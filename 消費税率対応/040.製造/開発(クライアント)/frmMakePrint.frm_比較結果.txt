[1] : C:\Users\...\修正後\cfrUnpaid\frmMakePrint.frm      | [2] : C:\Users\...\0306_cfrUnpaid\frmMakePrint.frm        
00001  |VERSION 5.00                                      ||00001  |VERSION 5.00                                      
00002  |Object = "{C0A63B80-4B21-11D3-BD95-D426EF2C7949}#1||00002  |Object = "{C0A63B80-4B21-11D3-BD95-D426EF2C7949}#1
00003  |Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1||00003  |Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1
00004  |Begin VB.Form frmMakePrint                        ||00004  |Begin VB.Form frmMakePrint                        
00005  |   Caption         =   "外部委託顧問料確認書作成" ||00005  |   Caption         =   "外部委託顧問料確認書作成" 
00006  |   ClientHeight    =   5595                       ||00006  |   ClientHeight    =   5595                       
00007  |   ClientLeft      =   165                        ||00007  |   ClientLeft      =   165                        
00008  |   ClientTop       =   855                        ||00008  |   ClientTop       =   855                        
00009  |   ClientWidth     =   9420                       ||00009  |   ClientWidth     =   9420                       
00010  |   LinkTopic       =   "Form1"                    ||00010  |   LinkTopic       =   "Form1"                    
00011  |   LockControls    =   -1  'True                  ||00011  |   LockControls    =   -1  'True                  
00012  |   ScaleHeight     =   5595                       ||00012  |   ScaleHeight     =   5595                       
00013  |   ScaleWidth      =   9420                       ||00013  |   ScaleWidth      =   9420                       
00014  |   StartUpPosition =   3  'Windows の既定値       ||00014  |   StartUpPosition =   3  'Windows の既定値       
00015  |   Begin VB.CommandButton cmdCheckClear           ||00015  |   Begin VB.CommandButton cmdCheckClear           
00016  |      Caption         =   "出力対象全てクリア"    ||00016  |      Caption         =   "出力対象全てクリア"    
00017  |      Height          =   345                     ||00017  |      Height          =   345                     
00018  |      Left            =   390                     ||00018  |      Left            =   390                     
00019  |      TabIndex        =   13                      ||00019  |      TabIndex        =   13                      
00020  |      Top             =   1080                    ||00020  |      Top             =   1080                    
00021  |      Width           =   1935                    ||00021  |      Width           =   1935                    
00022  |   End                                            ||00022  |   End                                            
00023  |   Begin VB.CheckBox chkAllSelect                 ||00023  |   Begin VB.CheckBox chkAllSelect                 
00024  |      Caption         =   "全てチェック"          ||00024  |      Caption         =   "全てチェック"          
00025  |      Height          =   255                     ||00025  |      Height          =   255                     
00026  |      Left            =   2460                    ||00026  |      Left            =   2460                    
00027  |      TabIndex        =   12                      ||00027  |      TabIndex        =   12                      
00028  |      Tag             =   "チェックボックス"      ||00028  |      Tag             =   "チェックボックス"      
00029  |      ToolTipText     =   "全ての出力チェックボッ ||00029  |      ToolTipText     =   "全ての出力チェックボッ 
00030  |      Top             =   1140                    ||00030  |      Top             =   1140                    
00031  |      Visible         =   0   'False              ||00031  |      Visible         =   0   'False              
00032  |      Width           =   1245                    ||00032  |      Width           =   1245                    
00033  |   End                                            ||00033  |   End                                            
00034  |   Begin VB.TextBox txtSysOutDate                 ||00034  |   Begin VB.TextBox txtSysOutDate                 
00035  |      Height          =   300                     ||00035  |      Height          =   300                     
00036  |      IMEMode         =   3  'ｵﾌ固定              ||00036  |      IMEMode         =   3  'ｵﾌ固定              
00037  |      Left            =   6600                    ||00037  |      Left            =   6600                    
00038  |      MaxLength       =   10                      ||00038  |      MaxLength       =   10                      
00039  |      TabIndex        =   3                       ||00039  |      TabIndex        =   3                       
00040  |      Tag             =   "出力日付"              ||00040  |      Tag             =   "出力日付"              
00041  |      Top             =   600                     ||00041  |      Top             =   600                     
00042  |      Width           =   2295                    ||00042  |      Width           =   2295                    
00043  |   End                                            ||00043  |   End                                            
00044  |   Begin VB.ComboBox cboBumonFlag                 ||00044  |   Begin VB.ComboBox cboBumonFlag                 
00045  |      Height          =   300                     ||00045  |      Height          =   300                     
00046  |      Left            =   6600                    ||00046  |      Left            =   6600                    
00047  |      Style           =   2  'ﾄﾞﾛｯﾌﾟﾀﾞｳﾝ ﾘｽﾄ      ||00047  |      Style           =   2  'ﾄﾞﾛｯﾌﾟﾀﾞｳﾝ ﾘｽﾄ      
00048  |      TabIndex        =   1                       ||00048  |      TabIndex        =   1                       
00049  |      Tag             =   "部署名"                ||00049  |      Tag             =   "部署名"                
00050  |      Top             =   120                     ||00050  |      Top             =   120                     
00051  |      Width           =   2280                    ||00051  |      Width           =   2280                    
00052  |   End                                            ||00052  |   End                                            
00053  |   Begin VB.TextBox txtInputTax                   ||00053  |   Begin VB.TextBox txtInputTax                   
00054  |      Alignment       =   1  '右揃え              ||00054  |      Alignment       =   1  '右揃え              
00055  |      Height          =   300                     ||00055  |      Height          =   300                     
00056  |      IMEMode         =   3  'ｵﾌ固定              ||00056  |      IMEMode         =   3  'ｵﾌ固定              
00057  |      Left            =   1545                    ||00057  |      Left            =   1545                    
00058  |      MaxLength       =   2                       ||00058  |      MaxLength       =   2                       
00059  |      TabIndex        =   2                       ||00059  |      TabIndex        =   2                       
00060  |      Tag             =   "消費税率"              ||00060  |      Tag             =   "消費税率"              
00061  |      ToolTipText     =   "入力できるのは整数2桁で||00061  |      ToolTipText     =   "入力できるのは整数2桁で
00062  |      Top             =   600                     ||00062  |      Top             =   600                     
00063  |      Visible         =   0   'False              ||00063  |      Visible         =   0   'False              
00064  |      Width           =   375                     ||00064  |      Width           =   375                     
00065  |   End                                            ||00065  |   End                                            
00066  |   Begin VB.CommandButton cmdCancel               ||00066  |   Begin VB.CommandButton cmdCancel               
00067  |      Caption         =   "キャンセル"            ||00067  |      Caption         =   "キャンセル"            
00068  |      Height          =   375                     ||00068  |      Height          =   375                     
00069  |      Left            =   6600                    ||00069  |      Left            =   6600                    
00070  |      TabIndex        =   5                       ||00070  |      TabIndex        =   5                       
00071  |      Tag             =   "キャンセルコマンドボタ ||00071  |      Tag             =   "キャンセルコマンドボタ 
00072  |      ToolTipText     =   "確認書作成画面を終了し ||00072  |      ToolTipText     =   "確認書作成画面を終了し 
00073  |      Top             =   1080                    ||00073  |      Top             =   1080                    
00074  |      Width           =   2295                    ||00074  |      Width           =   2295                    
00075  |   End                                            ||00075  |   End                                            
00076  |   Begin VB.CommandButton cmdMake                 ||00076  |   Begin VB.CommandButton cmdMake                 
00077  |      Caption         =   "確認書出力"            ||00077  |      Caption         =   "確認書出力"            
00078  |      Height          =   375                     ||00078  |      Height          =   375                     
00079  |      Left            =   4290                    ||00079  |      Left            =   4290                    
00080  |      TabIndex        =   4                       ||00080  |      TabIndex        =   4                       
00081  |      Tag             =   "作成コマンドボタン"    ||00081  |      Tag             =   "作成コマンドボタン"    
00082  |      ToolTipText     =   "確認書を作成します。"  ||00082  |      ToolTipText     =   "確認書を作成します。"  
00083  |      Top             =   1080                    ||00083  |      Top             =   1080                    
00084  |      Width           =   2235                    ||00084  |      Width           =   2235                    
00085  |   End                                            ||00085  |   End                                            
00086  |   Begin VB.TextBox txtInputName                  ||00086  |   Begin VB.TextBox txtInputName                  
00087  |      Height          =   300                     ||00087  |      Height          =   300                     
00088  |      IMEMode         =   1  'ｵﾝ                  ||00088  |      IMEMode         =   1  'ｵﾝ                  
00089  |      Left            =   1545                    ||00089  |      Left            =   1545                    
00090  |      MaxLength       =   10                      ||00090  |      MaxLength       =   10                      
00091  |      TabIndex        =   0                       ||00091  |      TabIndex        =   0                       
00092  |      Tag             =   "担当者"                ||00092  |      Tag             =   "担当者"                
00093  |      Top             =   120                     ||00093  |      Top             =   120                     
00094  |      Width           =   1815                    ||00094  |      Width           =   1815                    
00095  |   End                                            ||00095  |   End                                            
00096  |   Begin MSComDlg.CommonDialog dlgFileOut         ||00096  |   Begin MSComDlg.CommonDialog dlgFileOut         
00097  |      Left            =   120                     ||00097  |      Left            =   120                     
00098  |      Top             =   5040                    ||00098  |      Top             =   5040                    
00099  |      _ExtentX        =   847                     ||00099  |      _ExtentX        =   847                     
00100  |      _ExtentY        =   847                     ||00100  |      _ExtentY        =   847                     
00101  |      _Version        =   393216                  ||00101  |      _Version        =   393216                  
00102  |      CancelError     =   -1  'True               ||00102  |      CancelError     =   -1  'True               
00103  |      DefaultExt      =   "xls"                   ||00103  |      DefaultExt      =   "xls"                   
00104  |      DialogTitle     =   "外部委託顧問料確認書フ ||00104  |      DialogTitle     =   "外部委託顧問料確認書フ 
00105  |      Filter          =   "Microsoft EXCEL ブック ||00105  |      Filter          =   "Microsoft EXCEL ブック 
00106  |      FilterIndex     =   1                       ||00106  |      FilterIndex     =   1                       
00107  |      InitDir         =   "C:"                    ||00107  |      InitDir         =   "C:"                    
00108  |   End                                            ||00108  |   End                                            
00109  |   Begin VSFlex7LCtl.VSFlexGrid fgridMakePrint    ||00109  |   Begin VSFlex7LCtl.VSFlexGrid fgridMakePrint    
00110  |      Height          =   3855                    ||00110  |      Height          =   3855                    
00111  |      Left            =   120                     ||00111  |      Left            =   120                     
00112  |      TabIndex        =   9                       ||00112  |      TabIndex        =   9                       
00113  |      TabStop         =   0   'False              ||00113  |      TabStop         =   0   'False              
00114  |      Top             =   1560                    ||00114  |      Top             =   1560                    
00115  |      Width           =   9135                    ||00115  |      Width           =   9135                    
00116  |      _cx             =   16113                   ||00116  |      _cx             =   16113                   
00117  |      _cy             =   6800                    ||00117  |      _cy             =   6800                    
00118  |      _ConvInfo       =   1                       ||00118  |      _ConvInfo       =   1                       
00119  |      Appearance      =   1                       ||00119  |      Appearance      =   1                       
00120  |      BorderStyle     =   1                       ||00120  |      BorderStyle     =   1                       
00121  |      Enabled         =   -1  'True               ||00121  |      Enabled         =   -1  'True               
00122  |      BeginProperty Font {0BE35203-8F91-11CE-9DE3-||00122  |      BeginProperty Font {0BE35203-8F91-11CE-9DE3-
00123  |         Name            =   "ＭＳ Ｐゴシック"    ||00123  |         Name            =   "ＭＳ Ｐゴシック"    
00124  |         Size            =   9                    ||00124  |         Size            =   9                    
00125  |         Charset         =   128                  ||00125  |         Charset         =   128                  
00126  |         Weight          =   400                  ||00126  |         Weight          =   400                  
00127  |         Underline       =   0   'False           ||00127  |         Underline       =   0   'False           
00128  |         Italic          =   0   'False           ||00128  |         Italic          =   0   'False           
00129  |         Strikethrough   =   0   'False           ||00129  |         Strikethrough   =   0   'False           
00130  |      EndProperty                                 ||00130  |      EndProperty                                 
00131  |      MousePointer    =   0                       ||00131  |      MousePointer    =   0                       
00132  |      BackColor       =   -2147483643             ||00132  |      BackColor       =   -2147483643             
00133  |      ForeColor       =   -2147483640             ||00133  |      ForeColor       =   -2147483640             
00134  |      BackColorFixed  =   -2147483633             ||00134  |      BackColorFixed  =   -2147483633             
00135  |      ForeColorFixed  =   -2147483630             ||00135  |      ForeColorFixed  =   -2147483630             
00136  |      BackColorSel    =   -2147483644             ||00136  |      BackColorSel    =   -2147483644             
00137  |      ForeColorSel    =   -2147483634             ||00137  |      ForeColorSel    =   -2147483634             
00138  |      BackColorBkg    =   -2147483636             ||00138  |      BackColorBkg    =   -2147483636             
00139  |      BackColorAlternate=   -2147483643           ||00139  |      BackColorAlternate=   -2147483643           
00140  |      GridColor       =   -2147483633             ||00140  |      GridColor       =   -2147483633             
00141  |      GridColorFixed  =   -2147483632             ||00141  |      GridColorFixed  =   -2147483632             
00142  |      TreeColor       =   -2147483632             ||00142  |      TreeColor       =   -2147483632             
00143  |      FloodColor      =   192                     ||00143  |      FloodColor      =   192                     
00144  |      SheetBorder     =   -2147483642             ||00144  |      SheetBorder     =   -2147483642             
00145  |      FocusRect       =   1                       ||00145  |      FocusRect       =   1                       
00146  |      HighLight       =   1                       ||00146  |      HighLight       =   1                       
00147  |      AllowSelection  =   -1  'True               ||00147  |      AllowSelection  =   -1  'True               
00148  |      AllowBigSelection=   -1  'True              ||00148  |      AllowBigSelection=   -1  'True              
00149  |      AllowUserResizing=   1                      ||00149  |      AllowUserResizing=   1                      
00150  |      SelectionMode   =   0                       ||00150  |      SelectionMode   =   0                       
00151  |      GridLines       =   1                       ||00151  |      GridLines       =   1                       
00152  |      GridLinesFixed  =   2                       ||00152  |      GridLinesFixed  =   2                       
00153  |      GridLineWidth   =   1                       ||00153  |      GridLineWidth   =   1                       
00154  |      Rows            =   20                      ||00154  |      Rows            =   20                      
00155  |      Cols            =   30                      ||00155  |      Cols            =   30                      
00156  |      FixedRows       =   1                       ||00156  |      FixedRows       =   1                       
00157  |      FixedCols       =   1                       ||00157  |      FixedCols       =   1                       
00158  |      RowHeightMin    =   0                       ||00158  |      RowHeightMin    =   0                       
00159  |      RowHeightMax    =   0                       ||00159  |      RowHeightMax    =   0                       
00160  |      ColWidthMin     =   0                       ||00160  |      ColWidthMin     =   0                       
00161  |      ColWidthMax     =   0                       ||00161  |      ColWidthMax     =   0                       
00162  |      ExtendLastCol   =   0   'False              ||00162  |      ExtendLastCol   =   0   'False              
00163  |      FormatString    =   $"frmMakePrint.frx":0000||00163  |      FormatString    =   $"frmMakePrint.frx":0000
00164  |      ScrollTrack     =   0   'False              ||00164  |      ScrollTrack     =   0   'False              
00165  |      ScrollBars      =   3                       ||00165  |      ScrollBars      =   3                       
00166  |      ScrollTips      =   0   'False              ||00166  |      ScrollTips      =   0   'False              
00167  |      MergeCells      =   0                       ||00167  |      MergeCells      =   0                       
00168  |      MergeCompare    =   0                       ||00168  |      MergeCompare    =   0                       
00169  |      AutoResize      =   -1  'True               ||00169  |      AutoResize      =   -1  'True               
00170  |      AutoSizeMode    =   0                       ||00170  |      AutoSizeMode    =   0                       
00171  |      AutoSearch      =   0                       ||00171  |      AutoSearch      =   0                       
00172  |      AutoSearchDelay =   2                       ||00172  |      AutoSearchDelay =   2                       
00173  |      MultiTotals     =   -1  'True               ||00173  |      MultiTotals     =   -1  'True               
00174  |      SubtotalPosition=   1                       ||00174  |      SubtotalPosition=   1                       
00175  |      OutlineBar      =   0                       ||00175  |      OutlineBar      =   0                       
00176  |      OutlineCol      =   0                       ||00176  |      OutlineCol      =   0                       
00177  |      Ellipsis        =   0                       ||00177  |      Ellipsis        =   0                       
00178  |      ExplorerBar     =   1                       ||00178  |      ExplorerBar     =   1                       
00179  |      PicturesOver    =   0   'False              ||00179  |      PicturesOver    =   0   'False              
00180  |      FillStyle       =   0                       ||00180  |      FillStyle       =   0                       
00181  |      RightToLeft     =   0   'False              ||00181  |      RightToLeft     =   0   'False              
00182  |      PictureType     =   0                       ||00182  |      PictureType     =   0                       
00183  |      TabBehavior     =   1                       ||00183  |      TabBehavior     =   1                       
00184  |      OwnerDraw       =   0                       ||00184  |      OwnerDraw       =   0                       
00185  |      Editable        =   0                       ||00185  |      Editable        =   0                       
00186  |      ShowComboButton =   -1  'True               ||00186  |      ShowComboButton =   -1  'True               
00187  |      WordWrap        =   0   'False              ||00187  |      WordWrap        =   0   'False              
00188  |      TextStyle       =   0                       ||00188  |      TextStyle       =   0                       
00189  |      TextStyleFixed  =   0                       ||00189  |      TextStyleFixed  =   0                       
00190  |      OleDragMode     =   0                       ||00190  |      OleDragMode     =   0                       
00191  |      OleDropMode     =   0                       ||00191  |      OleDropMode     =   0                       
00192  |      ComboSearch     =   3                       ||00192  |      ComboSearch     =   3                       
00193  |      AutoSizeMouse   =   -1  'True               ||00193  |      AutoSizeMouse   =   -1  'True               
00194  |      FrozenRows      =   0                       ||00194  |      FrozenRows      =   0                       
00195  |      FrozenCols      =   0                       ||00195  |      FrozenCols      =   0                       
00196  |      AllowUserFreezing=   0                      ||00196  |      AllowUserFreezing=   0                      
00197  |      BackColorFrozen =   0                       ||00197  |      BackColorFrozen =   0                       
00198  |      ForeColorFrozen =   0                       ||00198  |      ForeColorFrozen =   0                       
00199  |      WallPaperAlignment=   9                     ||00199  |      WallPaperAlignment=   9                     
00200  |   End                                            ||00200  |   End                                            
00201  |   Begin VB.Label Label1                          ||00201  |   Begin VB.Label Label1                          
00202  |      AutoSize        =   -1  'True               ||00202  |      AutoSize        =   -1  'True               
00203  |      Caption         =   "%"                     ||00203  |      Caption         =   "%"                     
00204  |      Height          =   180                     ||00204  |      Height          =   180                     
00205  |      Left            =   2040                    ||00205  |      Left            =   2040                    
00206  |      TabIndex        =   11                      ||00206  |      TabIndex        =   11                      
00207  |      Tag             =   "%表示"                 ||00207  |      Tag             =   "%表示"                 
00208  |      Top             =   660                     ||00208  |      Top             =   660                     
00209  |      Visible         =   0   'False              ||00209  |      Visible         =   0   'False              
00210  |      Width           =   90                      ||00210  |      Width           =   90                      
00211  |   End                                            ||00211  |   End                                            
00212  |   Begin VB.Label lblSysOutDate                   ||00212  |   Begin VB.Label lblSysOutDate                   
00213  |      AutoSize        =   -1  'True               ||00213  |      AutoSize        =   -1  'True               
00214  |      Caption         =   "出力日付 (YYYY/MM/DD)" ||00214  |      Caption         =   "出力日付 (YYYY/MM/DD)" 
00215  |      Height          =   180                     ||00215  |      Height          =   180                     
00216  |      Left            =   4320                    ||00216  |      Left            =   4320                    
00217  |      TabIndex        =   10                      ||00217  |      TabIndex        =   10                      
00218  |      Tag             =   "基準月 (YYYY/MM)ラベル"||00218  |      Tag             =   "基準月 (YYYY/MM)ラベル"
00219  |      Top             =   660                     ||00219  |      Top             =   660                     
00220  |      Width           =   2010                    ||00220  |      Width           =   2010                    
00221  |   End                                            ||00221  |   End                                            
00222  |   Begin VB.Label lblBumonFlag                    ||00222  |   Begin VB.Label lblBumonFlag                    
00223  |      AutoSize        =   -1  'True               ||00223  |      AutoSize        =   -1  'True               
00224  |      Caption         =   "部署名"                ||00224  |      Caption         =   "部署名"                
00225  |      Height          =   180                     ||00225  |      Height          =   180                     
00226  |      Left            =   4320                    ||00226  |      Left            =   4320                    
00227  |      TabIndex        =   8                       ||00227  |      TabIndex        =   8                       
00228  |      Top             =   180                     ||00228  |      Top             =   180                     
00229  |      Width           =   540                     ||00229  |      Width           =   540                     
00230  |   End                                            ||00230  |   End                                            
00231  |   Begin VB.Label lblInpuTax                      ||00231  |   Begin VB.Label lblInpuTax                      
00232  |      AutoSize        =   -1  'True               ||00232  |      AutoSize        =   -1  'True               
00233  |      Caption         =   "消費税率"              ||00233  |      Caption         =   "消費税率"              
00234  |      Height          =   180                     ||00234  |      Height          =   180                     
00235  |      Left            =   480                     ||00235  |      Left            =   480                     
00236  |      TabIndex        =   7                       ||00236  |      TabIndex        =   7                       
00237  |      Tag             =   "基準月 (YYYY/MM)ラベル"||00237  |      Tag             =   "基準月 (YYYY/MM)ラベル"
00238  |      Top             =   660                     ||00238  |      Top             =   660                     
00239  |      Visible         =   0   'False              ||00239  |      Visible         =   0   'False              
00240  |      Width           =   720                     ||00240  |      Width           =   720                     
00241  |   End                                            ||00241  |   End                                            
00242  |   Begin VB.Label lblInputName                    ||00242  |   Begin VB.Label lblInputName                    
00243  |      AutoSize        =   -1  'True               ||00243  |      AutoSize        =   -1  'True               
00244  |      Caption         =   "担当者"                ||00244  |      Caption         =   "担当者"                
00245  |      Height          =   180                     ||00245  |      Height          =   180                     
00246  |      Left            =   480                     ||00246  |      Left            =   480                     
00247  |      TabIndex        =   6                       ||00247  |      TabIndex        =   6                       
00248  |      Tag             =   "基準月 (YYYY/MM)ラベル"||00248  |      Tag             =   "基準月 (YYYY/MM)ラベル"
00249  |      Top             =   180                     ||00249  |      Top             =   180                     
00250  |      Width           =   540                     ||00250  |      Width           =   540                     
00251  |   End                                            ||00251  |   End                                            
00252  |   Begin VB.Menu mnuFile                          ||00252  |   Begin VB.Menu mnuFile                          
00253  |      Caption         =   "ファイル(&F)"          ||00253  |      Caption         =   "ファイル(&F)"          
00254  |      Begin VB.Menu mnuEnd                        ||00254  |      Begin VB.Menu mnuEnd                        
00255  |         Caption         =   "終了(&X)"           ||00255  |         Caption         =   "終了(&X)"           
00256  |      End                                         ||00256  |      End                                         
00257  |   End                                            ||00257  |   End                                            
00258  |End                                               ||00258  |End                                               
00259  |Attribute VB_Name = "frmMakePrint"                ||00259  |Attribute VB_Name = "frmMakePrint"                
00260  |Attribute VB_GlobalNameSpace = False              ||00260  |Attribute VB_GlobalNameSpace = False              
00261  |Attribute VB_Creatable = False                    ||00261  |Attribute VB_Creatable = False                    
00262  |Attribute VB_PredeclaredId = True                 ||00262  |Attribute VB_PredeclaredId = True                 
00263  |Attribute VB_Exposed = False                      ||00263  |Attribute VB_Exposed = False                      
00264  |'=================================================||00264  |'=================================================
00265  |'プロジェクト       ：NAM 顧問料デイリー算出システ||00265  |'プロジェクト       ：NAM 顧問料デイリー算出システ
00266  |'プログラム名       ：外部委託顧問料確認書作成画面||00266  |'プログラム名       ：外部委託顧問料確認書作成画面
00267  |'プログラムID       ：frmMakePrint.frm            ||00267  |'プログラムID       ：frmMakePrint.frm            
00268  |'機能概要           ：外部委託顧問料確認書作成画面||00268  |'機能概要           ：外部委託顧問料確認書作成画面
00269  |'                                                 ||00269  |'                                                 
00270  |'日付         作者名            修正内容          ||00270  |'日付         作者名            修正内容          
00271  |'-------------------------------------------------||00271  |'-------------------------------------------------
00272  |'2004/08/03 　M.Katoh <SRA>  　新規作成           ||00272  |'2004/08/03 　M.Katoh <SRA>  　新規作成           
00273  |'2004/09/10   M.Yamazaki<SRA>  確認書にファンドコ ||00273  |'2004/09/10   M.Yamazaki<SRA>  確認書にファンドコ 
00274  |'2004/09/21   M.Yamazaki<SRA>  １契約に対して複数 ||00274  |'2004/09/21   M.Yamazaki<SRA>  １契約に対して複数 
00275  |'2004/09/28   M.Yamazaki<SRA>  月次NAVがない場合、||00275  |'2004/09/28   M.Yamazaki<SRA>  月次NAVがない場合、
00276  |'2004/11/08   M.Yamazaki<SRA>  NAVが倍になってしま||00276  |'2004/11/08   M.Yamazaki<SRA>  NAVが倍になってしま
00277  |'2004/11/10   M.Yamazaki<SRA>  見出し4行目のコメン||00277  |'2004/11/10   M.Yamazaki<SRA>  見出し4行目のコメン
00278  |'2004/11/16   M.Yamazaki<SRA>  前回締日がいつも締 ||00278  |'2004/11/16   M.Yamazaki<SRA>  前回締日がいつも締 
00279  |'2004/11/17   M.Yamazaki<SRA>  端数の四捨五入が正 ||00279  |'2004/11/17   M.Yamazaki<SRA>  端数の四捨五入が正 
00280  |'                              消費税は切り捨てる ||00280  |'                              消費税は切り捨てる 
00281  |'2004/12/13   M.Yamazaki<SRA>  前回締日取得時に適 ||00281  |'2004/12/13   M.Yamazaki<SRA>  前回締日取得時に適 
00282  |'2004/12/17   M.Yamazaki<SRA>  上限金額、下限金額 ||00282  |'2004/12/17   M.Yamazaki<SRA>  上限金額、下限金額 
00283  |'2004/12/29   M.Yamazaki<SRA>  NAV取得区分が日次NA||00283  |'2004/12/29   M.Yamazaki<SRA>  NAV取得区分が日次NA
00284  |'2005/01/11   M.Yamazaki<SRA>  名称使用許諾料の上 ||00284  |'2005/01/11   M.Yamazaki<SRA>  名称使用許諾料の上 
00285  |'2005/01/13   M.Yamazaki<SRA>  １契約複数口座の場 ||00285  |'2005/01/13   M.Yamazaki<SRA>  １契約複数口座の場 
00286  |'2005/01/17   M.Yamazaki<SRA>  換算レートの入力は ||00286  |'2005/01/17   M.Yamazaki<SRA>  換算レートの入力は 
00287  |'2005/03/09   M.Yamazaki<SRA>  別紙対応、消費税対 ||00287  |'2005/03/09   M.Yamazaki<SRA>  別紙対応、消費税対 
00288  |'2005/04/21   M.Yamazaki<SRA>  パフォーマンス改善 ||00288  |'2005/04/21   M.Yamazaki<SRA>  パフォーマンス改善 
00289  |'2005/04/22   M.Yamazaki<SRA>  顧問料計算終了日の ||00289  |'2005/04/22   M.Yamazaki<SRA>  顧問料計算終了日の 
00290  |'2005/04/22   M.Yamazaki<SRA>  重複データをグリッ ||00290  |'2005/04/22   M.Yamazaki<SRA>  重複データをグリッ 
00291  |'2005/07/25   K.Nishihama<SRA> 英文チェックボック ||00291  |'2005/07/25   K.Nishihama<SRA> 英文チェックボック 
00292  |'2006/04/11   K.Furuya <SRA>   外部委託顧問料改良(||00292  |'2006/04/11   K.Furuya <SRA>   外部委託顧問料改良(
00293  |'2006/07/03   K.Furuya <SRA>   期中料率変更契約/RA||00293  |'2006/07/03   K.Furuya <SRA>   期中料率変更契約/RA
00294  |'2008/03/12   K.Furuya <SRA>   ファンド決算期間で ||00294  |'2008/03/12   K.Furuya <SRA>   ファンド決算期間で 
00295  |'2014/02/19   M.Takada <SRA>   【管理会計】消費税 ||00295  |'2014/02/19   M.Takada <SRA>   【管理会計】消費税 
00296  |'=================================================||00296  |'=================================================
00297  |' 本製品に関するすべての権利は(株)野村総合研究所に||00297  |' 本製品に関するすべての権利は(株)野村総合研究所に
00298  |'による許可を得ずに、本製品の全部または一部を複製 ||00298  |'による許可を得ずに、本製品の全部または一部を複製 
00299  |'=================================================||00299  |'=================================================
00300  |Option Explicit                                   ||00300  |Option Explicit                                   
00301  |                                                  ||00301  |                                                  
00302  |Private Declare Function WinHelp& Lib "user32" Ali||00302  |Private Declare Function WinHelp& Lib "user32" Ali
00303  |    (ByVal hWnd As Long, ByVal lpHelpFile As Strin||00303  |    (ByVal hWnd As Long, ByVal lpHelpFile As Strin
00304  |    ByVal dwData As Long)                         ||00304  |    ByVal dwData As Long)                         
00305  |                                                  ||00305  |                                                  
00306  |'モジュール内共通データ（変数）定義               ||00306  |'モジュール内共通データ（変数）定義               
00307  |                                                  ||00307  |                                                  
00308  |'セキュリティ関数用                               ||00308  |'セキュリティ関数用                               
00309  |Dim mblnFlgUnload           As Boolean  'Unloadす ||00309  |Dim mblnFlgUnload           As Boolean  'Unloadす 
00310  |Dim mblnFinishStatus        As Boolean  '当Formス ||00310  |Dim mblnFinishStatus        As Boolean  '当Formス 
00311  |                                                  ||00311  |                                                  
00312  |'DB関数用                                         ||00312  |'DB関数用                                         
00313  |Dim mblnDBClose             As Boolean  'DB-Close ||00313  |Dim mblnDBClose             As Boolean  'DB-Close 
00314  |Dim mblnDynasetOpen         As Boolean  'DB-Dynase||00314  |Dim mblnDynasetOpen         As Boolean  'DB-Dynase
00315  |Dim mblnDynasetClose        As Boolean  'DB-DynaSe||00315  |Dim mblnDynasetClose        As Boolean  'DB-DynaSe
00316  |Dim mblnRollback            As Boolean  'DB-Rollba||00316  |Dim mblnRollback            As Boolean  'DB-Rollba
00317  |                                                  ||00317  |                                                  
00318  |Dim mstrbasedate            As String   '基準月(YY||00318  |Dim mstrbasedate            As String   '基準月(YY
00319  |Dim mstrbaseMonth           As String   '基準月(MM||00319  |Dim mstrbaseMonth           As String   '基準月(MM
00320  |Dim mstrbaseYear            As String   '基準月(YY||00320  |Dim mstrbaseYear            As String   '基準月(YY
00321  |Dim mstrbaseToday           As String   '当日日付(||00321  |Dim mstrbaseToday           As String   '当日日付(
00322  |Dim mstrYYYYMM              As String   'mstrbased||00322  |Dim mstrYYYYMM              As String   'mstrbased
00323  |Dim mstrYYYYMMDD            As String   'mstrbased||00323  |Dim mstrYYYYMMDD            As String   'mstrbased
00324  |                                                  ||00324  |                                                  
00325  |Dim mstrSettlementDate      As String   '対象前回 ||00325  |Dim mstrSettlementDate      As String   '対象前回 
00326  |Dim mstrNearSettleDate      As String   '対象直近 ||00326  |Dim mstrNearSettleDate      As String   '対象直近 
00327  |Dim mstrPaymentDate         As String   '対象支払 ||00327  |Dim mstrPaymentDate         As String   '対象支払 
00328  |Dim mstrDailyNav            As String   '対象日次N||00328  |Dim mstrDailyNav            As String   '対象日次N
00329  |Dim mstrMonthlyNav()        As String   '対象月次N||00329  |Dim mstrMonthlyNav()        As String   '対象月次N
00330  |Dim mstrMonthlyPayCom       As String   '対象月別 ||00330  |Dim mstrMonthlyPayCom       As String   '対象月別 
00331  |Dim gSysoutDataCnt          As Long     'Excelに出||00331  |Dim gSysoutDataCnt          As Long     'Excelに出
00332  |Dim gProcessCnt             As Long     '出力処理 ||00332  |Dim gProcessCnt             As Long     '出力処理 
00333  |Dim gTotalProcessCnt        As Long     '総計の出 ||00333  |Dim gTotalProcessCnt        As Long     '総計の出 
00334  |Dim gSaveFileCnt            As Long     '保存ファ ||00334  |Dim gSaveFileCnt            As Long     '保存ファ 
00335  |Dim mstrFileName            As String   '保存する ||00335  |Dim mstrFileName            As String   '保存する 
00336  |Dim mstrFileNameBK          As String   '保存する ||00336  |Dim mstrFileNameBK          As String   '保存する 
00337  |Dim mstrContractFlag()      As String   '契約区分 ||00337  |Dim mstrContractFlag()      As String   '契約区分 
00338  |                                                  ||00338  |                                                  
00339  |Dim xlApp                   As Excel.Application  ||00339  |Dim xlApp                   As Excel.Application  
00340  |Dim xlBook                  As Excel.Workbook     ||00340  |Dim xlBook                  As Excel.Workbook     
00341  |Dim xlSheet                 As Excel.Worksheet    ||00341  |Dim xlSheet                 As Excel.Worksheet    
00342  |'2004/11/17 Start                                 ||00342  |'2004/11/17 Start                                 
00343  |Dim dblValueIn              As Double             ||00343  |Dim dblValueIn              As Double             
00344  |Dim dblValueOut             As Double             ||00344  |Dim dblValueOut             As Double             
00345  |'2004/11/17 End                                   ||00345  |'2004/11/17 End                                   
00346  |'2005/02/02 Start                                 ||00346  |'2005/02/02 Start                                 
00347  |Dim dstrShimebi             As String             ||00347  |Dim dstrShimebi             As String             
00348  |'2005/02/02 End                                   ||00348  |'2005/02/02 End                                   
00349  |'2005/03/09 Start                                 ||00349  |'2005/03/09 Start                                 
00350  |Dim gTotalDnavCnt           As Long     '日次NAV一||00350  |Dim gTotalDnavCnt           As Long     '日次NAV一
00351  |Dim gTotalCnt               As Long               ||00351  |Dim gTotalCnt               As Long               
00352  |Dim dstrOldAccCode          As String             ||00352  |Dim dstrOldAccCode          As String             
00353  |Dim ddblconsumption_tax     As Double             ||00353  |Dim ddblconsumption_tax     As Double             
00354  |'2005/03/09 End                                   ||00354  |'2005/03/09 End                                   
00355  |'2005/04/21 Start                                 ||00355  |'2005/04/21 Start                                 
00356  |Dim lRecCnt2 As Long                              ||00356  |Dim lRecCnt2 As Long                              
00357  |Dim dstrSvSettlementDate As String                ||00357  |Dim dstrSvSettlementDate As String                
00358  |'2005/04/21 End                                   ||00358  |'2005/04/21 End                                   
00359  |'2005/04/22 Start                                 ||00359  |'2005/04/22 Start                                 
00360  |Dim lRowCnt         As Long                       ||00360  |Dim lRowCnt         As Long                       
00361  |'2005/04/22 End                                   ||00361  |'2005/04/22 End                                   
00362  |'2006/04/13 START K.Furuya 外部委託顧問料改良対応 ||00362  |'2006/04/13 START K.Furuya 外部委託顧問料改良対応 
00363  |Dim strErrCall      As String       'エラー       ||00363  |Dim strErrCall      As String       'エラー       
00364  |'2006/04/13 END   K.Furuya 外部委託顧問料改良対応 ||00364  |'2006/04/13 END   K.Furuya 外部委託顧問料改良対応 
00365  |'2006/07/13 START K.Furuya 期中料率変更契約/RAFI対||00365  |'2006/07/13 START K.Furuya 期中料率変更契約/RAFI対
00366  |Dim msAssetFlg            As String   '資産種別   ||00366  |Dim msAssetFlg            As String   '資産種別   
00367  |Dim msdstrCaldate         As String   'カレンダー ||00367  |Dim msdstrCaldate         As String   'カレンダー 
00368  |Dim msBabyAccountCode     As String   'マザー組入 ||00368  |Dim msBabyAccountCode     As String   'マザー組入 
00369  |Dim msContNo              As String   '契約番号   ||00369  |Dim msContNo              As String   '契約番号   
00370  |Dim msAccCode             As String   'ベビー口座 ||00370  |Dim msAccCode             As String   'ベビー口座 
00371  |Dim msMotherAccCode       As String   'マザー口座 ||00371  |Dim msMotherAccCode       As String   'マザー口座 
00372  |'2006/07/13 END   K.Furuya 期中料率変更契約/RAFI対||00372  |'2006/07/13 END   K.Furuya 期中料率変更契約/RAFI対
00373  |                                                  ||00373  |                                                  
00374  |'2014/02/19 START M.Takada 【管理会計】消費税率変 ||00374  |'2014/02/19 START M.Takada 【管理会計】消費税率変 
00375  |Dim strTaxRate()    As String   '消費税率の格納配 ||00375  |Dim strTaxRate()    As String   '消費税率の格納配 
00376  |Dim strPayNum()     As String   '(消費税率変更前後||00376  |Dim strPayNum()     As String   '(消費税率変更前後
00377  |Dim strChgPay     As String     '支払額の切り分け ||00377  |Dim strChgPay     As String     '支払額の切り分け 
00378  |Dim strTaxNum()     As String   '消費税額の格納配 ||00378  |Dim strTaxNum()     As String   '消費税額の格納配 
00379  |Dim intDays()       As Integer  '適用開始日を境に ||00379  |Dim intDays()       As Integer  '適用開始日を境に 
00380  |Dim intCount        As Integer  '配列用カウンター ||00380  |Dim intCount        As Integer  '配列用カウンター 
00381  |Dim Tax_Flg         As Boolean  '消費税額の分割算 ||00381  |Dim Tax_Flg         As Boolean  '消費税額の分割算 
00382 L|Dim strUse_Date     As String   '最新の適用開始日 ||       |                                                  
00383 L|Dim strNoChgTaxRate As String   '税率変更なしの最 ||       |                                                  
00384  |'2014/02/19 END   M.Takada 【管理会計】消費税率変 ||00382  |'2014/02/19 END   M.Takada 【管理会計】消費税率変 
00385  |                                                  ||00383  |                                                  
00386  |'Const定義                                        ||00384  |'Const定義                                        
00387  |Const conTitle      As String = "NAM顧問料算出 外 ||00385  |Const conTitle      As String = "NAM顧問料算出 外 
00388  |Const conMeForm     As String = "frmMakeprint"    ||00386  |Const conMeForm     As String = "frmMakeprint"    
00389  |Const sWord0a       As String = "ファンド支払投資 ||00387  |Const sWord0a       As String = "ファンド支払投資 
00390  |Const sWord0b       As String = "業務サービス料確 ||00388  |Const sWord0b       As String = "業務サービス料確 
00391  |Const sWord0c       As String = "名称使用許諾料確 ||00389  |Const sWord0c       As String = "名称使用許諾料確 
00392  |Const sWord1        As String = "野村ｱｾｯﾄﾏﾈｼﾞﾒﾝﾄ株||00390  |Const sWord1        As String = "野村ｱｾｯﾄﾏﾈｼﾞﾒﾝﾄ株
00393  |Const sWord2        As String = "財　務　部　　"  ||00391  |Const sWord2        As String = "財　務　部　　"  
00394  |'2004/11/10 Start                                 ||00392  |'2004/11/10 Start                                 
00395  |'Const sWord3    As String = "下記のとおり顧問料を||00393  |'Const sWord3    As String = "下記のとおり顧問料を
00396  |Const sWord3a       As String = "下記のとおり顧問 ||00394  |Const sWord3a       As String = "下記のとおり顧問 
00397  |Const sWord3b       As String = "下記のとおり業務 ||00395  |Const sWord3b       As String = "下記のとおり業務 
00398  |Const sWord3c       As String = "下記のとおり名称 ||00396  |Const sWord3c       As String = "下記のとおり名称 
00399  |'2004/11/10 End                                   ||00397  |'2004/11/10 End                                   
00400  |Const sWord4        As String = "ファンド名"      ||00398  |Const sWord4        As String = "ファンド名"      
00401  |'2004/09/10 Start                                 ||00399  |'2004/09/10 Start                                 
00402  |Const sWord4_2      As String = "ファンドコード"  ||00400  |Const sWord4_2      As String = "ファンドコード"  
00403  |'2004/09/10 End                                   ||00401  |'2004/09/10 End                                   
00404  |Const sWord5        As String = "計 算 期 間"     ||00402  |Const sWord5        As String = "計 算 期 間"     
00405  |Const sWord6        As String = "月末純資産"      ||00403  |Const sWord6        As String = "月末純資産"      
00406  |Const sWord7        As String = "日      付"      ||00404  |Const sWord7        As String = "日      付"      
00407  |Const sWord8        As String = "純　　資　　産"  ||00405  |Const sWord8        As String = "純　　資　　産"  
00408  |'2006/08/11 START K.Furuya                        ||00406  |'2006/08/11 START K.Furuya                        
00409  |'Const sWord9        As String = "合　　　 計"    ||00407  |'Const sWord9        As String = "合　　　 計"    
00410  |Const sWord9        As String = "合　　　計"      ||00408  |Const sWord9        As String = "合　　　計"      
00411  |'2006/08/11 END   K.Furuya                        ||00409  |'2006/08/11 END   K.Furuya                        
00412  |Const sWord10       As String = "年　　　率"      ||00410  |Const sWord10       As String = "年　　　率"      
00413  |'2004/09/10 Start                                 ||00411  |'2004/09/10 Start                                 
00414  |'Const sWord11   As String = "投資顧問料"         ||00412  |'Const sWord11   As String = "投資顧問料"         
00415  |Const sWord11a      As String = "投資顧問料"      ||00413  |Const sWord11a      As String = "投資顧問料"      
00416  |Const sWord11b      As String = "業務サービス料"  ||00414  |Const sWord11b      As String = "業務サービス料"  
00417  |Const sWord11c      As String = "名称使用許諾料"  ||00415  |Const sWord11c      As String = "名称使用許諾料"  
00418  |'2004/09/10 End                                   ||00416  |'2004/09/10 End                                   
00419  |Const sWord12       As String = "支　払　先"      ||00417  |Const sWord12       As String = "支　払　先"      
00420  |Const sWord13       As String = "支払予定日"      ||00418  |Const sWord13       As String = "支払予定日"      
00421  |Const sWord14       As String = "株式運用部"      ||00419  |Const sWord14       As String = "株式運用部"      
00422  |Const sWord15       As String = "担 当 者 印"     ||00420  |Const sWord15       As String = "担 当 者 印"     
00423  |Const sWord16       As String = "検　　印"        ||00421  |Const sWord16       As String = "検　　印"        
00424  |Const sWord17       As String = " 精　査　印"     ||00422  |Const sWord17       As String = " 精　査　印"     
00425  |Const sWord18       As String = "÷"              ||00423  |Const sWord18       As String = "÷"              
00426  |Const sWord19       As String = "："              ||00424  |Const sWord19       As String = "："              
00427  |Const sWord20       As String = " 〜 "            ||00425  |Const sWord20       As String = " 〜 "            
00428  |Const sWord21       As String = " ＝ "            ||00426  |Const sWord21       As String = " ＝ "            
00429  |Const sWord22       As String = "(消費税 "        ||00427  |Const sWord22       As String = "(消費税 "        
00430  |Const sWord23       As String = " %)"             ||00428  |Const sWord23       As String = " %)"             
00431  |Const sWord24       As String = "合 計"           ||00429  |Const sWord24       As String = "合 計"           
00432  |Const sWord25       As String = "月末"            ||00430  |Const sWord25       As String = "月末"            
00433  |Const sWord26       As String = "平均純資産総額の ||00431  |Const sWord26       As String = "平均純資産総額の 
00434  |'2005/01/12 Start                                 ||00432  |'2005/01/12 Start                                 
00435  |'Const sWord27   As String = "円までの部分 ・・・ ||00433  |'Const sWord27   As String = "円までの部分 ・・・ 
00436  |Const sWord27       As String = "までの部分 ・・・||00434  |Const sWord27       As String = "までの部分 ・・・
00437  |'2005/01/12 End                                   ||00435  |'2005/01/12 End                                   
00438  |Const sWord28       As String = "平均純資産総額の"||00436  |Const sWord28       As String = "平均純資産総額の"
00439  |'2005/01/12 Start                                 ||00437  |'2005/01/12 Start                                 
00440  |'Const sWord29   As String = "円を超えて"         ||00438  |'Const sWord29   As String = "円を超えて"         
00441  |Const sWord29       As String = "を超えて"        ||00439  |Const sWord29       As String = "を超えて"        
00442  |'2005/01/12 End                                   ||00440  |'2005/01/12 End                                   
00443  |Const sWord30       As String = "平均純資産総額の ||00441  |Const sWord30       As String = "平均純資産総額の 
00444  |'2005/01/12 Start                                 ||00442  |'2005/01/12 Start                                 
00445  |'Const sWord31   As String = "円を超える部分 ・・ ||00443  |'Const sWord31   As String = "円を超える部分 ・・ 
00446  |Const sWord31       As String = "を超える部分 ・・||00444  |Const sWord31       As String = "を超える部分 ・・
00447  |'2005/01/12 End                                   ||00445  |'2005/01/12 End                                   
00448  |                                                  ||00446  |                                                  
00449  |Const sWord32       As String = "%"               ||00447  |Const sWord32       As String = "%"               
00450  |Const sWord33       As String = "確認書"          ||00448  |Const sWord33       As String = "確認書"          
00451  |Const sWord34       As String = "年   月   日"    ||00449  |Const sWord34       As String = "年   月   日"    
00452  |Const sWord35       As String = "財　務　部"      ||00450  |Const sWord35       As String = "財　務　部"      
00453  |                                                  ||00451  |                                                  
00454  |Const sYen          As String = " 円"             ||00452  |Const sYen          As String = " 円"             
00455  |'2005/01/12 Start                                 ||00453  |'2005/01/12 Start                                 
00456  |Const sAud          As String = " Ａドル"         ||00454  |Const sAud          As String = " Ａドル"         
00457  |Const sCad          As String = " Ｃドル"         ||00455  |Const sCad          As String = " Ｃドル"         
00458  |Const sChf          As String = " Ｓフラン"       ||00456  |Const sChf          As String = " Ｓフラン"       
00459  |Const sEur          As String = " ユーロ"         ||00457  |Const sEur          As String = " ユーロ"         
00460  |Const sGbp          As String = " ポンド"         ||00458  |Const sGbp          As String = " ポンド"         
00461  |Const sHkd          As String = " ＨＫドル"       ||00459  |Const sHkd          As String = " ＨＫドル"       
00462  |Const sMyr          As String = " Ｍドル"         ||00460  |Const sMyr          As String = " Ｍドル"         
00463  |Const sNzd          As String = " ＮＺドル"       ||00461  |Const sNzd          As String = " ＮＺドル"       
00464  |Const sSek          As String = " Ｓクローネ"     ||00462  |Const sSek          As String = " Ｓクローネ"     
00465  |Const sSgd          As String = " Ｓドル"         ||00463  |Const sSgd          As String = " Ｓドル"         
00466  |Const sUsd          As String = " ＵＳドル"       ||00464  |Const sUsd          As String = " ＵＳドル"       
00467  |'2005/01/12 End                                   ||00465  |'2005/01/12 End                                   
00468  |'2005/01/21 Start                                 ||00466  |'2005/01/21 Start                                 
00469  |Const sNok          As String = " Ｎクローネ"     ||00467  |Const sNok          As String = " Ｎクローネ"     
00470  |'2005/01/21 End                                   ||00468  |'2005/01/21 End                                   
00471  |Const WordYear      As String = "年"              ||00469  |Const WordYear      As String = "年"              
00472  |Const WordMonth     As String = "月"              ||00470  |Const WordMonth     As String = "月"              
00473  |Const WordDay       As String = "日"              ||00471  |Const WordDay       As String = "日"              
00474  |'2005/01/12 Start                                 ||00472  |'2005/01/12 Start                                 
00475  |'2005/01/18 Start                                 ||00473  |'2005/01/18 Start                                 
00476  |'Const sWord36       As String = "換算元"         ||00474  |'Const sWord36       As String = "換算元"         
00477  |'Const sWord37       As String = "換算先"         ||00475  |'Const sWord37       As String = "換算先"         
00478  |'Const sWord38       As String = "(通貨)"         ||00476  |'Const sWord38       As String = "(通貨)"         
00479  |'Const sWord39       As String = "ＮＡＶ通貨"     ||00477  |'Const sWord39       As String = "ＮＡＶ通貨"     
00480  |'Const sWord40       As String = "閾値通貨"       ||00478  |'Const sWord40       As String = "閾値通貨"       
00481  |'Const sWord41       As String = "顧問料通貨"     ||00479  |'Const sWord41       As String = "顧問料通貨"     
00482  |'Const sWord42       As String = "支払通貨"       ||00480  |'Const sWord42       As String = "支払通貨"       
00483  |'2005/01/18 End                                   ||00481  |'2005/01/18 End                                   
00484  |Const sWord43       As String = "("               ||00482  |Const sWord43       As String = "("               
00485  |Const sWord44       As String = ")"               ||00483  |Const sWord44       As String = ")"               
00486  |'2005/01/18 Start                                 ||00484  |'2005/01/18 Start                                 
00487  |'Const sWord45       As String = "レート"         ||00485  |'Const sWord45       As String = "レート"         
00488  |'2005/01/18 End                                   ||00486  |'2005/01/18 End                                   
00489  |Const sWord46       As String = "支　払　額"      ||00487  |Const sWord46       As String = "支　払　額"      
00490  |Const sWordCap      As String = "上限金額："      ||00488  |Const sWordCap      As String = "上限金額："      
00491  |Const sWordFloor    As String = "下限金額："      ||00489  |Const sWordFloor    As String = "下限金額："      
00492  |'2005/01/12 End                                   ||00490  |'2005/01/12 End                                   
00493  |                                                  ||00491  |                                                  
00494  |'2005/03/09 Start                                 ||00492  |'2005/03/09 Start                                 
00495  |Const sWord47       As String = "日次NAV一覧"     ||00493  |Const sWord47       As String = "日次NAV一覧"     
00496  |Const sWord48       As String = "平　　　　　　　 ||00494  |Const sWord48       As String = "平　　　　　　　 
00497  |Const sWord49       As String = "合　　　　　　　 ||00495  |Const sWord49       As String = "合　　　　　　　 
00498  |Const sWord50       As String = "純資産総額"      ||00496  |Const sWord50       As String = "純資産総額"      
00499  |Const sWord51       As String = "平均純資産総額"  ||00497  |Const sWord51       As String = "平均純資産総額"  
00500  |'2005/03/09 End                                   ||00498  |'2005/03/09 End                                   
00501  |                                                  ||00499  |                                                  
00502  |'2005/03/18 Start                                 ||00500  |'2005/03/18 Start                                 
00503  |Const sWord52       As String = "(休日除く)"      ||00501  |Const sWord52       As String = "(休日除く)"      
00504  |'2005/03/18 End                                   ||00502  |'2005/03/18 End                                   
00505  |                                                  ||00503  |                                                  
00506  |'2006/07/14 START K.Furuya 期中料率変更契約対応   ||00504  |'2006/07/14 START K.Furuya 期中料率変更契約対応   
00507  |Const sWord53       As String = "料率変更履歴"    ||00505  |Const sWord53       As String = "料率変更履歴"    
00508  |Const sWord54       As String = "料率の変更があり ||00506  |Const sWord54       As String = "料率の変更があり 
00509  |Const sWord55       As String = "適用期間"        ||00507  |Const sWord55       As String = "適用期間"        
00510  |Const sWord56       As String = "年　　率"        ||00508  |Const sWord56       As String = "年　　率"        
00511  |Const sWord57       As String = "平均NAV"         ||00509  |Const sWord57       As String = "平均NAV"         
00512  |Const sWord58       As String = "総　合　計"      ||00510  |Const sWord58       As String = "総　合　計"      
00513  |Const sWord59       As String = "　"              ||00511  |Const sWord59       As String = "　"              
00514  |Const sWord60       As String = "-"               ||00512  |Const sWord60       As String = "-"               
00515  |Const sWord61       As String = "平均純資産"      ||00513  |Const sWord61       As String = "平均純資産"      
00516  |Const sWord62       As String = "_"               ||00514  |Const sWord62       As String = "_"               
00517  |'2006/07/14 END   K.Furuya 期中料率変更契約対応   ||00515  |'2006/07/14 END   K.Furuya 期中料率変更契約対応   
00518  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||00516  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
00519  |Const sWord63       As String = "日次時価総額一覧"||00517  |Const sWord63       As String = "日次時価総額一覧"
00520  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||00518  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
00521  |                                                  ||00519  |                                                  
00522  |'2014/02/19 START M.Takada 【管理会計】消費税率変 ||00520  |'2014/02/19 START M.Takada 【管理会計】消費税率変 
00523 L|Const sWord72       As String = "内訳書"          ||       |                                                  
00524  |Const sWordTitle    As String = "消費税額内訳書"  ||00521  |Const sWordTitle    As String = "消費税額内訳書"  
00525  |Const sWordComment  As String = "下記のとおり消費 ||00522  |Const sWordComment  As String = "下記のとおり消費 
00526  |Const sWord64       As String = "※計算期間内に消 ||00523  |Const sWord64       As String = "※計算期間内に消 
00527  |Const sWord65       As String = "　別紙｢消費税額内||00524  |Const sWord65       As String = "　別紙｢消費税額内
00528  |Const sWord66       As String = "消費税率"        ||00525  |Const sWord66       As String = "消費税率"        
00529  |Const sWord67       As String = "税率適用期間"    ||00526  |Const sWord67       As String = "税率適用期間"    
00530  |Const sWord68       As String = "支払額"          ||00527  |Const sWord68       As String = "支払額"          
00531  |Const sWord69       As String = "消費税額"        ||00528  |Const sWord69       As String = "消費税額"        
00532  |Const sWord70       As String = "合計"            ||00529  |Const sWord70       As String = "合計"            
00533  |Const sWord71       As String = "(消費税)"        ||00530  |Const sWord71       As String = "(消費税)"        
00534  |'2014/02/19 END   M.Takada 【管理会計】消費税率変 ||00531  |'2014/02/19 END   M.Takada 【管理会計】消費税率変 
00535  |                                                  ||00532  |                                                  
00536  |Const conKotei      As Integer = 1      '固定料率 ||00533  |Const conKotei      As Integer = 1      '固定料率 
00537  |Const conDankai     As Integer = 2      '段階料率 ||00534  |Const conDankai     As Integer = 2      '段階料率 
00538  |Const conFlagON     As Integer = 1      '対象締日 ||00535  |Const conFlagON     As Integer = 1      '対象締日 
00539  |Const conFlagOFF    As Integer = 0      '対象締日 ||00536  |Const conFlagOFF    As Integer = 0      '対象締日 
00540  |Const conSheetLimit As Integer = 50     '1ブックに||00537  |Const conSheetLimit As Integer = 50     '1ブックに
00541  |Const conUrudoshi   As String = "0229"  '閏年日付 ||00538  |Const conUrudoshi   As String = "0229"  '閏年日付 
00542  |Const conNoUrudoshi As String = "0228"  '非閏年日 ||00539  |Const conNoUrudoshi As String = "0228"  '非閏年日 
00543  |Const conYearDays   As Integer = 365    '1年間の日||00540  |Const conYearDays   As Integer = 365    '1年間の日
00544  |                                                  ||00541  |                                                  
00545  |'2006/08/24 START K.Furuya 期中料率変更契約対応   ||00542  |'2006/08/24 START K.Furuya 期中料率変更契約対応   
00546  |Const conSheetLastLine As Integer = 62  '料率変更 ||00543  |Const conSheetLastLine As Integer = 62  '料率変更 
00547  |'2006/08/24 END   K.Furuya 期中料率変更契約対応   ||00544  |'2006/08/24 END   K.Furuya 期中料率変更契約対応   
00548  |                                                  ||00545  |                                                  
00549  |'2005/01/12 Start                                 ||00546  |'2005/01/12 Start                                 
00550  |Const conYearDays2  As Integer = 360    '1年間の日||00547  |Const conYearDays2  As Integer = 360    '1年間の日
00551  |Const cAud          As String = "AUD"             ||00548  |Const cAud          As String = "AUD"             
00552  |Const cCad          As String = "CAD"             ||00549  |Const cCad          As String = "CAD"             
00553  |Const cChf          As String = "CHF"             ||00550  |Const cChf          As String = "CHF"             
00554  |Const cEur          As String = "EUR"             ||00551  |Const cEur          As String = "EUR"             
00555  |Const cGbp          As String = "GBP"             ||00552  |Const cGbp          As String = "GBP"             
00556  |Const cHkd          As String = "HKD"             ||00553  |Const cHkd          As String = "HKD"             
00557  |Const cJpy          As String = "JPY"             ||00554  |Const cJpy          As String = "JPY"             
00558  |Const cMyr          As String = "MYR"             ||00555  |Const cMyr          As String = "MYR"             
00559  |Const cNzd          As String = "NZD"             ||00556  |Const cNzd          As String = "NZD"             
00560  |Const cSek          As String = "SEK"             ||00557  |Const cSek          As String = "SEK"             
00561  |Const cSgd          As String = "SGD"             ||00558  |Const cSgd          As String = "SGD"             
00562  |Const cUsd          As String = "USD"             ||00559  |Const cUsd          As String = "USD"             
00563  |'2005/01/12 End                                   ||00560  |'2005/01/12 End                                   
00564  |'2005/01/21 Start                                 ||00561  |'2005/01/21 Start                                 
00565  |Const cNok          As String = "NOK"             ||00562  |Const cNok          As String = "NOK"             
00566  |'2005/01/21 End                                   ||00563  |'2005/01/21 End                                   
00567  |                                                  ||00564  |                                                  
00568  |Const conColSysOutbln         As Integer = 1  '出 ||00565  |Const conColSysOutbln         As Integer = 1  '出 
00569  |                                                  ||00566  |                                                  
00570  |'2005/07/25 Start                                 ||00567  |'2005/07/25 Start                                 
00571  |Const conColEnglishbln        As Integer = 2  '英 ||00568  |Const conColEnglishbln        As Integer = 2  '英 
00572  |'2005/07/25 End                                   ||00569  |'2005/07/25 End                                   
00573  |                                                  ||00570  |                                                  
00574  |'2004/12/29 Start                                 ||00571  |'2004/12/29 Start                                 
00575  |'Const conColPayMentDate As Integer = 16 '支払予定||00572  |'Const conColPayMentDate As Integer = 16 '支払予定
00576  |'2005/07/25 Start                                 ||00573  |'2005/07/25 Start                                 
00577  |'Const conColPayMentDate       As Integer = 19 '支||00574  |'Const conColPayMentDate       As Integer = 19 '支
00578  |'2005/07/25 End                                   ||00575  |'2005/07/25 End                                   
00579  |Const conColPayMentDate       As Integer = 22 '支 ||00576  |Const conColPayMentDate       As Integer = 22 '支 
00580  |'2004/12/29 End                                   ||00577  |'2004/12/29 End                                   
00581  |'2005/01/17 Start                                 ||00578  |'2005/01/17 Start                                 
00582  |''2005/01/11 Start                                ||00579  |''2005/01/11 Start                                
00583  |'Const conColOtherRateRuleFlag As Integer = 15 '外||00580  |'Const conColOtherRateRuleFlag As Integer = 15 '外
00584  |'Const conColNavAmount         As Integer = 23 'NA||00581  |'Const conColNavAmount         As Integer = 23 'NA
00585  |'Const conColNavCom            As Integer = 24 'NA||00582  |'Const conColNavCom            As Integer = 24 'NA
00586  |'Const conColAmountCom         As Integer = 25 '閾||00583  |'Const conColAmountCom         As Integer = 25 '閾
00587  |'Const conColComPay            As Integer = 26 '顧||00584  |'Const conColComPay            As Integer = 26 '顧
00588  |''2005/01/11 End                                  ||00585  |''2005/01/11 End                                  
00589  |'2005/01/17 End                                   ||00586  |'2005/01/17 End                                   
00590  |'2005/01/18 Start                                 ||00587  |'2005/01/18 Start                                 
00591  |''2005/01/14 Start                                ||00588  |''2005/01/14 Start                                
00592  |'Const conColNavCurrencyCode      As Integer = 20 ||00589  |'Const conColNavCurrencyCode      As Integer = 20 
00593  |'Const conColAmountCurrencyCode   As Integer = 21 ||00590  |'Const conColAmountCurrencyCode   As Integer = 21 
00594  |'Const conColOtherComCurrencyCode As Integer = 22 ||00591  |'Const conColOtherComCurrencyCode As Integer = 22 
00595  |''2005/01/14 End                                  ||00592  |''2005/01/14 End                                  
00596  |'2005/01/18 End                                   ||00593  |'2005/01/18 End                                   
00597  |'2008/03/12 START ファンド決算期間での外部委託顧問||00594  |'2008/03/12 START ファンド決算期間での外部委託顧問
00598  |Const conColFndCalcFrom       As Integer = 28 'フ ||00595  |Const conColFndCalcFrom       As Integer = 28 'フ 
00599  |Const conColFndCalcTo         As Integer = 29 'フ ||00596  |Const conColFndCalcTo         As Integer = 29 'フ 
00600  |'2008/03/12 END   ファンド決算期間での外部委託顧問||00597  |'2008/03/12 END   ファンド決算期間での外部委託顧問
00601  |                                                  ||00598  |                                                  
00602  |                                                  ||00599  |                                                  
00603  |                                                  ||00600  |                                                  
00604  |                                                  ||00601  |                                                  
00605  |'2005/07/29 Start                                 ||00602  |'2005/07/29 Start                                 
00606  |'英文用確認書作成対応の為Const定義されている定数（||00603  |'英文用確認書作成対応の為Const定義されている定数（
00607  |                                                  ||00604  |                                                  
00608  |'Const定義                                        ||00605  |'Const定義                                        
00609  |Const sWord0d       As String = "Details of Adviso||00606  |Const sWord0d       As String = "Details of Adviso
00610  |Const sWord0e       As String = "Details of Servic||00607  |Const sWord0e       As String = "Details of Servic
00611  |Const sWord0f       As String = "Details of Licens||00608  |Const sWord0f       As String = "Details of Licens
00612  |Const sWord1a       As String = "Nomura Asset Mana||00609  |Const sWord1a       As String = "Nomura Asset Mana
00613  |Const sWord2a       As String = "Treasury & Contro||00610  |Const sWord2a       As String = "Treasury & Contro
00614  |'2006/08/18 START                                 ||00611  |'2006/08/18 START                                 
00615  |'Const sWord3d       As String = "Please confirm t||00612  |'Const sWord3d       As String = "Please confirm t
00616  |'Const sWord3e       As String = "Please confirm t||00613  |'Const sWord3e       As String = "Please confirm t
00617  |'Const sWord3f       As String = "Please confirm t||00614  |'Const sWord3f       As String = "Please confirm t
00618  |Const sWord3d       As String = "We would like to ||00615  |Const sWord3d       As String = "We would like to 
00619  |Const sWord3e       As String = "We would like to ||00616  |Const sWord3e       As String = "We would like to 
00620  |Const sWord3f       As String = "We would like to ||00617  |Const sWord3f       As String = "We would like to 
00621  |'2006/08/18 END                                   ||00618  |'2006/08/18 END                                   
00622  |Const sWord4a       As String = "Fund Name"       ||00619  |Const sWord4a       As String = "Fund Name"       
00623  |Const sWord4_2a     As String = "Fund Code"       ||00620  |Const sWord4_2a     As String = "Fund Code"       
00624  |'2006/08/18 START                                 ||00621  |'2006/08/18 START                                 
00625  |'Const sWord5a       As String = "Cover Period"   ||00622  |'Const sWord5a       As String = "Cover Period"   
00626  |'Const sWord6a       As String = "End of Month Net||00623  |'Const sWord6a       As String = "End of Month Net
00627  |Const sWord5a       As String = "Calculation Perio||00624  |Const sWord5a       As String = "Calculation Perio
00628  |Const sWord6a       As String = "Month-end Net Ass||00625  |Const sWord6a       As String = "Month-end Net Ass
00629  |'2006/08/18 END                                   ||00626  |'2006/08/18 END                                   
00630  |Const sWord7a       As String = "DATE"            ||00627  |Const sWord7a       As String = "DATE"            
00631  |Const sWord8a       As String = "Net Asset Value" ||00628  |Const sWord8a       As String = "Net Asset Value" 
00632  |Const sWord9a       As String = "Amount"          ||00629  |Const sWord9a       As String = "Amount"          
00633  |'2006/08/18 START                                 ||00630  |'2006/08/18 START                                 
00634  |'Const sWord10a      As String = "Advisory Rate"  ||00631  |'Const sWord10a      As String = "Advisory Rate"  
00635  |Const sWord10a      As String = "Annual Rate"     ||00632  |Const sWord10a      As String = "Annual Rate"     
00636  |'2006/08/18 END                                   ||00633  |'2006/08/18 END                                   
00637  |Const sWord11d      As String = "Advisory Fee"    ||00634  |Const sWord11d      As String = "Advisory Fee"    
00638  |Const sWord11e      As String = "Service Fee"     ||00635  |Const sWord11e      As String = "Service Fee"     
00639  |Const sWord11f      As String = "License Fee"     ||00636  |Const sWord11f      As String = "License Fee"     
00640  |Const sWord12a      As String = "Company"         ||00637  |Const sWord12a      As String = "Company"         
00641  |Const sWord13a      As String = "Payment Date"    ||00638  |Const sWord13a      As String = "Payment Date"    
00642  |'Const sWord14a      As String = "株式運用部(英語)||00639  |'Const sWord14a      As String = "株式運用部(英語)
00643  |'Const sWord15a      As String = "担 当 者 印(英語||00640  |'Const sWord15a      As String = "担 当 者 印(英語
00644  |'Const sWord16a      As String = "検　　印(英語)" ||00641  |'Const sWord16a      As String = "検　　印(英語)" 
00645  |'Const sWord17a       As String = " 精　査　印(英 ||00642  |'Const sWord17a       As String = " 精　査　印(英 
00646  |'Const sWord18       As String = "÷"             ||00643  |'Const sWord18       As String = "÷"             
00647  |'Const sWord19       As String = "："             ||00644  |'Const sWord19       As String = "："             
00648  |'Const sWord20       As String = " 〜 "           ||00645  |'Const sWord20       As String = " 〜 "           
00649  |'Const sWord21       As String = " ＝ "           ||00646  |'Const sWord21       As String = " ＝ "           
00650  |Const sWord22a       As String = "(Tax "          ||00647  |Const sWord22a       As String = "(Tax "          
00651  |'Const sWord23       As String = " %)"            ||00648  |'Const sWord23       As String = " %)"            
00652  |Const sWord24a       As String = "Amount"         ||00649  |Const sWord24a       As String = "Amount"         
00653  |Const sWord25a       As String = "月末(英語)"     ||00650  |Const sWord25a       As String = "月末(英語)"     
00654  |Const sWord26a       As String = "The First "     ||00651  |Const sWord26a       As String = "The First "     
00655  |Const sWord27a       As String = " of the Avarage ||00652  |Const sWord27a       As String = " of the Avarage 
00656  |Const sWord28a       As String = "The amount of Av||00653  |Const sWord28a       As String = "The amount of Av
00657  |Const sWord29a       As String = " and up to "    ||00654  |Const sWord29a       As String = " and up to "    
00658  |Const sWord30a       As String = " of the Average ||00655  |Const sWord30a       As String = " of the Average 
00659  |'Const sWord31a       As String = "を超える部分 ・||00656  |'Const sWord31a       As String = "を超える部分 ・
00660  |'Const sWord32       As String = "%"              ||00657  |'Const sWord32       As String = "%"              
00661  |Const sWord33a       As String = "確認書(英語)"   ||00658  |Const sWord33a       As String = "確認書(英語)"   
00662  |Const sWord34a       As String = "年   月   日(英 ||00659  |Const sWord34a       As String = "年   月   日(英 
00663  |'Const sWord35a       As String = "財　務　部(英語||00660  |'Const sWord35a       As String = "財　務　部(英語
00664  |Const sYena          As String = " Japanese yen"  ||00661  |Const sYena          As String = " Japanese yen"  
00665  |Const sAuda          As String = " AUD"           ||00662  |Const sAuda          As String = " AUD"           
00666  |Const sCada          As String = " CAD"           ||00663  |Const sCada          As String = " CAD"           
00667  |Const sChfa          As String = " CHF"           ||00664  |Const sChfa          As String = " CHF"           
00668  |Const sEura          As String = " EUR"           ||00665  |Const sEura          As String = " EUR"           
00669  |Const sGbpa          As String = " GBP"           ||00666  |Const sGbpa          As String = " GBP"           
00670  |Const sHkda          As String = " HKD"           ||00667  |Const sHkda          As String = " HKD"           
00671  |Const sMyra          As String = " MYR"           ||00668  |Const sMyra          As String = " MYR"           
00672  |Const sNzda          As String = " NZD"           ||00669  |Const sNzda          As String = " NZD"           
00673  |Const sSeka          As String = " SEK"           ||00670  |Const sSeka          As String = " SEK"           
00674  |Const sSgda          As String = " SGD"           ||00671  |Const sSgda          As String = " SGD"           
00675  |Const sUsda          As String = " USD"           ||00672  |Const sUsda          As String = " USD"           
00676  |Const sNoka          As String = " NOK"           ||00673  |Const sNoka          As String = " NOK"           
00677  |'Const WordYeara      As String = "年(英語)"      ||00674  |'Const WordYeara      As String = "年(英語)"      
00678  |'Const WordMontha     As String = "月(英語)"      ||00675  |'Const WordMontha     As String = "月(英語)"      
00679  |Const WordDaya       As String = "days"           ||00676  |Const WordDaya       As String = "days"           
00680  |'Const sWord43       As String = "("              ||00677  |'Const sWord43       As String = "("              
00681  |'Const sWord44       As String = ")"              ||00678  |'Const sWord44       As String = ")"              
00682  |'2006/08/18 START                                 ||00679  |'2006/08/18 START                                 
00683  |'Const sWord46a       As String = "Calculation"   ||00680  |'Const sWord46a       As String = "Calculation"   
00684  |Const sWord46a       As String = "Amount payable" ||00681  |Const sWord46a       As String = "Amount payable" 
00685  |'2006/08/18 END                                   ||00682  |'2006/08/18 END                                   
00686  |Const sWordCapa      As String = "Cap："          ||00683  |Const sWordCapa      As String = "Cap："          
00687  |Const sWordFloora    As String = "Floor："        ||00684  |Const sWordFloora    As String = "Floor："        
00688  |Const sWord47a       As String = "Daily NAV"      ||00685  |Const sWord47a       As String = "Daily NAV"      
00689  |Const sWord48a       As String = "AVERAGE"        ||00686  |Const sWord48a       As String = "AVERAGE"        
00690  |Const sWord49a       As String = "AMOUNT"         ||00687  |Const sWord49a       As String = "AMOUNT"         
00691  |Const sWord50a       As String = "Total NAV"      ||00688  |Const sWord50a       As String = "Total NAV"      
00692  |Const sWord51a       As String = "Average Net Asse||00689  |Const sWord51a       As String = "Average Net Asse
00693  |Const sWord52a       As String = "(each business d||00690  |Const sWord52a       As String = "(each business d
00694  |'2006/08/18 START 文言追加                        ||00691  |'2006/08/18 START 文言追加                        
00695  |Const sWord53a       As String = "Please refer to ||00692  |Const sWord53a       As String = "Please refer to 
00696  |Const sWord54a       As String = "Advice of change||00693  |Const sWord54a       As String = "Advice of change
00697  |Const sWord55a       As String = "Service of chang||00694  |Const sWord55a       As String = "Service of chang
00698  |Const sWord56a       As String = "License of chang||00695  |Const sWord56a       As String = "License of chang
00699  |Const sWord57a       As String = "Calculation Peri||00696  |Const sWord57a       As String = "Calculation Peri
00700  |Const sWord58a       As String = "AVERAGE NAV"    ||00697  |Const sWord58a       As String = "AVERAGE NAV"    
00701  |Const sWord59a       As String = "Cover Period"   ||00698  |Const sWord59a       As String = "Cover Period"   
00702  |Const sWord60a       As String = "料率変更履歴(英 ||00699  |Const sWord60a       As String = "料率変更履歴(英 
00703  |Const sWord61a       As String = "(英語)"         ||00700  |Const sWord61a       As String = "(英語)"         
00704  |Const sWord62a       As String = "Period Covered" ||00701  |Const sWord62a       As String = "Period Covered" 
00705  |'2006/08/18 END   文言追加                        ||00702  |'2006/08/18 END   文言追加                        
00706  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||00703  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
00707  |Const sWord63a       As String = "Month-end Market||00704  |Const sWord63a       As String = "Month-end Market
00708  |Const sWord64a       As String = "Market Value"   ||00705  |Const sWord64a       As String = "Market Value"   
00709  |Const sWord65a       As String = " of the Avarage ||00706  |Const sWord65a       As String = " of the Avarage 
00710  |Const sWord66a       As String = "The amount of Av||00707  |Const sWord66a       As String = "The amount of Av
00711  |Const sWord67a       As String = " of the Average ||00708  |Const sWord67a       As String = " of the Average 
00712  |Const sWord68a       As String = "Daily Market Val||00709  |Const sWord68a       As String = "Daily Market Val
00713  |Const sWord69a       As String = "Total Market Val||00710  |Const sWord69a       As String = "Total Market Val
00714  |Const sWord70a       As String = "Average Market V||00711  |Const sWord70a       As String = "Average Market V
00715  |Const sWord71a       As String = "AVERAGE MARKET V||00712  |Const sWord71a       As String = "AVERAGE MARKET V
00716  |                                                  ||00713  |                                                  
00717  |'2005/08/03 確認書一覧出力データ バッチ起動用に新 ||00714  |'2005/08/03 確認書一覧出力データ バッチ起動用に新 
00718  |Private Declare Function OpenProcess Lib "kernel32||00715  |Private Declare Function OpenProcess Lib "kernel32
00719  |Private Const SYNCHRONIZE = &H100000              ||00716  |Private Const SYNCHRONIZE = &H100000              
00720  |Private Declare Function WaitForSingleObject Lib "||00717  |Private Declare Function WaitForSingleObject Lib "
00721  |Private Const INFINITE = &HFFFF      '  Infinite t||00718  |Private Const INFINITE = &HFFFF      '  Infinite t
00722  |Private Declare Function CloseHandle Lib "kernel32||00719  |Private Declare Function CloseHandle Lib "kernel32
00723  |                                                  ||00720  |                                                  
00724  |'=================================================||00721  |'=================================================
00725  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fncOtherRealComUpdateInsert  ||00722  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fncOtherRealComUpdateInsert  
00726  |'機能            :   外部委託顧問料実払管理テーブ ||00723  |'機能            :   外部委託顧問料実払管理テーブ 
00727  |'                                                 ||00724  |'                                                 
00728  |'                                                 ||00725  |'                                                 
00729  |'日付               担当　              修正内容  ||00726  |'日付               担当　              修正内容  
00730  |'-------------------------------------------------||00727  |'-------------------------------------------------
00731  |'2006/04/10         K.Furuya<SRA>      新規作成   ||00728  |'2006/04/10         K.Furuya<SRA>      新規作成   
00732  |'2006/07/28         K.Furuya<SRA>      期中料率変 ||00729  |'2006/07/28         K.Furuya<SRA>      期中料率変 
00733  |'2008/10/15         K.Nishihama<SRA>   財務会計帳 ||00730  |'2008/10/15         K.Nishihama<SRA>   財務会計帳 
00734  |'=================================================||00731  |'=================================================
00735  |Private Function fncOtherRealComUpdateInsert(strCo||00732  |Private Function fncOtherRealComUpdateInsert(strCo
00736  |        strSettlement_Date As String, _           ||00733  |        strSettlement_Date As String, _           
00737  |        strOther_Cur_Code As String, _            ||00734  |        strOther_Cur_Code As String, _            
00738  |        strFix_Com_c As String, _                 ||00735  |        strFix_Com_c As String, _                 
00739  |        strFix_Com_j As String, _                 ||00736  |        strFix_Com_j As String, _                 
00740  |        strReal_Com_c As String, _                ||00737  |        strReal_Com_c As String, _                
00741  |        strReal_Com_j As String _                 ||00738  |        strReal_Com_j As String _                 
00742  |        ) As Integer                              ||00739  |        ) As Integer                              
00743  |                                                  ||00740  |                                                  
00744  |    Dim strSQL              As String             ||00741  |    Dim strSQL              As String             
00745  |    Dim WkContractNo        As String             ||00742  |    Dim WkContractNo        As String             
00746  |    Dim WkBaseMonth         As String             ||00743  |    Dim WkBaseMonth         As String             
00747  |    Dim WkCurCode           As String             ||00744  |    Dim WkCurCode           As String             
00748  |    Dim WkSettlementDate    As String             ||00745  |    Dim WkSettlementDate    As String             
00749  |    Dim WkFixComFlag        As String             ||00746  |    Dim WkFixComFlag        As String             
00750  |    Dim WkFixComC           As String             ||00747  |    Dim WkFixComC           As String             
00751  |    Dim WkFixComJ           As String             ||00748  |    Dim WkFixComJ           As String             
00752  |    Dim WkRealComFlag       As String             ||00749  |    Dim WkRealComFlag       As String             
00753  |    Dim WkRealComC          As String             ||00750  |    Dim WkRealComC          As String             
00754  |    Dim WkRealComJ          As String             ||00751  |    Dim WkRealComJ          As String             
00755  |    Dim WkRetRealComC       As String             ||00752  |    Dim WkRetRealComC       As String             
00756  |    Dim WkRetRealComJ       As String             ||00753  |    Dim WkRetRealComJ       As String             
00757  |    Dim WkFixCalcComYM      As String             ||00754  |    Dim WkFixCalcComYM      As String             
00758  |    Dim WkSettFixFlag       As String             ||00755  |    Dim WkSettFixFlag       As String             
00759  |    Dim blnret              As Boolean            ||00756  |    Dim blnret              As Boolean            
00760  |    Dim ErrorMsg            As String             ||00757  |    Dim ErrorMsg            As String             
00761  |    Dim strAsset_T_Cd       As String             ||00758  |    Dim strAsset_T_Cd       As String             
00762  |                                                  ||00759  |                                                  
00763  |    Dim uOtherRealComUPD    As tycfr_other_real_co||00760  |    Dim uOtherRealComUPD    As tycfr_other_real_co
00764  |                                                  ||00761  |                                                  
00765  |    fncOtherRealComUpdateInsert = -1              ||00762  |    fncOtherRealComUpdateInsert = -1              
00766  |                                                  ||00763  |                                                  
00767  |    'SQL文生成                                    ||00764  |    'SQL文生成                                    
00768  |    strSQL = ""                                   ||00765  |    strSQL = ""                                   
00769  |    strSQL = strSQL & "SELECT "                   ||00766  |    strSQL = strSQL & "SELECT "                   
00770  |    strSQL = strSQL & "    COM1.CONTRACT_NO,"     ||00767  |    strSQL = strSQL & "    COM1.CONTRACT_NO,"     
00771  |    strSQL = strSQL & "    COM1.BASE_MONTH,"      ||00768  |    strSQL = strSQL & "    COM1.BASE_MONTH,"      
00772  |    strSQL = strSQL & "    COM1.SETTLEMENT_DATE," ||00769  |    strSQL = strSQL & "    COM1.SETTLEMENT_DATE," 
00773  |    strSQL = strSQL & "    COM1.OTHER_CURRENCY_COD||00770  |    strSQL = strSQL & "    COM1.OTHER_CURRENCY_COD
00774  |    strSQL = strSQL & "    COM1.FIX_COM_FLAG,"    ||00771  |    strSQL = strSQL & "    COM1.FIX_COM_FLAG,"    
00775  |    strSQL = strSQL & "    COM1.FIX_COM_CALC_MONTH||00772  |    strSQL = strSQL & "    COM1.FIX_COM_CALC_MONTH
00776  |    strSQL = strSQL & "    COM1.FIX_COM_DATE,"    ||00773  |    strSQL = strSQL & "    COM1.FIX_COM_DATE,"    
00777  |    strSQL = strSQL & "    COM1.REAL_COM_FLAG,"   ||00774  |    strSQL = strSQL & "    COM1.REAL_COM_FLAG,"   
00778  |    strSQL = strSQL & "    COM1.FIX_COM_C,"       ||00775  |    strSQL = strSQL & "    COM1.FIX_COM_C,"       
00779  |    strSQL = strSQL & "    COM1.FIX_COM_J,"       ||00776  |    strSQL = strSQL & "    COM1.FIX_COM_J,"       
00780  |    strSQL = strSQL & "    COM3.SETT_FIX_FLAG,"   ||00777  |    strSQL = strSQL & "    COM3.SETT_FIX_FLAG,"   
00781  |    strSQL = strSQL & "    COM2.INVALID_FLAG"     ||00778  |    strSQL = strSQL & "    COM2.INVALID_FLAG"     
00782  |    strSQL = strSQL & " FROM CFR_OTHER_REAL_COM_TB||00779  |    strSQL = strSQL & " FROM CFR_OTHER_REAL_COM_TB
00783  |    strSQL = strSQL & "      CFR_CONTRACT_TBL COM2||00780  |    strSQL = strSQL & "      CFR_CONTRACT_TBL COM2
00784  |    strSQL = strSQL & "      CFR_OTHER_COM_RULE_TB||00781  |    strSQL = strSQL & "      CFR_OTHER_COM_RULE_TB
00785  |    strSQL = strSQL & " WHERE COM1.CONTRACT_NO = C||00782  |    strSQL = strSQL & " WHERE COM1.CONTRACT_NO = C
00786  |    strSQL = strSQL & "       COM1.CONTRACT_NO = C||00783  |    strSQL = strSQL & "       COM1.CONTRACT_NO = C
00787  |'2006/07/28 START K.Furuya 期中料率変更契約/RAFI対||00784  |'2006/07/28 START K.Furuya 期中料率変更契約/RAFI対
00788  |'    strSQL = strSQL & "       COM3.INVALID_FLAG =||00785  |'    strSQL = strSQL & "       COM3.INVALID_FLAG =
00789  |    strSQL = strSQL & "       (COM3.START_DATE <= ||00786  |    strSQL = strSQL & "       (COM3.START_DATE <= 
00790  |    strSQL = strSQL & "        '" & strSettlement_||00787  |    strSQL = strSQL & "        '" & strSettlement_
00791  |'2006/07/28 END   K.Furuya 期中料率変更契約/RAFI対||00788  |'2006/07/28 END   K.Furuya 期中料率変更契約/RAFI対
00792  |    strSQL = strSQL & "       COM1.CONTRACT_NO = '||00789  |    strSQL = strSQL & "       COM1.CONTRACT_NO = '
00793  |    strSQL = strSQL & "       COM1.SETTLEMENT_DATE||00790  |    strSQL = strSQL & "       COM1.SETTLEMENT_DATE
00794  |    'SQL実行                                      ||00791  |    'SQL実行                                      
00795  |    If (gintDyCreate(strSQL) = False) Then        ||00792  |    If (gintDyCreate(strSQL) = False) Then        
00796  |        Call subError("DBエラー", Str(9999), "gint||00793  |        Call subError("DBエラー", Str(9999), "gint
00797  |            "DB関数エラー", strErrCall, conTitle) ||00794  |            "DB関数エラー", strErrCall, conTitle) 
00798  |        GoTo ErrExit                              ||00795  |        GoTo ErrExit                              
00799  |    End If                                        ||00796  |    End If                                        
00800  |    '外部委託顧問料契約属性が無効の場合実払管理テ ||00797  |    '外部委託顧問料契約属性が無効の場合実払管理テ 
00801  |    If Not gblnDyEOF() Then                       ||00798  |    If Not gblnDyEOF() Then                       
00802  |        If Trim(gvlnDyDataS("invalid_flag")) = "1"||00799  |        If Trim(gvlnDyDataS("invalid_flag")) = "1"
00803  |            '更新なし                             ||00800  |            '更新なし                             
00804  |            fncOtherRealComUpdateInsert = 0       ||00801  |            fncOtherRealComUpdateInsert = 0       
00805  |            Exit Function                         ||00802  |            Exit Function                         
00806  |        End If                                    ||00803  |        End If                                    
00807  |    End If                                        ||00804  |    End If                                        
00808  |                                                  ||00805  |                                                  
00809  |    If gblnDyEOF() Then                           ||00806  |    If gblnDyEOF() Then                           
00810  |    'Insert実行                                   ||00807  |    'Insert実行                                   
00811  |                                                  ||00808  |                                                  
00812  |        'SQL文生成                                ||00809  |        'SQL文生成                                
00813  |        strSQL = ""                               ||00810  |        strSQL = ""                               
00814  |        strSQL = strSQL & "SELECT "               ||00811  |        strSQL = strSQL & "SELECT "               
00815  |        strSQL = strSQL & "    COM1.CONTRACT_NO," ||00812  |        strSQL = strSQL & "    COM1.CONTRACT_NO," 
00816  |        strSQL = strSQL & "    COM2.SETT_FIX_FLAG,||00813  |        strSQL = strSQL & "    COM2.SETT_FIX_FLAG,
00817  |        strSQL = strSQL & "    COM1.INVALID_FLAG" ||00814  |        strSQL = strSQL & "    COM1.INVALID_FLAG" 
00818  |        strSQL = strSQL & " FROM CFR_CONTRACT_TBL ||00815  |        strSQL = strSQL & " FROM CFR_CONTRACT_TBL 
00819  |        strSQL = strSQL & "      CFR_OTHER_COM_RUL||00816  |        strSQL = strSQL & "      CFR_OTHER_COM_RUL
00820  |        strSQL = strSQL & " WHERE COM1.CONTRACT_NO||00817  |        strSQL = strSQL & " WHERE COM1.CONTRACT_NO
00821  |'2006/07/28 START K.Furuya 期中料率変更契約/RAFI対||00818  |'2006/07/28 START K.Furuya 期中料率変更契約/RAFI対
00822  |'        strSQL = strSQL & "       COM2.INVALID_FL||00819  |'        strSQL = strSQL & "       COM2.INVALID_FL
00823  |        strSQL = strSQL & "       (COM2.START_DATE||00820  |        strSQL = strSQL & "       (COM2.START_DATE
00824  |        strSQL = strSQL & "        '" & strSettlem||00821  |        strSQL = strSQL & "        '" & strSettlem
00825  |'2006/07/28 END   K.Furuya 期中料率変更契約/RAFI対||00822  |'2006/07/28 END   K.Furuya 期中料率変更契約/RAFI対
00826  |        strSQL = strSQL & "       COM1.CONTRACT_NO||00823  |        strSQL = strSQL & "       COM1.CONTRACT_NO
00827  |                                                  ||00824  |                                                  
00828  |        If gintDyCreate(strSQL) = False Then      ||00825  |        If gintDyCreate(strSQL) = False Then      
00829  |            GoTo ErrExit                          ||00826  |            GoTo ErrExit                          
00830  |        End If                                    ||00827  |        End If                                    
00831  |                                                  ||00828  |                                                  
00832  |        '外部委託顧問料契約属性が無効の場合実払管 ||00829  |        '外部委託顧問料契約属性が無効の場合実払管 
00833  |        If Trim(gvlnDyDataS("invalid_flag")) = "1"||00830  |        If Trim(gvlnDyDataS("invalid_flag")) = "1"
00834  |            '更新なし                             ||00831  |            '更新なし                             
00835  |            fncOtherRealComUpdateInsert = 0       ||00832  |            fncOtherRealComUpdateInsert = 0       
00836  |            Exit Function                         ||00833  |            Exit Function                         
00837  |        End If                                    ||00834  |        End If                                    
00838  |                                                  ||00835  |                                                  
00839  |'''''''''''''''''''''2008/10/15 START K.Nishihama ||00836  |'''''''''''''''''''''2008/10/15 START K.Nishihama 
00840  |'''''''''''''''''''''確定額反映月の設定をやめる　 ||00837  |'''''''''''''''''''''確定額反映月の設定をやめる　 
00841  |'''''''''''''''''''''        WkSettFixFlag = Trim(||00838  |'''''''''''''''''''''        WkSettFixFlag = Trim(
00842  |'''''''''''''''''''''        If WkSettFixFlag = "1||00839  |'''''''''''''''''''''        If WkSettFixFlag = "1
00843  |'''''''''''''''''''''            WkFixCalcComYM = ||00840  |'''''''''''''''''''''            WkFixCalcComYM = 
00844  |'''''''''''''''''''''            WkBaseMonth = Mid||00841  |'''''''''''''''''''''            WkBaseMonth = Mid
00845  |'''''''''''''''''''''        Else                 ||00842  |'''''''''''''''''''''        Else                 
00846  |'''''''''''''''''''''            '確定顧問料計算済||00843  |'''''''''''''''''''''            '確定顧問料計算済
00847  |'''''''''''''''''''''            strSQL = ""      ||00844  |'''''''''''''''''''''            strSQL = ""      
00848  |'''''''''''''''''''''            strSQL = strSQL &||00845  |'''''''''''''''''''''            strSQL = strSQL &
00849  |'''''''''''''''''''''            strSQL = strSQL &||00846  |'''''''''''''''''''''            strSQL = strSQL &
00850  |'''''''''''''''''''''            strSQL = strSQL &||00847  |'''''''''''''''''''''            strSQL = strSQL &
00851  |'''''''''''''''''''''            strSQL = strSQL &||00848  |'''''''''''''''''''''            strSQL = strSQL &
00852  |'''''''''''''''''''''                             ||00849  |'''''''''''''''''''''                             
00853  |'''''''''''''''''''''            If gintDyCreate(s||00850  |'''''''''''''''''''''            If gintDyCreate(s
00854  |'''''''''''''''''''''                GoTo ErrExit ||00851  |'''''''''''''''''''''                GoTo ErrExit 
00855  |'''''''''''''''''''''            End If           ||00852  |'''''''''''''''''''''            End If           
00856  |'''''''''''''''''''''            '確定顧問料計算済||00853  |'''''''''''''''''''''            '確定顧問料計算済
00857  |'''''''''''''''''''''            WkFixCalcComYM = ||00854  |'''''''''''''''''''''            WkFixCalcComYM = 
00858  |'''''''''''''''''''''            '基準月をセット  ||00855  |'''''''''''''''''''''            '基準月をセット  
00859  |'''''''''''''''''''''            WkBaseMonth = Tri||00856  |'''''''''''''''''''''            WkBaseMonth = Tri
00860  |'''''''''''''''''''''        End If               ||00857  |'''''''''''''''''''''        End If               
00861  |'''''''''''''''''''''確定額反映月の設定をやめる　 ||00858  |'''''''''''''''''''''確定額反映月の設定をやめる　 
00862  |'''''''''''''''''''''2008/10/15 END K.Nishihama 財||00859  |'''''''''''''''''''''2008/10/15 END K.Nishihama 財
00863  |                                                  ||00860  |                                                  
00864  |'2008/10/15 START K.Nishihama 財務会計帳票対応    ||00861  |'2008/10/15 START K.Nishihama 財務会計帳票対応    
00865  |'上記をコメントした代わりに追加　★★★           ||00862  |'上記をコメントした代わりに追加　★★★           
00866  |'（基準月を生成）                                 ||00863  |'（基準月を生成）                                 
00867  |        WkSettFixFlag = Trim(gvlnDyDataS("SETT_FIX||00864  |        WkSettFixFlag = Trim(gvlnDyDataS("SETT_FIX
00868  |        If WkSettFixFlag = "1" Then               ||00865  |        If WkSettFixFlag = "1" Then               
00869  |            WkBaseMonth = Mid(Trim(strSettlement_D||00866  |            WkBaseMonth = Mid(Trim(strSettlement_D
00870  |        Else                                      ||00867  |        Else                                      
00871  |            'BaseMonthに設定する基準月は締め日+1日||00868  |            'BaseMonthに設定する基準月は締め日+1日
00872  |            Dim WkSettlementYear      As String   ||00869  |            Dim WkSettlementYear      As String   
00873  |            Dim WkSettlementMonth     As String   ||00870  |            Dim WkSettlementMonth     As String   
00874  |            Dim WkSettlementDay       As String   ||00871  |            Dim WkSettlementDay       As String   
00875  |            Dim WkSettlementYMD       As String   ||00872  |            Dim WkSettlementYMD       As String   
00876  |            Dim WkSettlementNextYMD   As String   ||00873  |            Dim WkSettlementNextYMD   As String   
00877  |                                                  ||00874  |                                                  
00878  |            WkSettlementYear = Mid(Trim(strSettlem||00875  |            WkSettlementYear = Mid(Trim(strSettlem
00879  |            WkSettlementMonth = Mid(Trim(strSettle||00876  |            WkSettlementMonth = Mid(Trim(strSettle
00880  |            WkSettlementDay = Mid(Trim(strSettleme||00877  |            WkSettlementDay = Mid(Trim(strSettleme
00881  |            WkSettlementYMD = WkSettlementYear & "||00878  |            WkSettlementYMD = WkSettlementYear & "
00882  |            WkSettlementNextYMD = DateAdd("d", 1, ||00879  |            WkSettlementNextYMD = DateAdd("d", 1, 
00883  |            WkBaseMonth = Mid(WkSettlementNextYMD,||00880  |            WkBaseMonth = Mid(WkSettlementNextYMD,
00884  |        End If                                    ||00881  |        End If                                    
00885  |'上記をコメントした代わりに追加　★★★           ||00882  |'上記をコメントした代わりに追加　★★★           
00886  |'2008/10/15 END K.Nishihama 財務会計帳票対応      ||00883  |'2008/10/15 END K.Nishihama 財務会計帳票対応      
00887  |                                                  ||00884  |                                                  
00888  |On Error Resume Next                              ||00885  |On Error Resume Next                              
00889  |        strAsset_T_Cd = "999"                     ||00886  |        strAsset_T_Cd = "999"                     
00890  |ReInsert:                                         ||00887  |ReInsert:                                         
00891  |                                                  ||00888  |                                                  
00892  |        'SQL文生成                                ||00889  |        'SQL文生成                                
00893  |        With uOtherRealComUPD                     ||00890  |        With uOtherRealComUPD                     
00894  |            .CONTRACT_NO = strContract_No         ||00891  |            .CONTRACT_NO = strContract_No         
00895  |            .BASE_MONTH = WkBaseMonth             ||00892  |            .BASE_MONTH = WkBaseMonth             
00896  |            .CURRENCY_CODE = "999"                ||00893  |            .CURRENCY_CODE = "999"                
00897  |            .ASSET_TYPE_CODE = strAsset_T_Cd      ||00894  |            .ASSET_TYPE_CODE = strAsset_T_Cd      
00898  |            .SETTLEMENT_DATE = strSettlement_Date ||00895  |            .SETTLEMENT_DATE = strSettlement_Date 
00899  |            .OTHER_CURRENCY_CODE = strOther_Cur_Co||00896  |            .OTHER_CURRENCY_CODE = strOther_Cur_Co
00900  |            .FIX_COM_FLAG = "1"                   ||00897  |            .FIX_COM_FLAG = "1"                   
00901  |            .FIX_COM_C = strFix_Com_c             ||00898  |            .FIX_COM_C = strFix_Com_c             
00902  |            .FIX_COM_J = strFix_Com_j             ||00899  |            .FIX_COM_J = strFix_Com_j             
00903  |            .FIX_COM_CALC_MONTH = WkFixCalcComYM  ||00900  |            .FIX_COM_CALC_MONTH = WkFixCalcComYM  
00904  |            .FIX_COM_DATE = strSettlement_Date    ||00901  |            .FIX_COM_DATE = strSettlement_Date    
00905  |            .REAL_COM_FLAG = "0"                  ||00902  |            .REAL_COM_FLAG = "0"                  
00906  |            .REAL_COM_C = strReal_Com_c           ||00903  |            .REAL_COM_C = strReal_Com_c           
00907  |            .REAL_COM_J = strReal_Com_j           ||00904  |            .REAL_COM_J = strReal_Com_j           
00908  |        End With                                  ||00905  |        End With                                  
00909  |        'SQL文生成                                ||00906  |        'SQL文生成                                
00910  |        strSQL = ""                               ||00907  |        strSQL = ""                               
00911  |        strSQL = gstrEditSQLcfr_OtherRealComForIns||00908  |        strSQL = gstrEditSQLcfr_OtherRealComForIns
00912  |                                                  ||00909  |                                                  
00913  |        'ＳＱＬ実行                               ||00910  |        'ＳＱＬ実行                               
00914  |         If (gblnMakePrintDbExec(strSQL, ErrorMsg,||00911  |         If (gblnMakePrintDbExec(strSQL, ErrorMsg,
00915  |            'DBアクセスエラー                     ||00912  |            'DBアクセスエラー                     
00916  |            '--更新失敗--ロールバック実行         ||00913  |            '--更新失敗--ロールバック実行         
00917  |            'メッセージ出力処理                   ||00914  |            'メッセージ出力処理                   
00918  |            blnret = gblnDbRollback               ||00915  |            blnret = gblnDbRollback               
00919  |            'エラーが一意制約違反の場合は、資産種 ||00916  |            'エラーが一意制約違反の場合は、資産種 
00920  |            If Trim(ErrorMsg) = "ORA-00001" Then  ||00917  |            If Trim(ErrorMsg) = "ORA-00001" Then  
00921  |                'SQL文を生成する(基準月の資産種別 ||00918  |                'SQL文を生成する(基準月の資産種別 
00922  |                strSQL = ""                       ||00919  |                strSQL = ""                       
00923  |                strSQL = strSQL & "SELECT"        ||00920  |                strSQL = strSQL & "SELECT"        
00924  |                strSQL = strSQL & "    CONTRACT_NO||00921  |                strSQL = strSQL & "    CONTRACT_NO
00925  |                strSQL = strSQL & "    BASE_MONTH,||00922  |                strSQL = strSQL & "    BASE_MONTH,
00926  |                strSQL = strSQL & "    MIN(ASSET_T||00923  |                strSQL = strSQL & "    MIN(ASSET_T
00927  |                strSQL = strSQL & " FROM CFR_OTHER||00924  |                strSQL = strSQL & " FROM CFR_OTHER
00928  |                strSQL = strSQL & " WHERE"        ||00925  |                strSQL = strSQL & " WHERE"        
00929  |                strSQL = strSQL & "    CONTRACT_NO||00926  |                strSQL = strSQL & "    CONTRACT_NO
00930  |                strSQL = strSQL & "    BASE_MONTH ||00927  |                strSQL = strSQL & "    BASE_MONTH 
00931  |                strSQL = strSQL & " GROUP BY"     ||00928  |                strSQL = strSQL & " GROUP BY"     
00932  |                strSQL = strSQL & "    CONTRACT_NO||00929  |                strSQL = strSQL & "    CONTRACT_NO
00933  |                strSQL = strSQL & "    BASE_MONTH"||00930  |                strSQL = strSQL & "    BASE_MONTH"
00934  |                                                  ||00931  |                                                  
00935  |                'SQL実行                          ||00932  |                'SQL実行                          
00936  |                If (gintDyCreate(strSQL) = False) ||00933  |                If (gintDyCreate(strSQL) = False) 
00937  |                    Call subError("DBエラー", Str(||00934  |                    Call subError("DBエラー", Str(
00938  |                        "DB関数エラー", strErrCall||00935  |                        "DB関数エラー", strErrCall
00939  |                    GoTo ErrExit                  ||00936  |                    GoTo ErrExit                  
00940  |                End If                            ||00937  |                End If                            
00941  |                                                  ||00938  |                                                  
00942  |                If Not gblnDyEOF() Then           ||00939  |                If Not gblnDyEOF() Then           
00943  |                    strAsset_T_Cd = Trim(gvlnDyDat||00940  |                    strAsset_T_Cd = Trim(gvlnDyDat
00944  |                End If                            ||00941  |                End If                            
00945  |                '資産種別をデクリメントする       ||00942  |                '資産種別をデクリメントする       
00946  |                strAsset_T_Cd = Format(CInt(strAss||00943  |                strAsset_T_Cd = Format(CInt(strAss
00947  |                GoTo ReInsert                     ||00944  |                GoTo ReInsert                     
00948  |            End If                                ||00945  |            End If                                
00949  |            Call gOnErrorMsg(strSQL$, "gblnDbExec(||00946  |            Call gOnErrorMsg(strSQL$, "gblnDbExec(
00950  |                                                  ||00947  |                                                  
00951  |            GoTo ErrExit                          ||00948  |            GoTo ErrExit                          
00952  |        End If                                    ||00949  |        End If                                    
00953  |    Else                                          ||00950  |    Else                                          
00954  |    'Update実行                                   ||00951  |    'Update実行                                   
00955  |        WkContractNo = Trim(gvlnDyDataS("contract_||00952  |        WkContractNo = Trim(gvlnDyDataS("contract_
00956  |        WkBaseMonth = Trim(gvlnDyDataS("base_month||00953  |        WkBaseMonth = Trim(gvlnDyDataS("base_month
00957  |        WkCurCode = Trim(gvlnDyDataS("other_curren||00954  |        WkCurCode = Trim(gvlnDyDataS("other_curren
00958  |        WkSettlementDate = Trim(gvlnDyDataS("settl||00955  |        WkSettlementDate = Trim(gvlnDyDataS("settl
00959  |        WkFixComFlag = Trim(gvlnDyDataS("fix_com_f||00956  |        WkFixComFlag = Trim(gvlnDyDataS("fix_com_f
00960  |        WkRealComFlag = Trim(gvlnDyDataS("real_com||00957  |        WkRealComFlag = Trim(gvlnDyDataS("real_com
00961  |        WkSettFixFlag = Trim(gvlnDyDataS("SETT_FIX||00958  |        WkSettFixFlag = Trim(gvlnDyDataS("SETT_FIX
00962  |        WkFixComC = strFix_Com_c                  ||00959  |        WkFixComC = strFix_Com_c                  
00963  |        WkFixComJ = strFix_Com_j                  ||00960  |        WkFixComJ = strFix_Com_j                  
00964  |        WkRealComC = strReal_Com_c                ||00961  |        WkRealComC = strReal_Com_c                
00965  |        WkRealComJ = strReal_Com_j                ||00962  |        WkRealComJ = strReal_Com_j                
00966  |                                                  ||00963  |                                                  
00967  |'''''''''''''''''''''2008/10/15 START K.Nishihama ||00964  |'''''''''''''''''''''2008/10/15 START K.Nishihama 
00968  |'''''''''''''''''''''確定額反映月の設定をやめる　 ||00965  |'''''''''''''''''''''確定額反映月の設定をやめる　 
00969  |'''''''''''''''''''''        If WkSettFixFlag = "1||00966  |'''''''''''''''''''''        If WkSettFixFlag = "1
00970  |'''''''''''''''''''''            WkFixCalcComYM = ||00967  |'''''''''''''''''''''            WkFixCalcComYM = 
00971  |'''''''''''''''''''''        Else                 ||00968  |'''''''''''''''''''''        Else                 
00972  |'''''''''''''''''''''            '確定顧問料計算済||00969  |'''''''''''''''''''''            '確定顧問料計算済
00973  |'''''''''''''''''''''            strSQL = ""      ||00970  |'''''''''''''''''''''            strSQL = ""      
00974  |'''''''''''''''''''''            strSQL = strSQL &||00971  |'''''''''''''''''''''            strSQL = strSQL &
00975  |'''''''''''''''''''''            strSQL = strSQL &||00972  |'''''''''''''''''''''            strSQL = strSQL &
00976  |'''''''''''''''''''''            strSQL = strSQL &||00973  |'''''''''''''''''''''            strSQL = strSQL &
00977  |'''''''''''''''''''''            strSQL = strSQL &||00974  |'''''''''''''''''''''            strSQL = strSQL &
00978  |'''''''''''''''''''''                             ||00975  |'''''''''''''''''''''                             
00979  |'''''''''''''''''''''            If gintDyCreate(s||00976  |'''''''''''''''''''''            If gintDyCreate(s
00980  |'''''''''''''''''''''                GoTo ErrExit ||00977  |'''''''''''''''''''''                GoTo ErrExit 
00981  |'''''''''''''''''''''            End If           ||00978  |'''''''''''''''''''''            End If           
00982  |'''''''''''''''''''''            '確定顧問料計算済||00979  |'''''''''''''''''''''            '確定顧問料計算済
00983  |'''''''''''''''''''''            WkFixCalcComYM = ||00980  |'''''''''''''''''''''            WkFixCalcComYM = 
00984  |'''''''''''''''''''''        End If               ||00981  |'''''''''''''''''''''        End If               
00985  |'''''''''''''''''''''確定額反映月の設定をやめる　 ||00982  |'''''''''''''''''''''確定額反映月の設定をやめる　 
00986  |'''''''''''''''''''''2008/10/15 END K.Nishihama 財||00983  |'''''''''''''''''''''2008/10/15 END K.Nishihama 財
00987  |                                                  ||00984  |                                                  
00988  |        'Case 1  ,確定入力区分 = '1' & 実払入力区 ||00985  |        'Case 1  ,確定入力区分 = '1' & 実払入力区 
00989  |        If WkFixComFlag = "0" And WkRealComFlag = ||00986  |        If WkFixComFlag = "0" And WkRealComFlag = 
00990  |            'SQL文生成                            ||00987  |            'SQL文生成                            
00991  |            strSQL = ""                           ||00988  |            strSQL = ""                           
00992  |            strSQL = gstrEditSQL_OtherRealComforUp||00989  |            strSQL = gstrEditSQL_OtherRealComforUp
00993  |                WkFixComC, WkFixComJ, WkFixCalcCom||00990  |                WkFixComC, WkFixComJ, WkFixCalcCom
00994  |        'Case 2  ,確定入力区分 = '1' & 実払入力区 ||00991  |        'Case 2  ,確定入力区分 = '1' & 実払入力区 
00995  |        ElseIf WkFixComFlag = "1" And WkRealComFla||00992  |        ElseIf WkFixComFlag = "1" And WkRealComFla
00996  |            'SQL文生成                            ||00993  |            'SQL文生成                            
00997  |            strSQL = ""                           ||00994  |            strSQL = ""                           
00998  |            strSQL = gstrEditSQL_OtherRealComforUp||00995  |            strSQL = gstrEditSQL_OtherRealComforUp
00999  |                WkFixComC, WkFixComJ, WkFixCalcCom||00996  |                WkFixComC, WkFixComJ, WkFixCalcCom
01000  |        'Case 3  ,確定入力区分 = '1' & 実払入力区 ||00997  |        'Case 3  ,確定入力区分 = '1' & 実払入力区 
01001  |        ElseIf WkFixComFlag = "1" And WkRealComFla||00998  |        ElseIf WkFixComFlag = "1" And WkRealComFla
01002  |            'SQL文生成                            ||00999  |            'SQL文生成                            
01003  |            strSQL = ""                           ||01000  |            strSQL = ""                           
01004  |            strSQL = gstrEditSQL_OtherRealComforUp||01001  |            strSQL = gstrEditSQL_OtherRealComforUp
01005  |                WkFixComC, WkFixComJ, WkFixCalcCom||01002  |                WkFixComC, WkFixComJ, WkFixCalcCom
01006  |        'Case 4  ,確定入力区分 = '2' & 実払入力区 ||01003  |        'Case 4  ,確定入力区分 = '2' & 実払入力区 
01007  |        ElseIf WkFixComFlag = "2" And WkRealComFla||01004  |        ElseIf WkFixComFlag = "2" And WkRealComFla
01008  |            'SQL文生成                            ||01005  |            'SQL文生成                            
01009  |            strSQL = ""                           ||01006  |            strSQL = ""                           
01010  |            strSQL = gstrEditSQL_OtherRealComforUp||01007  |            strSQL = gstrEditSQL_OtherRealComforUp
01011  |                WkFixComC, WkFixComJ, WkFixCalcCom||01008  |                WkFixComC, WkFixComJ, WkFixCalcCom
01012  |        'Case 5  ,確定入力区分 = '2' & 実払入力区 ||01009  |        'Case 5  ,確定入力区分 = '2' & 実払入力区 
01013  |        ElseIf WkFixComFlag = "2" And WkRealComFla||01010  |        ElseIf WkFixComFlag = "2" And WkRealComFla
01014  |            'SQL文生成                            ||01011  |            'SQL文生成                            
01015  |            strSQL = ""                           ||01012  |            strSQL = ""                           
01016  |            strSQL = gstrEditSQL_OtherRealComforUp||01013  |            strSQL = gstrEditSQL_OtherRealComforUp
01017  |                WkFixComC, WkFixComJ, WkFixCalcCom||01014  |                WkFixComC, WkFixComJ, WkFixCalcCom
01018  |        'Case 6  ,確定入力区分 = '2' & 実払入力区 ||01015  |        'Case 6  ,確定入力区分 = '2' & 実払入力区 
01019  |        Else                                      ||01016  |        Else                                      
01020  |            '更新なし                             ||01017  |            '更新なし                             
01021  |            fncOtherRealComUpdateInsert = 0       ||01018  |            fncOtherRealComUpdateInsert = 0       
01022  |            Exit Function                         ||01019  |            Exit Function                         
01023  |        End If                                    ||01020  |        End If                                    
01024  |        'SQL文実行                                ||01021  |        'SQL文実行                                
01025  |         If (gblnDbExec(strSQL, True) <> True) The||01022  |         If (gblnDbExec(strSQL, True) <> True) The
01026  |            'DBアクセスエラー                     ||01023  |            'DBアクセスエラー                     
01027  |            '--更新失敗--ロールバック実行         ||01024  |            '--更新失敗--ロールバック実行         
01028  |            'メッセージ出力処理                   ||01025  |            'メッセージ出力処理                   
01029  |            blnret = gblnDbRollback               ||01026  |            blnret = gblnDbRollback               
01030  |            Call gOnErrorMsg(strSQL$, "gblnDbExec(||01027  |            Call gOnErrorMsg(strSQL$, "gblnDbExec(
01031  |            GoTo ErrExit                          ||01028  |            GoTo ErrExit                          
01032  |        End If                                    ||01029  |        End If                                    
01033  |                                                  ||01030  |                                                  
01034  |    End If                                        ||01031  |    End If                                        
01035  |                                                  ||01032  |                                                  
01036  |    'DBクローズ                                   ||01033  |    'DBクローズ                                   
01037  |    If Not gblnDyClose() Then                     ||01034  |    If Not gblnDyClose() Then                     
01038  |        Call subPubError("DBエラー", Str(9999), "g||01035  |        Call subPubError("DBエラー", Str(9999), "g
01039  |            "DB関数エラー", strErrCall, conTitle) ||01036  |            "DB関数エラー", strErrCall, conTitle) 
01040  |    End If                                        ||01037  |    End If                                        
01041  |                                                  ||01038  |                                                  
01042  |    fncOtherRealComUpdateInsert = 0               ||01039  |    fncOtherRealComUpdateInsert = 0               
01043  |    Exit Function                                 ||01040  |    Exit Function                                 
01044  |                                                  ||01041  |                                                  
01045  |ErrExit:                                          ||01042  |ErrExit:                                          
01046  |                                                  ||01043  |                                                  
01047  |    'DBクローズ                                   ||01044  |    'DBクローズ                                   
01048  |    If Not gblnDyClose() Then                     ||01045  |    If Not gblnDyClose() Then                     
01049  |        Call subPubError("DBエラー", Str(9999), "g||01046  |        Call subPubError("DBエラー", Str(9999), "g
01050  |            "DB関数エラー", strErrCall, conTitle) ||01047  |            "DB関数エラー", strErrCall, conTitle) 
01051  |    End If                                        ||01048  |    End If                                        
01052  |                                                  ||01049  |                                                  
01053  |End Function                                      ||01050  |End Function                                      
01054  |                                                  ||01051  |                                                  
01055  |'2005/07/29 End                                   ||01052  |'2005/07/29 End                                   
01056  |                                                  ||01053  |                                                  
01057  |Private Sub cmdCancel_Click()                     ||01054  |Private Sub cmdCancel_Click()                     
01058  |    Unload Me                                     ||01055  |    Unload Me                                     
01059  |End Sub                                           ||01056  |End Sub                                           
01060  |                                                  ||01057  |                                                  
01061  |Private Sub cmdCheckClear_Click()                 ||01058  |Private Sub cmdCheckClear_Click()                 
01062  |                                                  ||01059  |                                                  
01063  |'=================================================||01060  |'=================================================
01064  |'処理内容     cmdCheckClear_Click時モジュール     ||01061  |'処理内容     cmdCheckClear_Click時モジュール     
01065  |'備考         「出力」チェックボックスのチェックを||01062  |'備考         「出力」チェックボックスのチェックを
01066  |'日付         担当               内容             ||01063  |'日付         担当               内容             
01067  |'------------ ----------------- ------------------||01064  |'------------ ----------------- ------------------
01068  |'2005/07/25   K.Nishihama<SRA>   新規作成         ||01065  |'2005/07/25   K.Nishihama<SRA>   新規作成         
01069  |'=================================================||01066  |'=================================================
01070  |    Dim lineCnt As Long                           ||01067  |    Dim lineCnt As Long                           
01071  |                                                  ||01068  |                                                  
01072  |    With fgridMakePrint                           ||01069  |    With fgridMakePrint                           
01073  |        For lineCnt = 0 To .Rows - 2              ||01070  |        For lineCnt = 0 To .Rows - 2              
01074  |            .Col = conColSysOutbln                ||01071  |            .Col = conColSysOutbln                
01075  |            .Row = lineCnt + 1                    ||01072  |            .Row = lineCnt + 1                    
01076  |            'チェックボックスをOFFする            ||01073  |            'チェックボックスをOFFする            
01077  |            .Text = 0                             ||01074  |            .Text = 0                             
01078  |            '背景色を通常色に戻す                 ||01075  |            '背景色を通常色に戻す                 
01079  |            .Cell(flexcpBackColor, .Row, 3, .Row, ||01076  |            .Cell(flexcpBackColor, .Row, 3, .Row, 
01080  |            .Cell(flexcpBackColor, .Row, 6, .Row, ||01077  |            .Cell(flexcpBackColor, .Row, 6, .Row, 
01081  |            .Cell(flexcpBackColor, .Row, 8, .Row, ||01078  |            .Cell(flexcpBackColor, .Row, 8, .Row, 
01082  |            .Cell(flexcpBackColor, .Row, 15, .Row,||01079  |            .Cell(flexcpBackColor, .Row, 15, .Row,
01083  |        Next lineCnt                              ||01080  |        Next lineCnt                              
01084  |    End With                                      ||01081  |    End With                                      
01085  |                                                  ||01082  |                                                  
01086  |End Sub                                           ||01083  |End Sub                                           
01087  |                                                  ||01084  |                                                  
01088  |'=================================================||01085  |'=================================================
01089  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fgridMakePrint_AfterEdit     ||01086  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fgridMakePrint_AfterEdit     
01090  |'機能            :   グリッド編集後エラーチェック ||01087  |'機能            :   グリッド編集後エラーチェック 
01091  |'                                                 ||01088  |'                                                 
01092  |'日付               担当　              修正内容  ||01089  |'日付               担当　              修正内容  
01093  |'-------------------------------------------------||01090  |'-------------------------------------------------
01094  |'2004/08/06         M.Katoh<SRA>       新規作成   ||01091  |'2004/08/06         M.Katoh<SRA>       新規作成   
01095  |'2005/01/11         M.Yamazaki <SRA>   入力チェッ ||01092  |'2005/01/11         M.Yamazaki <SRA>   入力チェッ 
01096  |'2005/01/17         M.Yamazaki <SRA>   入力チェッ ||01093  |'2005/01/17         M.Yamazaki <SRA>   入力チェッ 
01097  |'2008/03/12         K.Furuya<SRA>      ファンド決 ||01094  |'2008/03/12         K.Furuya<SRA>      ファンド決 
01098  |'=================================================||01095  |'=================================================
01099  |Private Sub fgridMakePrint_AfterEdit(ByVal Row As ||01096  |Private Sub fgridMakePrint_AfterEdit(ByVal Row As 
01100  |    Dim sBuf            As String                 ||01097  |    Dim sBuf            As String                 
01101  |                                                  ||01098  |                                                  
01102  |    With fgridMakePrint                           ||01099  |    With fgridMakePrint                           
01103  |'2005/01/17 Start                                 ||01100  |'2005/01/17 Start                                 
01104  |''2005/01/11 Start                                ||01101  |''2005/01/11 Start                                
01105  |''        If (Col = conColPayMentDate) Or (Col = c||01102  |''        If (Col = conColPayMentDate) Or (Col = c
01106  |'        If (Col = conColPayMentDate) Or (Col = co||01103  |'        If (Col = conColPayMentDate) Or (Col = co
01107  |'        Or (Col = conColNavAmount) Or (Col = conC||01104  |'        Or (Col = conColNavAmount) Or (Col = conC
01108  |'        Or (Col = conColAmountCom) Or (Col = conC||01105  |'        Or (Col = conColAmountCom) Or (Col = conC
01109  |''2005/01/11 End                                  ||01106  |''2005/01/11 End                                  
01110  |'2008/03/12 START ファンド決算期間での外部委託顧問||01107  |'2008/03/12 START ファンド決算期間での外部委託顧問
01111  |'        If (Col = conColPayMentDate) Or (Col = co||01108  |'        If (Col = conColPayMentDate) Or (Col = co
01112  |        '編集可能列にファンド計算を追加           ||01109  |        '編集可能列にファンド計算を追加           
01113  |        If (Col = conColPayMentDate) Or _         ||01110  |        If (Col = conColPayMentDate) Or _         
01114  |            (Col = conColSysOutbln) Or _          ||01111  |            (Col = conColSysOutbln) Or _          
01115  |            (Col = conColFndCalcFrom) Or _        ||01112  |            (Col = conColFndCalcFrom) Or _        
01116  |            (Col = conColFndCalcTo) Then          ||01113  |            (Col = conColFndCalcTo) Then          
01117  |'2008/03/12 START ファンド決算期間での外部委託顧問||01114  |'2008/03/12 START ファンド決算期間での外部委託顧問
01118  |'2005/01/17 End                                   ||01115  |'2005/01/17 End                                   
01119  |            If .EditText = "" Then                ||01116  |            If .EditText = "" Then                
01120  |                .BackColorSel = COLOR_CHG_OK_CELL ||01117  |                .BackColorSel = COLOR_CHG_OK_CELL 
01121  |                .ForeColorSel = vbWindowText      ||01118  |                .ForeColorSel = vbWindowText      
01122  |                Exit Sub                          ||01119  |                Exit Sub                          
01123  |            End If                                ||01120  |            End If                                
01124  |        End If                                    ||01121  |        End If                                    
01125  |'2005/01/17 Start                                 ||01122  |'2005/01/17 Start                                 
01126  |''2005/01/11 Start                                ||01123  |''2005/01/11 Start                                
01127  |''        If Col = conColPayMentDate Then '/をつけ||01124  |''        If Col = conColPayMentDate Then '/をつけ
01128  |''            sBuf = gstrDateFormat(.EditText, 1) ||01125  |''            sBuf = gstrDateFormat(.EditText, 1) 
01129  |''        End If                                  ||01126  |''        End If                                  
01130  |'        Select Case Col                          ||01127  |'        Select Case Col                          
01131  |'            Case conColPayMentDate               ||01128  |'            Case conColPayMentDate               
01132  |'                sBuf = gstrDateFormat(.EditText, ||01129  |'                sBuf = gstrDateFormat(.EditText, 
01133  |'            Case conColNavAmount                 ||01130  |'            Case conColNavAmount                 
01134  |'                If .Cell(flexcpText, Row, conColO||01131  |'                If .Cell(flexcpText, Row, conColO
01135  |'                    Exit Sub                     ||01132  |'                    Exit Sub                     
01136  |'                End If                           ||01133  |'                End If                           
01137  |'                If fnRateChk(.EditText) = False T||01134  |'                If fnRateChk(.EditText) = False T
01138  |'                    .Cell(flexcpBackColor, Row, C||01135  |'                    .Cell(flexcpBackColor, Row, C
01139  |''''''                    sBuf = Format(.EditText,||01136  |''''''                    sBuf = Format(.EditText,
01140  |'                    sBuf = Format(.EditText, "##0||01137  |'                    sBuf = Format(.EditText, "##0
01141  |'                Else                             ||01138  |'                Else                             
01142  |'                    MsgSend "レート入力エラー    ||01139  |'                    MsgSend "レート入力エラー    
01143  |'                    sBuf = .EditText             ||01140  |'                    sBuf = .EditText             
01144  |'                    .Cell(flexcpBackColor, Row, C||01141  |'                    .Cell(flexcpBackColor, Row, C
01145  |'                End If                           ||01142  |'                End If                           
01146  |'            Case conColNavCom                    ||01143  |'            Case conColNavCom                    
01147  |'                If fnRateChk(.EditText) = False T||01144  |'                If fnRateChk(.EditText) = False T
01148  |'                    .Cell(flexcpBackColor, Row, C||01145  |'                    .Cell(flexcpBackColor, Row, C
01149  |''''''                    sBuf = Format(.EditText,||01146  |''''''                    sBuf = Format(.EditText,
01150  |'                    sBuf = Format(.EditText, "##0||01147  |'                    sBuf = Format(.EditText, "##0
01151  |'                Else                             ||01148  |'                Else                             
01152  |'                    MsgSend "レート入力エラー    ||01149  |'                    MsgSend "レート入力エラー    
01153  |'                    sBuf = .EditText             ||01150  |'                    sBuf = .EditText             
01154  |'                    .Cell(flexcpBackColor, Row, C||01151  |'                    .Cell(flexcpBackColor, Row, C
01155  |'                End If                           ||01152  |'                End If                           
01156  |'            Case conColAmountCom                 ||01153  |'            Case conColAmountCom                 
01157  |'                If .Cell(flexcpText, Row, conColO||01154  |'                If .Cell(flexcpText, Row, conColO
01158  |'                    Exit Sub                     ||01155  |'                    Exit Sub                     
01159  |'                End If                           ||01156  |'                End If                           
01160  |'                If fnRateChk(.EditText) = False T||01157  |'                If fnRateChk(.EditText) = False T
01161  |'                    .Cell(flexcpBackColor, Row, C||01158  |'                    .Cell(flexcpBackColor, Row, C
01162  |''''''                    sBuf = Format(.EditText,||01159  |''''''                    sBuf = Format(.EditText,
01163  |'                    sBuf = Format(.EditText, "##0||01160  |'                    sBuf = Format(.EditText, "##0
01164  |'                Else                             ||01161  |'                Else                             
01165  |'                    MsgSend "レート入力エラー    ||01162  |'                    MsgSend "レート入力エラー    
01166  |'                    sBuf = .EditText             ||01163  |'                    sBuf = .EditText             
01167  |'                    .Cell(flexcpBackColor, Row, C||01164  |'                    .Cell(flexcpBackColor, Row, C
01168  |'                End If                           ||01165  |'                End If                           
01169  |'            Case conColComPay                    ||01166  |'            Case conColComPay                    
01170  |'                If fnRateChk(.EditText) = False T||01167  |'                If fnRateChk(.EditText) = False T
01171  |'                    .Cell(flexcpBackColor, Row, C||01168  |'                    .Cell(flexcpBackColor, Row, C
01172  |''''''                    sBuf = Format(.EditText,||01169  |''''''                    sBuf = Format(.EditText,
01173  |'                    sBuf = Format(.EditText, "##0||01170  |'                    sBuf = Format(.EditText, "##0
01174  |'                Else                             ||01171  |'                Else                             
01175  |'                    MsgSend "レート入力エラー    ||01172  |'                    MsgSend "レート入力エラー    
01176  |'                    sBuf = .EditText             ||01173  |'                    sBuf = .EditText             
01177  |'                    .Cell(flexcpBackColor, Row, C||01174  |'                    .Cell(flexcpBackColor, Row, C
01178  |'                End If                           ||01175  |'                End If                           
01179  |'        End Select                               ||01176  |'        End Select                               
01180  |''2005/01/11 End                                  ||01177  |''2005/01/11 End                                  
01181  |        If Col = conColPayMentDate Then '/をつける||01178  |        If Col = conColPayMentDate Then '/をつける
01182  |            sBuf = gstrDateFormat(.EditText, 1)   ||01179  |            sBuf = gstrDateFormat(.EditText, 1)   
01183  |        End If                                    ||01180  |        End If                                    
01184  |'2005/01/17 End                                   ||01181  |'2005/01/17 End                                   
01185  |'2008/03/12 START ファンド決算期間での外部委託顧問||01182  |'2008/03/12 START ファンド決算期間での外部委託顧問
01186  |        If Col = conColFndCalcFrom Then '/をつける||01183  |        If Col = conColFndCalcFrom Then '/をつける
01187  |            sBuf = gstrDateFormat(.EditText, 1)   ||01184  |            sBuf = gstrDateFormat(.EditText, 1)   
01188  |        End If                                    ||01185  |        End If                                    
01189  |        If Col = conColFndCalcTo Then '/をつける  ||01186  |        If Col = conColFndCalcTo Then '/をつける  
01190  |            sBuf = gstrDateFormat(.EditText, 1)   ||01187  |            sBuf = gstrDateFormat(.EditText, 1)   
01191  |        End If                                    ||01188  |        End If                                    
01192  |'2008/03/12 START ファンド決算期間での外部委託顧問||01189  |'2008/03/12 START ファンド決算期間での外部委託顧問
01193  |        .Text = sBuf                              ||01190  |        .Text = sBuf                              
01194  |    End With                                      ||01191  |    End With                                      
01195  |End Sub                                           ||01192  |End Sub                                           
01196  |                                                  ||01193  |                                                  
01197  |'=================================================||01194  |'=================================================
01198  |'処理内容     確認書作成対象情報表示グリッド　クリ||01195  |'処理内容     確認書作成対象情報表示グリッド　クリ
01199  |'備考                                             ||01196  |'備考                                             
01200  |'                                                 ||01197  |'                                                 
01201  |'日付         担当               内容             ||01198  |'日付         担当               内容             
01202  |'------------ ----------------- ------------------||01199  |'------------ ----------------- ------------------
01203  |'2004/08/06   M.Katoh <SRA>  　　新規作成         ||01200  |'2004/08/06   M.Katoh <SRA>  　　新規作成         
01204  |'2006/07/04   K.Furuya<SRA>      期中料率変更契約/||01201  |'2006/07/04   K.Furuya<SRA>      期中料率変更契約/
01205  |'                                グリッドの出力チ ||01202  |'                                グリッドの出力チ 
01206  |'                                選択行の背景色が ||01203  |'                                選択行の背景色が 
01207  |'=================================================||01204  |'=================================================
01208  |Private Sub fgridMakePrint_Click()                ||01205  |Private Sub fgridMakePrint_Click()                
01209  |    'チェックされた行の番号                       ||01206  |    'チェックされた行の番号                       
01210  |    Dim NowRow  As Integer                        ||01207  |    Dim NowRow  As Integer                        
01211  |    With fgridMakePrint                           ||01208  |    With fgridMakePrint                           
01212  |        'チェックされた行の番号を取得             ||01209  |        'チェックされた行の番号を取得             
01213  |        NowRow = .Row                             ||01210  |        NowRow = .Row                             
01214  |        If .CellChecked = flexChecked Then        ||01211  |        If .CellChecked = flexChecked Then        
01215  |            .CellChecked = flexUnchecked          ||01212  |            .CellChecked = flexUnchecked          
01216  |            'チェックを外したら通常色に戻す       ||01213  |            'チェックを外したら通常色に戻す       
01217  |            .Cell(flexcpBackColor, NowRow, 3, NowR||01214  |            .Cell(flexcpBackColor, NowRow, 3, NowR
01218  |            .Cell(flexcpBackColor, NowRow, 6, NowR||01215  |            .Cell(flexcpBackColor, NowRow, 6, NowR
01219  |            .Cell(flexcpBackColor, NowRow, 8, NowR||01216  |            .Cell(flexcpBackColor, NowRow, 8, NowR
01220  |            .Cell(flexcpBackColor, NowRow, 15, Now||01217  |            .Cell(flexcpBackColor, NowRow, 15, Now
01221  |        ElseIf .CellChecked = flexUnchecked Then  ||01218  |        ElseIf .CellChecked = flexUnchecked Then  
01222  |            .CellChecked = flexChecked            ||01219  |            .CellChecked = flexChecked            
01223  |            'チェックしたら選択色に変える         ||01220  |            'チェックしたら選択色に変える         
01224  |            .Cell(flexcpBackColor, NowRow, 3, NowR||01221  |            .Cell(flexcpBackColor, NowRow, 3, NowR
01225  |            .Cell(flexcpBackColor, NowRow, 6, NowR||01222  |            .Cell(flexcpBackColor, NowRow, 6, NowR
01226  |            .Cell(flexcpBackColor, NowRow, 8, NowR||01223  |            .Cell(flexcpBackColor, NowRow, 8, NowR
01227  |            .Cell(flexcpBackColor, NowRow, 15, Now||01224  |            .Cell(flexcpBackColor, NowRow, 15, Now
01228  |        End If                                    ||01225  |        End If                                    
01229  |    End With                                      ||01226  |    End With                                      
01230  |End Sub                                           ||01227  |End Sub                                           
01231  |                                                  ||01228  |                                                  
01232  |'=================================================||01229  |'=================================================
01233  |'処理内容  VSFLEX：カラム編集に入る直前処理       ||01230  |'処理内容  VSFLEX：カラム編集に入る直前処理       
01234  |'備考                                             ||01231  |'備考                                             
01235  |'                                                 ||01232  |'                                                 
01236  |'日付         担当               内容             ||01233  |'日付         担当               内容             
01237  |'------------ ----------------- ------------------||01234  |'------------ ----------------- ------------------
01238  |'2004/08/06   M.Katoh<SRA>       新規作成         ||01235  |'2004/08/06   M.Katoh<SRA>       新規作成         
01239  |'2005/01/11   M.Yamazaki<SRA>    変更可能列追加   ||01236  |'2005/01/11   M.Yamazaki<SRA>    変更可能列追加   
01240  |'2005/01/14   M.Yamazaki<SRA>    各通貨(NAV通貨、 ||01237  |'2005/01/14   M.Yamazaki<SRA>    各通貨(NAV通貨、 
01241  |'2005/01/17   M.Yamazaki<SRA>    各通貨(NAV通貨、 ||01238  |'2005/01/17   M.Yamazaki<SRA>    各通貨(NAV通貨、 
01242  |'2008/03/12   K.Furuya<SRA>      ファンド決算期間 ||01239  |'2008/03/12   K.Furuya<SRA>      ファンド決算期間 
01243  |'=================================================||01240  |'=================================================
01244  |Private Sub fgridMakePrint_BeforeEdit(ByVal Row As||01241  |Private Sub fgridMakePrint_BeforeEdit(ByVal Row As
01245  |                                                  ||01242  |                                                  
01246  |'2005/01/17 Start                                 ||01243  |'2005/01/17 Start                                 
01247  |''2005/01/11 Start                                ||01244  |''2005/01/11 Start                                
01248  |''    '変更可能列(支払予定日)以外は変更不可にする ||01245  |''    '変更可能列(支払予定日)以外は変更不可にする 
01249  |''    If (Col = conColPayMentDate) Then           ||01246  |''    If (Col = conColPayMentDate) Then           
01250  |'    If (Col = conColPayMentDate) _               ||01247  |'    If (Col = conColPayMentDate) _               
01251  |'    Or (Col = conColNavAmount) _                 ||01248  |'    Or (Col = conColNavAmount) _                 
01252  |'    Or (Col = conColNavCom) _                    ||01249  |'    Or (Col = conColNavCom) _                    
01253  |'    Or (Col = conColAmountCom) _                 ||01250  |'    Or (Col = conColAmountCom) _                 
01254  |'    Or (Col = conColComPay) Then                 ||01251  |'    Or (Col = conColComPay) Then                 
01255  |'        If fgridMakePrint.Cell(flexcpText, Row, c||01252  |'        If fgridMakePrint.Cell(flexcpText, Row, c
01256  |'            If ((Col = conColNavAmount) Or (Col =||01253  |'            If ((Col = conColNavAmount) Or (Col =
01257  |'                Cancel = True                    ||01254  |'                Cancel = True                    
01258  |'            End If                               ||01255  |'            End If                               
01259  |'        End If                                   ||01256  |'        End If                                   
01260  |''2005/01/11 End                                  ||01257  |''2005/01/11 End                                  
01261  |''2005/01/14 Start                                ||01258  |''2005/01/14 Start                                
01262  |'        'NAV通貨 VS. 閾値通貨 入力制御(NAV通貨 →||01259  |'        'NAV通貨 VS. 閾値通貨 入力制御(NAV通貨 →
01263  |'        If fgridMakePrint.Cell(flexcpText, Row, c||01260  |'        If fgridMakePrint.Cell(flexcpText, Row, c
01264  |'            If (Col = conColNavAmount) Then      ||01261  |'            If (Col = conColNavAmount) Then      
01265  |'                Cancel = True                    ||01262  |'                Cancel = True                    
01266  |'            End If                               ||01263  |'            End If                               
01267  |'        End If                                   ||01264  |'        End If                                   
01268  |'        'NAV通貨 VS. 外部委託顧問料通貨 入力制御(||01265  |'        'NAV通貨 VS. 外部委託顧問料通貨 入力制御(
01269  |'        If fgridMakePrint.Cell(flexcpText, Row, c||01266  |'        If fgridMakePrint.Cell(flexcpText, Row, c
01270  |'            If (Col = conColNavCom) Then         ||01267  |'            If (Col = conColNavCom) Then         
01271  |'                Cancel = True                    ||01268  |'                Cancel = True                    
01272  |'            End If                               ||01269  |'            End If                               
01273  |'        End If                                   ||01270  |'        End If                                   
01274  |'        '閾値通貨 VS. 外部委託顧問料通貨 入力制御||01271  |'        '閾値通貨 VS. 外部委託顧問料通貨 入力制御
01275  |'        If fgridMakePrint.Cell(flexcpText, Row, c||01272  |'        If fgridMakePrint.Cell(flexcpText, Row, c
01276  |'            If (Col = conColAmountCom) Then      ||01273  |'            If (Col = conColAmountCom) Then      
01277  |'                Cancel = True                    ||01274  |'                Cancel = True                    
01278  |'            End If                               ||01275  |'            End If                               
01279  |'        End If                                   ||01276  |'        End If                                   
01280  |'        '外部委託顧問料通貨 VS. 支払通貨('JPY'固 ||01277  |'        '外部委託顧問料通貨 VS. 支払通貨('JPY'固 
01281  |'        If fgridMakePrint.Cell(flexcpText, Row, c||01278  |'        If fgridMakePrint.Cell(flexcpText, Row, c
01282  |'            If (Col = conColComPay) Then         ||01279  |'            If (Col = conColComPay) Then         
01283  |'                Cancel = True                    ||01280  |'                Cancel = True                    
01284  |'            End If                               ||01281  |'            End If                               
01285  |'        End If                                   ||01282  |'        End If                                   
01286  |''2005/01/14 End                                  ||01283  |''2005/01/14 End                                  
01287  |'2008/03/12 START ファンド決算期間での外部委託顧問||01284  |'2008/03/12 START ファンド決算期間での外部委託顧問
01288  |    '変更可能列(支払予定日とファンド計算日)以外は ||01285  |    '変更可能列(支払予定日とファンド計算日)以外は 
01289  |    If (Col = conColPayMentDate) Or (Col = conColF||01286  |    If (Col = conColPayMentDate) Or (Col = conColF
01290  |    Else                                          ||01287  |    Else                                          
01291  |        Cancel = True                             ||01288  |        Cancel = True                             
01292  |    End If                                        ||01289  |    End If                                        
01293  |'2008/03/12 END   ファンド決算期間での外部委託顧問||01290  |'2008/03/12 END   ファンド決算期間での外部委託顧問
01294  |'2005/01/17 End                                   ||01291  |'2005/01/17 End                                   
01295  |End Sub                                           ||01292  |End Sub                                           
01296  |                                                  ||01293  |                                                  
01297  |'=================================================||01294  |'=================================================
01298  |'処理内容  VSFLEX：編集可能カラムでDeleteKeyを押さ||01295  |'処理内容  VSFLEX：編集可能カラムでDeleteKeyを押さ
01299  |'備考                                             ||01296  |'備考                                             
01300  |'                                                 ||01297  |'                                                 
01301  |'日付         担当               内容             ||01298  |'日付         担当               内容             
01302  |'------------ ----------------- ------------------||01299  |'------------ ----------------- ------------------
01303  |'2004/08/06   M.Katoh <SRA>     新規作成          ||01300  |'2004/08/06   M.Katoh <SRA>     新規作成          
01304  |'2005/01/11   M.Yamazaki <SRA>  列追加            ||01301  |'2005/01/11   M.Yamazaki <SRA>  列追加            
01305  |'2005/01/17   M.Yamazaki <SRA>  列追加をせず元に戻||01302  |'2005/01/17   M.Yamazaki <SRA>  列追加をせず元に戻
01306  |'2008/03/12   K.Furuya<SRA>     ファンド決算期間で||01303  |'2008/03/12   K.Furuya<SRA>     ファンド決算期間で
01307  |'=================================================||01304  |'=================================================
01308  |Private Sub fgridMakePrint_KeyDown(KeyCode As Inte||01305  |Private Sub fgridMakePrint_KeyDown(KeyCode As Inte
01309  |    Dim NowRow As Long                            ||01306  |    Dim NowRow As Long                            
01310  |    Dim NowCol As Long                            ||01307  |    Dim NowCol As Long                            
01311  |    Dim intRtn                                    ||01308  |    Dim intRtn                                    
01312  |                                                  ||01309  |                                                  
01313  |    NowRow = fgridMakePrint.Row  '現在行          ||01310  |    NowRow = fgridMakePrint.Row  '現在行          
01314  |    NowCol = fgridMakePrint.Col  '現在列          ||01311  |    NowCol = fgridMakePrint.Col  '現在列          
01315  |                                                  ||01312  |                                                  
01316  |    'Deleteキー押下                               ||01313  |    'Deleteキー押下                               
01317  |    If KeyCode = vbKeyDelete Then                 ||01314  |    If KeyCode = vbKeyDelete Then                 
01318  |        With fgridMakePrint                       ||01315  |        With fgridMakePrint                       
01319  |            Select Case NowCol                    ||01316  |            Select Case NowCol                    
01320  |                '支払予定日列                     ||01317  |                '支払予定日列                     
01321  |                Case conColPayMentDate            ||01318  |                Case conColPayMentDate            
01322  |                    .Cell(flexcpBackColor, NowRow,||01319  |                    .Cell(flexcpBackColor, NowRow,
01323  |                    .Cell(flexcpText, NowRow, NowC||01320  |                    .Cell(flexcpText, NowRow, NowC
01324  |'2008/03/12   K.Furuya<SRA>      ファンド決算期間 ||01321  |'2008/03/12   K.Furuya<SRA>      ファンド決算期間 
01325  |                'ファンド計算FROM列               ||01322  |                'ファンド計算FROM列               
01326  |                Case conColFndCalcFrom            ||01323  |                Case conColFndCalcFrom            
01327  |                    .Cell(flexcpBackColor, NowRow,||01324  |                    .Cell(flexcpBackColor, NowRow,
01328  |                    .Cell(flexcpText, NowRow, NowC||01325  |                    .Cell(flexcpText, NowRow, NowC
01329  |                'ファンド計算TO列                 ||01326  |                'ファンド計算TO列                 
01330  |                Case conColFndCalcTo              ||01327  |                Case conColFndCalcTo              
01331  |                    .Cell(flexcpBackColor, NowRow,||01328  |                    .Cell(flexcpBackColor, NowRow,
01332  |                    .Cell(flexcpText, NowRow, NowC||01329  |                    .Cell(flexcpText, NowRow, NowC
01333  |'2008/03/12   K.Furuya<SRA>      ファンド決算期間 ||01330  |'2008/03/12   K.Furuya<SRA>      ファンド決算期間 
01334  |                                                  ||01331  |                                                  
01335  |'2005/01/17 Start                                 ||01332  |'2005/01/17 Start                                 
01336  |''2005/01/11 Start                                ||01333  |''2005/01/11 Start                                
01337  |'                'NAV通貨→閾値通貨換算レート列   ||01334  |'                'NAV通貨→閾値通貨換算レート列   
01338  |'                Case conColNavAmount             ||01335  |'                Case conColNavAmount             
01339  |'                    .Cell(flexcpBackColor, NowRow||01336  |'                    .Cell(flexcpBackColor, NowRow
01340  |'                    .Cell(flexcpText, NowRow, Now||01337  |'                    .Cell(flexcpText, NowRow, Now
01341  |'                'NAV通貨→顧問料通貨換算レート列 ||01338  |'                'NAV通貨→顧問料通貨換算レート列 
01342  |'                Case conColNavCom                ||01339  |'                Case conColNavCom                
01343  |'                    .Cell(flexcpBackColor, NowRow||01340  |'                    .Cell(flexcpBackColor, NowRow
01344  |'                    .Cell(flexcpText, NowRow, Now||01341  |'                    .Cell(flexcpText, NowRow, Now
01345  |'                '閾値通貨→顧問料通貨換算レート列||01342  |'                '閾値通貨→顧問料通貨換算レート列
01346  |'                Case conColAmountCom             ||01343  |'                Case conColAmountCom             
01347  |'                    .Cell(flexcpBackColor, NowRow||01344  |'                    .Cell(flexcpBackColor, NowRow
01348  |'                    .Cell(flexcpText, NowRow, Now||01345  |'                    .Cell(flexcpText, NowRow, Now
01349  |'                '顧問料レート→支払(円)換算レート||01346  |'                '顧問料レート→支払(円)換算レート
01350  |'                Case conColComPay                ||01347  |'                Case conColComPay                
01351  |'                    .Cell(flexcpBackColor, NowRow||01348  |'                    .Cell(flexcpBackColor, NowRow
01352  |'                    .Cell(flexcpText, NowRow, Now||01349  |'                    .Cell(flexcpText, NowRow, Now
01353  |''2005/01/11 End                                  ||01350  |''2005/01/11 End                                  
01354  |'2005/01/17 End                                   ||01351  |'2005/01/17 End                                   
01355  |            End Select                            ||01352  |            End Select                            
01356  |        End With                                  ||01353  |        End With                                  
01357  |    End If                                        ||01354  |    End If                                        
01358  |                                                  ||01355  |                                                  
01359  |End Sub                                           ||01356  |End Sub                                           
01360  |                                                  ||01357  |                                                  
01361  |'=================================================||01358  |'=================================================
01362  |'処理内容  VSFLEX：入力可能列のKeyPressEdit時処理 ||01359  |'処理内容  VSFLEX：入力可能列のKeyPressEdit時処理 
01363  |'備考                                             ||01360  |'備考                                             
01364  |'                                                 ||01361  |'                                                 
01365  |'日付         担当               内容             ||01362  |'日付         担当               内容             
01366  |'------------ ----------------- ------------------||01363  |'------------ ----------------- ------------------
01367  |'2004/08/06   M.Katoh <SRA>     新規作成          ||01364  |'2004/08/06   M.Katoh <SRA>     新規作成          
01368  |'2005/01/11   M.Yamazaki<SRA>   変更可能列追加    ||01365  |'2005/01/11   M.Yamazaki<SRA>   変更可能列追加    
01369  |'2005/01/17   M.Yamazaki<SRA>   変更可能列追加をせ||01366  |'2005/01/17   M.Yamazaki<SRA>   変更可能列追加をせ
01370  |'2008/03/12   K.Furuya<SRA>     ファンド決算期間で||01367  |'2008/03/12   K.Furuya<SRA>     ファンド決算期間で
01371  |'=================================================||01368  |'=================================================
01372  |Private Sub fgridMakePrint_KeyPressEdit(ByVal Row ||01369  |Private Sub fgridMakePrint_KeyPressEdit(ByVal Row 
01373  |    Dim NowCol As Long                            ||01370  |    Dim NowCol As Long                            
01374  |    Dim intRtn                                    ||01371  |    Dim intRtn                                    
01375  |                                                  ||01372  |                                                  
01376  |    NowCol = fgridMakePrint.Col  '現在列          ||01373  |    NowCol = fgridMakePrint.Col  '現在列          
01377  |                                                  ||01374  |                                                  
01378  |'2005/01/17 Start                                 ||01375  |'2005/01/17 Start                                 
01379  |''2005/01/11 Start                                ||01376  |''2005/01/11 Start                                
01380  |''    '支払予定日の列                             ||01377  |''    '支払予定日の列                             
01381  |''    If NowCol = conColPayMentDate Then          ||01378  |''    If NowCol = conColPayMentDate Then          
01382  |''    '   半角数字のみ入力可                      ||01379  |''    '   半角数字のみ入力可                      
01383  |''        Call gChkInputChar(KeyAscii, "0001010") ||01380  |''        Call gChkInputChar(KeyAscii, "0001010") 
01384  |''    End If                                      ||01381  |''    End If                                      
01385  |'    If (NowCol = conColPayMentDate) _            ||01382  |'    If (NowCol = conColPayMentDate) _            
01386  |'    Or (NowCol = conColNavAmount) _              ||01383  |'    Or (NowCol = conColNavAmount) _              
01387  |'    Or (NowCol = conColNavCom) _                 ||01384  |'    Or (NowCol = conColNavCom) _                 
01388  |'    Or (NowCol = conColAmountCom) _              ||01385  |'    Or (NowCol = conColAmountCom) _              
01389  |'    Or (NowCol = conColComPay) Then              ||01386  |'    Or (NowCol = conColComPay) Then              
01390  |'    '   半角数字のみ入力可                       ||01387  |'    '   半角数字のみ入力可                       
01391  |'        Call gChkInputChar(KeyAscii, "0001010")  ||01388  |'        Call gChkInputChar(KeyAscii, "0001010")  
01392  |'    End If                                       ||01389  |'    End If                                       
01393  |''2005/01/11 End                                  ||01390  |''2005/01/11 End                                  
01394  |    '支払予定日の列                               ||01391  |    '支払予定日の列                               
01395  |    If NowCol = conColPayMentDate Then            ||01392  |    If NowCol = conColPayMentDate Then            
01396  |    '   半角数字のみ入力可                        ||01393  |    '   半角数字のみ入力可                        
01397  |        Call gChkInputChar(KeyAscii, "0001010")   ||01394  |        Call gChkInputChar(KeyAscii, "0001010")   
01398  |    End If                                        ||01395  |    End If                                        
01399  |'2005/01/17 End                                   ||01396  |'2005/01/17 End                                   
01400  |'2008/03/12 START ファンド決算期間での外部委託顧問||01397  |'2008/03/12 START ファンド決算期間での外部委託顧問
01401  |    'ファンド計算FROMの列                         ||01398  |    'ファンド計算FROMの列                         
01402  |    If NowCol = conColFndCalcFrom Then            ||01399  |    If NowCol = conColFndCalcFrom Then            
01403  |    '   半角数字のみ入力可                        ||01400  |    '   半角数字のみ入力可                        
01404  |        Call gChkInputChar(KeyAscii, "0001010")   ||01401  |        Call gChkInputChar(KeyAscii, "0001010")   
01405  |    End If                                        ||01402  |    End If                                        
01406  |    'ファンド計算TOの列                           ||01403  |    'ファンド計算TOの列                           
01407  |    If NowCol = conColFndCalcTo Then              ||01404  |    If NowCol = conColFndCalcTo Then              
01408  |    '   半角数字のみ入力可                        ||01405  |    '   半角数字のみ入力可                        
01409  |        Call gChkInputChar(KeyAscii, "0001010")   ||01406  |        Call gChkInputChar(KeyAscii, "0001010")   
01410  |    End If                                        ||01407  |    End If                                        
01411  |'2008/03/12 END   ファンド決算期間での外部委託顧問||01408  |'2008/03/12 END   ファンド決算期間での外部委託顧問
01412  |End Sub                                           ||01409  |End Sub                                           
01413  |                                                  ||01410  |                                                  
01414  |'=================================================||01411  |'=================================================
01415  |'処理内容  VSFLEX：入力可能列のValidateEdit時処理 ||01412  |'処理内容  VSFLEX：入力可能列のValidateEdit時処理 
01416  |'備考                                             ||01413  |'備考                                             
01417  |'                                                 ||01414  |'                                                 
01418  |'日付         担当               内容             ||01415  |'日付         担当               内容             
01419  |'------------ ----------------- ------------------||01416  |'------------ ----------------- ------------------
01420  |'2004/08/06   M.Katoh <SRA>     新規作成          ||01417  |'2004/08/06   M.Katoh <SRA>     新規作成          
01421  |'2005/01/11   M.Yamazaki <SRA>  入力チェック列追加||01418  |'2005/01/11   M.Yamazaki <SRA>  入力チェック列追加
01422  |'2005/01/17   M.Yamazaki <SRA>  入力チェック列追加||01419  |'2005/01/17   M.Yamazaki <SRA>  入力チェック列追加
01423  |'=================================================||01420  |'=================================================
01424  |Private Sub fgridMakePrint_ValidateEdit(ByVal Row ||01421  |Private Sub fgridMakePrint_ValidateEdit(ByVal Row 
01425  |    Dim strtxt As String            '入力文字列の ||01422  |    Dim strtxt As String            '入力文字列の 
01426  |    Dim intRtn As Integer                         ||01423  |    Dim intRtn As Integer                         
01427  |                                                  ||01424  |                                                  
01428  |    '出力列の場合チェック不要                     ||01425  |    '出力列の場合チェック不要                     
01429  |    If (Col = conColSysOutbln) Then               ||01426  |    If (Col = conColSysOutbln) Then               
01430  |        GoTo EndProc                              ||01427  |        GoTo EndProc                              
01431  |    End If                                        ||01428  |    End If                                        
01432  |                                                  ||01429  |                                                  
01433  |    With fgridMakePrint                           ||01430  |    With fgridMakePrint                           
01434  |'2005/01/17 Start                                 ||01431  |'2005/01/17 Start                                 
01435  |''2005/01/11 Start                                ||01432  |''2005/01/11 Start                                
01436  |''        '入力列のチェック                       ||01433  |''        '入力列のチェック                       
01437  |''        strtxt = gstrDateFormat(Trim(.EditText),||01434  |''        strtxt = gstrDateFormat(Trim(.EditText),
01438  |''        If strtxt = "" Then '未入力             ||01435  |''        If strtxt = "" Then '未入力             
01439  |''            .Cell(flexcpBackColor, Row, Col) = C||01436  |''            .Cell(flexcpBackColor, Row, Col) = C
01440  |''        Else                                    ||01437  |''        Else                                    
01441  |''            If (IsDate(strtxt) = False) Then    ||01438  |''            If (IsDate(strtxt) = False) Then    
01442  |''                .Cell(flexcpBackColor, Row, Col)||01439  |''                .Cell(flexcpBackColor, Row, Col)
01443  |''                intRtn = MsgBox("日付を入力して ||01440  |''                intRtn = MsgBox("日付を入力して 
01444  |''                    vbCritical, "日付チェック") ||01441  |''                    vbCritical, "日付チェック") 
01445  |''            Else                                ||01442  |''            Else                                
01446  |''                .Cell(flexcpBackColor, Row, Col)||01443  |''                .Cell(flexcpBackColor, Row, Col)
01447  |''            End If                              ||01444  |''            End If                              
01448  |''        End If                                  ||01445  |''        End If                                  
01449  |'        Select Case Col                          ||01446  |'        Select Case Col                          
01450  |'            Case conColPayMentDate               ||01447  |'            Case conColPayMentDate               
01451  |'                '入力列のチェック                ||01448  |'                '入力列のチェック                
01452  |'                strtxt = gstrDateFormat(Trim(.Edi||01449  |'                strtxt = gstrDateFormat(Trim(.Edi
01453  |'                If strtxt = "" Then '未入力      ||01450  |'                If strtxt = "" Then '未入力      
01454  |'                    .Cell(flexcpBackColor, Row, C||01451  |'                    .Cell(flexcpBackColor, Row, C
01455  |'                Else                             ||01452  |'                Else                             
01456  |'                    If (IsDate(strtxt) = False) T||01453  |'                    If (IsDate(strtxt) = False) T
01457  |'                        .Cell(flexcpBackColor, Ro||01454  |'                        .Cell(flexcpBackColor, Ro
01458  |'                        intRtn = MsgBox("日付を入||01455  |'                        intRtn = MsgBox("日付を入
01459  |'                            vbCritical, "日付チェ||01456  |'                            vbCritical, "日付チェ
01460  |'                    Else                         ||01457  |'                    Else                         
01461  |'                        .Cell(flexcpBackColor, Ro||01458  |'                        .Cell(flexcpBackColor, Ro
01462  |'                    End If                       ||01459  |'                    End If                       
01463  |'                End If                           ||01460  |'                End If                           
01464  |'            Case conColNavAmount                 ||01461  |'            Case conColNavAmount                 
01465  |'                '入力列のチェック                ||01462  |'                '入力列のチェック                
01466  |'                strtxt = Trim(.EditText)         ||01463  |'                strtxt = Trim(.EditText)         
01467  |'                If strtxt = "" Then '未入力      ||01464  |'                If strtxt = "" Then '未入力      
01468  |'                    .Cell(flexcpBackColor, Row, C||01465  |'                    .Cell(flexcpBackColor, Row, C
01469  |'                Else                             ||01466  |'                Else                             
01470  |'                    If (IsNumeric(strtxt) = False||01467  |'                    If (IsNumeric(strtxt) = False
01471  |'                        .Cell(flexcpBackColor, Ro||01468  |'                        .Cell(flexcpBackColor, Ro
01472  |'                        intRtn = MsgBox("換算レー||01469  |'                        intRtn = MsgBox("換算レー
01473  |'                            vbCritical, "換算レー||01470  |'                            vbCritical, "換算レー
01474  |'                    Else                         ||01471  |'                    Else                         
01475  |'                        .Cell(flexcpBackColor, Ro||01472  |'                        .Cell(flexcpBackColor, Ro
01476  |'                    End If                       ||01473  |'                    End If                       
01477  |'                End If                           ||01474  |'                End If                           
01478  |'            Case conColNavCom                    ||01475  |'            Case conColNavCom                    
01479  |'                '入力列のチェック                ||01476  |'                '入力列のチェック                
01480  |'                strtxt = Trim(.EditText)         ||01477  |'                strtxt = Trim(.EditText)         
01481  |'                If strtxt = "" Then '未入力      ||01478  |'                If strtxt = "" Then '未入力      
01482  |'                    .Cell(flexcpBackColor, Row, C||01479  |'                    .Cell(flexcpBackColor, Row, C
01483  |'                Else                             ||01480  |'                Else                             
01484  |'                    If (IsNumeric(strtxt) = False||01481  |'                    If (IsNumeric(strtxt) = False
01485  |'                        .Cell(flexcpBackColor, Ro||01482  |'                        .Cell(flexcpBackColor, Ro
01486  |'                        intRtn = MsgBox("換算レー||01483  |'                        intRtn = MsgBox("換算レー
01487  |'                            vbCritical, "換算レー||01484  |'                            vbCritical, "換算レー
01488  |'                    Else                         ||01485  |'                    Else                         
01489  |'                        .Cell(flexcpBackColor, Ro||01486  |'                        .Cell(flexcpBackColor, Ro
01490  |'                    End If                       ||01487  |'                    End If                       
01491  |'                End If                           ||01488  |'                End If                           
01492  |'            Case conColAmountCom                 ||01489  |'            Case conColAmountCom                 
01493  |'                '入力列のチェック                ||01490  |'                '入力列のチェック                
01494  |'                strtxt = Trim(.EditText)         ||01491  |'                strtxt = Trim(.EditText)         
01495  |'                If strtxt = "" Then '未入力      ||01492  |'                If strtxt = "" Then '未入力      
01496  |'                    .Cell(flexcpBackColor, Row, C||01493  |'                    .Cell(flexcpBackColor, Row, C
01497  |'                Else                             ||01494  |'                Else                             
01498  |'                    If (IsNumeric(strtxt) = False||01495  |'                    If (IsNumeric(strtxt) = False
01499  |'                        .Cell(flexcpBackColor, Ro||01496  |'                        .Cell(flexcpBackColor, Ro
01500  |'                        intRtn = MsgBox("換算レー||01497  |'                        intRtn = MsgBox("換算レー
01501  |'                            vbCritical, "換算レー||01498  |'                            vbCritical, "換算レー
01502  |'                    Else                         ||01499  |'                    Else                         
01503  |'                        .Cell(flexcpBackColor, Ro||01500  |'                        .Cell(flexcpBackColor, Ro
01504  |'                    End If                       ||01501  |'                    End If                       
01505  |'                End If                           ||01502  |'                End If                           
01506  |'            Case conColComPay                    ||01503  |'            Case conColComPay                    
01507  |'                '入力列のチェック                ||01504  |'                '入力列のチェック                
01508  |'                strtxt = Trim(.EditText)         ||01505  |'                strtxt = Trim(.EditText)         
01509  |'                If strtxt = "" Then '未入力      ||01506  |'                If strtxt = "" Then '未入力      
01510  |'                    .Cell(flexcpBackColor, Row, C||01507  |'                    .Cell(flexcpBackColor, Row, C
01511  |'                Else                             ||01508  |'                Else                             
01512  |'                    If (IsNumeric(strtxt) = False||01509  |'                    If (IsNumeric(strtxt) = False
01513  |'                        .Cell(flexcpBackColor, Ro||01510  |'                        .Cell(flexcpBackColor, Ro
01514  |'                        intRtn = MsgBox("換算レー||01511  |'                        intRtn = MsgBox("換算レー
01515  |'                            vbCritical, "換算レー||01512  |'                            vbCritical, "換算レー
01516  |'                    Else                         ||01513  |'                    Else                         
01517  |'                        .Cell(flexcpBackColor, Ro||01514  |'                        .Cell(flexcpBackColor, Ro
01518  |'                    End If                       ||01515  |'                    End If                       
01519  |'                End If                           ||01516  |'                End If                           
01520  |'        End Select                               ||01517  |'        End Select                               
01521  |''2005/01/11 End                                  ||01518  |''2005/01/11 End                                  
01522  |        '入力列のチェック                         ||01519  |        '入力列のチェック                         
01523  |        strtxt = gstrDateFormat(Trim(.EditText), 1||01520  |        strtxt = gstrDateFormat(Trim(.EditText), 1
01524  |        If strtxt = "" Then '未入力               ||01521  |        If strtxt = "" Then '未入力               
01525  |            .Cell(flexcpBackColor, Row, Col) = COL||01522  |            .Cell(flexcpBackColor, Row, Col) = COL
01526  |        Else                                      ||01523  |        Else                                      
01527  |            If (IsDate(strtxt) = False) Then      ||01524  |            If (IsDate(strtxt) = False) Then      
01528  |                .Cell(flexcpBackColor, Row, Col) =||01525  |                .Cell(flexcpBackColor, Row, Col) =
01529  |                intRtn = MsgBox("日付を入力してく ||01526  |                intRtn = MsgBox("日付を入力してく 
01530  |                    vbCritical, "日付チェック")   ||01527  |                    vbCritical, "日付チェック")   
01531  |            Else                                  ||01528  |            Else                                  
01532  |                .Cell(flexcpBackColor, Row, Col) =||01529  |                .Cell(flexcpBackColor, Row, Col) =
01533  |            End If                                ||01530  |            End If                                
01534  |        End If                                    ||01531  |        End If                                    
01535  |'2005/01/17 End                                   ||01532  |'2005/01/17 End                                   
01536  |                                                  ||01533  |                                                  
01537  |    End With                                      ||01534  |    End With                                      
01538  |EndProc:                                          ||01535  |EndProc:                                          
01539  |                                                  ||01536  |                                                  
01540  |End Sub                                           ||01537  |End Sub                                           
01541  |                                                  ||01538  |                                                  
01542  |'=================================================||01539  |'=================================================
01543  |'処理内容     FormResize時処理                    ||01540  |'処理内容     FormResize時処理                    
01544  |'備考                                             ||01541  |'備考                                             
01545  |'                                                 ||01542  |'                                                 
01546  |'日付         担当               内容             ||01543  |'日付         担当               内容             
01547  |'------------ ----------------- ------------------||01544  |'------------ ----------------- ------------------
01548  |'2004/08/23   M.Katoh <SRA>     新規作成          ||01545  |'2004/08/23   M.Katoh <SRA>     新規作成          
01549  |'=================================================||01546  |'=================================================
01550  |Private Sub Form_Resize()                         ||01547  |Private Sub Form_Resize()                         
01551  |    On Error GoTo OnErrorProc                     ||01548  |    On Error GoTo OnErrorProc                     
01552  |                                                  ||01549  |                                                  
01553  |    Const conMeModule As String = "Form_Resize" ' ||01550  |    Const conMeModule As String = "Form_Resize" ' 
01554  |    Dim strErrCall As String        'エラー呼出元 ||01551  |    Dim strErrCall As String        'エラー呼出元 
01555  |                                                  ||01552  |                                                  
01556  |    'エラー呼出元設定                             ||01553  |    'エラー呼出元設定                             
01557  |    strErrCall = conMeForm & ":" & conMeModule    ||01554  |    strErrCall = conMeForm & ":" & conMeModule    
01558  |                                                  ||01555  |                                                  
01559  |    ' フォームのサイズが変更されたときのリサイズ処||01556  |    ' フォームのサイズが変更されたときのリサイズ処
01560  |    ' 記述します。                                ||01557  |    ' 記述します。                                
01561  |    On Error Resume Next                          ||01558  |    On Error Resume Next                          
01562  |                                                  ||01559  |                                                  
01563  |    ' 上のグリッド(fgridDailyOtherCom)のリサイズ処||01560  |    ' 上のグリッド(fgridDailyOtherCom)のリサイズ処
01564  |    On Error Resume Next                          ||01561  |    On Error Resume Next                          
01565  |    Dim h!                                        ||01562  |    Dim h!                                        
01566  |    With fgridMakePrint                           ||01563  |    With fgridMakePrint                           
01567  |        h = ScaleHeight - .Top - .Left            ||01564  |        h = ScaleHeight - .Top - .Left            
01568  |        .Move .Left, .Top, ScaleWidth - 2 * .Left,||01565  |        .Move .Left, .Top, ScaleWidth - 2 * .Left,
01569  |    End With                                      ||01566  |    End With                                      
01570  |                                                  ||01567  |                                                  
01571  |    GoTo EndProc                                  ||01568  |    GoTo EndProc                                  
01572  |                                                  ||01569  |                                                  
01573  |OnErrorProc:                                      ||01570  |OnErrorProc:                                      
01574  |    Call subError("システムエラー", Str(Err.Number||01571  |    Call subError("システムエラー", Str(Err.Number
01575  |        Error, strErrCall, conTitle)              ||01572  |        Error, strErrCall, conTitle)              
01576  |    Exit Sub                                      ||01573  |    Exit Sub                                      
01577  |                                                  ||01574  |                                                  
01578  |ErrorProc:                                        ||01575  |ErrorProc:                                        
01579  |    Exit Sub                                      ||01576  |    Exit Sub                                      
01580  |                                                  ||01577  |                                                  
01581  |EndProc:                                          ||01578  |EndProc:                                          
01582  |                                                  ||01579  |                                                  
01583  |End Sub                                           ||01580  |End Sub                                           
01584  |                                                  ||01581  |                                                  
01585  |Private Sub mnuEnd_Click()                        ||01582  |Private Sub mnuEnd_Click()                        
01586  |    Unload Me                                     ||01583  |    Unload Me                                     
01587  |End Sub                                           ||01584  |End Sub                                           
01588  |                                                  ||01585  |                                                  
01589  |'=================================================||01586  |'=================================================
01590  |'処理内容  FormKeyDown時処理                      ||01587  |'処理内容  FormKeyDown時処理                      
01591  |'備考      FormのKeyPreviewをTrueにした上で、エン ||01588  |'備考      FormのKeyPreviewをTrueにした上で、エン 
01592  |'                                                 ||01589  |'                                                 
01593  |'日付         担当               内容             ||01590  |'日付         担当               内容             
01594  |'------------ ----------------- ------------------||01591  |'------------ ----------------- ------------------
01595  |'2004/04/01   H.Yonehara <SRA>  新規作成          ||01592  |'2004/04/01   H.Yonehara <SRA>  新規作成          
01596  |'=================================================||01593  |'=================================================
01597  |Private Sub Form_KeyDown(KeyCode As Integer, Shift||01594  |Private Sub Form_KeyDown(KeyCode As Integer, Shift
01598  |    If (KeyCode = vbKeyReturn) Then               ||01595  |    If (KeyCode = vbKeyReturn) Then               
01599  |        KeyCode = 0                               ||01596  |        KeyCode = 0                               
01600  |        SendKeys "{TAB}"                          ||01597  |        SendKeys "{TAB}"                          
01601  |    End If                                        ||01598  |    End If                                        
01602  |End Sub                                           ||01599  |End Sub                                           
01603  |                                                  ||01600  |                                                  
01604  |'=================================================||01601  |'=================================================
01605  |'処理内容     FormLoad時モジュール                ||01602  |'処理内容     FormLoad時モジュール                
01606  |'備考                                             ||01603  |'備考                                             
01607  |'                                                 ||01604  |'                                                 
01608  |'日付         担当               内容             ||01605  |'日付         担当               内容             
01609  |'------------ ----------------- ------------------||01606  |'------------ ----------------- ------------------
01610  |'2004/08/03   M.Katoh <SRA>     新規作成          ||01607  |'2004/08/03   M.Katoh <SRA>     新規作成          
01611  |'2008/03/12   K.Furuya<SRA>     ファンド決算期間で||01608  |'2008/03/12   K.Furuya<SRA>     ファンド決算期間で
01612  |'=================================================||01609  |'=================================================
01613 L|Private Sub form_load()                           ||01610 R|Private Sub Form_load()                           
01614  |    On Error GoTo OnErrorProc                     ||01611  |    On Error GoTo OnErrorProc                     
01615  |                                                  ||01612  |                                                  
01616  |    Const conMeModule As String = "Form_Load" '当 ||01613  |    Const conMeModule As String = "Form_Load" '当 
01617  |    Dim strErrCall As String        'エラー呼出元 ||01614  |    Dim strErrCall As String        'エラー呼出元 
01618  |                                                  ||01615  |                                                  
01619  |    'エラー呼出元設定                             ||01616  |    'エラー呼出元設定                             
01620  |    strErrCall = conMeForm & ":" & conMeModule    ||01617  |    strErrCall = conMeForm & ":" & conMeModule    
01621  |                                                  ||01618  |                                                  
01622  |    'マウスポインター砂時計                       ||01619  |    'マウスポインター砂時計                       
01623  |    Screen.MousePointer = vbHourglass             ||01620  |    Screen.MousePointer = vbHourglass             
01624  |                                                  ||01621  |                                                  
01625  |    '初期設定                                     ||01622  |    '初期設定                                     
01626  |    mblnFlgUnload = True                        'U||01623  |    mblnFlgUnload = True                        'U
01627  |    mblnFinishStatus = True                     ' ||01624  |    mblnFinishStatus = True                     ' 
01628  |    mblnDBClose = False                         'D||01625  |    mblnDBClose = False                         'D
01629  |    mblnDynasetOpen = False                     'D||01626  |    mblnDynasetOpen = False                     'D
01630  |    mblnDynasetClose = False                    'D||01627  |    mblnDynasetClose = False                    'D
01631  |    mblnRollback = False                        'D||01628  |    mblnRollback = False                        'D
01632  |    mstrbasedate = ""                           'G||01629  |    mstrbasedate = ""                           'G
01633  |    mstrYYYYMMDD = ""                           'm||01630  |    mstrYYYYMMDD = ""                           'm
01634  |    mstrYYYYMM = ""                               ||01631  |    mstrYYYYMM = ""                               
01635  |    mstrbaseToday = ""                           '||01632  |    mstrbaseToday = ""                           '
01636  |                                                  ||01633  |                                                  
01637  |    mstrYYYYMM = gstrZengetuYYYYMM                ||01634  |    mstrYYYYMM = gstrZengetuYYYYMM                
01638  |    mstrYYYYMMDD = gstrZengetuYYYYMMDD            ||01635  |    mstrYYYYMMDD = gstrZengetuYYYYMMDD            
01639  |    mstrbaseToday = gstrDateFormat2(CStr(DATE), 1)||01636  |    mstrbaseToday = gstrDateFormat2(CStr(DATE), 1)
01640  |                                                  ||01637  |                                                  
01641  |    '基準月セット                                 ||01638  |    '基準月セット                                 
01642  |    mstrbasedate = Trim(mstrYYYYMM)               ||01639  |    mstrbasedate = Trim(mstrYYYYMM)               
01643  |    mstrbaseMonth = Mid(mstrbasedate, 5, 2)       ||01640  |    mstrbaseMonth = Mid(mstrbasedate, 5, 2)       
01644  |    mstrbaseYear = Mid(mstrbasedate, 1, 4)        ||01641  |    mstrbaseYear = Mid(mstrbasedate, 1, 4)        
01645  |                                                  ||01642  |                                                  
01646  |    'コンスタント配列の取得(契約区分)             ||01643  |    'コンスタント配列の取得(契約区分)             
01647  |    Call gParseStringGet(CONTRACT_FLAG, mstrContra||01644  |    Call gParseStringGet(CONTRACT_FLAG, mstrContra
01648  |                                                  ||01645  |                                                  
01649  |'2006/07/13 START K.Furuya 期中料率変更契約/RAFI対||01646  |'2006/07/13 START K.Furuya 期中料率変更契約/RAFI対
01650  |'    Me.Width = 9705                              ||01647  |'    Me.Width = 9705                              
01651  |'    Me.Height = 6330                             ||01648  |'    Me.Height = 6330                             
01652  |'2008/03/12 START ファンド決算期間での外部委託顧問||01649  |'2008/03/12 START ファンド決算期間での外部委託顧問
01653  |'    Me.Width = 12945                             ||01650  |'    Me.Width = 12945                             
01654  |    Me.Width = 15950                              ||01651  |    Me.Width = 15950                              
01655  |'2008/03/12 END   ファンド決算期間での外部委託顧問||01652  |'2008/03/12 END   ファンド決算期間での外部委託顧問
01656  |    Me.Height = 8850                              ||01653  |    Me.Height = 8850                              
01657  |'2006/07/13 END   K.Furuya 期中料率変更契約/RAFI対||01654  |'2006/07/13 END   K.Furuya 期中料率変更契約/RAFI対
01658  |                                                  ||01655  |                                                  
01659  |    '画面共通初期処理                             ||01656  |    '画面共通初期処理                             
01660  |    Call gFormIni(Me)                             ||01657  |    Call gFormIni(Me)                             
01661  |                                                  ||01658  |                                                  
01662  |    '確認書作成情報グリッド初期処理               ||01659  |    '確認書作成情報グリッド初期処理               
01663  |    Call sbMakePrintFlexGridIni                   ||01660  |    Call sbMakePrintFlexGridIni                   
01664  |                                                  ||01661  |                                                  
01665  |    '出力日付に当日日付をセット                   ||01662  |    '出力日付に当日日付をセット                   
01666  |    txtSysOutDate.Text = Format(DATE, "YYYY/MM/DD"||01663  |    txtSysOutDate.Text = Format(DATE, "YYYY/MM/DD"
01667  |                                                  ||01664  |                                                  
01668  |'''''    '確認書作成データ抽出処理                ||01665  |'''''    '確認書作成データ抽出処理                
01669  |'''''    If fnMakePrintDataSet() = False Then     ||01666  |'''''    If fnMakePrintDataSet() = False Then     
01670  |'''''        Unload Me                            ||01667  |'''''        Unload Me                            
01671  |'''''        GoTo ErrorProc                       ||01668  |'''''        GoTo ErrorProc                       
01672  |'''''    Else                                     ||01669  |'''''    Else                                     
01673  |'''''        Me.Enabled = True                    ||01670  |'''''        Me.Enabled = True                    
01674  |'''''        Me.Refresh                           ||01671  |'''''        Me.Refresh                           
01675  |'''''    End If                                   ||01672  |'''''    End If                                   
01676  |                                                  ||01673  |                                                  
01677  |'2005/08/03大改修実施     '確認書作成データ抽出処 ||01674  |'2005/08/03大改修実施     '確認書作成データ抽出処 
01678  |    If fnMakePrintDataSet_New() = False Then      ||01675  |    If fnMakePrintDataSet_New() = False Then      
01679  |        Unload Me                                 ||01676  |        Unload Me                                 
01680  |        GoTo ErrorProc                            ||01677  |        GoTo ErrorProc                            
01681  |    Else                                          ||01678  |    Else                                          
01682  |        Me.Enabled = True                         ||01679  |        Me.Enabled = True                         
01683  |        Me.Refresh                                ||01680  |        Me.Refresh                                
01684  |    End If                                        ||01681  |    End If                                        
01685  |                                                  ||01682  |                                                  
01686  |    '部署名コンボボックスにコンスタントセット     ||01683  |    '部署名コンボボックスにコンスタントセット     
01687  |    Call gConstDataSetToCombo(cboBumonFlag, BUMON_||01684  |    Call gConstDataSetToCombo(cboBumonFlag, BUMON_
01688  |                                                  ||01685  |                                                  
01689  |''debug                                           ||01686  |''debug                                           
01690  |'txtInputName.Text = "吉 池"                      ||01687  |'txtInputName.Text = "吉 池"                      
01691  |'txtInputTax.Text = "5"                           ||01688  |'txtInputTax.Text = "5"                           
01692  |                                                  ||01689  |                                                  
01693  |    GoTo EndProc                                  ||01690  |    GoTo EndProc                                  
01694  |                                                  ||01691  |                                                  
01695  |OnErrorProc:                                      ||01692  |OnErrorProc:                                      
01696  |    Call subError("システムエラー", Str(Err.Number||01693  |    Call subError("システムエラー", Str(Err.Number
01697  |        Error, strErrCall, conTitle)              ||01694  |        Error, strErrCall, conTitle)              
01698  |    Exit Sub                                      ||01695  |    Exit Sub                                      
01699  |                                                  ||01696  |                                                  
01700  |ErrorProc:                                        ||01697  |ErrorProc:                                        
01701  |    'マウスポインター元に戻す                     ||01698  |    'マウスポインター元に戻す                     
01702  |    Screen.MousePointer = vbDefault               ||01699  |    Screen.MousePointer = vbDefault               
01703  |    Exit Sub                                      ||01700  |    Exit Sub                                      
01704  |                                                  ||01701  |                                                  
01705  |EndProc:                                          ||01702  |EndProc:                                          
01706  |    'マウスポインター元に戻す                     ||01703  |    'マウスポインター元に戻す                     
01707  |    Screen.MousePointer = vbDefault               ||01704  |    Screen.MousePointer = vbDefault               
01708  |End Sub                                           ||01705  |End Sub                                           
01709  |                                                  ||01706  |                                                  
01710  |'=================================================||01707  |'=================================================
01711  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnMakePrintDataSet_New       ||01708  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnMakePrintDataSet_New       
01712  |'機能            :   確認書作成テーブルデータ抽出 ||01709  |'機能            :   確認書作成テーブルデータ抽出 
01713  |'                                                 ||01710  |'                                                 
01714  |'日付               担当　              修正内容  ||01711  |'日付               担当　              修正内容  
01715  |'-------------------------------------------------||01712  |'-------------------------------------------------
01716  |'2005/08/03         K.Nishihama<SRA>   新規作成   ||01713  |'2005/08/03         K.Nishihama<SRA>   新規作成   
01717  |'2014/02/19         M.Takada   <SRA>   【管理会計 ||01714  |'2014/02/19         M.Takada   <SRA>   【管理会計 
01718  |'=================================================||01715  |'=================================================
01719  |Private Function fnMakePrintDataSet_New() As Boole||01716  |Private Function fnMakePrintDataSet_New() As Boole
01720  |                                                  ||01717  |                                                  
01721  |    Const conMeModule   As String = "fnMakePrintDa||01718  |    Const conMeModule   As String = "fnMakePrintDa
01722  |    Dim strErrCall      As String        'エラー呼||01719  |    Dim strErrCall      As String        'エラー呼
01723  |    Dim sSql            As String                 ||01720  |    Dim sSql            As String                 
01724  |    Dim lRecCnt         As Long                   ||01721  |    Dim lRecCnt         As Long                   
01725  |    Dim lActiveIdx      As Long                   ||01722  |    Dim lActiveIdx      As Long                   
01726  |    Dim iRet            As Integer                ||01723  |    Dim iRet            As Integer                
01727  |    Dim intRtn As Long                            ||01724  |    Dim intRtn As Long                            
01728  |    Dim strCommandLine As String                  ||01725  |    Dim strCommandLine As String                  
01729  |                                                  ||01726  |                                                  
01730  |    '初期処理                                     ||01727  |    '初期処理                                     
01731  |    fnMakePrintDataSet_New = False                ||01728  |    fnMakePrintDataSet_New = False                
01732  |                                                  ||01729  |                                                  
01733  |    'エラー呼出元設定                             ||01730  |    'エラー呼出元設定                             
01734  |    strErrCall = conMeForm & ":" & conMeModule    ||01731  |    strErrCall = conMeForm & ":" & conMeModule    
01735  |                                                  ||01732  |                                                  
01736  |    '起動するUNIXバッチ名とクライアントテンポラリ ||01733  |    '起動するUNIXバッチ名とクライアントテンポラリ 
01737  |    gstrCfrBatch = gstrCfrRootDir & gstrCfrExeDir ||01734  |    gstrCfrBatch = gstrCfrRootDir & gstrCfrExeDir 
01738  |    gstrCfrBatchTempFile = gstrCfrBatchConfirmDraw||01735  |    gstrCfrBatchTempFile = gstrCfrBatchConfirmDraw
01739  |                                                  ||01736  |                                                  
01740  |    strCommandLine = _                            ||01737  |    strCommandLine = _                            
01741  |        "cmd.exe /c rsh.exe" _                    ||01738  |        "cmd.exe /c rsh.exe" _                    
01742  |        & " " & gstrCfrUnixServer _               ||01739  |        & " " & gstrCfrUnixServer _               
01743  |        & " -l " & gstrCfrUnixUser _              ||01740  |        & " -l " & gstrCfrUnixUser _              
01744  |        & " " & gstrCfrBatch _                    ||01741  |        & " " & gstrCfrBatch _                    
01745  |        & " > " & gstrCfrBatchTempFile            ||01742  |        & " > " & gstrCfrBatchTempFile            
01746  |                                                  ||01743  |                                                  
01747  |        ' コマンドの実行                          ||01744  |        ' コマンドの実行                          
01748  |    If Not SyncShell(strCommandLine, vbHide) Then ||01745  |    If Not SyncShell(strCommandLine, vbHide) Then 
01749  |        intRtn = MsgBox("システムエラー：SyncShell||01746  |        intRtn = MsgBox("システムエラー：SyncShell
01750  |        Exit Function                             ||01747  |        Exit Function                             
01751  |    End If                                        ||01748  |    End If                                        
01752  |                                                  ||01749  |                                                  
01753  |    'ｲﾝﾃﾞｯｸｽ初期化                                ||01750  |    'ｲﾝﾃﾞｯｸｽ初期化                                
01754  |    lRecCnt = 0                                   ||01751  |    lRecCnt = 0                                   
01755  |    lRowCnt = 0                                   ||01752  |    lRowCnt = 0                                   
01756  |    lActiveIdx = 0                                ||01753  |    lActiveIdx = 0                                
01757  |    'DBオープン                                   ||01754  |    'DBオープン                                   
01758  |    If Not gintDbOpen() Then                      ||01755  |    If Not gintDbOpen() Then                      
01759  |        Exit Function                             ||01756  |        Exit Function                             
01760  |    End If                                        ||01757  |    End If                                        
01761  |                                                  ||01758  |                                                  
01762  |    'SQL文作成 一覧表示データ取得                 ||01759  |    'SQL文作成 一覧表示データ取得                 
01763  |    sSql = ""                                     ||01760  |    sSql = ""                                     
01764  |    sSql = sSql & "SELECT * FROM CFR_DETAIL_TBL or||01761  |    sSql = sSql & "SELECT * FROM CFR_DETAIL_TBL or
01765  |                                                  ||01762  |                                                  
01766  |    'ﾀﾞｲﾅｾｯﾄの作成                                ||01763  |    'ﾀﾞｲﾅｾｯﾄの作成                                
01767  |    If (gintDyCreate(sSql) = False) Then          ||01764  |    If (gintDyCreate(sSql) = False) Then          
01768  |        Call subError("DBエラー", Str(9999), "gint||01765  |        Call subError("DBエラー", Str(9999), "gint
01769  |            "DB関数エラー", strErrCall, conTitle) ||01766  |            "DB関数エラー", strErrCall, conTitle) 
01770  |        Exit Function                             ||01767  |        Exit Function                             
01771  |    End If                                        ||01768  |    End If                                        
01772  |                                                  ||01769  |                                                  
01773  |    '配列初期化                                   ||01770  |    '配列初期化                                   
01774  |    ReDim gbuMGetUPDRec.N(0)                      ||01771  |    ReDim gbuMGetUPDRec.N(0)                      
01775  |                                                  ||01772  |                                                  
01776  |    'EOF判定処理                                  ||01773  |    'EOF判定処理                                  
01777  |    Do Until gblnDyEOF()                          ||01774  |    Do Until gblnDyEOF()                          
01778  |        '対象データ抽出                           ||01775  |        '対象データ抽出                           
01779  |        '配列にセット                             ||01776  |        '配列にセット                             
01780  |        Call sbMGetDataGet(lRecCnt)               ||01777  |        Call sbMGetDataGet(lRecCnt)               
01781  |        lRecCnt = lRecCnt + 1                     ||01778  |        lRecCnt = lRecCnt + 1                     
01782  |        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                         ||01779  |        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                         
01783  |        Call gDyNext                              ||01780  |        Call gDyNext                              
01784  |    Loop                                          ||01781  |    Loop                                          
01785  |                                                  ||01782  |                                                  
01786  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             ||01783  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             
01787  |    Call gblnDyClose                              ||01784  |    Call gblnDyClose                              
01788  |                                                  ||01785  |                                                  
01789  |'2014/02/19 START M.Takada 【管理会計】消費税率変 ||01786  |'2014/02/19 START M.Takada 【管理会計】消費税率変 
01790  |    ''SQL文作成 消費税率取得                      ||01787  |    ''SQL文作成 消費税率取得                      
01791  |    'sSql = "SELECT CONSUMPTION_TAX FROM CFR_CONSU||01788  |    'sSql = "SELECT CONSUMPTION_TAX FROM CFR_CONSU
01792  |                                                  ||01789  |                                                  
01793  |    ''ﾀﾞｲﾅｾｯﾄの作成                               ||01790  |    ''ﾀﾞｲﾅｾｯﾄの作成                               
01794  |    'If (gintDyCreate(sSql) = False) Then         ||01791  |    'If (gintDyCreate(sSql) = False) Then         
01795  |    '    Call subError("DBエラー", Str(9999), "gin||01792  |    '    Call subError("DBエラー", Str(9999), "gin
01796  |    '        "DB関数エラー", strErrCall, conTitle)||01793  |    '        "DB関数エラー", strErrCall, conTitle)
01797  |    '    Exit Function                            ||01794  |    '    Exit Function                            
01798  |    'End If                                       ||01795  |    'End If                                       
01799  |                                                  ||01796  |                                                  
01800  |    'ddblconsumption_tax = gvlnDyDataN("CONSUMPTIO||01797  |    'ddblconsumption_tax = gvlnDyDataN("CONSUMPTIO
01801  |                                                  ||01798  |                                                  
01802  |    ''ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                            ||01799  |    ''ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                            
01803  |    'Call gblnDyClose                             ||01800  |    'Call gblnDyClose                             
01804  |'2014/02/19 END   M.Takada 【管理会計】消費税率変 ||01801  |'2014/02/19 END   M.Takada 【管理会計】消費税率変 
01805  |                                                  ||01802  |                                                  
01806  |    'グリッドデータセット処理                     ||01803  |    'グリッドデータセット処理                     
01807  |    lRecCnt = 0                                   ||01804  |    lRecCnt = 0                                   
01808  |    For lRecCnt = LBound(gbuMGetUPDRec.N) To UBoun||01805  |    For lRecCnt = LBound(gbuMGetUPDRec.N) To UBoun
01809  |        'グリッドの行カウンターアップ             ||01806  |        'グリッドの行カウンターアップ             
01810  |        lRowCnt = lRowCnt + 1                     ||01807  |        lRowCnt = lRowCnt + 1                     
01811  |        'グリッドにセット                         ||01808  |        'グリッドにセット                         
01812  |        Call sbMakePrintFlexGridDataSet(lRowCnt, l||01809  |        Call sbMakePrintFlexGridDataSet(lRowCnt, l
01813  |    Next lRecCnt                                  ||01810  |    Next lRecCnt                                  
01814  |                                                  ||01811  |                                                  
01815  |    With fgridMakePrint                           ||01812  |    With fgridMakePrint                           
01816  |        '抽出０件の場合は出力ボタンを無効にする   ||01813  |        '抽出０件の場合は出力ボタンを無効にする   
01817  |        If lRowCnt = 0 Then                       ||01814  |        If lRowCnt = 0 Then                       
01818  |            cmdMake.Enabled = False               ||01815  |            cmdMake.Enabled = False               
01819  |            iRet = MsgBox("出力情報がありません。"||01816  |            iRet = MsgBox("出力情報がありません。"
01820  |            .Editable = flexEDNone        'グリッ ||01817  |            .Editable = flexEDNone        'グリッ 
01821  |        Else                                      ||01818  |        Else                                      
01822  |            cmdMake.Enabled = True                ||01819  |            cmdMake.Enabled = True                
01823  |            .Editable = flexEDKbdMouse    'グリッ ||01820  |            .Editable = flexEDKbdMouse    'グリッ 
01824  |            .Select 1, 0                          ||01821  |            .Select 1, 0                          
01825  |        End If                                    ||01822  |        End If                                    
01826  |                                                  ||01823  |                                                  
01827  |        'スクロールバー表示・非表示設定           ||01824  |        'スクロールバー表示・非表示設定           
01828  |        If lRowCnt < 16 Then                      ||01825  |        If lRowCnt < 16 Then                      
01829  |            .Left = .Left + 120                   ||01826  |            .Left = .Left + 120                   
01830  |            .Width = .Width - 240                 ||01827  |            .Width = .Width - 240                 
01831  |        End If                                    ||01828  |        End If                                    
01832  |                                                  ||01829  |                                                  
01833  |        If lRowCnt > 1 Then                       ||01830  |        If lRowCnt > 1 Then                       
01834  |            '表示行設定                           ||01831  |            '表示行設定                           
01835  |            .TopRow = lActiveIdx                  ||01832  |            .TopRow = lActiveIdx                  
01836  |            lActiveIdx = lActiveIdx + 1           ||01833  |            lActiveIdx = lActiveIdx + 1           
01837  |            .Row = lActiveIdx                     ||01834  |            .Row = lActiveIdx                     
01838  |        End If                                    ||01835  |        End If                                    
01839  |                                                  ||01836  |                                                  
01840  |        'グリッド表示                             ||01837  |        'グリッド表示                             
01841  |        .Visible = True                           ||01838  |        .Visible = True                           
01842  |    End With                                      ||01839  |    End With                                      
01843  |                                                  ||01840  |                                                  
01844  |    '戻り値セット                                 ||01841  |    '戻り値セット                                 
01845  |    fnMakePrintDataSet_New = True                 ||01842  |    fnMakePrintDataSet_New = True                 
01846  |                                                  ||01843  |                                                  
01847  |End Function                                      ||01844  |End Function                                      
01848  |                                                  ||01845  |                                                  
01849  |'=================================================||01846  |'=================================================
01850  |'処理内容  同期実行                               ||01847  |'処理内容  同期実行                               
01851  |'備考                                             ||01848  |'備考                                             
01852  |'                                                 ||01849  |'                                                 
01853  |'日付         担当               内容             ||01850  |'日付         担当               内容             
01854  |'------------ ----------------- ------------------||01851  |'------------ ----------------- ------------------
01855  |'2004/03/17   H.Yonehara <SRA>  新規作成          ||01852  |'2004/03/17   H.Yonehara <SRA>  新規作成          
01856  |'=================================================||01853  |'=================================================
01857  |' 同期実行                                        ||01854  |' 同期実行                                        
01858  |Private Function SyncShell(ByVal cmdLine, ByVal wi||01855  |Private Function SyncShell(ByVal cmdLine, ByVal wi
01859  |    Dim processId As Long                         ||01856  |    Dim processId As Long                         
01860  |    Dim hProcess As Long                          ||01857  |    Dim hProcess As Long                          
01861  |    Dim Ret As Long                               ||01858  |    Dim Ret As Long                               
01862  |    Dim intRtn As Integer                         ||01859  |    Dim intRtn As Integer                         
01863  |'    Dim exitCode As Long                         ||01860  |'    Dim exitCode As Long                         
01864  |                                                  ||01861  |                                                  
01865  |    SyncShell = False                             ||01862  |    SyncShell = False                             
01866  |                                                  ||01863  |                                                  
01867  |    On Error Resume Next                          ||01864  |    On Error Resume Next                          
01868  |    processId = 0                                 ||01865  |    processId = 0                                 
01869  |    processId = Shell(cmdLine, windowStyle)       ||01866  |    processId = Shell(cmdLine, windowStyle)       
01870  |    If processId = 0 Then                         ||01867  |    If processId = 0 Then                         
01871  |        intRtn = MsgBox("システムエラー：起動エラ ||01868  |        intRtn = MsgBox("システムエラー：起動エラ 
01872  |           vbCritical + vbOKOnly, conTitle)       ||01869  |           vbCritical + vbOKOnly, conTitle)       
01873  |        'MsgBox "起動エラー(PC内)"                ||01870  |        'MsgBox "起動エラー(PC内)"                
01874  |        Exit Function                             ||01871  |        Exit Function                             
01875  |    End If                                        ||01872  |    End If                                        
01876  |    On Error GoTo 0                               ||01873  |    On Error GoTo 0                               
01877  |                                                  ||01874  |                                                  
01878  |    hProcess = OpenProcess(SYNCHRONIZE, 0, process||01875  |    hProcess = OpenProcess(SYNCHRONIZE, 0, process
01879  |    If hProcess = 0 Then                          ||01876  |    If hProcess = 0 Then                          
01880  |        intRtn = MsgBox("システムエラー：プロセス ||01877  |        intRtn = MsgBox("システムエラー：プロセス 
01881  |            vbCritical + vbOKOnly, conTitle)      ||01878  |            vbCritical + vbOKOnly, conTitle)      
01882  |        'MsgBox "プロセスハンドル取得エラー"      ||01879  |        'MsgBox "プロセスハンドル取得エラー"      
01883  |        Exit Function                             ||01880  |        Exit Function                             
01884  |    End If                                        ||01881  |    End If                                        
01885  |                                                  ||01882  |                                                  
01886  |'   ★画面を書き換えたい場合は、こっち            ||01883  |'   ★画面を書き換えたい場合は、こっち            
01887  |'   ※但しDoEventで機能ボタンや×ボタンを押せてし ||01884  |'   ※但しDoEventで機能ボタンや×ボタンを押せてし 
01888  |'     イベントが起こってしまうので対処が必要      ||01885  |'     イベントが起こってしまうので対処が必要      
01889  |'    ret = WaitForSingleObject(hProcess, 100)     ||01886  |'    ret = WaitForSingleObject(hProcess, 100)     
01890  |'    Do While ret = WAIT_TIMEOUT                  ||01887  |'    Do While ret = WAIT_TIMEOUT                  
01891  |'        DoEvents                                 ||01888  |'        DoEvents                                 
01892  |'        ret = WaitForSingleObject(hProcess, 100) ||01889  |'        ret = WaitForSingleObject(hProcess, 100) 
01893  |'    Loop                                         ||01890  |'    Loop                                         
01894  |'   ★画面を固めてしまって良い場合は､こっち       ||01891  |'   ★画面を固めてしまって良い場合は､こっち       
01895  |    Ret = WaitForSingleObject(hProcess, INFINITE) ||01892  |    Ret = WaitForSingleObject(hProcess, INFINITE) 
01896  |                                                  ||01893  |                                                  
01897  |'   終了コード取得・・・意味ない                  ||01894  |'   終了コード取得・・・意味ない                  
01898  |'    ret = GetExitCodeProcess(hProcess, exitCode) ||01895  |'    ret = GetExitCodeProcess(hProcess, exitCode) 
01899  |'    Debug.Print "EXIT = " & exitCode             ||01896  |'    Debug.Print "EXIT = " & exitCode             
01900  |                                                  ||01897  |                                                  
01901  |    Ret = CloseHandle(hProcess)                   ||01898  |    Ret = CloseHandle(hProcess)                   
01902  |                                                  ||01899  |                                                  
01903  |    SyncShell = True                              ||01900  |    SyncShell = True                              
01904  |End Function                                      ||01901  |End Function                                      
01905  |                                                  ||01902  |                                                  
01906  |'=================================================||01903  |'=================================================
01907  |'処理内容     FormUnload時モジュール              ||01904  |'処理内容     FormUnload時モジュール              
01908  |'備考                                             ||01905  |'備考                                             
01909  |'                                                 ||01906  |'                                                 
01910  |'日付         担当               内容             ||01907  |'日付         担当               内容             
01911  |'------------ ----------------- ------------------||01908  |'------------ ----------------- ------------------
01912  |'2004/08/03   M.Katoh <SRA>     新規作成          ||01909  |'2004/08/03   M.Katoh <SRA>     新規作成          
01913  |'=================================================||01910  |'=================================================
01914  |Private Sub Form_Unload(Cancel As Integer)        ||01911  |Private Sub Form_Unload(Cancel As Integer)        
01915  |    On Error GoTo OnErrorProc                     ||01912  |    On Error GoTo OnErrorProc                     
01916  |                                                  ||01913  |                                                  
01917  |    Const conMeModule As String = "Form_Unload" ' ||01914  |    Const conMeModule As String = "Form_Unload" ' 
01918  |    Dim strErrCall As String        'エラー呼出元 ||01915  |    Dim strErrCall As String        'エラー呼出元 
01919  |                                                  ||01916  |                                                  
01920  |    'エラー呼出元設定                             ||01917  |    'エラー呼出元設定                             
01921  |    strErrCall = conMeForm & ":" & conMeModule    ||01918  |    strErrCall = conMeForm & ":" & conMeModule    
01922  |                                                  ||01919  |                                                  
01923  |    '初期設定                                     ||01920  |    '初期設定                                     
01924  |     mblnFlgUnload = False                        ||01921  |     mblnFlgUnload = False                        
01925  |                                                  ||01922  |                                                  
01926  |    'Dynasetクローズ処理                          ||01923  |    'Dynasetクローズ処理                          
01927  |    If gblnDynasetClose Then                      ||01924  |    If gblnDynasetClose Then                      
01928  |        If Not gblnDyClose Then                   ||01925  |        If Not gblnDyClose Then                   
01929  |            Call subError("DBエラー", Str(9999), "||01926  |            Call subError("DBエラー", Str(9999), "
01930  |                "DB関数エラー", strErrCall, conTit||01927  |                "DB関数エラー", strErrCall, conTit
01931  |        End If                                    ||01928  |        End If                                    
01932  |    End If                                        ||01929  |    End If                                        
01933  |                                                  ||01930  |                                                  
01934  |    '一応、変数開放する方向で…                   ||01931  |    '一応、変数開放する方向で…                   
01935  |    Set xlApp = Nothing                           ||01932  |    Set xlApp = Nothing                           
01936  |    Set xlBook = Nothing                          ||01933  |    Set xlBook = Nothing                          
01937  |    Set xlSheet = Nothing                         ||01934  |    Set xlSheet = Nothing                         
01938  |                                                  ||01935  |                                                  
01939  |    gblnDynasetClose = False                      ||01936  |    gblnDynasetClose = False                      
01940  |                                                  ||01937  |                                                  
01941  |    GoTo EndProc                                  ||01938  |    GoTo EndProc                                  
01942  |                                                  ||01939  |                                                  
01943  |OnErrorProc:                                      ||01940  |OnErrorProc:                                      
01944  |    Call subError("システムエラー", Str(Err.Number||01941  |    Call subError("システムエラー", Str(Err.Number
01945  |        Error, strErrCall, conTitle)              ||01942  |        Error, strErrCall, conTitle)              
01946  |    'マウスポインター元に戻す                     ||01943  |    'マウスポインター元に戻す                     
01947  |    Screen.MousePointer = vbDefault               ||01944  |    Screen.MousePointer = vbDefault               
01948  |    Exit Sub                                      ||01945  |    Exit Sub                                      
01949  |                                                  ||01946  |                                                  
01950  |EndProc:                                          ||01947  |EndProc:                                          
01951  |    'マウスポインター元に戻す                     ||01948  |    'マウスポインター元に戻す                     
01952  |    Screen.MousePointer = vbDefault               ||01949  |    Screen.MousePointer = vbDefault               
01953  |                                                  ||01950  |                                                  
01954  |End Sub                                           ||01951  |End Sub                                           
01955  |                                                  ||01952  |                                                  
01956  |'=================================================||01953  |'=================================================
01957  |'処理内容     確認書出力ボタン押下時処理          ||01954  |'処理内容     確認書出力ボタン押下時処理          
01958  |'備考                                             ||01955  |'備考                                             
01959  |'                                                 ||01956  |'                                                 
01960  |'日付         担当               内容             ||01957  |'日付         担当               内容             
01961  |'------------ ----------------- ------------------||01958  |'------------ ----------------- ------------------
01962  |'2004/08/03   M.Katoh <SRA>     新規作成          ||01959  |'2004/08/03   M.Katoh <SRA>     新規作成          
01963  |                                                  ||01960  |                                                  
01964  |'=================================================||01961  |'=================================================
01965  |Private Sub cmdMake_Click()                       ||01962  |Private Sub cmdMake_Click()                       
01966  |                                                  ||01963  |                                                  
01967  |    Const conMeModule   As String = "cmdMake_Click||01964  |    Const conMeModule   As String = "cmdMake_Click
01968  |    Dim strErrCall      As String        'エラー呼||01965  |    Dim strErrCall      As String        'エラー呼
01969  |    Dim dDate           As Date                   ||01966  |    Dim dDate           As Date                   
01970  |    Dim strFname        As String                 ||01967  |    Dim strFname        As String                 
01971  |    Dim iRet            As Integer                ||01968  |    Dim iRet            As Integer                
01972  |    Dim iIdx    As Integer                        ||01969  |    Dim iIdx    As Integer                        
01973  |    Dim ChkFLG$                                   ||01970  |    Dim ChkFLG$                                   
01974  |                                                  ||01971  |                                                  
01975  |On Error Resume Next                              ||01972  |On Error Resume Next                              
01976  |                                                  ||01973  |                                                  
01977  |    'エラー呼出元設定                             ||01974  |    'エラー呼出元設定                             
01978  |    strErrCall = conMeForm & ":" & conMeModule    ||01975  |    strErrCall = conMeForm & ":" & conMeModule    
01979  |                                                  ||01976  |                                                  
01980  |    'マウスポインター砂時計                       ||01977  |    'マウスポインター砂時計                       
01981  |    Screen.MousePointer = vbHourglass             ||01978  |    Screen.MousePointer = vbHourglass             
01982  |                                                  ||01979  |                                                  
01983  |    '出力チェックボックスのチェック確認           ||01980  |    '出力チェックボックスのチェック確認           
01984  |    ChkFLG = "OFF"                                ||01981  |    ChkFLG = "OFF"                                
01985  |    With fgridMakePrint                           ||01982  |    With fgridMakePrint                           
01986  |        .Col = conColSysOutbln   '出力フラグを選択||01983  |        .Col = conColSysOutbln   '出力フラグを選択
01987  |                                                  ||01984  |                                                  
01988  |'        For iIdx = .LeftCol - 1 To .Rows - 1     ||01985  |'        For iIdx = .LeftCol - 1 To .Rows - 1     
01989  |        For iIdx = 0 To .Rows - 1                 ||01986  |        For iIdx = 0 To .Rows - 1                 
01990  |            .Row = iIdx                           ||01987  |            .Row = iIdx                           
01991  |            '現在行の取消チェックボックスを確認し ||01988  |            '現在行の取消チェックボックスを確認し 
01992  |            If .CellChecked = flexChecked Or .Cell||01989  |            If .CellChecked = flexChecked Or .Cell
01993  |                ChkFLG = "ON"                     ||01990  |                ChkFLG = "ON"                     
01994  |                Exit For                          ||01991  |                Exit For                          
01995  |            End If                                ||01992  |            End If                                
01996  |        Next iIdx                                 ||01993  |        Next iIdx                                 
01997  |        'フラグが「OFF」なら、処理中止            ||01994  |        'フラグが「OFF」なら、処理中止            
01998  |        If ChkFLG = "OFF" Then                    ||01995  |        If ChkFLG = "OFF" Then                    
01999  |            MsgBox "出力チェックボックスが１つもチ||01996  |            MsgBox "出力チェックボックスが１つもチ
02000  |            GoTo EndProc                          ||01997  |            GoTo EndProc                          
02001  |        End If                                    ||01998  |        End If                                    
02002  |    End With                                      ||01999  |    End With                                      
02003  |                                                  ||02000  |                                                  
02004  |    '入力チェック                                 ||02001  |    '入力チェック                                 
02005  |    If fnNyuryokuCheck = False Then               ||02002  |    If fnNyuryokuCheck = False Then               
02006  |        'マウスポインター元に戻す                 ||02003  |        'マウスポインター元に戻す                 
02007  |        Screen.MousePointer = vbDefault           ||02004  |        Screen.MousePointer = vbDefault           
02008  |        Exit Sub                                  ||02005  |        Exit Sub                                  
02009  |    End If                                        ||02006  |    End If                                        
02010  |                                                  ||02007  |                                                  
02011  |    'ファイル上書き確認                           ||02008  |    'ファイル上書き確認                           
02012  |    dlgFileOut.Flags = cdlOFNOverwritePrompt + cdl||02009  |    dlgFileOut.Flags = cdlOFNOverwritePrompt + cdl
02013  |    'キャンセル時エラーとする                     ||02010  |    'キャンセル時エラーとする                     
02014  |    dlgFileOut.CancelError = True                 ||02011  |    dlgFileOut.CancelError = True                 
02015  |    'ｺﾓﾝﾀﾞｲｱﾛｸﾞ表示                               ||02012  |    'ｺﾓﾝﾀﾞｲｱﾛｸﾞ表示                               
02016  |    dlgFileOut.ShowSave                           ||02013  |    dlgFileOut.ShowSave                           
02017  |    'ファイル名を保存する                         ||02014  |    'ファイル名を保存する                         
02018  |    mstrFileName = dlgFileOut.FileName            ||02015  |    mstrFileName = dlgFileOut.FileName            
02019  |    mstrFileNameBK = mstrFileName                 ||02016  |    mstrFileNameBK = mstrFileName                 
02020  |                                                  ||02017  |                                                  
02021  |    'エラー確認                                   ||02018  |    'エラー確認                                   
02022  |    If Err.Number <> 0 Then                       ||02019  |    If Err.Number <> 0 Then                       
02023  |        'キャンセル時                             ||02020  |        'キャンセル時                             
02024  |        Err.Clear                                 ||02021  |        Err.Clear                                 
02025  |        'マウスポインター元に戻す                 ||02022  |        'マウスポインター元に戻す                 
02026  |        Screen.MousePointer = vbDefault           ||02023  |        Screen.MousePointer = vbDefault           
02027  |        Exit Sub                                  ||02024  |        Exit Sub                                  
02028  |    End If                                        ||02025  |    End If                                        
02029  |                                                  ||02026  |                                                  
02030  |On Error GoTo OnErrorProc                         ||02027  |On Error GoTo OnErrorProc                         
02031  |                                                  ||02028  |                                                  
02032  |    '指定したファイルの使用チェック               ||02029  |    '指定したファイルの使用チェック               
02033  |    If fnblnUseCheck(mstrFileName) = False Then   ||02030  |    If fnblnUseCheck(mstrFileName) = False Then   
02034  |        GoTo EndProc                              ||02031  |        GoTo EndProc                              
02035  |    End If                                        ||02032  |    End If                                        
02036  |                                                  ||02033  |                                                  
02037  |    'グリッドの非表示                             ||02034  |    'グリッドの非表示                             
02038  |    fgridMakePrint.Visible = False                ||02035  |    fgridMakePrint.Visible = False                
02039  |                                                  ||02036  |                                                  
02040  |    'カウンターの初期化                           ||02037  |    'カウンターの初期化                           
02041  |    gSaveFileCnt = 0                              ||02038  |    gSaveFileCnt = 0                              
02042  |    gProcessCnt = 0                               ||02039  |    gProcessCnt = 0                               
02043  |    gTotalProcessCnt = 0                          ||02040  |    gTotalProcessCnt = 0                          
02044  |'2005/03/09 Start                                 ||02041  |'2005/03/09 Start                                 
02045  |    gTotalDnavCnt = 0                             ||02042  |    gTotalDnavCnt = 0                             
02046  |    gTotalCnt = 0                                 ||02043  |    gTotalCnt = 0                                 
02047  |    dstrOldAccCode = ""                           ||02044  |    dstrOldAccCode = ""                           
02048  |'2005/03/09 End                                   ||02045  |'2005/03/09 End                                   
02049  |                                                  ||02046  |                                                  
02050  |    '確認書作成モジュール実行                     ||02047  |    '確認書作成モジュール実行                     
02051  |'2006/07/03 START K.Furuya 期中料率変更契約/RAFI対||02048  |'2006/07/03 START K.Furuya 期中料率変更契約/RAFI対
02052  |'    If fnblMakePrint() = False Then              ||02049  |'    If fnblMakePrint() = False Then              
02053  |'        GoTo OnErrorProc                         ||02050  |'        GoTo OnErrorProc                         
02054  |'    End If                                       ||02051  |'    End If                                       
02055  |    If fnblMakePrint_New() = False Then           ||02052  |    If fnblMakePrint_New() = False Then           
02056  |        GoTo OnErrorProc                          ||02053  |        GoTo OnErrorProc                          
02057  |    End If                                        ||02054  |    End If                                        
02058  |'2006/07/03 END   K.Furuya 期中料率変更契約/RAFI対||02055  |'2006/07/03 END   K.Furuya 期中料率変更契約/RAFI対
02059  |                                                  ||02056  |                                                  
02060  |    'グリッドの表示                               ||02057  |    'グリッドの表示                               
02061  |    fgridMakePrint.Visible = True                 ||02058  |    fgridMakePrint.Visible = True                 
02062  |                                                  ||02059  |                                                  
02063  |    iRet = MsgBox("確認書をEXCELファイルに出力しま||02060  |    iRet = MsgBox("確認書をEXCELファイルに出力しま
02064  |                                                  ||02061  |                                                  
02065  |    GoTo EndProc                                  ||02062  |    GoTo EndProc                                  
02066  |                                                  ||02063  |                                                  
02067  |OnErrorProc:                                      ||02064  |OnErrorProc:                                      
02068  |    Call subError("システムエラー", Str(Err.Number||02065  |    Call subError("システムエラー", Str(Err.Number
02069  |        Error, strErrCall, conTitle)              ||02066  |        Error, strErrCall, conTitle)              
02070  |    'マウスポインター元に戻す                     ||02067  |    'マウスポインター元に戻す                     
02071  |    Screen.MousePointer = vbDefault               ||02068  |    Screen.MousePointer = vbDefault               
02072  |                                                  ||02069  |                                                  
02073  |EndProc:                                          ||02070  |EndProc:                                          
02074  |    'マウスポインター元に戻す                     ||02071  |    'マウスポインター元に戻す                     
02075  |    Screen.MousePointer = vbDefault               ||02072  |    Screen.MousePointer = vbDefault               
02076  |End Sub                                           ||02073  |End Sub                                           
02077  |                                                  ||02074  |                                                  
02078  |'=================================================||02075  |'=================================================
02079  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblnUseCheck                ||02076  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblnUseCheck                
02080  |'機能            :   同名ファイルを保存する(上書き||02077  |'機能            :   同名ファイルを保存する(上書き
02081  |'                   そのファイルが使用されていない||02078  |'                   そのファイルが使用されていない
02082  |'                                                 ||02079  |'                                                 
02083  |'日付         担当               内容             ||02080  |'日付         担当               内容             
02084  |'------------ ----------------- ------------------||02081  |'------------ ----------------- ------------------
02085  |'2004/08/03   M.Katoh <SRA>     新規作成          ||02082  |'2004/08/03   M.Katoh <SRA>     新規作成          
02086  |'=================================================||02083  |'=================================================
02087  |Private Function fnblnUseCheck( _                 ||02084  |Private Function fnblnUseCheck( _                 
02088  |    ByVal FName As String _                       ||02085  |    ByVal FName As String _                       
02089  |) As Boolean                                      ||02086  |) As Boolean                                      
02090  |    On Error Resume Next                          ||02087  |    On Error Resume Next                          
02091  |    Dim strFile     As String                     ||02088  |    Dim strFile     As String                     
02092  |                                                  ||02089  |                                                  
02093  |    '戻り値初期化                                 ||02090  |    '戻り値初期化                                 
02094  |    fnblnUseCheck = False                         ||02091  |    fnblnUseCheck = False                         
02095  |                                                  ||02092  |                                                  
02096  |    'ファイルが存在するか調べる                   ||02093  |    'ファイルが存在するか調べる                   
02097  |    strFile = Dir$(FName)                         ||02094  |    strFile = Dir$(FName)                         
02098  |    If Len(strFile) = 0 Then                      ||02095  |    If Len(strFile) = 0 Then                      
02099  |        'ファイルが存在しなければ問題なし         ||02096  |        'ファイルが存在しなければ問題なし         
02100  |    Else                                          ||02097  |    Else                                          
02101  |        'ファイルがあればファイルの名前を同じ名前 ||02098  |        'ファイルがあればファイルの名前を同じ名前 
02102  |        Name FName As FName                       ||02099  |        Name FName As FName                       
02103  |        'ファイルが使用中であればエラーが発生しま ||02100  |        'ファイルが使用中であればエラーが発生しま 
02104  |        If Err.Number Then                        ||02101  |        If Err.Number Then                        
02105  |            MsgBox "上書きしようとしたファイルは使||02102  |            MsgBox "上書きしようとしたファイルは使
02106  |            'エラーが発生した場合は Err オブジェク||02103  |            'エラーが発生した場合は Err オブジェク
02107  |            Err.Clear                             ||02104  |            Err.Clear                             
02108  |            Exit Function                         ||02105  |            Exit Function                         
02109  |        End If                                    ||02106  |        End If                                    
02110  |    End If                                        ||02107  |    End If                                        
02111  |                                                  ||02108  |                                                  
02112  |    '正常戻り値をセットする                       ||02109  |    '正常戻り値をセットする                       
02113  |    fnblnUseCheck = True                          ||02110  |    fnblnUseCheck = True                          
02114  |                                                  ||02111  |                                                  
02115  |End Function                                      ||02112  |End Function                                      
02116  |                                                  ||02113  |                                                  
02117  |'=================================================||02114  |'=================================================
02118  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblMakePrint                ||02115  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblMakePrint                
02119  |'機能            :   確認書のExcel出力            ||02116  |'機能            :   確認書のExcel出力            
02120  |'                                                 ||02117  |'                                                 
02121  |'日付               担当　              修正内容  ||02118  |'日付               担当　              修正内容  
02122  |'-------------------------------------------------||02119  |'-------------------------------------------------
02123  |'2004/08/03         M.Katoh<SRA>       新規作成   ||02120  |'2004/08/03         M.Katoh<SRA>       新規作成   
02124  |'2004/09/02         M.Yamazaki<SRA>     複数ページ||02121  |'2004/09/02         M.Yamazaki<SRA>     複数ページ
02125  |'2004/09/21         M.Yamazaki<SRA>    １契約に対 ||02122  |'2004/09/21         M.Yamazaki<SRA>    １契約に対 
02126  |'2004/11/08         M.Yamazaki<SRA>    NAVが倍にな||02123  |'2004/11/08         M.Yamazaki<SRA>    NAVが倍にな
02127  |'2004/11/16         M.Yamazaki<SRA>    前回締日が ||02124  |'2004/11/16         M.Yamazaki<SRA>    前回締日が 
02128  |'2004/12/13         M.Yamazaki<SRA>    前回締日取 ||02125  |'2004/12/13         M.Yamazaki<SRA>    前回締日取 
02129  |'2005/02/02         M.Yamazaki<SRA>    前回締日取 ||02126  |'2005/02/02         M.Yamazaki<SRA>    前回締日取 
02130  |'2005/02/22         S.Kaketani<SRA>    前回締日取 ||02127  |'2005/02/22         S.Kaketani<SRA>    前回締日取 
02131  |'2006/07/03         K.Furuya <SRA>     期中料率変 ||02128  |'2006/07/03         K.Furuya <SRA>     期中料率変 
02132  |'                                      ソースが煩 ||02129  |'                                      ソースが煩 
02133  |'                                      作り変えの ||02130  |'                                      作り変えの 
02134  |'=================================================||02131  |'=================================================
02135  |Private Function fnblMakePrint( _                 ||02132  |Private Function fnblMakePrint( _                 
02136  |) As Boolean                                      ||02133  |) As Boolean                                      
02137  |                                                  ||02134  |                                                  
02138  |                                                  ||02135  |                                                  
02139  |'#################################################||02136  |'#################################################
02140  |'2006/07/03 START K.Furuya 期中料率変更契約/RAFI対||02137  |'2006/07/03 START K.Furuya 期中料率変更契約/RAFI対
02141  |'#################################################||02138  |'#################################################
02142  |'    Dim sSql            As String                ||02139  |'    Dim sSql            As String                
02143  |'    Dim lRecCnt         As Long                  ||02140  |'    Dim lRecCnt         As Long                  
02144  |'    Dim lRecDayCnt      As Long                  ||02141  |'    Dim lRecDayCnt      As Long                  
02145  |'    Dim lGridCnt        As Long                  ||02142  |'    Dim lGridCnt        As Long                  
02146  |'    Dim Cnt             As Long                  ||02143  |'    Dim Cnt             As Long                  
02147  |'    Dim MonthlyCnt      As Long                  ||02144  |'    Dim MonthlyCnt      As Long                  
02148  |'    Dim sStart          As String                ||02145  |'    Dim sStart          As String                
02149  |'    Dim sEnd            As String                ||02146  |'    Dim sEnd            As String                
02150  |'    Dim sContractNo     As String                ||02147  |'    Dim sContractNo     As String                
02151  |'    Dim sAccCode        As String                ||02148  |'    Dim sAccCode        As String                
02152  |'    Dim sCurrencyCode   As String                ||02149  |'    Dim sCurrencyCode   As String                
02153  |'    Dim sBaseDate       As String                ||02150  |'    Dim sBaseDate       As String                
02154  |'    Dim sSettleDate     As String                ||02151  |'    Dim sSettleDate     As String                
02155  |'    Dim sRuleNo         As String                ||02152  |'    Dim sRuleNo         As String                
02156  |'    Dim sPayDate        As String                ||02153  |'    Dim sPayDate        As String                
02157  |'    Dim ParaYear        As String                ||02154  |'    Dim ParaYear        As String                
02158  |'    Dim ParaMonth       As String                ||02155  |'    Dim ParaMonth       As String                
02159  |'    Dim ParaDay         As String                ||02156  |'    Dim ParaDay         As String                
02160  |'    Dim sZenkai         As String                ||02157  |'    Dim sZenkai         As String                
02161  |'    Dim sNearMonth      As String                ||02158  |'    Dim sNearMonth      As String                
02162  |'    Dim LastYearFlag    As Boolean               ||02159  |'    Dim LastYearFlag    As Boolean               
02163  |'    Dim strErrCall      As String                ||02160  |'    Dim strErrCall      As String                
02164  |'    Const conMeModule   As String = "fnblMakePrin||02161  |'    Const conMeModule   As String = "fnblMakePrin
02165  |''2004/09/21 Start                                ||02162  |''2004/09/21 Start                                
02166  |'    Dim sContNo         As String                ||02163  |'    Dim sContNo         As String                
02167  |''2004/09/21 End                                  ||02164  |''2004/09/21 End                                  
02168  |''2004/11/08 Start                                ||02165  |''2004/11/08 Start                                
02169  |'    Dim ddblNav As Double                        ||02166  |'    Dim ddblNav As Double                        
02170  |'    Dim ddblCnt As Double                        ||02167  |'    Dim ddblCnt As Double                        
02171  |'    Dim ddblNavTotal                             ||02168  |'    Dim ddblNavTotal                             
02172  |'    Dim dstrMonthOld As String                   ||02169  |'    Dim dstrMonthOld As String                   
02173  |'    Dim dstrMonthNew As String                   ||02170  |'    Dim dstrMonthNew As String                   
02174  |'    Dim i As Integer                             ||02171  |'    Dim i As Integer                             
02175  |''2004/11/08 End                                  ||02172  |''2004/11/08 End                                  
02176  |'                                                 ||02173  |'                                                 
02177  |'On Error GoTo OnErrorProc                        ||02174  |'On Error GoTo OnErrorProc                        
02178  |'                                                 ||02175  |'                                                 
02179  |'    '戻り値初期化                                ||02176  |'    '戻り値初期化                                
02180  |'    fnblMakePrint = False                        ||02177  |'    fnblMakePrint = False                        
02181  |'                                                 ||02178  |'                                                 
02182  |'    'エラー呼出元設定                            ||02179  |'    'エラー呼出元設定                            
02183  |'    strErrCall = conMeForm & ":" & conMeModule   ||02180  |'    strErrCall = conMeForm & ":" & conMeModule   
02184  |'                                                 ||02181  |'                                                 
02185  |'    '初期化                                      ||02182  |'    '初期化                                      
02186  |'    lRecCnt = 0                                  ||02183  |'    lRecCnt = 0                                  
02187  |'    lRecDayCnt = 0                               ||02184  |'    lRecDayCnt = 0                               
02188  |'    gProcessCnt = 0                              ||02185  |'    gProcessCnt = 0                              
02189  |'    lGridCnt = 0                                 ||02186  |'    lGridCnt = 0                                 
02190  |'    ddblNav = 0                                  ||02187  |'    ddblNav = 0                                  
02191  |'    ddblCnt = 0                                  ||02188  |'    ddblCnt = 0                                  
02192  |'                                                 ||02189  |'                                                 
02193  |'    'DBオープン                                  ||02190  |'    'DBオープン                                  
02194  |'    If Not gintDbOpen() Then                     ||02191  |'    If Not gintDbOpen() Then                     
02195  |'        Exit Function                            ||02192  |'        Exit Function                            
02196  |'    End If                                       ||02193  |'    End If                                       
02197  |'                                                 ||02194  |'                                                 
02198  |'    'グリッドデータを配列に格納する              ||02195  |'    'グリッドデータを配列に格納する              
02199  |'    '配列初期化                                  ||02196  |'    '配列初期化                                  
02200  |'    ReDim gbuMGetUPDRec.N(0)                     ||02197  |'    ReDim gbuMGetUPDRec.N(0)                     
02201  |'    'スプレット表示件数が１件以上の場合のみ      ||02198  |'    'スプレット表示件数が１件以上の場合のみ      
02202  |'    With fgridMakePrint                          ||02199  |'    With fgridMakePrint                          
02203  |'        If .Rows > 1 Then                        ||02200  |'        If .Rows > 1 Then                        
02204  |'            'グリッドデータセット処理            ||02201  |'            'グリッドデータセット処理            
02205  |'            For lGridCnt = 0 To .Rows - 2        ||02202  |'            For lGridCnt = 0 To .Rows - 2        
02206  |'                '出力列を選択する                ||02203  |'                '出力列を選択する                
02207  |'                .Col = conColSysOutbln           ||02204  |'                .Col = conColSysOutbln           
02208  |'                .Row = lGridCnt + 1              ||02205  |'                .Row = lGridCnt + 1              
02209  |'                If .Text = True Then             ||02206  |'                If .Text = True Then             
02210  |'                    '対象データ抽出              ||02207  |'                    '対象データ抽出              
02211  |'                    Call sbGridDataGet(lGridCnt, ||02208  |'                    Call sbGridDataGet(lGridCnt, 
02212  |'                    '配列の要素数設定カウンターア||02209  |'                    '配列の要素数設定カウンターア
02213  |'                    lRecCnt = lRecCnt + 1        ||02210  |'                    lRecCnt = lRecCnt + 1        
02214  |'                End If                           ||02211  |'                End If                           
02215  |'            Next lGridCnt                        ||02212  |'            Next lGridCnt                        
02216  |'        Else                                     ||02213  |'        Else                                     
02217  |'            MsgBox "グリッドデータがないですよ！"||02214  |'            MsgBox "グリッドデータがないですよ！"
02218  |'            Exit Function                        ||02215  |'            Exit Function                        
02219  |'        End If                                   ||02216  |'        End If                                   
02220  |'        '後で使うので、カウンター変数を初期化    ||02217  |'        '後で使うので、カウンター変数を初期化    
02221  |'        lRecCnt = 0                              ||02218  |'        lRecCnt = 0                              
02222  |'    End With                                     ||02219  |'    End With                                     
02223  |'                                                 ||02220  |'                                                 
02224  |'    '取得した契約番号分ループする                ||02221  |'    '取得した契約番号分ループする                
02225  |'    For Cnt = LBound(gbuMGetUPDRec.N) To UBound(g||02222  |'    For Cnt = LBound(gbuMGetUPDRec.N) To UBound(g
02226  |'            '変数の初期化                        ||02223  |'            '変数の初期化                        
02227  |'            mstrPaymentDate = ""                 ||02224  |'            mstrPaymentDate = ""                 
02228  |'            mstrNearSettleDate = ""              ||02225  |'            mstrNearSettleDate = ""              
02229  |'            mstrSettlementDate = ""              ||02226  |'            mstrSettlementDate = ""              
02230  |'            MonthlyCnt = 0                       ||02227  |'            MonthlyCnt = 0                       
02231  |'            LastYearFlag = False                 ||02228  |'            LastYearFlag = False                 
02232  |'            '支払予定日をセット                  ||02229  |'            '支払予定日をセット                  
02233  |''2004/09/02 Start                                ||02230  |''2004/09/02 Start                                
02234  |''            fgridMakePrint.Col = conColPayMentDa||02231  |''            fgridMakePrint.Col = conColPayMentDa
02235  |''            fgridMakePrint.Row = Cnt + 1        ||02232  |''            fgridMakePrint.Row = Cnt + 1        
02236  |''            sPayDate = fgridMakePrint.Text      ||02233  |''            sPayDate = fgridMakePrint.Text      
02237  |''            mstrPaymentDate = fgridMakePrint.Tex||02234  |''            mstrPaymentDate = fgridMakePrint.Tex
02238  |'            sPayDate = gbuMGetUPDRec.N(Cnt).MGET_||02235  |'            sPayDate = gbuMGetUPDRec.N(Cnt).MGET_
02239  |'            mstrPaymentDate = gbuMGetUPDRec.N(Cnt||02236  |'            mstrPaymentDate = gbuMGetUPDRec.N(Cnt
02240  |''2004/09/02 End                                  ||02237  |''2004/09/02 End                                  
02241  |'            '処理回数をカウントアップ            ||02238  |'            '処理回数をカウントアップ            
02242  |'            gProcessCnt = gProcessCnt + 1        ||02239  |'            gProcessCnt = gProcessCnt + 1        
02243  |''SQL文の作成(外部委託顧問料締日取得)             ||02240  |''SQL文の作成(外部委託顧問料締日取得)             
02244  |'            sContractNo = gbuMGetUPDRec.N(Cnt).MG||02241  |'            sContractNo = gbuMGetUPDRec.N(Cnt).MG
02245  |'            sSettleDate = gbuMGetUPDRec.N(Cnt).MG||02242  |'            sSettleDate = gbuMGetUPDRec.N(Cnt).MG
02246  |'            '基準年をセット                      ||02243  |'            '基準年をセット                      
02247  |'            mstrbaseYear = Mid(sSettleDate, 1, 4)||02244  |'            mstrbaseYear = Mid(sSettleDate, 1, 4)
02248  |'            '直近締日を設定                      ||02245  |'            '直近締日を設定                      
02249  |'            mstrNearSettleDate = sSettleDate     ||02246  |'            mstrNearSettleDate = sSettleDate     
02250  |'                                                 ||02247  |'                                                 
02251  |''2005/02/02 Start                                ||02248  |''2005/02/02 Start                                
02252  |''            '前回締日を設定する                 ||02249  |''            '前回締日を設定する                 
02253  |''            sSettleDate = gbuMGetUPDRec.N(Cnt).M||02250  |''            sSettleDate = gbuMGetUPDRec.N(Cnt).M
02254  |'''2004/12/13 Start                               ||02251  |'''2004/12/13 Start                               
02255  |'''            sSql = gstrEditSQLcfr_MaxSettlement||02252  |'''            sSql = gstrEditSQLcfr_MaxSettlement
02256  |'''                    sContractNo, Mid(sSettleDat||02253  |'''                    sContractNo, Mid(sSettleDat
02257  |''            sSql = gstrEditSQLcfr_MaxSettlementD||02254  |''            sSql = gstrEditSQLcfr_MaxSettlementD
02258  |''                    sContractNo, mstrbaseToday, ||02255  |''                    sContractNo, mstrbaseToday, 
02259  |'''2004/12/13 End                                 ||02256  |'''2004/12/13 End                                 
02260  |''            'ﾀﾞｲﾅｾｯﾄの作成                      ||02257  |''            'ﾀﾞｲﾅｾｯﾄの作成                      
02261  |''            If gintDyCreate(sSql) = False Then  ||02258  |''            If gintDyCreate(sSql) = False Then  
02262  |''                Exit Function                   ||02259  |''                Exit Function                   
02263  |''            End If                              ||02260  |''            End If                              
02264  |''            'EOF判定処理                        ||02261  |''            'EOF判定処理                        
02265  |''            If gblnDyEOF() = False Then         ||02262  |''            If gblnDyEOF() = False Then         
02266  |''                '対象締日データ抽出             ||02263  |''                '対象締日データ抽出             
02267  |''                mstrSettlementDate = gvlnDyDataS||02264  |''                mstrSettlementDate = gvlnDyDataS
02268  |''            End If                              ||02265  |''            End If                              
02269  |''            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                   ||02266  |''            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                   
02270  |''            Call gblnDyClose                    ||02267  |''            Call gblnDyClose                    
02271  |''                '前回締日を設定                 ||02268  |''                '前回締日を設定                 
02272  |''            If Mid(mstrNearSettleDate, 5, 4) < m||02269  |''            If Mid(mstrNearSettleDate, 5, 4) < m
02273  |''                '前年フラグを更新               ||02270  |''                '前年フラグを更新               
02274  |''                LastYearFlag = True             ||02271  |''                LastYearFlag = True             
02275  |''            End If                              ||02272  |''            End If                              
02276  |''                                                ||02273  |''                                                
02277  |'''前回締日が去年の場合の処理                     ||02274  |'''前回締日が去年の場合の処理                     
02278  |''            If mstrSettlementDate = "" Then     ||02275  |''            If mstrSettlementDate = "" Then     
02279  |''                '前年フラグを更新               ||02276  |''                '前年フラグを更新               
02280  |''                LastYearFlag = True             ||02277  |''                LastYearFlag = True             
02281  |''                'SQL文の作成(外部委託顧問料締日 ||02278  |''                'SQL文の作成(外部委託顧問料締日 
02282  |'''2004/12/13 Start                               ||02279  |'''2004/12/13 Start                               
02283  |'''                sSql = gstrEditSQLcfr_MaxSettle||02280  |'''                sSql = gstrEditSQLcfr_MaxSettle
02284  |'''                    sContractNo)               ||02281  |'''                    sContractNo)               
02285  |''                sSql = gstrEditSQLcfr_MaxSettlem||02282  |''                sSql = gstrEditSQLcfr_MaxSettlem
02286  |''                    sContractNo, mstrbaseToday) ||02283  |''                    sContractNo, mstrbaseToday) 
02287  |'''2004/12/13 End                                 ||02284  |'''2004/12/13 End                                 
02288  |''                'ﾀﾞｲﾅｾｯﾄの作成                  ||02285  |''                'ﾀﾞｲﾅｾｯﾄの作成                  
02289  |''                If gintDyCreate(sSql) = False Th||02286  |''                If gintDyCreate(sSql) = False Th
02290  |''                    Exit Function               ||02287  |''                    Exit Function               
02291  |''                End If                          ||02288  |''                End If                          
02292  |''                '対象締日データ抽出             ||02289  |''                '対象締日データ抽出             
02293  |''                mstrSettlementDate = gvlnDyDataS||02290  |''                mstrSettlementDate = gvlnDyDataS
02294  |''                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理               ||02291  |''                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理               
02295  |''                Call gblnDyClose                ||02292  |''                Call gblnDyClose                
02296  |''            End If                              ||02293  |''            End If                              
02297  |''                                                ||02294  |''                                                
02298  |''            '締日取得のチェック                 ||02295  |''            '締日取得のチェック                 
02299  |''            If mstrSettlementDate = "" Then     ||02296  |''            If mstrSettlementDate = "" Then     
02300  |''                MsgBox "締日が取得できてません。||02297  |''                MsgBox "締日が取得できてません。
02301  |''                Exit Function                   ||02298  |''                Exit Function                   
02302  |''            End If                              ||02299  |''            End If                              
02303  |''                                                ||02300  |''                                                
02304  |''            '営業フラグチェック(締日をYYYYMMDD形||02301  |''            '営業フラグチェック(締日をYYYYMMDD形
02305  |''            '前回締日                           ||02302  |''            '前回締日                           
02306  |''            If LastYearFlag = True Then         ||02303  |''            If LastYearFlag = True Then         
02307  |''                ParaYear = Mid((CInt(mstrbaseYea||02304  |''                ParaYear = Mid((CInt(mstrbaseYea
02308  |''            Else                                ||02305  |''            Else                                
02309  |''                ParaYear = Mid(mstrbaseYear, 1, ||02306  |''                ParaYear = Mid(mstrbaseYear, 1, 
02310  |''            End If                              ||02307  |''            End If                              
02311  |''            mstrSettlementDate = ParaYear & mstr||02308  |''            mstrSettlementDate = ParaYear & mstr
02312  |'''2004/11/16 Start                               ||02309  |'''2004/11/16 Start                               
02313  |''            'カレンダーテーブル該当データ取得用 ||02310  |''            'カレンダーテーブル該当データ取得用 
02314  |''            sSql = gstrEditSQLCalGetSelect(mstrS||02311  |''            sSql = gstrEditSQLCalGetSelect(mstrS
02315  |''            'ﾀﾞｲﾅｾｯﾄの作成                      ||02312  |''            'ﾀﾞｲﾅｾｯﾄの作成                      
02316  |''            If gintDyCreate(sSql) = False Then  ||02313  |''            If gintDyCreate(sSql) = False Then  
02317  |''                Exit Function                   ||02314  |''                Exit Function                   
02318  |''            End If                              ||02315  |''            End If                              
02319  |''            'EOF判定処理                        ||02316  |''            'EOF判定処理                        
02320  |''            If gblnDyEOF() = False Then         ||02317  |''            If gblnDyEOF() = False Then         
02321  |''                '対象締日抽出                   ||02318  |''                '対象締日抽出                   
02322  |''                mstrSettlementDate = gvlnDyDataN||02319  |''                mstrSettlementDate = gvlnDyDataN
02323  |''            End If                              ||02320  |''            End If                              
02324  |''            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                   ||02321  |''            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                   
02325  |''            Call gblnDyClose                    ||02322  |''            Call gblnDyClose                    
02326  |'''2004/11/16 End                                 ||02323  |'''2004/11/16 End                                 
02327  |'            '前回締日営業日翌日の設定            ||02324  |'            '前回締日営業日翌日の設定            
02328  |'            mstrSettlementDate = gbuMGetUPDRec.N(||02325  |'            mstrSettlementDate = gbuMGetUPDRec.N(
02329  |''2005/02/02 End                                  ||02326  |''2005/02/02 End                                  
02330  |'        '顧問料計算開始日・終了日との整合性をチェ||02327  |'        '顧問料計算開始日・終了日との整合性をチェ
02331  |'            sStart = gbuMGetUPDRec.N(Cnt).MGET_co||02328  |'            sStart = gbuMGetUPDRec.N(Cnt).MGET_co
02332  |'            sEnd = gbuMGetUPDRec.N(Cnt).MGET_com_||02329  |'            sEnd = gbuMGetUPDRec.N(Cnt).MGET_com_
02333  |'            '前回締日 < 顧問料計算開始日 の場合、||02330  |'            '前回締日 < 顧問料計算開始日 の場合、
02334  |'            If sStart <> "" Then                 ||02331  |'            If sStart <> "" Then                 
02335  |'                If mstrSettlementDate < sStart Th||02332  |'                If mstrSettlementDate < sStart Th
02336  |'                    mstrSettlementDate = sStart  ||02333  |'                    mstrSettlementDate = sStart  
02337  |''2005/02/02 Start                                ||02334  |''2005/02/02 Start                                
02338  |''                Else                            ||02335  |''                Else                            
02339  |''                    '前回締日に変更がない場合は ||02336  |''                    '前回締日に変更がない場合は 
02340  |''                    mstrSettlementDate = gstrDat||02337  |''                    mstrSettlementDate = gstrDat
02341  |''2005/02/02 End                                  ||02338  |''2005/02/02 End                                  
02342  |'                End If                           ||02339  |'                End If                           
02343  |''2005/02/02 Start                                ||02340  |''2005/02/02 Start                                
02344  |''            Else                                ||02341  |''            Else                                
02345  |''                '前回締日に変更がない場合は、前 ||02342  |''                '前回締日に変更がない場合は、前 
02346  |''                mstrSettlementDate = gstrDateFor||02343  |''                mstrSettlementDate = gstrDateFor
02347  |''2005/02/02 End                                  ||02344  |''2005/02/02 End                                  
02348  |'            End If                               ||02345  |'            End If                               
02349  |''2005/02/02 Start                                ||02346  |''2005/02/02 Start                                
02350  |''            '前回締日に+1した時に、年を跨いだ場 ||02347  |''            '前回締日に+1した時に、年を跨いだ場 
02351  |''            If Mid(mstrSettlementDate, 1, 4) = m||02348  |''            If Mid(mstrSettlementDate, 1, 4) = m
02352  |''                LastYearFlag = False            ||02349  |''                LastYearFlag = False            
02353  |''            End If                              ||02350  |''            End If                              
02354  |''2005/02/02 End                                  ||02351  |''2005/02/02 End                                  
02355  |'                                                 ||02352  |'                                                 
02356  |'            '直近締日 < 顧問料計算終了日 の場合、||02353  |'            '直近締日 < 顧問料計算終了日 の場合、
02357  |'            If sEnd <> "" Then                   ||02354  |'            If sEnd <> "" Then                   
02358  |'                If mstrNearSettleDate > sEnd Then||02355  |'                If mstrNearSettleDate > sEnd Then
02359  |'                    mstrNearSettleDate = sEnd    ||02356  |'                    mstrNearSettleDate = sEnd    
02360  |'                End If                           ||02357  |'                End If                           
02361  |'            End If                               ||02358  |'            End If                               
02362  |'                                                 ||02359  |'                                                 
02363  |''SQL文の作成(日次NAV取得)                        ||02360  |''SQL文の作成(日次NAV取得)                        
02364  |''2004/09/21 Start                                ||02361  |''2004/09/21 Start                                
02365  |''            sAccCode = gbuMGetUPDRec.N(Cnt).MGET||02362  |''            sAccCode = gbuMGetUPDRec.N(Cnt).MGET
02366  |''            sCurrencyCode = gbuMGetUPDRec.N(Cnt)||02363  |''            sCurrencyCode = gbuMGetUPDRec.N(Cnt)
02367  |''            '日次NAVは当年度のNAVを取得する     ||02364  |''            '日次NAVは当年度のNAVを取得する     
02368  |''            sSql = gstrEditSQLcfr_DailyNavForSel||02365  |''            sSql = gstrEditSQLcfr_DailyNavForSel
02369  |''                sAccCode, mstrNearSettleDate, sC||02366  |''                sAccCode, mstrNearSettleDate, sC
02370  |'            sContNo = gbuMGetUPDRec.N(Cnt).MGET_c||02367  |'            sContNo = gbuMGetUPDRec.N(Cnt).MGET_c
02371  |'            '日次NAVは当年度のNAVを取得する      ||02368  |'            '日次NAVは当年度のNAVを取得する      
02372  |'            sSql = gstrEditSQLcfr_DailyNavForSele||02369  |'            sSql = gstrEditSQLcfr_DailyNavForSele
02373  |'                sContNo, mstrNearSettleDate)     ||02370  |'                sContNo, mstrNearSettleDate)     
02374  |''2004/09/21 End                                  ||02371  |''2004/09/21 End                                  
02375  |'            'ﾀﾞｲﾅｾｯﾄの作成                       ||02372  |'            'ﾀﾞｲﾅｾｯﾄの作成                       
02376  |'            If gintDyCreate(sSql) = False Then   ||02373  |'            If gintDyCreate(sSql) = False Then   
02377  |'                Exit Function                    ||02374  |'                Exit Function                    
02378  |'            End If                               ||02375  |'            End If                               
02379  |''2004/11/08 Start                                ||02376  |''2004/11/08 Start                                
02380  |''            '対象締日データ抽出                 ||02377  |''            '対象締日データ抽出                 
02381  |''            mstrDailyNav = gvlnDyDataS("NET_ASSE||02378  |''            mstrDailyNav = gvlnDyDataS("NET_ASSE
02382  |'            mstrDailyNav = 0                     ||02379  |'            mstrDailyNav = 0                     
02383  |'            ddblNav = 0                          ||02380  |'            ddblNav = 0                          
02384  |'            ddblCnt = 0                          ||02381  |'            ddblCnt = 0                          
02385  |'            'EOF判定処理                         ||02382  |'            'EOF判定処理                         
02386  |'            Do Until gblnDyEOF()                 ||02383  |'            Do Until gblnDyEOF()                 
02387  |'                ddblNav = gvlnDyDataN("NET_ASSET_||02384  |'                ddblNav = gvlnDyDataN("NET_ASSET_
02388  |'                ddblCnt = gvlnDyDataN("NAV_CNT") ||02385  |'                ddblCnt = gvlnDyDataN("NAV_CNT") 
02389  |'                If ddblCnt > 0 Then              ||02386  |'                If ddblCnt > 0 Then              
02390  |'                    mstrDailyNav = mstrDailyNav +||02387  |'                    mstrDailyNav = mstrDailyNav +
02391  |'                Else                             ||02388  |'                Else                             
02392  |'                    mstrDailyNav = mstrDailyNav +||02389  |'                    mstrDailyNav = mstrDailyNav +
02393  |'                End If                           ||02390  |'                End If                           
02394  |'                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                ||02391  |'                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                
02395  |'                Call gDyNext                     ||02392  |'                Call gDyNext                     
02396  |'            Loop                                 ||02393  |'            Loop                                 
02397  |''2004/11/08 End                                  ||02394  |''2004/11/08 End                                  
02398  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    ||02395  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    
02399  |'            Call gblnDyClose                     ||02396  |'            Call gblnDyClose                     
02400  |'                                                 ||02397  |'                                                 
02401  |''SQL文の作成(月次NAV取得)                        ||02398  |''SQL文の作成(月次NAV取得)                        
02402  |'            '配列初期化                          ||02399  |'            '配列初期化                          
02403  |'            ReDim gtypcfr_mnav_tbl(0)            ||02400  |'            ReDim gtypcfr_mnav_tbl(0)            
02404  |'                                                 ||02401  |'                                                 
02405  |''2005/02/22 Start                                ||02402  |''2005/02/22 Start                                
02406  |'            '前回締日の月をセット(YYYYMM形式でセ ||02403  |'            '前回締日の月をセット(YYYYMM形式でセ 
02407  |''            If LastYearFlag = True Then         ||02404  |''            If LastYearFlag = True Then         
02408  |''                sZenkai = CStr(CInt(mstrbaseYear||02405  |''                sZenkai = CStr(CInt(mstrbaseYear
02409  |''            Else                                ||02406  |''            Else                                
02410  |''                sZenkai = mstrbaseYear & Mid(mst||02407  |''                sZenkai = mstrbaseYear & Mid(mst
02411  |''            End If                              ||02408  |''            End If                              
02412  |'             sZenkai = Mid(mstrSettlementDate, 1,||02409  |'             sZenkai = Mid(mstrSettlementDate, 1,
02413  |''2005/02/22 Start                                ||02410  |''2005/02/22 Start                                
02414  |'                                                 ||02411  |'                                                 
02415  |'            '直近締日の月の前月をセット          ||02412  |'            '直近締日の月の前月をセット          
02416  |'            sNearMonth = DateAdd("m", -1, gstrDat||02413  |'            sNearMonth = DateAdd("m", -1, gstrDat
02417  |'            sNearMonth = Mid(gstrDateFormat2(sNea||02414  |'            sNearMonth = Mid(gstrDateFormat2(sNea
02418  |'                                                 ||02415  |'                                                 
02419  |''2004/09/21 Start                                ||02416  |''2004/09/21 Start                                
02420  |''            sSql = gstrEditSQLcfr_MonthlyNavForS||02417  |''            sSql = gstrEditSQLcfr_MonthlyNavForS
02421  |''                sAccCode, sNearMonth, sZenkai, s||02418  |''                sAccCode, sNearMonth, sZenkai, s
02422  |'            sSql = gstrEditSQLcfr_MonthlyNavForSe||02419  |'            sSql = gstrEditSQLcfr_MonthlyNavForSe
02423  |'                sContNo, sNearMonth, sZenkai)    ||02420  |'                sContNo, sNearMonth, sZenkai)    
02424  |''2004/09/21 End                                  ||02421  |''2004/09/21 End                                  
02425  |'            'ﾀﾞｲﾅｾｯﾄの作成                       ||02422  |'            'ﾀﾞｲﾅｾｯﾄの作成                       
02426  |'            If gintDyCreate(sSql) = False Then   ||02423  |'            If gintDyCreate(sSql) = False Then   
02427  |'                Exit Function                    ||02424  |'                Exit Function                    
02428  |'            End If                               ||02425  |'            End If                               
02429  |''2004/11/08 Start                                ||02426  |''2004/11/08 Start                                
02430  |'            dstrMonthOld = ""                    ||02427  |'            dstrMonthOld = ""                    
02431  |'            dstrMonthNew = ""                    ||02428  |'            dstrMonthNew = ""                    
02432  |'            ddblNav = 0                          ||02429  |'            ddblNav = 0                          
02433  |'            ddblCnt = 0                          ||02430  |'            ddblCnt = 0                          
02434  |'            ddblNavTotal = 0                     ||02431  |'            ddblNavTotal = 0                     
02435  |'            i = 0                                ||02432  |'            i = 0                                
02436  |''2004/11/08 End                                  ||02433  |''2004/11/08 End                                  
02437  |'            Do Until gblnDyEOF()                 ||02434  |'            Do Until gblnDyEOF()                 
02438  |''2004/11/08 Start                                ||02435  |''2004/11/08 Start                                
02439  |'                '動的配列更新                    ||02436  |'                '動的配列更新                    
02440  |''                ReDim Preserve gtypcfr_mnav_tbl(||02437  |''                ReDim Preserve gtypcfr_mnav_tbl(
02441  |'                '対象月次NAV抽出                 ||02438  |'                '対象月次NAV抽出                 
02442  |''                gtypcfr_mnav_tbl(MonthlyCnt).bas||02439  |''                gtypcfr_mnav_tbl(MonthlyCnt).bas
02443  |''                gtypcfr_mnav_tbl(MonthlyCnt).net||02440  |''                gtypcfr_mnav_tbl(MonthlyCnt).net
02444  |''                MonthlyCnt = MonthlyCnt + 1     ||02441  |''                MonthlyCnt = MonthlyCnt + 1     
02445  |'                dstrMonthNew = gvlnDyDataS("base_||02442  |'                dstrMonthNew = gvlnDyDataS("base_
02446  |'                If dstrMonthNew <> dstrMonthOld T||02443  |'                If dstrMonthNew <> dstrMonthOld T
02447  |'                    If i = 0 Then                ||02444  |'                    If i = 0 Then                
02448  |'                        '動的配列更新            ||02445  |'                        '動的配列更新            
02449  |'                        ReDim Preserve gtypcfr_mn||02446  |'                        ReDim Preserve gtypcfr_mn
02450  |'                        i = 1                    ||02447  |'                        i = 1                    
02451  |'                    Else                         ||02448  |'                    Else                         
02452  |'                        MonthlyCnt = MonthlyCnt +||02449  |'                        MonthlyCnt = MonthlyCnt +
02453  |'                        ReDim Preserve gtypcfr_mn||02450  |'                        ReDim Preserve gtypcfr_mn
02454  |'                        ddblNav = 0              ||02451  |'                        ddblNav = 0              
02455  |'                        ddblCnt = 0              ||02452  |'                        ddblCnt = 0              
02456  |'                        ddblNavTotal = 0         ||02453  |'                        ddblNavTotal = 0         
02457  |'                    End If                       ||02454  |'                    End If                       
02458  |'                End If                           ||02455  |'                End If                           
02459  |'                ddblNav = gvlnDyDataN("NET_ASSET_||02456  |'                ddblNav = gvlnDyDataN("NET_ASSET_
02460  |'                ddblCnt = gvlnDyDataN("NAV_CNT") ||02457  |'                ddblCnt = gvlnDyDataN("NAV_CNT") 
02461  |'                If ddblCnt > 0 Then              ||02458  |'                If ddblCnt > 0 Then              
02462  |'                    ddblNavTotal = ddblNavTotal +||02459  |'                    ddblNavTotal = ddblNavTotal +
02463  |'                Else                             ||02460  |'                Else                             
02464  |'                    ddblNavTotal = ddblNavTotal +||02461  |'                    ddblNavTotal = ddblNavTotal +
02465  |'                End If                           ||02462  |'                End If                           
02466  |'                gtypcfr_mnav_tbl(MonthlyCnt).BASE||02463  |'                gtypcfr_mnav_tbl(MonthlyCnt).BASE
02467  |'                gtypcfr_mnav_tbl(MonthlyCnt).net_||02464  |'                gtypcfr_mnav_tbl(MonthlyCnt).net_
02468  |'                dstrMonthOld = dstrMonthNew      ||02465  |'                dstrMonthOld = dstrMonthNew      
02469  |''2004/11/08 End                                  ||02466  |''2004/11/08 End                                  
02470  |'                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                ||02467  |'                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                
02471  |'                Call gDyNext                     ||02468  |'                Call gDyNext                     
02472  |'            Loop                                 ||02469  |'            Loop                                 
02473  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    ||02470  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    
02474  |'            Call gblnDyClose                     ||02471  |'            Call gblnDyClose                     
02475  |'                                                 ||02472  |'                                                 
02476  |''SQL文の作成(月別支払顧問料)                     ||02473  |''SQL文の作成(月別支払顧問料)                     
02477  |''            sZenkai = DateAdd("m", 1, gstrDateFo||02474  |''            sZenkai = DateAdd("m", 1, gstrDateFo
02478  |''            sZenkai = Mid(gstrDateFormat2(sZenka||02475  |''            sZenkai = Mid(gstrDateFormat2(sZenka
02479  |''            sNearMonth = Mid(mstrNearSettleDate,||02476  |''            sNearMonth = Mid(mstrNearSettleDate,
02480  |''            sSql = gstrEditSQLcfr_MonthlyPayComF||02477  |''            sSql = gstrEditSQLcfr_MonthlyPayComF
02481  |''                sContractNo, sZenkai, sNearMonth||02478  |''                sContractNo, sZenkai, sNearMonth
02482  |''            'ﾀﾞｲﾅｾｯﾄの作成                      ||02479  |''            'ﾀﾞｲﾅｾｯﾄの作成                      
02483  |''            If gintDyCreate(sSql) = False Then  ||02480  |''            If gintDyCreate(sSql) = False Then  
02484  |''                Exit Function                   ||02481  |''                Exit Function                   
02485  |''            End If                              ||02482  |''            End If                              
02486  |''            '対象月別支払顧問料累計値抽出       ||02483  |''            '対象月別支払顧問料累計値抽出       
02487  |''            mstrMonthlyPayCom = gvlnDyDataS("SUM||02484  |''            mstrMonthlyPayCom = gvlnDyDataS("SUM
02488  |''            If mstrMonthlyPayCom <> "" Then     ||02485  |''            If mstrMonthlyPayCom <> "" Then     
02489  |''                mstrMonthlyPayCom = Round(gvlnDy||02486  |''                mstrMonthlyPayCom = Round(gvlnDy
02490  |''            End If                              ||02487  |''            End If                              
02491  |''            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                   ||02488  |''            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                   
02492  |''            Call gblnDyClose                    ||02489  |''            Call gblnDyClose                    
02493  |'                                                 ||02490  |'                                                 
02494  |''SQL文の作成(外部委託顧問料率取得)               ||02491  |''SQL文の作成(外部委託顧問料率取得)               
02495  |'            sRuleNo = gbuMGetUPDRec.N(Cnt).MGET_O||02492  |'            sRuleNo = gbuMGetUPDRec.N(Cnt).MGET_O
02496  |'            sSql = gstrEditSQLcfr_OtherComRateFor||02493  |'            sSql = gstrEditSQLcfr_OtherComRateFor
02497  |'                sContractNo, sRuleNo)            ||02494  |'                sContractNo, sRuleNo)            
02498  |'            'ﾀﾞｲﾅｾｯﾄの作成                       ||02495  |'            'ﾀﾞｲﾅｾｯﾄの作成                       
02499  |'            If gintDyCreate(sSql) = False Then   ||02496  |'            If gintDyCreate(sSql) = False Then   
02500  |'                Exit Function                    ||02497  |'                Exit Function                    
02501  |'            End If                               ||02498  |'            End If                               
02502  |'            '配列初期化                          ||02499  |'            '配列初期化                          
02503  |'            ReDim gbuOtherComRateGetUPDRec.N(0)  ||02500  |'            ReDim gbuOtherComRateGetUPDRec.N(0)  
02504  |'            MonthlyCnt = 0                       ||02501  |'            MonthlyCnt = 0                       
02505  |'            'EOF判定処理                         ||02502  |'            'EOF判定処理                         
02506  |'            Do Until gblnDyEOF()                 ||02503  |'            Do Until gblnDyEOF()                 
02507  |'                '対象データ抽出                  ||02504  |'                '対象データ抽出                  
02508  |'                Call sbOtherComDataGet(MonthlyCnt||02505  |'                Call sbOtherComDataGet(MonthlyCnt
02509  |'                MonthlyCnt = MonthlyCnt + 1      ||02506  |'                MonthlyCnt = MonthlyCnt + 1      
02510  |'                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                ||02507  |'                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                
02511  |'                Call gDyNext                     ||02508  |'                Call gDyNext                     
02512  |'            Loop                                 ||02509  |'            Loop                                 
02513  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    ||02510  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    
02514  |'            Call gblnDyClose                     ||02511  |'            Call gblnDyClose                     
02515  |'                                                 ||02512  |'                                                 
02516  |''確認書の作成                                    ||02513  |''確認書の作成                                    
02517  |'                                                 ||02514  |'                                                 
02518  |'    If gProcessCnt <> 1 Then                     ||02515  |'    If gProcessCnt <> 1 Then                     
02519  |'        '2回目以降はシートの追加                 ||02516  |'        '2回目以降はシートの追加                 
02520  |'        xlBook.Worksheets.Add after:=xlBook.Sheet||02517  |'        xlBook.Worksheets.Add after:=xlBook.Sheet
02521  |'    Else                                         ||02518  |'    Else                                         
02522  |'        '1回目はオブジェクトの設定               ||02519  |'        '1回目はオブジェクトの設定               
02523  |'        Set xlApp = CreateObject("Excel.Applicati||02520  |'        Set xlApp = CreateObject("Excel.Applicati
02524  |'        Set xlBook = xlApp.Workbooks.Add         ||02521  |'        Set xlBook = xlApp.Workbooks.Add         
02525  |'    End If                                       ||02522  |'    End If                                       
02526  |'    Set xlSheet = xlBook.Sheets(gProcessCnt)     ||02523  |'    Set xlSheet = xlBook.Sheets(gProcessCnt)     
02527  |'                                                 ||02524  |'                                                 
02528  |'    If fnblExcelOut(Cnt) = False Then            ||02525  |'    If fnblExcelOut(Cnt) = False Then            
02529  |'        MsgBox "確認書の作成でエラーが発生しまし ||02526  |'        MsgBox "確認書の作成でエラーが発生しまし 
02530  |'        Exit Function                            ||02527  |'        Exit Function                            
02531  |'    End If                                       ||02528  |'    End If                                       
02532  |'                                                 ||02529  |'                                                 
02533  |'    If gbuMGetUPDRec.N(Cnt).MGET_company_flag = "||02530  |'    If gbuMGetUPDRec.N(Cnt).MGET_company_flag = "
02534  |'        xlBook.Worksheets.Add after:=xlBook.Sheet||02531  |'        xlBook.Worksheets.Add after:=xlBook.Sheet
02535  |'        gProcessCnt = gProcessCnt + 1            ||02532  |'        gProcessCnt = gProcessCnt + 1            
02536  |'                                                 ||02533  |'                                                 
02537  |'        If fnblExcelEnglishOut(Cnt) = False Then ||02534  |'        If fnblExcelEnglishOut(Cnt) = False Then 
02538  |'            MsgBox "英文確認書の作成でエラーが発 ||02535  |'            MsgBox "英文確認書の作成でエラーが発 
02539  |'            Exit Function                        ||02536  |'            Exit Function                        
02540  |'        End If                                   ||02537  |'        End If                                   
02541  |'    End If                                       ||02538  |'    End If                                       
02542  |'                                                 ||02539  |'                                                 
02543  |'    'Excel の Worksheet 削除用カウンタ変数       ||02540  |'    'Excel の Worksheet 削除用カウンタ変数       
02544  |'    Dim Ws_Cnt      As Integer                   ||02541  |'    Dim Ws_Cnt      As Integer                   
02545  |'    Dim Ws_Del_Cnt  As Integer                   ||02542  |'    Dim Ws_Del_Cnt  As Integer                   
02546  |'    Dim Ws_Del_Cnt2 As Integer                   ||02543  |'    Dim Ws_Del_Cnt2 As Integer                   
02547  |'                                                 ||02544  |'                                                 
02548  |'                                                 ||02545  |'                                                 
02549  |'    '動的ファイル名部分を取得                    ||02546  |'    '動的ファイル名部分を取得                    
02550  |'    If gTotalProcessCnt = 1 Then                 ||02547  |'    If gTotalProcessCnt = 1 Then                 
02551  |'        Call sbFileNameChange                    ||02548  |'        Call sbFileNameChange                    
02552  |'    End If                                       ||02549  |'    End If                                       
02553  |'                                                 ||02550  |'                                                 
02554  |'    'Excel の Worksheet 削除用カウンタ初期化     ||02551  |'    'Excel の Worksheet 削除用カウンタ初期化     
02555  |'    Ws_Cnt = xlBook.Worksheets.Count             ||02552  |'    Ws_Cnt = xlBook.Worksheets.Count             
02556  |'    Ws_Del_Cnt2 = 0                              ||02553  |'    Ws_Del_Cnt2 = 0                              
02557  |'    '出力するデータ数のカウント(gSysoutDataCnt)と||02554  |'    '出力するデータ数のカウント(gSysoutDataCnt)と
02558  |'    If gTotalProcessCnt = gSysoutDataCnt Then    ||02555  |'    If gTotalProcessCnt = gSysoutDataCnt Then    
02559  |'        ' WorkBookが存在すれば削除               ||02556  |'        ' WorkBookが存在すれば削除               
02560  |'        If Dir(mstrFileName) <> "" Then          ||02557  |'        If Dir(mstrFileName) <> "" Then          
02561  |'            Kill (mstrFileName)                  ||02558  |'            Kill (mstrFileName)                  
02562  |'        End If                                   ||02559  |'        End If                                   
02563  |'                                                 ||02560  |'                                                 
02564  |'        'シート名を調査しシート削除              ||02561  |'        'シート名を調査しシート削除              
02565  |'        For Ws_Del_Cnt = 1 To Ws_Cnt             ||02562  |'        For Ws_Del_Cnt = 1 To Ws_Cnt             
02566  |'            If Left(xlBook.Worksheets(Ws_Del_Cnt)||02563  |'            If Left(xlBook.Worksheets(Ws_Del_Cnt)
02567  |'                'シートの削除                    ||02564  |'                'シートの削除                    
02568  |'                Application.DisplayAlerts = False||02565  |'                Application.DisplayAlerts = False
02569  |'                xlBook.Worksheets(Ws_Del_Cnt).Del||02566  |'                xlBook.Worksheets(Ws_Del_Cnt).Del
02570  |'                Application.DisplayAlerts = True ||02567  |'                Application.DisplayAlerts = True 
02571  |'                Ws_Del_Cnt = Ws_Del_Cnt - 1      ||02568  |'                Ws_Del_Cnt = Ws_Del_Cnt - 1      
02572  |'                Ws_Del_Cnt2 = Ws_Del_Cnt2 + 1    ||02569  |'                Ws_Del_Cnt2 = Ws_Del_Cnt2 + 1    
02573  |'                If Ws_Del_Cnt2 = 2 Then          ||02570  |'                If Ws_Del_Cnt2 = 2 Then          
02574  |'                    Exit For                     ||02571  |'                    Exit For                     
02575  |'                End If                           ||02572  |'                End If                           
02576  |'            End If                               ||02573  |'            End If                               
02577  |'        Next Ws_Del_Cnt                          ||02574  |'        Next Ws_Del_Cnt                          
02578  |'                                                 ||02575  |'                                                 
02579  |'        '見易いようにシートの1枚目を選択する     ||02576  |'        '見易いようにシートの1枚目を選択する     
02580  |'        xlBook.Worksheets(1).Select              ||02577  |'        xlBook.Worksheets(1).Select              
02581  |'                                                 ||02578  |'                                                 
02582  |'        xlBook.SaveAs mstrFileName               ||02579  |'        xlBook.SaveAs mstrFileName               
02583  |'        xlBook.Close                             ||02580  |'        xlBook.Close                             
02584  |'        xlApp.Quit                               ||02581  |'        xlApp.Quit                               
02585  |'                                                 ||02582  |'                                                 
02586  |'        Set xlApp = Nothing                      ||02583  |'        Set xlApp = Nothing                      
02587  |'        Set xlBook = Nothing                     ||02584  |'        Set xlBook = Nothing                     
02588  |'        Set xlSheet = Nothing                    ||02585  |'        Set xlSheet = Nothing                    
02589  |'                                                 ||02586  |'                                                 
02590  |'        '処理回数カウンターの初期化              ||02587  |'        '処理回数カウンターの初期化              
02591  |'        gProcessCnt = 0                          ||02588  |'        gProcessCnt = 0                          
02592  |'        '保存ファイル名の修正                    ||02589  |'        '保存ファイル名の修正                    
02593  |'        gSaveFileCnt = gSaveFileCnt + 1          ||02590  |'        gSaveFileCnt = gSaveFileCnt + 1          
02594  |'        mstrFileName = mstrFileNameBK & " (" & gS||02591  |'        mstrFileName = mstrFileNameBK & " (" & gS
02595  |'    End If                                       ||02592  |'    End If                                       
02596  |'                                                 ||02593  |'                                                 
02597  |'                                                 ||02594  |'                                                 
02598  |'                                                 ||02595  |'                                                 
02599  |''        End If                                  ||02596  |''        End If                                  
02600  |'    Next Cnt                                     ||02597  |'    Next Cnt                                     
02601  |'                                                 ||02598  |'                                                 
02602  |'    '正常戻り値セット                            ||02599  |'    '正常戻り値セット                            
02603  |'    fnblMakePrint = True                         ||02600  |'    fnblMakePrint = True                         
02604  |'    GoTo EndProc                                 ||02601  |'    GoTo EndProc                                 
02605  |'                                                 ||02602  |'                                                 
02606  |'OnErrorProc:                                     ||02603  |'OnErrorProc:                                     
02607  |'    Call subError("システムエラー", Str(Err.Numbe||02604  |'    Call subError("システムエラー", Str(Err.Numbe
02608  |'        Error, strErrCall, conTitle)             ||02605  |'        Error, strErrCall, conTitle)             
02609  |'    'マウスポインター元に戻す                    ||02606  |'    'マウスポインター元に戻す                    
02610  |'    Screen.MousePointer = vbDefault              ||02607  |'    Screen.MousePointer = vbDefault              
02611  |'                                                 ||02608  |'                                                 
02612  |'EndProc:                                         ||02609  |'EndProc:                                         
02613  |'#################################################||02610  |'#################################################
02614  |'2006/07/03 END   K.Furuya 期中料率変更契約/RAFI対||02611  |'2006/07/03 END   K.Furuya 期中料率変更契約/RAFI対
02615  |'#################################################||02612  |'#################################################
02616  |                                                  ||02613  |                                                  
02617  |End Function                                      ||02614  |End Function                                      
02618  |                                                  ||02615  |                                                  
02619  |'=================================================||02616  |'=================================================
02620  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMGetDataGet                ||02617  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMGetDataGet                
02621  |'機能            :   対象月次外部委託顧問料率取得 ||02618  |'機能            :   対象月次外部委託顧問料率取得 
02622  |'                                                 ||02619  |'                                                 
02623  |'日付               担当　              修正内容  ||02620  |'日付               担当　              修正内容  
02624  |'-------------------------------------------------||02621  |'-------------------------------------------------
02625  |'2004/08/04         M.Katoh<SRA>       新規作成   ||02622  |'2004/08/04         M.Katoh<SRA>       新規作成   
02626  |'2004/12/17         M.Yamazaki<SRA>    上限金額、 ||02623  |'2004/12/17         M.Yamazaki<SRA>    上限金額、 
02627  |'2005/01/11         M.Yamazaki<SRA>    閾値通貨、 ||02624  |'2005/01/11         M.Yamazaki<SRA>    閾値通貨、 
02628  |'2005/01/18         M.Yamazaki<SRA>    口座属性・ ||02625  |'2005/01/18         M.Yamazaki<SRA>    口座属性・ 
02629  |'2005/03/09         M.Yamazaki<SRA>    外部委託顧 ||02626  |'2005/03/09         M.Yamazaki<SRA>    外部委託顧 
02630  |'2008/03/26         K.Furuya<SRA>      ファンド決 ||02627  |'2008/03/26         K.Furuya<SRA>      ファンド決 
02631  |'=================================================||02628  |'=================================================
02632  |Private Sub sbMGetDataGet( _                      ||02629  |Private Sub sbMGetDataGet( _                      
02633  |    ByVal lRecIdx As Long _                       ||02630  |    ByVal lRecIdx As Long _                       
02634  |)                                                 ||02631  |)                                                 
02635  |                                                  ||02632  |                                                  
02636  |    '動的配列更新                                 ||02633  |    '動的配列更新                                 
02637  |    ReDim Preserve gbuMGetUPDRec.N(0 To lRecIdx)  ||02634  |    ReDim Preserve gbuMGetUPDRec.N(0 To lRecIdx)  
02638  |                                                  ||02635  |                                                  
02639  |    With gbuMGetUPDRec.N(lRecIdx)                 ||02636  |    With gbuMGetUPDRec.N(lRecIdx)                 
02640  |'''''        .MGET_contract_no = gvlnDyDataS("Cont||02637  |'''''        .MGET_contract_no = gvlnDyDataS("Cont
02641  |'''''        .MGET_contract_name = gvlnDyDataS("Co||02638  |'''''        .MGET_contract_name = gvlnDyDataS("Co
02642  |'''''        .MGET_contract_flag = gvlnDyDataS("Co||02639  |'''''        .MGET_contract_flag = gvlnDyDataS("Co
02643  |'''''        .MGET_account_code = gvlnDyDataS("acc||02640  |'''''        .MGET_account_code = gvlnDyDataS("acc
02644  |'''''        .MGET_account_name = gvlnDyDataS("acc||02641  |'''''        .MGET_account_name = gvlnDyDataS("acc
02645  |''''''2005/01/18 Start                            ||02642  |''''''2005/01/18 Start                            
02646  |'''''        .MGET_acc_invalid_flag = gvlnDyDataS(||02643  |'''''        .MGET_acc_invalid_flag = gvlnDyDataS(
02647  |''''''2005/01/18 End                              ||02644  |''''''2005/01/18 End                              
02648  |'''''        .MGET_base_currency_code = gvlnDyData||02645  |'''''        .MGET_base_currency_code = gvlnDyData
02649  |'''''        .MGET_settlement_date = gvlnDyDataS("||02646  |'''''        .MGET_settlement_date = gvlnDyDataS("
02650  |'''''        .MGET_settlement_date_YYYYMMDD = gvln||02647  |'''''        .MGET_settlement_date_YYYYMMDD = gvln
02651  |'''''        .MGET_com_calc_start = gvlnDyDataS("c||02648  |'''''        .MGET_com_calc_start = gvlnDyDataS("c
02652  |'''''        .MGET_com_calc_end = gvlnDyDataS("com||02649  |'''''        .MGET_com_calc_end = gvlnDyDataS("com
02653  |'''''        .MGET_company_code = gvlnDyDataS("com||02650  |'''''        .MGET_company_code = gvlnDyDataS("com
02654  |'''''        .MGET_company_name = gvlnDyDataS("com||02651  |'''''        .MGET_company_name = gvlnDyDataS("com
02655  |'''''                                             ||02652  |'''''                                             
02656  |'''''        .MGET_OTHER_COM_RULE_NO = gvlnDyDataN||02653  |'''''        .MGET_OTHER_COM_RULE_NO = gvlnDyDataN
02657  |'''''        .MGET_other_rate_rule_flag = gvlnDyDa||02654  |'''''        .MGET_other_rate_rule_flag = gvlnDyDa
02658  |''''''2004/12/17 Start                            ||02655  |''''''2004/12/17 Start                            
02659  |'''''        .MGET_cap = gvlnDyDataS("CAP")       ||02656  |'''''        .MGET_cap = gvlnDyDataS("CAP")       
02660  |'''''        .MGET_floor = gvlnDyDataS("FLOOR")   ||02657  |'''''        .MGET_floor = gvlnDyDataS("FLOOR")   
02661  |'''''        .MGET_nav_get_flag = gvlnDyDataS("NAV||02658  |'''''        .MGET_nav_get_flag = gvlnDyDataS("NAV
02662  |''''''2004/12/17 End                              ||02659  |''''''2004/12/17 End                              
02663  |''''''2005/01/11 Start                            ||02660  |''''''2005/01/11 Start                            
02664  |'''''        .MGET_amount_currency_code = gvlnDyDa||02661  |'''''        .MGET_amount_currency_code = gvlnDyDa
02665  |'''''        .MGET_other_com_currency_code = gvlnD||02662  |'''''        .MGET_other_com_currency_code = gvlnD
02666  |'''''        .MGET_days_in_a_year = gvlnDyDataS("D||02663  |'''''        .MGET_days_in_a_year = gvlnDyDataS("D
02667  |''''''2005/01/11 End                              ||02664  |''''''2005/01/11 End                              
02668  |''''''2005/02/02 Start                            ||02665  |''''''2005/02/02 Start                            
02669  |'''''        .MGET_yokujitu = ""                  ||02666  |'''''        .MGET_yokujitu = ""                  
02670  |''''''2005/02/02 End                              ||02667  |''''''2005/02/02 End                              
02671  |''''''2005/03/09 Start                            ||02668  |''''''2005/03/09 Start                            
02672  |'''''        .MGET_tax_calc_flag = gvlnDyDataS("TA||02669  |'''''        .MGET_tax_calc_flag = gvlnDyDataS("TA
02673  |''''''2005/03/09 End                              ||02670  |''''''2005/03/09 End                              
02674  |                                                  ||02671  |                                                  
02675  |        .MGET_company_flag = gvlnDyDataS("COMPANY_||02672  |        .MGET_company_flag = gvlnDyDataS("COMPANY_
02676  |        .MGET_contract_no = gvlnDyDataS("Contract_||02673  |        .MGET_contract_no = gvlnDyDataS("Contract_
02677  |        .MGET_contract_name = gvlnDyDataS("Contrac||02674  |        .MGET_contract_name = gvlnDyDataS("Contrac
02678  |        .MGET_contract_name_e = gvlnDyDataS("Contr||02675  |        .MGET_contract_name_e = gvlnDyDataS("Contr
02679  |        .MGET_contract_flag = gvlnDyDataS("Contrac||02676  |        .MGET_contract_flag = gvlnDyDataS("Contrac
02680  |        .MGET_settlement_date = gvlnDyDataS("sett_||02677  |        .MGET_settlement_date = gvlnDyDataS("sett_
02681  |        .MGET_account_code = gvlnDyDataS("account_||02678  |        .MGET_account_code = gvlnDyDataS("account_
02682  |        .MGET_account_name = gvlnDyDataS("account_||02679  |        .MGET_account_name = gvlnDyDataS("account_
02683  |        .MGET_base_currency_code = gvlnDyDataS("ba||02680  |        .MGET_base_currency_code = gvlnDyDataS("ba
02684  |        .MGET_com_calc_start = gvlnDyDataS("com_ca||02681  |        .MGET_com_calc_start = gvlnDyDataS("com_ca
02685  |        .MGET_com_calc_end = gvlnDyDataS("com_calc||02682  |        .MGET_com_calc_end = gvlnDyDataS("com_calc
02686  |        .MGET_company_code = gvlnDyDataS("company_||02683  |        .MGET_company_code = gvlnDyDataS("company_
02687  |        .MGET_company_name = gvlnDyDataS("company_||02684  |        .MGET_company_name = gvlnDyDataS("company_
02688  |        .MGET_company_name_e = gvlnDyDataS("compan||02685  |        .MGET_company_name_e = gvlnDyDataS("compan
02689  |        .MGET_OTHER_COM_RULE_NO = gvlnDyDataN("OTH||02686  |        .MGET_OTHER_COM_RULE_NO = gvlnDyDataN("OTH
02690  |        .MGET_other_rate_rule_flag = gvlnDyDataN("||02687  |        .MGET_other_rate_rule_flag = gvlnDyDataN("
02691  |        .MGET_nav_get_flag = gvlnDyDataS("NAV_GET_||02688  |        .MGET_nav_get_flag = gvlnDyDataS("NAV_GET_
02692  |                                                  ||02689  |                                                  
02693  |        '上限値に"-99"が入っている場合は、""と置き||02690  |        '上限値に"-99"が入っている場合は、""と置き
02694  |        If gvlnDyDataS("CAP") = "-99" Then        ||02691  |        If gvlnDyDataS("CAP") = "-99" Then        
02695  |            .MGET_cap = ""                        ||02692  |            .MGET_cap = ""                        
02696  |        Else                                      ||02693  |        Else                                      
02697  |            .MGET_cap = gvlnDyDataS("CAP")        ||02694  |            .MGET_cap = gvlnDyDataS("CAP")        
02698  |        End If                                    ||02695  |        End If                                    
02699  |                                                  ||02696  |                                                  
02700  |        '下限値に"-99"が入っている場合は、""と置き||02697  |        '下限値に"-99"が入っている場合は、""と置き
02701  |        If gvlnDyDataS("FLOOR") = "-99" Then      ||02698  |        If gvlnDyDataS("FLOOR") = "-99" Then      
02702  |            .MGET_floor = ""                      ||02699  |            .MGET_floor = ""                      
02703  |        Else                                      ||02700  |        Else                                      
02704  |            .MGET_floor = gvlnDyDataS("FLOOR")    ||02701  |            .MGET_floor = gvlnDyDataS("FLOOR")    
02705  |        End If                                    ||02702  |        End If                                    
02706  |                                                  ||02703  |                                                  
02707  |        .MGET_amount_currency_code = gvlnDyDataS("||02704  |        .MGET_amount_currency_code = gvlnDyDataS("
02708  |        .MGET_other_com_currency_code = gvlnDyData||02705  |        .MGET_other_com_currency_code = gvlnDyData
02709  |        .MGET_days_in_a_year = gvlnDyDataS("DAYS_I||02706  |        .MGET_days_in_a_year = gvlnDyDataS("DAYS_I
02710  |        .MGET_settlement_date_YYYYMMDD = gvlnDyDat||02707  |        .MGET_settlement_date_YYYYMMDD = gvlnDyDat
02711  |        .MGET_tax_calc_flag = gvlnDyDataS("TAX_CAL||02708  |        .MGET_tax_calc_flag = gvlnDyDataS("TAX_CAL
02712  |'2008/03/26 START ファンド決算期間での外部委託顧問||02709  |'2008/03/26 START ファンド決算期間での外部委託顧問
02713  |        .MGET_other_real_flag = "0"               ||02710  |        .MGET_other_real_flag = "0"               
02714  |'2008/03/26 END   ファンド決算期間での外部委託顧問||02711  |'2008/03/26 END   ファンド決算期間での外部委託顧問
02715  |                                                  ||02712  |                                                  
02716  |    End With                                      ||02713  |    End With                                      
02717  |                                                  ||02714  |                                                  
02718  |End Sub                                           ||02715  |End Sub                                           
02719  |                                                  ||02716  |                                                  
02720  |'=================================================||02717  |'=================================================
02721  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbOtherComDataGet            ||02718  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbOtherComDataGet            
02722  |'機能            :   対象外部委託顧問料率取得テー ||02719  |'機能            :   対象外部委託顧問料率取得テー 
02723  |'                                                 ||02720  |'                                                 
02724  |'日付               担当　              修正内容  ||02721  |'日付               担当　              修正内容  
02725  |'-------------------------------------------------||02722  |'-------------------------------------------------
02726  |'2004/08/05         M.Katoh<SRA>       新規作成   ||02723  |'2004/08/05         M.Katoh<SRA>       新規作成   
02727  |'2006/07/07         K.Furuya<SRA>      期中料率変 ||02724  |'2006/07/07         K.Furuya<SRA>      期中料率変 
02728  |'                                      計算期間の ||02725  |'                                      計算期間の 
02729  |'=================================================||02726  |'=================================================
02730  |Private Sub sbOtherComDataGet( _                  ||02727  |Private Sub sbOtherComDataGet( _                  
02731  |    ByVal lRecIdx As Long _                       ||02728  |    ByVal lRecIdx As Long _                       
02732  |)                                                 ||02729  |)                                                 
02733  |                                                  ||02730  |                                                  
02734  |    '動的配列更新                                 ||02731  |    '動的配列更新                                 
02735  |    ReDim Preserve gbuOtherComRateGetUPDRec.N(0 To||02732  |    ReDim Preserve gbuOtherComRateGetUPDRec.N(0 To
02736  |                                                  ||02733  |                                                  
02737  |'2006/07/07 START K.Furuya 期中料率変更契約/RAFI対||02734  |'2006/07/07 START K.Furuya 期中料率変更契約/RAFI対
02738  |'    With gbuOtherComRateGetUPDRec.N(lRecIdx)     ||02735  |'    With gbuOtherComRateGetUPDRec.N(lRecIdx)     
02739  |'        .RGET_CONTRACT_NO = gvlnDyDataS("Contract||02736  |'        .RGET_CONTRACT_NO = gvlnDyDataS("Contract
02740  |'        .RGET_OTHER_COM_RULE_NO = gvlnDyDataN("OT||02737  |'        .RGET_OTHER_COM_RULE_NO = gvlnDyDataN("OT
02741  |'        .RGET_OTHER_COM_RULE_ORDER = gvlnDyDataN(||02738  |'        .RGET_OTHER_COM_RULE_ORDER = gvlnDyDataN(
02742  |'        .RGET_THRESHOLD_AMOUNT = gvlnDyDataN("THR||02739  |'        .RGET_THRESHOLD_AMOUNT = gvlnDyDataN("THR
02743  |'        .RGET_OTHER_COM_RATE = gvlnDyDataN("OTHER||02740  |'        .RGET_OTHER_COM_RATE = gvlnDyDataN("OTHER
02744  |'        .RGET_RITSU = gvlnDyDataN("RITSU")       ||02741  |'        .RGET_RITSU = gvlnDyDataN("RITSU")       
02745  |'    End With                                     ||02742  |'    End With                                     
02746  |    With gbuOtherComRateGetUPDRec.N(lRecIdx)      ||02743  |    With gbuOtherComRateGetUPDRec.N(lRecIdx)      
02747  |        .RGET_START_DATE = gvlnDyDataS("START_DATE||02744  |        .RGET_START_DATE = gvlnDyDataS("START_DATE
02748  |        .RGET_END_DATE = gvlnDyDataS("END_DATE")  ||02745  |        .RGET_END_DATE = gvlnDyDataS("END_DATE")  
02749  |        .RGET_CONTRACT_NO = gvlnDyDataS("Contract_||02746  |        .RGET_CONTRACT_NO = gvlnDyDataS("Contract_
02750  |        .RGET_OTHER_COM_RULE_NO = gvlnDyDataN("OTH||02747  |        .RGET_OTHER_COM_RULE_NO = gvlnDyDataN("OTH
02751  |        .RGET_OTHER_COM_RULE_ORDER = gvlnDyDataN("||02748  |        .RGET_OTHER_COM_RULE_ORDER = gvlnDyDataN("
02752  |        .RGET_THRESHOLD_AMOUNT = gvlnDyDataN("THRE||02749  |        .RGET_THRESHOLD_AMOUNT = gvlnDyDataN("THRE
02753  |        .RGET_OTHER_COM_RATE = gvlnDyDataN("OTHER_||02750  |        .RGET_OTHER_COM_RATE = gvlnDyDataN("OTHER_
02754  |        .RGET_RITSU = gvlnDyDataN("RITSU")        ||02751  |        .RGET_RITSU = gvlnDyDataN("RITSU")        
02755  |        .RGET_RULE_NO_CNT = gvlnDyDataN("RULE_NO_C||02752  |        .RGET_RULE_NO_CNT = gvlnDyDataN("RULE_NO_C
02756  |    End With                                      ||02753  |    End With                                      
02757  |'2006/07/07 END   K.Furuya 期中料率変更契約/RAFI対||02754  |'2006/07/07 END   K.Furuya 期中料率変更契約/RAFI対
02758  |                                                  ||02755  |                                                  
02759  |End Sub                                           ||02756  |End Sub                                           
02760  |                                                  ||02757  |                                                  
02761  |'=================================================||02758  |'=================================================
02762  |'処理内容     締日チェック：fnChkSettlementDate   ||02759  |'処理内容     締日チェック：fnChkSettlementDate   
02763  |'備考         締日が営業日かチェックして、対象締日||02760  |'備考         締日が営業日かチェックして、対象締日
02764  |'                                                 ||02761  |'                                                 
02765  |'引数         strSettlementDate:対象締日,iNum：処 ||02762  |'引数         strSettlementDate:対象締日,iNum：処 
02766  |'             iNum = 1：直近締日セット,iNum = 2： ||02763  |'             iNum = 1：直近締日セット,iNum = 2： 
02767  |'                                                 ||02764  |'                                                 
02768  |'日付         担当               内容             ||02765  |'日付         担当               内容             
02769  |'------------ ----------------- ------------------||02766  |'------------ ----------------- ------------------
02770  |'2004/08/24   M.Katoh <SRA>     新規作成          ||02767  |'2004/08/24   M.Katoh <SRA>     新規作成          
02771  |'=================================================||02768  |'=================================================
02772  |Private Function fnChkSettlementDate( _           ||02769  |Private Function fnChkSettlementDate( _           
02773  |    ByVal strSettlementDate As String, _          ||02770  |    ByVal strSettlementDate As String, _          
02774  |    ByVal iNum As String _                        ||02771  |    ByVal iNum As String _                        
02775  |) As Boolean                                      ||02772  |) As Boolean                                      
02776  |                                                  ||02773  |                                                  
02777  |On Error GoTo OnErrorProc                         ||02774  |On Error GoTo OnErrorProc                         
02778  |                                                  ||02775  |                                                  
02779  |    Const conMeModule As String = "sbChkSettlement||02776  |    Const conMeModule As String = "sbChkSettlement
02780  |    Dim sSql        As String                     ||02777  |    Dim sSql        As String                     
02781  |    Dim sWorkWhere  As String                     ||02778  |    Dim sWorkWhere  As String                     
02782  |    Dim blnret      As Boolean                    ||02779  |    Dim blnret      As Boolean                    
02783  |    Dim iEigyoFlag  As Integer                    ||02780  |    Dim iEigyoFlag  As Integer                    
02784  |    Dim strErrCall  As String        'エラー呼出元||02781  |    Dim strErrCall  As String        'エラー呼出元
02785  |    Dim WorkDate    As String                     ||02782  |    Dim WorkDate    As String                     
02786  |                                                  ||02783  |                                                  
02787  |    '戻り値初期化                                 ||02784  |    '戻り値初期化                                 
02788  |    fnChkSettlementDate = False                   ||02785  |    fnChkSettlementDate = False                   
02789  |                                                  ||02786  |                                                  
02790  |    'カレンダーテーブル該当データ取得用ＳＱＬ     ||02787  |    'カレンダーテーブル該当データ取得用ＳＱＬ     
02791  |    sSql = gstrEditSQLCalGetSelect(strSettlementDa||02788  |    sSql = gstrEditSQLCalGetSelect(strSettlementDa
02792  |    'ﾀﾞｲﾅｾｯﾄの作成                                ||02789  |    'ﾀﾞｲﾅｾｯﾄの作成                                
02793  |    If gintDyCreate(sSql) = False Then            ||02790  |    If gintDyCreate(sSql) = False Then            
02794  |        Exit Function                             ||02791  |        Exit Function                             
02795  |    End If                                        ||02792  |    End If                                        
02796  |    'EOF判定処理                                  ||02793  |    'EOF判定処理                                  
02797  |    If gblnDyEOF() = False Then                   ||02794  |    If gblnDyEOF() = False Then                   
02798  |        '対象締日抽出                             ||02795  |        '対象締日抽出                             
02799  |        WorkDate = gvlnDyDataN("CAL_EIGYO_YMD")   ||02796  |        WorkDate = gvlnDyDataN("CAL_EIGYO_YMD")   
02800  |    End If                                        ||02797  |    End If                                        
02801  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             ||02798  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             
02802  |    Call gblnDyClose                              ||02799  |    Call gblnDyClose                              
02803  |                                                  ||02800  |                                                  
02804  |    '締日を格納する                               ||02801  |    '締日を格納する                               
02805  |    If iNum = 1 Then                              ||02802  |    If iNum = 1 Then                              
02806  |        mstrNearSettleDate = WorkDate             ||02803  |        mstrNearSettleDate = WorkDate             
02807  |    ElseIf iNum = 2 Then                          ||02804  |    ElseIf iNum = 2 Then                          
02808  |        mstrSettlementDate = WorkDate             ||02805  |        mstrSettlementDate = WorkDate             
02809  |    End If                                        ||02806  |    End If                                        
02810  |                                                  ||02807  |                                                  
02811  |    If WorkDate = "" Then                         ||02808  |    If WorkDate = "" Then                         
02812  |        MsgBox "締日が存在してません。。。", vbCri||02809  |        MsgBox "締日が存在してません。。。", vbCri
02813  |        GoTo EndProc                              ||02810  |        GoTo EndProc                              
02814  |    End If                                        ||02811  |    End If                                        
02815  |                                                  ||02812  |                                                  
02816  |    '正常戻り値セット                             ||02813  |    '正常戻り値セット                             
02817  |    fnChkSettlementDate = True                    ||02814  |    fnChkSettlementDate = True                    
02818  |    GoTo EndProc                                  ||02815  |    GoTo EndProc                                  
02819  |                                                  ||02816  |                                                  
02820  |OnErrorProc:                                      ||02817  |OnErrorProc:                                      
02821  |    Call subError("システムエラー", Str(Err.Number||02818  |    Call subError("システムエラー", Str(Err.Number
02822  |        Error, strErrCall, conTitle)              ||02819  |        Error, strErrCall, conTitle)              
02823  |    Exit Function                                 ||02820  |    Exit Function                                 
02824  |                                                  ||02821  |                                                  
02825  |EndProc:                                          ||02822  |EndProc:                                          
02826  |                                                  ||02823  |                                                  
02827  |End Function                                      ||02824  |End Function                                      
02828  |                                                  ||02825  |                                                  
02829  |'=================================================||02826  |'=================================================
02830  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelOut                 ||02827  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelOut                 
02831  |'機能            :   確認書のExcel出力            ||02828  |'機能            :   確認書のExcel出力            
02832  |'                                                 ||02829  |'                                                 
02833  |'日付               担当　              修正内容  ||02830  |'日付               担当　              修正内容  
02834  |'-------------------------------------------------||02831  |'-------------------------------------------------
02835  |'2004/08/03         M.Katoh<SRA>       新規作成   ||02832  |'2004/08/03         M.Katoh<SRA>       新規作成   
02836  |'2004/09/10         M.Yamazaki<SRA>    確認書にフ ||02833  |'2004/09/10         M.Yamazaki<SRA>    確認書にフ 
02837  |'2004/09/21         M.Yamazaki<SRA>    １契約に対 ||02834  |'2004/09/21         M.Yamazaki<SRA>    １契約に対 
02838  |'2004/09/28         M.Yamazaki<SRA>    月次NAVがな||02835  |'2004/09/28         M.Yamazaki<SRA>    月次NAVがな
02839  |'2004/11/10         M.Yamazaki<SRA>    見出し4行目||02836  |'2004/11/10         M.Yamazaki<SRA>    見出し4行目
02840  |'2004/11/17         M.Yamazaki<SRA>    端数の四捨 ||02837  |'2004/11/17         M.Yamazaki<SRA>    端数の四捨 
02841  |'                                      消費税は切 ||02838  |'                                      消費税は切 
02842  |'2004/12/29         M.Yamazaki<SRA>    NAV取得区分||02839  |'2004/12/29         M.Yamazaki<SRA>    NAV取得区分
02843  |'2005/01/06         M.Yamazaki<SRA>    名称使用許 ||02840  |'2005/01/06         M.Yamazaki<SRA>    名称使用許 
02844  |'2005/01/11         M.Yamazaki<SRA>    名称使用許 ||02841  |'2005/01/11         M.Yamazaki<SRA>    名称使用許 
02845  |'2005/01/13         M.Yamazaki<SRA>    １契約複数 ||02842  |'2005/01/13         M.Yamazaki<SRA>    １契約複数 
02846  |'2005/01/17         M.Yamazaki<SRA>    換算レート ||02843  |'2005/01/17         M.Yamazaki<SRA>    換算レート 
02847  |'                                      またレート ||02844  |'                                      またレート 
02848  |'2005/01/20         M.Yamazaki<SRA>    日次NAVにデ||02845  |'2005/01/20         M.Yamazaki<SRA>    日次NAVにデ
02849  |'                                      前営業日の ||02846  |'                                      前営業日の 
02850  |'2005/03/09         M.Yamazaki<SRA>    外部委託顧 ||02847  |'2005/03/09         M.Yamazaki<SRA>    外部委託顧 
02851  |'                                      消費税計算 ||02848  |'                                      消費税計算 
02852  |'2005/03/15         M.Yamazaki<SRA>    名称使用許 ||02849  |'2005/03/15         M.Yamazaki<SRA>    名称使用許 
02853  |'2005/03/18         M.Yamazaki<SRA>    名称使用許 ||02850  |'2005/03/18         M.Yamazaki<SRA>    名称使用許 
02854  |'2005/03/25         M.Yamazaki<SRA>    帳票出力時 ||02851  |'2005/03/25         M.Yamazaki<SRA>    帳票出力時 
02855  |'                                      日次NAV平均||02852  |'                                      日次NAV平均
02856  |'                                      計算期間の ||02853  |'                                      計算期間の 
02857  |'2006/04/11         K.Furuya <SRA>     外部委託顧 ||02854  |'2006/04/11         K.Furuya <SRA>     外部委託顧 
02858  |'2006/07/03         K.Furuya <SRA>     期中料率変 ||02855  |'2006/07/03         K.Furuya <SRA>     期中料率変 
02859  |'                                      ソースが煩 ||02856  |'                                      ソースが煩 
02860  |'                                      作り変えの ||02857  |'                                      作り変えの 
02861  |'=================================================||02858  |'=================================================
02862  |Private Function fnblExcelOut( _                  ||02859  |Private Function fnblExcelOut( _                  
02863  |    ByVal lRecIdx As Long _                       ||02860  |    ByVal lRecIdx As Long _                       
02864  |) As Boolean                                      ||02861  |) As Boolean                                      
02865  |                                                  ||02862  |                                                  
02866  |                                                  ||02863  |                                                  
02867  |'#################################################||02864  |'#################################################
02868  |'2006/07/03 START K.Furuya 期中料率変更契約/RAFI対||02865  |'2006/07/03 START K.Furuya 期中料率変更契約/RAFI対
02869  |'#################################################||02866  |'#################################################
02870  |'                                                 ||02867  |'                                                 
02871  |'    Dim dStart      As Date     '計算期間　開始日||02868  |'    Dim dStart      As Date     '計算期間　開始日
02872  |'    Dim dEnd        As Date     '計算期間　終了日||02869  |'    Dim dEnd        As Date     '計算期間　終了日
02873  |'    Dim sSql        As String                    ||02870  |'    Dim sSql        As String                    
02874  |'    Dim sCurrencyCode As String '通貨コード(SQL文||02871  |'    Dim sCurrencyCode As String '通貨コード(SQL文
02875  |'    Dim AccCode     As String   '口座コード(SQL文||02872  |'    Dim AccCode     As String   '口座コード(SQL文
02876  |'    Dim sDate       As Date     '支払予定日      ||02873  |'    Dim sDate       As Date     '支払予定日      
02877  |'    Dim sName       As String   '担当者名        ||02874  |'    Dim sName       As String   '担当者名        
02878  |'    Dim i           As Integer  'カウンター      ||02875  |'    Dim i           As Integer  'カウンター      
02879  |'    Dim ColNum      As Integer  '部署名コンボボッ||02876  |'    Dim ColNum      As Integer  '部署名コンボボッ
02880  |'    Dim ColWord     As String   '部署名コンボボッ||02877  |'    Dim ColWord     As String   '部署名コンボボッ
02881  |'    Dim iSyouhizei  As Long     '消費税          ||02878  |'    Dim iSyouhizei  As Long     '消費税          
02882  |'    Dim iRowCnt     As Long     '月末純資産データ||02879  |'    Dim iRowCnt     As Long     '月末純資産データ
02883  |'    Dim TotalNav    As Currency '累積NAV         ||02880  |'    Dim TotalNav    As Currency '累積NAV         
02884  |'    Dim TotalRate   As Currency '累積閾値        ||02881  |'    Dim TotalRate   As Currency '累積閾値        
02885  |'    Dim cRate       As Currency '料率            ||02882  |'    Dim cRate       As Currency '料率            
02886  |'    Dim WorkRate    As Currency '一つ前の累積閾値||02883  |'    Dim WorkRate    As Currency '一つ前の累積閾値
02887  |'    Dim TotalCom    As Currency '累積投資顧問料  ||02884  |'    Dim TotalCom    As Currency '累積投資顧問料  
02888  |'    Dim lTaxNum     As Currency '消費税値        ||02885  |'    Dim lTaxNum     As Currency '消費税値        
02889  |'    Dim lMonthlyPayCom As Currency  '月別支払額  ||02886  |'    Dim lMonthlyPayCom As Currency  '月別支払額  
02890  |'    Dim lCalcNav    As Currency '計算対象NAV     ||02887  |'    Dim lCalcNav    As Currency '計算対象NAV     
02891  |'    Dim iCalcNum    As Integer  '計算期間日数    ||02888  |'    Dim iCalcNum    As Integer  '計算期間日数    
02892  |'    'Excel の Application 変数とエラーをトラップ ||02889  |'    'Excel の Application 変数とエラーをトラップ 
02893  |'    Dim iTries      As Integer                   ||02890  |'    Dim iTries      As Integer                   
02894  |'    Dim strErrCall      As String 'エラー呼出元  ||02891  |'    Dim strErrCall      As String 'エラー呼出元  
02895  |'    Const conMeModule   As String = "fnblExcelOut||02892  |'    Const conMeModule   As String = "fnblExcelOut
02896  |'    'Excel の Worksheet 削除用カウンタ変数       ||02893  |'    'Excel の Worksheet 削除用カウンタ変数       
02897  |'    Dim Ws_Cnt      As Integer                   ||02894  |'    Dim Ws_Cnt      As Integer                   
02898  |'    Dim Ws_Del_Cnt  As Integer                   ||02895  |'    Dim Ws_Del_Cnt  As Integer                   
02899  |'    Dim Ws_Del_Cnt2 As Integer                   ||02896  |'    Dim Ws_Del_Cnt2 As Integer                   
02900  |''2004/09/21 Start                                ||02897  |''2004/09/21 Start                                
02901  |'    Dim ContNo      As String   '契約番号(SQL文作||02898  |'    Dim ContNo      As String   '契約番号(SQL文作
02902  |'    Dim NavGetCnt   As Long                      ||02899  |'    Dim NavGetCnt   As Long                      
02903  |'    Dim sGetAccCode As String                    ||02900  |'    Dim sGetAccCode As String                    
02904  |''2004/09/21 End                                  ||02901  |''2004/09/21 End                                  
02905  |''2004/09/28 Start                                ||02902  |''2004/09/28 Start                                
02906  |'    Dim Mnav_Flg    As String                    ||02903  |'    Dim Mnav_Flg    As String                    
02907  |''2004/09/28 End                                  ||02904  |''2004/09/28 End                                  
02908  |''2004/12/29 Start                                ||02905  |''2004/12/29 Start                                
02909  |'    Dim sStart As String            '計算対象　開||02906  |'    Dim sStart As String            '計算対象　開
02910  |'    Dim sEnd As String              '計算対象　終||02907  |'    Dim sEnd As String              '計算対象　終
02911  |'    Dim dstrBasedate As String      '基準日用ワー||02908  |'    Dim dstrBasedate As String      '基準日用ワー
02912  |'    Dim dstrCaldate() As String     'カレンダー日||02909  |'    Dim dstrCaldate() As String     'カレンダー日
02913  |'    Dim ddblDailynav() As Double    '日次NAV用格 ||02910  |'    Dim ddblDailynav() As Double    '日次NAV用格 
02914  |'    Dim dlngCnt As Long             '計算対象期間||02911  |'    Dim dlngCnt As Long             '計算対象期間
02915  |'    Dim dstrCaldate2 As String      'カレンダー日||02912  |'    Dim dstrCaldate2 As String      'カレンダー日
02916  |'    Dim dstrBasedate2 As String     '基準日(/編集||02913  |'    Dim dstrBasedate2 As String     '基準日(/編集
02917  |'    Dim dlngDiffdate As Long        'カレンダー日||02914  |'    Dim dlngDiffdate As Long        'カレンダー日
02918  |'    Dim dintFor As Integer          'For文用変数 ||02915  |'    Dim dintFor As Integer          'For文用変数 
02919  |'    Dim ddblTtalnav As Double       '日次NAV累積 ||02916  |'    Dim ddblTtalnav As Double       '日次NAV累積 
02920  |''2004/12/29 End                                  ||02917  |''2004/12/29 End                                  
02921  |''2005/01/06 Start                                ||02918  |''2005/01/06 Start                                
02922  |'    Dim dstrAvgNav As String                     ||02919  |'    Dim dstrAvgNav As String                     
02923  |''2005/01/06 End                                  ||02920  |''2005/01/06 End                                  
02924  |''2005/01/11 Start                                ||02921  |''2005/01/11 Start                                
02925  |'    Dim ddblNearNav As Double                    ||02922  |'    Dim ddblNearNav As Double                    
02926  |''2005/01/11 End                                  ||02923  |''2005/01/11 End                                  
02927  |''2005/01/12 Start                                ||02924  |''2005/01/12 Start                                
02928  |''''''Dim ddblShiharai As Double                  ||02925  |''''''Dim ddblShiharai As Double                  
02929  |''2005/01/12 End                                  ||02926  |''2005/01/12 End                                  
02930  |''2005/01/13 Start                                ||02927  |''2005/01/13 Start                                
02931  |'    Dim dstrAccCd() As String                    ||02928  |'    Dim dstrAccCd() As String                    
02932  |'    Dim dstrBsCCd() As String                    ||02929  |'    Dim dstrBsCCd() As String                    
02933  |'    Dim intRtn      As Integer                   ||02930  |'    Dim intRtn      As Integer                   
02934  |''2005/01/13 End                                  ||02931  |''2005/01/13 End                                  
02935  |''2005/01/17 Start                                ||02932  |''2005/01/17 Start                                
02936  |'    Dim dstrDate         As String               ||02933  |'    Dim dstrDate         As String               
02937  |'    Dim dstrCurrencyCode As String               ||02934  |'    Dim dstrCurrencyCode As String               
02938  |'    Dim ddblExchangeRate As Double               ||02935  |'    Dim ddblExchangeRate As Double               
02939  |''2005/01/17 End                                  ||02936  |''2005/01/17 End                                  
02940  |''2005/03/09 Start                                ||02937  |''2005/03/09 Start                                
02941  |'    Dim dintPage    As Integer                   ||02938  |'    Dim dintPage    As Integer                   
02942  |'    Dim dintPageIni As Integer                   ||02939  |'    Dim dintPageIni As Integer                   
02943  |'    Dim dintAmari   As Integer                   ||02940  |'    Dim dintAmari   As Integer                   
02944  |'    Dim dCalDate    As Date                      ||02941  |'    Dim dCalDate    As Date                      
02945  |'    Dim J           As Integer                   ||02942  |'    Dim J           As Integer                   
02946  |'    Dim K           As Integer                   ||02943  |'    Dim K           As Integer                   
02947  |'    Dim L           As Integer                   ||02944  |'    Dim L           As Integer                   
02948  |'    Dim AvgNav      As Currency                  ||02945  |'    Dim AvgNav      As Currency                  
02949  |'    Dim dintFor2    As Integer                   ||02946  |'    Dim dintFor2    As Integer                   
02950  |''2005/03/09 End                                  ||02947  |''2005/03/09 End                                  
02951  |''2005/03/18 Start                                ||02948  |''2005/03/18 Start                                
02952  |'    Dim dlngMeisyoSu As Integer                  ||02949  |'    Dim dlngMeisyoSu As Integer                  
02953  |''2005/03/18 End                                  ||02950  |''2005/03/18 End                                  
02954  |''2005/03/25 Start                                ||02951  |''2005/03/25 Start                                
02955  |'    Dim dlngCntsv As Long                        ||02952  |'    Dim dlngCntsv As Long                        
02956  |''2005/03/25 End                                  ||02953  |''2005/03/25 End                                  
02957  |'                                                 ||02954  |'                                                 
02958  |'    '2006/04/12 START K.Furuya 実払管理テーブル更||02955  |'    '2006/04/12 START K.Furuya 実払管理テーブル更
02959  |'    Dim WkContractNo        As String            ||02956  |'    Dim WkContractNo        As String            
02960  |'    Dim WkCurCode           As String            ||02957  |'    Dim WkCurCode           As String            
02961  |'    Dim WkSettlementDate    As String            ||02958  |'    Dim WkSettlementDate    As String            
02962  |'    Dim WkFixComC           As String            ||02959  |'    Dim WkFixComC           As String            
02963  |'    Dim WkFixComJ           As String            ||02960  |'    Dim WkFixComJ           As String            
02964  |'    Dim WkRealComC          As String            ||02961  |'    Dim WkRealComC          As String            
02965  |'    Dim WkRealComJ          As String            ||02962  |'    Dim WkRealComJ          As String            
02966  |'    '2006/04/12 END   K.Furuya 実払管理テーブル更||02963  |'    '2006/04/12 END   K.Furuya 実払管理テーブル更
02967  |'                                                 ||02964  |'                                                 
02968  |'    '戻り値初期化                                ||02965  |'    '戻り値初期化                                
02969  |'    fnblExcelOut = False                         ||02966  |'    fnblExcelOut = False                         
02970  |'    i = 0                                        ||02967  |'    i = 0                                        
02971  |'                                                 ||02968  |'                                                 
02972  |'On Error Resume Next                             ||02969  |'On Error Resume Next                             
02973  |'                                                 ||02970  |'                                                 
02974  |''    If gProcessCnt <> 1 Then                    ||02971  |''    If gProcessCnt <> 1 Then                    
02975  |''        '2回目以降はシートの追加                ||02972  |''        '2回目以降はシートの追加                
02976  |''        xlBook.Worksheets.Add after:=xlBook.Shee||02973  |''        xlBook.Worksheets.Add after:=xlBook.Shee
02977  |''    Else                                        ||02974  |''    Else                                        
02978  |''        '1回目はオブジェクトの設定              ||02975  |''        '1回目はオブジェクトの設定              
02979  |''        Set xlApp = CreateObject("Excel.Applicat||02976  |''        Set xlApp = CreateObject("Excel.Applicat
02980  |''        Set xlBook = xlApp.Workbooks.Add        ||02977  |''        Set xlBook = xlApp.Workbooks.Add        
02981  |''    End If                                      ||02978  |''    End If                                      
02982  |''    Set xlSheet = xlBook.Sheets(gProcessCnt)    ||02979  |''    Set xlSheet = xlBook.Sheets(gProcessCnt)    
02983  |'                                                 ||02980  |'                                                 
02984  |'    'Excelフォーマットを調整                     ||02981  |'    'Excelフォーマットを調整                     
02985  |'    xlSheet.Cells.ColumnWidth = 1                ||02982  |'    xlSheet.Cells.ColumnWidth = 1                
02986  |'    xlSheet.Cells.Font.Size = 11                 ||02983  |'    xlSheet.Cells.Font.Size = 11                 
02987  |'    'シート名を設定(確認書**)                    ||02984  |'    'シート名を設定(確認書**)                    
02988  |''2005/03/09 Start                                ||02985  |''2005/03/09 Start                                
02989  |''    xlBook.Sheets(gProcessCnt).Name = sWord33 & ||02986  |''    xlBook.Sheets(gProcessCnt).Name = sWord33 & 
02990  |'    xlBook.Sheets(gProcessCnt).Name = sWord33 & (||02987  |'    xlBook.Sheets(gProcessCnt).Name = sWord33 & (
02991  |''2005/03/09 End                                  ||02988  |''2005/03/09 End                                  
02992  |'    'シートの余白を設定                          ||02989  |'    'シートの余白を設定                          
02993  |'    xlSheet.PageSetup.TopMargin = Application.Inc||02990  |'    xlSheet.PageSetup.TopMargin = Application.Inc
02994  |'    xlSheet.PageSetup.BottomMargin = Application.||02991  |'    xlSheet.PageSetup.BottomMargin = Application.
02995  |''2005/01/20 Start                                ||02992  |''2005/01/20 Start                                
02996  |'    xlSheet.PageSetup.LeftMargin = Application.In||02993  |'    xlSheet.PageSetup.LeftMargin = Application.In
02997  |''    xlSheet.PageSetup.LeftMargin = Application.I||02994  |''    xlSheet.PageSetup.LeftMargin = Application.I
02998  |''2005/01/20 End                                  ||02995  |''2005/01/20 End                                  
02999  |''2005/01/20 Start                                ||02996  |''2005/01/20 Start                                
03000  |''    xlSheet.PageSetup.RightMargin = Application.||02997  |''    xlSheet.PageSetup.RightMargin = Application.
03001  |'    xlSheet.PageSetup.RightMargin = Application.I||02998  |'    xlSheet.PageSetup.RightMargin = Application.I
03002  |''2005/01/20 End                                  ||02999  |''2005/01/20 End                                  
03003  |'                                                 ||03000  |'                                                 
03004  |'    '総計の出力処理カウンターアップ              ||03001  |'    '総計の出力処理カウンターアップ              
03005  |'    gTotalProcessCnt = gTotalProcessCnt + 1      ||03002  |'    gTotalProcessCnt = gTotalProcessCnt + 1      
03006  |'                                                 ||03003  |'                                                 
03007  |'    DoEvents                                     ||03004  |'    DoEvents                                     
03008  |'    With xlSheet                                 ||03005  |'    With xlSheet                                 
03009  |'        '題目                                    ||03006  |'        '題目                                    
03010  |''2004/09/01 Start                                ||03007  |''2004/09/01 Start                                
03011  |''        Select Case gbuMGetUPDRec.N(lRecIdx).MGE||03008  |''        Select Case gbuMGetUPDRec.N(lRecIdx).MGE
03012  |''            Case mstrContractFlag(1)            ||03009  |''            Case mstrContractFlag(1)            
03013  |''                .Cells(5, 1).Value = sWord0a    ||03010  |''                .Cells(5, 1).Value = sWord0a    
03014  |''            Case mstrContractFlag(2)            ||03011  |''            Case mstrContractFlag(2)            
03015  |''                .Cells(5, 1).Value = sWord0b    ||03012  |''                .Cells(5, 1).Value = sWord0b    
03016  |''            Case mstrContractFlag(3)            ||03013  |''            Case mstrContractFlag(3)            
03017  |''                .Cells(5, 1).Value = sWord0c    ||03014  |''                .Cells(5, 1).Value = sWord0c    
03018  |''            Case Else                           ||03015  |''            Case Else                           
03019  |''                MsgBox "契約区分が変です。", vbC||03016  |''                MsgBox "契約区分が変です。", vbC
03020  |''        End Select                              ||03017  |''        End Select                              
03021  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).||03018  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).
03022  |'            Case Mid(mstrContractFlag(1), 1, 1)  ||03019  |'            Case Mid(mstrContractFlag(1), 1, 1)  
03023  |'                .Cells(5, 1).Value = sWord0a     ||03020  |'                .Cells(5, 1).Value = sWord0a     
03024  |'            Case Mid(mstrContractFlag(2), 1, 1)  ||03021  |'            Case Mid(mstrContractFlag(2), 1, 1)  
03025  |'                .Cells(5, 1).Value = sWord0b     ||03022  |'                .Cells(5, 1).Value = sWord0b     
03026  |'            Case Mid(mstrContractFlag(3), 1, 1)  ||03023  |'            Case Mid(mstrContractFlag(3), 1, 1)  
03027  |'                .Cells(5, 1).Value = sWord0c     ||03024  |'                .Cells(5, 1).Value = sWord0c     
03028  |'            Case Else                            ||03025  |'            Case Else                            
03029  |'                MsgBox "契約区分が不正です。", vb||03026  |'                MsgBox "契約区分が不正です。", vb
03030  |'        End Select                               ||03027  |'        End Select                               
03031  |''2004/09/01 Start                                ||03028  |''2004/09/01 Start                                
03032  |'        .Cells(5, 1).Font.Size = 14              ||03029  |'        .Cells(5, 1).Font.Size = 14              
03033  |''2005/01/12 Start                                ||03030  |''2005/01/12 Start                                
03034  |''        .Range("A5:BE5").HorizontalAlignment = x||03031  |''        .Range("A5:BE5").HorizontalAlignment = x
03035  |''2005/01/20 Start                                ||03032  |''2005/01/20 Start                                
03036  |''        .Range("A5:BF5").HorizontalAlignment = x||03033  |''        .Range("A5:BF5").HorizontalAlignment = x
03037  |''        .Range("A5:BD5").HorizontalAlignment = x||03034  |''        .Range("A5:BD5").HorizontalAlignment = x
03038  |'        .Range("A5:BG5").HorizontalAlignment = xl||03035  |'        .Range("A5:BG5").HorizontalAlignment = xl
03039  |''2005/01/20 End                                  ||03036  |''2005/01/20 End                                  
03040  |''2005/01/12 End                                  ||03037  |''2005/01/12 End                                  
03041  |'        '出力日付                                ||03038  |'        '出力日付                                
03042  |'        If RTrim(txtSysOutDate.Text) = "" Then   ||03039  |'        If RTrim(txtSysOutDate.Text) = "" Then   
03043  |''2005/01/12 Start                                ||03040  |''2005/01/12 Start                                
03044  |''            .Cells(3, 54).Value = sWord34       ||03041  |''            .Cells(3, 54).Value = sWord34       
03045  |''            .Cells(3, 54).HorizontalAlignment = ||03042  |''            .Cells(3, 54).HorizontalAlignment = 
03046  |''        Else                                    ||03043  |''        Else                                    
03047  |''            .Cells(3, 45).Value = CStr(Format(tx||03044  |''            .Cells(3, 45).Value = CStr(Format(tx
03048  |'            .Cells(3, 50).Value = sWord34        ||03045  |'            .Cells(3, 50).Value = sWord34        
03049  |'            .Cells(3, 50).HorizontalAlignment = x||03046  |'            .Cells(3, 50).HorizontalAlignment = x
03050  |'        Else                                     ||03047  |'        Else                                     
03051  |'            .Cells(3, 43).Value = CStr(Format(txt||03048  |'            .Cells(3, 43).Value = CStr(Format(txt
03052  |''2005/01/12 End                                  ||03049  |''2005/01/12 End                                  
03053  |'        End If                                   ||03050  |'        End If                                   
03054  |'        '財務部　担当者                          ||03051  |'        '財務部　担当者                          
03055  |'        sName = RTrim(txtInputName.Text)         ||03052  |'        sName = RTrim(txtInputName.Text)         
03056  |'        '財務部                                  ||03053  |'        '財務部                                  
03057  |''2005/01/12 Start                                ||03054  |''2005/01/12 Start                                
03058  |''        .Cells(7, 39).Value = sWord1            ||03055  |''        .Cells(7, 39).Value = sWord1            
03059  |''        .Cells(8, 41).Value = sWord2 & sName    ||03056  |''        .Cells(8, 41).Value = sWord2 & sName    
03060  |'        .Cells(7, 37).Value = sWord1             ||03057  |'        .Cells(7, 37).Value = sWord1             
03061  |'        .Cells(8, 39).Value = sWord2 & sName     ||03058  |'        .Cells(8, 39).Value = sWord2 & sName     
03062  |''2005/01/12 End                                  ||03059  |''2005/01/12 End                                  
03063  |'        '下記のとおり･･･                         ||03060  |'        '下記のとおり･･･                         
03064  |''2004/11/10 Start                                ||03061  |''2004/11/10 Start                                
03065  |''        .Cells(10, 2).Value = sWord3            ||03062  |''        .Cells(10, 2).Value = sWord3            
03066  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).||03063  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).
03067  |'            Case Mid(mstrContractFlag(1), 1, 1)  ||03064  |'            Case Mid(mstrContractFlag(1), 1, 1)  
03068  |'                .Cells(10, 2).Value = sWord3a    ||03065  |'                .Cells(10, 2).Value = sWord3a    
03069  |'            Case Mid(mstrContractFlag(2), 1, 1)  ||03066  |'            Case Mid(mstrContractFlag(2), 1, 1)  
03070  |'                .Cells(10, 2).Value = sWord3b    ||03067  |'                .Cells(10, 2).Value = sWord3b    
03071  |'            Case Mid(mstrContractFlag(3), 1, 1)  ||03068  |'            Case Mid(mstrContractFlag(3), 1, 1)  
03072  |'                .Cells(10, 2).Value = sWord3c    ||03069  |'                .Cells(10, 2).Value = sWord3c    
03073  |'            Case Else                            ||03070  |'            Case Else                            
03074  |'        End Select                               ||03071  |'        End Select                               
03075  |''2004/11/10 End                                  ||03072  |''2004/11/10 End                                  
03076  |'        'ファンド名                              ||03073  |'        'ファンド名                              
03077  |''2005/03/09 Start                                ||03074  |''2005/03/09 Start                                
03078  |''        .Cells(13, 2).Value = sWord4            ||03075  |''        .Cells(13, 2).Value = sWord4            
03079  |'        .Cells(12, 2).Value = sWord4             ||03076  |'        .Cells(12, 2).Value = sWord4             
03080  |''2005/03/09 End                                  ||03077  |''2005/03/09 End                                  
03081  |''2004/09/10 Start                                ||03078  |''2004/09/10 Start                                
03082  |''        .Cells(13, 10).Value = sWord19          ||03079  |''        .Cells(13, 10).Value = sWord19          
03083  |''2005/03/09 Start                                ||03080  |''2005/03/09 Start                                
03084  |'''2005/01/12 Start                               ||03081  |'''2005/01/12 Start                               
03085  |'''        .Cells(13, 11).Value = sWord19         ||03082  |'''        .Cells(13, 11).Value = sWord19         
03086  |'''        .Cells(13, 9).Value = sWord19          ||03083  |'''        .Cells(13, 9).Value = sWord19          
03087  |'''2005/01/12 End                                 ||03084  |'''2005/01/12 End                                 
03088  |'        .Cells(12, 11).Value = sWord19           ||03085  |'        .Cells(12, 11).Value = sWord19           
03089  |''2005/03/09 End                                  ||03086  |''2005/03/09 End                                  
03090  |''2004/09/10 End                                  ||03087  |''2004/09/10 End                                  
03091  |''2005/03/09 Start                                ||03088  |''2005/03/09 Start                                
03092  |'''2005/01/12 Start                               ||03089  |'''2005/01/12 Start                               
03093  |''        .Cells(13, 13).Value = gbuMGetUPDRec.N(l||03090  |''        .Cells(13, 13).Value = gbuMGetUPDRec.N(l
03094  |'''        .Cells(13, 11).Value = gbuMGetUPDRec.N(||03091  |'''        .Cells(13, 11).Value = gbuMGetUPDRec.N(
03095  |'''2005/01/12 End                                 ||03092  |'''2005/01/12 End                                 
03096  |'        .Cells(12, 13).Value = gbuMGetUPDRec.N(lR||03093  |'        .Cells(12, 13).Value = gbuMGetUPDRec.N(lR
03097  |''2005/03/09 End                                  ||03094  |''2005/03/09 End                                  
03098  |''2005/03/09 Start                                ||03095  |''2005/03/09 Start                                
03099  |''2004/09/10 Start                                ||03096  |''2004/09/10 Start                                
03100  |''        'ファンドコード                         ||03097  |''        'ファンドコード                         
03101  |''        .Cells(14, 2).Value = sWord4_2          ||03098  |''        .Cells(14, 2).Value = sWord4_2          
03102  |'''2005/01/12 Start                               ||03099  |'''2005/01/12 Start                               
03103  |''        .Cells(14, 11).Value = sWord19          ||03100  |''        .Cells(14, 11).Value = sWord19          
03104  |''        .Cells(14, 13).NumberFormatLocal = "@"  ||03101  |''        .Cells(14, 13).NumberFormatLocal = "@"  
03105  |'        'ファンドコード                          ||03102  |'        'ファンドコード                          
03106  |'        .Cells(13, 2).Value = sWord4_2           ||03103  |'        .Cells(13, 2).Value = sWord4_2           
03107  |'        .Cells(13, 11).Value = sWord19           ||03104  |'        .Cells(13, 11).Value = sWord19           
03108  |'        .Cells(13, 13).NumberFormatLocal = "@"   ||03105  |'        .Cells(13, 13).NumberFormatLocal = "@"   
03109  |''2005/03/09 End                                  ||03106  |''2005/03/09 End                                  
03110  |''        .Cells(14, 9).Value = sWord19           ||03107  |''        .Cells(14, 9).Value = sWord19           
03111  |''        .Cells(14, 11).NumberFormatLocal = "@"  ||03108  |''        .Cells(14, 11).NumberFormatLocal = "@"  
03112  |''2005/01/12 End                                  ||03109  |''2005/01/12 End                                  
03113  |''        .Cells(14, 13).Value = gbuMGetUPDRec.N(l||03110  |''        .Cells(14, 13).Value = gbuMGetUPDRec.N(l
03114  |''2004/09/10 End                                  ||03111  |''2004/09/10 End                                  
03115  |''2004/09/21 Start                                ||03112  |''2004/09/21 Start                                
03116  |'        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_co||03113  |'        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_co
03117  |'        sSql = gstrEditSQLcfr_NavGetForSelectList||03114  |'        sSql = gstrEditSQLcfr_NavGetForSelectList
03118  |'        'ﾀﾞｲﾅｾｯﾄの作成                           ||03115  |'        'ﾀﾞｲﾅｾｯﾄの作成                           
03119  |'        If gintDyCreate(sSql) = False Then       ||03116  |'        If gintDyCreate(sSql) = False Then       
03120  |'            Exit Function                        ||03117  |'            Exit Function                        
03121  |'        End If                                   ||03118  |'        End If                                   
03122  |'                                                 ||03119  |'                                                 
03123  |'        '2006/04/12 START K.Furuya 実払管理テーブ||03120  |'        '2006/04/12 START K.Furuya 実払管理テーブ
03124  |'        '契約番号を取得                          ||03121  |'        '契約番号を取得                          
03125  |'        WkContractNo = ""                        ||03122  |'        WkContractNo = ""                        
03126  |'        WkContractNo = ContNo                    ||03123  |'        WkContractNo = ContNo                    
03127  |'        '2006/04/12 END   K.Furuya 実払管理テーブ||03124  |'        '2006/04/12 END   K.Furuya 実払管理テーブ
03128  |'                                                 ||03125  |'                                                 
03129  |'        Do Until gblnDyEOF()                     ||03126  |'        Do Until gblnDyEOF()                     
03130  |'            '動的配列更新                        ||03127  |'            '動的配列更新                        
03131  |'            ReDim Preserve gtypcfr_navget_tbl(0 T||03128  |'            ReDim Preserve gtypcfr_navget_tbl(0 T
03132  |''2005/01/13 Start                                ||03129  |''2005/01/13 Start                                
03133  |'            ReDim Preserve dstrAccCd(0 To NavGetC||03130  |'            ReDim Preserve dstrAccCd(0 To NavGetC
03134  |''2005/01/13 End                                  ||03131  |''2005/01/13 End                                  
03135  |'            'NAV取得抽出                         ||03132  |'            'NAV取得抽出                         
03136  |'            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT||03133  |'            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT
03137  |'            If NavGetCnt > 0 Then                ||03134  |'            If NavGetCnt > 0 Then                
03138  |'                sGetAccCode = sGetAccCode & " , "||03135  |'                sGetAccCode = sGetAccCode & " , "
03139  |'            Else                                 ||03136  |'            Else                                 
03140  |'                sGetAccCode = sGetAccCode & gtypc||03137  |'                sGetAccCode = sGetAccCode & gtypc
03141  |'            End If                               ||03138  |'            End If                               
03142  |''2005/01/13 Start                                ||03139  |''2005/01/13 Start                                
03143  |'            '口座コードの格納(１契約複数口座の場 ||03140  |'            '口座コードの格納(１契約複数口座の場 
03144  |'            dstrAccCd(NavGetCnt) = gtypcfr_navget||03141  |'            dstrAccCd(NavGetCnt) = gtypcfr_navget
03145  |''2005/01/13 End                                  ||03142  |''2005/01/13 End                                  
03146  |'            NavGetCnt = NavGetCnt + 1            ||03143  |'            NavGetCnt = NavGetCnt + 1            
03147  |'            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                    ||03144  |'            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                    
03148  |'            Call gDyNext                         ||03145  |'            Call gDyNext                         
03149  |'        Loop                                     ||03146  |'        Loop                                     
03150  |'        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                        ||03147  |'        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                        
03151  |'        Call gblnDyClose                         ||03148  |'        Call gblnDyClose                         
03152  |''2005/01/13 Start                                ||03149  |''2005/01/13 Start                                
03153  |'        '１契約複数口座の場合に口座のベース通貨に||03150  |'        '１契約複数口座の場合に口座のベース通貨に
03154  |'        ReDim dstrBsCCd(0 To NavGetCnt - 1)      ||03151  |'        ReDim dstrBsCCd(0 To NavGetCnt - 1)      
03155  |'        If NavGetCnt - 1 > 0 Then                ||03152  |'        If NavGetCnt - 1 > 0 Then                
03156  |'            For dintFor = 0 To NavGetCnt - 1     ||03153  |'            For dintFor = 0 To NavGetCnt - 1     
03157  |'                sSql = ""                        ||03154  |'                sSql = ""                        
03158  |'                sSql = sSql & "SELECT ACCOUNT_COD||03155  |'                sSql = sSql & "SELECT ACCOUNT_COD
03159  |'                sSql = sSql & "WHERE ACCOUNT_CODE||03156  |'                sSql = sSql & "WHERE ACCOUNT_CODE
03160  |'                'ﾀﾞｲﾅｾｯﾄの作成                   ||03157  |'                'ﾀﾞｲﾅｾｯﾄの作成                   
03161  |'                If gintDyCreate(sSql) = False The||03158  |'                If gintDyCreate(sSql) = False The
03162  |'                    Exit Function                ||03159  |'                    Exit Function                
03163  |'                Else                             ||03160  |'                Else                             
03164  |'                    dstrBsCCd(dintFor) = gvlnDyDa||03161  |'                    dstrBsCCd(dintFor) = gvlnDyDa
03165  |'                End If                           ||03162  |'                End If                           
03166  |'                If dintFor > 0 Then              ||03163  |'                If dintFor > 0 Then              
03167  |'                    If dstrBsCCd(dintFor) <> dstr||03164  |'                    If dstrBsCCd(dintFor) <> dstr
03168  |'                        intRtn = MsgBox("ファンド||03165  |'                        intRtn = MsgBox("ファンド
03169  |'                        Exit Function            ||03166  |'                        Exit Function            
03170  |'                    End If                       ||03167  |'                    End If                       
03171  |'                End If                           ||03168  |'                End If                           
03172  |'            Next dintFor                         ||03169  |'            Next dintFor                         
03173  |'                                                 ||03170  |'                                                 
03174  |'        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                        ||03171  |'        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                        
03175  |'        Call gblnDyClose                         ||03172  |'        Call gblnDyClose                         
03176  |'                                                 ||03173  |'                                                 
03177  |'        End If                                   ||03174  |'        End If                                   
03178  |'        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                        ||03175  |'        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                        
03179  |''        Call gblnDyClose                        ||03176  |''        Call gblnDyClose                        
03180  |''2005/01/13 End                                  ||03177  |''2005/01/13 End                                  
03181  |''2005/03/09 Start                                ||03178  |''2005/03/09 Start                                
03182  |'''2005/01/12 Start                               ||03179  |'''2005/01/12 Start                               
03183  |''        .Cells(14, 13).Value = sGetAccCode      ||03180  |''        .Cells(14, 13).Value = sGetAccCode      
03184  |'''        .Cells(14, 11).Value = sGetAccCode     ||03181  |'''        .Cells(14, 11).Value = sGetAccCode     
03185  |'''2005/01/12 End                                 ||03182  |'''2005/01/12 End                                 
03186  |'''2004/09/21 End                                 ||03183  |'''2004/09/21 End                                 
03187  |'        .Cells(13, 13).Value = sGetAccCode       ||03184  |'        .Cells(13, 13).Value = sGetAccCode       
03188  |''2005/03/09 End                                  ||03185  |''2005/03/09 End                                  
03189  |'                                                 ||03186  |'                                                 
03190  |''2005/03/09 Start                                ||03187  |''2005/03/09 Start                                
03191  |''        '計算期間                               ||03188  |''        '計算期間                               
03192  |''        .Cells(16, 2).Value = sWord5            ||03189  |''        .Cells(16, 2).Value = sWord5            
03193  |'''2004/09/10 Start                               ||03190  |'''2004/09/10 Start                               
03194  |'''        .Cells(16, 10).Value = sWord19         ||03191  |'''        .Cells(16, 10).Value = sWord19         
03195  |'''2005/01/12 Start                               ||03192  |'''2005/01/12 Start                               
03196  |''        .Cells(16, 11).Value = sWord19          ||03193  |''        .Cells(16, 11).Value = sWord19          
03197  |'''        .Cells(16, 9).Value = sWord19          ||03194  |'''        .Cells(16, 9).Value = sWord19          
03198  |'''2005/01/12 End                                 ||03195  |'''2005/01/12 End                                 
03199  |'''2004/09/10 End                                 ||03196  |'''2004/09/10 End                                 
03200  |'        '計算期間                                ||03197  |'        '計算期間                                
03201  |'        .Cells(15, 2).Value = sWord5             ||03198  |'        .Cells(15, 2).Value = sWord5             
03202  |'        .Cells(15, 11).Value = sWord19           ||03199  |'        .Cells(15, 11).Value = sWord19           
03203  |''2005/03/09 End                                  ||03200  |''2005/03/09 End                                  
03204  |'        '前回締日・直近締日セット                ||03201  |'        '前回締日・直近締日セット                
03205  |'        dStart = CDate(gstrDateFormat(mstrSettlem||03202  |'        dStart = CDate(gstrDateFormat(mstrSettlem
03206  |'        dEnd = CDate(gstrDateFormat(mstrNearSettl||03203  |'        dEnd = CDate(gstrDateFormat(mstrNearSettl
03207  |''2005/01/17 Start                                ||03204  |''2005/01/17 Start                                
03208  |'        dstrDate = Replace(CStr(dEnd), "/", "")  ||03205  |'        dstrDate = Replace(CStr(dEnd), "/", "")  
03209  |'                                                 ||03206  |'                                                 
03210  |'        '2006/04/12 START K.Furuya 実払管理テーブ||03207  |'        '2006/04/12 START K.Furuya 実払管理テーブ
03211  |'        '締日を取得                              ||03208  |'        '締日を取得                              
03212  |'        WkSettlementDate = ""                    ||03209  |'        WkSettlementDate = ""                    
03213  |'        WkSettlementDate = dstrDate              ||03210  |'        WkSettlementDate = dstrDate              
03214  |'        '2006/04/12 END   K.Furuya 実払管理テーブ||03211  |'        '2006/04/12 END   K.Furuya 実払管理テーブ
03215  |'                                                 ||03212  |'                                                 
03216  |''2005/01/17 End                                  ||03213  |''2005/01/17 End                                  
03217  |''2005/03/09 Start                                ||03214  |''2005/03/09 Start                                
03218  |'''2005/01/12 Start                               ||03215  |'''2005/01/12 Start                               
03219  |''        .Cells(16, 13).Value = _                ||03216  |''        .Cells(16, 13).Value = _                
03220  |''            CStr(Format(dStart, "YYYY年M月D日"))||03217  |''            CStr(Format(dStart, "YYYY年M月D日"))
03221  |''            CStr(Format(dEnd, "YYYY年M月D日")) &||03218  |''            CStr(Format(dEnd, "YYYY年M月D日")) &
03222  |''            (DateDiff("d", dStart, dEnd) + 1) & ||03219  |''            (DateDiff("d", dStart, dEnd) + 1) & 
03223  |'''        .Cells(16, 11).Value = _               ||03220  |'''        .Cells(16, 11).Value = _               
03224  |'''            CStr(Format(dStart, "YYYY年M月D日")||03221  |'''            CStr(Format(dStart, "YYYY年M月D日")
03225  |'''            CStr(Format(dEnd, "YYYY年M月D日")) ||03222  |'''            CStr(Format(dEnd, "YYYY年M月D日")) 
03226  |'''            (DateDiff("d", dStart, dEnd) + 1) &||03223  |'''            (DateDiff("d", dStart, dEnd) + 1) &
03227  |'''2005/01/12 End                                 ||03224  |'''2005/01/12 End                                 
03228  |''2005/03/18 Start                                ||03225  |''2005/03/18 Start                                
03229  |''        .Cells(15, 13).Value = _                ||03226  |''        .Cells(15, 13).Value = _                
03230  |''            CStr(Format(dStart, "YYYY年M月D日"))||03227  |''            CStr(Format(dStart, "YYYY年M月D日"))
03231  |''2005/03/18 End                                  ||03228  |''2005/03/18 End                                  
03232  |''2005/03/09 End                                  ||03229  |''2005/03/09 End                                  
03233  |'        iCalcNum = DateDiff("d", dStart, dEnd) + ||03230  |'        iCalcNum = DateDiff("d", dStart, dEnd) + 
03234  |'                                                 ||03231  |'                                                 
03235  |''2005/03/09 Start                                ||03232  |''2005/03/09 Start                                
03236  |'        '純資産総額                              ||03233  |'        '純資産総額                              
03237  |'        .Cells(17, 2).Value = sWord50            ||03234  |'        .Cells(17, 2).Value = sWord50            
03238  |'        .Cells(17, 11).Value = sWord19           ||03235  |'        .Cells(17, 11).Value = sWord19           
03239  |''2005/03/09 End                                  ||03236  |''2005/03/09 End                                  
03240  |'                                                 ||03237  |'                                                 
03241  |'    '月末純資産                                  ||03238  |'    '月末純資産                                  
03242  |'        .Cells(19, 2).Value = sWord6             ||03239  |'        .Cells(19, 2).Value = sWord6             
03243  |''2004/09/10 Start                                ||03240  |''2004/09/10 Start                                
03244  |''        .Cells(19, 10).Value = sWord19          ||03241  |''        .Cells(19, 10).Value = sWord19          
03245  |''2005/01/12 Start                                ||03242  |''2005/01/12 Start                                
03246  |'        .Cells(19, 11).Value = sWord19           ||03243  |'        .Cells(19, 11).Value = sWord19           
03247  |''        .Cells(19, 9).Value = sWord19           ||03244  |''        .Cells(19, 9).Value = sWord19           
03248  |''2005/01/12 End                                  ||03245  |''2005/01/12 End                                  
03249  |''2004/09/10 End                                  ||03246  |''2004/09/10 End                                  
03250  |''2005/01/12 Start                                ||03247  |''2005/01/12 Start                                
03251  |'        '純資産                                  ||03248  |'        '純資産                                  
03252  |'        .Cells(19, 26).Value = sWord8            ||03249  |'        .Cells(19, 26).Value = sWord8            
03253  |''        .Range("Z19:AM19").HorizontalAlignment =||03250  |''        .Range("Z19:AM19").HorizontalAlignment =
03254  |'        .Range("Z19:AN19").HorizontalAlignment = ||03251  |'        .Range("Z19:AN19").HorizontalAlignment = 
03255  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ ||03252  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ 
03256  |'        '合計(純資産)                            ||03253  |'        '合計(純資産)                            
03257  |'        .Cells(33, 14).Value = sWord9            ||03254  |'        .Cells(33, 14).Value = sWord9            
03258  |'        .Range("N33:Y33").HorizontalAlignment = x||03255  |'        .Range("N33:Y33").HorizontalAlignment = x
03259  |''2005/03/09 End @@@@@ 合計行を出力しないならここ ||03256  |''2005/03/09 End @@@@@ 合計行を出力しないならここ 
03260  |'        '日付                                    ||03257  |'        '日付                                    
03261  |'        .Cells(19, 14).Value = sWord7            ||03258  |'        .Cells(19, 14).Value = sWord7            
03262  |'        .Range("N19:Y19").HorizontalAlignment = x||03259  |'        .Range("N19:Y19").HorizontalAlignment = x
03263  |''        '純資産                                 ||03260  |''        '純資産                                 
03264  |''        .Cells(19, 24).Value = sWord8           ||03261  |''        .Cells(19, 24).Value = sWord8           
03265  |''        .Range("X19:AL19").HorizontalAlignment =||03262  |''        .Range("X19:AL19").HorizontalAlignment =
03266  |''        '合計(純資産)                           ||03263  |''        '合計(純資産)                           
03267  |''        .Cells(33, 12).Value = sWord9           ||03264  |''        .Cells(33, 12).Value = sWord9           
03268  |''        .Range("L33:W33").HorizontalAlignment = ||03265  |''        .Range("L33:W33").HorizontalAlignment = 
03269  |''        '日付                                   ||03266  |''        '日付                                   
03270  |''        .Cells(19, 12).Value = sWord7           ||03267  |''        .Cells(19, 12).Value = sWord7           
03271  |''        .Range("L19:W19").HorizontalAlignment = ||03268  |''        .Range("L19:W19").HorizontalAlignment = 
03272  |'                                                 ||03269  |'                                                 
03273  |''2005/01/17 Start                                ||03270  |''2005/01/17 Start                                
03274  |''        '換算元                                 ||03271  |''        '換算元                                 
03275  |''        .Cells(19, 40).Value = sWord36          ||03272  |''        .Cells(19, 40).Value = sWord36          
03276  |''        .Range("AN19:AT19").HorizontalAlignment ||03273  |''        .Range("AN19:AT19").HorizontalAlignment 
03277  |''        '換算先                                 ||03274  |''        '換算先                                 
03278  |''        .Cells(19, 47).Value = sWord37          ||03275  |''        .Cells(19, 47).Value = sWord37          
03279  |''        .Range("AU19:BA19").HorizontalAlignment ||03276  |''        .Range("AU19:BA19").HorizontalAlignment 
03280  |''        '換算元(通貨)                           ||03277  |''        '換算元(通貨)                           
03281  |''        .Cells(20, 40).Value = sWord38          ||03278  |''        .Cells(20, 40).Value = sWord38          
03282  |''        .Range("AN20:AT20").HorizontalAlignment ||03279  |''        .Range("AN20:AT20").HorizontalAlignment 
03283  |''        '換算先(通貨)                           ||03280  |''        '換算先(通貨)                           
03284  |''        .Cells(20, 47).Value = sWord38          ||03281  |''        .Cells(20, 47).Value = sWord38          
03285  |''        .Range("AU20:BA20").HorizontalAlignment ||03282  |''        .Range("AU20:BA20").HorizontalAlignment 
03286  |''        'レート                                 ||03283  |''        'レート                                 
03287  |''        .Cells(20, 54).Value = sWord45          ||03284  |''        .Cells(20, 54).Value = sWord45          
03288  |''        .Range("BB20:BF20").HorizontalAlignment ||03285  |''        .Range("BB20:BF20").HorizontalAlignment 
03289  |''                                                ||03286  |''                                                
03290  |''        'NAV通貨→閾値通貨(NAV通貨)             ||03287  |''        'NAV通貨→閾値通貨(NAV通貨)             
03291  |''        .Cells(21, 40).Value = sWord39          ||03288  |''        .Cells(21, 40).Value = sWord39          
03292  |''        .Range("AN21:AT21").HorizontalAlignment ||03289  |''        .Range("AN21:AT21").HorizontalAlignment 
03293  |''        'NAV通貨→閾値通貨(閾値通貨)            ||03290  |''        'NAV通貨→閾値通貨(閾値通貨)            
03294  |''        .Cells(21, 47).Value = sWord40          ||03291  |''        .Cells(21, 47).Value = sWord40          
03295  |''        .Range("AU21:BA21").HorizontalAlignment ||03292  |''        .Range("AU21:BA21").HorizontalAlignment 
03296  |''        'NAV通貨→閾値通貨(NAV通貨)             ||03293  |''        'NAV通貨→閾値通貨(NAV通貨)             
03297  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_base_cu||03294  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_base_cu
03298  |''            .Cells(22, 42).Value = sWord43 & gbu||03295  |''            .Cells(22, 42).Value = sWord43 & gbu
03299  |'''            .Range("AN22:AT22").HorizontalAlign||03296  |'''            .Range("AN22:AT22").HorizontalAlign
03300  |''        Else                                    ||03297  |''        Else                                    
03301  |''            .Cells(22, 42).Value = ""           ||03298  |''            .Cells(22, 42).Value = ""           
03302  |'''            .Range("AN22:AT22").HorizontalAlign||03299  |'''            .Range("AN22:AT22").HorizontalAlign
03303  |''        End If                                  ||03300  |''        End If                                  
03304  |''        'NAV通貨→閾値通貨(閾値通貨)            ||03301  |''        'NAV通貨→閾値通貨(閾値通貨)            
03305  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_amount_||03302  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_amount_
03306  |''            .Cells(22, 49).Value = sWord43 & gbu||03303  |''            .Cells(22, 49).Value = sWord43 & gbu
03307  |'''            .Range("AU22:BA22").HorizontalAlign||03304  |'''            .Range("AU22:BA22").HorizontalAlign
03308  |''        Else                                    ||03305  |''        Else                                    
03309  |''            .Cells(22, 49).Value = ""           ||03306  |''            .Cells(22, 49).Value = ""           
03310  |'''            .Range("AU22:BA22").HorizontalAlign||03307  |'''            .Range("AU22:BA22").HorizontalAlign
03311  |''        End If                                  ||03308  |''        End If                                  
03312  |''        'NAV通貨→閾値通貨(レート)              ||03309  |''        'NAV通貨→閾値通貨(レート)              
03313  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_NavAmou||03310  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_NavAmou
03314  |''            .Cells(22, 58).NumberFormatLocal = "||03311  |''            .Cells(22, 58).NumberFormatLocal = "
03315  |''            .Cells(22, 58).Value = Format(gbuMGe||03312  |''            .Cells(22, 58).Value = Format(gbuMGe
03316  |''            .Cells(22, 58).HorizontalAlignment =||03313  |''            .Cells(22, 58).HorizontalAlignment =
03317  |'''            .Range("BB22:BF22").HorizontalAlign||03314  |'''            .Range("BB22:BF22").HorizontalAlign
03318  |''        Else                                    ||03315  |''        Else                                    
03319  |''            .Cells(22, 58).NumberFormatLocal = "||03316  |''            .Cells(22, 58).NumberFormatLocal = "
03320  |''            .Cells(22, 58).Value = ""           ||03317  |''            .Cells(22, 58).Value = ""           
03321  |''            .Cells(22, 58).HorizontalAlignment =||03318  |''            .Cells(22, 58).HorizontalAlignment =
03322  |'''            .Range("BB22:BF22").HorizontalAlign||03319  |'''            .Range("BB22:BF22").HorizontalAlign
03323  |''        End If                                  ||03320  |''        End If                                  
03324  |''                                                ||03321  |''                                                
03325  |''        'NAV通貨→顧問料通貨(NAV通貨)           ||03322  |''        'NAV通貨→顧問料通貨(NAV通貨)           
03326  |''        .Cells(23, 40).Value = sWord39          ||03323  |''        .Cells(23, 40).Value = sWord39          
03327  |''        .Range("AN23:AT23").HorizontalAlignment ||03324  |''        .Range("AN23:AT23").HorizontalAlignment 
03328  |''        'NAV通貨→顧問料通貨(顧問料通貨)        ||03325  |''        'NAV通貨→顧問料通貨(顧問料通貨)        
03329  |''        .Cells(23, 47).Value = sWord41          ||03326  |''        .Cells(23, 47).Value = sWord41          
03330  |''        .Range("AU23:BA23").HorizontalAlignment ||03327  |''        .Range("AU23:BA23").HorizontalAlignment 
03331  |''        'NAV通貨→顧問料通貨(NAV通貨)           ||03328  |''        'NAV通貨→顧問料通貨(NAV通貨)           
03332  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_base_cu||03329  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_base_cu
03333  |''            .Cells(24, 42).Value = sWord43 & gbu||03330  |''            .Cells(24, 42).Value = sWord43 & gbu
03334  |'''            .Range("AN24:AT24").HorizontalAlign||03331  |'''            .Range("AN24:AT24").HorizontalAlign
03335  |''        Else                                    ||03332  |''        Else                                    
03336  |''            .Cells(24, 42).Value = ""           ||03333  |''            .Cells(24, 42).Value = ""           
03337  |'''            .Range("AN24:AT24").HorizontalAlign||03334  |'''            .Range("AN24:AT24").HorizontalAlign
03338  |''        End If                                  ||03335  |''        End If                                  
03339  |''        'NAV通貨→顧問料通貨(顧問料通貨)        ||03336  |''        'NAV通貨→顧問料通貨(顧問料通貨)        
03340  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_other_c||03337  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_other_c
03341  |''            .Cells(24, 49).Value = sWord43 & gbu||03338  |''            .Cells(24, 49).Value = sWord43 & gbu
03342  |'''            .Range("AU24:BA24").HorizontalAlign||03339  |'''            .Range("AU24:BA24").HorizontalAlign
03343  |''        Else                                    ||03340  |''        Else                                    
03344  |''            .Cells(24, 49).Value = ""           ||03341  |''            .Cells(24, 49).Value = ""           
03345  |'''            .Range("AU24:BA24").HorizontalAlign||03342  |'''            .Range("AU24:BA24").HorizontalAlign
03346  |''        End If                                  ||03343  |''        End If                                  
03347  |''        'NAV通貨→顧問料通貨(レート)            ||03344  |''        'NAV通貨→顧問料通貨(レート)            
03348  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_NavCom ||03345  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_NavCom 
03349  |''            .Cells(24, 58).NumberFormatLocal = "||03346  |''            .Cells(24, 58).NumberFormatLocal = "
03350  |''            .Cells(24, 58).Value = Format(gbuMGe||03347  |''            .Cells(24, 58).Value = Format(gbuMGe
03351  |''            .Cells(24, 58).HorizontalAlignment =||03348  |''            .Cells(24, 58).HorizontalAlignment =
03352  |'''            .Range("BB24:BF24").HorizontalAlign||03349  |'''            .Range("BB24:BF24").HorizontalAlign
03353  |''        Else                                    ||03350  |''        Else                                    
03354  |''            .Cells(24, 58).NumberFormatLocal = "||03351  |''            .Cells(24, 58).NumberFormatLocal = "
03355  |''            .Cells(24, 58).Value = ""           ||03352  |''            .Cells(24, 58).Value = ""           
03356  |''            .Cells(24, 58).HorizontalAlignment =||03353  |''            .Cells(24, 58).HorizontalAlignment =
03357  |'''            .Range("BB24:BF24").HorizontalAlign||03354  |'''            .Range("BB24:BF24").HorizontalAlign
03358  |''        End If                                  ||03355  |''        End If                                  
03359  |''                                                ||03356  |''                                                
03360  |''        '閾値通貨→顧問料通貨(閾値通貨)         ||03357  |''        '閾値通貨→顧問料通貨(閾値通貨)         
03361  |''        .Cells(25, 40).Value = sWord40          ||03358  |''        .Cells(25, 40).Value = sWord40          
03362  |''        .Range("AN25:AT25").HorizontalAlignment ||03359  |''        .Range("AN25:AT25").HorizontalAlignment 
03363  |''        '閾値通貨→顧問料通貨(顧問料通貨)       ||03360  |''        '閾値通貨→顧問料通貨(顧問料通貨)       
03364  |''        .Cells(25, 47).Value = sWord41          ||03361  |''        .Cells(25, 47).Value = sWord41          
03365  |''        .Range("AU25:BA25").HorizontalAlignment ||03362  |''        .Range("AU25:BA25").HorizontalAlignment 
03366  |''        '閾値通貨→顧問料通貨(閾値通貨)         ||03363  |''        '閾値通貨→顧問料通貨(閾値通貨)         
03367  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_amount_||03364  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_amount_
03368  |''            .Cells(26, 42).Value = sWord43 & gbu||03365  |''            .Cells(26, 42).Value = sWord43 & gbu
03369  |'''            .Range("AN26:AT26").HorizontalAlign||03366  |'''            .Range("AN26:AT26").HorizontalAlign
03370  |''        Else                                    ||03367  |''        Else                                    
03371  |''            .Cells(26, 42).Value = ""           ||03368  |''            .Cells(26, 42).Value = ""           
03372  |'''            .Range("AN26:AT26").HorizontalAlign||03369  |'''            .Range("AN26:AT26").HorizontalAlign
03373  |''        End If                                  ||03370  |''        End If                                  
03374  |''        '閾値通貨→顧問料通貨(顧問料通貨)       ||03371  |''        '閾値通貨→顧問料通貨(顧問料通貨)       
03375  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_other_c||03372  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_other_c
03376  |''            .Cells(26, 49).Value = sWord43 & gbu||03373  |''            .Cells(26, 49).Value = sWord43 & gbu
03377  |'''            .Range("AU26:BA26").HorizontalAlign||03374  |'''            .Range("AU26:BA26").HorizontalAlign
03378  |''        Else                                    ||03375  |''        Else                                    
03379  |''            .Cells(26, 49).Value = ""           ||03376  |''            .Cells(26, 49).Value = ""           
03380  |'''            .Range("AU26:BA26").HorizontalAlign||03377  |'''            .Range("AU26:BA26").HorizontalAlign
03381  |''        End If                                  ||03378  |''        End If                                  
03382  |''        '閾値通貨→顧問料通貨(レート)           ||03379  |''        '閾値通貨→顧問料通貨(レート)           
03383  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_AmountC||03380  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_AmountC
03384  |''            .Cells(26, 58).NumberFormatLocal = "||03381  |''            .Cells(26, 58).NumberFormatLocal = "
03385  |''            .Cells(26, 58).Value = Format(gbuMGe||03382  |''            .Cells(26, 58).Value = Format(gbuMGe
03386  |''            .Cells(26, 58).HorizontalAlignment =||03383  |''            .Cells(26, 58).HorizontalAlignment =
03387  |'''            .Range("BB26:BF26").HorizontalAlign||03384  |'''            .Range("BB26:BF26").HorizontalAlign
03388  |''        Else                                    ||03385  |''        Else                                    
03389  |''            .Cells(26, 58).NumberFormatLocal = "||03386  |''            .Cells(26, 58).NumberFormatLocal = "
03390  |''            .Cells(26, 58).Value = ""           ||03387  |''            .Cells(26, 58).Value = ""           
03391  |''            .Cells(26, 58).HorizontalAlignment =||03388  |''            .Cells(26, 58).HorizontalAlignment =
03392  |'''            .Range("BB26:BF26").HorizontalAlign||03389  |'''            .Range("BB26:BF26").HorizontalAlign
03393  |''        End If                                  ||03390  |''        End If                                  
03394  |''                                                ||03391  |''                                                
03395  |''        '顧問料通貨→支払通貨(顧問料通貨)       ||03392  |''        '顧問料通貨→支払通貨(顧問料通貨)       
03396  |''        .Cells(27, 40).Value = sWord41          ||03393  |''        .Cells(27, 40).Value = sWord41          
03397  |''        .Range("AN27:AT27").HorizontalAlignment ||03394  |''        .Range("AN27:AT27").HorizontalAlignment 
03398  |''        '顧問料通貨→支払通貨(支払通貨)         ||03395  |''        '顧問料通貨→支払通貨(支払通貨)         
03399  |''        .Cells(27, 47).Value = sWord42          ||03396  |''        .Cells(27, 47).Value = sWord42          
03400  |''        .Range("AU27:BA27").HorizontalAlignment ||03397  |''        .Range("AU27:BA27").HorizontalAlignment 
03401  |''        '顧問料通貨→支払通貨(顧問料通貨)       ||03398  |''        '顧問料通貨→支払通貨(顧問料通貨)       
03402  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_other_c||03399  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_other_c
03403  |''            .Cells(28, 42).Value = sWord43 & gbu||03400  |''            .Cells(28, 42).Value = sWord43 & gbu
03404  |'''            .Range("AN28:AT28").HorizontalAlign||03401  |'''            .Range("AN28:AT28").HorizontalAlign
03405  |''        Else                                    ||03402  |''        Else                                    
03406  |''            .Cells(28, 42).Value = ""           ||03403  |''            .Cells(28, 42).Value = ""           
03407  |'''            .Range("AN28:AT28").HorizontalAlign||03404  |'''            .Range("AN28:AT28").HorizontalAlign
03408  |''        End If                                  ||03405  |''        End If                                  
03409  |''        '顧問料通貨→支払通貨(支払通貨)         ||03406  |''        '顧問料通貨→支払通貨(支払通貨)         
03410  |''        .Cells(28, 49).Value = sWord43 & "JPY" &||03407  |''        .Cells(28, 49).Value = sWord43 & "JPY" &
03411  |'''        .Range("AU28:BA28").HorizontalAlignment||03408  |'''        .Range("AU28:BA28").HorizontalAlignment
03412  |''        '顧問料通貨→支払通貨(レート)           ||03409  |''        '顧問料通貨→支払通貨(レート)           
03413  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_ComPay ||03410  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_ComPay 
03414  |''            .Cells(28, 58).NumberFormatLocal = "||03411  |''            .Cells(28, 58).NumberFormatLocal = "
03415  |''            .Cells(28, 58).Value = Format(gbuMGe||03412  |''            .Cells(28, 58).Value = Format(gbuMGe
03416  |''            .Cells(28, 58).HorizontalAlignment =||03413  |''            .Cells(28, 58).HorizontalAlignment =
03417  |'''            .Range("BB28:BF28").HorizontalAlign||03414  |'''            .Range("BB28:BF28").HorizontalAlign
03418  |''        Else                                    ||03415  |''        Else                                    
03419  |''            .Cells(28, 58).NumberFormatLocal = "||03416  |''            .Cells(28, 58).NumberFormatLocal = "
03420  |''            .Cells(28, 58).Value = ""           ||03417  |''            .Cells(28, 58).Value = ""           
03421  |''            .Cells(28, 58).HorizontalAlignment =||03418  |''            .Cells(28, 58).HorizontalAlignment =
03422  |'''            .Range("BB28:BF28").HorizontalAlign||03419  |'''            .Range("BB28:BF28").HorizontalAlign
03423  |''        End If                                  ||03420  |''        End If                                  
03424  |''2005/01/17 End                                  ||03421  |''2005/01/17 End                                  
03425  |'                                                 ||03422  |'                                                 
03426  |''2005/01/12 End                                  ||03423  |''2005/01/12 End                                  
03427  |'        iRowCnt = 0                              ||03424  |'        iRowCnt = 0                              
03428  |'        TotalNav = 0                             ||03425  |'        TotalNav = 0                             
03429  |''2004/09/28 Start                                ||03426  |''2004/09/28 Start                                
03430  |'        Mnav_Flg = 0                             ||03427  |'        Mnav_Flg = 0                             
03431  |''2004/09/28 End                                  ||03428  |''2004/09/28 End                                  
03432  |'                                                 ||03429  |'                                                 
03433  |''2005/03/09 Start                                ||03430  |''2005/03/09 Start                                
03434  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_contrac||03431  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_contrac
03435  |''        '契約区分「1」or「2」                   ||03432  |''        '契約区分「1」or「2」                   
03436  |''        '契約区分「1」or「2」or (「3」and 取得NA||03433  |''        '契約区分「1」or「2」or (「3」and 取得NA
03437  |''2005/03/25 Start                                ||03434  |''2005/03/25 Start                                
03438  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_contrac||03435  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_contrac
03439  |''        Or gbuMGetUPDRec.N(lRecIdx).MGET_contrac||03436  |''        Or gbuMGetUPDRec.N(lRecIdx).MGET_contrac
03440  |''        Or (gbuMGetUPDRec.N(lRecIdx).MGET_contra||03437  |''        Or (gbuMGetUPDRec.N(lRecIdx).MGET_contra
03441  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||03438  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
03442  |'        Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||03439  |'        Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
03443  |'        Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_con||03440  |'        Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_con
03444  |''2005/03/25 End                                  ||03441  |''2005/03/25 End                                  
03445  |''2005/03/09 End                                  ||03442  |''2005/03/09 End                                  
03446  |''2004/12/29 Start                                ||03443  |''2004/12/29 Start                                
03447  |''        '月次NAVを累積                          ||03444  |''        '月次NAVを累積                          
03448  |''          For i = LBound(gtypcfr_mnav_tbl) To UB||03445  |''          For i = LBound(gtypcfr_mnav_tbl) To UB
03449  |''          '2004/09/28 Start                     ||03446  |''          '2004/09/28 Start                     
03450  |'''              '日付                            ||03447  |'''              '日付                            
03451  |'''              .Cells(20 + i, 15).Value = _     ||03448  |'''              .Cells(20 + i, 15).Value = _     
03452  |'''                  Mid(gtypcfr_mnav_tbl(i).base_||03449  |'''                  Mid(gtypcfr_mnav_tbl(i).base_
03453  |'''                      WordYear & CInt(Mid(gtypc||03450  |'''                      WordYear & CInt(Mid(gtypc
03454  |'''              '純資産                          ||03451  |'''              '純資産                          
03455  |'''              .Cells(20 + i, 37).NumberFormatLo||03452  |'''              .Cells(20 + i, 37).NumberFormatLo
03456  |'''              .Cells(20 + i, 37).Value = CStr(F||03453  |'''              .Cells(20 + i, 37).Value = CStr(F
03457  |'''              .Cells(20 + i, 37).HorizontalAlig||03454  |'''              .Cells(20 + i, 37).HorizontalAlig
03458  |'''              TotalNav = TotalNav + CCur(gtypcf||03455  |'''              TotalNav = TotalNav + CCur(gtypcf
03459  |'''              iRowCnt = iRowCnt + 1            ||03456  |'''              iRowCnt = iRowCnt + 1            
03460  |''              If Len(gtypcfr_mnav_tbl(i).base_mo||03457  |''              If Len(gtypcfr_mnav_tbl(i).base_mo
03461  |''                '日付                           ||03458  |''                '日付                           
03462  |''                .Cells(20 + i, 15).Value = _    ||03459  |''                .Cells(20 + i, 15).Value = _    
03463  |''                    Mid(gtypcfr_mnav_tbl(i).base||03460  |''                    Mid(gtypcfr_mnav_tbl(i).base
03464  |''                        WordYear & CInt(Mid(gtyp||03461  |''                        WordYear & CInt(Mid(gtyp
03465  |''                '純資産                         ||03462  |''                '純資産                         
03466  |''                .Cells(20 + i, 37).NumberFormatL||03463  |''                .Cells(20 + i, 37).NumberFormatL
03467  |''                .Cells(20 + i, 37).Value = CStr(||03464  |''                .Cells(20 + i, 37).Value = CStr(
03468  |''                .Cells(20 + i, 37).HorizontalAli||03465  |''                .Cells(20 + i, 37).HorizontalAli
03469  |''                TotalNav = TotalNav + CCur(gtypc||03466  |''                TotalNav = TotalNav + CCur(gtypc
03470  |''                iRowCnt = iRowCnt + 1           ||03467  |''                iRowCnt = iRowCnt + 1           
03471  |''              Else                              ||03468  |''              Else                              
03472  |''                Mnav_Flg = 1                    ||03469  |''                Mnav_Flg = 1                    
03473  |''              End If                            ||03470  |''              End If                            
03474  |''          '2004/09/28 End                       ||03471  |''          '2004/09/28 End                       
03475  |''          Next i                                ||03472  |''          Next i                                
03476  |''        '日次NAVを算出                          ||03473  |''        '日次NAVを算出                          
03477  |''        '2004/09/28 Start                       ||03474  |''        '2004/09/28 Start                       
03478  |''          If Mnav_Flg = 1 Then                  ||03475  |''          If Mnav_Flg = 1 Then                  
03479  |''            i = i - 1                           ||03476  |''            i = i - 1                           
03480  |''          End If                                ||03477  |''          End If                                
03481  |''        '2004/09/28 End                         ||03478  |''        '2004/09/28 End                         
03482  |''          If mstrDailyNav <> "" Then            ||03479  |''          If mstrDailyNav <> "" Then            
03483  |''              '日付                             ||03480  |''              '日付                             
03484  |''              .Cells(20 + i, 15).Value = CStr(Fo||03481  |''              .Cells(20 + i, 15).Value = CStr(Fo
03485  |''              '純資産                           ||03482  |''              '純資産                           
03486  |''              .Cells(20 + i, 37).NumberFormatLoc||03483  |''              .Cells(20 + i, 37).NumberFormatLoc
03487  |''              .Cells(20 + i, 37).Value = CStr(Fo||03484  |''              .Cells(20 + i, 37).Value = CStr(Fo
03488  |''              .Cells(20 + i, 37).HorizontalAlign||03485  |''              .Cells(20 + i, 37).HorizontalAlign
03489  |''              TotalNav = TotalNav + CCur(mstrDai||03486  |''              TotalNav = TotalNav + CCur(mstrDai
03490  |''              iRowCnt = iRowCnt + 1             ||03487  |''              iRowCnt = iRowCnt + 1             
03491  |''          End If                                ||03488  |''          End If                                
03492  |''          '対象締日データ抽出                   ||03489  |''          '対象締日データ抽出                   
03493  |''          .Cells(20, 37).NumberFormatLocal = "@"||03490  |''          .Cells(20, 37).NumberFormatLocal = "@"
03494  |''          .Cells(20, 37).Value = CStr(Format(Tot||03491  |''          .Cells(20, 37).Value = CStr(Format(Tot
03495  |''          .Cells(20, 37).HorizontalAlignment = x||03492  |''          .Cells(20, 37).HorizontalAlignment = x
03496  |''          '合計(月末純資産)                     ||03493  |''          '合計(月末純資産)                     
03497  |''          .Cells(33, 37).NumberFormatLocal = "@"||03494  |''          .Cells(33, 37).NumberFormatLocal = "@"
03498  |''          .Cells(33, 37).Value = CStr(Format(Tot||03495  |''          .Cells(33, 37).Value = CStr(Format(Tot
03499  |''          .Cells(33, 37).HorizontalAlignment = x||03496  |''          .Cells(33, 37).HorizontalAlignment = x
03500  |''          '計算期間の純資産総額の合計(月末純資産||03497  |''          '計算期間の純資産総額の合計(月末純資産
03501  |''          .Cells(36, 23).NumberFormatLocal = "@"||03498  |''          .Cells(36, 23).NumberFormatLocal = "@"
03502  |''          .Cells(36, 23).Value = CStr(Format(Tot||03499  |''          .Cells(36, 23).Value = CStr(Format(Tot
03503  |''          .Cells(36, 23).HorizontalAlignment = x||03500  |''          .Cells(36, 23).HorizontalAlignment = x
03504  |''          '計算期間の純資産総額の合計÷計算期間 ||03501  |''          '計算期間の純資産総額の合計÷計算期間 
03505  |''          .Cells(36, 35).NumberFormatLocal = "@"||03502  |''          .Cells(36, 35).NumberFormatLocal = "@"
03506  |'''2004/11/17 Start                               ||03503  |'''2004/11/17 Start                               
03507  |'''          .Cells(35, 35).NumberFormatLocal = "@||03504  |'''          .Cells(35, 35).NumberFormatLocal = "@
03508  |'''          .Cells(35, 35).Value = CStr(Format(To||03505  |'''          .Cells(35, 35).Value = CStr(Format(To
03509  |'''          .Cells(36, 35).Value = CStr(Format(Ro||03506  |'''          .Cells(36, 35).Value = CStr(Format(Ro
03510  |''          dblValueIn = TotalNav / iRowCnt       ||03507  |''          dblValueIn = TotalNav / iRowCnt       
03511  |''          Call sbGetRoundValue(dblValueIn)      ||03508  |''          Call sbGetRoundValue(dblValueIn)      
03512  |''          .Cells(36, 35).Value = CStr(Format(dbl||03509  |''          .Cells(36, 35).Value = CStr(Format(dbl
03513  |'''2004/11/17 End                                 ||03510  |'''2004/11/17 End                                 
03514  |''          '÷??＝                               ||03511  |''          '÷??＝                               
03515  |''          .Cells(36, 26).Value = sWord18 & "   "||03512  |''          .Cells(36, 26).Value = sWord18 & "   "
03516  |''2005/03/09 Start                                ||03513  |''2005/03/09 Start                                
03517  |''            Select Case gbuMGetUPDRec.N(lRecIdx)||03514  |''            Select Case gbuMGetUPDRec.N(lRecIdx)
03518  |''                '契約区分：外部委託顧問料計算   ||03515  |''                '契約区分：外部委託顧問料計算   
03519  |''                Case mstrContractFlag(1)        ||03516  |''                Case mstrContractFlag(1)        
03520  |''2005/03/09 End                                  ||03517  |''2005/03/09 End                                  
03521  |'                    '月末NAV取得                 ||03518  |'                    '月末NAV取得                 
03522  |'                    If gbuMGetUPDRec.N(lRecIdx).M||03519  |'                    If gbuMGetUPDRec.N(lRecIdx).M
03523  |'                        '月次NAVを累積           ||03520  |'                        '月次NAVを累積           
03524  |'                          For i = LBound(gtypcfr_||03521  |'                          For i = LBound(gtypcfr_
03525  |'                          '2004/09/28 Start      ||03522  |'                          '2004/09/28 Start      
03526  |'                '              '日付             ||03523  |'                '              '日付             
03527  |'                '              .Cells(20 + i, 15)||03524  |'                '              .Cells(20 + i, 15)
03528  |'                '                  Mid(gtypcfr_mn||03525  |'                '                  Mid(gtypcfr_mn
03529  |'                '                      WordYear &||03526  |'                '                      WordYear &
03530  |'                '              '純資産           ||03527  |'                '              '純資産           
03531  |'                '              .Cells(20 + i, 37)||03528  |'                '              .Cells(20 + i, 37)
03532  |'                '              .Cells(20 + i, 37)||03529  |'                '              .Cells(20 + i, 37)
03533  |'                '              .Cells(20 + i, 37)||03530  |'                '              .Cells(20 + i, 37)
03534  |'                '              TotalNav = TotalNa||03531  |'                '              TotalNav = TotalNa
03535  |'                '              iRowCnt = iRowCnt ||03532  |'                '              iRowCnt = iRowCnt 
03536  |'                              If Len(gtypcfr_mnav||03533  |'                              If Len(gtypcfr_mnav
03537  |''2005/01/12 Start                                ||03534  |''2005/01/12 Start                                
03538  |'                                '日付            ||03535  |'                                '日付            
03539  |'                                .Cells(20 + i, 15||03536  |'                                .Cells(20 + i, 15
03540  |'                                        WordYear ||03537  |'                                        WordYear 
03541  |''                                '純資産         ||03538  |''                                '純資産         
03542  |''                                .Cells(20 + i, 3||03539  |''                                .Cells(20 + i, 3
03543  |'''2005/01/11 Start                               ||03540  |'''2005/01/11 Start                               
03544  |'''                                .Cells(20 + i, ||03541  |'''                                .Cells(20 + i, 
03545  |''                                .Cells(20 + i, 3||03542  |''                                .Cells(20 + i, 3
03546  |'''2005/01/11 End                                 ||03543  |'''2005/01/11 End                                 
03547  |''                                .Cells(20 + i, 3||03544  |''                                .Cells(20 + i, 3
03548  |''                                '日付           ||03545  |''                                '日付           
03549  |''                                .Cells(20 + i, 1||03546  |''                                .Cells(20 + i, 1
03550  |''                                    Mid(gtypcfr_||03547  |''                                    Mid(gtypcfr_
03551  |''                                        WordYear||03548  |''                                        WordYear
03552  |'                                '純資産          ||03549  |'                                '純資産          
03553  |''2005/01/13 Start                                ||03550  |''2005/01/13 Start                                
03554  |''                                .Cells(20 + i, 4||03551  |''                                .Cells(20 + i, 4
03555  |''                                .Cells(20 + i, 3||03552  |''                                .Cells(20 + i, 3
03556  |'                                .Cells(20 + i, 39||03553  |'                                .Cells(20 + i, 39
03557  |''2005/01/13 End                                  ||03554  |''2005/01/13 End                                  
03558  |''2005/01/11 Start                                ||03555  |''2005/01/11 Start                                
03559  |''                                .Cells(20 + i, 4||03556  |''                                .Cells(20 + i, 4
03560  |''                                .Cells(20 + i, 3||03557  |''                                .Cells(20 + i, 3
03561  |''2005/01/20 Start                                ||03558  |''2005/01/20 Start                                
03562  |''                                .Cells(20 + i, 3||03559  |''                                .Cells(20 + i, 3
03563  |'                                If gbuMGetUPDRec.||03560  |'                                If gbuMGetUPDRec.
03564  |'                                    .Cells(20 + i||03561  |'                                    .Cells(20 + i
03565  |'                                Else             ||03562  |'                                Else             
03566  |'                                    .Cells(20 + i||03563  |'                                    .Cells(20 + i
03567  |'                                End If           ||03564  |'                                End If           
03568  |''2005/01/20 End                                  ||03565  |''2005/01/20 End                                  
03569  |''2005/01/11 End                                  ||03566  |''2005/01/11 End                                  
03570  |''                                .Cells(20 + i, 4||03567  |''                                .Cells(20 + i, 4
03571  |''                                .Cells(20 + i, 3||03568  |''                                .Cells(20 + i, 3
03572  |'                                .Cells(20 + i, 39||03569  |'                                .Cells(20 + i, 39
03573  |''2005/01/12 End                                  ||03570  |''2005/01/12 End                                  
03574  |'                                TotalNav = TotalN||03571  |'                                TotalNav = TotalN
03575  |'                                iRowCnt = iRowCnt||03572  |'                                iRowCnt = iRowCnt
03576  |'                              Else               ||03573  |'                              Else               
03577  |'                                Mnav_Flg = 1     ||03574  |'                                Mnav_Flg = 1     
03578  |'                              End If             ||03575  |'                              End If             
03579  |'                          '2004/09/28 End        ||03576  |'                          '2004/09/28 End        
03580  |'                          Next i                 ||03577  |'                          Next i                 
03581  |'                        '日次NAVを算出           ||03578  |'                        '日次NAVを算出           
03582  |'                        '2004/09/28 Start        ||03579  |'                        '2004/09/28 Start        
03583  |'                          If Mnav_Flg = 1 Then   ||03580  |'                          If Mnav_Flg = 1 Then   
03584  |'                            i = i - 1            ||03581  |'                            i = i - 1            
03585  |'                          End If                 ||03582  |'                          End If                 
03586  |'                        '2004/09/28 End          ||03583  |'                        '2004/09/28 End          
03587  |'                          If mstrDailyNav <> "" T||03584  |'                          If mstrDailyNav <> "" T
03588  |''2005/01/12 Start                                ||03585  |''2005/01/12 Start                                
03589  |'                              '日付              ||03586  |'                              '日付              
03590  |'                              .Cells(20 + i, 15).||03587  |'                              .Cells(20 + i, 15).
03591  |''                              '純資産           ||03588  |''                              '純資産           
03592  |''                              .Cells(20 + i, 37)||03589  |''                              .Cells(20 + i, 37)
03593  |'''2005/01/11 Start                               ||03590  |'''2005/01/11 Start                               
03594  |'''                              .Cells(20 + i, 37||03591  |'''                              .Cells(20 + i, 37
03595  |''                              .Cells(20 + i, 37)||03592  |''                              .Cells(20 + i, 37)
03596  |'''2005/01/11 End                                 ||03593  |'''2005/01/11 End                                 
03597  |''                              .Cells(20 + i, 37)||03594  |''                              .Cells(20 + i, 37)
03598  |''                              '日付             ||03595  |''                              '日付             
03599  |''                              .Cells(20 + i, 13)||03596  |''                              .Cells(20 + i, 13)
03600  |'                              '純資産            ||03597  |'                              '純資産            
03601  |''                              .Cells(20 + i, 47)||03598  |''                              .Cells(20 + i, 47)
03602  |''                              .Cells(20 + i, 37)||03599  |''                              .Cells(20 + i, 37)
03603  |'                              .Cells(20 + i, 39).||03600  |'                              .Cells(20 + i, 39).
03604  |''2005/01/11 Start                                ||03601  |''2005/01/11 Start                                
03605  |''                              .Cells(20 + i, 47)||03602  |''                              .Cells(20 + i, 47)
03606  |''                              .Cells(20 + i, 37)||03603  |''                              .Cells(20 + i, 37)
03607  |''2005/01/20 Start                                ||03604  |''2005/01/20 Start                                
03608  |''                              .Cells(20 + i, 39)||03605  |''                              .Cells(20 + i, 39)
03609  |'                                If gbuMGetUPDRec.||03606  |'                                If gbuMGetUPDRec.
03610  |'                                    .Cells(20 + i||03607  |'                                    .Cells(20 + i
03611  |'                                Else             ||03608  |'                                Else             
03612  |'                                    .Cells(20 + i||03609  |'                                    .Cells(20 + i
03613  |'                                End If           ||03610  |'                                End If           
03614  |''2005/01/20 End                                  ||03611  |''2005/01/20 End                                  
03615  |''2005/01/11 End                                  ||03612  |''2005/01/11 End                                  
03616  |''                              .Cells(20 + i, 47)||03613  |''                              .Cells(20 + i, 47)
03617  |''                              .Cells(20 + i, 37)||03614  |''                              .Cells(20 + i, 37)
03618  |'                              .Cells(20 + i, 39).||03615  |'                              .Cells(20 + i, 39).
03619  |''2005/01/12 End                                  ||03616  |''2005/01/12 End                                  
03620  |'                              TotalNav = TotalNav||03617  |'                              TotalNav = TotalNav
03621  |'                              iRowCnt = iRowCnt +||03618  |'                              iRowCnt = iRowCnt +
03622  |'                          End If                 ||03619  |'                          End If                 
03623  |''2005/01/12 Start                                ||03620  |''2005/01/12 Start                                
03624  |''                          '合計(月末純資産)     ||03621  |''                          '合計(月末純資産)     
03625  |''                          .Cells(33, 37).NumberF||03622  |''                          .Cells(33, 37).NumberF
03626  |'''2005/01/11 Start                               ||03623  |'''2005/01/11 Start                               
03627  |'''                          .Cells(33, 37).Value ||03624  |'''                          .Cells(33, 37).Value 
03628  |''                          .Cells(33, 37).Value =||03625  |''                          .Cells(33, 37).Value =
03629  |'''2005/01/11 End                                 ||03626  |'''2005/01/11 End                                 
03630  |''                          .Cells(33, 37).Horizon||03627  |''                          .Cells(33, 37).Horizon
03631  |''                          '計算期間の純資産総額 ||03628  |''                          '計算期間の純資産総額 
03632  |''                          .Cells(36, 23).NumberF||03629  |''                          .Cells(36, 23).NumberF
03633  |'''2005/01/11 Start                               ||03630  |'''2005/01/11 Start                               
03634  |'''                          .Cells(36, 23).Value ||03631  |'''                          .Cells(36, 23).Value 
03635  |''                          .Cells(36, 23).Value =||03632  |''                          .Cells(36, 23).Value =
03636  |'''2005/01/11 End                                 ||03633  |'''2005/01/11 End                                 
03637  |''                          .Cells(36, 23).Horizon||03634  |''                          .Cells(36, 23).Horizon
03638  |''                          '計算期間の純資産総額 ||03635  |''                          '計算期間の純資産総額 
03639  |''                          .Cells(36, 35).NumberF||03636  |''                          .Cells(36, 35).NumberF
03640  |'                          '合計(月末純資産)      ||03637  |'                          '合計(月末純資産)      
03641  |''                          .Cells(33, 47).NumberF||03638  |''                          .Cells(33, 47).NumberF
03642  |''                          .Cells(33, 37).NumberF||03639  |''                          .Cells(33, 37).NumberF
03643  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ ||03640  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ 
03644  |'                          .Cells(33, 39).NumberFo||03641  |'                          .Cells(33, 39).NumberFo
03645  |''2005/03/09 End @@@@@ 合計行を出力しないならここ ||03642  |''2005/03/09 End @@@@@ 合計行を出力しないならここ 
03646  |''2005/03/09 Start                                ||03643  |''2005/03/09 Start                                
03647  |'                          .Cells(17, 23).NumberFo||03644  |'                          .Cells(17, 23).NumberFo
03648  |''2005/03/09 End                                  ||03645  |''2005/03/09 End                                  
03649  |''2005/01/11 Start                                ||03646  |''2005/01/11 Start                                
03650  |''                          .Cells(33, 47).Value =||03647  |''                          .Cells(33, 47).Value =
03651  |''                          .Cells(33, 37).Value =||03648  |''                          .Cells(33, 37).Value =
03652  |''2005/01/20 Start                                ||03649  |''2005/01/20 Start                                
03653  |''                          .Cells(33, 39).Value =||03650  |''                          .Cells(33, 39).Value =
03654  |'                            If gbuMGetUPDRec.N(lR||03651  |'                            If gbuMGetUPDRec.N(lR
03655  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ ||03652  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ 
03656  |'                                .Cells(33, 39).Va||03653  |'                                .Cells(33, 39).Va
03657  |''2005/03/09 End @@@@@ 合計行を出力しないならここ ||03654  |''2005/03/09 End @@@@@ 合計行を出力しないならここ 
03658  |''2005/03/09 Start                                ||03655  |''2005/03/09 Start                                
03659  |'                                .Cells(17, 23).Va||03656  |'                                .Cells(17, 23).Va
03660  |''2005/03/09 End                                  ||03657  |''2005/03/09 End                                  
03661  |'                            Else                 ||03658  |'                            Else                 
03662  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ ||03659  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ 
03663  |'                                .Cells(33, 39).Va||03660  |'                                .Cells(33, 39).Va
03664  |''2005/03/09 End @@@@@ 合計行を出力しないならここ ||03661  |''2005/03/09 End @@@@@ 合計行を出力しないならここ 
03665  |''2005/03/09 Start                                ||03662  |''2005/03/09 Start                                
03666  |'                                .Cells(17, 23).Va||03663  |'                                .Cells(17, 23).Va
03667  |''2005/03/09 End                                  ||03664  |''2005/03/09 End                                  
03668  |'                            End If               ||03665  |'                            End If               
03669  |''2005/01/20 End                                  ||03666  |''2005/01/20 End                                  
03670  |''2005/01/11 End                                  ||03667  |''2005/01/11 End                                  
03671  |''                          .Cells(33, 47).Horizon||03668  |''                          .Cells(33, 47).Horizon
03672  |''                          .Cells(33, 37).Horizon||03669  |''                          .Cells(33, 37).Horizon
03673  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ ||03670  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ 
03674  |'                          .Cells(33, 39).Horizont||03671  |'                          .Cells(33, 39).Horizont
03675  |''2005/03/09 End @@@@@ 合計行を出力しないならここ ||03672  |''2005/03/09 End @@@@@ 合計行を出力しないならここ 
03676  |''2005/03/09 Start                                ||03673  |''2005/03/09 Start                                
03677  |'                          .Cells(17, 23).Horizont||03674  |'                          .Cells(17, 23).Horizont
03678  |''2005/03/09 End                                  ||03675  |''2005/03/09 End                                  
03679  |''2005/03/09 Start                                ||03676  |''2005/03/09 Start                                
03680  |'                        '平均純資産総額          ||03677  |'                        '平均純資産総額          
03681  |'                        .Cells(36, 2).Value = sWo||03678  |'                        .Cells(36, 2).Value = sWo
03682  |'                        .Cells(36, 11).Value = sW||03679  |'                        .Cells(36, 11).Value = sW
03683  |''2005/03/09 End                                  ||03680  |''2005/03/09 End                                  
03684  |'                          '計算期間の純資産総額の||03681  |'                          '計算期間の純資産総額の
03685  |''                          .Cells(36, 21).NumberF||03682  |''                          .Cells(36, 21).NumberF
03686  |'                          .Cells(36, 23).NumberFo||03683  |'                          .Cells(36, 23).NumberFo
03687  |''2005/01/11 Start                                ||03684  |''2005/01/11 Start                                
03688  |''2005/01/20 Start                                ||03685  |''2005/01/20 Start                                
03689  |''                          .Cells(36, 23).Value =||03686  |''                          .Cells(36, 23).Value =
03690  |'                            If gbuMGetUPDRec.N(lR||03687  |'                            If gbuMGetUPDRec.N(lR
03691  |'                                .Cells(36, 23).Va||03688  |'                                .Cells(36, 23).Va
03692  |'                            Else                 ||03689  |'                            Else                 
03693  |'                                .Cells(36, 23).Va||03690  |'                                .Cells(36, 23).Va
03694  |'                            End If               ||03691  |'                            End If               
03695  |''2005/01/20 End                                  ||03692  |''2005/01/20 End                                  
03696  |''                          .Cells(36, 21).Value =||03693  |''                          .Cells(36, 21).Value =
03697  |''2005/01/11 End                                  ||03694  |''2005/01/11 End                                  
03698  |''                          .Cells(36, 21).Horizon||03695  |''                          .Cells(36, 21).Horizon
03699  |'                          .Cells(36, 23).Horizont||03696  |'                          .Cells(36, 23).Horizont
03700  |'                          '計算期間の純資産総額の||03697  |'                          '計算期間の純資産総額の
03701  |''                          .Cells(36, 33).NumberF||03698  |''                          .Cells(36, 33).NumberF
03702  |'                          .Cells(36, 35).NumberFo||03699  |'                          .Cells(36, 35).NumberFo
03703  |''2005/01/12 End                                  ||03700  |''2005/01/12 End                                  
03704  |'                '2004/11/17 Start                ||03701  |'                '2004/11/17 Start                
03705  |'                '          .Cells(35, 35).NumberF||03702  |'                '          .Cells(35, 35).NumberF
03706  |'                '          .Cells(35, 35).Value =||03703  |'                '          .Cells(35, 35).Value =
03707  |'                '          .Cells(36, 35).Value =||03704  |'                '          .Cells(36, 35).Value =
03708  |'                          dblValueIn = TotalNav /||03705  |'                          dblValueIn = TotalNav /
03709  |'''''''2005/01/11 Start                           ||03706  |'''''''2005/01/11 Start                           
03710  |''''''                          Select Case gbuMGe||03707  |''''''                          Select Case gbuMGe
03711  |''''''                            Case "1"    '固 ||03708  |''''''                            Case "1"    '固 
03712  |''''''                                'NAV通貨と外||03709  |''''''                                'NAV通貨と外
03713  |''''''                                If gbuMGetUP||03710  |''''''                                If gbuMGetUP
03714  |''''''                                    '外部委 ||03711  |''''''                                    '外部委 
03715  |''''''                                    If gbuMG||03712  |''''''                                    If gbuMG
03716  |''''''                                    End If  ||03713  |''''''                                    End If  
03717  |''''''                                End If      ||03714  |''''''                                End If      
03718  |''''''                                'NAV通貨と外||03715  |''''''                                'NAV通貨と外
03719  |''''''                                If gbuMGetUP||03716  |''''''                                If gbuMGetUP
03720  |''''''                                    '外部委 ||03717  |''''''                                    '外部委 
03721  |''''''                                    If gbuMG||03718  |''''''                                    If gbuMG
03722  |''''''                                    End If  ||03719  |''''''                                    End If  
03723  |''''''                                End If      ||03720  |''''''                                End If      
03724  |''''''                            Case "2"    '段 ||03721  |''''''                            Case "2"    '段 
03725  |''''''                                'NAV通貨と閾||03722  |''''''                                'NAV通貨と閾
03726  |''''''                                If gbuMGetUP||03723  |''''''                                If gbuMGetUP
03727  |''''''                                    '閾値通 ||03724  |''''''                                    '閾値通 
03728  |''''''                                    If gbuMG||03725  |''''''                                    If gbuMG
03729  |''''''                                        '外 ||03726  |''''''                                        '外 
03730  |''''''                                        If g||03727  |''''''                                        If g
03731  |''''''                                            ||03728  |''''''                                            
03732  |''''''                                        End ||03729  |''''''                                        End 
03733  |''''''                                    End If  ||03730  |''''''                                    End If  
03734  |''''''                                End If      ||03731  |''''''                                End If      
03735  |''''''                                'NAV通貨と閾||03732  |''''''                                'NAV通貨と閾
03736  |''''''                                If gbuMGetUP||03733  |''''''                                If gbuMGetUP
03737  |''''''                                    '閾値通 ||03734  |''''''                                    '閾値通 
03738  |''''''                                    If gbuMG||03735  |''''''                                    If gbuMG
03739  |''''''                                        '外 ||03736  |''''''                                        '外 
03740  |''''''                                        If g||03737  |''''''                                        If g
03741  |''''''                                            ||03738  |''''''                                            
03742  |''''''                                        End ||03739  |''''''                                        End 
03743  |''''''                                    End If  ||03740  |''''''                                    End If  
03744  |''''''                                End If      ||03741  |''''''                                End If      
03745  |''''''                          End Select        ||03742  |''''''                          End Select        
03746  |'''''''2005/01/11 End                             ||03743  |'''''''2005/01/11 End                             
03747  |''2005/01/13 Start                                ||03744  |''2005/01/13 Start                                
03748  |''                          Call sbGetRoundValue(d||03745  |''                          Call sbGetRoundValue(d
03749  |''2005/01/20 Start                                ||03746  |''2005/01/20 Start                                
03750  |'                          If gbuMGetUPDRec.N(lRec||03747  |'                          If gbuMGetUPDRec.N(lRec
03751  |'                                Call sbGetRoundVa||03748  |'                                Call sbGetRoundVa
03752  |'                          Else                   ||03749  |'                          Else                   
03753  |'                                Call sbGetRoundVa||03750  |'                                Call sbGetRoundVa
03754  |'                          End If                 ||03751  |'                          End If                 
03755  |''2005/01/20 End                                  ||03752  |''2005/01/20 End                                  
03756  |''2005/01/13 End                                  ||03753  |''2005/01/13 End                                  
03757  |''2005/01/11 Start                                ||03754  |''2005/01/11 Start                                
03758  |''                          .Cells(36, 35).Value =||03755  |''                          .Cells(36, 35).Value =
03759  |''2005/01/12 Start                                ||03756  |''2005/01/12 Start                                
03760  |''平均NAV(計算対象NAV)                            ||03757  |''平均NAV(計算対象NAV)                            
03761  |''2005/01/20 Start                                ||03758  |''2005/01/20 Start                                
03762  |''                          .Cells(36, 35).Value =||03759  |''                          .Cells(36, 35).Value =
03763  |'                            If gbuMGetUPDRec.N(lR||03760  |'                            If gbuMGetUPDRec.N(lR
03764  |'                                .Cells(36, 35).Va||03761  |'                                .Cells(36, 35).Va
03765  |'                            Else                 ||03762  |'                            Else                 
03766  |'                                .Cells(36, 35).Va||03763  |'                                .Cells(36, 35).Va
03767  |'                            End If               ||03764  |'                            End If               
03768  |''2005/01/20 End                                  ||03765  |''2005/01/20 End                                  
03769  |''2005/01/11 End                                  ||03766  |''2005/01/11 End                                  
03770  |'                '2004/11/17 End                  ||03767  |'                '2004/11/17 End                  
03771  |'                          '÷??＝                ||03768  |'                          '÷??＝                
03772  |'                          .Cells(36, 26).Value = ||03769  |'                          .Cells(36, 26).Value = 
03773  |'''平均NAV(計算対象NAV)                           ||03770  |'''平均NAV(計算対象NAV)                           
03774  |''                          .Cells(36, 33).Value =||03771  |''                          .Cells(36, 33).Value =
03775  |'''2005/01/11 End                                 ||03772  |'''2005/01/11 End                                 
03776  |''                '2004/11/17 End                 ||03773  |''                '2004/11/17 End                 
03777  |''                          '÷??＝               ||03774  |''                          '÷??＝               
03778  |''                          .Cells(36, 24).Value =||03775  |''                          .Cells(36, 24).Value =
03779  |''2005/01/12 End                                  ||03776  |''2005/01/12 End                                  
03780  |'                    Else                         ||03777  |'                    Else                         
03781  |''2005/03/09 Start                                ||03778  |''2005/03/09 Start                                
03782  |'''2005/01/11 Start                               ||03779  |'''2005/01/11 Start                               
03783  |''                        '日次NAV平均取得        ||03780  |''                        '日次NAV平均取得        
03784  |''                        sStart = gstrDateFormat2||03781  |''                        sStart = gstrDateFormat2
03785  |''                        sEnd = gstrDateFormat2(C||03782  |''                        sEnd = gstrDateFormat2(C
03786  |''                                                ||03783  |''                                                
03787  |''                        '計算開始日と外部委託顧 ||03784  |''                        '計算開始日と外部委託顧 
03788  |''                        If sStart = gbuMGetUPDRe||03785  |''                        If sStart = gbuMGetUPDRe
03789  |''                            sSql = ""           ||03786  |''                            sSql = ""           
03790  |''                            sSql = sSql & "SELEC||03787  |''                            sSql = sSql & "SELEC
03791  |''                            sSql = sSql & "FROM ||03788  |''                            sSql = sSql & "FROM 
03792  |''                            sSql = sSql & "WHERE||03789  |''                            sSql = sSql & "WHERE
03793  |''                                                ||03790  |''                                                
03794  |''                            'ﾀﾞｲﾅｾｯﾄの作成      ||03791  |''                            'ﾀﾞｲﾅｾｯﾄの作成      
03795  |''                            If gintDyCreate(sSql||03792  |''                            If gintDyCreate(sSql
03796  |''                                Exit Function   ||03793  |''                                Exit Function   
03797  |''                            Else                ||03794  |''                            Else                
03798  |''                                '休日の場合、翌 ||03795  |''                                '休日の場合、翌 
03799  |''                                If gvlnDyDataS("||03796  |''                                If gvlnDyDataS("
03800  |''                                    sSql = ""   ||03797  |''                                    sSql = ""   
03801  |''                                    sSql = sSql ||03798  |''                                    sSql = sSql 
03802  |''                                    sSql = sSql ||03799  |''                                    sSql = sSql 
03803  |''                                    sSql = sSql ||03800  |''                                    sSql = sSql 
03804  |''                                    sSql = sSql ||03801  |''                                    sSql = sSql 
03805  |''                                    sSql = sSql ||03802  |''                                    sSql = sSql 
03806  |''                                    sSql = sSql ||03803  |''                                    sSql = sSql 
03807  |''                                    sSql = sSql ||03804  |''                                    sSql = sSql 
03808  |''                                    sSql = sSql ||03805  |''                                    sSql = sSql 
03809  |''                                                ||03806  |''                                                
03810  |''                                    'ﾀﾞｲﾅｾｯﾄの作||03807  |''                                    'ﾀﾞｲﾅｾｯﾄの作
03811  |''                                    If gintDyCre||03808  |''                                    If gintDyCre
03812  |''                                        Exit Fun||03809  |''                                        Exit Fun
03813  |''                                    Else        ||03810  |''                                    Else        
03814  |''                                        ddblNear||03811  |''                                        ddblNear
03815  |'''2005/01/24 Start                               ||03812  |'''2005/01/24 Start                               
03816  |''                                        sSql = "||03813  |''                                        sSql = "
03817  |''                                        sSql = s||03814  |''                                        sSql = s
03818  |''                                        sSql = s||03815  |''                                        sSql = s
03819  |''                                        sSql = s||03816  |''                                        sSql = s
03820  |''                                        sSql = s||03817  |''                                        sSql = s
03821  |''                                        sSql = s||03818  |''                                        sSql = s
03822  |''                                        sSql = s||03819  |''                                        sSql = s
03823  |''                                        sSql = s||03820  |''                                        sSql = s
03824  |''                                        'ﾀﾞｲﾅｾｯﾄ||03821  |''                                        'ﾀﾞｲﾅｾｯﾄ
03825  |''                                        If gintD||03822  |''                                        If gintD
03826  |''                                            Exit||03823  |''                                            Exit
03827  |''                                        Else    ||03824  |''                                        Else    
03828  |''                                            sSta||03825  |''                                            sSta
03829  |''                                            dSta||03826  |''                                            dSta
03830  |''                                            .Cel||03827  |''                                            .Cel
03831  |''                                                ||03828  |''                                                
03832  |''                                                ||03829  |''                                                
03833  |''                                                ||03830  |''                                                
03834  |''                                            iCal||03831  |''                                            iCal
03835  |''                                        End If  ||03832  |''                                        End If  
03836  |'''2005/01/24 End                                 ||03833  |'''2005/01/24 End                                 
03837  |''                                    End If      ||03834  |''                                    End If      
03838  |''                                End If          ||03835  |''                                End If          
03839  |''                            End If              ||03836  |''                            End If              
03840  |''                        End If                  ||03837  |''                        End If                  
03841  |'''2005/01/11 End                                 ||03838  |'''2005/01/11 End                                 
03842  |''                        sSql = ""               ||03839  |''                        sSql = ""               
03843  |''                        sSql = sSql & "SELECT   ||03840  |''                        sSql = sSql & "SELECT   
03844  |''                        sSql = sSql & "FROM  CFR||03841  |''                        sSql = sSql & "FROM  CFR
03845  |''                        sSql = sSql & "WHERE CAL||03842  |''                        sSql = sSql & "WHERE CAL
03846  |''                        sSql = sSql & "AND   CAL||03843  |''                        sSql = sSql & "AND   CAL
03847  |''                        sSql = sSql & "ORDER BY ||03844  |''                        sSql = sSql & "ORDER BY 
03848  |''                                                ||03845  |''                                                
03849  |''                        'ﾀﾞｲﾅｾｯﾄの作成          ||03846  |''                        'ﾀﾞｲﾅｾｯﾄの作成          
03850  |''                        If gintDyCreate(sSql) = ||03847  |''                        If gintDyCreate(sSql) = 
03851  |''                            Exit Function       ||03848  |''                            Exit Function       
03852  |''                        End If                  ||03849  |''                        End If                  
03853  |''                                                ||03850  |''                                                
03854  |''                        ReDim dstrCaldate(gbxOra||03851  |''                        ReDim dstrCaldate(gbxOra
03855  |''                        ReDim ddblDailynav(gbxOr||03852  |''                        ReDim ddblDailynav(gbxOr
03856  |''                                                ||03853  |''                                                
03857  |''                        'EOF判定処理            ||03854  |''                        'EOF判定処理            
03858  |''                        dlngCnt = 0             ||03855  |''                        dlngCnt = 0             
03859  |''                                                ||03856  |''                                                
03860  |''                        Do Until gblnDyEOF()    ||03857  |''                        Do Until gblnDyEOF()    
03861  |''                            dlngCnt = dlngCnt + ||03858  |''                            dlngCnt = dlngCnt + 
03862  |''                            '抽出データセット   ||03859  |''                            '抽出データセット   
03863  |''                            dstrCaldate(dlngCnt)||03860  |''                            dstrCaldate(dlngCnt)
03864  |''                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ   ||03861  |''                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ   
03865  |''                            Call gDyNext        ||03862  |''                            Call gDyNext        
03866  |''                        Loop                    ||03863  |''                        Loop                    
03867  |''                                                ||03864  |''                                                
03868  |''                        sSql = ""               ||03865  |''                        sSql = ""               
03869  |''                        sSql = sSql & "SELECT   ||03866  |''                        sSql = sSql & "SELECT   
03870  |''                        sSql = sSql & "FROM  CFR||03867  |''                        sSql = sSql & "FROM  CFR
03871  |''                        sSql = sSql & "WHERE    ||03868  |''                        sSql = sSql & "WHERE    
03872  |''                        sSql = sSql & "AND   ((C||03869  |''                        sSql = sSql & "AND   ((C
03873  |''                        sSql = sSql & "AND   ((C||03870  |''                        sSql = sSql & "AND   ((C
03874  |''                        sSql = sSql & "AND   ((C||03871  |''                        sSql = sSql & "AND   ((C
03875  |''                        sSql = sSql & "AND   ((C||03872  |''                        sSql = sSql & "AND   ((C
03876  |''                        sSql = sSql & "ORDER BY ||03873  |''                        sSql = sSql & "ORDER BY 
03877  |''                                                ||03874  |''                                                
03878  |''                        If gintDyCreate(sSql) = ||03875  |''                        If gintDyCreate(sSql) = 
03879  |''                            Exit Function       ||03876  |''                            Exit Function       
03880  |''                        End If                  ||03877  |''                        End If                  
03881  |''                                                ||03878  |''                                                
03882  |''                        dlngCnt = 0             ||03879  |''                        dlngCnt = 0             
03883  |''                                                ||03880  |''                                                
03884  |''                        Do Until gblnDyEOF()    ||03881  |''                        Do Until gblnDyEOF()    
03885  |''                            dlngCnt = dlngCnt + ||03882  |''                            dlngCnt = dlngCnt + 
03886  |''                            '抽出データセット   ||03883  |''                            '抽出データセット   
03887  |''                            dstrBasedate = gvlnD||03884  |''                            dstrBasedate = gvlnD
03888  |''                            If Mid(dstrCaldate(d||03885  |''                            If Mid(dstrCaldate(d
03889  |''                                ddblDailynav(dln||03886  |''                                ddblDailynav(dln
03890  |''                            Else                ||03887  |''                            Else                
03891  |''                                '計算開始日が外 ||03888  |''                                '計算開始日が外 
03892  |''                                If ddblNearNav <||03889  |''                                If ddblNearNav <
03893  |''                                And dlngCnt = 1 ||03890  |''                                And dlngCnt = 1 
03894  |''                                    dstrCaldate2||03891  |''                                    dstrCaldate2
03895  |''                                    dstrBasedate||03892  |''                                    dstrBasedate
03896  |''                                    dlngDiffdate||03893  |''                                    dlngDiffdate
03897  |''                                                ||03894  |''                                                
03898  |''                                    For dintFor ||03895  |''                                    For dintFor 
03899  |''                                        ddblDail||03896  |''                                        ddblDail
03900  |''                                        dlngCnt ||03897  |''                                        dlngCnt 
03901  |''                                    Next dintFor||03898  |''                                    Next dintFor
03902  |'''2005/01/18 Start                               ||03899  |'''2005/01/18 Start                               
03903  |''                                    ddblDailynav||03900  |''                                    ddblDailynav
03904  |'''2005/01/18 End                                 ||03901  |'''2005/01/18 End                                 
03905  |''                                Else            ||03902  |''                                Else            
03906  |''                                    '日次NAVにデ||03903  |''                                    '日次NAVにデ
03907  |''                                    dstrCaldate2||03904  |''                                    dstrCaldate2
03908  |''                                    dstrBasedate||03905  |''                                    dstrBasedate
03909  |''                                    dlngDiffdate||03906  |''                                    dlngDiffdate
03910  |''                                                ||03907  |''                                                
03911  |''                                    For dintFor ||03908  |''                                    For dintFor 
03912  |'''2005/01/18 Start                               ||03909  |'''2005/01/18 Start                               
03913  |'''                                        ddblDai||03910  |'''                                        ddblDai
03914  |'''                                        dlngCnt||03911  |'''                                        dlngCnt
03915  |''                                        If ddblD||03912  |''                                        If ddblD
03916  |''                                            ddbl||03913  |''                                            ddbl
03917  |''                                        Else    ||03914  |''                                        Else    
03918  |''                                            '日 ||03915  |''                                            '日 
03919  |'''2005/01/20 Start                               ||03916  |'''2005/01/20 Start                               
03920  |'''                                            ddb||03917  |'''                                            ddb
03921  |''                                            intR||03918  |''                                            intR
03922  |''                                            vbLf||03919  |''                                            vbLf
03923  |''                                            vbLf||03920  |''                                            vbLf
03924  |''                                                ||03921  |''                                                
03925  |''                                            Exit||03922  |''                                            Exit
03926  |'''2005/01/20 End                                 ||03923  |'''2005/01/20 End                                 
03927  |''                                        End If  ||03924  |''                                        End If  
03928  |''                                        dlngCnt ||03925  |''                                        dlngCnt 
03929  |'''2005/01/18 End                                 ||03926  |'''2005/01/18 End                                 
03930  |''                                    Next dintFor||03927  |''                                    Next dintFor
03931  |'''2005/01/18 Start                               ||03928  |'''2005/01/18 Start                               
03932  |''                                    ddblDailynav||03929  |''                                    ddblDailynav
03933  |'''2005/01/18 End                                 ||03930  |'''2005/01/18 End                                 
03934  |''                                End If          ||03931  |''                                End If          
03935  |''                                                ||03932  |''                                                
03936  |''''                                If Mid(dstrCal||03933  |''''                                If Mid(dstrCal
03937  |''''                                And Mid(dstrCa||03934  |''''                                And Mid(dstrCa
03938  |'''                                If Mid(dstrCald||03935  |'''                                If Mid(dstrCald
03939  |'''                                    '休日の場合||03936  |'''                                    '休日の場合
03940  |'''                                    dstrCaldate||03937  |'''                                    dstrCaldate
03941  |'''                                    dstrBasedat||03938  |'''                                    dstrBasedat
03942  |'''                                    dlngDiffdat||03939  |'''                                    dlngDiffdat
03943  |''''                                    dlngDiffda||03940  |''''                                    dlngDiffda
03944  |'''                                               ||03941  |'''                                               
03945  |'''                                    For dintFor||03942  |'''                                    For dintFor
03946  |'''                                        ddblDai||03943  |'''                                        ddblDai
03947  |'''                                        dlngCnt||03944  |'''                                        dlngCnt
03948  |'''                                    Next dintFo||03945  |'''                                    Next dintFo
03949  |''''                                    ddblDailyn||03946  |''''                                    ddblDailyn
03950  |'''                                Else           ||03947  |'''                                Else           
03951  |'''                                    '営業日の場||03948  |'''                                    '営業日の場
03952  |'''                                    dstrCaldate||03949  |'''                                    dstrCaldate
03953  |'''                                    dstrBasedat||03950  |'''                                    dstrBasedat
03954  |'''                                    dlngDiffdat||03951  |'''                                    dlngDiffdat
03955  |'''                                               ||03952  |'''                                               
03956  |'''                                    For dintFor||03953  |'''                                    For dintFor
03957  |'''                                        ddblDai||03954  |'''                                        ddblDai
03958  |'''                                        dlngCnt||03955  |'''                                        dlngCnt
03959  |'''                                    Next dintFo||03956  |'''                                    Next dintFo
03960  |''''                                    ddblDailyn||03957  |''''                                    ddblDailyn
03961  |'''                                End If         ||03958  |'''                                End If         
03962  |''                            End If              ||03959  |''                            End If              
03963  |''                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ   ||03960  |''                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ   
03964  |''                            Call gDyNext        ||03961  |''                            Call gDyNext        
03965  |''                        Loop                    ||03962  |''                        Loop                    
03966  |''                                                ||03963  |''                                                
03967  |''                        ddblTtalnav = 0         ||03964  |''                        ddblTtalnav = 0         
03968  |''                                                ||03965  |''                                                
03969  |''                        For dintFor = 1 To dlngC||03966  |''                        For dintFor = 1 To dlngC
03970  |''                            ddblTtalnav = ddblTt||03967  |''                            ddblTtalnav = ddblTt
03971  |''                        Next dintFor            ||03968  |''                        Next dintFor            
03972  |''                                                ||03969  |''                                                
03973  |''                        iRowCnt = dlngCnt       ||03970  |''                        iRowCnt = dlngCnt       
03974  |'''2005/01/18 Start                               ||03971  |'''2005/01/18 Start                               
03975  |'''                        TotalNav = ddblTtalnav ||03972  |'''                        TotalNav = ddblTtalnav 
03976  |''                        TotalNav = ddblTtalnav  ||03973  |''                        TotalNav = ddblTtalnav  
03977  |'''2005/01/18 End                                 ||03974  |'''2005/01/18 End                                 
03978  |''                        dblValueIn = TotalNav   ||03975  |''                        dblValueIn = TotalNav   
03979  |'''2005/01/13 Start                               ||03976  |'''2005/01/13 Start                               
03980  |'''                        Call sbGetRoundValue(db||03977  |'''                        Call sbGetRoundValue(db
03981  |''                        Call sbGetRoundValue2(db||03978  |''                        Call sbGetRoundValue2(db
03982  |'''2005/01/13 End                                 ||03979  |'''2005/01/13 End                                 
03983  |''                        TotalNav = dblValueOut  ||03980  |''                        TotalNav = dblValueOut  
03984  |''                                                ||03981  |''                                                
03985  |'''2005/03/09 Start                               ||03982  |'''2005/03/09 Start                               
03986  |''''2005/01/12 Start                              ||03983  |''''2005/01/12 Start                              
03987  |''''                      '対象締日データ抽出     ||03984  |''''                      '対象締日データ抽出     
03988  |''''                      .Cells(20, 37).NumberFor||03985  |''''                      .Cells(20, 37).NumberFor
03989  |'''''2005/01/11 Start                             ||03986  |'''''2005/01/11 Start                             
03990  |'''''                      .Cells(20, 37).Value = ||03987  |'''''                      .Cells(20, 37).Value = 
03991  |''''                      .Cells(20, 37).Value = C||03988  |''''                      .Cells(20, 37).Value = C
03992  |'''''2005/01/11 End                               ||03989  |'''''2005/01/11 End                               
03993  |''''                      .Cells(20, 37).Horizonta||03990  |''''                      .Cells(20, 37).Horizonta
03994  |''''                      '合計(月末純資産)       ||03991  |''''                      '合計(月末純資産)       
03995  |''''                      .Cells(33, 37).NumberFor||03992  |''''                      .Cells(33, 37).NumberFor
03996  |'''''2005/01/11 Start                             ||03993  |'''''2005/01/11 Start                             
03997  |'''''                      .Cells(33, 37).Value = ||03994  |'''''                      .Cells(33, 37).Value = 
03998  |''''                      .Cells(33, 37).Value = C||03995  |''''                      .Cells(33, 37).Value = C
03999  |'''''2005/01/11 End                               ||03996  |'''''2005/01/11 End                               
04000  |''''                      .Cells(33, 37).Horizonta||03997  |''''                      .Cells(33, 37).Horizonta
04001  |''''                      '計算期間の純資産総額の ||03998  |''''                      '計算期間の純資産総額の 
04002  |''''                      .Cells(36, 23).NumberFor||03999  |''''                      .Cells(36, 23).NumberFor
04003  |'''''2005/01/11 Start                             ||04000  |'''''2005/01/11 Start                             
04004  |'''''                      .Cells(36, 23).Value = ||04001  |'''''                      .Cells(36, 23).Value = 
04005  |''''                      .Cells(36, 23).Value = C||04002  |''''                      .Cells(36, 23).Value = C
04006  |'''''2005/01/11 End                               ||04003  |'''''2005/01/11 End                               
04007  |''''                      .Cells(36, 23).Horizonta||04004  |''''                      .Cells(36, 23).Horizonta
04008  |''''                      '計算期間の純資産総額の ||04005  |''''                      '計算期間の純資産総額の 
04009  |''''                      .Cells(36, 35).NumberFor||04006  |''''                      .Cells(36, 35).NumberFor
04010  |'''                      '対象締日データ抽出      ||04007  |'''                      '対象締日データ抽出      
04011  |''''                      .Cells(20, 37).NumberFor||04008  |''''                      .Cells(20, 37).NumberFor
04012  |''''2005/03/09 Start                              ||04009  |''''2005/03/09 Start                              
04013  |''''                      .Cells(20, 39).NumberFor||04010  |''''                      .Cells(20, 39).NumberFor
04014  |''''2005/03/09 End                                ||04011  |''''2005/03/09 End                                
04015  |''''2005/01/11 Start                              ||04012  |''''2005/01/11 Start                              
04016  |''''                      .Cells(20, 37).Value = C||04013  |''''                      .Cells(20, 37).Value = C
04017  |''''                      .Cells(20, 37).Value = C||04014  |''''                      .Cells(20, 37).Value = C
04018  |''''2005/01/20 Start                              ||04015  |''''2005/01/20 Start                              
04019  |''''                      .Cells(20, 39).Value = C||04016  |''''                      .Cells(20, 39).Value = C
04020  |''''2005/03/09 Start                              ||04017  |''''2005/03/09 Start                              
04021  |''''                        If gbuMGetUPDRec.N(lRe||04018  |''''                        If gbuMGetUPDRec.N(lRe
04022  |''''                            .Cells(20, 39).Val||04019  |''''                            .Cells(20, 39).Val
04023  |''''                        Else                  ||04020  |''''                        Else                  
04024  |''''                            .Cells(20, 39).Val||04021  |''''                            .Cells(20, 39).Val
04025  |''''                        End If                ||04022  |''''                        End If                
04026  |''''2005/03/09 End                                ||04023  |''''2005/03/09 End                                
04027  |''''2005/01/20 End                                ||04024  |''''2005/01/20 End                                
04028  |''''2005/01/11 End                                ||04025  |''''2005/01/11 End                                
04029  |''''                      .Cells(20, 37).Horizonta||04026  |''''                      .Cells(20, 37).Horizonta
04030  |''''2005/03/09 Start                              ||04027  |''''2005/03/09 Start                              
04031  |''''                      .Cells(20, 39).Horizonta||04028  |''''                      .Cells(20, 39).Horizonta
04032  |''''2005/03/09 End                                ||04029  |''''2005/03/09 End                                
04033  |'''                      '合計(月末純資産)        ||04030  |'''                      '合計(月末純資産)        
04034  |''''                      .Cells(33, 37).NumberFor||04031  |''''                      .Cells(33, 37).NumberFor
04035  |''''2005/03/09 Start                              ||04032  |''''2005/03/09 Start                              
04036  |''''                      .Cells(33, 39).NumberFor||04033  |''''                      .Cells(33, 39).NumberFor
04037  |''''2005/03/09 End                                ||04034  |''''2005/03/09 End                                
04038  |''''2005/03/09 Start                              ||04035  |''''2005/03/09 Start                              
04039  |'''                      .Cells(17, 21).NumberForm||04036  |'''                      .Cells(17, 21).NumberForm
04040  |''''2005/03/09 End                                ||04037  |''''2005/03/09 End                                
04041  |''''2005/01/11 Start                              ||04038  |''''2005/01/11 Start                              
04042  |''''                      .Cells(33, 37).Value = C||04039  |''''                      .Cells(33, 37).Value = C
04043  |''''                      .Cells(33, 37).Value = C||04040  |''''                      .Cells(33, 37).Value = C
04044  |''''2005/01/20 Start                              ||04041  |''''2005/01/20 Start                              
04045  |''''                      .Cells(33, 39).Value = C||04042  |''''                      .Cells(33, 39).Value = C
04046  |'''                        If gbuMGetUPDRec.N(lRec||04043  |'''                        If gbuMGetUPDRec.N(lRec
04047  |''''2005/03/09 Start                              ||04044  |''''2005/03/09 Start                              
04048  |''''                            .Cells(33, 39).Val||04045  |''''                            .Cells(33, 39).Val
04049  |''''2005/03/09 End                                ||04046  |''''2005/03/09 End                                
04050  |''''2005/03/09 Start                              ||04047  |''''2005/03/09 Start                              
04051  |'''                            .Cells(17, 21).Valu||04048  |'''                            .Cells(17, 21).Valu
04052  |''''2005/03/09 End                                ||04049  |''''2005/03/09 End                                
04053  |'''                        Else                   ||04050  |'''                        Else                   
04054  |''''2005/03/09 Start                              ||04051  |''''2005/03/09 Start                              
04055  |''''                            .Cells(33, 39).Val||04052  |''''                            .Cells(33, 39).Val
04056  |''''2005/03/09 End                                ||04053  |''''2005/03/09 End                                
04057  |''''2005/03/09 Start                              ||04054  |''''2005/03/09 Start                              
04058  |'''                            .Cells(17, 21).Valu||04055  |'''                            .Cells(17, 21).Valu
04059  |''''2005/03/09 End                                ||04056  |''''2005/03/09 End                                
04060  |'''                        End If                 ||04057  |'''                        End If                 
04061  |''''2005/01/20 End                                ||04058  |''''2005/01/20 End                                
04062  |''''2005/01/11 End                                ||04059  |''''2005/01/11 End                                
04063  |''''                      .Cells(33, 37).Horizonta||04060  |''''                      .Cells(33, 37).Horizonta
04064  |''''2005/03/09 Start                              ||04061  |''''2005/03/09 Start                              
04065  |''''                      .Cells(33, 39).Horizonta||04062  |''''                      .Cells(33, 39).Horizonta
04066  |''''2005/03/09 End                                ||04063  |''''2005/03/09 End                                
04067  |''''2005/03/09 Start                              ||04064  |''''2005/03/09 Start                              
04068  |'''                      .Cells(17, 21).Horizontal||04065  |'''                      .Cells(17, 21).Horizontal
04069  |''''2005/03/09 End                                ||04066  |''''2005/03/09 End                                
04070  |''''2005/03/09 Start                              ||04067  |''''2005/03/09 Start                              
04071  |'''                        '平均純資産総額        ||04068  |'''                        '平均純資産総額        
04072  |'''                        .Cells(36, 2).Value = s||04069  |'''                        .Cells(36, 2).Value = s
04073  |'''                        .Cells(36, 11).Value = ||04070  |'''                        .Cells(36, 11).Value = 
04074  |''''2005/03/09 End                                ||04071  |''''2005/03/09 End                                
04075  |'''                      '計算期間の純資産総額の合||04072  |'''                      '計算期間の純資産総額の合
04076  |''''                      .Cells(36, 21).NumberFor||04073  |''''                      .Cells(36, 21).NumberFor
04077  |'''                      .Cells(36, 23).NumberForm||04074  |'''                      .Cells(36, 23).NumberForm
04078  |''''2005/01/11 Start                              ||04075  |''''2005/01/11 Start                              
04079  |''''                      .Cells(36, 23).Value = C||04076  |''''                      .Cells(36, 23).Value = C
04080  |''''                      .Cells(36, 21).Value = C||04077  |''''                      .Cells(36, 21).Value = C
04081  |''''2005/01/20 Start                              ||04078  |''''2005/01/20 Start                              
04082  |''''                      .Cells(36, 23).Value = C||04079  |''''                      .Cells(36, 23).Value = C
04083  |'''                        If gbuMGetUPDRec.N(lRec||04080  |'''                        If gbuMGetUPDRec.N(lRec
04084  |'''                            .Cells(36, 23).Valu||04081  |'''                            .Cells(36, 23).Valu
04085  |'''                        Else                   ||04082  |'''                        Else                   
04086  |'''                            .Cells(36, 23).Valu||04083  |'''                            .Cells(36, 23).Valu
04087  |'''                        End If                 ||04084  |'''                        End If                 
04088  |''''2005/01/20 End                                ||04085  |''''2005/01/20 End                                
04089  |''''2005/01/11 End                                ||04086  |''''2005/01/11 End                                
04090  |''''                      .Cells(36, 21).Horizonta||04087  |''''                      .Cells(36, 21).Horizonta
04091  |'''                      .Cells(36, 23).Horizontal||04088  |'''                      .Cells(36, 23).Horizontal
04092  |'''                      '計算期間の純資産総額の合||04089  |'''                      '計算期間の純資産総額の合
04093  |''''                      .Cells(36, 33).NumberFor||04090  |''''                      .Cells(36, 33).NumberFor
04094  |'''                      .Cells(36, 35).NumberForm||04091  |'''                      .Cells(36, 35).NumberForm
04095  |''''2005/01/12 End                                ||04092  |''''2005/01/12 End                                
04096  |'''            '2004/11/17 Start                  ||04093  |'''            '2004/11/17 Start                  
04097  |'''            '          .Cells(35, 35).NumberFor||04094  |'''            '          .Cells(35, 35).NumberFor
04098  |'''            '          .Cells(35, 35).Value = C||04095  |'''            '          .Cells(35, 35).Value = C
04099  |'''            '          .Cells(36, 35).Value = C||04096  |'''            '          .Cells(36, 35).Value = C
04100  |'''                      dblValueIn = TotalNav / i||04097  |'''                      dblValueIn = TotalNav / i
04101  |'''''''''2005/01/11 Start                         ||04098  |'''''''''2005/01/11 Start                         
04102  |''''''''                        Select Case gbuMGe||04099  |''''''''                        Select Case gbuMGe
04103  |''''''''                          Case "1"    '固 ||04100  |''''''''                          Case "1"    '固 
04104  |''''''''                              'NAV通貨と外||04101  |''''''''                              'NAV通貨と外
04105  |''''''''                              If gbuMGetUP||04102  |''''''''                              If gbuMGetUP
04106  |''''''''                                  '外部委 ||04103  |''''''''                                  '外部委 
04107  |''''''''                                  If gbuMG||04104  |''''''''                                  If gbuMG
04108  |''''''''                                  End If  ||04105  |''''''''                                  End If  
04109  |''''''''                              End If      ||04106  |''''''''                              End If      
04110  |''''''''                              'NAV通貨と外||04107  |''''''''                              'NAV通貨と外
04111  |''''''''                              If gbuMGetUP||04108  |''''''''                              If gbuMGetUP
04112  |''''''''                                  '外部委 ||04109  |''''''''                                  '外部委 
04113  |''''''''                                  If gbuMG||04110  |''''''''                                  If gbuMG
04114  |''''''''                                  End If  ||04111  |''''''''                                  End If  
04115  |''''''''                              End If      ||04112  |''''''''                              End If      
04116  |''''''''                          Case "2"    '段 ||04113  |''''''''                          Case "2"    '段 
04117  |''''''''                              'NAV通貨と閾||04114  |''''''''                              'NAV通貨と閾
04118  |''''''''                              If gbuMGetUP||04115  |''''''''                              If gbuMGetUP
04119  |''''''''                                  '閾値通 ||04116  |''''''''                                  '閾値通 
04120  |''''''''                                  If gbuMG||04117  |''''''''                                  If gbuMG
04121  |''''''''                                      '外 ||04118  |''''''''                                      '外 
04122  |''''''''                                      If g||04119  |''''''''                                      If g
04123  |''''''''                                          ||04120  |''''''''                                          
04124  |''''''''                                      End ||04121  |''''''''                                      End 
04125  |''''''''                                  End If  ||04122  |''''''''                                  End If  
04126  |''''''''                              End If      ||04123  |''''''''                              End If      
04127  |''''''''                              'NAV通貨と閾||04124  |''''''''                              'NAV通貨と閾
04128  |''''''''                              If gbuMGetUP||04125  |''''''''                              If gbuMGetUP
04129  |''''''''                                  '閾値通 ||04126  |''''''''                                  '閾値通 
04130  |''''''''                                  If gbuMG||04127  |''''''''                                  If gbuMG
04131  |''''''''                                      '外 ||04128  |''''''''                                      '外 
04132  |''''''''                                      If g||04129  |''''''''                                      If g
04133  |''''''''                                          ||04130  |''''''''                                          
04134  |''''''''                                      End ||04131  |''''''''                                      End 
04135  |''''''''                                  End If  ||04132  |''''''''                                  End If  
04136  |''''''''                              End If      ||04133  |''''''''                              End If      
04137  |''''''''                        End Select        ||04134  |''''''''                        End Select        
04138  |'''''''''2005/01/11 End                           ||04135  |'''''''''2005/01/11 End                           
04139  |''''2005/01/13 Start                              ||04136  |''''2005/01/13 Start                              
04140  |''''                      Call sbGetRoundValue(dbl||04137  |''''                      Call sbGetRoundValue(dbl
04141  |''''2005/01/20 Start                              ||04138  |''''2005/01/20 Start                              
04142  |''''                      Call sbGetRoundValue2(db||04139  |''''                      Call sbGetRoundValue2(db
04143  |'''                      If gbuMGetUPDRec.N(lRecId||04140  |'''                      If gbuMGetUPDRec.N(lRecId
04144  |'''                            Call sbGetRoundValu||04141  |'''                            Call sbGetRoundValu
04145  |'''                      Else                     ||04142  |'''                      Else                     
04146  |'''                            Call sbGetRoundValu||04143  |'''                            Call sbGetRoundValu
04147  |'''                      End If                   ||04144  |'''                      End If                   
04148  |''''2005/01/20 End                                ||04145  |''''2005/01/20 End                                
04149  |''''2005/01/13 End                                ||04146  |''''2005/01/13 End                                
04150  |''''2005/01/11 Start                              ||04147  |''''2005/01/11 Start                              
04151  |''''                      .Cells(36, 35).Value = C||04148  |''''                      .Cells(36, 35).Value = C
04152  |''''2005/01/12 Start                              ||04149  |''''2005/01/12 Start                              
04153  |'''''平均NAV(計算対象NAV)                         ||04150  |'''''平均NAV(計算対象NAV)                         
04154  |''''                      .Cells(36, 35).Value = C||04151  |''''                      .Cells(36, 35).Value = C
04155  |'''''2005/01/11 End                               ||04152  |'''''2005/01/11 End                               
04156  |''''            '2004/11/17 End                   ||04153  |''''            '2004/11/17 End                   
04157  |''''                      '÷??＝                 ||04154  |''''                      '÷??＝                 
04158  |''''                      .Cells(36, 26).Value = s||04155  |''''                      .Cells(36, 26).Value = s
04159  |''''平均NAV(計算対象NAV)                          ||04156  |''''平均NAV(計算対象NAV)                          
04160  |''''                      .Cells(36, 33).Value = C||04157  |''''                      .Cells(36, 33).Value = C
04161  |''''2005/01/20 Start                              ||04158  |''''2005/01/20 Start                              
04162  |''''                      .Cells(36, 35).Value = C||04159  |''''                      .Cells(36, 35).Value = C
04163  |'''                        If gbuMGetUPDRec.N(lRec||04160  |'''                        If gbuMGetUPDRec.N(lRec
04164  |'''                            .Cells(36, 35).Valu||04161  |'''                            .Cells(36, 35).Valu
04165  |'''                        Else                   ||04162  |'''                        Else                   
04166  |'''                            .Cells(36, 35).Valu||04163  |'''                            .Cells(36, 35).Valu
04167  |'''                        End If                 ||04164  |'''                        End If                 
04168  |''''2005/01/20 End                                ||04165  |''''2005/01/20 End                                
04169  |''''2005/01/11 End                                ||04166  |''''2005/01/11 End                                
04170  |''''2005/03/09 Start                              ||04167  |''''2005/03/09 Start                              
04171  |'''                        AvgNav = dblValueOut   ||04168  |'''                        AvgNav = dblValueOut   
04172  |''''2005/03/09 End                                ||04169  |''''2005/03/09 End                                
04173  |'''            '2004/11/17 End                    ||04170  |'''            '2004/11/17 End                    
04174  |'''                      '÷??＝                  ||04171  |'''                      '÷??＝                  
04175  |''''                      .Cells(36, 24).Value = s||04172  |''''                      .Cells(36, 24).Value = s
04176  |'''                      .Cells(36, 26).Value = sW||04173  |'''                      .Cells(36, 26).Value = sW
04177  |''''2005/01/12 End                                ||04174  |''''2005/01/12 End                                
04178  |'''2005/03/09 End                                 ||04175  |'''2005/03/09 End                                 
04179  |''                    End If                      ||04176  |''                    End If                      
04180  |'                    ddblTtalnav = 0              ||04177  |'                    ddblTtalnav = 0              
04181  |'                    For dintFor = 0 To NavGetCnt ||04178  |'                    For dintFor = 0 To NavGetCnt 
04182  |'                                                 ||04179  |'                                                 
04183  |'                        '日次NAV平均取得         ||04180  |'                        '日次NAV平均取得         
04184  |'                        sStart = gstrDateFormat2(||04181  |'                        sStart = gstrDateFormat2(
04185  |'                        sEnd = gstrDateFormat2(CS||04182  |'                        sEnd = gstrDateFormat2(CS
04186  |'                                                 ||04183  |'                                                 
04187  |'                        '計算開始日と外部委託顧問||04184  |'                        '計算開始日と外部委託顧問
04188  |'                        If sStart = gbuMGetUPDRec||04185  |'                        If sStart = gbuMGetUPDRec
04189  |'                            sSql = ""            ||04186  |'                            sSql = ""            
04190  |'                            sSql = sSql & "SELECT||04187  |'                            sSql = sSql & "SELECT
04191  |'                                                 ||04188  |'                                                 
04192  |'                            'ﾀﾞｲﾅｾｯﾄの作成       ||04189  |'                            'ﾀﾞｲﾅｾｯﾄの作成       
04193  |'                            If gintDyCreate(sSql)||04190  |'                            If gintDyCreate(sSql)
04194  |'                                Exit Function    ||04191  |'                                Exit Function    
04195  |'                            Else                 ||04192  |'                            Else                 
04196  |'                                '休日の場合、翌営||04193  |'                                '休日の場合、翌営
04197  |'                                If gvlnDyDataS("E||04194  |'                                If gvlnDyDataS("E
04198  |'                                    sSql = ""    ||04195  |'                                    sSql = ""    
04199  |'                                    sSql = sSql &||04196  |'                                    sSql = sSql &
04200  |'                                    sSql = sSql &||04197  |'                                    sSql = sSql &
04201  |'                                    sSql = sSql &||04198  |'                                    sSql = sSql &
04202  |'                                    sSql = sSql &||04199  |'                                    sSql = sSql &
04203  |'                                                 ||04200  |'                                                 
04204  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||04201  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
04205  |'                                    If gintDyCrea||04202  |'                                    If gintDyCrea
04206  |'                                        Exit Func||04203  |'                                        Exit Func
04207  |'                                    Else         ||04204  |'                                    Else         
04208  |'                                        ddblNearN||04205  |'                                        ddblNearN
04209  |'                                        sSql = ""||04206  |'                                        sSql = ""
04210  |'                                        sSql = sS||04207  |'                                        sSql = sS
04211  |'                                        sSql = sS||04208  |'                                        sSql = sS
04212  |'                                        sSql = sS||04209  |'                                        sSql = sS
04213  |'                                        sSql = sS||04210  |'                                        sSql = sS
04214  |'                                        'ﾀﾞｲﾅｾｯﾄ ||04211  |'                                        'ﾀﾞｲﾅｾｯﾄ 
04215  |'                                        If gintDy||04212  |'                                        If gintDy
04216  |'                                            Exit ||04213  |'                                            Exit 
04217  |'                                        Else     ||04214  |'                                        Else     
04218  |'                                            sStar||04215  |'                                            sStar
04219  |'                                            dStar||04216  |'                                            dStar
04220  |'                                            .Cell||04217  |'                                            .Cell
04221  |'                                                C||04218  |'                                                C
04222  |'                                            iCalc||04219  |'                                            iCalc
04223  |'                                        End If   ||04220  |'                                        End If   
04224  |'                                    End If       ||04221  |'                                    End If       
04225  |'                                End If           ||04222  |'                                End If           
04226  |'                            End If               ||04223  |'                            End If               
04227  |'                        End If                   ||04224  |'                        End If                   
04228  |'                        sSql = ""                ||04225  |'                        sSql = ""                
04229  |'                        sSql = sSql & "SELECT CAL||04226  |'                        sSql = sSql & "SELECT CAL
04230  |'                        sSql = sSql & "WHERE CAL_||04227  |'                        sSql = sSql & "WHERE CAL_
04231  |'                                                 ||04228  |'                                                 
04232  |'                        'ﾀﾞｲﾅｾｯﾄの作成           ||04229  |'                        'ﾀﾞｲﾅｾｯﾄの作成           
04233  |'                        If gintDyCreate(sSql) = F||04230  |'                        If gintDyCreate(sSql) = F
04234  |'                            Exit Function        ||04231  |'                            Exit Function        
04235  |'                        End If                   ||04232  |'                        End If                   
04236  |'                                                 ||04233  |'                                                 
04237  |'                        If dlngCnt = 0 Then      ||04234  |'                        If dlngCnt = 0 Then      
04238  |'                            ReDim dstrCaldate(gbx||04235  |'                            ReDim dstrCaldate(gbx
04239  |'                            ReDim ddblDailynav(gb||04236  |'                            ReDim ddblDailynav(gb
04240  |'                        End If                   ||04237  |'                        End If                   
04241  |'                                                 ||04238  |'                                                 
04242  |'                        'EOF判定処理             ||04239  |'                        'EOF判定処理             
04243  |'                        dlngCnt = 0              ||04240  |'                        dlngCnt = 0              
04244  |'                                                 ||04241  |'                                                 
04245  |'                        Do Until gblnDyEOF()     ||04242  |'                        Do Until gblnDyEOF()     
04246  |'                            dlngCnt = dlngCnt + 1||04243  |'                            dlngCnt = dlngCnt + 1
04247  |'                            '抽出データセット    ||04244  |'                            '抽出データセット    
04248  |'                            dstrCaldate(dlngCnt) ||04245  |'                            dstrCaldate(dlngCnt) 
04249  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    ||04246  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    
04250  |'                            Call gDyNext         ||04247  |'                            Call gDyNext         
04251  |'                        Loop                     ||04248  |'                        Loop                     
04252  |'                                                 ||04249  |'                                                 
04253  |'                                                 ||04250  |'                                                 
04254  |'                        '2005/08/26　START       ||04251  |'                        '2005/08/26　START       
04255  |'                        '変数sStartに格納されてい||04252  |'                        '変数sStartに格納されてい
04256  |'                        '変数sStartの直近の営業日||04253  |'                        '変数sStartの直近の営業日
04257  |'                        '（変数sStartに格納されて||04254  |'                        '（変数sStartに格納されて
04258  |'                        '　直近日付が存在しない場||04255  |'                        '　直近日付が存在しない場
04259  |'                                                 ||04256  |'                                                 
04260  |'                        sSql = ""                ||04257  |'                        sSql = ""                
04261  |'                        sSql = sSql & "SELECT MAX||04258  |'                        sSql = sSql & "SELECT MAX
04262  |'                        sSql = sSql & "FROM   CFR||04259  |'                        sSql = sSql & "FROM   CFR
04263  |'                        sSql = sSql & "WHERE  BAS||04260  |'                        sSql = sSql & "WHERE  BAS
04264  |'                        sSql = sSql & "AND    ACC||04261  |'                        sSql = sSql & "AND    ACC
04265  |'                                                 ||04262  |'                                                 
04266  |'                        'ﾀﾞｲﾅｾｯﾄの作成           ||04263  |'                        'ﾀﾞｲﾅｾｯﾄの作成           
04267  |'                        If gintDyCreate(sSql) = F||04264  |'                        If gintDyCreate(sSql) = F
04268  |'                            Exit Function        ||04265  |'                            Exit Function        
04269  |'                        End If                   ||04266  |'                        End If                   
04270  |'                                                 ||04267  |'                                                 
04271  |'                        Do Until gblnDyEOF()     ||04268  |'                        Do Until gblnDyEOF()     
04272  |'                           '抽出データセット     ||04269  |'                           '抽出データセット     
04273  |'                            sStart = gvlnDyDataS(||04270  |'                            sStart = gvlnDyDataS(
04274  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    ||04271  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    
04275  |'                            Call gDyNext         ||04272  |'                            Call gDyNext         
04276  |'                        Loop                     ||04273  |'                        Loop                     
04277  |'                                                 ||04274  |'                                                 
04278  |'                        '2005/08/26　END         ||04275  |'                        '2005/08/26　END         
04279  |'                                                 ||04276  |'                                                 
04280  |'                        sSql = ""                ||04277  |'                        sSql = ""                
04281  |'                        sSql = sSql & "SELECT ACC||04278  |'                        sSql = sSql & "SELECT ACC
04282  |'                        sSql = sSql & "WHERE (((C||04279  |'                        sSql = sSql & "WHERE (((C
04283  |'                        sSql = sSql & "AND ((CFR_||04280  |'                        sSql = sSql & "AND ((CFR_
04284  |'                        sSql = sSql & "AND ((CFR_||04281  |'                        sSql = sSql & "AND ((CFR_
04285  |'                        sSql = sSql & "ORDER BY C||04282  |'                        sSql = sSql & "ORDER BY C
04286  |'                                                 ||04283  |'                                                 
04287  |'                        If gintDyCreate(sSql) = F||04284  |'                        If gintDyCreate(sSql) = F
04288  |'                            Exit Function        ||04285  |'                            Exit Function        
04289  |'                        End If                   ||04286  |'                        End If                   
04290  |'                                                 ||04287  |'                                                 
04291  |''2005/03/25 Start                                ||04288  |''2005/03/25 Start                                
04292  |'                        dlngCntsv = dlngCnt      ||04289  |'                        dlngCntsv = dlngCnt      
04293  |''2005/03/25 End                                  ||04290  |''2005/03/25 End                                  
04294  |'                        dlngCnt = 0              ||04291  |'                        dlngCnt = 0              
04295  |'                                                 ||04292  |'                                                 
04296  |'                        Do Until gblnDyEOF()     ||04293  |'                        Do Until gblnDyEOF()     
04297  |'                            dlngCnt = dlngCnt + 1||04294  |'                            dlngCnt = dlngCnt + 1
04298  |'                            '抽出データセット    ||04295  |'                            '抽出データセット    
04299  |'                            dstrBasedate = gvlnDy||04296  |'                            dstrBasedate = gvlnDy
04300  |'                            If Mid(dstrCaldate(dl||04297  |'                            If Mid(dstrCaldate(dl
04301  |'                                ddblDailynav(dlng||04298  |'                                ddblDailynav(dlng
04302  |'                            Else                 ||04299  |'                            Else                 
04303  |'                                '計算開始日が外部||04300  |'                                '計算開始日が外部
04304  |'                                If ddblNearNav <>||04301  |'                                If ddblNearNav <>
04305  |'                                And dlngCnt = 1 T||04302  |'                                And dlngCnt = 1 T
04306  |'                                    dstrCaldate2 ||04303  |'                                    dstrCaldate2 
04307  |'                                    dstrBasedate2||04304  |'                                    dstrBasedate2
04308  |'                                    dlngDiffdate ||04305  |'                                    dlngDiffdate 
04309  |'                                                 ||04306  |'                                                 
04310  |'                                    For dintFor2 ||04307  |'                                    For dintFor2 
04311  |'                                        ddblDaily||04308  |'                                        ddblDaily
04312  |'                                        dlngCnt =||04309  |'                                        dlngCnt =
04313  |'                                    Next dintFor2||04310  |'                                    Next dintFor2
04314  |'                                    ddblDailynav(||04311  |'                                    ddblDailynav(
04315  |'                                Else             ||04312  |'                                Else             
04316  |'                                    '日次NAVにデ ||04313  |'                                    '日次NAVにデ 
04317  |'                                    dstrCaldate2 ||04314  |'                                    dstrCaldate2 
04318  |'                                    dstrBasedate2||04315  |'                                    dstrBasedate2
04319  |'                                    dlngDiffdate ||04316  |'                                    dlngDiffdate 
04320  |'                                                 ||04317  |'                                                 
04321  |'                                    For dintFor2 ||04318  |'                                    For dintFor2 
04322  |'                                        If ddblDa||04319  |'                                        If ddblDa
04323  |'                                            ddblD||04320  |'                                            ddblD
04324  |'                                        Else     ||04321  |'                                        Else     
04325  |'                                            '日次||04322  |'                                            '日次
04326  |'                                            intRt||04323  |'                                            intRt
04327  |'                                            vbLf ||04324  |'                                            vbLf 
04328  |'                                            vbLf ||04325  |'                                            vbLf 
04329  |'                                                v||04326  |'                                                v
04330  |'                                            Exit ||04327  |'                                            Exit 
04331  |'                                        End If   ||04328  |'                                        End If   
04332  |'                                        dlngCnt =||04329  |'                                        dlngCnt =
04333  |'                                    Next dintFor2||04330  |'                                    Next dintFor2
04334  |'                                    ddblDailynav(||04331  |'                                    ddblDailynav(
04335  |'                                End If           ||04332  |'                                End If           
04336  |'                                                 ||04333  |'                                                 
04337  |'                            End If               ||04334  |'                            End If               
04338  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    ||04335  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    
04339  |'                            Call gDyNext         ||04336  |'                            Call gDyNext         
04340  |'                        Loop                     ||04337  |'                        Loop                     
04341  |'                                                 ||04338  |'                                                 
04342  |'                    Next dintFor                 ||04339  |'                    Next dintFor                 
04343  |'                                                 ||04340  |'                                                 
04344  |''2005/03/25 Start                                ||04341  |''2005/03/25 Start                                
04345  |'                    If dlngCntsv <> dlngCnt Then ||04342  |'                    If dlngCntsv <> dlngCnt Then 
04346  |'                        For dintFor2 = dlngCnt + ||04343  |'                        For dintFor2 = dlngCnt + 
04347  |'                            ddblDailynav(dintFor2||04344  |'                            ddblDailynav(dintFor2
04348  |'                        Next dintFor2            ||04345  |'                        Next dintFor2            
04349  |'                        dlngCnt = dlngCntsv      ||04346  |'                        dlngCnt = dlngCntsv      
04350  |'                    End If                       ||04347  |'                    End If                       
04351  |''2005/03/25 End                                  ||04348  |''2005/03/25 End                                  
04352  |'                                                 ||04349  |'                                                 
04353  |'                    ddblTtalnav = 0              ||04350  |'                    ddblTtalnav = 0              
04354  |'                                                 ||04351  |'                                                 
04355  |'                    For dintFor2 = 1 To dlngCnt  ||04352  |'                    For dintFor2 = 1 To dlngCnt  
04356  |'                        ddblTtalnav = ddblTtalnav||04353  |'                        ddblTtalnav = ddblTtalnav
04357  |'                    Next dintFor2                ||04354  |'                    Next dintFor2                
04358  |'                                                 ||04355  |'                                                 
04359  |'                    iRowCnt = dlngCnt            ||04356  |'                    iRowCnt = dlngCnt            
04360  |'                    TotalNav = ddblTtalnav       ||04357  |'                    TotalNav = ddblTtalnav       
04361  |'                    dblValueIn = TotalNav        ||04358  |'                    dblValueIn = TotalNav        
04362  |'                    Call sbGetRoundValue2(dblValu||04359  |'                    Call sbGetRoundValue2(dblValu
04363  |'                    TotalNav = dblValueOut       ||04360  |'                    TotalNav = dblValueOut       
04364  |''2005/03/09 End                                  ||04361  |''2005/03/09 End                                  
04365  |''2005/03/09 Start                                ||04362  |''2005/03/09 Start                                
04366  |'                      '合計(月末純資産)          ||04363  |'                      '合計(月末純資産)          
04367  |'                      .Cells(17, 23).NumberFormat||04364  |'                      .Cells(17, 23).NumberFormat
04368  |'                        If gbuMGetUPDRec.N(lRecId||04365  |'                        If gbuMGetUPDRec.N(lRecId
04369  |'                            .Cells(17, 23).Value ||04366  |'                            .Cells(17, 23).Value 
04370  |'                        Else                     ||04367  |'                        Else                     
04371  |'                            .Cells(17, 23).Value ||04368  |'                            .Cells(17, 23).Value 
04372  |'                        End If                   ||04369  |'                        End If                   
04373  |'                      .Cells(17, 23).HorizontalAl||04370  |'                      .Cells(17, 23).HorizontalAl
04374  |'                        '平均純資産総額          ||04371  |'                        '平均純資産総額          
04375  |'                        .Cells(36, 2).Value = sWo||04372  |'                        .Cells(36, 2).Value = sWo
04376  |'                        .Cells(36, 11).Value = sW||04373  |'                        .Cells(36, 11).Value = sW
04377  |'                      '計算期間の純資産総額の合計||04374  |'                      '計算期間の純資産総額の合計
04378  |'                      .Cells(36, 23).NumberFormat||04375  |'                      .Cells(36, 23).NumberFormat
04379  |'                        If gbuMGetUPDRec.N(lRecId||04376  |'                        If gbuMGetUPDRec.N(lRecId
04380  |'                            .Cells(36, 23).Value ||04377  |'                            .Cells(36, 23).Value 
04381  |'                        Else                     ||04378  |'                        Else                     
04382  |'                            .Cells(36, 23).Value ||04379  |'                            .Cells(36, 23).Value 
04383  |'                        End If                   ||04380  |'                        End If                   
04384  |'                      .Cells(36, 23).HorizontalAl||04381  |'                      .Cells(36, 23).HorizontalAl
04385  |'                      '計算期間の純資産総額の合計||04382  |'                      '計算期間の純資産総額の合計
04386  |'                      .Cells(36, 35).NumberFormat||04383  |'                      .Cells(36, 35).NumberFormat
04387  |'                      dblValueIn = TotalNav / iRo||04384  |'                      dblValueIn = TotalNav / iRo
04388  |'                      If gbuMGetUPDRec.N(lRecIdx)||04385  |'                      If gbuMGetUPDRec.N(lRecIdx)
04389  |'                            Call sbGetRoundValue2||04386  |'                            Call sbGetRoundValue2
04390  |'                      Else                       ||04387  |'                      Else                       
04391  |'                            Call sbGetRoundValue(||04388  |'                            Call sbGetRoundValue(
04392  |'                      End If                     ||04389  |'                      End If                     
04393  |'                        If gbuMGetUPDRec.N(lRecId||04390  |'                        If gbuMGetUPDRec.N(lRecId
04394  |'                            .Cells(36, 35).Value ||04391  |'                            .Cells(36, 35).Value 
04395  |'                        Else                     ||04392  |'                        Else                     
04396  |'                            .Cells(36, 35).Value ||04393  |'                            .Cells(36, 35).Value 
04397  |'                        End If                   ||04394  |'                        End If                   
04398  |'                        AvgNav = dblValueOut     ||04395  |'                        AvgNav = dblValueOut     
04399  |'                      '÷??＝                    ||04396  |'                      '÷??＝                    
04400  |'                      .Cells(36, 26).Value = sWor||04397  |'                      .Cells(36, 26).Value = sWor
04401  |'        End If                                   ||04398  |'        End If                                   
04402  |''2005/03/09 End                                  ||04399  |''2005/03/09 End                                  
04403  |''2005/03/09 Start                                ||04400  |''2005/03/09 Start                                
04404  |''                '契約区分：業務サービス料計算   ||04401  |''                '契約区分：業務サービス料計算   
04405  |''                Case mstrContractFlag(2)        ||04402  |''                Case mstrContractFlag(2)        
04406  |''                    '月次NAVを累積              ||04403  |''                    '月次NAVを累積              
04407  |''                      For i = LBound(gtypcfr_mna||04404  |''                      For i = LBound(gtypcfr_mna
04408  |''                      '2004/09/28 Start         ||04405  |''                      '2004/09/28 Start         
04409  |''            '              '日付                ||04406  |''            '              '日付                
04410  |''            '              .Cells(20 + i, 15).Va||04407  |''            '              .Cells(20 + i, 15).Va
04411  |''            '                  Mid(gtypcfr_mnav_||04408  |''            '                  Mid(gtypcfr_mnav_
04412  |''            '                      WordYear & CI||04409  |''            '                      WordYear & CI
04413  |''            '              '純資産              ||04410  |''            '              '純資産              
04414  |''            '              .Cells(20 + i, 37).Nu||04411  |''            '              .Cells(20 + i, 37).Nu
04415  |''            '              .Cells(20 + i, 37).Va||04412  |''            '              .Cells(20 + i, 37).Va
04416  |''            '              .Cells(20 + i, 37).Ho||04413  |''            '              .Cells(20 + i, 37).Ho
04417  |''            '              TotalNav = TotalNav +||04414  |''            '              TotalNav = TotalNav +
04418  |''            '              iRowCnt = iRowCnt + 1||04415  |''            '              iRowCnt = iRowCnt + 1
04419  |''                          If Len(gtypcfr_mnav_tb||04416  |''                          If Len(gtypcfr_mnav_tb
04420  |'''2005/01/12 Start                               ||04417  |'''2005/01/12 Start                               
04421  |''                            '日付               ||04418  |''                            '日付               
04422  |''                            .Cells(20 + i, 15).V||04419  |''                            .Cells(20 + i, 15).V
04423  |''                                Mid(gtypcfr_mnav||04420  |''                                Mid(gtypcfr_mnav
04424  |''                                    WordYear & C||04421  |''                                    WordYear & C
04425  |'''                            '純資産            ||04422  |'''                            '純資産            
04426  |'''                            .Cells(20 + i, 37).||04423  |'''                            .Cells(20 + i, 37).
04427  |''''2005/01/11 Start                              ||04424  |''''2005/01/11 Start                              
04428  |''''                            .Cells(20 + i, 37)||04425  |''''                            .Cells(20 + i, 37)
04429  |'''                            .Cells(20 + i, 37).||04426  |'''                            .Cells(20 + i, 37).
04430  |''''2005/01/11 End                                ||04427  |''''2005/01/11 End                                
04431  |'''                            .Cells(20 + i, 37).||04428  |'''                            .Cells(20 + i, 37).
04432  |'''                            '日付              ||04429  |'''                            '日付              
04433  |'''                            .Cells(20 + i, 13).||04430  |'''                            .Cells(20 + i, 13).
04434  |'''                                Mid(gtypcfr_mna||04431  |'''                                Mid(gtypcfr_mna
04435  |'''                                    WordYear & ||04432  |'''                                    WordYear & 
04436  |''                            '純資産             ||04433  |''                            '純資産             
04437  |'''                            .Cells(20 + i, 37).||04434  |'''                            .Cells(20 + i, 37).
04438  |''                            .Cells(20 + i, 39).N||04435  |''                            .Cells(20 + i, 39).N
04439  |'''2005/01/11 Start                               ||04436  |'''2005/01/11 Start                               
04440  |'''                            .Cells(20 + i, 37).||04437  |'''                            .Cells(20 + i, 37).
04441  |'''                            .Cells(20 + i, 37).||04438  |'''                            .Cells(20 + i, 37).
04442  |'''2005/01/20 Start                               ||04439  |'''2005/01/20 Start                               
04443  |'''                            .Cells(20 + i, 39).||04440  |'''                            .Cells(20 + i, 39).
04444  |''                            If gbuMGetUPDRec.N(l||04441  |''                            If gbuMGetUPDRec.N(l
04445  |''                                .Cells(20 + i, 3||04442  |''                                .Cells(20 + i, 3
04446  |''                            Else                ||04443  |''                            Else                
04447  |''                                .Cells(20 + i, 3||04444  |''                                .Cells(20 + i, 3
04448  |''                            End If              ||04445  |''                            End If              
04449  |'''2005/01/20 End                                 ||04446  |'''2005/01/20 End                                 
04450  |'''2005/01/11 End                                 ||04447  |'''2005/01/11 End                                 
04451  |'''                            .Cells(20 + i, 37).||04448  |'''                            .Cells(20 + i, 37).
04452  |''                            .Cells(20 + i, 39).H||04449  |''                            .Cells(20 + i, 39).H
04453  |'''2005/01/12 End                                 ||04450  |'''2005/01/12 End                                 
04454  |''                            TotalNav = TotalNav ||04451  |''                            TotalNav = TotalNav 
04455  |''                            iRowCnt = iRowCnt + ||04452  |''                            iRowCnt = iRowCnt + 
04456  |''                          Else                  ||04453  |''                          Else                  
04457  |''                            Mnav_Flg = 1        ||04454  |''                            Mnav_Flg = 1        
04458  |''                          End If                ||04455  |''                          End If                
04459  |''                      '2004/09/28 End           ||04456  |''                      '2004/09/28 End           
04460  |''                      Next i                    ||04457  |''                      Next i                    
04461  |''                    '日次NAVを算出              ||04458  |''                    '日次NAVを算出              
04462  |''                    '2004/09/28 Start           ||04459  |''                    '2004/09/28 Start           
04463  |''                      If Mnav_Flg = 1 Then      ||04460  |''                      If Mnav_Flg = 1 Then      
04464  |''                        i = i - 1               ||04461  |''                        i = i - 1               
04465  |''                      End If                    ||04462  |''                      End If                    
04466  |''                    '2004/09/28 End             ||04463  |''                    '2004/09/28 End             
04467  |''                      If mstrDailyNav <> "" Then||04464  |''                      If mstrDailyNav <> "" Then
04468  |'''2005/01/12 Start                               ||04465  |'''2005/01/12 Start                               
04469  |''                          '日付                 ||04466  |''                          '日付                 
04470  |''                          .Cells(20 + i, 15).Val||04467  |''                          .Cells(20 + i, 15).Val
04471  |'''                          '純資産              ||04468  |'''                          '純資産              
04472  |'''                          .Cells(20 + i, 37).Nu||04469  |'''                          .Cells(20 + i, 37).Nu
04473  |''''2005/01/11 Start                              ||04470  |''''2005/01/11 Start                              
04474  |''''                          .Cells(20 + i, 37).V||04471  |''''                          .Cells(20 + i, 37).V
04475  |'''                          .Cells(20 + i, 37).Va||04472  |'''                          .Cells(20 + i, 37).Va
04476  |''''2005/01/11 End                                ||04473  |''''2005/01/11 End                                
04477  |'''                          .Cells(20 + i, 37).Ho||04474  |'''                          .Cells(20 + i, 37).Ho
04478  |'''                          '日付                ||04475  |'''                          '日付                
04479  |'''                          .Cells(20 + i, 13).Va||04476  |'''                          .Cells(20 + i, 13).Va
04480  |''                          '純資産               ||04477  |''                          '純資産               
04481  |'''                          .Cells(20 + i, 37).Nu||04478  |'''                          .Cells(20 + i, 37).Nu
04482  |''                          .Cells(20 + i, 39).Num||04479  |''                          .Cells(20 + i, 39).Num
04483  |'''2005/01/11 Start                               ||04480  |'''2005/01/11 Start                               
04484  |'''                          .Cells(20 + i, 37).Va||04481  |'''                          .Cells(20 + i, 37).Va
04485  |'''                          .Cells(20 + i, 37).Va||04482  |'''                          .Cells(20 + i, 37).Va
04486  |'''2005/01/20 Start                               ||04483  |'''2005/01/20 Start                               
04487  |'''                          .Cells(20 + i, 39).Va||04484  |'''                          .Cells(20 + i, 39).Va
04488  |''                            If gbuMGetUPDRec.N(l||04485  |''                            If gbuMGetUPDRec.N(l
04489  |''                                .Cells(20 + i, 3||04486  |''                                .Cells(20 + i, 3
04490  |''                            Else                ||04487  |''                            Else                
04491  |''                                .Cells(20 + i, 3||04488  |''                                .Cells(20 + i, 3
04492  |''                            End If              ||04489  |''                            End If              
04493  |'''2005/01/20 End                                 ||04490  |'''2005/01/20 End                                 
04494  |'''2005/01/11 End                                 ||04491  |'''2005/01/11 End                                 
04495  |'''                          .Cells(20 + i, 37).Ho||04492  |'''                          .Cells(20 + i, 37).Ho
04496  |''                          .Cells(20 + i, 39).Hor||04493  |''                          .Cells(20 + i, 39).Hor
04497  |'''2005/01/12 End                                 ||04494  |'''2005/01/12 End                                 
04498  |''                          TotalNav = TotalNav + ||04495  |''                          TotalNav = TotalNav + 
04499  |''                          iRowCnt = iRowCnt + 1 ||04496  |''                          iRowCnt = iRowCnt + 1 
04500  |''                      End If                    ||04497  |''                      End If                    
04501  |'''2005/01/12 Start                               ||04498  |'''2005/01/12 Start                               
04502  |'''                      '対象締日データ抽出      ||04499  |'''                      '対象締日データ抽出      
04503  |'''                      .Cells(20, 37).NumberForm||04500  |'''                      .Cells(20, 37).NumberForm
04504  |''''2005/01/11 Start                              ||04501  |''''2005/01/11 Start                              
04505  |''''                      .Cells(20, 37).Value = C||04502  |''''                      .Cells(20, 37).Value = C
04506  |'''                      .Cells(20, 37).Value = CS||04503  |'''                      .Cells(20, 37).Value = CS
04507  |''''2005/01/11 End                                ||04504  |''''2005/01/11 End                                
04508  |'''                      .Cells(20, 37).Horizontal||04505  |'''                      .Cells(20, 37).Horizontal
04509  |'''                      '合計(月末純資産)        ||04506  |'''                      '合計(月末純資産)        
04510  |'''                      .Cells(33, 37).NumberForm||04507  |'''                      .Cells(33, 37).NumberForm
04511  |''''2005/01/11 Start                              ||04508  |''''2005/01/11 Start                              
04512  |''''                      .Cells(33, 37).Value = C||04509  |''''                      .Cells(33, 37).Value = C
04513  |'''                      .Cells(33, 37).Value = CS||04510  |'''                      .Cells(33, 37).Value = CS
04514  |''''2005/01/11 End                                ||04511  |''''2005/01/11 End                                
04515  |'''                      .Cells(33, 37).Horizontal||04512  |'''                      .Cells(33, 37).Horizontal
04516  |'''                      '計算期間の純資産総額の合||04513  |'''                      '計算期間の純資産総額の合
04517  |'''                      .Cells(36, 23).NumberForm||04514  |'''                      .Cells(36, 23).NumberForm
04518  |''''2005/01/11 Start                              ||04515  |''''2005/01/11 Start                              
04519  |''''                      .Cells(36, 23).Value = C||04516  |''''                      .Cells(36, 23).Value = C
04520  |'''                      .Cells(36, 23).Value = CS||04517  |'''                      .Cells(36, 23).Value = CS
04521  |''''2005/01/11 End                                ||04518  |''''2005/01/11 End                                
04522  |'''                      .Cells(36, 23).Horizontal||04519  |'''                      .Cells(36, 23).Horizontal
04523  |'''                      '計算期間の純資産総額の合||04520  |'''                      '計算期間の純資産総額の合
04524  |'''                      .Cells(36, 35).NumberForm||04521  |'''                      .Cells(36, 35).NumberForm
04525  |''''''''2005/01/18 Start　業務サービス料のときは明||04522  |''''''''2005/01/18 Start　業務サービス料のときは明
04526  |'''''''                      '対象締日データ抽出  ||04523  |'''''''                      '対象締日データ抽出  
04527  |'''''''                      .Cells(20, 37).Number||04524  |'''''''                      .Cells(20, 37).Number
04528  |''''''''2005/01/11 Start                          ||04525  |''''''''2005/01/11 Start                          
04529  |''''''''                      .Cells(20, 37).Value||04526  |''''''''                      .Cells(20, 37).Value
04530  |'''''''                      .Cells(20, 37).Value ||04527  |'''''''                      .Cells(20, 37).Value 
04531  |''''''''2005/01/11 End                            ||04528  |''''''''2005/01/11 End                            
04532  |'''''''                      .Cells(20, 37).Horizo||04529  |'''''''                      .Cells(20, 37).Horizo
04533  |''''''''2005/01/18 End                            ||04530  |''''''''2005/01/18 End                            
04534  |''                      '合計(月末純資産)         ||04531  |''                      '合計(月末純資産)         
04535  |'''                      .Cells(33, 37).NumberForm||04532  |'''                      .Cells(33, 37).NumberForm
04536  |''                      .Cells(33, 39).NumberForma||04533  |''                      .Cells(33, 39).NumberForma
04537  |'''2005/01/11 Start                               ||04534  |'''2005/01/11 Start                               
04538  |'''                      .Cells(33, 37).Value = CS||04535  |'''                      .Cells(33, 37).Value = CS
04539  |'''                      .Cells(33, 37).Value = CS||04536  |'''                      .Cells(33, 37).Value = CS
04540  |'''2005/01/20 Start                               ||04537  |'''2005/01/20 Start                               
04541  |'''                      .Cells(33, 39).Value = CS||04538  |'''                      .Cells(33, 39).Value = CS
04542  |''                        If gbuMGetUPDRec.N(lRecI||04539  |''                        If gbuMGetUPDRec.N(lRecI
04543  |''                            .Cells(33, 39).Value||04540  |''                            .Cells(33, 39).Value
04544  |''                        Else                    ||04541  |''                        Else                    
04545  |''                            .Cells(33, 39).Value||04542  |''                            .Cells(33, 39).Value
04546  |''                        End If                  ||04543  |''                        End If                  
04547  |'''2005/01/20 End                                 ||04544  |'''2005/01/20 End                                 
04548  |'''2005/01/11 End                                 ||04545  |'''2005/01/11 End                                 
04549  |'''                      .Cells(33, 37).Horizontal||04546  |'''                      .Cells(33, 37).Horizontal
04550  |''                      .Cells(33, 39).HorizontalA||04547  |''                      .Cells(33, 39).HorizontalA
04551  |''                      '計算期間の純資産総額の合 ||04548  |''                      '計算期間の純資産総額の合 
04552  |'''                      .Cells(36, 21).NumberForm||04549  |'''                      .Cells(36, 21).NumberForm
04553  |''                      .Cells(36, 23).NumberForma||04550  |''                      .Cells(36, 23).NumberForma
04554  |'''2005/01/11 Start                               ||04551  |'''2005/01/11 Start                               
04555  |'''                      .Cells(36, 23).Value = CS||04552  |'''                      .Cells(36, 23).Value = CS
04556  |'''                      .Cells(36, 21).Value = CS||04553  |'''                      .Cells(36, 21).Value = CS
04557  |'''2005/01/20 Start                               ||04554  |'''2005/01/20 Start                               
04558  |'''                      .Cells(36, 23).Value = CS||04555  |'''                      .Cells(36, 23).Value = CS
04559  |''                        If gbuMGetUPDRec.N(lRecI||04556  |''                        If gbuMGetUPDRec.N(lRecI
04560  |''                            .Cells(36, 23).Value||04557  |''                            .Cells(36, 23).Value
04561  |''                        Else                    ||04558  |''                        Else                    
04562  |''                            .Cells(36, 23).Value||04559  |''                            .Cells(36, 23).Value
04563  |''                        End If                  ||04560  |''                        End If                  
04564  |'''2005/01/20 End                                 ||04561  |'''2005/01/20 End                                 
04565  |'''2005/01/11 End                                 ||04562  |'''2005/01/11 End                                 
04566  |'''                      .Cells(36, 21).Horizontal||04563  |'''                      .Cells(36, 21).Horizontal
04567  |''                      .Cells(36, 23).HorizontalA||04564  |''                      .Cells(36, 23).HorizontalA
04568  |''                      '計算期間の純資産総額の合 ||04565  |''                      '計算期間の純資産総額の合 
04569  |'''                      .Cells(36, 33).NumberForm||04566  |'''                      .Cells(36, 33).NumberForm
04570  |''                      .Cells(36, 35).NumberForma||04567  |''                      .Cells(36, 35).NumberForma
04571  |'''2005/01/12 End                                 ||04568  |'''2005/01/12 End                                 
04572  |''            '2004/11/17 Start                   ||04569  |''            '2004/11/17 Start                   
04573  |''            '          .Cells(35, 35).NumberForm||04570  |''            '          .Cells(35, 35).NumberForm
04574  |''            '          .Cells(35, 35).Value = CS||04571  |''            '          .Cells(35, 35).Value = CS
04575  |''            '          .Cells(36, 35).Value = CS||04572  |''            '          .Cells(36, 35).Value = CS
04576  |''                      dblValueIn = TotalNav / iR||04573  |''                      dblValueIn = TotalNav / iR
04577  |''''''''2005/01/11 Start                          ||04574  |''''''''2005/01/11 Start                          
04578  |'''''''                    Select Case gbuMGetUPDR||04575  |'''''''                    Select Case gbuMGetUPDR
04579  |'''''''                      Case "1"    '固定料率||04576  |'''''''                      Case "1"    '固定料率
04580  |'''''''                          'NAV通貨と外部委 ||04577  |'''''''                          'NAV通貨と外部委 
04581  |'''''''                          If gbuMGetUPDRec.||04578  |'''''''                          If gbuMGetUPDRec.
04582  |'''''''                              '外部委託顧問||04579  |'''''''                              '外部委託顧問
04583  |'''''''                              If gbuMGetUPD||04580  |'''''''                              If gbuMGetUPD
04584  |'''''''                              End If       ||04581  |'''''''                              End If       
04585  |'''''''                          End If           ||04582  |'''''''                          End If           
04586  |'''''''                          'NAV通貨と外部委 ||04583  |'''''''                          'NAV通貨と外部委 
04587  |'''''''                          If gbuMGetUPDRec.||04584  |'''''''                          If gbuMGetUPDRec.
04588  |'''''''                              '外部委託顧問||04585  |'''''''                              '外部委託顧問
04589  |'''''''                              If gbuMGetUPD||04586  |'''''''                              If gbuMGetUPD
04590  |'''''''                              End If       ||04587  |'''''''                              End If       
04591  |'''''''                          End If           ||04588  |'''''''                          End If           
04592  |'''''''                      Case "2"    '段階料率||04589  |'''''''                      Case "2"    '段階料率
04593  |'''''''                          'NAV通貨と閾値通 ||04590  |'''''''                          'NAV通貨と閾値通 
04594  |'''''''                          If gbuMGetUPDRec.||04591  |'''''''                          If gbuMGetUPDRec.
04595  |'''''''                              '閾値通貨と外||04592  |'''''''                              '閾値通貨と外
04596  |'''''''                              If gbuMGetUPD||04593  |'''''''                              If gbuMGetUPD
04597  |'''''''                                  '外部委託||04594  |'''''''                                  '外部委託
04598  |'''''''                                  If gbuMGe||04595  |'''''''                                  If gbuMGe
04599  |'''''''                                      dblVa||04596  |'''''''                                      dblVa
04600  |'''''''                                  End If   ||04597  |'''''''                                  End If   
04601  |'''''''                              End If       ||04598  |'''''''                              End If       
04602  |'''''''                          End If           ||04599  |'''''''                          End If           
04603  |'''''''                          'NAV通貨と閾値通 ||04600  |'''''''                          'NAV通貨と閾値通 
04604  |'''''''                          If gbuMGetUPDRec.||04601  |'''''''                          If gbuMGetUPDRec.
04605  |'''''''                              '閾値通貨と外||04602  |'''''''                              '閾値通貨と外
04606  |'''''''                              If gbuMGetUPD||04603  |'''''''                              If gbuMGetUPD
04607  |'''''''                                  '外部委託||04604  |'''''''                                  '外部委託
04608  |'''''''                                  If gbuMGe||04605  |'''''''                                  If gbuMGe
04609  |'''''''                                      dblVa||04606  |'''''''                                      dblVa
04610  |'''''''                                  End If   ||04607  |'''''''                                  End If   
04611  |'''''''                              End If       ||04608  |'''''''                              End If       
04612  |'''''''                          End If           ||04609  |'''''''                          End If           
04613  |'''''''                    End Select             ||04610  |'''''''                    End Select             
04614  |''''''''2005/01/11 End                            ||04611  |''''''''2005/01/11 End                            
04615  |'''2005/01/13 Start                               ||04612  |'''2005/01/13 Start                               
04616  |'''                      Call sbGetRoundValue(dblV||04613  |'''                      Call sbGetRoundValue(dblV
04617  |'''2005/01/20 Start                               ||04614  |'''2005/01/20 Start                               
04618  |'''                      Call sbGetRoundValue2(dbl||04615  |'''                      Call sbGetRoundValue2(dbl
04619  |''                      If gbuMGetUPDRec.N(lRecIdx||04616  |''                      If gbuMGetUPDRec.N(lRecIdx
04620  |''                        Call sbGetRoundValue2(db||04617  |''                        Call sbGetRoundValue2(db
04621  |''                      Else                      ||04618  |''                      Else                      
04622  |''                        Call sbGetRoundValue(dbl||04619  |''                        Call sbGetRoundValue(dbl
04623  |''                      End If                    ||04620  |''                      End If                    
04624  |'''2005/01/20 End                                 ||04621  |'''2005/01/20 End                                 
04625  |'''2005/01/13 End                                 ||04622  |'''2005/01/13 End                                 
04626  |'''2005/01/11 Start                               ||04623  |'''2005/01/11 Start                               
04627  |'''                      .Cells(36, 35).Value = CS||04624  |'''                      .Cells(36, 35).Value = CS
04628  |'''2005/01/12 Start                               ||04625  |'''2005/01/12 Start                               
04629  |''''平均NAV(計算対象NAV)                          ||04626  |''''平均NAV(計算対象NAV)                          
04630  |'''                      .Cells(36, 35).Value = CS||04627  |'''                      .Cells(36, 35).Value = CS
04631  |''''2005/01/11 End                                ||04628  |''''2005/01/11 End                                
04632  |'''            '2004/11/17 End                    ||04629  |'''            '2004/11/17 End                    
04633  |'''                      '÷??＝                  ||04630  |'''                      '÷??＝                  
04634  |'''                      .Cells(36, 26).Value = sW||04631  |'''                      .Cells(36, 26).Value = sW
04635  |'''平均NAV(計算対象NAV)                           ||04632  |'''平均NAV(計算対象NAV)                           
04636  |'''                      .Cells(36, 33).Value = CS||04633  |'''                      .Cells(36, 33).Value = CS
04637  |'''2005/01/20 Start                               ||04634  |'''2005/01/20 Start                               
04638  |'''                      .Cells(36, 35).Value = CS||04635  |'''                      .Cells(36, 35).Value = CS
04639  |''                        If gbuMGetUPDRec.N(lRecI||04636  |''                        If gbuMGetUPDRec.N(lRecI
04640  |''                            .Cells(36, 35).Value||04637  |''                            .Cells(36, 35).Value
04641  |''                        Else                    ||04638  |''                        Else                    
04642  |''                            .Cells(36, 35).Value||04639  |''                            .Cells(36, 35).Value
04643  |''                        End If                  ||04640  |''                        End If                  
04644  |'''2005/01/20 End                                 ||04641  |'''2005/01/20 End                                 
04645  |'''2005/01/11 End                                 ||04642  |'''2005/01/11 End                                 
04646  |''            '2004/11/17 End                     ||04643  |''            '2004/11/17 End                     
04647  |''                      '÷??＝                   ||04644  |''                      '÷??＝                   
04648  |'''                      .Cells(36, 24).Value = sW||04645  |'''                      .Cells(36, 24).Value = sW
04649  |''                      .Cells(36, 26).Value = sWo||04646  |''                      .Cells(36, 26).Value = sWo
04650  |'''2005/01/12 End                                 ||04647  |'''2005/01/12 End                                 
04651  |''            End Select                          ||04648  |''            End Select                          
04652  |'''2004/12/29 End                                 ||04649  |'''2004/12/29 End                                 
04653  |''2005/03/09 End                                  ||04650  |''2005/03/09 End                                  
04654  |''2005/03/09 Start                                ||04651  |''2005/03/09 Start                                
04655  |''        '契約区分：名称使用許諾料計算           ||04652  |''        '契約区分：名称使用許諾料計算           
04656  |''        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_con||04653  |''        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_con
04657  |'        '契約区分：名称使用許諾料計算　かつ　日次||04654  |'        '契約区分：名称使用許諾料計算　かつ　日次
04658  |'        Else                                     ||04655  |'        Else                                     
04659  |''2005/03/09 End                                  ||04656  |''2005/03/09 End                                  
04660  |'On Error GoTo OnErrorProc                        ||04657  |'On Error GoTo OnErrorProc                        
04661  |'                                                 ||04658  |'                                                 
04662  |'            '契約区分「3」の場合                 ||04659  |'            '契約区分「3」の場合                 
04663  |''2004/12/29 Start                                ||04660  |''2004/12/29 Start                                
04664  |''            Dim sStart As String    '計算対象　 ||04661  |''            Dim sStart As String    '計算対象　 
04665  |''            Dim sEnd As String      '計算対象　 ||04662  |''            Dim sEnd As String      '計算対象　 
04666  |''2004/12/29 End                                  ||04663  |''2004/12/29 End                                  
04667  |''2005/03/09 End                                  ||04664  |''2005/03/09 End                                  
04668  |''2005/03/09 Start                                ||04665  |''2005/03/09 Start                                
04669  |''            sStart = gstrDateFormat2(CStr(dStart||04666  |''            sStart = gstrDateFormat2(CStr(dStart
04670  |''            sEnd = gstrDateFormat2(CStr(dEnd), 1||04667  |''            sEnd = gstrDateFormat2(CStr(dEnd), 1
04671  |'''2004/09/21 Start                               ||04668  |'''2004/09/21 Start                               
04672  |'''            sCurrencyCode = gbuMGetUPDRec.N(lRe||04669  |'''            sCurrencyCode = gbuMGetUPDRec.N(lRe
04673  |'''            AccCode = gbuMGetUPDRec.N(lRecIdx).||04670  |'''            AccCode = gbuMGetUPDRec.N(lRecIdx).
04674  |'''            '日次NAVの平均を算出               ||04671  |'''            '日次NAVの平均を算出               
04675  |'''            sSql = gstrEditSQLcfr_DailyAvgForSe||04672  |'''            sSql = gstrEditSQLcfr_DailyAvgForSe
04676  |'''                AccCode, sStart, sEnd, sCurrenc||04673  |'''                AccCode, sStart, sEnd, sCurrenc
04677  |''            If NavGetCnt > 1 Then               ||04674  |''            If NavGetCnt > 1 Then               
04678  |''                '１契約複数口座の場合           ||04675  |''                '１契約複数口座の場合           
04679  |''                ContNo = gbuMGetUPDRec.N(lRecIdx||04676  |''                ContNo = gbuMGetUPDRec.N(lRecIdx
04680  |''                '日次NAVの平均を算出            ||04677  |''                '日次NAVの平均を算出            
04681  |''                sSql = gstrEditSQLcfr_DailyAvgFo||04678  |''                sSql = gstrEditSQLcfr_DailyAvgFo
04682  |''            Else                                ||04679  |''            Else                                
04683  |''                '１契約１口座の場合             ||04680  |''                '１契約１口座の場合             
04684  |''                sCurrencyCode = gbuMGetUPDRec.N(||04681  |''                sCurrencyCode = gbuMGetUPDRec.N(
04685  |''                AccCode = gbuMGetUPDRec.N(lRecId||04682  |''                AccCode = gbuMGetUPDRec.N(lRecId
04686  |''                '日次NAVの平均を算出            ||04683  |''                '日次NAVの平均を算出            
04687  |''                sSql = gstrEditSQLcfr_DailyAvgFo||04684  |''                sSql = gstrEditSQLcfr_DailyAvgFo
04688  |''            End If                              ||04685  |''            End If                              
04689  |'''2004/09/21 End                                 ||04686  |'''2004/09/21 End                                 
04690  |''            'ﾀﾞｲﾅｾｯﾄの作成                      ||04687  |''            'ﾀﾞｲﾅｾｯﾄの作成                      
04691  |''            If gintDyCreate(sSql) = False Then  ||04688  |''            If gintDyCreate(sSql) = False Then  
04692  |''                Exit Function                   ||04689  |''                Exit Function                   
04693  |''            End If                              ||04690  |''            End If                              
04694  |'''2005/01/06 Start                               ||04691  |'''2005/01/06 Start                               
04695  |'''            '対象締日データ抽出                ||04692  |'''            '対象締日データ抽出                
04696  |'''            .Cells(20, 37).NumberFormatLocal = ||04693  |'''            .Cells(20, 37).NumberFormatLocal = 
04697  |'''            .Cells(20, 37).Value = CStr(Format(||04694  |'''            .Cells(20, 37).Value = CStr(Format(
04698  |'''            .Cells(20, 37).HorizontalAlignment ||04695  |'''            .Cells(20, 37).HorizontalAlignment 
04699  |'''            '合計(月末純資産)                  ||04696  |'''            '合計(月末純資産)                  
04700  |'''            .Cells(33, 37).NumberFormatLocal = ||04697  |'''            .Cells(33, 37).NumberFormatLocal = 
04701  |'''            .Cells(33, 37).Value = CStr(Format(||04698  |'''            .Cells(33, 37).Value = CStr(Format(
04702  |'''            .Cells(33, 37).HorizontalAlignment ||04699  |'''            .Cells(33, 37).HorizontalAlignment 
04703  |'''            '投資顧問料計算用計算対象NAVに日次 ||04700  |'''            '投資顧問料計算用計算対象NAVに日次 
04704  |'''            If gvlnDyDataS("AVG(CFR_DAILY_NAV_T||04701  |'''            If gvlnDyDataS("AVG(CFR_DAILY_NAV_T
04705  |'''                lCalcNav = 0                   ||04702  |'''                lCalcNav = 0                   
04706  |'''            Else                               ||04703  |'''            Else                               
04707  |''''2004/11/17 Start                              ||04704  |''''2004/11/17 Start                              
04708  |''''                lCalcNav = Format(Round(gvlnDy||04705  |''''                lCalcNav = Format(Round(gvlnDy
04709  |'''                dblValueIn = gvlnDyDataN("AVG(C||04706  |'''                dblValueIn = gvlnDyDataN("AVG(C
04710  |'''                Call sbGetRoundValue(dblValueIn||04707  |'''                Call sbGetRoundValue(dblValueIn
04711  |'''                lCalcNav = CStr(Format(dblValue||04708  |'''                lCalcNav = CStr(Format(dblValue
04712  |''''2004/11/17 End                                ||04709  |''''2004/11/17 End                                
04713  |'''            End If                             ||04710  |'''            End If                             
04714  |''                                                ||04711  |''                                                
04715  |'''2005/01/20 Start                               ||04712  |'''2005/01/20 Start                               
04716  |'''            dstrAvgNav = gvlnDyDataS("AVG(CFR_D||04713  |'''            dstrAvgNav = gvlnDyDataS("AVG(CFR_D
04717  |''            dblValueIn = gvlnDyDataS("AVG(CFR_DA||04714  |''            dblValueIn = gvlnDyDataS("AVG(CFR_DA
04718  |''            If gbuMGetUPDRec.N(lRecIdx).MGET_bas||04715  |''            If gbuMGetUPDRec.N(lRecIdx).MGET_bas
04719  |''                Call sbGetRoundValue2(dblValueIn||04716  |''                Call sbGetRoundValue2(dblValueIn
04720  |''            Else                                ||04717  |''            Else                                
04721  |''                Call sbGetRoundValue(dblValueIn)||04718  |''                Call sbGetRoundValue(dblValueIn)
04722  |''            End If                              ||04719  |''            End If                              
04723  |''            dstrAvgNav = dblValueOut            ||04720  |''            dstrAvgNav = dblValueOut            
04724  |'''2005/01/20 End                                 ||04721  |'''2005/01/20 End                                 
04725  |''                                                ||04722  |''                                                
04726  |'''2005/03/09 Start                               ||04723  |'''2005/03/09 Start                               
04727  |''            If NavGetCnt > 1 Then               ||04724  |''            If NavGetCnt > 1 Then               
04728  |''                '１契約複数口座の場合           ||04725  |''                '１契約複数口座の場合           
04729  |''                ContNo = gbuMGetUPDRec.N(lRecIdx||04726  |''                ContNo = gbuMGetUPDRec.N(lRecIdx
04730  |''                '日次NAVの合計を算出            ||04727  |''                '日次NAVの合計を算出            
04731  |''                sSql = gstrEditSQLcfr_DailyAllFo||04728  |''                sSql = gstrEditSQLcfr_DailyAllFo
04732  |''            Else                                ||04729  |''            Else                                
04733  |''                '１契約１口座の場合             ||04730  |''                '１契約１口座の場合             
04734  |''                sCurrencyCode = gbuMGetUPDRec.N(||04731  |''                sCurrencyCode = gbuMGetUPDRec.N(
04735  |''                AccCode = gbuMGetUPDRec.N(lRecId||04732  |''                AccCode = gbuMGetUPDRec.N(lRecId
04736  |''                '日次NAVの合計を算出            ||04733  |''                '日次NAVの合計を算出            
04737  |''                sSql = gstrEditSQLcfr_DailyAllFo||04734  |''                sSql = gstrEditSQLcfr_DailyAllFo
04738  |''            End If                              ||04735  |''            End If                              
04739  |''            'ﾀﾞｲﾅｾｯﾄの作成                      ||04736  |''            'ﾀﾞｲﾅｾｯﾄの作成                      
04740  |''            If gintDyCreate(sSql) = False Then  ||04737  |''            If gintDyCreate(sSql) = False Then  
04741  |''                Exit Function                   ||04738  |''                Exit Function                   
04742  |''            End If                              ||04739  |''            End If                              
04743  |''                                                ||04740  |''                                                
04744  |''            ReDim dstrCaldate(gbxOraDynaset.Reco||04741  |''            ReDim dstrCaldate(gbxOraDynaset.Reco
04745  |''            ReDim ddblDailynav(gbxOraDynaset.Rec||04742  |''            ReDim ddblDailynav(gbxOraDynaset.Rec
04746  |''                                                ||04743  |''                                                
04747  |''            'EOF判定処理                        ||04744  |''            'EOF判定処理                        
04748  |''            dlngCnt = 0                         ||04745  |''            dlngCnt = 0                         
04749  |''                                                ||04746  |''                                                
04750  |''            Do Until gblnDyEOF()                ||04747  |''            Do Until gblnDyEOF()                
04751  |''                dlngCnt = dlngCnt + 1           ||04748  |''                dlngCnt = dlngCnt + 1           
04752  |''                '抽出データセット               ||04749  |''                '抽出データセット               
04753  |''                dstrCaldate(dlngCnt) = gvlnDyDat||04750  |''                dstrCaldate(dlngCnt) = gvlnDyDat
04754  |''                ddblDailynav(dlngCnt) = gvlnDyDa||04751  |''                ddblDailynav(dlngCnt) = gvlnDyDa
04755  |''                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ               ||04752  |''                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ               
04756  |''                Call gDyNext                    ||04753  |''                Call gDyNext                    
04757  |''            Loop                                ||04754  |''            Loop                                
04758  |''                                                ||04755  |''                                                
04759  |'''2005/03/09 End                                 ||04756  |'''2005/03/09 End                                 
04760  |'            ddblTtalnav = 0                      ||04757  |'            ddblTtalnav = 0                      
04761  |'            For dintFor = 0 To NavGetCnt - 1     ||04758  |'            For dintFor = 0 To NavGetCnt - 1     
04762  |'                                                 ||04759  |'                                                 
04763  |'                '日次NAV平均取得                 ||04760  |'                '日次NAV平均取得                 
04764  |'                sStart = gstrDateFormat2(CStr(dSt||04761  |'                sStart = gstrDateFormat2(CStr(dSt
04765  |'                sEnd = gstrDateFormat2(CStr(dEnd)||04762  |'                sEnd = gstrDateFormat2(CStr(dEnd)
04766  |'                                                 ||04763  |'                                                 
04767  |'                sSql = ""                        ||04764  |'                sSql = ""                        
04768  |'                sSql = sSql & "SELECT ACCOUNT_COD||04765  |'                sSql = sSql & "SELECT ACCOUNT_COD
04769  |'                sSql = sSql & "WHERE (((CFR_DAILY||04766  |'                sSql = sSql & "WHERE (((CFR_DAILY
04770  |'                sSql = sSql & "AND ((CFR_DAILY_NA||04767  |'                sSql = sSql & "AND ((CFR_DAILY_NA
04771  |'                sSql = sSql & "AND ((CFR_DAILY_NA||04768  |'                sSql = sSql & "AND ((CFR_DAILY_NA
04772  |'                sSql = sSql & "ORDER BY CFR_DAILY||04769  |'                sSql = sSql & "ORDER BY CFR_DAILY
04773  |'                                                 ||04770  |'                                                 
04774  |'                If gintDyCreate(sSql) = False The||04771  |'                If gintDyCreate(sSql) = False The
04775  |'                    Exit Function                ||04772  |'                    Exit Function                
04776  |'                End If                           ||04773  |'                End If                           
04777  |'                                                 ||04774  |'                                                 
04778  |'                If dlngCnt = 0 Then              ||04775  |'                If dlngCnt = 0 Then              
04779  |'                    ReDim dstrCaldate(gbxOraDynas||04776  |'                    ReDim dstrCaldate(gbxOraDynas
04780  |'                    ReDim ddblDailynav(gbxOraDyna||04777  |'                    ReDim ddblDailynav(gbxOraDyna
04781  |'                End If                           ||04778  |'                End If                           
04782  |'                                                 ||04779  |'                                                 
04783  |'                dlngCnt = 0                      ||04780  |'                dlngCnt = 0                      
04784  |'                                                 ||04781  |'                                                 
04785  |'                Do Until gblnDyEOF()             ||04782  |'                Do Until gblnDyEOF()             
04786  |'                    dlngCnt = dlngCnt + 1        ||04783  |'                    dlngCnt = dlngCnt + 1        
04787  |'                    '抽出データセット            ||04784  |'                    '抽出データセット            
04788  |'                    dstrCaldate(dlngCnt) = gvlnDy||04785  |'                    dstrCaldate(dlngCnt) = gvlnDy
04789  |'                    ddblDailynav(dlngCnt) = ddblD||04786  |'                    ddblDailynav(dlngCnt) = ddblD
04790  |'                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ            ||04787  |'                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ            
04791  |'                    Call gDyNext                 ||04788  |'                    Call gDyNext                 
04792  |'                Loop                             ||04789  |'                Loop                             
04793  |'                                                 ||04790  |'                                                 
04794  |'            Next dintFor                         ||04791  |'            Next dintFor                         
04795  |'                                                 ||04792  |'                                                 
04796  |'            ddblTtalnav = 0                      ||04793  |'            ddblTtalnav = 0                      
04797  |'                                                 ||04794  |'                                                 
04798  |'            For dintFor2 = 1 To dlngCnt          ||04795  |'            For dintFor2 = 1 To dlngCnt          
04799  |'                ddblTtalnav = ddblTtalnav + ddblD||04796  |'                ddblTtalnav = ddblTtalnav + ddblD
04800  |'            Next dintFor2                        ||04797  |'            Next dintFor2                        
04801  |'                                                 ||04798  |'                                                 
04802  |'            iRowCnt = dlngCnt                    ||04799  |'            iRowCnt = dlngCnt                    
04803  |''2005/03/18 Start                                ||04800  |''2005/03/18 Start                                
04804  |'            dlngMeisyoSu = dlngCnt               ||04801  |'            dlngMeisyoSu = dlngCnt               
04805  |''2005/03/18 End                                  ||04802  |''2005/03/18 End                                  
04806  |'            TotalNav = ddblTtalnav               ||04803  |'            TotalNav = ddblTtalnav               
04807  |'            dblValueIn = TotalNav                ||04804  |'            dblValueIn = TotalNav                
04808  |'            Call sbGetRoundValue2(dblValueIn)    ||04805  |'            Call sbGetRoundValue2(dblValueIn)    
04809  |'            TotalNav = dblValueOut               ||04806  |'            TotalNav = dblValueOut               
04810  |'                                                 ||04807  |'                                                 
04811  |'            '計算期間の純資産総額の合計÷計算期間||04808  |'            '計算期間の純資産総額の合計÷計算期間
04812  |'            dblValueIn = TotalNav / iRowCnt      ||04809  |'            dblValueIn = TotalNav / iRowCnt      
04813  |'            iCalcNum = iRowCnt                   ||04810  |'            iCalcNum = iRowCnt                   
04814  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base||04811  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base
04815  |'                  Call sbGetRoundValue2(dblValueI||04812  |'                  Call sbGetRoundValue2(dblValueI
04816  |'            Else                                 ||04813  |'            Else                                 
04817  |'                  Call sbGetRoundValue(dblValueIn||04814  |'                  Call sbGetRoundValue(dblValueIn
04818  |'            End If                               ||04815  |'            End If                               
04819  |'            dstrAvgNav = dblValueOut             ||04816  |'            dstrAvgNav = dblValueOut             
04820  |''2005/03/09 End                                  ||04817  |''2005/03/09 End                                  
04821  |''2005/03/15 Start                                ||04818  |''2005/03/15 Start                                
04822  |'            AvgNav = dstrAvgNav                  ||04819  |'            AvgNav = dstrAvgNav                  
04823  |''2005/03/15 End                                  ||04820  |''2005/03/15 End                                  
04824  |'                                                 ||04821  |'                                                 
04825  |''2005/01/18 Start                                ||04822  |''2005/01/18 Start                                
04826  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    ||04823  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    
04827  |'            Call gblnDyClose                     ||04824  |'            Call gblnDyClose                     
04828  |''2005/01/18 End                                  ||04825  |''2005/01/18 End                                  
04829  |''2005/01/12 Start                                ||04826  |''2005/01/12 Start                                
04830  |''            '対象締日データ抽出                 ||04827  |''            '対象締日データ抽出                 
04831  |''            .Cells(20, 37).NumberFormatLocal = "||04828  |''            .Cells(20, 37).NumberFormatLocal = "
04832  |'''2005/01/11 Start                               ||04829  |'''2005/01/11 Start                               
04833  |'''            .Cells(20, 37).Value = CStr(Format(||04830  |'''            .Cells(20, 37).Value = CStr(Format(
04834  |''            .Cells(20, 37).Value = CStr(Format(d||04831  |''            .Cells(20, 37).Value = CStr(Format(d
04835  |'''2005/01/11 End                                 ||04832  |'''2005/01/11 End                                 
04836  |''            .Cells(20, 37).HorizontalAlignment =||04833  |''            .Cells(20, 37).HorizontalAlignment =
04837  |''            '合計(月末純資産)                   ||04834  |''            '合計(月末純資産)                   
04838  |''            .Cells(33, 37).NumberFormatLocal = "||04835  |''            .Cells(33, 37).NumberFormatLocal = "
04839  |'''2005/01/11 Start                               ||04836  |'''2005/01/11 Start                               
04840  |'''            .Cells(33, 37).Value = CStr(Format(||04837  |'''            .Cells(33, 37).Value = CStr(Format(
04841  |''            .Cells(33, 37).Value = CStr(Format(d||04838  |''            .Cells(33, 37).Value = CStr(Format(d
04842  |'''2005/01/11 End                                 ||04839  |'''2005/01/11 End                                 
04843  |''            .Cells(33, 37).HorizontalAlignment =||04840  |''            .Cells(33, 37).HorizontalAlignment =
04844  |'            '対象締日データ抽出                  ||04841  |'            '対象締日データ抽出                  
04845  |''            .Cells(20, 37).NumberFormatLocal = "||04842  |''            .Cells(20, 37).NumberFormatLocal = "
04846  |''2005/03/09 Start                                ||04843  |''2005/03/09 Start                                
04847  |''            .Cells(20, 39).NumberFormatLocal = "||04844  |''            .Cells(20, 39).NumberFormatLocal = "
04848  |''2005/03/09 End                                  ||04845  |''2005/03/09 End                                  
04849  |''2005/01/11 Start                                ||04846  |''2005/01/11 Start                                
04850  |''            .Cells(20, 37).Value = CStr(Format(d||04847  |''            .Cells(20, 37).Value = CStr(Format(d
04851  |''            .Cells(20, 37).Value = CStr(Format(d||04848  |''            .Cells(20, 37).Value = CStr(Format(d
04852  |''2005/01/20 Start                                ||04849  |''2005/01/20 Start                                
04853  |''            .Cells(20, 39).Value = CStr(Format(d||04850  |''            .Cells(20, 39).Value = CStr(Format(d
04854  |''2005/03/09 Start                                ||04851  |''2005/03/09 Start                                
04855  |''            If gbuMGetUPDRec.N(lRecIdx).MGET_bas||04852  |''            If gbuMGetUPDRec.N(lRecIdx).MGET_bas
04856  |''                .Cells(20, 39).Value = CStr(Form||04853  |''                .Cells(20, 39).Value = CStr(Form
04857  |''            Else                                ||04854  |''            Else                                
04858  |''                .Cells(20, 39).Value = CStr(Form||04855  |''                .Cells(20, 39).Value = CStr(Form
04859  |''            End If                              ||04856  |''            End If                              
04860  |''2005/03/09 End                                  ||04857  |''2005/03/09 End                                  
04861  |''2005/01/20 End                                  ||04858  |''2005/01/20 End                                  
04862  |''2005/01/11 End                                  ||04859  |''2005/01/11 End                                  
04863  |''            .Cells(20, 37).HorizontalAlignment =||04860  |''            .Cells(20, 37).HorizontalAlignment =
04864  |''2005/03/09 Start                                ||04861  |''2005/03/09 Start                                
04865  |''            .Cells(20, 39).HorizontalAlignment =||04862  |''            .Cells(20, 39).HorizontalAlignment =
04866  |''2005/03/09 End                                  ||04863  |''2005/03/09 End                                  
04867  |'            '合計(月末純資産)                    ||04864  |'            '合計(月末純資産)                    
04868  |''            .Cells(33, 37).NumberFormatLocal = "||04865  |''            .Cells(33, 37).NumberFormatLocal = "
04869  |''2005/03/09 Start                                ||04866  |''2005/03/09 Start                                
04870  |''            .Cells(33, 39).NumberFormatLocal = "||04867  |''            .Cells(33, 39).NumberFormatLocal = "
04871  |''2005/03/09 End                                  ||04868  |''2005/03/09 End                                  
04872  |''2005/03/09 Start                                ||04869  |''2005/03/09 Start                                
04873  |'            .Cells(17, 23).NumberFormatLocal = "@||04870  |'            .Cells(17, 23).NumberFormatLocal = "@
04874  |''2005/03/09 End                                  ||04871  |''2005/03/09 End                                  
04875  |''2005/01/11 Start                                ||04872  |''2005/01/11 Start                                
04876  |''            .Cells(33, 37).Value = CStr(Format(d||04873  |''            .Cells(33, 37).Value = CStr(Format(d
04877  |''            .Cells(33, 37).Value = CStr(Format(d||04874  |''            .Cells(33, 37).Value = CStr(Format(d
04878  |''2005/01/20 Start                                ||04875  |''2005/01/20 Start                                
04879  |''            .Cells(20, 39).Value = CStr(Format(d||04876  |''            .Cells(20, 39).Value = CStr(Format(d
04880  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base||04877  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base
04881  |''2005/03/09 Start                                ||04878  |''2005/03/09 Start                                
04882  |''                .Cells(33, 39).Value = CStr(Form||04879  |''                .Cells(33, 39).Value = CStr(Form
04883  |''2005/03/09 End                                  ||04880  |''2005/03/09 End                                  
04884  |''2005/03/15 Start                                ||04881  |''2005/03/15 Start                                
04885  |'''2005/03/09 Start                               ||04882  |'''2005/03/09 Start                               
04886  |''                .Cells(17, 23).Value = CStr(Form||04883  |''                .Cells(17, 23).Value = CStr(Form
04887  |'''2005/03/09 End                                 ||04884  |'''2005/03/09 End                                 
04888  |'                .Cells(17, 23).Value = CStr(Forma||04885  |'                .Cells(17, 23).Value = CStr(Forma
04889  |''2005/03/15 End                                  ||04886  |''2005/03/15 End                                  
04890  |'            Else                                 ||04887  |'            Else                                 
04891  |''2005/03/09 Start                                ||04888  |''2005/03/09 Start                                
04892  |''                .Cells(33, 39).Value = CStr(Form||04889  |''                .Cells(33, 39).Value = CStr(Form
04893  |''2005/03/09 End                                  ||04890  |''2005/03/09 End                                  
04894  |''2005/03/15 Start                                ||04891  |''2005/03/15 Start                                
04895  |'''2005/03/09 Start                               ||04892  |'''2005/03/09 Start                               
04896  |''                .Cells(17, 23).Value = CStr(Form||04893  |''                .Cells(17, 23).Value = CStr(Form
04897  |'''2005/03/09 End                                 ||04894  |'''2005/03/09 End                                 
04898  |'                .Cells(17, 23).Value = CStr(Forma||04895  |'                .Cells(17, 23).Value = CStr(Forma
04899  |''2005/03/15 End                                  ||04896  |''2005/03/15 End                                  
04900  |'            End If                               ||04897  |'            End If                               
04901  |''2005/01/20 End                                  ||04898  |''2005/01/20 End                                  
04902  |''2005/01/11 End                                  ||04899  |''2005/01/11 End                                  
04903  |''            .Cells(33, 37).HorizontalAlignment =||04900  |''            .Cells(33, 37).HorizontalAlignment =
04904  |''2005/03/09 Start                                ||04901  |''2005/03/09 Start                                
04905  |''            .Cells(33, 39).HorizontalAlignment =||04902  |''            .Cells(33, 39).HorizontalAlignment =
04906  |''2005/03/09 End                                  ||04903  |''2005/03/09 End                                  
04907  |''2005/03/09 Start                                ||04904  |''2005/03/09 Start                                
04908  |'            .Cells(17, 23).HorizontalAlignment = ||04905  |'            .Cells(17, 23).HorizontalAlignment = 
04909  |''2005/03/09 End                                  ||04906  |''2005/03/09 End                                  
04910  |''2005/03/15 Start                                ||04907  |''2005/03/15 Start                                
04911  |'            '平均純資産総額                      ||04908  |'            '平均純資産総額                      
04912  |'            .Cells(36, 2).Value = sWord51        ||04909  |'            .Cells(36, 2).Value = sWord51        
04913  |'            .Cells(36, 11).Value = sWord19       ||04910  |'            .Cells(36, 11).Value = sWord19       
04914  |'            '計算期間の純資産総額の合計(月末純資 ||04911  |'            '計算期間の純資産総額の合計(月末純資 
04915  |'            .Cells(36, 23).NumberFormatLocal = "@||04912  |'            .Cells(36, 23).NumberFormatLocal = "@
04916  |'              If gbuMGetUPDRec.N(lRecIdx).MGET_ba||04913  |'              If gbuMGetUPDRec.N(lRecIdx).MGET_ba
04917  |'                  .Cells(36, 23).Value = CStr(For||04914  |'                  .Cells(36, 23).Value = CStr(For
04918  |'              Else                               ||04915  |'              Else                               
04919  |'                  .Cells(36, 23).Value = CStr(For||04916  |'                  .Cells(36, 23).Value = CStr(For
04920  |'              End If                             ||04917  |'              End If                             
04921  |'            .Cells(36, 23).HorizontalAlignment = ||04918  |'            .Cells(36, 23).HorizontalAlignment = 
04922  |'            '÷??＝                              ||04919  |'            '÷??＝                              
04923  |'            .Cells(36, 26).Value = sWord18 & "   ||04920  |'            .Cells(36, 26).Value = sWord18 & "   
04924  |'            '計算期間の純資産総額の合計÷計算期間||04921  |'            '計算期間の純資産総額の合計÷計算期間
04925  |'            .Cells(36, 35).NumberFormatLocal = "@||04922  |'            .Cells(36, 35).NumberFormatLocal = "@
04926  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base||04923  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base
04927  |'                .Cells(36, 35).Value = CStr(Forma||04924  |'                .Cells(36, 35).Value = CStr(Forma
04928  |'            Else                                 ||04925  |'            Else                                 
04929  |'                .Cells(36, 35).Value = CStr(Forma||04926  |'                .Cells(36, 35).Value = CStr(Forma
04930  |'            End If                               ||04927  |'            End If                               
04931  |''2005/03/15 End                                  ||04928  |''2005/03/15 End                                  
04932  |''2005/01/12 End                                  ||04929  |''2005/01/12 End                                  
04933  |''2005/01/17 Start                                ||04930  |''2005/01/17 Start                                
04934  |'            ddblExchangeRate = 0                 ||04931  |'            ddblExchangeRate = 0                 
04935  |''2005/01/17 End                                  ||04932  |''2005/01/17 End                                  
04936  |'            '投資顧問料計算用計算対象NAVに日次平 ||04933  |'            '投資顧問料計算用計算対象NAVに日次平 
04937  |'            If dstrAvgNav = "" Then              ||04934  |'            If dstrAvgNav = "" Then              
04938  |'                lCalcNav = 0                     ||04935  |'                lCalcNav = 0                     
04939  |'            Else                                 ||04936  |'            Else                                 
04940  |''2004/11/17 Start                                ||04937  |''2004/11/17 Start                                
04941  |''                lCalcNav = Format(Round(gvlnDyDa||04938  |''                lCalcNav = Format(Round(gvlnDyDa
04942  |'                dblValueIn = CDbl(dstrAvgNav)    ||04939  |'                dblValueIn = CDbl(dstrAvgNav)    
04943  |''2005/01/11 Start                                ||04940  |''2005/01/11 Start                                
04944  |'                '@@@@@ NAV通貨から閾値通貨に換算 ||04941  |'                '@@@@@ NAV通貨から閾値通貨に換算 
04945  |'                Select Case gbuMGetUPDRec.N(lRecI||04942  |'                Select Case gbuMGetUPDRec.N(lRecI
04946  |'                  Case "1"    '固定料率          ||04943  |'                  Case "1"    '固定料率          
04947  |''2005/01/20 Start                                ||04944  |''2005/01/20 Start                                
04948  |''                      'NAV通貨と外部委託顧問料通||04945  |''                      'NAV通貨と外部委託顧問料通
04949  |''                      If gbuMGetUPDRec.N(lRecIdx||04946  |''                      If gbuMGetUPDRec.N(lRecIdx
04950  |''                          '外部委託顧問料通貨が ||04947  |''                          '外部委託顧問料通貨が 
04951  |''                          If gbuMGetUPDRec.N(lRe||04948  |''                          If gbuMGetUPDRec.N(lRe
04952  |''                          End If                ||04949  |''                          End If                
04953  |''                      End If                    ||04950  |''                      End If                    
04954  |''                      'NAV通貨と外部委託顧問料通||04951  |''                      'NAV通貨と外部委託顧問料通
04955  |''                      If gbuMGetUPDRec.N(lRecIdx||04952  |''                      If gbuMGetUPDRec.N(lRecIdx
04956  |''                          '外部委託顧問料通貨が ||04953  |''                          '外部委託顧問料通貨が 
04957  |''                          If gbuMGetUPDRec.N(lRe||04954  |''                          If gbuMGetUPDRec.N(lRe
04958  |''                          End If                ||04955  |''                          End If                
04959  |''                      End If                    ||04956  |''                      End If                    
04960  |'                    If gbuMGetUPDRec.N(lRecIdx).M||04957  |'                    If gbuMGetUPDRec.N(lRecIdx).M
04961  |'                        'NAV通貨→JPYの為替レート||04958  |'                        'NAV通貨→JPYの為替レート
04962  |'                        dstrCurrencyCode = gbuMGe||04959  |'                        dstrCurrencyCode = gbuMGe
04963  |'                        ddblExchangeRate = fnstrE||04960  |'                        ddblExchangeRate = fnstrE
04964  |'                        If ddblExchangeRate = 0 T||04961  |'                        If ddblExchangeRate = 0 T
04965  |'                          intRtn = MsgBox("ＴＴＭ||04962  |'                          intRtn = MsgBox("ＴＴＭ
04966  |'                          vbLf & "対象通貨コード ||04963  |'                          vbLf & "対象通貨コード 
04967  |'                          vbLf & "基準日 ： [ " &||04964  |'                          vbLf & "基準日 ： [ " &
04968  |'                              vbCritical, "ＴＴＭ||04965  |'                              vbCritical, "ＴＴＭ
04969  |'                          Exit Function          ||04966  |'                          Exit Function          
04970  |'                        End If                   ||04967  |'                        End If                   
04971  |'                        'NAV通貨→JPYへレート換算||04968  |'                        'NAV通貨→JPYへレート換算
04972  |'                        dblValueIn = dblValueIn *||04969  |'                        dblValueIn = dblValueIn *
04973  |'                    End If                       ||04970  |'                    End If                       
04974  |''2005/01/20 End                                  ||04971  |''2005/01/20 End                                  
04975  |'                  Case "2"    '段階料率          ||04972  |'                  Case "2"    '段階料率          
04976  |''2005/01/26 Start                                ||04973  |''2005/01/26 Start                                
04977  |''''''                      'NAV通貨と閾値通貨が相||04974  |''''''                      'NAV通貨と閾値通貨が相
04978  |''''''                      If gbuMGetUPDRec.N(lRe||04975  |''''''                      If gbuMGetUPDRec.N(lRe
04979  |''''''                          '閾値通貨と外部委 ||04976  |''''''                          '閾値通貨と外部委 
04980  |''''''                          If gbuMGetUPDRec.N||04977  |''''''                          If gbuMGetUPDRec.N
04981  |''''''                              '外部委託顧問 ||04978  |''''''                              '外部委託顧問 
04982  |''''''                              If gbuMGetUPDR||04979  |''''''                              If gbuMGetUPDR
04983  |'''''''2005/01/17 Start                           ||04980  |'''''''2005/01/17 Start                           
04984  |'''''''                                  dblValueI||04981  |'''''''                                  dblValueI
04985  |''''''                                  'NAV通貨→||04982  |''''''                                  'NAV通貨→
04986  |''''''                                  dstrCurren||04983  |''''''                                  dstrCurren
04987  |''''''                                  ddblExchan||04984  |''''''                                  ddblExchan
04988  |''''''                                  If ddblExc||04985  |''''''                                  If ddblExc
04989  |''''''                                    intRtn =||04986  |''''''                                    intRtn =
04990  |''''''                                    vbLf & "||04987  |''''''                                    vbLf & "
04991  |''''''                                    vbLf & "||04988  |''''''                                    vbLf & "
04992  |''''''                                        vbCr||04989  |''''''                                        vbCr
04993  |''''''                                    Exit Fun||04990  |''''''                                    Exit Fun
04994  |''''''                                  End If    ||04991  |''''''                                  End If    
04995  |''''''                                  'NAV通貨→||04992  |''''''                                  'NAV通貨→
04996  |''''''                                  dblValueIn||04993  |''''''                                  dblValueIn
04997  |''''''                                  '閾値通貨 ||04994  |''''''                                  '閾値通貨 
04998  |''''''                                  dstrCurren||04995  |''''''                                  dstrCurren
04999  |''''''                                  ddblExchan||04996  |''''''                                  ddblExchan
05000  |''''''                                  If ddblExc||04997  |''''''                                  If ddblExc
05001  |''''''                                    intRtn =||04998  |''''''                                    intRtn =
05002  |''''''                                    vbLf & "||04999  |''''''                                    vbLf & "
05003  |''''''                                    vbLf & "||05000  |''''''                                    vbLf & "
05004  |''''''                                        vbCr||05001  |''''''                                        vbCr
05005  |''''''                                    Exit Fun||05002  |''''''                                    Exit Fun
05006  |''''''                                  End If    ||05003  |''''''                                  End If    
05007  |''''''                                  'JPY→閾値||05004  |''''''                                  'JPY→閾値
05008  |''''''                                  dblValueIn||05005  |''''''                                  dblValueIn
05009  |'''''''2005/01/17 End                             ||05006  |'''''''2005/01/17 End                             
05010  |''''''                              End If        ||05007  |''''''                              End If        
05011  |''''''                          End If            ||05008  |''''''                          End If            
05012  |''''''                      End If                ||05009  |''''''                      End If                
05013  |''''''                      'NAV通貨と閾値通貨が相||05010  |''''''                      'NAV通貨と閾値通貨が相
05014  |''''''                      If gbuMGetUPDRec.N(lRe||05011  |''''''                      If gbuMGetUPDRec.N(lRe
05015  |''''''                          '閾値通貨と外部委 ||05012  |''''''                          '閾値通貨と外部委 
05016  |''''''                          If gbuMGetUPDRec.N||05013  |''''''                          If gbuMGetUPDRec.N
05017  |''''''                              '外部委託顧問 ||05014  |''''''                              '外部委託顧問 
05018  |''''''                              If gbuMGetUPDR||05015  |''''''                              If gbuMGetUPDR
05019  |'''''''2005/01/17 Start                           ||05016  |'''''''2005/01/17 Start                           
05020  |'''''''                                  dblValueI||05017  |'''''''                                  dblValueI
05021  |''''''                                  'NAV通貨→||05018  |''''''                                  'NAV通貨→
05022  |''''''                                  dstrCurren||05019  |''''''                                  dstrCurren
05023  |''''''                                  ddblExchan||05020  |''''''                                  ddblExchan
05024  |''''''                                  If ddblExc||05021  |''''''                                  If ddblExc
05025  |''''''                                    intRtn =||05022  |''''''                                    intRtn =
05026  |''''''                                    vbLf & "||05023  |''''''                                    vbLf & "
05027  |''''''                                    vbLf & "||05024  |''''''                                    vbLf & "
05028  |''''''                                        vbCr||05025  |''''''                                        vbCr
05029  |''''''                                    Exit Fun||05026  |''''''                                    Exit Fun
05030  |''''''                                  End If    ||05027  |''''''                                  End If    
05031  |''''''                                  'NAV通貨→||05028  |''''''                                  'NAV通貨→
05032  |''''''                                  dblValueIn||05029  |''''''                                  dblValueIn
05033  |''''''                                  '閾値通貨 ||05030  |''''''                                  '閾値通貨 
05034  |''''''                                  dstrCurren||05031  |''''''                                  dstrCurren
05035  |''''''                                  ddblExchan||05032  |''''''                                  ddblExchan
05036  |''''''                                  If ddblExc||05033  |''''''                                  If ddblExc
05037  |''''''                                    intRtn =||05034  |''''''                                    intRtn =
05038  |''''''                                    vbLf & "||05035  |''''''                                    vbLf & "
05039  |''''''                                    vbLf & "||05036  |''''''                                    vbLf & "
05040  |''''''                                        vbCr||05037  |''''''                                        vbCr
05041  |''''''                                    Exit Fun||05038  |''''''                                    Exit Fun
05042  |''''''                                  End If    ||05039  |''''''                                  End If    
05043  |''''''                                  'JPY→閾値||05040  |''''''                                  'JPY→閾値
05044  |''''''                                  dblValueIn||05041  |''''''                                  dblValueIn
05045  |'''''''2005/01/17 End                             ||05042  |'''''''2005/01/17 End                             
05046  |''''''                              End If        ||05043  |''''''                              End If        
05047  |''''''                          End If            ||05044  |''''''                          End If            
05048  |''''''                      End If                ||05045  |''''''                      End If                
05049  |'                    If gbuMGetUPDRec.N(lRecIdx).M||05046  |'                    If gbuMGetUPDRec.N(lRecIdx).M
05050  |'                        If gbuMGetUPDRec.N(lRecId||05047  |'                        If gbuMGetUPDRec.N(lRecId
05051  |'                        Else                     ||05048  |'                        Else                     
05052  |'                            '閾値通貨→JPYの為替 ||05049  |'                            '閾値通貨→JPYの為替 
05053  |'                            dstrCurrencyCode = gb||05050  |'                            dstrCurrencyCode = gb
05054  |'                            ddblExchangeRate = fn||05051  |'                            ddblExchangeRate = fn
05055  |'                            If ddblExchangeRate =||05052  |'                            If ddblExchangeRate =
05056  |'                              intRtn = MsgBox("Ｔ||05053  |'                              intRtn = MsgBox("Ｔ
05057  |'                              vbLf & "対象通貨コ ||05054  |'                              vbLf & "対象通貨コ 
05058  |'                              vbLf & "基準日 ： [||05055  |'                              vbLf & "基準日 ： [
05059  |'                                  vbCritical, "Ｔ||05056  |'                                  vbCritical, "Ｔ
05060  |'                              Exit Function      ||05057  |'                              Exit Function      
05061  |'                            End If               ||05058  |'                            End If               
05062  |'                            'JPY→閾値通貨へレー ||05059  |'                            'JPY→閾値通貨へレー 
05063  |'                            dblValueIn = dblValue||05060  |'                            dblValueIn = dblValue
05064  |'                        End If                   ||05061  |'                        End If                   
05065  |'                    Else                         ||05062  |'                    Else                         
05066  |'                        'NAV通貨→JPYの為替レート||05063  |'                        'NAV通貨→JPYの為替レート
05067  |'                        dstrCurrencyCode = gbuMGe||05064  |'                        dstrCurrencyCode = gbuMGe
05068  |'                        ddblExchangeRate = fnstrE||05065  |'                        ddblExchangeRate = fnstrE
05069  |'                        If ddblExchangeRate = 0 T||05066  |'                        If ddblExchangeRate = 0 T
05070  |'                          intRtn = MsgBox("ＴＴＭ||05067  |'                          intRtn = MsgBox("ＴＴＭ
05071  |'                          vbLf & "対象通貨コード ||05068  |'                          vbLf & "対象通貨コード 
05072  |'                          vbLf & "基準日 ： [ " &||05069  |'                          vbLf & "基準日 ： [ " &
05073  |'                              vbCritical, "ＴＴＭ||05070  |'                              vbCritical, "ＴＴＭ
05074  |'                          Exit Function          ||05071  |'                          Exit Function          
05075  |'                        End If                   ||05072  |'                        End If                   
05076  |'                        'NAV通貨→JPYへレート換算||05073  |'                        'NAV通貨→JPYへレート換算
05077  |'                        dblValueIn = dblValueIn *||05074  |'                        dblValueIn = dblValueIn *
05078  |'                        If gbuMGetUPDRec.N(lRecId||05075  |'                        If gbuMGetUPDRec.N(lRecId
05079  |'                        Else                     ||05076  |'                        Else                     
05080  |'                            '閾値通貨→JPYの為替 ||05077  |'                            '閾値通貨→JPYの為替 
05081  |'                            dstrCurrencyCode = gb||05078  |'                            dstrCurrencyCode = gb
05082  |'                            ddblExchangeRate = fn||05079  |'                            ddblExchangeRate = fn
05083  |'                            If ddblExchangeRate =||05080  |'                            If ddblExchangeRate =
05084  |'                              intRtn = MsgBox("Ｔ||05081  |'                              intRtn = MsgBox("Ｔ
05085  |'                              vbLf & "対象通貨コ ||05082  |'                              vbLf & "対象通貨コ 
05086  |'                              vbLf & "基準日 ： [||05083  |'                              vbLf & "基準日 ： [
05087  |'                                  vbCritical, "Ｔ||05084  |'                                  vbCritical, "Ｔ
05088  |'                              Exit Function      ||05085  |'                              Exit Function      
05089  |'                            End If               ||05086  |'                            End If               
05090  |'                            'JPY→閾値通貨へ逆レ ||05087  |'                            'JPY→閾値通貨へ逆レ 
05091  |'                            dblValueIn = dblValue||05088  |'                            dblValueIn = dblValue
05092  |'                        End If                   ||05089  |'                        End If                   
05093  |'                    End If                       ||05090  |'                    End If                       
05094  |''2005/01/26 End                                  ||05091  |''2005/01/26 End                                  
05095  |'                End Select                       ||05092  |'                End Select                       
05096  |'                '@@@@@ NAV通貨から閾値通貨に換算 ||05093  |'                '@@@@@ NAV通貨から閾値通貨に換算 
05097  |''2005/01/11 End                                  ||05094  |''2005/01/11 End                                  
05098  |''2005/01/13 Start                                ||05095  |''2005/01/13 Start                                
05099  |''                Call sbGetRoundValue(dblValueIn)||05096  |''                Call sbGetRoundValue(dblValueIn)
05100  |'                Call sbGetRoundValue2(dblValueIn)||05097  |'                Call sbGetRoundValue2(dblValueIn)
05101  |''2005/01/13 End                                  ||05098  |''2005/01/13 End                                  
05102  |''2005/01/11 Start                                ||05099  |''2005/01/11 Start                                
05103  |''                lCalcNav = CStr(Format(dblValueO||05100  |''                lCalcNav = CStr(Format(dblValueO
05104  |''閾値レート換算後平均NAV(計算対象NAV)            ||05101  |''閾値レート換算後平均NAV(計算対象NAV)            
05105  |'                lCalcNav = CStr(Format(dblValueOu||05102  |'                lCalcNav = CStr(Format(dblValueOu
05106  |''2005/01/11 End                                  ||05103  |''2005/01/11 End                                  
05107  |''2004/11/17 End                                  ||05104  |''2004/11/17 End                                  
05108  |'            End If                               ||05105  |'            End If                               
05109  |''''''            '@@@@@※ここではなく顧問料に換算||05106  |''''''            '@@@@@※ここではなく顧問料に換算
05110  |''''''            If Len(gbuMGetUPDRec.N(lRecIdx).||05107  |''''''            If Len(gbuMGetUPDRec.N(lRecIdx).
05111  |''''''                If lCalcNav < CDbl(gbuMGetUP||05108  |''''''                If lCalcNav < CDbl(gbuMGetUP
05112  |''''''                    lCalcNav = CDbl(gbuMGetU||05109  |''''''                    lCalcNav = CDbl(gbuMGetU
05113  |''''''                End If                      ||05110  |''''''                End If                      
05114  |''''''            End If                          ||05111  |''''''            End If                          
05115  |''''''            If Len(gbuMGetUPDRec.N(lRecIdx).||05112  |''''''            If Len(gbuMGetUPDRec.N(lRecIdx).
05116  |''''''                If lCalcNav > CDbl(gbuMGetUP||05113  |''''''                If lCalcNav > CDbl(gbuMGetUP
05117  |''''''                    lCalcNav = CDbl(gbuMGetU||05114  |''''''                    lCalcNav = CDbl(gbuMGetU
05118  |''''''                End If                      ||05115  |''''''                End If                      
05119  |''''''            End If                          ||05116  |''''''            End If                          
05120  |''2005/01/06 End                                  ||05117  |''2005/01/06 End                                  
05121  |''2005/01/18 Start                                ||05118  |''2005/01/18 Start                                
05122  |''            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                   ||05119  |''            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                   
05123  |''            Call gblnDyClose                    ||05120  |''            Call gblnDyClose                    
05124  |''2005/01/18 End                                  ||05121  |''2005/01/18 End                                  
05125  |'                                                 ||05122  |'                                                 
05126  |'On Error Resume Next                             ||05123  |'On Error Resume Next                             
05127  |'        End If                                   ||05124  |'        End If                                   
05128  |'                                                 ||05125  |'                                                 
05129  |'    '投資顧問料                                  ||05126  |'    '投資顧問料                                  
05130  |'        Dim dRitsu As Double    '外部委託顧問料率||05127  |'        Dim dRitsu As Double    '外部委託顧問料率
05131  |'        dRitsu = 0                               ||05128  |'        dRitsu = 0                               
05132  |'        TotalRate = 0                            ||05129  |'        TotalRate = 0                            
05133  |''2005/01/17 Start                                ||05130  |''2005/01/17 Start                                
05134  |'        ddblExchangeRate = 0                     ||05131  |'        ddblExchangeRate = 0                     
05135  |''2005/01/17 End                                  ||05132  |''2005/01/17 End                                  
05136  |'        '計算対象NAVを変数にセット               ||05133  |'        '計算対象NAVを変数にセット               
05137  |''2005/03/09 Start                                ||05134  |''2005/03/09 Start                                
05138  |''        '契約区分：外部委託顧問料計算または業務 ||05135  |''        '契約区分：外部委託顧問料計算または業務 
05139  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_contrac||05136  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_contrac
05140  |''2005/03/09 End                                  ||05137  |''2005/03/09 End                                  
05141  |'            lCalcNav = 0                         ||05138  |'            lCalcNav = 0                         
05142  |''2004/11/17 Start                                ||05139  |''2004/11/17 Start                                
05143  |''            lCalcNav = Format(Round(TotalNav / i||05140  |''            lCalcNav = Format(Round(TotalNav / i
05144  |'            dblValueIn = TotalNav / iRowCnt      ||05141  |'            dblValueIn = TotalNav / iRowCnt      
05145  |''2005/01/12 Start                                ||05142  |''2005/01/12 Start                                
05146  |'            '@@@@@ NAV通貨から閾値通貨に換算 @@@@||05143  |'            '@@@@@ NAV通貨から閾値通貨に換算 @@@@
05147  |'            Select Case gbuMGetUPDRec.N(lRecIdx).||05144  |'            Select Case gbuMGetUPDRec.N(lRecIdx).
05148  |'              Case "1"    '固定料率(固定料率の場 ||05145  |'              Case "1"    '固定料率(固定料率の場 
05149  |'                  'NAV通貨と外部委託顧問料通貨が ||05146  |'                  'NAV通貨と外部委託顧問料通貨が 
05150  |''2005/01/20 Start                                ||05147  |''2005/01/20 Start                                
05151  |''                  If gbuMGetUPDRec.N(lRecIdx).MG||05148  |''                  If gbuMGetUPDRec.N(lRecIdx).MG
05152  |''                      '外部委託顧問料通貨が円以 ||05149  |''                      '外部委託顧問料通貨が円以 
05153  |''                      If gbuMGetUPDRec.N(lRecIdx||05150  |''                      If gbuMGetUPDRec.N(lRecIdx
05154  |''                      End If                    ||05151  |''                      End If                    
05155  |''                  End If                        ||05152  |''                  End If                        
05156  |''                  'NAV通貨と外部委託顧問料通貨が||05153  |''                  'NAV通貨と外部委託顧問料通貨が
05157  |''                  If gbuMGetUPDRec.N(lRecIdx).MG||05154  |''                  If gbuMGetUPDRec.N(lRecIdx).MG
05158  |''                      '外部委託顧問料通貨が円   ||05155  |''                      '外部委託顧問料通貨が円   
05159  |''                      If gbuMGetUPDRec.N(lRecIdx||05156  |''                      If gbuMGetUPDRec.N(lRecIdx
05160  |''                      End If                    ||05157  |''                      End If                    
05161  |''                  End If                        ||05158  |''                  End If                        
05162  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||05159  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
05163  |'                    'NAV通貨→JPYの為替レートを取||05160  |'                    'NAV通貨→JPYの為替レートを取
05164  |'                    dstrCurrencyCode = gbuMGetUPD||05161  |'                    dstrCurrencyCode = gbuMGetUPD
05165  |'                    ddblExchangeRate = fnstrExcha||05162  |'                    ddblExchangeRate = fnstrExcha
05166  |'                    If ddblExchangeRate = 0 Then ||05163  |'                    If ddblExchangeRate = 0 Then 
05167  |'                      intRtn = MsgBox("ＴＴＭが取||05164  |'                      intRtn = MsgBox("ＴＴＭが取
05168  |'                      vbLf & "対象通貨コード ： [||05165  |'                      vbLf & "対象通貨コード ： [
05169  |'                      vbLf & "基準日 ： [ " & Mid||05166  |'                      vbLf & "基準日 ： [ " & Mid
05170  |'                          vbCritical, "ＴＴＭ取得||05167  |'                          vbCritical, "ＴＴＭ取得
05171  |'                      Exit Function              ||05168  |'                      Exit Function              
05172  |'                    End If                       ||05169  |'                    End If                       
05173  |'                    'NAV通貨→JPYへレート換算    ||05170  |'                    'NAV通貨→JPYへレート換算    
05174  |'                    dblValueIn = dblValueIn * ddb||05171  |'                    dblValueIn = dblValueIn * ddb
05175  |'                End If                           ||05172  |'                End If                           
05176  |''2005/01/20 End                                  ||05173  |''2005/01/20 End                                  
05177  |'              Case "2"    '段階料率              ||05174  |'              Case "2"    '段階料率              
05178  |''2005/01/26 Start                                ||05175  |''2005/01/26 Start                                
05179  |'''''''2005/01/17 Start @@@@@@@@@@                ||05176  |'''''''2005/01/17 Start @@@@@@@@@@                
05180  |'''''''                    'NAV通貨→JPY→閾値通貨||05177  |'''''''                    'NAV通貨→JPY→閾値通貨
05181  |'''''''                    'NAV通貨→JPYの為替レー||05178  |'''''''                    'NAV通貨→JPYの為替レー
05182  |'''''''                    dstrDate = Replace(CStr||05179  |'''''''                    dstrDate = Replace(CStr
05183  |'''''''                    dstrCurrencyCode = gbuM||05180  |'''''''                    dstrCurrencyCode = gbuM
05184  |'''''''                    ddblExchangeRate = fnst||05181  |'''''''                    ddblExchangeRate = fnst
05185  |'''''''                    '閾値通貨→JPYの為替レ ||05182  |'''''''                    '閾値通貨→JPYの為替レ 
05186  |'''''''                    dstrDate = Replace(CStr||05183  |'''''''                    dstrDate = Replace(CStr
05187  |'''''''                    dstrCurrencyCode = gbuM||05184  |'''''''                    dstrCurrencyCode = gbuM
05188  |'''''''                    ddblExchangeRate = fnst||05185  |'''''''                    ddblExchangeRate = fnst
05189  |'''''''                                           ||05186  |'''''''                                           
05190  |'''''''                    sSql = ""              ||05187  |'''''''                    sSql = ""              
05191  |'''''''                    sSql = sSql & "SELECT  ||05188  |'''''''                    sSql = sSql & "SELECT  
05192  |'''''''                    sSql = sSql & "TBL_TTM1||05189  |'''''''                    sSql = sSql & "TBL_TTM1
05193  |'''''''                    sSql = sSql & "TBL_TTM1||05190  |'''''''                    sSql = sSql & "TBL_TTM1
05194  |'''''''                    sSql = sSql & "TBL_TTM1||05191  |'''''''                    sSql = sSql & "TBL_TTM1
05195  |'''''''                    sSql = sSql & "TBL_TTM1||05192  |'''''''                    sSql = sSql & "TBL_TTM1
05196  |'''''''                    sSql = sSql & "FROM (SE||05193  |'''''''                    sSql = sSql & "FROM (SE
05197  |'''''''                    sSql = sSql & "WK_TTM.c||05194  |'''''''                    sSql = sSql & "WK_TTM.c
05198  |'''''''                    sSql = sSql & "TO_CHAR(||05195  |'''''''                    sSql = sSql & "TO_CHAR(
05199  |'''''''                    sSql = sSql & "NVL(WK_T||05196  |'''''''                    sSql = sSql & "NVL(WK_T
05200  |'''''''                    sSql = sSql & "TO_CHAR(||05197  |'''''''                    sSql = sSql & "TO_CHAR(
05201  |'''''''                    sSql = sSql & "FROM cfr||05198  |'''''''                    sSql = sSql & "FROM cfr
05202  |'''''''                    sSql = sSql & "WHERE " ||05199  |'''''''                    sSql = sSql & "WHERE " 
05203  |'''''''                    sSql = sSql & "(WK_TTM.||05200  |'''''''                    sSql = sSql & "(WK_TTM.
05204  |'''''''                    sSql = sSql & "FROM cfr||05201  |'''''''                    sSql = sSql & "FROM cfr
05205  |'''''''                    sSql = sSql & "WHERE TT||05202  |'''''''                    sSql = sSql & "WHERE TT
05206  |'''''''                    sSql = sSql & "AND TTM1||05203  |'''''''                    sSql = sSql & "AND TTM1
05207  |'''''''                    sSql = sSql & dstrDate ||05204  |'''''''                    sSql = sSql & dstrDate 
05208  |'''''''                    sSql = sSql & "' "     ||05205  |'''''''                    sSql = sSql & "' "     
05209  |'''''''                    sSql = sSql & "GROUP BY||05206  |'''''''                    sSql = sSql & "GROUP BY
05210  |'''''''                    sSql = sSql & "AND WK_T||05207  |'''''''                    sSql = sSql & "AND WK_T
05211  |'''''''                    sSql = sSql & dstrCurre||05208  |'''''''                    sSql = sSql & dstrCurre
05212  |'''''''                    sSql = sSql & "') TBL_T||05209  |'''''''                    sSql = sSql & "') TBL_T
05213  |'''''''                    'ﾀﾞｲﾅｾｯﾄの作成         ||05210  |'''''''                    'ﾀﾞｲﾅｾｯﾄの作成         
05214  |'''''''                    If gintDyCreate(sSql) =||05211  |'''''''                    If gintDyCreate(sSql) =
05215  |'''''''                        Exit Function      ||05212  |'''''''                        Exit Function      
05216  |'''''''                    Else                   ||05213  |'''''''                    Else                   
05217  |'''''''                        dstrBsCCd(dintFor) ||05214  |'''''''                        dstrBsCCd(dintFor) 
05218  |'''''''                    End If                 ||05215  |'''''''                    End If                 
05219  |'''''''                    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理      ||05216  |'''''''                    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理      
05220  |'''''''                    Call gblnDyClose       ||05217  |'''''''                    Call gblnDyClose       
05221  |''''''                                            ||05218  |''''''                                            
05222  |''''''                  'JPY→閾値通貨のレートを取||05219  |''''''                  'JPY→閾値通貨のレートを取
05223  |'''''''2005/01/17 End                             ||05220  |'''''''2005/01/17 End                             
05224  |''''''                  'NAV通貨と閾値通貨が相違  ||05221  |''''''                  'NAV通貨と閾値通貨が相違  
05225  |''''''                  If gbuMGetUPDRec.N(lRecIdx||05222  |''''''                  If gbuMGetUPDRec.N(lRecIdx
05226  |''''''                      '閾値通貨と外部委託顧 ||05223  |''''''                      '閾値通貨と外部委託顧 
05227  |''''''                      If gbuMGetUPDRec.N(lRe||05224  |''''''                      If gbuMGetUPDRec.N(lRe
05228  |''''''                          '外部委託顧問料通 ||05225  |''''''                          '外部委託顧問料通 
05229  |''''''                          If gbuMGetUPDRec.N||05226  |''''''                          If gbuMGetUPDRec.N
05230  |'''''''2005/01/17 Start                           ||05227  |'''''''2005/01/17 Start                           
05231  |'''''''                              dblValueIn = ||05228  |'''''''                              dblValueIn = 
05232  |''''''                              'NAV通貨→JPY ||05229  |''''''                              'NAV通貨→JPY 
05233  |''''''                              dstrCurrencyCo||05230  |''''''                              dstrCurrencyCo
05234  |''''''                              ddblExchangeRa||05231  |''''''                              ddblExchangeRa
05235  |''''''                              If ddblExchang||05232  |''''''                              If ddblExchang
05236  |''''''                                intRtn = Msg||05233  |''''''                                intRtn = Msg
05237  |''''''                                vbLf & "対象||05234  |''''''                                vbLf & "対象
05238  |''''''                                vbLf & "基準||05235  |''''''                                vbLf & "基準
05239  |''''''                                    vbCritic||05236  |''''''                                    vbCritic
05240  |''''''                                Exit Functio||05237  |''''''                                Exit Functio
05241  |''''''                              End If        ||05238  |''''''                              End If        
05242  |''''''                              'NAV通貨→JPY ||05239  |''''''                              'NAV通貨→JPY 
05243  |'''''''2005/01/18 Start                           ||05240  |'''''''2005/01/18 Start                           
05244  |'''''''                              dblValueIn = ||05241  |'''''''                              dblValueIn = 
05245  |''''''                              dblValueIn = d||05242  |''''''                              dblValueIn = d
05246  |'''''''2005/01/18 End                             ||05243  |'''''''2005/01/18 End                             
05247  |''''''                              '閾値通貨→JPY||05244  |''''''                              '閾値通貨→JPY
05248  |''''''                              dstrCurrencyCo||05245  |''''''                              dstrCurrencyCo
05249  |''''''                              ddblExchangeRa||05246  |''''''                              ddblExchangeRa
05250  |''''''                              If ddblExchang||05247  |''''''                              If ddblExchang
05251  |''''''                                intRtn = Msg||05248  |''''''                                intRtn = Msg
05252  |''''''                                vbLf & "対象||05249  |''''''                                vbLf & "対象
05253  |''''''                                vbLf & "基準||05250  |''''''                                vbLf & "基準
05254  |''''''                                    vbCritic||05251  |''''''                                    vbCritic
05255  |''''''                                Exit Functio||05252  |''''''                                Exit Functio
05256  |''''''                              End If        ||05253  |''''''                              End If        
05257  |''''''                              'JPY→閾値通貨||05254  |''''''                              'JPY→閾値通貨
05258  |''''''                              dblValueIn = d||05255  |''''''                              dblValueIn = d
05259  |'''''''2005/01/17 End                             ||05256  |'''''''2005/01/17 End                             
05260  |''''''                          End If            ||05257  |''''''                          End If            
05261  |''''''                      End If                ||05258  |''''''                      End If                
05262  |''''''                  End If                    ||05259  |''''''                  End If                    
05263  |''''''                  'NAV通貨と閾値通貨が相違  ||05260  |''''''                  'NAV通貨と閾値通貨が相違  
05264  |''''''                  If gbuMGetUPDRec.N(lRecIdx||05261  |''''''                  If gbuMGetUPDRec.N(lRecIdx
05265  |''''''                      '閾値通貨と外部委託顧 ||05262  |''''''                      '閾値通貨と外部委託顧 
05266  |''''''                      If gbuMGetUPDRec.N(lRe||05263  |''''''                      If gbuMGetUPDRec.N(lRe
05267  |''''''                          '外部委託顧問料通 ||05264  |''''''                          '外部委託顧問料通 
05268  |''''''                          If gbuMGetUPDRec.N||05265  |''''''                          If gbuMGetUPDRec.N
05269  |'''''''2005/01/17 Start                           ||05266  |'''''''2005/01/17 Start                           
05270  |'''''''                              dblValueIn = ||05267  |'''''''                              dblValueIn = 
05271  |''''''                              'NAV通貨→JPY ||05268  |''''''                              'NAV通貨→JPY 
05272  |''''''                              dstrCurrencyCo||05269  |''''''                              dstrCurrencyCo
05273  |''''''                              ddblExchangeRa||05270  |''''''                              ddblExchangeRa
05274  |''''''                              If ddblExchang||05271  |''''''                              If ddblExchang
05275  |''''''                                intRtn = Msg||05272  |''''''                                intRtn = Msg
05276  |''''''                                vbLf & "対象||05273  |''''''                                vbLf & "対象
05277  |''''''                                vbLf & "基準||05274  |''''''                                vbLf & "基準
05278  |''''''                                    vbCritic||05275  |''''''                                    vbCritic
05279  |''''''                                Exit Functio||05276  |''''''                                Exit Functio
05280  |''''''                              End If        ||05277  |''''''                              End If        
05281  |''''''                              'NAV通貨→JPY ||05278  |''''''                              'NAV通貨→JPY 
05282  |'''''''2005/01/18 Start                           ||05279  |'''''''2005/01/18 Start                           
05283  |'''''''                              dblValueIn = ||05280  |'''''''                              dblValueIn = 
05284  |''''''                              dblValueIn = d||05281  |''''''                              dblValueIn = d
05285  |'''''''2005/01/18 End                             ||05282  |'''''''2005/01/18 End                             
05286  |''''''                              '閾値通貨→JPY||05283  |''''''                              '閾値通貨→JPY
05287  |''''''                              dstrCurrencyCo||05284  |''''''                              dstrCurrencyCo
05288  |''''''                              ddblExchangeRa||05285  |''''''                              ddblExchangeRa
05289  |''''''                              If ddblExchang||05286  |''''''                              If ddblExchang
05290  |''''''                                intRtn = Msg||05287  |''''''                                intRtn = Msg
05291  |''''''                                vbLf & "対象||05288  |''''''                                vbLf & "対象
05292  |''''''                                vbLf & "基準||05289  |''''''                                vbLf & "基準
05293  |''''''                                    vbCritic||05290  |''''''                                    vbCritic
05294  |''''''                                Exit Functio||05291  |''''''                                Exit Functio
05295  |''''''                              End If        ||05292  |''''''                              End If        
05296  |''''''                              'JPY→閾値通貨||05293  |''''''                              'JPY→閾値通貨
05297  |''''''                              dblValueIn = d||05294  |''''''                              dblValueIn = d
05298  |'''''''2005/01/17 End                             ||05295  |'''''''2005/01/17 End                             
05299  |''''''                          End If            ||05296  |''''''                          End If            
05300  |''''''                      End If                ||05297  |''''''                      End If                
05301  |''''''                  End If                    ||05298  |''''''                  End If                    
05302  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||05299  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
05303  |'                    If gbuMGetUPDRec.N(lRecIdx).M||05300  |'                    If gbuMGetUPDRec.N(lRecIdx).M
05304  |'                    Else                         ||05301  |'                    Else                         
05305  |'                        '閾値通貨→JPYの為替レー ||05302  |'                        '閾値通貨→JPYの為替レー 
05306  |'                        dstrCurrencyCode = gbuMGe||05303  |'                        dstrCurrencyCode = gbuMGe
05307  |'                        ddblExchangeRate = fnstrE||05304  |'                        ddblExchangeRate = fnstrE
05308  |'                        If ddblExchangeRate = 0 T||05305  |'                        If ddblExchangeRate = 0 T
05309  |'                          intRtn = MsgBox("ＴＴＭ||05306  |'                          intRtn = MsgBox("ＴＴＭ
05310  |'                          vbLf & "対象通貨コード ||05307  |'                          vbLf & "対象通貨コード 
05311  |'                          vbLf & "基準日 ： [ " &||05308  |'                          vbLf & "基準日 ： [ " &
05312  |'                              vbCritical, "ＴＴＭ||05309  |'                              vbCritical, "ＴＴＭ
05313  |'                          Exit Function          ||05310  |'                          Exit Function          
05314  |'                        End If                   ||05311  |'                        End If                   
05315  |'                        'JPY→閾値通貨へレート換 ||05312  |'                        'JPY→閾値通貨へレート換 
05316  |'                        dblValueIn = dblValueIn *||05313  |'                        dblValueIn = dblValueIn *
05317  |'                    End If                       ||05314  |'                    End If                       
05318  |'                Else                             ||05315  |'                Else                             
05319  |'                    'NAV通貨→JPYの為替レートを取||05316  |'                    'NAV通貨→JPYの為替レートを取
05320  |'                    dstrCurrencyCode = gbuMGetUPD||05317  |'                    dstrCurrencyCode = gbuMGetUPD
05321  |'                    ddblExchangeRate = fnstrExcha||05318  |'                    ddblExchangeRate = fnstrExcha
05322  |'                    If ddblExchangeRate = 0 Then ||05319  |'                    If ddblExchangeRate = 0 Then 
05323  |'                      intRtn = MsgBox("ＴＴＭが取||05320  |'                      intRtn = MsgBox("ＴＴＭが取
05324  |'                      vbLf & "対象通貨コード ： [||05321  |'                      vbLf & "対象通貨コード ： [
05325  |'                      vbLf & "基準日 ： [ " & Mid||05322  |'                      vbLf & "基準日 ： [ " & Mid
05326  |'                          vbCritical, "ＴＴＭ取得||05323  |'                          vbCritical, "ＴＴＭ取得
05327  |'                      Exit Function              ||05324  |'                      Exit Function              
05328  |'                    End If                       ||05325  |'                    End If                       
05329  |'                    'NAV通貨→JPYへレート換算    ||05326  |'                    'NAV通貨→JPYへレート換算    
05330  |'                    dblValueIn = dblValueIn * ddb||05327  |'                    dblValueIn = dblValueIn * ddb
05331  |'                    If gbuMGetUPDRec.N(lRecIdx).M||05328  |'                    If gbuMGetUPDRec.N(lRecIdx).M
05332  |'                    Else                         ||05329  |'                    Else                         
05333  |'                        '閾値通貨→JPYの為替レー ||05330  |'                        '閾値通貨→JPYの為替レー 
05334  |'                        dstrCurrencyCode = gbuMGe||05331  |'                        dstrCurrencyCode = gbuMGe
05335  |'                        ddblExchangeRate = fnstrE||05332  |'                        ddblExchangeRate = fnstrE
05336  |'                        If ddblExchangeRate = 0 T||05333  |'                        If ddblExchangeRate = 0 T
05337  |'                          intRtn = MsgBox("ＴＴＭ||05334  |'                          intRtn = MsgBox("ＴＴＭ
05338  |'                          vbLf & "対象通貨コード ||05335  |'                          vbLf & "対象通貨コード 
05339  |'                          vbLf & "基準日 ： [ " &||05336  |'                          vbLf & "基準日 ： [ " &
05340  |'                              vbCritical, "ＴＴＭ||05337  |'                              vbCritical, "ＴＴＭ
05341  |'                          Exit Function          ||05338  |'                          Exit Function          
05342  |'                        End If                   ||05339  |'                        End If                   
05343  |'                        'JPY→閾値通貨へ逆レート ||05340  |'                        'JPY→閾値通貨へ逆レート 
05344  |'                        dblValueIn = dblValueIn /||05341  |'                        dblValueIn = dblValueIn /
05345  |'                    End If                       ||05342  |'                    End If                       
05346  |'                End If                           ||05343  |'                End If                           
05347  |''2005/01/26 End                                  ||05344  |''2005/01/26 End                                  
05348  |'            End Select                           ||05345  |'            End Select                           
05349  |'            '@@@@@ NAV通貨から閾値通貨に換算 @@@@||05346  |'            '@@@@@ NAV通貨から閾値通貨に換算 @@@@
05350  |''2005/01/12 End                                  ||05347  |''2005/01/12 End                                  
05351  |''2005/01/13 Start                                ||05348  |''2005/01/13 Start                                
05352  |''            Call sbGetRoundValue(dblValueIn)    ||05349  |''            Call sbGetRoundValue(dblValueIn)    
05353  |'            Call sbGetRoundValue2(dblValueIn)    ||05350  |'            Call sbGetRoundValue2(dblValueIn)    
05354  |''2005/01/13 End                                  ||05351  |''2005/01/13 End                                  
05355  |''2005/01/12 Start                                ||05352  |''2005/01/12 Start                                
05356  |''            lCalcNav = CStr(Format(dblValueOut, ||05353  |''            lCalcNav = CStr(Format(dblValueOut, 
05357  |'            lCalcNav = CStr(Format(dblValueOut, "||05354  |'            lCalcNav = CStr(Format(dblValueOut, "
05358  |''2005/01/12 End                                  ||05355  |''2005/01/12 End                                  
05359  |''2004/11/17 End                                  ||05356  |''2004/11/17 End                                  
05360  |''2005/03/09 Start                                ||05357  |''2005/03/09 Start                                
05361  |''        End If                                  ||05358  |''        End If                                  
05362  |''2005/03/09 End                                  ||05359  |''2005/03/09 End                                  
05363  |'        '固定料率                                ||05360  |'        '固定料率                                
05364  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_ra||05361  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_ra
05365  |'            '計算対称NAV × 外部委託顧問料率 ÷ 1||05362  |'            '計算対称NAV × 外部委託顧問料率 ÷ 1
05366  |'            dRitsu = CDbl(gbuOtherComRateGetUPDRe||05363  |'            dRitsu = CDbl(gbuOtherComRateGetUPDRe
05367  |''2004/11/17 Start                                ||05364  |''2004/11/17 Start                                
05368  |''            mstrMonthlyPayCom = CCur(Round(lCalc||05365  |''            mstrMonthlyPayCom = CCur(Round(lCalc
05369  |''2005/01/12 Start                                ||05366  |''2005/01/12 Start                                
05370  |''            dblValueIn = lCalcNav * dRitsu / 100||05367  |''            dblValueIn = lCalcNav * dRitsu / 100
05371  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days||05368  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days
05372  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days||05369  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days
05373  |'                '一年間の日数：365日またはカレン ||05370  |'                '一年間の日数：365日またはカレン 
05374  |'                dblValueIn = lCalcNav * dRitsu / ||05371  |'                dblValueIn = lCalcNav * dRitsu / 
05375  |'            Else                                 ||05372  |'            Else                                 
05376  |'                '一年間の日数：360日             ||05373  |'                '一年間の日数：360日             
05377  |'                dblValueIn = lCalcNav * dRitsu / ||05374  |'                dblValueIn = lCalcNav * dRitsu / 
05378  |'            End If                               ||05375  |'            End If                               
05379  |''2005/01/12 End                                  ||05376  |''2005/01/12 End                                  
05380  |''2005/01/12 Start                                ||05377  |''2005/01/12 Start                                
05381  |''            Call sbGetRoundValue(dblValueIn)    ||05378  |''            Call sbGetRoundValue(dblValueIn)    
05382  |''            mstrMonthlyPayCom = CStr(Format(dblV||05379  |''            mstrMonthlyPayCom = CStr(Format(dblV
05383  |''2005/01/12 End                                  ||05380  |''2005/01/12 End                                  
05384  |''2004/11/17 End                                  ||05381  |''2004/11/17 End                                  
05385  |'        '段階料率                                ||05382  |'        '段階料率                                
05386  |'        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_othe||05383  |'        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_othe
05387  |'            '料率分ループ処理                    ||05384  |'            '料率分ループ処理                    
05388  |'            For i = LBound(gbuOtherComRateGetUPDR||05385  |'            For i = LBound(gbuOtherComRateGetUPDR
05389  |'                TotalRate = TotalRate + CCur(gbuO||05386  |'                TotalRate = TotalRate + CCur(gbuO
05390  |'                cRate = CCur(gbuOtherComRateGetUP||05387  |'                cRate = CCur(gbuOtherComRateGetUP
05391  |'                dRitsu = CDbl(gbuOtherComRateGetU||05388  |'                dRitsu = CDbl(gbuOtherComRateGetU
05392  |'                If i = UBound(gbuOtherComRateGetU||05389  |'                If i = UBound(gbuOtherComRateGetU
05393  |'                    '(前回閾値)：累積閾値 = WORK ||05390  |'                    '(前回閾値)：累積閾値 = WORK 
05394  |'                    TotalRate = WorkRate         ||05391  |'                    TotalRate = WorkRate         
05395  |'                ElseIf TotalRate <= lCalcNav Then||05392  |'                ElseIf TotalRate <= lCalcNav Then
05396  |'                    '累積投資顧問料 = 累積投資顧 ||05393  |'                    '累積投資顧問料 = 累積投資顧 
05397  |''2004/11/17 Start                                ||05394  |''2004/11/17 Start                                
05398  |''                    TotalCom = TotalCom + CCur(R||05395  |''                    TotalCom = TotalCom + CCur(R
05399  |'                    dblValueIn = cRate * dRitsu /||05396  |'                    dblValueIn = cRate * dRitsu /
05400  |''2005/01/13 Start                                ||05397  |''2005/01/13 Start                                
05401  |''                    Call sbGetRoundValue(dblValu||05398  |''                    Call sbGetRoundValue(dblValu
05402  |'                    Call sbGetRoundValue2(dblValu||05399  |'                    Call sbGetRoundValue2(dblValu
05403  |''2005/01/13 End                                  ||05400  |''2005/01/13 End                                  
05404  |'                    TotalCom = TotalCom + dblValu||05401  |'                    TotalCom = TotalCom + dblValu
05405  |''2004/11/17 End                                  ||05402  |''2004/11/17 End                                  
05406  |'                Else                             ||05403  |'                Else                             
05407  |'                    '(前回閾値)：累積閾値 = WORK ||05404  |'                    '(前回閾値)：累積閾値 = WORK 
05408  |'                    TotalRate = WorkRate         ||05405  |'                    TotalRate = WorkRate         
05409  |'                    Exit For                     ||05406  |'                    Exit For                     
05410  |'                End If                           ||05407  |'                End If                           
05411  |'                '累積閾値をWORKに格納(一つ前の閾 ||05408  |'                '累積閾値をWORKに格納(一つ前の閾 
05412  |'                WorkRate = TotalRate             ||05409  |'                WorkRate = TotalRate             
05413  |'            Next i                               ||05410  |'            Next i                               
05414  |'            '累積投資顧問料 = 累積投資顧問料 + ( ||05411  |'            '累積投資顧問料 = 累積投資顧問料 + ( 
05415  |''2004/11/17 Start                                ||05412  |''2004/11/17 Start                                
05416  |''            TotalCom = TotalCom + CCur(Round((lC||05413  |''            TotalCom = TotalCom + CCur(Round((lC
05417  |''            dblValueIn = (lCalcNav - TotalRate) ||05414  |''            dblValueIn = (lCalcNav - TotalRate) 
05418  |''            Call sbGetRoundValue(dblValueIn)    ||05415  |''            Call sbGetRoundValue(dblValueIn)    
05419  |''            TotalCom = TotalCom + dblValueOut   ||05416  |''            TotalCom = TotalCom + dblValueOut   
05420  |'            dblValueIn = (lCalcNav - TotalRate) *||05417  |'            dblValueIn = (lCalcNav - TotalRate) *
05421  |'            TotalCom = TotalCom + dblValueIn     ||05418  |'            TotalCom = TotalCom + dblValueIn     
05422  |''2004/11/17 End                                  ||05419  |''2004/11/17 End                                  
05423  |'            '投資顧問料 = 累積投資顧問料 × 計算 ||05420  |'            '投資顧問料 = 累積投資顧問料 × 計算 
05424  |''2004/11/17 Start                                ||05421  |''2004/11/17 Start                                
05425  |''            mstrMonthlyPayCom = CCur(Round(Total||05422  |''            mstrMonthlyPayCom = CCur(Round(Total
05426  |''2005/01/12 Start                                ||05423  |''2005/01/12 Start                                
05427  |''            dblValueIn = TotalCom * iCalcNum / c||05424  |''            dblValueIn = TotalCom * iCalcNum / c
05428  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days||05425  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days
05429  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days||05426  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days
05430  |'                '一年間の日数：365日またはカレン ||05427  |'                '一年間の日数：365日またはカレン 
05431  |''2005/01/18 Start                                ||05428  |''2005/01/18 Start                                
05432  |''                dblValueIn = lCalcNav * dRitsu /||05429  |''                dblValueIn = lCalcNav * dRitsu /
05433  |'                dblValueIn = TotalCom * iCalcNum ||05430  |'                dblValueIn = TotalCom * iCalcNum 
05434  |''2005/01/18 End                                  ||05431  |''2005/01/18 End                                  
05435  |'            Else                                 ||05432  |'            Else                                 
05436  |'                '一年間の日数：360日             ||05433  |'                '一年間の日数：360日             
05437  |''2005/01/18 Start                                ||05434  |''2005/01/18 Start                                
05438  |''                dblValueIn = lCalcNav * dRitsu /||05435  |''                dblValueIn = lCalcNav * dRitsu /
05439  |'                dblValueIn = TotalCom * iCalcNum ||05436  |'                dblValueIn = TotalCom * iCalcNum 
05440  |''2005/01/18 End                                  ||05437  |''2005/01/18 End                                  
05441  |'            End If                               ||05438  |'            End If                               
05442  |''2005/01/12 End                                  ||05439  |''2005/01/12 End                                  
05443  |''2005/01/12 Start                                ||05440  |''2005/01/12 Start                                
05444  |''            Call sbGetRoundValue(dblValueIn)    ||05441  |''            Call sbGetRoundValue(dblValueIn)    
05445  |''            mstrMonthlyPayCom = dblValueOut     ||05442  |''            mstrMonthlyPayCom = dblValueOut     
05446  |''2005/01/12 End                                  ||05443  |''2005/01/12 End                                  
05447  |''2004/11/17 End                                  ||05444  |''2004/11/17 End                                  
05448  |'        End If                                   ||05445  |'        End If                                   
05449  |''2005/01/12 Start                                ||05446  |''2005/01/12 Start                                
05450  |''''''        '支払への換算用に保存               ||05447  |''''''        '支払への換算用に保存               
05451  |''''''        ddblShiharai = dblValueIn           ||05448  |''''''        ddblShiharai = dblValueIn           
05452  |''2005/01/17 Start                                ||05449  |''2005/01/17 Start                                
05453  |'        ddblExchangeRate = 0                     ||05450  |'        ddblExchangeRate = 0                     
05454  |''2005/01/17 End                                  ||05451  |''2005/01/17 End                                  
05455  |'        '@@@@@ 外部委託顧問料に換算 @@@@@        ||05452  |'        '@@@@@ 外部委託顧問料に換算 @@@@@        
05456  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET||05453  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET
05457  |'          Case "1"    '固定料率                  ||05454  |'          Case "1"    '固定料率                  
05458  |''2005/01/26 Start                                ||05455  |''2005/01/26 Start                                
05459  |''''''              'NAV通貨と外部委託顧問料通貨が||05456  |''''''              'NAV通貨と外部委託顧問料通貨が
05460  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG||05457  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG
05461  |''''''                  '外部委託顧問料通貨が円以 ||05458  |''''''                  '外部委託顧問料通貨が円以 
05462  |''''''                  If gbuMGetUPDRec.N(lRecIdx||05459  |''''''                  If gbuMGetUPDRec.N(lRecIdx
05463  |''''''                    'NAV通貨から外部委託顧問||05460  |''''''                    'NAV通貨から外部委託顧問
05464  |'''''''2005/01/17 Start                           ||05461  |'''''''2005/01/17 Start                           
05465  |'''''''                    dblValueIn = dblValueIn||05462  |'''''''                    dblValueIn = dblValueIn
05466  |'''''''2005/01/18 Start                           ||05463  |'''''''2005/01/18 Start                           
05467  |'''''''                    'NAV通貨→JPYの為替レー||05464  |'''''''                    'NAV通貨→JPYの為替レー
05468  |'''''''                    dstrCurrencyCode = gbuM||05465  |'''''''                    dstrCurrencyCode = gbuM
05469  |'''''''                    ddblExchangeRate = fnst||05466  |'''''''                    ddblExchangeRate = fnst
05470  |'''''''                    If ddblExchangeRate = 0||05467  |'''''''                    If ddblExchangeRate = 0
05471  |'''''''                      intRtn = MsgBox("ＴＴ||05468  |'''''''                      intRtn = MsgBox("ＴＴ
05472  |'''''''                      vbLf & "対象通貨コー ||05469  |'''''''                      vbLf & "対象通貨コー 
05473  |'''''''                      vbLf & "基準日 ： [ "||05470  |'''''''                      vbLf & "基準日 ： [ "
05474  |'''''''                          vbCritical, "ＴＴ||05471  |'''''''                          vbCritical, "ＴＴ
05475  |'''''''                      Exit Function        ||05472  |'''''''                      Exit Function        
05476  |'''''''                    End If                 ||05473  |'''''''                    End If                 
05477  |'''''''                    'NAV通貨→JPYへレート換||05474  |'''''''                    'NAV通貨→JPYへレート換
05478  |'''''''                    dblValueIn = dblValueIn||05475  |'''''''                    dblValueIn = dblValueIn
05479  |'''''''                    '閾値通貨→JPYの為替レ ||05476  |'''''''                    '閾値通貨→JPYの為替レ 
05480  |'''''''                    dstrCurrencyCode = gbuM||05477  |'''''''                    dstrCurrencyCode = gbuM
05481  |'''''''                    ddblExchangeRate = fnst||05478  |'''''''                    ddblExchangeRate = fnst
05482  |'''''''                    '閾値通貨→JPYへレート ||05479  |'''''''                    '閾値通貨→JPYへレート 
05483  |'''''''                    dblValueIn = dblValueIn||05480  |'''''''                    dblValueIn = dblValueIn
05484  |'''''''2005/01/18 End                             ||05481  |'''''''2005/01/18 End                             
05485  |''''''                    '外部委託顧問料通貨→JPY||05482  |''''''                    '外部委託顧問料通貨→JPY
05486  |''''''                    dstrCurrencyCode = gbuMG||05483  |''''''                    dstrCurrencyCode = gbuMG
05487  |''''''                    ddblExchangeRate = fnstr||05484  |''''''                    ddblExchangeRate = fnstr
05488  |''''''                    If ddblExchangeRate = 0 ||05485  |''''''                    If ddblExchangeRate = 0 
05489  |''''''                      intRtn = MsgBox("ＴＴ ||05486  |''''''                      intRtn = MsgBox("ＴＴ 
05490  |''''''                      vbLf & "対象通貨コード||05487  |''''''                      vbLf & "対象通貨コード
05491  |''''''                      vbLf & "基準日 ： [ " ||05488  |''''''                      vbLf & "基準日 ： [ " 
05492  |''''''                          vbCritical, "ＴＴ ||05489  |''''''                          vbCritical, "ＴＴ 
05493  |''''''                      Exit Function         ||05490  |''''''                      Exit Function         
05494  |''''''                    End If                  ||05491  |''''''                    End If                  
05495  |''''''                    'JPY→閾値通貨へ逆レート||05492  |''''''                    'JPY→閾値通貨へ逆レート
05496  |''''''                    dblValueIn = dblValueIn ||05493  |''''''                    dblValueIn = dblValueIn 
05497  |'''''''2005/01/17 End                             ||05494  |'''''''2005/01/17 End                             
05498  |''''''                  End If                    ||05495  |''''''                  End If                    
05499  |''''''              End If                        ||05496  |''''''              End If                        
05500  |''''''              'NAV通貨と外部委託顧問料通貨が||05497  |''''''              'NAV通貨と外部委託顧問料通貨が
05501  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG||05498  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG
05502  |''''''                  '外部委託顧問料通貨が円   ||05499  |''''''                  '外部委託顧問料通貨が円   
05503  |''''''                  If gbuMGetUPDRec.N(lRecIdx||05500  |''''''                  If gbuMGetUPDRec.N(lRecIdx
05504  |''''''                    'NAV通貨から外部委託顧問||05501  |''''''                    'NAV通貨から外部委託顧問
05505  |'''''''2005/01/17 Start                           ||05502  |'''''''2005/01/17 Start                           
05506  |'''''''                    dblValueIn = dblValueIn||05503  |'''''''                    dblValueIn = dblValueIn
05507  |'''''''2005/01/18 Start                           ||05504  |'''''''2005/01/18 Start                           
05508  |''''''                    'NAV通貨→JPYの為替レー ||05505  |''''''                    'NAV通貨→JPYの為替レー 
05509  |'''''''                    dstrCurrencyCode = gbuM||05506  |'''''''                    dstrCurrencyCode = gbuM
05510  |'''''''                    ddblExchangeRate = fnst||05507  |'''''''                    ddblExchangeRate = fnst
05511  |'''''''                    If ddblExchangeRate = 0||05508  |'''''''                    If ddblExchangeRate = 0
05512  |'''''''                      intRtn = MsgBox("ＴＴ||05509  |'''''''                      intRtn = MsgBox("ＴＴ
05513  |'''''''                      vbLf & "対象通貨コー ||05510  |'''''''                      vbLf & "対象通貨コー 
05514  |'''''''                      vbLf & "基準日 ： [ "||05511  |'''''''                      vbLf & "基準日 ： [ "
05515  |'''''''                          vbCritical, "ＴＴ||05512  |'''''''                          vbCritical, "ＴＴ
05516  |'''''''                      Exit Function        ||05513  |'''''''                      Exit Function        
05517  |'''''''                    End If                 ||05514  |'''''''                    End If                 
05518  |'''''''                    'NAV通貨→JPYへレート換||05515  |'''''''                    'NAV通貨→JPYへレート換
05519  |'''''''                    dblValueIn = dblValueIn||05516  |'''''''                    dblValueIn = dblValueIn
05520  |'''''''                    '閾値通貨→JPYの為替レ ||05517  |'''''''                    '閾値通貨→JPYの為替レ 
05521  |'''''''                    dstrCurrencyCode = gbuM||05518  |'''''''                    dstrCurrencyCode = gbuM
05522  |'''''''                    ddblExchangeRate = fnst||05519  |'''''''                    ddblExchangeRate = fnst
05523  |'''''''                    If ddblExchangeRate = 0||05520  |'''''''                    If ddblExchangeRate = 0
05524  |'''''''                      intRtn = MsgBox("ＴＴ||05521  |'''''''                      intRtn = MsgBox("ＴＴ
05525  |'''''''                      vbLf & "対象通貨コー ||05522  |'''''''                      vbLf & "対象通貨コー 
05526  |'''''''                      vbLf & "基準日 ： [ "||05523  |'''''''                      vbLf & "基準日 ： [ "
05527  |'''''''                          vbCritical, "ＴＴ||05524  |'''''''                          vbCritical, "ＴＴ
05528  |'''''''                      Exit Function        ||05525  |'''''''                      Exit Function        
05529  |'''''''                    End If                 ||05526  |'''''''                    End If                 
05530  |'''''''                    '閾値通貨→JPYへレート ||05527  |'''''''                    '閾値通貨→JPYへレート 
05531  |'''''''                    dblValueIn = dblValueIn||05528  |'''''''                    dblValueIn = dblValueIn
05532  |'''''''2005/01/18 End                             ||05529  |'''''''2005/01/18 End                             
05533  |'''''''''''                    '外部委託顧問料通貨||05530  |'''''''''''                    '外部委託顧問料通貨
05534  |'''''''''''                    dstrCurrencyCode = ||05531  |'''''''''''                    dstrCurrencyCode = 
05535  |'''''''''''                    ddblExchangeRate = ||05532  |'''''''''''                    ddblExchangeRate = 
05536  |'''''''''''                    'JPY→閾値通貨へ逆 ||05533  |'''''''''''                    'JPY→閾値通貨へ逆 
05537  |'''''''''''                    dblValueIn = dblVal||05534  |'''''''''''                    dblValueIn = dblVal
05538  |'''''''2005/01/17 End                             ||05535  |'''''''2005/01/17 End                             
05539  |''''''                  End If                    ||05536  |''''''                  End If                    
05540  |''''''              End If                        ||05537  |''''''              End If                        
05541  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||05538  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
05542  |'                Else                             ||05539  |'                Else                             
05543  |'                  '外部委託顧問料通貨→JPYの為替 ||05540  |'                  '外部委託顧問料通貨→JPYの為替 
05544  |'                  dstrCurrencyCode = gbuMGetUPDRe||05541  |'                  dstrCurrencyCode = gbuMGetUPDRe
05545  |'                  ddblExchangeRate = fnstrExchang||05542  |'                  ddblExchangeRate = fnstrExchang
05546  |'                  If ddblExchangeRate = 0 Then   ||05543  |'                  If ddblExchangeRate = 0 Then   
05547  |'                    intRtn = MsgBox("ＴＴＭが取得||05544  |'                    intRtn = MsgBox("ＴＴＭが取得
05548  |'                    vbLf & "対象通貨コード ： [ "||05545  |'                    vbLf & "対象通貨コード ： [ "
05549  |'                    vbLf & "基準日 ： [ " & Mid(d||05546  |'                    vbLf & "基準日 ： [ " & Mid(d
05550  |'                        vbCritical, "ＴＴＭ取得エ||05547  |'                        vbCritical, "ＴＴＭ取得エ
05551  |'                    Exit Function                ||05548  |'                    Exit Function                
05552  |'                  End If                         ||05549  |'                  End If                         
05553  |'                  'JPY→閾値通貨へ逆レート換算   ||05550  |'                  'JPY→閾値通貨へ逆レート換算   
05554  |'                  dblValueIn = dblValueIn / ddblE||05551  |'                  dblValueIn = dblValueIn / ddblE
05555  |'                End If                           ||05552  |'                End If                           
05556  |''2005/01/26 End                                  ||05553  |''2005/01/26 End                                  
05557  |'          Case "2"    '段階料率                  ||05554  |'          Case "2"    '段階料率                  
05558  |''2005/01/26 Start                                ||05555  |''2005/01/26 Start                                
05559  |''''''              'NAV通貨と閾値通貨が相違      ||05556  |''''''              'NAV通貨と閾値通貨が相違      
05560  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG||05557  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG
05561  |''''''                  '閾値通貨と外部委託顧問料 ||05558  |''''''                  '閾値通貨と外部委託顧問料 
05562  |''''''                  If gbuMGetUPDRec.N(lRecIdx||05559  |''''''                  If gbuMGetUPDRec.N(lRecIdx
05563  |''''''                      '外部委託顧問料通貨が ||05560  |''''''                      '外部委託顧問料通貨が 
05564  |''''''                      If gbuMGetUPDRec.N(lRe||05561  |''''''                      If gbuMGetUPDRec.N(lRe
05565  |''''''                        '閾値通貨から外部委 ||05562  |''''''                        '閾値通貨から外部委 
05566  |'''''''2005/01/17 Start                           ||05563  |'''''''2005/01/17 Start                           
05567  |'''''''                         dblValueIn = dblVa||05564  |'''''''                         dblValueIn = dblVa
05568  |'''''''2005/01/18 Start                           ||05565  |'''''''2005/01/18 Start                           
05569  |'''''''                         'NAV通貨→JPYの為 ||05566  |'''''''                         'NAV通貨→JPYの為 
05570  |'''''''                         dstrCurrencyCode =||05567  |'''''''                         dstrCurrencyCode =
05571  |'''''''                         ddblExchangeRate =||05568  |'''''''                         ddblExchangeRate =
05572  |'''''''                         'NAV通貨→JPYへレ ||05569  |'''''''                         'NAV通貨→JPYへレ 
05573  |'''''''                         dblValueIn = dblVa||05570  |'''''''                         dblValueIn = dblVa
05574  |''''''                         '閾値通貨→JPYの為 ||05571  |''''''                         '閾値通貨→JPYの為 
05575  |''''''                         dstrCurrencyCode = ||05572  |''''''                         dstrCurrencyCode = 
05576  |''''''                         ddblExchangeRate = ||05573  |''''''                         ddblExchangeRate = 
05577  |''''''                         If ddblExchangeRate||05574  |''''''                         If ddblExchangeRate
05578  |''''''                           intRtn = MsgBox("||05575  |''''''                           intRtn = MsgBox("
05579  |''''''                           vbLf & "対象通貨 ||05576  |''''''                           vbLf & "対象通貨 
05580  |''''''                           vbLf & "基準日 ：||05577  |''''''                           vbLf & "基準日 ：
05581  |''''''                               vbCritical, "||05578  |''''''                               vbCritical, "
05582  |''''''                           Exit Function    ||05579  |''''''                           Exit Function    
05583  |''''''                         End If             ||05580  |''''''                         End If             
05584  |''''''                         '閾値通貨→JPYへレ ||05581  |''''''                         '閾値通貨→JPYへレ 
05585  |''''''                         dblValueIn = dblVal||05582  |''''''                         dblValueIn = dblVal
05586  |'''''''2005/01/18 End                             ||05583  |'''''''2005/01/18 End                             
05587  |''''''                         '外部委託顧問料通貨||05584  |''''''                         '外部委託顧問料通貨
05588  |''''''                         dstrCurrencyCode = ||05585  |''''''                         dstrCurrencyCode = 
05589  |''''''                         ddblExchangeRate = ||05586  |''''''                         ddblExchangeRate = 
05590  |''''''                         If ddblExchangeRate||05587  |''''''                         If ddblExchangeRate
05591  |''''''                           intRtn = MsgBox("||05588  |''''''                           intRtn = MsgBox("
05592  |''''''                           vbLf & "対象通貨 ||05589  |''''''                           vbLf & "対象通貨 
05593  |''''''                           vbLf & "基準日 ：||05590  |''''''                           vbLf & "基準日 ：
05594  |''''''                               vbCritical, "||05591  |''''''                               vbCritical, "
05595  |''''''                           Exit Function    ||05592  |''''''                           Exit Function    
05596  |''''''                         End If             ||05593  |''''''                         End If             
05597  |''''''                         'JPY→閾値通貨へ逆 ||05594  |''''''                         'JPY→閾値通貨へ逆 
05598  |''''''                         dblValueIn = dblVal||05595  |''''''                         dblValueIn = dblVal
05599  |'''''''2005/01/17 End                             ||05596  |'''''''2005/01/17 End                             
05600  |''''''                      End If                ||05597  |''''''                      End If                
05601  |''''''                  End If                    ||05598  |''''''                  End If                    
05602  |''''''              End If                        ||05599  |''''''              End If                        
05603  |''''''              'NAV通貨と閾値通貨が相違      ||05600  |''''''              'NAV通貨と閾値通貨が相違      
05604  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG||05601  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG
05605  |''''''                  '閾値通貨と外部委託顧問料 ||05602  |''''''                  '閾値通貨と外部委託顧問料 
05606  |''''''                  If gbuMGetUPDRec.N(lRecIdx||05603  |''''''                  If gbuMGetUPDRec.N(lRecIdx
05607  |''''''                      '外部委託顧問料通貨が ||05604  |''''''                      '外部委託顧問料通貨が 
05608  |''''''                      If gbuMGetUPDRec.N(lRe||05605  |''''''                      If gbuMGetUPDRec.N(lRe
05609  |''''''                        '閾値通貨から外部委 ||05606  |''''''                        '閾値通貨から外部委 
05610  |'''''''2005/01/17 Start                           ||05607  |'''''''2005/01/17 Start                           
05611  |'''''''                         dblValueIn = dblVa||05608  |'''''''                         dblValueIn = dblVa
05612  |'''''''2005/01/18 Start                           ||05609  |'''''''2005/01/18 Start                           
05613  |'''''''                         'NAV通貨→JPYの為 ||05610  |'''''''                         'NAV通貨→JPYの為 
05614  |'''''''                         dstrCurrencyCode =||05611  |'''''''                         dstrCurrencyCode =
05615  |'''''''                         ddblExchangeRate =||05612  |'''''''                         ddblExchangeRate =
05616  |'''''''                         'NAV通貨→JPYへレ ||05613  |'''''''                         'NAV通貨→JPYへレ 
05617  |'''''''                         dblValueIn = dblVa||05614  |'''''''                         dblValueIn = dblVa
05618  |''''''                         '閾値通貨→JPYの為 ||05615  |''''''                         '閾値通貨→JPYの為 
05619  |''''''                         dstrCurrencyCode = ||05616  |''''''                         dstrCurrencyCode = 
05620  |''''''                         ddblExchangeRate = ||05617  |''''''                         ddblExchangeRate = 
05621  |''''''                         If ddblExchangeRate||05618  |''''''                         If ddblExchangeRate
05622  |''''''                           intRtn = MsgBox("||05619  |''''''                           intRtn = MsgBox("
05623  |''''''                           vbLf & "対象通貨 ||05620  |''''''                           vbLf & "対象通貨 
05624  |''''''                           vbLf & "基準日 ：||05621  |''''''                           vbLf & "基準日 ：
05625  |''''''                               vbCritical, "||05622  |''''''                               vbCritical, "
05626  |''''''                           Exit Function    ||05623  |''''''                           Exit Function    
05627  |''''''                         End If             ||05624  |''''''                         End If             
05628  |''''''                         '閾値通貨→JPYへレ ||05625  |''''''                         '閾値通貨→JPYへレ 
05629  |''''''                         dblValueIn = dblVal||05626  |''''''                         dblValueIn = dblVal
05630  |'''''''2005/01/18 End                             ||05627  |'''''''2005/01/18 End                             
05631  |'''''''                         '外部委託顧問料通 ||05628  |'''''''                         '外部委託顧問料通 
05632  |'''''''                         dstrCurrencyCode =||05629  |'''''''                         dstrCurrencyCode =
05633  |'''''''                         ddblExchangeRate =||05630  |'''''''                         ddblExchangeRate =
05634  |'''''''                         'JPY→閾値通貨へ逆||05631  |'''''''                         'JPY→閾値通貨へ逆
05635  |'''''''                         dblValueIn = dblVa||05632  |'''''''                         dblValueIn = dblVa
05636  |'''''''2005/01/17 End                             ||05633  |'''''''2005/01/17 End                             
05637  |''''''                      End If                ||05634  |''''''                      End If                
05638  |''''''                  End If                    ||05635  |''''''                  End If                    
05639  |''''''              End If                        ||05636  |''''''              End If                        
05640  |'            '                                    ||05637  |'            '                                    
05641  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe||05638  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe
05642  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||05639  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
05643  |'                Else                             ||05640  |'                Else                             
05644  |'                    '閾値通貨→JPYの為替レートを ||05641  |'                    '閾値通貨→JPYの為替レートを 
05645  |'                    dstrCurrencyCode = gbuMGetUPD||05642  |'                    dstrCurrencyCode = gbuMGetUPD
05646  |'                    ddblExchangeRate = fnstrExcha||05643  |'                    ddblExchangeRate = fnstrExcha
05647  |'                    'JPY→閾値通貨へ逆レート換算 ||05644  |'                    'JPY→閾値通貨へ逆レート換算 
05648  |'                    dblValueIn = dblValueIn / ddb||05645  |'                    dblValueIn = dblValueIn / ddb
05649  |'                End If                           ||05646  |'                End If                           
05650  |'            Else                                 ||05647  |'            Else                                 
05651  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||05648  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
05652  |'                    '外部委託顧問料通貨→JPYの為 ||05649  |'                    '外部委託顧問料通貨→JPYの為 
05653  |'                    dstrCurrencyCode = gbuMGetUPD||05650  |'                    dstrCurrencyCode = gbuMGetUPD
05654  |'                    ddblExchangeRate = fnstrExcha||05651  |'                    ddblExchangeRate = fnstrExcha
05655  |'                    'JPY→閾値通貨へレート換算   ||05652  |'                    'JPY→閾値通貨へレート換算   
05656  |'                    dblValueIn = dblValueIn / ddb||05653  |'                    dblValueIn = dblValueIn / ddb
05657  |'                Else                             ||05654  |'                Else                             
05658  |'                    '閾値通貨→JPYの為替レートを ||05655  |'                    '閾値通貨→JPYの為替レートを 
05659  |'                    dstrCurrencyCode = gbuMGetUPD||05656  |'                    dstrCurrencyCode = gbuMGetUPD
05660  |'                    ddblExchangeRate = fnstrExcha||05657  |'                    ddblExchangeRate = fnstrExcha
05661  |'                    'JPY→閾値通貨へ逆レート換算 ||05658  |'                    'JPY→閾値通貨へ逆レート換算 
05662  |'                    dblValueIn = dblValueIn * ddb||05659  |'                    dblValueIn = dblValueIn * ddb
05663  |'                    '外部委託顧問料通貨→JPYの為 ||05660  |'                    '外部委託顧問料通貨→JPYの為 
05664  |'                    dstrCurrencyCode = gbuMGetUPD||05661  |'                    dstrCurrencyCode = gbuMGetUPD
05665  |'                    ddblExchangeRate = fnstrExcha||05662  |'                    ddblExchangeRate = fnstrExcha
05666  |'                    'JPY→閾値通貨へ逆レート換算 ||05663  |'                    'JPY→閾値通貨へ逆レート換算 
05667  |'                    dblValueIn = dblValueIn / ddb||05664  |'                    dblValueIn = dblValueIn / ddb
05668  |'                End If                           ||05665  |'                End If                           
05669  |'            End If                               ||05666  |'            End If                               
05670  |''2005/01/26 End                                  ||05667  |''2005/01/26 End                                  
05671  |'        End Select                               ||05668  |'        End Select                               
05672  |'        '@@@@@ 外部委託顧問料に換算 @@@@@        ||05669  |'        '@@@@@ 外部委託顧問料に換算 @@@@@        
05673  |''2005/01/13 Start                                ||05670  |''2005/01/13 Start                                
05674  |''        Call sbGetRoundValue(dblValueIn)        ||05671  |''        Call sbGetRoundValue(dblValueIn)        
05675  |'        Call sbGetRoundValue2(dblValueIn)        ||05672  |'        Call sbGetRoundValue2(dblValueIn)        
05676  |''2005/01/13 End                                  ||05673  |''2005/01/13 End                                  
05677  |'        mstrMonthlyPayCom = dblValueOut          ||05674  |'        mstrMonthlyPayCom = dblValueOut          
05678  |''2005/01/12 End                                  ||05675  |''2005/01/12 End                                  
05679  |'                                                 ||05676  |'                                                 
05680  |''2005/01/12 Start                                ||05677  |''2005/01/12 Start                                
05681  |''        '年率                                   ||05678  |''        '年率                                   
05682  |''        .Cells(39, 2).Value = sWord10           ||05679  |''        .Cells(39, 2).Value = sWord10           
05683  |'''2004/09/10 Start                               ||05680  |'''2004/09/10 Start                               
05684  |'''        .Cells(39, 10).Value = sWord19         ||05681  |'''        .Cells(39, 10).Value = sWord19         
05685  |'        .Cells(39, 11).Value = sWord19           ||05682  |'        .Cells(39, 11).Value = sWord19           
05686  |'        '年率                                    ||05683  |'        '年率                                    
05687  |'        .Cells(39, 2).Value = sWord10            ||05684  |'        .Cells(39, 2).Value = sWord10            
05688  |''2004/09/10 Start                                ||05685  |''2004/09/10 Start                                
05689  |''        .Cells(39, 10).Value = sWord19          ||05686  |''        .Cells(39, 10).Value = sWord19          
05690  |''        .Cells(39, 9).Value = sWord19           ||05687  |''        .Cells(39, 9).Value = sWord19           
05691  |''2005/01/12 End                                  ||05688  |''2005/01/12 End                                  
05692  |''2004/09/10 End                                  ||05689  |''2004/09/10 End                                  
05693  |'        TotalRate = 0                            ||05690  |'        TotalRate = 0                            
05694  |'        '固定料率                                ||05691  |'        '固定料率                                
05695  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_ra||05692  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_ra
05696  |'            '年率1行固定                         ||05693  |'            '年率1行固定                         
05697  |''2004/11/17 Start                                ||05694  |''2004/11/17 Start                                
05698  |''            .Cells(39, 13).Value = _            ||05695  |''            .Cells(39, 13).Value = _            
05699  |''                sWord30 & Format(gbuOtherComRate||05696  |''                sWord30 & Format(gbuOtherComRate
05700  |''2005/01/12 Start                                ||05697  |''2005/01/12 Start                                
05701  |'            .Cells(39, 13).Value = _             ||05698  |'            .Cells(39, 13).Value = _             
05702  |'                sWord30 & Format(gbuOtherComRateG||05699  |'                sWord30 & Format(gbuOtherComRateG
05703  |''            .Cells(39, 11).Value = _            ||05700  |''            .Cells(39, 11).Value = _            
05704  |''                sWord30 & Format(gbuOtherComRate||05701  |''                sWord30 & Format(gbuOtherComRate
05705  |''2005/01/12 End                                  ||05702  |''2005/01/12 End                                  
05706  |''2004/11/17 End                                  ||05703  |''2004/11/17 End                                  
05707  |'        '段階料率                                ||05704  |'        '段階料率                                
05708  |'        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_othe||05705  |'        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_othe
05709  |'            '料率順位のデータ数により処理を分岐  ||05706  |'            '料率順位のデータ数により処理を分岐  
05710  |'            iRowCnt = 0                          ||05707  |'            iRowCnt = 0                          
05711  |'            If UBound(gbuOtherComRateGetUPDRec.N)||05708  |'            If UBound(gbuOtherComRateGetUPDRec.N)
05712  |'                '料率データが4件以上のときは行間 ||05709  |'                '料率データが4件以上のときは行間 
05713  |'                For i = LBound(gbuOtherComRateGet||05710  |'                For i = LBound(gbuOtherComRateGet
05714  |'                    If i = 0 Then                ||05711  |'                    If i = 0 Then                
05715  |'                        '年率1行目               ||05712  |'                        '年率1行目               
05716  |''2005/01/12 Start                                ||05713  |''2005/01/12 Start                                
05717  |''                        .Cells(39, 13).Value = _||05714  |''                        .Cells(39, 13).Value = _
05718  |''                            sWord26 & CStr(Forma||05715  |''                            sWord26 & CStr(Forma
05719  |''                            sWord27 & Format(gbu||05716  |''                            sWord27 & Format(gbu
05720  |'                        Select Case gbuMGetUPDRec||05717  |'                        Select Case gbuMGetUPDRec
05721  |'                            Case cAud            ||05718  |'                            Case cAud            
05722  |'                                .Cells(39, 13).Va||05719  |'                                .Cells(39, 13).Va
05723  |'                                    sWord26 & CSt||05720  |'                                    sWord26 & CSt
05724  |'                                    sAud & sWord2||05721  |'                                    sAud & sWord2
05725  |'                            Case cCad            ||05722  |'                            Case cCad            
05726  |'                                .Cells(39, 13).Va||05723  |'                                .Cells(39, 13).Va
05727  |'                                    sWord26 & CSt||05724  |'                                    sWord26 & CSt
05728  |'                                    sCad & sWord2||05725  |'                                    sCad & sWord2
05729  |'                            Case cChf            ||05726  |'                            Case cChf            
05730  |'                                .Cells(39, 13).Va||05727  |'                                .Cells(39, 13).Va
05731  |'                                    sWord26 & CSt||05728  |'                                    sWord26 & CSt
05732  |'                                    sChf & sWord2||05729  |'                                    sChf & sWord2
05733  |'                            Case cEur            ||05730  |'                            Case cEur            
05734  |'                                .Cells(39, 13).Va||05731  |'                                .Cells(39, 13).Va
05735  |'                                    sWord26 & CSt||05732  |'                                    sWord26 & CSt
05736  |'                                    sEur & sWord2||05733  |'                                    sEur & sWord2
05737  |'                            Case cGbp            ||05734  |'                            Case cGbp            
05738  |'                                .Cells(39, 13).Va||05735  |'                                .Cells(39, 13).Va
05739  |'                                    sWord26 & CSt||05736  |'                                    sWord26 & CSt
05740  |'                                    sGbp & sWord2||05737  |'                                    sGbp & sWord2
05741  |'                            Case cHkd            ||05738  |'                            Case cHkd            
05742  |'                                .Cells(39, 13).Va||05739  |'                                .Cells(39, 13).Va
05743  |'                                    sWord26 & CSt||05740  |'                                    sWord26 & CSt
05744  |'                                    sHkd & sWord2||05741  |'                                    sHkd & sWord2
05745  |'                            Case cJpy            ||05742  |'                            Case cJpy            
05746  |'                                .Cells(39, 13).Va||05743  |'                                .Cells(39, 13).Va
05747  |'                                    sWord26 & CSt||05744  |'                                    sWord26 & CSt
05748  |'                                    sYen & sWord2||05745  |'                                    sYen & sWord2
05749  |'                            Case cMyr            ||05746  |'                            Case cMyr            
05750  |'                                .Cells(39, 13).Va||05747  |'                                .Cells(39, 13).Va
05751  |'                                    sWord26 & CSt||05748  |'                                    sWord26 & CSt
05752  |'                                    sMyr & sWord2||05749  |'                                    sMyr & sWord2
05753  |'                            Case cNzd            ||05750  |'                            Case cNzd            
05754  |'                                .Cells(39, 13).Va||05751  |'                                .Cells(39, 13).Va
05755  |'                                    sWord26 & CSt||05752  |'                                    sWord26 & CSt
05756  |'                                    sNzd & sWord2||05753  |'                                    sNzd & sWord2
05757  |'                            Case cSek            ||05754  |'                            Case cSek            
05758  |'                                .Cells(39, 13).Va||05755  |'                                .Cells(39, 13).Va
05759  |'                                    sWord26 & CSt||05756  |'                                    sWord26 & CSt
05760  |'                                    sSek & sWord2||05757  |'                                    sSek & sWord2
05761  |'                            Case cSgd            ||05758  |'                            Case cSgd            
05762  |'                                .Cells(39, 13).Va||05759  |'                                .Cells(39, 13).Va
05763  |'                                    sWord26 & CSt||05760  |'                                    sWord26 & CSt
05764  |'                                    sSgd & sWord2||05761  |'                                    sSgd & sWord2
05765  |'                            Case cUsd            ||05762  |'                            Case cUsd            
05766  |'                                .Cells(39, 13).Va||05763  |'                                .Cells(39, 13).Va
05767  |'                                    sWord26 & CSt||05764  |'                                    sWord26 & CSt
05768  |'                                    sUsd & sWord2||05765  |'                                    sUsd & sWord2
05769  |'                            Case cNok            ||05766  |'                            Case cNok            
05770  |'                                .Cells(39, 13).Va||05767  |'                                .Cells(39, 13).Va
05771  |'                                    sWord26 & CSt||05768  |'                                    sWord26 & CSt
05772  |'                                    sNok & sWord2||05769  |'                                    sNok & sWord2
05773  |'                        End Select               ||05770  |'                        End Select               
05774  |''2005/01/12 End                                  ||05771  |''2005/01/12 End                                  
05775  |'                        '年率　累積値セット      ||05772  |'                        '年率　累積値セット      
05776  |'                        TotalRate = CCur(gbuOther||05773  |'                        TotalRate = CCur(gbuOther
05777  |'                    ElseIf i = UBound(gbuOtherCom||05774  |'                    ElseIf i = UBound(gbuOtherCom
05778  |'                        '年率最終行              ||05775  |'                        '年率最終行              
05779  |''2005/01/12 Start                                ||05776  |''2005/01/12 Start                                
05780  |'                        '前半金額部分            ||05777  |'                        '前半金額部分            
05781  |'                        .Cells(39 + i, 23).Number||05778  |'                        .Cells(39 + i, 23).Number
05782  |''2005/01/20 Start                                ||05779  |''2005/01/20 Start                                
05783  |''                        .Cells(39 + i, 23).Value||05780  |''                        .Cells(39 + i, 23).Value
05784  |'                        If gbuMGetUPDRec.N(lRecId||05781  |'                        If gbuMGetUPDRec.N(lRecId
05785  |'                            .Cells(39 + i, 23).Va||05782  |'                            .Cells(39 + i, 23).Va
05786  |'                        Else                     ||05783  |'                        Else                     
05787  |'                            .Cells(39 + i, 23).Va||05784  |'                            .Cells(39 + i, 23).Va
05788  |'                        End If                   ||05785  |'                        End If                   
05789  |''2005/01/20 End                                  ||05786  |''2005/01/20 End                                  
05790  |'                        .Cells(39 + i, 23).Horizo||05787  |'                        .Cells(39 + i, 23).Horizo
05791  |''                        '前半金額部分           ||05788  |''                        '前半金額部分           
05792  |''                        .Cells(39 + i, 21).Numbe||05789  |''                        .Cells(39 + i, 21).Numbe
05793  |''                        .Cells(39 + i, 21).Value||05790  |''                        .Cells(39 + i, 21).Value
05794  |''                        .Cells(39 + i, 21).Horiz||05791  |''                        .Cells(39 + i, 21).Horiz
05795  |''2005/01/12 End                                  ||05792  |''2005/01/12 End                                  
05796  |''                        '年率　累積値セット     ||05793  |''                        '年率　累積値セット     
05797  |''                        TotalRate = TotalRate + ||05794  |''                        TotalRate = TotalRate + 
05798  |'                        '後半の文言              ||05795  |'                        '後半の文言              
05799  |''2005/01/12 Start                                ||05796  |''2005/01/12 Start                                
05800  |''                        .Cells(39 + i, 24).Value||05797  |''                        .Cells(39 + i, 24).Value
05801  |''                            sWord31 & Format(gbu||05798  |''                            sWord31 & Format(gbu
05802  |'                        Select Case gbuMGetUPDRec||05799  |'                        Select Case gbuMGetUPDRec
05803  |'                            Case cAud            ||05800  |'                            Case cAud            
05804  |'                                .Cells(39 + i, 24||05801  |'                                .Cells(39 + i, 24
05805  |'                                    sAud & sWord3||05802  |'                                    sAud & sWord3
05806  |'                            Case cCad            ||05803  |'                            Case cCad            
05807  |'                                .Cells(39 + i, 24||05804  |'                                .Cells(39 + i, 24
05808  |'                                    sCad & sWord3||05805  |'                                    sCad & sWord3
05809  |'                            Case cChf            ||05806  |'                            Case cChf            
05810  |'                                .Cells(39 + i, 24||05807  |'                                .Cells(39 + i, 24
05811  |'                                    sChf & sWord3||05808  |'                                    sChf & sWord3
05812  |'                            Case cEur            ||05809  |'                            Case cEur            
05813  |'                                .Cells(39 + i, 24||05810  |'                                .Cells(39 + i, 24
05814  |'                                    sEur & sWord3||05811  |'                                    sEur & sWord3
05815  |'                            Case cGbp            ||05812  |'                            Case cGbp            
05816  |'                                .Cells(39 + i, 24||05813  |'                                .Cells(39 + i, 24
05817  |'                                    sGbp & sWord3||05814  |'                                    sGbp & sWord3
05818  |'                            Case cHkd            ||05815  |'                            Case cHkd            
05819  |'                                .Cells(39 + i, 24||05816  |'                                .Cells(39 + i, 24
05820  |'                                    sHkd & sWord3||05817  |'                                    sHkd & sWord3
05821  |'                            Case cJpy            ||05818  |'                            Case cJpy            
05822  |'                                .Cells(39 + i, 24||05819  |'                                .Cells(39 + i, 24
05823  |'                                    sYen & sWord3||05820  |'                                    sYen & sWord3
05824  |'                            Case cMyr            ||05821  |'                            Case cMyr            
05825  |'                                .Cells(39 + i, 24||05822  |'                                .Cells(39 + i, 24
05826  |'                                    sMyr & sWord3||05823  |'                                    sMyr & sWord3
05827  |'                            Case cNzd            ||05824  |'                            Case cNzd            
05828  |'                                .Cells(39 + i, 24||05825  |'                                .Cells(39 + i, 24
05829  |'                                    sNzd & sWord3||05826  |'                                    sNzd & sWord3
05830  |'                            Case cSek            ||05827  |'                            Case cSek            
05831  |'                                .Cells(39 + i, 24||05828  |'                                .Cells(39 + i, 24
05832  |'                                    sSek & sWord3||05829  |'                                    sSek & sWord3
05833  |'                            Case cSgd            ||05830  |'                            Case cSgd            
05834  |'                                .Cells(39 + i, 24||05831  |'                                .Cells(39 + i, 24
05835  |'                                    sSgd & sWord3||05832  |'                                    sSgd & sWord3
05836  |'                            Case cUsd            ||05833  |'                            Case cUsd            
05837  |'                                .Cells(39 + i, 24||05834  |'                                .Cells(39 + i, 24
05838  |'                                    sUsd & sWord3||05835  |'                                    sUsd & sWord3
05839  |'                            Case cNok            ||05836  |'                            Case cNok            
05840  |'                                .Cells(39 + i, 24||05837  |'                                .Cells(39 + i, 24
05841  |'                                    sNok & sWord3||05838  |'                                    sNok & sWord3
05842  |'                        End Select               ||05839  |'                        End Select               
05843  |''2005/01/12 End                                  ||05840  |''2005/01/12 End                                  
05844  |'                    Else                         ||05841  |'                    Else                         
05845  |'                        '年率2行目以降           ||05842  |'                        '年率2行目以降           
05846  |''2005/01/12 Start                                ||05843  |''2005/01/12 Start                                
05847  |'                        '前半金額部分            ||05844  |'                        '前半金額部分            
05848  |'                        .Cells(39 + i, 23).Number||05845  |'                        .Cells(39 + i, 23).Number
05849  |''                        .Cells(39 + i, 23).Value||05846  |''                        .Cells(39 + i, 23).Value
05850  |''2005/01/20 Start                                ||05847  |''2005/01/20 Start                                
05851  |''                        .Cells(39 + i, 23).Value||05848  |''                        .Cells(39 + i, 23).Value
05852  |'                        If gbuMGetUPDRec.N(lRecId||05849  |'                        If gbuMGetUPDRec.N(lRecId
05853  |'                            .Cells(39 + i, 23).Va||05850  |'                            .Cells(39 + i, 23).Va
05854  |'                        Else                     ||05851  |'                        Else                     
05855  |'                            .Cells(39 + i, 23).Va||05852  |'                            .Cells(39 + i, 23).Va
05856  |'                        End If                   ||05853  |'                        End If                   
05857  |''2005/01/20 End                                  ||05854  |''2005/01/20 End                                  
05858  |'                        .Cells(39 + i, 23).Horizo||05855  |'                        .Cells(39 + i, 23).Horizo
05859  |''                        '前半金額部分           ||05856  |''                        '前半金額部分           
05860  |''                        .Cells(39 + i, 21).Numbe||05857  |''                        .Cells(39 + i, 21).Numbe
05861  |''                        .Cells(39 + i, 21).Value||05858  |''                        .Cells(39 + i, 21).Value
05862  |''                        .Cells(39 + i, 21).Horiz||05859  |''                        .Cells(39 + i, 21).Horiz
05863  |''2005/01/12 End                                  ||05860  |''2005/01/12 End                                  
05864  |'                        '年率　累積値セット      ||05861  |'                        '年率　累積値セット      
05865  |'                        TotalRate = TotalRate + C||05862  |'                        TotalRate = TotalRate + C
05866  |'                        '後半の文言              ||05863  |'                        '後半の文言              
05867  |''2005/01/12 Start                                ||05864  |''2005/01/12 Start                                
05868  |''                        .Cells(39 + i, 24).Value||05865  |''                        .Cells(39 + i, 24).Value
05869  |''                            sWord29 & CStr(Forma||05866  |''                            sWord29 & CStr(Forma
05870  |''                            Format(gbuOtherComRa||05867  |''                            Format(gbuOtherComRa
05871  |'                        Select Case gbuMGetUPDRec||05868  |'                        Select Case gbuMGetUPDRec
05872  |'                            Case cAud            ||05869  |'                            Case cAud            
05873  |'                                .Cells(39 + i, 24||05870  |'                                .Cells(39 + i, 24
05874  |'                                    sAud & sWord2||05871  |'                                    sAud & sWord2
05875  |'                                    Format(gbuOth||05872  |'                                    Format(gbuOth
05876  |'                            Case cCad            ||05873  |'                            Case cCad            
05877  |'                                .Cells(39 + i, 24||05874  |'                                .Cells(39 + i, 24
05878  |'                                    sCad & sWord2||05875  |'                                    sCad & sWord2
05879  |'                                    Format(gbuOth||05876  |'                                    Format(gbuOth
05880  |'                            Case cChf            ||05877  |'                            Case cChf            
05881  |'                                .Cells(39 + i, 24||05878  |'                                .Cells(39 + i, 24
05882  |'                                    sChf & sWord2||05879  |'                                    sChf & sWord2
05883  |'                                    Format(gbuOth||05880  |'                                    Format(gbuOth
05884  |'                            Case cEur            ||05881  |'                            Case cEur            
05885  |'                                .Cells(39 + i, 24||05882  |'                                .Cells(39 + i, 24
05886  |'                                    sEur & sWord2||05883  |'                                    sEur & sWord2
05887  |'                                    Format(gbuOth||05884  |'                                    Format(gbuOth
05888  |'                            Case cGbp            ||05885  |'                            Case cGbp            
05889  |'                                .Cells(39 + i, 24||05886  |'                                .Cells(39 + i, 24
05890  |'                                    sGbp & sWord2||05887  |'                                    sGbp & sWord2
05891  |'                                    Format(gbuOth||05888  |'                                    Format(gbuOth
05892  |'                            Case cHkd            ||05889  |'                            Case cHkd            
05893  |'                                .Cells(39 + i, 24||05890  |'                                .Cells(39 + i, 24
05894  |'                                    sHkd & sWord2||05891  |'                                    sHkd & sWord2
05895  |'                                    Format(gbuOth||05892  |'                                    Format(gbuOth
05896  |'                            Case cJpy            ||05893  |'                            Case cJpy            
05897  |'                                .Cells(39 + i, 24||05894  |'                                .Cells(39 + i, 24
05898  |'                                    sYen & sWord2||05895  |'                                    sYen & sWord2
05899  |'                                    Format(gbuOth||05896  |'                                    Format(gbuOth
05900  |'                            Case cMyr            ||05897  |'                            Case cMyr            
05901  |'                                .Cells(39 + i, 24||05898  |'                                .Cells(39 + i, 24
05902  |'                                    sMyr & sWord2||05899  |'                                    sMyr & sWord2
05903  |'                                    Format(gbuOth||05900  |'                                    Format(gbuOth
05904  |'                            Case cNzd            ||05901  |'                            Case cNzd            
05905  |'                                .Cells(39 + i, 24||05902  |'                                .Cells(39 + i, 24
05906  |'                                    sNzd & sWord2||05903  |'                                    sNzd & sWord2
05907  |'                                    Format(gbuOth||05904  |'                                    Format(gbuOth
05908  |'                            Case cSek            ||05905  |'                            Case cSek            
05909  |'                                .Cells(39 + i, 24||05906  |'                                .Cells(39 + i, 24
05910  |'                                    sSek & sWord2||05907  |'                                    sSek & sWord2
05911  |'                                    Format(gbuOth||05908  |'                                    Format(gbuOth
05912  |'                            Case cSgd            ||05909  |'                            Case cSgd            
05913  |'                                .Cells(39 + i, 24||05910  |'                                .Cells(39 + i, 24
05914  |'                                    sSgd & sWord2||05911  |'                                    sSgd & sWord2
05915  |'                                    Format(gbuOth||05912  |'                                    Format(gbuOth
05916  |'                            Case cUsd            ||05913  |'                            Case cUsd            
05917  |'                                .Cells(39 + i, 24||05914  |'                                .Cells(39 + i, 24
05918  |'                                    sUsd & sWord2||05915  |'                                    sUsd & sWord2
05919  |'                                    Format(gbuOth||05916  |'                                    Format(gbuOth
05920  |'                            Case cNok            ||05917  |'                            Case cNok            
05921  |'                                .Cells(39 + i, 24||05918  |'                                .Cells(39 + i, 24
05922  |'                                    sNok & sWord2||05919  |'                                    sNok & sWord2
05923  |'                                    Format(gbuOth||05920  |'                                    Format(gbuOth
05924  |'                        End Select               ||05921  |'                        End Select               
05925  |''2005/01/12 End                                  ||05922  |''2005/01/12 End                                  
05926  |'                    End If                       ||05923  |'                    End If                       
05927  |'                Next i                           ||05924  |'                Next i                           
05928  |'            Else                                 ||05925  |'            Else                                 
05929  |'                '料率データが3件以下のときは行間 ||05926  |'                '料率データが3件以下のときは行間 
05930  |'                For i = LBound(gbuOtherComRateGet||05927  |'                For i = LBound(gbuOtherComRateGet
05931  |'                    If i = 0 Then                ||05928  |'                    If i = 0 Then                
05932  |'                        '年率1行目               ||05929  |'                        '年率1行目               
05933  |''2005/01/12 Start                                ||05930  |''2005/01/12 Start                                
05934  |''                        .Cells(39, 13).Value = _||05931  |''                        .Cells(39, 13).Value = _
05935  |''                            sWord26 & CStr(Forma||05932  |''                            sWord26 & CStr(Forma
05936  |''                            sWord27 & Format(gbu||05933  |''                            sWord27 & Format(gbu
05937  |'                        Select Case gbuMGetUPDRec||05934  |'                        Select Case gbuMGetUPDRec
05938  |'                            Case cAud            ||05935  |'                            Case cAud            
05939  |'                                .Cells(39, 13).Va||05936  |'                                .Cells(39, 13).Va
05940  |'                                    sWord26 & CSt||05937  |'                                    sWord26 & CSt
05941  |'                                    sAud & sWord2||05938  |'                                    sAud & sWord2
05942  |'                            Case cCad            ||05939  |'                            Case cCad            
05943  |'                                .Cells(39, 13).Va||05940  |'                                .Cells(39, 13).Va
05944  |'                                    sWord26 & CSt||05941  |'                                    sWord26 & CSt
05945  |'                                    sCad & sWord2||05942  |'                                    sCad & sWord2
05946  |'                            Case cChf            ||05943  |'                            Case cChf            
05947  |'                                .Cells(39, 13).Va||05944  |'                                .Cells(39, 13).Va
05948  |'                                    sWord26 & CSt||05945  |'                                    sWord26 & CSt
05949  |'                                    sChf & sWord2||05946  |'                                    sChf & sWord2
05950  |'                            Case cEur            ||05947  |'                            Case cEur            
05951  |'                                .Cells(39, 13).Va||05948  |'                                .Cells(39, 13).Va
05952  |'                                    sWord26 & CSt||05949  |'                                    sWord26 & CSt
05953  |'                                    sEur & sWord2||05950  |'                                    sEur & sWord2
05954  |'                            Case cGbp            ||05951  |'                            Case cGbp            
05955  |'                                .Cells(39, 13).Va||05952  |'                                .Cells(39, 13).Va
05956  |'                                    sWord26 & CSt||05953  |'                                    sWord26 & CSt
05957  |'                                    sGbp & sWord2||05954  |'                                    sGbp & sWord2
05958  |'                            Case cHkd            ||05955  |'                            Case cHkd            
05959  |'                                .Cells(39, 13).Va||05956  |'                                .Cells(39, 13).Va
05960  |'                                    sWord26 & CSt||05957  |'                                    sWord26 & CSt
05961  |'                                    sHkd & sWord2||05958  |'                                    sHkd & sWord2
05962  |'                            Case cJpy            ||05959  |'                            Case cJpy            
05963  |'                                .Cells(39, 13).Va||05960  |'                                .Cells(39, 13).Va
05964  |'                                    sWord26 & CSt||05961  |'                                    sWord26 & CSt
05965  |'                                    sYen & sWord2||05962  |'                                    sYen & sWord2
05966  |'                            Case cMyr            ||05963  |'                            Case cMyr            
05967  |'                                .Cells(39, 13).Va||05964  |'                                .Cells(39, 13).Va
05968  |'                                    sWord26 & CSt||05965  |'                                    sWord26 & CSt
05969  |'                                    sMyr & sWord2||05966  |'                                    sMyr & sWord2
05970  |'                            Case cNzd            ||05967  |'                            Case cNzd            
05971  |'                                .Cells(39, 13).Va||05968  |'                                .Cells(39, 13).Va
05972  |'                                    sWord26 & CSt||05969  |'                                    sWord26 & CSt
05973  |'                                    sNzd & sWord2||05970  |'                                    sNzd & sWord2
05974  |'                            Case cSek            ||05971  |'                            Case cSek            
05975  |'                                .Cells(39, 13).Va||05972  |'                                .Cells(39, 13).Va
05976  |'                                    sWord26 & CSt||05973  |'                                    sWord26 & CSt
05977  |'                                    sSek & sWord2||05974  |'                                    sSek & sWord2
05978  |'                            Case cSgd            ||05975  |'                            Case cSgd            
05979  |'                                .Cells(39, 13).Va||05976  |'                                .Cells(39, 13).Va
05980  |'                                    sWord26 & CSt||05977  |'                                    sWord26 & CSt
05981  |'                                    sSgd & sWord2||05978  |'                                    sSgd & sWord2
05982  |'                            Case cUsd            ||05979  |'                            Case cUsd            
05983  |'                                .Cells(39, 13).Va||05980  |'                                .Cells(39, 13).Va
05984  |'                                    sWord26 & CSt||05981  |'                                    sWord26 & CSt
05985  |'                                    sUsd & sWord2||05982  |'                                    sUsd & sWord2
05986  |'                            Case cNok            ||05983  |'                            Case cNok            
05987  |'                                .Cells(39, 13).Va||05984  |'                                .Cells(39, 13).Va
05988  |'                                    sWord26 & CSt||05985  |'                                    sWord26 & CSt
05989  |'                                    sNok & sWord2||05986  |'                                    sNok & sWord2
05990  |'                        End Select               ||05987  |'                        End Select               
05991  |''2005/01/12 End                                  ||05988  |''2005/01/12 End                                  
05992  |'                        '年率　累積値セット      ||05989  |'                        '年率　累積値セット      
05993  |'                        TotalRate = CCur(gbuOther||05990  |'                        TotalRate = CCur(gbuOther
05994  |'                    ElseIf i = UBound(gbuOtherCom||05991  |'                    ElseIf i = UBound(gbuOtherCom
05995  |'                        If UBound(gbuOtherComRate||05992  |'                        If UBound(gbuOtherComRate
05996  |'                            '年率最終行          ||05993  |'                            '年率最終行          
05997  |''2005/01/12 Start                                ||05994  |''2005/01/12 Start                                
05998  |'                            '前半金額部分        ||05995  |'                            '前半金額部分        
05999  |'                            .Cells(39 + i + 2, 23||05996  |'                            .Cells(39 + i + 2, 23
06000  |''                            .Cells(39 + i + 2, 2||05997  |''                            .Cells(39 + i + 2, 2
06001  |''2005/01/20 Start                                ||05998  |''2005/01/20 Start                                
06002  |''                            .Cells(39 + i + 2, 2||05999  |''                            .Cells(39 + i + 2, 2
06003  |'                            If gbuMGetUPDRec.N(lR||06000  |'                            If gbuMGetUPDRec.N(lR
06004  |'                                .Cells(39 + i + 2||06001  |'                                .Cells(39 + i + 2
06005  |'                            Else                 ||06002  |'                            Else                 
06006  |'                                .Cells(39 + i + 2||06003  |'                                .Cells(39 + i + 2
06007  |'                            End If               ||06004  |'                            End If               
06008  |''2005/01/20 End                                  ||06005  |''2005/01/20 End                                  
06009  |'                            .Cells(39 + i + 2, 23||06006  |'                            .Cells(39 + i + 2, 23
06010  |''                            '前半金額部分       ||06007  |''                            '前半金額部分       
06011  |''                            .Cells(39 + i + 2, 2||06008  |''                            .Cells(39 + i + 2, 2
06012  |''                            .Cells(39 + i + 2, 2||06009  |''                            .Cells(39 + i + 2, 2
06013  |''                            .Cells(39 + i + 2, 2||06010  |''                            .Cells(39 + i + 2, 2
06014  |''2005/01/12 End                                  ||06011  |''2005/01/12 End                                  
06015  |'    '                        '年率　累積値セット ||06012  |'    '                        '年率　累積値セット 
06016  |'    '                        TotalRate = TotalRat||06013  |'    '                        TotalRate = TotalRat
06017  |'                            '後半の文言          ||06014  |'                            '後半の文言          
06018  |''2005/01/12 Start                                ||06015  |''2005/01/12 Start                                
06019  |''                            .Cells(39 + i + 2, 2||06016  |''                            .Cells(39 + i + 2, 2
06020  |''                                sWord31 & Format||06017  |''                                sWord31 & Format
06021  |'                            Select Case gbuMGetUP||06018  |'                            Select Case gbuMGetUP
06022  |'                                Case cAud        ||06019  |'                                Case cAud        
06023  |'                                    .Cells(39 + i||06020  |'                                    .Cells(39 + i
06024  |'                                        sAud & sW||06021  |'                                        sAud & sW
06025  |'                                Case cCad        ||06022  |'                                Case cCad        
06026  |'                                    .Cells(39 + i||06023  |'                                    .Cells(39 + i
06027  |'                                        sCad & sW||06024  |'                                        sCad & sW
06028  |'                                Case cChf        ||06025  |'                                Case cChf        
06029  |'                                    .Cells(39 + i||06026  |'                                    .Cells(39 + i
06030  |'                                        sChf & sW||06027  |'                                        sChf & sW
06031  |'                                Case cEur        ||06028  |'                                Case cEur        
06032  |'                                    .Cells(39 + i||06029  |'                                    .Cells(39 + i
06033  |'                                        sEur & sW||06030  |'                                        sEur & sW
06034  |'                                Case cGbp        ||06031  |'                                Case cGbp        
06035  |'                                    .Cells(39 + i||06032  |'                                    .Cells(39 + i
06036  |'                                        sGbp & sW||06033  |'                                        sGbp & sW
06037  |'                                Case cHkd        ||06034  |'                                Case cHkd        
06038  |'                                    .Cells(39 + i||06035  |'                                    .Cells(39 + i
06039  |'                                        sHkd & sW||06036  |'                                        sHkd & sW
06040  |'                                Case cJpy        ||06037  |'                                Case cJpy        
06041  |'                                    .Cells(39 + i||06038  |'                                    .Cells(39 + i
06042  |'                                        sYen & sW||06039  |'                                        sYen & sW
06043  |'                                Case cMyr        ||06040  |'                                Case cMyr        
06044  |'                                    .Cells(39 + i||06041  |'                                    .Cells(39 + i
06045  |'                                        sMyr & sW||06042  |'                                        sMyr & sW
06046  |'                                Case cNzd        ||06043  |'                                Case cNzd        
06047  |'                                    .Cells(39 + i||06044  |'                                    .Cells(39 + i
06048  |'                                        sNzd & sW||06045  |'                                        sNzd & sW
06049  |'                                Case cSek        ||06046  |'                                Case cSek        
06050  |'                                    .Cells(39 + i||06047  |'                                    .Cells(39 + i
06051  |'                                        sSek & sW||06048  |'                                        sSek & sW
06052  |'                                Case cSgd        ||06049  |'                                Case cSgd        
06053  |'                                    .Cells(39 + i||06050  |'                                    .Cells(39 + i
06054  |'                                        sSgd & sW||06051  |'                                        sSgd & sW
06055  |'                                Case cUsd        ||06052  |'                                Case cUsd        
06056  |'                                    .Cells(39 + i||06053  |'                                    .Cells(39 + i
06057  |'                                        sUsd & sW||06054  |'                                        sUsd & sW
06058  |'                                Case cNok        ||06055  |'                                Case cNok        
06059  |'                                    .Cells(39 + i||06056  |'                                    .Cells(39 + i
06060  |'                                        sNok & sW||06057  |'                                        sNok & sW
06061  |'                            End Select           ||06058  |'                            End Select           
06062  |''2005/01/12 End                                  ||06059  |''2005/01/12 End                                  
06063  |'                        Else                     ||06060  |'                        Else                     
06064  |'                            '年率最終行          ||06061  |'                            '年率最終行          
06065  |''2005/01/12 Start                                ||06062  |''2005/01/12 Start                                
06066  |'                            '前半金額部分        ||06063  |'                            '前半金額部分        
06067  |'                            .Cells(39 + i + 1, 23||06064  |'                            .Cells(39 + i + 1, 23
06068  |''                            .Cells(39 + i + 1, 2||06065  |''                            .Cells(39 + i + 1, 2
06069  |''2005/01/20 Start                                ||06066  |''2005/01/20 Start                                
06070  |''                            .Cells(39 + i + 1, 2||06067  |''                            .Cells(39 + i + 1, 2
06071  |'                            If gbuMGetUPDRec.N(lR||06068  |'                            If gbuMGetUPDRec.N(lR
06072  |'                                .Cells(39 + i + 1||06069  |'                                .Cells(39 + i + 1
06073  |'                            Else                 ||06070  |'                            Else                 
06074  |'                                .Cells(39 + i + 1||06071  |'                                .Cells(39 + i + 1
06075  |'                            End If               ||06072  |'                            End If               
06076  |''2005/01/20 End                                  ||06073  |''2005/01/20 End                                  
06077  |'                            .Cells(39 + i + 1, 23||06074  |'                            .Cells(39 + i + 1, 23
06078  |''                            '前半金額部分       ||06075  |''                            '前半金額部分       
06079  |''                            .Cells(39 + i + 1, 2||06076  |''                            .Cells(39 + i + 1, 2
06080  |''                            .Cells(39 + i + 1, 2||06077  |''                            .Cells(39 + i + 1, 2
06081  |''                            .Cells(39 + i + 1, 2||06078  |''                            .Cells(39 + i + 1, 2
06082  |''2005/01/12 End                                  ||06079  |''2005/01/12 End                                  
06083  |'    '                        '年率　累積値セット ||06080  |'    '                        '年率　累積値セット 
06084  |'    '                        TotalRate = TotalRat||06081  |'    '                        TotalRate = TotalRat
06085  |'                            '後半の文言          ||06082  |'                            '後半の文言          
06086  |''2005/01/12 Start                                ||06083  |''2005/01/12 Start                                
06087  |''                            .Cells(39 + i + 1, 2||06084  |''                            .Cells(39 + i + 1, 2
06088  |''                                sWord31 & Format||06085  |''                                sWord31 & Format
06089  |'                            Select Case gbuMGetUP||06086  |'                            Select Case gbuMGetUP
06090  |'                                Case cAud        ||06087  |'                                Case cAud        
06091  |'                                    .Cells(39 + i||06088  |'                                    .Cells(39 + i
06092  |'                                        sAud & sW||06089  |'                                        sAud & sW
06093  |'                                Case cCad        ||06090  |'                                Case cCad        
06094  |'                                    .Cells(39 + i||06091  |'                                    .Cells(39 + i
06095  |'                                        sCad & sW||06092  |'                                        sCad & sW
06096  |'                                Case cChf        ||06093  |'                                Case cChf        
06097  |'                                    .Cells(39 + i||06094  |'                                    .Cells(39 + i
06098  |'                                        sChf & sW||06095  |'                                        sChf & sW
06099  |'                                Case cEur        ||06096  |'                                Case cEur        
06100  |'                                    .Cells(39 + i||06097  |'                                    .Cells(39 + i
06101  |'                                        sEur & sW||06098  |'                                        sEur & sW
06102  |'                                Case cGbp        ||06099  |'                                Case cGbp        
06103  |'                                    .Cells(39 + i||06100  |'                                    .Cells(39 + i
06104  |'                                        sGbp & sW||06101  |'                                        sGbp & sW
06105  |'                                Case cHkd        ||06102  |'                                Case cHkd        
06106  |'                                    .Cells(39 + i||06103  |'                                    .Cells(39 + i
06107  |'                                        sHkd & sW||06104  |'                                        sHkd & sW
06108  |'                                Case cJpy        ||06105  |'                                Case cJpy        
06109  |'                                    .Cells(39 + i||06106  |'                                    .Cells(39 + i
06110  |'                                        sYen & sW||06107  |'                                        sYen & sW
06111  |'                                Case cMyr        ||06108  |'                                Case cMyr        
06112  |'                                    .Cells(39 + i||06109  |'                                    .Cells(39 + i
06113  |'                                        sMyr & sW||06110  |'                                        sMyr & sW
06114  |'                                Case cNzd        ||06111  |'                                Case cNzd        
06115  |'                                    .Cells(39 + i||06112  |'                                    .Cells(39 + i
06116  |'                                        sNzd & sW||06113  |'                                        sNzd & sW
06117  |'                                Case cSek        ||06114  |'                                Case cSek        
06118  |'                                    .Cells(39 + i||06115  |'                                    .Cells(39 + i
06119  |'                                        sSek & sW||06116  |'                                        sSek & sW
06120  |'                                Case cSgd        ||06117  |'                                Case cSgd        
06121  |'                                    .Cells(39 + i||06118  |'                                    .Cells(39 + i
06122  |'                                        sSgd & sW||06119  |'                                        sSgd & sW
06123  |'                                Case cUsd        ||06120  |'                                Case cUsd        
06124  |'                                    .Cells(39 + i||06121  |'                                    .Cells(39 + i
06125  |'                                        sUsd & sW||06122  |'                                        sUsd & sW
06126  |'                                Case cNok        ||06123  |'                                Case cNok        
06127  |'                                    .Cells(39 + i||06124  |'                                    .Cells(39 + i
06128  |'                                        sNok & sW||06125  |'                                        sNok & sW
06129  |'                            End Select           ||06126  |'                            End Select           
06130  |''2005/01/12 End                                  ||06127  |''2005/01/12 End                                  
06131  |'                        End If                   ||06128  |'                        End If                   
06132  |'                    Else                         ||06129  |'                    Else                         
06133  |'                        '年率2行目以降           ||06130  |'                        '年率2行目以降           
06134  |''2005/01/12 Start                                ||06131  |''2005/01/12 Start                                
06135  |'                        '前半金額部分            ||06132  |'                        '前半金額部分            
06136  |'                        .Cells(39 + i + 1, 23).Nu||06133  |'                        .Cells(39 + i + 1, 23).Nu
06137  |''                        .Cells(39 + i + 1, 23).V||06134  |''                        .Cells(39 + i + 1, 23).V
06138  |''2005/01/20 Start                                ||06135  |''2005/01/20 Start                                
06139  |''                        .Cells(39 + i + 1, 23).V||06136  |''                        .Cells(39 + i + 1, 23).V
06140  |'                        If gbuMGetUPDRec.N(lRecId||06137  |'                        If gbuMGetUPDRec.N(lRecId
06141  |'                            .Cells(39 + i + 1, 23||06138  |'                            .Cells(39 + i + 1, 23
06142  |'                        Else                     ||06139  |'                        Else                     
06143  |'                            .Cells(39 + i + 1, 23||06140  |'                            .Cells(39 + i + 1, 23
06144  |'                        End If                   ||06141  |'                        End If                   
06145  |''2005/01/20 End                                  ||06142  |''2005/01/20 End                                  
06146  |'                        .Cells(39 + i + 1, 23).Ho||06143  |'                        .Cells(39 + i + 1, 23).Ho
06147  |''                        '前半金額部分           ||06144  |''                        '前半金額部分           
06148  |''                        .Cells(39 + i + 1, 21).N||06145  |''                        .Cells(39 + i + 1, 21).N
06149  |''                        .Cells(39 + i + 1, 21).V||06146  |''                        .Cells(39 + i + 1, 21).V
06150  |''                        .Cells(39 + i + 1, 21).H||06147  |''                        .Cells(39 + i + 1, 21).H
06151  |''2005/01/12 End                                  ||06148  |''2005/01/12 End                                  
06152  |'                        '年率　累積値セット      ||06149  |'                        '年率　累積値セット      
06153  |'                        TotalRate = TotalRate + C||06150  |'                        TotalRate = TotalRate + C
06154  |'                        '後半の文言              ||06151  |'                        '後半の文言              
06155  |''2005/01/12 Start                                ||06152  |''2005/01/12 Start                                
06156  |''                        .Cells(39 + i + 1, 24).V||06153  |''                        .Cells(39 + i + 1, 24).V
06157  |''                            sWord29 & CStr(Forma||06154  |''                            sWord29 & CStr(Forma
06158  |''                            Format(gbuOtherComRa||06155  |''                            Format(gbuOtherComRa
06159  |'                        Select Case gbuMGetUPDRec||06156  |'                        Select Case gbuMGetUPDRec
06160  |'                            Case cAud            ||06157  |'                            Case cAud            
06161  |'                                .Cells(39 + i + 1||06158  |'                                .Cells(39 + i + 1
06162  |'                                    sAud & sWord2||06159  |'                                    sAud & sWord2
06163  |'                                    Format(gbuOth||06160  |'                                    Format(gbuOth
06164  |'                            Case cCad            ||06161  |'                            Case cCad            
06165  |'                                .Cells(39 + i + 1||06162  |'                                .Cells(39 + i + 1
06166  |'                                    sCad & sWord2||06163  |'                                    sCad & sWord2
06167  |'                                    Format(gbuOth||06164  |'                                    Format(gbuOth
06168  |'                            Case cChf            ||06165  |'                            Case cChf            
06169  |'                                .Cells(39 + i + 1||06166  |'                                .Cells(39 + i + 1
06170  |'                                    sChf & sWord2||06167  |'                                    sChf & sWord2
06171  |'                                    Format(gbuOth||06168  |'                                    Format(gbuOth
06172  |'                            Case cEur            ||06169  |'                            Case cEur            
06173  |'                                .Cells(39 + i + 1||06170  |'                                .Cells(39 + i + 1
06174  |'                                    sEur & sWord2||06171  |'                                    sEur & sWord2
06175  |'                                    Format(gbuOth||06172  |'                                    Format(gbuOth
06176  |'                            Case cGbp            ||06173  |'                            Case cGbp            
06177  |'                                .Cells(39 + i + 1||06174  |'                                .Cells(39 + i + 1
06178  |'                                    sGbp & sWord2||06175  |'                                    sGbp & sWord2
06179  |'                                    Format(gbuOth||06176  |'                                    Format(gbuOth
06180  |'                            Case cHkd            ||06177  |'                            Case cHkd            
06181  |'                                .Cells(39 + i + 1||06178  |'                                .Cells(39 + i + 1
06182  |'                                    sHkd & sWord2||06179  |'                                    sHkd & sWord2
06183  |'                                    Format(gbuOth||06180  |'                                    Format(gbuOth
06184  |'                            Case cJpy            ||06181  |'                            Case cJpy            
06185  |'                                .Cells(39 + i + 1||06182  |'                                .Cells(39 + i + 1
06186  |'                                    sYen & sWord2||06183  |'                                    sYen & sWord2
06187  |'                                    Format(gbuOth||06184  |'                                    Format(gbuOth
06188  |'                            Case cMyr            ||06185  |'                            Case cMyr            
06189  |'                                .Cells(39 + i + 1||06186  |'                                .Cells(39 + i + 1
06190  |'                                    sMyr & sWord2||06187  |'                                    sMyr & sWord2
06191  |'                                    Format(gbuOth||06188  |'                                    Format(gbuOth
06192  |'                            Case cNzd            ||06189  |'                            Case cNzd            
06193  |'                                .Cells(39 + i + 1||06190  |'                                .Cells(39 + i + 1
06194  |'                                    sNzd & sWord2||06191  |'                                    sNzd & sWord2
06195  |'                                    Format(gbuOth||06192  |'                                    Format(gbuOth
06196  |'                            Case cSek            ||06193  |'                            Case cSek            
06197  |'                                .Cells(39 + i + 1||06194  |'                                .Cells(39 + i + 1
06198  |'                                    sSek & sWord2||06195  |'                                    sSek & sWord2
06199  |'                                    Format(gbuOth||06196  |'                                    Format(gbuOth
06200  |'                            Case cSgd            ||06197  |'                            Case cSgd            
06201  |'                                .Cells(39 + i + 1||06198  |'                                .Cells(39 + i + 1
06202  |'                                    sSgd & sWord2||06199  |'                                    sSgd & sWord2
06203  |'                                    Format(gbuOth||06200  |'                                    Format(gbuOth
06204  |'                            Case cUsd            ||06201  |'                            Case cUsd            
06205  |'                                .Cells(39 + i + 1||06202  |'                                .Cells(39 + i + 1
06206  |'                                    sUsd & sWord2||06203  |'                                    sUsd & sWord2
06207  |'                                    Format(gbuOth||06204  |'                                    Format(gbuOth
06208  |'                            Case cNok            ||06205  |'                            Case cNok            
06209  |'                                .Cells(39 + i + 1||06206  |'                                .Cells(39 + i + 1
06210  |'                                    sNok & sWord2||06207  |'                                    sNok & sWord2
06211  |'                                    Format(gbuOth||06208  |'                                    Format(gbuOth
06212  |'                        End Select               ||06209  |'                        End Select               
06213  |''2005/01/12 End                                  ||06210  |''2005/01/12 End                                  
06214  |'                    End If                       ||06211  |'                    End If                       
06215  |'                Next i                           ||06212  |'                Next i                           
06216  |'            End If                               ||06213  |'            End If                               
06217  |'        End If                                   ||06214  |'        End If                                   
06218  |'                                                 ||06215  |'                                                 
06219  |'        '投資顧問料                              ||06216  |'        '投資顧問料                              
06220  |''2004/09/10 Start                                ||06217  |''2004/09/10 Start                                
06221  |''        .Cells(46, 2).Value = sWord11           ||06218  |''        .Cells(46, 2).Value = sWord11           
06222  |''        .Cells(46, 10).Value = sWord19          ||06219  |''        .Cells(46, 10).Value = sWord19          
06223  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).||06220  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).
06224  |'            Case Mid(mstrContractFlag(1), 1, 1)  ||06221  |'            Case Mid(mstrContractFlag(1), 1, 1)  
06225  |'                .Cells(46, 2).Value = sWord11a   ||06222  |'                .Cells(46, 2).Value = sWord11a   
06226  |'            Case Mid(mstrContractFlag(2), 1, 1)  ||06223  |'            Case Mid(mstrContractFlag(2), 1, 1)  
06227  |'                .Cells(46, 2).Value = sWord11b   ||06224  |'                .Cells(46, 2).Value = sWord11b   
06228  |'            Case Mid(mstrContractFlag(3), 1, 1)  ||06225  |'            Case Mid(mstrContractFlag(3), 1, 1)  
06229  |'                .Cells(46, 2).Value = sWord11c   ||06226  |'                .Cells(46, 2).Value = sWord11c   
06230  |'            Case Else                            ||06227  |'            Case Else                            
06231  |'                MsgBox "契約区分が不正です。", vb||06228  |'                MsgBox "契約区分が不正です。", vb
06232  |'        End Select                               ||06229  |'        End Select                               
06233  |'        .Cells(46, 11).Value = sWord19           ||06230  |'        .Cells(46, 11).Value = sWord19           
06234  |''2004/09/10 End                                  ||06231  |''2004/09/10 End                                  
06235  |'                                                 ||06232  |'                                                 
06236  |''2005/01/12 Start                                ||06233  |''2005/01/12 Start                                
06237  |'        '外部委託顧問料                          ||06234  |'        '外部委託顧問料                          
06238  |''        .Cells(46, 30).NumberFormatLocal = "@"  ||06235  |''        .Cells(46, 30).NumberFormatLocal = "@"  
06239  |''2005/01/20 Start                                ||06236  |''2005/01/20 Start                                
06240  |''        .Cells(46, 31).NumberFormatLocal = "@"  ||06237  |''        .Cells(46, 31).NumberFormatLocal = "@"  
06241  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||06238  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
06242  |'            .Cells(46, 31).NumberFormatLocal = "@||06239  |'            .Cells(46, 31).NumberFormatLocal = "@
06243  |'        Else                                     ||06240  |'        Else                                     
06244  |'            .Cells(46, 29).NumberFormatLocal = "@||06241  |'            .Cells(46, 29).NumberFormatLocal = "@
06245  |'        End If                                   ||06242  |'        End If                                   
06246  |''2005/01/20 End                                  ||06243  |''2005/01/20 End                                  
06247  |'        '契約区分が名称使用許諾料の場合上限・下限||06244  |'        '契約区分が名称使用許諾料の場合上限・下限
06248  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||06245  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
06249  |'            '下限金額より換算した金額が小さい場合||06246  |'            '下限金額より換算した金額が小さい場合
06250  |'            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_||06247  |'            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_
06251  |'                If mstrMonthlyPayCom < CDbl(gbuMG||06248  |'                If mstrMonthlyPayCom < CDbl(gbuMG
06252  |'                    mstrMonthlyPayCom = CDbl(gbuM||06249  |'                    mstrMonthlyPayCom = CDbl(gbuM
06253  |'                End If                           ||06250  |'                End If                           
06254  |'            End If                               ||06251  |'            End If                               
06255  |'            '上限金額より換算した金額が大きい場合||06252  |'            '上限金額より換算した金額が大きい場合
06256  |'            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_||06253  |'            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_
06257  |'                If mstrMonthlyPayCom > CDbl(gbuMG||06254  |'                If mstrMonthlyPayCom > CDbl(gbuMG
06258  |'                    mstrMonthlyPayCom = CDbl(gbuM||06255  |'                    mstrMonthlyPayCom = CDbl(gbuM
06259  |'                End If                           ||06256  |'                End If                           
06260  |'            End If                               ||06257  |'            End If                               
06261  |''2005/01/20 Start                                ||06258  |''2005/01/20 Start                                
06262  |'            dblValueIn = CDbl(mstrMonthlyPayCom) ||06259  |'            dblValueIn = CDbl(mstrMonthlyPayCom) 
06263  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou||06260  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou
06264  |'                Call sbGetRoundValue2(dblValueIn)||06261  |'                Call sbGetRoundValue2(dblValueIn)
06265  |'            Else                                 ||06262  |'            Else                                 
06266  |'                Call sbGetRoundValue(dblValueIn) ||06263  |'                Call sbGetRoundValue(dblValueIn) 
06267  |'            End If                               ||06264  |'            End If                               
06268  |'            mstrMonthlyPayCom = dblValueOut      ||06265  |'            mstrMonthlyPayCom = dblValueOut      
06269  |''2005/01/20 End                                  ||06266  |''2005/01/20 End                                  
06270  |'        End If                                   ||06267  |'        End If                                   
06271  |'                                                 ||06268  |'                                                 
06272  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET||06269  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET
06273  |'            Case cAud                            ||06270  |'            Case cAud                            
06274  |'                .Cells(46, 31).Value = CStr(Forma||06271  |'                .Cells(46, 31).Value = CStr(Forma
06275  |'                .Cells(46, 32).Value = sAud      ||06272  |'                .Cells(46, 32).Value = sAud      
06276  |'            Case cCad                            ||06273  |'            Case cCad                            
06277  |'                .Cells(46, 31).Value = CStr(Forma||06274  |'                .Cells(46, 31).Value = CStr(Forma
06278  |'                .Cells(46, 32).Value = sCad      ||06275  |'                .Cells(46, 32).Value = sCad      
06279  |'            Case cChf                            ||06276  |'            Case cChf                            
06280  |'                .Cells(46, 31).Value = CStr(Forma||06277  |'                .Cells(46, 31).Value = CStr(Forma
06281  |'                .Cells(46, 32).Value = sChf      ||06278  |'                .Cells(46, 32).Value = sChf      
06282  |'            Case cEur                            ||06279  |'            Case cEur                            
06283  |'                .Cells(46, 31).Value = CStr(Forma||06280  |'                .Cells(46, 31).Value = CStr(Forma
06284  |'                .Cells(46, 32).Value = sEur      ||06281  |'                .Cells(46, 32).Value = sEur      
06285  |'            Case cGbp                            ||06282  |'            Case cGbp                            
06286  |'                .Cells(46, 31).Value = CStr(Forma||06283  |'                .Cells(46, 31).Value = CStr(Forma
06287  |'                .Cells(46, 32).Value = sGbp      ||06284  |'                .Cells(46, 32).Value = sGbp      
06288  |'            Case cHkd                            ||06285  |'            Case cHkd                            
06289  |'                .Cells(46, 31).Value = CStr(Forma||06286  |'                .Cells(46, 31).Value = CStr(Forma
06290  |'                .Cells(46, 32).Value = sHkd      ||06287  |'                .Cells(46, 32).Value = sHkd      
06291  |'            Case cJpy                            ||06288  |'            Case cJpy                            
06292  |'                .Cells(46, 29).Value = CStr(Forma||06289  |'                .Cells(46, 29).Value = CStr(Forma
06293  |'                .Cells(46, 32).Value = sYen      ||06290  |'                .Cells(46, 32).Value = sYen      
06294  |'            Case cMyr                            ||06291  |'            Case cMyr                            
06295  |'                .Cells(46, 31).Value = CStr(Forma||06292  |'                .Cells(46, 31).Value = CStr(Forma
06296  |'                .Cells(46, 32).Value = sMyr      ||06293  |'                .Cells(46, 32).Value = sMyr      
06297  |'            Case cNzd                            ||06294  |'            Case cNzd                            
06298  |'                .Cells(46, 31).Value = CStr(Forma||06295  |'                .Cells(46, 31).Value = CStr(Forma
06299  |'                .Cells(46, 32).Value = sNzd      ||06296  |'                .Cells(46, 32).Value = sNzd      
06300  |'            Case cSek                            ||06297  |'            Case cSek                            
06301  |'                .Cells(46, 31).Value = CStr(Forma||06298  |'                .Cells(46, 31).Value = CStr(Forma
06302  |'                .Cells(46, 32).Value = sSek      ||06299  |'                .Cells(46, 32).Value = sSek      
06303  |'            Case cSgd                            ||06300  |'            Case cSgd                            
06304  |'                .Cells(46, 31).Value = CStr(Forma||06301  |'                .Cells(46, 31).Value = CStr(Forma
06305  |'                .Cells(46, 32).Value = sSgd      ||06302  |'                .Cells(46, 32).Value = sSgd      
06306  |'            Case cUsd                            ||06303  |'            Case cUsd                            
06307  |'                .Cells(46, 31).Value = CStr(Forma||06304  |'                .Cells(46, 31).Value = CStr(Forma
06308  |'                .Cells(46, 32).Value = sUsd      ||06305  |'                .Cells(46, 32).Value = sUsd      
06309  |'            Case cNok                            ||06306  |'            Case cNok                            
06310  |'                .Cells(46, 31).Value = CStr(Forma||06307  |'                .Cells(46, 31).Value = CStr(Forma
06311  |'                .Cells(46, 32).Value = sNok      ||06308  |'                .Cells(46, 32).Value = sNok      
06312  |'        End Select                               ||06309  |'        End Select                               
06313  |'                                                 ||06310  |'                                                 
06314  |'        '顧問料                                  ||06311  |'        '顧問料                                  
06315  |''        .Cells(46, 30).HorizontalAlignment = xlR||06312  |''        .Cells(46, 30).HorizontalAlignment = xlR
06316  |''2005/01/20 Start                                ||06313  |''2005/01/20 Start                                
06317  |''        .Cells(46, 31).HorizontalAlignment = xlR||06314  |''        .Cells(46, 31).HorizontalAlignment = xlR
06318  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||06315  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
06319  |'            .Cells(46, 31).HorizontalAlignment = ||06316  |'            .Cells(46, 31).HorizontalAlignment = 
06320  |'        Else                                     ||06317  |'        Else                                     
06321  |'            .Cells(46, 29).HorizontalAlignment = ||06318  |'            .Cells(46, 29).HorizontalAlignment = 
06322  |'        End If                                   ||06319  |'        End If                                   
06323  |''2005/01/20 End                                  ||06320  |''2005/01/20 End                                  
06324  |'                                                 ||06321  |'                                                 
06325  |'        '契約区分が名称使用許諾料の場合上限・下限||06322  |'        '契約区分が名称使用許諾料の場合上限・下限
06326  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||06323  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
06327  |'            '上限金額                            ||06324  |'            '上限金額                            
06328  |'            .Cells(46, 39).Value = sWordCap      ||06325  |'            .Cells(46, 39).Value = sWordCap      
06329  |'            .Cells(46, 57).NumberFormatLocal = "@||06326  |'            .Cells(46, 57).NumberFormatLocal = "@
06330  |''2005/01/20 Start                                ||06327  |''2005/01/20 Start                                
06331  |''            .Cells(46, 57).Value = Format(gbuMGe||06328  |''            .Cells(46, 57).Value = Format(gbuMGe
06332  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou||06329  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou
06333  |'                .Cells(46, 57).Value = Format(gbu||06330  |'                .Cells(46, 57).Value = Format(gbu
06334  |'            Else                                 ||06331  |'            Else                                 
06335  |'                .Cells(46, 57).Value = Format(gbu||06332  |'                .Cells(46, 57).Value = Format(gbu
06336  |'            End If                               ||06333  |'            End If                               
06337  |''2005/01/20 End                                  ||06334  |''2005/01/20 End                                  
06338  |'            .Cells(46, 57).HorizontalAlignment = ||06335  |'            .Cells(46, 57).HorizontalAlignment = 
06339  |'            '下限金額                            ||06336  |'            '下限金額                            
06340  |'            .Cells(47, 39).Value = sWordFloor    ||06337  |'            .Cells(47, 39).Value = sWordFloor    
06341  |'            .Cells(47, 57).NumberFormatLocal = "@||06338  |'            .Cells(47, 57).NumberFormatLocal = "@
06342  |''2005/01/20 Start                                ||06339  |''2005/01/20 Start                                
06343  |''            .Cells(47, 57).Value = Format(gbuMGe||06340  |''            .Cells(47, 57).Value = Format(gbuMGe
06344  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou||06341  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou
06345  |'                .Cells(47, 57).Value = Format(gbu||06342  |'                .Cells(47, 57).Value = Format(gbu
06346  |'            Else                                 ||06343  |'            Else                                 
06347  |'                .Cells(47, 57).Value = Format(gbu||06344  |'                .Cells(47, 57).Value = Format(gbu
06348  |'            End If                               ||06345  |'            End If                               
06349  |''2005/01/20 End                                  ||06346  |''2005/01/20 End                                  
06350  |'            .Cells(47, 57).HorizontalAlignment = ||06347  |'            .Cells(47, 57).HorizontalAlignment = 
06351  |'        End If                                   ||06348  |'        End If                                   
06352  |'                                                 ||06349  |'                                                 
06353  |''2005/01/12 End                                  ||06350  |''2005/01/12 End                                  
06354  |'                                                 ||06351  |'                                                 
06355  |''2005/01/17 Start                                ||06352  |''2005/01/17 Start                                
06356  |'        ddblExchangeRate = 0                     ||06353  |'        ddblExchangeRate = 0                     
06357  |''2005/01/17 End                                  ||06354  |''2005/01/17 End                                  
06358  |''2005/01/12 Start                                ||06355  |''2005/01/12 Start                                
06359  |'        '@@@@@ 支払に換算 @@@@@                  ||06356  |'        '@@@@@ 支払に換算 @@@@@                  
06360  |''''''        dblValueIn = ddblShiharai           ||06357  |''''''        dblValueIn = ddblShiharai           
06361  |'        dblValueIn = mstrMonthlyPayCom           ||06358  |'        dblValueIn = mstrMonthlyPayCom           
06362  |'                                                 ||06359  |'                                                 
06363  |'        '2006/04/12 START K.Furuya 実払管理テーブ||06360  |'        '2006/04/12 START K.Furuya 実払管理テーブ
06364  |'        '通貨円以外の場合確定顧問料通貨を取得    ||06361  |'        '通貨円以外の場合確定顧問料通貨を取得    
06365  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||06362  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
06366  |'            WkFixComC = ""                       ||06363  |'            WkFixComC = ""                       
06367  |'            WkRealComC = ""                      ||06364  |'            WkRealComC = ""                      
06368  |'            WkFixComC = mstrMonthlyPayCom        ||06365  |'            WkFixComC = mstrMonthlyPayCom        
06369  |'            WkRealComC = mstrMonthlyPayCom       ||06366  |'            WkRealComC = mstrMonthlyPayCom       
06370  |'        End If                                   ||06367  |'        End If                                   
06371  |'        '通貨を取得                              ||06368  |'        '通貨を取得                              
06372  |'        WkCurCode = ""                           ||06369  |'        WkCurCode = ""                           
06373  |'        WkCurCode = Trim(gbuMGetUPDRec.N(lRecIdx)||06370  |'        WkCurCode = Trim(gbuMGetUPDRec.N(lRecIdx)
06374  |'        '2006/04/12 END   K.Furuya 実払管理テーブ||06371  |'        '2006/04/12 END   K.Furuya 実払管理テーブ
06375  |'                                                 ||06372  |'                                                 
06376  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET||06373  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET
06377  |'          Case "1"    '固定料率                  ||06374  |'          Case "1"    '固定料率                  
06378  |''2005/01/26 Start                                ||06375  |''2005/01/26 Start                                
06379  |''''''              'NAV通貨と外部委託顧問料通貨が||06376  |''''''              'NAV通貨と外部委託顧問料通貨が
06380  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG||06377  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG
06381  |''''''                  '外部委託顧問料通貨が円以 ||06378  |''''''                  '外部委託顧問料通貨が円以 
06382  |''''''                  If gbuMGetUPDRec.N(lRecIdx||06379  |''''''                  If gbuMGetUPDRec.N(lRecIdx
06383  |''''''                    '外部委託顧問料通貨から ||06380  |''''''                    '外部委託顧問料通貨から 
06384  |'''''''2005/01/17 Start                           ||06381  |'''''''2005/01/17 Start                           
06385  |'''''''                    dblValueIn = dblValueIn||06382  |'''''''                    dblValueIn = dblValueIn
06386  |''''''                    '外部委託顧問料通貨→JPY||06383  |''''''                    '外部委託顧問料通貨→JPY
06387  |''''''                    dstrCurrencyCode = gbuMG||06384  |''''''                    dstrCurrencyCode = gbuMG
06388  |''''''                    ddblExchangeRate = fnstr||06385  |''''''                    ddblExchangeRate = fnstr
06389  |''''''                    If ddblExchangeRate = 0 ||06386  |''''''                    If ddblExchangeRate = 0 
06390  |''''''                      intRtn = MsgBox("ＴＴ ||06387  |''''''                      intRtn = MsgBox("ＴＴ 
06391  |''''''                      vbLf & "対象通貨コード||06388  |''''''                      vbLf & "対象通貨コード
06392  |''''''                      vbLf & "基準日 ： [ " ||06389  |''''''                      vbLf & "基準日 ： [ " 
06393  |''''''                          vbCritical, "ＴＴ ||06390  |''''''                          vbCritical, "ＴＴ 
06394  |''''''                      Exit Function         ||06391  |''''''                      Exit Function         
06395  |''''''                    End If                  ||06392  |''''''                    End If                  
06396  |''''''                    '外部委託顧問料通貨→JPY||06393  |''''''                    '外部委託顧問料通貨→JPY
06397  |''''''                    dblValueIn = dblValueIn ||06394  |''''''                    dblValueIn = dblValueIn 
06398  |'''''''2005/01/17 End                             ||06395  |'''''''2005/01/17 End                             
06399  |''''''                  End If                    ||06396  |''''''                  End If                    
06400  |''''''              End If                        ||06397  |''''''              End If                        
06401  |''''''              'NAV通貨と外部委託顧問料通貨が||06398  |''''''              'NAV通貨と外部委託顧問料通貨が
06402  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG||06399  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG
06403  |''''''                  '外部委託顧問料通貨が円   ||06400  |''''''                  '外部委託顧問料通貨が円   
06404  |''''''                  If gbuMGetUPDRec.N(lRecIdx||06401  |''''''                  If gbuMGetUPDRec.N(lRecIdx
06405  |''''''                  End If                    ||06402  |''''''                  End If                    
06406  |''''''              End If                        ||06403  |''''''              End If                        
06407  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||06404  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
06408  |'                Else                             ||06405  |'                Else                             
06409  |'                  '外部委託顧問料通貨→JPYの為替 ||06406  |'                  '外部委託顧問料通貨→JPYの為替 
06410  |'                  dstrCurrencyCode = gbuMGetUPDRe||06407  |'                  dstrCurrencyCode = gbuMGetUPDRe
06411  |'                  ddblExchangeRate = fnstrExchang||06408  |'                  ddblExchangeRate = fnstrExchang
06412  |'                  If ddblExchangeRate = 0 Then   ||06409  |'                  If ddblExchangeRate = 0 Then   
06413  |'                    intRtn = MsgBox("ＴＴＭが取得||06410  |'                    intRtn = MsgBox("ＴＴＭが取得
06414  |'                    vbLf & "対象通貨コード ： [ "||06411  |'                    vbLf & "対象通貨コード ： [ "
06415  |'                    vbLf & "基準日 ： [ " & Mid(d||06412  |'                    vbLf & "基準日 ： [ " & Mid(d
06416  |'                        vbCritical, "ＴＴＭ取得エ||06413  |'                        vbCritical, "ＴＴＭ取得エ
06417  |'                    Exit Function                ||06414  |'                    Exit Function                
06418  |'                  End If                         ||06415  |'                  End If                         
06419  |'                  'JPY→支払通貨へレート換算     ||06416  |'                  'JPY→支払通貨へレート換算     
06420  |'                  dblValueIn = dblValueIn * ddblE||06417  |'                  dblValueIn = dblValueIn * ddblE
06421  |'                End If                           ||06418  |'                End If                           
06422  |''2005/01/26 End                                  ||06419  |''2005/01/26 End                                  
06423  |'          Case "2"    '段階料率                  ||06420  |'          Case "2"    '段階料率                  
06424  |''2005/01/26 Start                                ||06421  |''2005/01/26 Start                                
06425  |''''''              'NAV通貨と閾値通貨が相違      ||06422  |''''''              'NAV通貨と閾値通貨が相違      
06426  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG||06423  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG
06427  |''''''                  '閾値通貨と外部委託顧問料 ||06424  |''''''                  '閾値通貨と外部委託顧問料 
06428  |''''''                  If gbuMGetUPDRec.N(lRecIdx||06425  |''''''                  If gbuMGetUPDRec.N(lRecIdx
06429  |''''''                      '外部委託顧問料通貨が ||06426  |''''''                      '外部委託顧問料通貨が 
06430  |''''''                      If gbuMGetUPDRec.N(lRe||06427  |''''''                      If gbuMGetUPDRec.N(lRe
06431  |''''''                        '外部委託顧問料通貨 ||06428  |''''''                        '外部委託顧問料通貨 
06432  |'''''''2005/01/17 Start                           ||06429  |'''''''2005/01/17 Start                           
06433  |'''''''                        dblValueIn = dblVal||06430  |'''''''                        dblValueIn = dblVal
06434  |''''''                        '外部委託顧問料通貨 ||06431  |''''''                        '外部委託顧問料通貨 
06435  |''''''                        dstrCurrencyCode = g||06432  |''''''                        dstrCurrencyCode = g
06436  |''''''                        ddblExchangeRate = f||06433  |''''''                        ddblExchangeRate = f
06437  |''''''                        If ddblExchangeRate ||06434  |''''''                        If ddblExchangeRate 
06438  |''''''                          intRtn = MsgBox(" ||06435  |''''''                          intRtn = MsgBox(" 
06439  |''''''                          vbLf & "対象通貨コ||06436  |''''''                          vbLf & "対象通貨コ
06440  |''''''                          vbLf & "基準日 ： ||06437  |''''''                          vbLf & "基準日 ： 
06441  |''''''                              vbCritical, " ||06438  |''''''                              vbCritical, " 
06442  |''''''                          Exit Function     ||06439  |''''''                          Exit Function     
06443  |''''''                        End If              ||06440  |''''''                        End If              
06444  |''''''                        '外部委託顧問料通貨 ||06441  |''''''                        '外部委託顧問料通貨 
06445  |''''''                        dblValueIn = dblValu||06442  |''''''                        dblValueIn = dblValu
06446  |'''''''2005/01/17 End                             ||06443  |'''''''2005/01/17 End                             
06447  |''''''                      End If                ||06444  |''''''                      End If                
06448  |''''''                  End If                    ||06445  |''''''                  End If                    
06449  |''''''              End If                        ||06446  |''''''              End If                        
06450  |''''''              'NAV通貨と閾値通貨が相違      ||06447  |''''''              'NAV通貨と閾値通貨が相違      
06451  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG||06448  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG
06452  |''''''                  '閾値通貨と外部委託顧問料 ||06449  |''''''                  '閾値通貨と外部委託顧問料 
06453  |''''''                  If gbuMGetUPDRec.N(lRecIdx||06450  |''''''                  If gbuMGetUPDRec.N(lRecIdx
06454  |''''''                      '外部委託顧問料通貨が ||06451  |''''''                      '外部委託顧問料通貨が 
06455  |''''''                      If gbuMGetUPDRec.N(lRe||06452  |''''''                      If gbuMGetUPDRec.N(lRe
06456  |''''''                      End If                ||06453  |''''''                      End If                
06457  |''''''                  End If                    ||06454  |''''''                  End If                    
06458  |''''''              End If                        ||06455  |''''''              End If                        
06459  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe||06456  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe
06460  |'            Else                                 ||06457  |'            Else                                 
06461  |'                '外部委託顧問料通貨→JPYの為替レ ||06458  |'                '外部委託顧問料通貨→JPYの為替レ 
06462  |'                dstrCurrencyCode = gbuMGetUPDRec.||06459  |'                dstrCurrencyCode = gbuMGetUPDRec.
06463  |'                ddblExchangeRate = fnstrExchangeR||06460  |'                ddblExchangeRate = fnstrExchangeR
06464  |'                If ddblExchangeRate = 0 Then     ||06461  |'                If ddblExchangeRate = 0 Then     
06465  |'                  intRtn = MsgBox("ＴＴＭが取得で||06462  |'                  intRtn = MsgBox("ＴＴＭが取得で
06466  |'                  vbLf & "対象通貨コード ： [ " &||06463  |'                  vbLf & "対象通貨コード ： [ " &
06467  |'                  vbLf & "基準日 ： [ " & Mid(dst||06464  |'                  vbLf & "基準日 ： [ " & Mid(dst
06468  |'                      vbCritical, "ＴＴＭ取得エラ||06465  |'                      vbCritical, "ＴＴＭ取得エラ
06469  |'                  Exit Function                  ||06466  |'                  Exit Function                  
06470  |'                End If                           ||06467  |'                End If                           
06471  |'                '外部委託顧問料通貨→JPYへレート ||06468  |'                '外部委託顧問料通貨→JPYへレート 
06472  |'                dblValueIn = dblValueIn * ddblExc||06469  |'                dblValueIn = dblValueIn * ddblExc
06473  |'            End If                               ||06470  |'            End If                               
06474  |''2005/01/26 End                                  ||06471  |''2005/01/26 End                                  
06475  |'        End Select                               ||06472  |'        End Select                               
06476  |'        '@@@@@ 支払に換算 @@@@@                  ||06473  |'        '@@@@@ 支払に換算 @@@@@                  
06477  |'        Call sbGetRoundValue(dblValueIn)         ||06474  |'        Call sbGetRoundValue(dblValueIn)         
06478  |'        mstrMonthlyPayCom = dblValueOut          ||06475  |'        mstrMonthlyPayCom = dblValueOut          
06479  |'                                                 ||06476  |'                                                 
06480  |'        '2006/04/12 START K.Furuya 実払管理テーブ||06477  |'        '2006/04/12 START K.Furuya 実払管理テーブ
06481  |'        '確定額と実払額を取得                    ||06478  |'        '確定額と実払額を取得                    
06482  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||06479  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
06483  |'            WkFixComC = ""                       ||06480  |'            WkFixComC = ""                       
06484  |'            WkFixComJ = ""                       ||06481  |'            WkFixComJ = ""                       
06485  |'            WkRealComC = ""                      ||06482  |'            WkRealComC = ""                      
06486  |'            WkRealComJ = ""                      ||06483  |'            WkRealComJ = ""                      
06487  |'            WkFixComC = mstrMonthlyPayCom        ||06484  |'            WkFixComC = mstrMonthlyPayCom        
06488  |'            WkFixComJ = mstrMonthlyPayCom        ||06485  |'            WkFixComJ = mstrMonthlyPayCom        
06489  |'            WkRealComC = mstrMonthlyPayCom       ||06486  |'            WkRealComC = mstrMonthlyPayCom       
06490  |'            WkRealComJ = mstrMonthlyPayCom       ||06487  |'            WkRealComJ = mstrMonthlyPayCom       
06491  |'        Else                                     ||06488  |'        Else                                     
06492  |'            WkFixComJ = ""                       ||06489  |'            WkFixComJ = ""                       
06493  |'            WkRealComJ = ""                      ||06490  |'            WkRealComJ = ""                      
06494  |'            WkFixComJ = mstrMonthlyPayCom        ||06491  |'            WkFixComJ = mstrMonthlyPayCom        
06495  |'            WkRealComJ = mstrMonthlyPayCom       ||06492  |'            WkRealComJ = mstrMonthlyPayCom       
06496  |'        End If                                   ||06493  |'        End If                                   
06497  |'        '2006/04/12 END   K.Furuya 実払管理テーブ||06494  |'        '2006/04/12 END   K.Furuya 実払管理テーブ
06498  |'                                                 ||06495  |'                                                 
06499  |''2005/01/12 End                                  ||06496  |''2005/01/12 End                                  
06500  |'                                                 ||06497  |'                                                 
06501  |''2005/01/17 Start                                ||06498  |''2005/01/17 Start                                
06502  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe||06499  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe
06503  |'                'TTMレート                       ||06500  |'                'TTMレート                       
06504  |'                .Cells(47, 19).Value = sWord43   ||06501  |'                .Cells(47, 19).Value = sWord43   
06505  |'                .Cells(47, 33).NumberFormatLocal ||06502  |'                .Cells(47, 33).NumberFormatLocal 
06506  |'                .Cells(47, 33).Value = Format(ddb||06503  |'                .Cells(47, 33).Value = Format(ddb
06507  |'                .Cells(47, 33).HorizontalAlignmen||06504  |'                .Cells(47, 33).HorizontalAlignmen
06508  |'                .Cells(47, 34).Value = sWord44   ||06505  |'                .Cells(47, 34).Value = sWord44   
06509  |'            End If                               ||06506  |'            End If                               
06510  |''2005/01/17 End                                  ||06507  |''2005/01/17 End                                  
06511  |''2005/01/12 Start                                ||06508  |''2005/01/12 Start                                
06512  |''        '税抜金額(月別支払顧問料の累計)         ||06509  |''        '税抜金額(月別支払顧問料の累計)         
06513  |''        .Cells(46, 27).NumberFormatLocal = "@"  ||06510  |''        .Cells(46, 27).NumberFormatLocal = "@"  
06514  |''        .Cells(46, 27).Value = CStr(Format(mstrM||06511  |''        .Cells(46, 27).Value = CStr(Format(mstrM
06515  |''        .Cells(46, 27).HorizontalAlignment = xlR||06512  |''        .Cells(46, 27).HorizontalAlignment = xlR
06516  |''2005/01/13 Start                                ||06513  |''2005/01/13 Start                                
06517  |'            '支払額                              ||06514  |'            '支払額                              
06518  |'            .Cells(48, 2).Value = sWord46        ||06515  |'            .Cells(48, 2).Value = sWord46        
06519  |'            .Cells(48, 11).Value = sWord19       ||06516  |'            .Cells(48, 11).Value = sWord19       
06520  |''2005/01/13 End                                  ||06517  |''2005/01/13 End                                  
06521  |'            '税抜金額(月別支払顧問料の累計)      ||06518  |'            '税抜金額(月別支払顧問料の累計)      
06522  |'            .Cells(48, 29).NumberFormatLocal = "@||06519  |'            .Cells(48, 29).NumberFormatLocal = "@
06523  |'            .Cells(48, 29).Value = CStr(Format(ms||06520  |'            .Cells(48, 29).Value = CStr(Format(ms
06524  |'            .Cells(48, 29).HorizontalAlignment = ||06521  |'            .Cells(48, 29).HorizontalAlignment = 
06525  |'            .Cells(48, 32).Value = sYen          ||06522  |'            .Cells(48, 32).Value = sYen          
06526  |''2005/01/12 End                                  ||06523  |''2005/01/12 End                                  
06527  |'                                                 ||06524  |'                                                 
06528  |''2005/03/09 Start                                ||06525  |''2005/03/09 Start                                
06529  |''        '消費税率テキストボックス入力の場合のみ ||06526  |''        '消費税率テキストボックス入力の場合のみ 
06530  |''        If txtInputTax.Text <> "" Then          ||06527  |''        If txtInputTax.Text <> "" Then          
06531  |''            '(消費税XX%)                        ||06528  |''            '(消費税XX%)                        
06532  |''            iSyouhizei = CInt(Trim(txtInputTax.T||06529  |''            iSyouhizei = CInt(Trim(txtInputTax.T
06533  |'''2005/01/12 Start                               ||06530  |'''2005/01/12 Start                               
06534  |'''            .Cells(47, 29).Value = sWord22 & iS||06531  |'''            .Cells(47, 29).Value = sWord22 & iS
06535  |''            .Cells(49, 32).Value = sWord22 & iSy||06532  |''            .Cells(49, 32).Value = sWord22 & iSy
06536  |'''2005/01/12 End                                 ||06533  |'''2005/01/12 End                                 
06537  |'''2004/11/17 Start                               ||06534  |'''2004/11/17 Start                               
06538  |'''            lTaxNum = Round(mstrMonthlyPayCom *||06535  |'''            lTaxNum = Round(mstrMonthlyPayCom *
06539  |''            dblValueIn = mstrMonthlyPayCom * iSy||06536  |''            dblValueIn = mstrMonthlyPayCom * iSy
06540  |''            Call sbGetRoundValueTax(dblValueIn) ||06537  |''            Call sbGetRoundValueTax(dblValueIn) 
06541  |''            lTaxNum = dblValueOut               ||06538  |''            lTaxNum = dblValueOut               
06542  |'''2004/11/17 End                                 ||06539  |'''2004/11/17 End                                 
06543  |'''2005/01/12 Start                               ||06540  |'''2005/01/12 Start                               
06544  |'''            .Cells(47, 27).NumberFormatLocal = ||06541  |'''            .Cells(47, 27).NumberFormatLocal = 
06545  |'''            .Cells(47, 27).Value = CStr(Format(||06542  |'''            .Cells(47, 27).Value = CStr(Format(
06546  |'''            .Cells(47, 27).HorizontalAlignment ||06543  |'''            .Cells(47, 27).HorizontalAlignment 
06547  |'''            '合計(消費税＋月別支払顧問料の累計)||06544  |'''            '合計(消費税＋月別支払顧問料の累計)
06548  |'''            .Cells(48, 14).Value = sWord24     ||06545  |'''            .Cells(48, 14).Value = sWord24     
06549  |''            .Cells(49, 29).NumberFormatLocal = "||06546  |''            .Cells(49, 29).NumberFormatLocal = "
06550  |''            .Cells(49, 29).Value = CStr(Format((||06547  |''            .Cells(49, 29).Value = CStr(Format((
06551  |''            .Cells(49, 29).HorizontalAlignment =||06548  |''            .Cells(49, 29).HorizontalAlignment =
06552  |''            '合計(消費税＋月別支払顧問料の累計) ||06549  |''            '合計(消費税＋月別支払顧問料の累計) 
06553  |''            .Cells(50, 13).Value = sWord24      ||06550  |''            .Cells(50, 13).Value = sWord24      
06554  |'''2005/01/12 End                                 ||06551  |'''2005/01/12 End                                 
06555  |'''2004/11/17 Start                               ||06552  |'''2004/11/17 Start                               
06556  |'''            lMonthlyPayCom = Round(lTaxNum + CC||06553  |'''            lMonthlyPayCom = Round(lTaxNum + CC
06557  |''            dblValueIn = lTaxNum + CCur(mstrMont||06554  |''            dblValueIn = lTaxNum + CCur(mstrMont
06558  |''            Call sbGetRoundValue(dblValueIn)    ||06555  |''            Call sbGetRoundValue(dblValueIn)    
06559  |''            lMonthlyPayCom = dblValueOut        ||06556  |''            lMonthlyPayCom = dblValueOut        
06560  |'''2004/11/17 End                                 ||06557  |'''2004/11/17 End                                 
06561  |'''2005/01/12 Start                               ||06558  |'''2005/01/12 Start                               
06562  |'''            .Cells(48, 27).NumberFormatLocal = ||06559  |'''            .Cells(48, 27).NumberFormatLocal = 
06563  |'''            .Cells(48, 27).Value = CStr(Format(||06560  |'''            .Cells(48, 27).Value = CStr(Format(
06564  |'''            .Cells(48, 27).HorizontalAlignment ||06561  |'''            .Cells(48, 27).HorizontalAlignment 
06565  |'''            '円                                ||06562  |'''            '円                                
06566  |'''            .Cells(48, 29).Value = sYen        ||06563  |'''            .Cells(48, 29).Value = sYen        
06567  |'''            '下線                              ||06564  |'''            '下線                              
06568  |'''            With xlSheet.Range("M47:AL47").Bord||06565  |'''            With xlSheet.Range("M47:AL47").Bord
06569  |'''                .LineStyle = xlContinuous      ||06566  |'''                .LineStyle = xlContinuous      
06570  |'''                .Weight = xlThin               ||06567  |'''                .Weight = xlThin               
06571  |'''            End With                           ||06568  |'''            End With                           
06572  |'''        Else                                   ||06569  |'''        Else                                   
06573  |'''            '月別支払顧問料の累計＋円          ||06570  |'''            '月別支払顧問料の累計＋円          
06574  |'''            .Cells(46, 27).Value = ""          ||06571  |'''            .Cells(46, 27).Value = ""          
06575  |'''            .Cells(46, 13).Value = CStr(Format(||06572  |'''            .Cells(46, 13).Value = CStr(Format(
06576  |''            .Cells(50, 29).NumberFormatLocal = "||06573  |''            .Cells(50, 29).NumberFormatLocal = "
06577  |''            .Cells(50, 29).Value = CStr(Format(l||06574  |''            .Cells(50, 29).Value = CStr(Format(l
06578  |''            .Cells(50, 29).HorizontalAlignment =||06575  |''            .Cells(50, 29).HorizontalAlignment =
06579  |''            '円                                 ||06576  |''            '円                                 
06580  |''            .Cells(50, 32).Value = sYen         ||06577  |''            .Cells(50, 32).Value = sYen         
06581  |''            '下線                               ||06578  |''            '下線                               
06582  |''            With xlSheet.Range("M49:AL49").Borde||06579  |''            With xlSheet.Range("M49:AL49").Borde
06583  |''                .LineStyle = xlContinuous       ||06580  |''                .LineStyle = xlContinuous       
06584  |''                .Weight = xlThin                ||06581  |''                .Weight = xlThin                
06585  |''            End With                            ||06582  |''            End With                            
06586  |''        Else                                    ||06583  |''        Else                                    
06587  |'''            '月別支払顧問料の累計＋円          ||06584  |'''            '月別支払顧問料の累計＋円          
06588  |'''            .Cells(48, 28).Value = ""          ||06585  |'''            .Cells(48, 28).Value = ""          
06589  |'''            .Cells(48, 28).Value = CStr(Format(||06586  |'''            .Cells(48, 28).Value = CStr(Format(
06590  |'''2005/01/12 End                                 ||06587  |'''2005/01/12 End                                 
06591  |'''            '下線                              ||06588  |'''            '下線                              
06592  |'''            With xlSheet.Range("M46:AN46").Bord||06589  |'''            With xlSheet.Range("M46:AN46").Bord
06593  |'''                .LineStyle = xlContinuous      ||06590  |'''                .LineStyle = xlContinuous      
06594  |'''                .Weight = xlThin               ||06591  |'''                .Weight = xlThin               
06595  |'''            End With                           ||06592  |'''            End With                           
06596  |''        End If                                  ||06593  |''        End If                                  
06597  |'        '消費税計算有無：「有り」の場合のみ、消費||06594  |'        '消費税計算有無：「有り」の場合のみ、消費
06598  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc||06595  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc
06599  |'            '(消費税XX%)                         ||06596  |'            '(消費税XX%)                         
06600  |'            iSyouhizei = ddblconsumption_tax     ||06597  |'            iSyouhizei = ddblconsumption_tax     
06601  |'            .Cells(49, 32).Value = sWord22 & iSyo||06598  |'            .Cells(49, 32).Value = sWord22 & iSyo
06602  |'            dblValueIn = mstrMonthlyPayCom * iSyo||06599  |'            dblValueIn = mstrMonthlyPayCom * iSyo
06603  |'            Call sbGetRoundValueTax(dblValueIn)  ||06600  |'            Call sbGetRoundValueTax(dblValueIn)  
06604  |'            lTaxNum = dblValueOut                ||06601  |'            lTaxNum = dblValueOut                
06605  |'            .Cells(49, 29).NumberFormatLocal = "@||06602  |'            .Cells(49, 29).NumberFormatLocal = "@
06606  |'            .Cells(49, 29).Value = CStr(Format((l||06603  |'            .Cells(49, 29).Value = CStr(Format((l
06607  |'            .Cells(49, 29).HorizontalAlignment = ||06604  |'            .Cells(49, 29).HorizontalAlignment = 
06608  |'            '合計(消費税＋月別支払顧問料の累計)  ||06605  |'            '合計(消費税＋月別支払顧問料の累計)  
06609  |'            .Cells(50, 13).Value = sWord24       ||06606  |'            .Cells(50, 13).Value = sWord24       
06610  |'            dblValueIn = lTaxNum + CCur(mstrMonth||06607  |'            dblValueIn = lTaxNum + CCur(mstrMonth
06611  |'            Call sbGetRoundValue(dblValueIn)     ||06608  |'            Call sbGetRoundValue(dblValueIn)     
06612  |'            lMonthlyPayCom = dblValueOut         ||06609  |'            lMonthlyPayCom = dblValueOut         
06613  |'            .Cells(50, 29).NumberFormatLocal = "@||06610  |'            .Cells(50, 29).NumberFormatLocal = "@
06614  |'            .Cells(50, 29).Value = CStr(Format(lM||06611  |'            .Cells(50, 29).Value = CStr(Format(lM
06615  |'            .Cells(50, 29).HorizontalAlignment = ||06612  |'            .Cells(50, 29).HorizontalAlignment = 
06616  |'            '円                                  ||06613  |'            '円                                  
06617  |'            .Cells(50, 32).Value = sYen          ||06614  |'            .Cells(50, 32).Value = sYen          
06618  |'            '下線                                ||06615  |'            '下線                                
06619  |'            With xlSheet.Range("M49:AL49").Border||06616  |'            With xlSheet.Range("M49:AL49").Border
06620  |'                .LineStyle = xlContinuous        ||06617  |'                .LineStyle = xlContinuous        
06621  |'                .Weight = xlThin                 ||06618  |'                .Weight = xlThin                 
06622  |'            End With                             ||06619  |'            End With                             
06623  |'        Else                                     ||06620  |'        Else                                     
06624  |'        End If                                   ||06621  |'        End If                                   
06625  |''2005/03/09 End                                  ||06622  |''2005/03/09 End                                  
06626  |'                                                 ||06623  |'                                                 
06627  |''2005/01/12 Start                                ||06624  |''2005/01/12 Start                                
06628  |''        '支払先                                 ||06625  |''        '支払先                                 
06629  |''        .Cells(50, 2).Value = sWord12           ||06626  |''        .Cells(50, 2).Value = sWord12           
06630  |'''2004/09/10 Start                               ||06627  |'''2004/09/10 Start                               
06631  |'''        .Cells(50, 10).Value = sWord19         ||06628  |'''        .Cells(50, 10).Value = sWord19         
06632  |''        .Cells(50, 11).Value = sWord19          ||06629  |''        .Cells(50, 11).Value = sWord19          
06633  |'''2004/09/10 End                                 ||06630  |'''2004/09/10 End                                 
06634  |''        .Cells(50, 13).Value = gbuMGetUPDRec.N(l||06631  |''        .Cells(50, 13).Value = gbuMGetUPDRec.N(l
06635  |''        '支払予定日                             ||06632  |''        '支払予定日                             
06636  |''        .Cells(53, 2).Value = sWord13           ||06633  |''        .Cells(53, 2).Value = sWord13           
06637  |'''2004/09/10 Start                               ||06634  |'''2004/09/10 Start                               
06638  |'''        .Cells(53, 10).Value = sWord19         ||06635  |'''        .Cells(53, 10).Value = sWord19         
06639  |''        .Cells(53, 11).Value = sWord19          ||06636  |''        .Cells(53, 11).Value = sWord19          
06640  |'''2004/09/10 End                                 ||06637  |'''2004/09/10 End                                 
06641  |''        '支払予定日                             ||06638  |''        '支払予定日                             
06642  |''        sDate = Trim(mstrPaymentDate)           ||06639  |''        sDate = Trim(mstrPaymentDate)           
06643  |''        .Cells(53, 13).Value = _                ||06640  |''        .Cells(53, 13).Value = _                
06644  |''            Format(sDate, "YYYY") & WordYear & _||06641  |''            Format(sDate, "YYYY") & WordYear & _
06645  |''            Format(sDate, "M") & WordMonth & _  ||06642  |''            Format(sDate, "M") & WordMonth & _  
06646  |''            Format(sDate, "D") & WordDay        ||06643  |''            Format(sDate, "D") & WordDay        
06647  |'        '支払先                                  ||06644  |'        '支払先                                  
06648  |'        .Cells(52, 2).Value = sWord12            ||06645  |'        .Cells(52, 2).Value = sWord12            
06649  |''2004/09/10 Start                                ||06646  |''2004/09/10 Start                                
06650  |''        .Cells(50, 10).Value = sWord19          ||06647  |''        .Cells(50, 10).Value = sWord19          
06651  |'        .Cells(52, 11).Value = sWord19           ||06648  |'        .Cells(52, 11).Value = sWord19           
06652  |''2004/09/10 End                                  ||06649  |''2004/09/10 End                                  
06653  |'        .Cells(52, 13).Value = gbuMGetUPDRec.N(lR||06650  |'        .Cells(52, 13).Value = gbuMGetUPDRec.N(lR
06654  |'        '支払予定日                              ||06651  |'        '支払予定日                              
06655  |'        .Cells(54, 2).Value = sWord13            ||06652  |'        .Cells(54, 2).Value = sWord13            
06656  |''2004/09/10 Start                                ||06653  |''2004/09/10 Start                                
06657  |''        .Cells(53, 10).Value = sWord19          ||06654  |''        .Cells(53, 10).Value = sWord19          
06658  |'        .Cells(54, 11).Value = sWord19           ||06655  |'        .Cells(54, 11).Value = sWord19           
06659  |''2004/09/10 End                                  ||06656  |''2004/09/10 End                                  
06660  |'        '支払予定日                              ||06657  |'        '支払予定日                              
06661  |'        sDate = Trim(mstrPaymentDate)            ||06658  |'        sDate = Trim(mstrPaymentDate)            
06662  |'        .Cells(54, 13).Value = _                 ||06659  |'        .Cells(54, 13).Value = _                 
06663  |'            Format(sDate, "YYYY") & WordYear & _ ||06660  |'            Format(sDate, "YYYY") & WordYear & _ 
06664  |'            Format(sDate, "M") & WordMonth & _   ||06661  |'            Format(sDate, "M") & WordMonth & _   
06665  |'            Format(sDate, "D") & WordDay         ||06662  |'            Format(sDate, "D") & WordDay         
06666  |''2005/01/12 End                                  ||06663  |''2005/01/12 End                                  
06667  |'      '部署名                                    ||06664  |'      '部署名                                    
06668  |'        'コンボ左の数字取得                      ||06665  |'        'コンボ左の数字取得                      
06669  |'        ColNum = Trim(gstrComboCodeGet(cboBumonFl||06666  |'        ColNum = Trim(gstrComboCodeGet(cboBumonFl
06670  |'        'コンボ「：」以下の文字列                ||06667  |'        'コンボ「：」以下の文字列                
06671  |'        ColWord = Trim(gstrComboDataGet(cboBumonF||06668  |'        ColWord = Trim(gstrComboDataGet(cboBumonF
06672  |''2005/01/12 Start                                ||06669  |''2005/01/12 Start                                
06673  |''        .Cells(56, 2).Value = ColWord           ||06670  |''        .Cells(56, 2).Value = ColWord           
06674  |''        .Range("B56:S56").HorizontalAlignment = ||06671  |''        .Range("B56:S56").HorizontalAlignment = 
06675  |''        '担当者印                               ||06672  |''        '担当者印                               
06676  |''        .Cells(57, 2).Value = sWord15           ||06673  |''        .Cells(57, 2).Value = sWord15           
06677  |''        .Range("B57:J57").HorizontalAlignment = ||06674  |''        .Range("B57:J57").HorizontalAlignment = 
06678  |''        '検印                                   ||06675  |''        '検印                                   
06679  |''        .Cells(57, 11).Value = sWord16          ||06676  |''        .Cells(57, 11).Value = sWord16          
06680  |''        .Range("K57:S57").HorizontalAlignment = ||06677  |''        .Range("K57:S57").HorizontalAlignment = 
06681  |''        '財務部                                 ||06678  |''        '財務部                                 
06682  |''        .Cells(56, 26).Value = sWord35          ||06679  |''        .Cells(56, 26).Value = sWord35          
06683  |''        .Range("Z56:AQ56").HorizontalAlignment =||06680  |''        .Range("Z56:AQ56").HorizontalAlignment =
06684  |''        '精査印                                 ||06681  |''        '精査印                                 
06685  |''        .Cells(57, 26).Value = sWord17          ||06682  |''        .Cells(57, 26).Value = sWord17          
06686  |''        .Range("Z57:AH57").HorizontalAlignment =||06683  |''        .Range("Z57:AH57").HorizontalAlignment =
06687  |''        '検印                                   ||06684  |''        '検印                                   
06688  |''        .Cells(57, 35).Value = sWord16          ||06685  |''        .Cells(57, 35).Value = sWord16          
06689  |''        .Range("AI57:AQ57").HorizontalAlignment ||06686  |''        .Range("AI57:AQ57").HorizontalAlignment 
06690  |'        .Cells(56, 2).Value = ColWord            ||06687  |'        .Cells(56, 2).Value = ColWord            
06691  |'        .Range("B56:S56").HorizontalAlignment = x||06688  |'        .Range("B56:S56").HorizontalAlignment = x
06692  |'        '担当者印                                ||06689  |'        '担当者印                                
06693  |'        .Cells(57, 2).Value = sWord15            ||06690  |'        .Cells(57, 2).Value = sWord15            
06694  |'        .Range("B57:J57").HorizontalAlignment = x||06691  |'        .Range("B57:J57").HorizontalAlignment = x
06695  |'        '検印                                    ||06692  |'        '検印                                    
06696  |'        .Cells(57, 11).Value = sWord16           ||06693  |'        .Cells(57, 11).Value = sWord16           
06697  |'        .Range("K57:S57").HorizontalAlignment = x||06694  |'        .Range("K57:S57").HorizontalAlignment = x
06698  |'        '財務部                                  ||06695  |'        '財務部                                  
06699  |'        .Cells(56, 24).Value = sWord35           ||06696  |'        .Cells(56, 24).Value = sWord35           
06700  |'        .Range("X56:AO56").HorizontalAlignment = ||06697  |'        .Range("X56:AO56").HorizontalAlignment = 
06701  |'        '精査印                                  ||06698  |'        '精査印                                  
06702  |'        .Cells(57, 24).Value = sWord17           ||06699  |'        .Cells(57, 24).Value = sWord17           
06703  |'        .Range("X57:AF57").HorizontalAlignment = ||06700  |'        .Range("X57:AF57").HorizontalAlignment = 
06704  |'        '検印                                    ||06701  |'        '検印                                    
06705  |'        .Cells(57, 33).Value = sWord16           ||06702  |'        .Cells(57, 33).Value = sWord16           
06706  |'        .Range("AG57:AO57").HorizontalAlignment =||06703  |'        .Range("AG57:AO57").HorizontalAlignment =
06707  |''2005/01/12 End                                  ||06704  |''2005/01/12 End                                  
06708  |'                                                 ||06705  |'                                                 
06709  |'    End With                                     ||06706  |'    End With                                     
06710  |'                                                 ||06707  |'                                                 
06711  |''2005/01/12 Start                                ||06708  |''2005/01/12 Start                                
06712  |''    '月末純資産(外枠)                           ||06709  |''    '月末純資産(外枠)                           
06713  |''    With xlSheet.Range("N19:AM33").Borders(xlEdg||06710  |''    With xlSheet.Range("N19:AM33").Borders(xlEdg
06714  |''        .LineStyle = xlContinuous               ||06711  |''        .LineStyle = xlContinuous               
06715  |''        .Weight = xlThin                        ||06712  |''        .Weight = xlThin                        
06716  |''    End With                                    ||06713  |''    End With                                    
06717  |''    With xlSheet.Range("N19:AM33").Borders(xlEdg||06714  |''    With xlSheet.Range("N19:AM33").Borders(xlEdg
06718  |''        .LineStyle = xlContinuous               ||06715  |''        .LineStyle = xlContinuous               
06719  |''        .Weight = xlThin                        ||06716  |''        .Weight = xlThin                        
06720  |''    End With                                    ||06717  |''    End With                                    
06721  |''    With xlSheet.Range("N19:AM33").Borders(xlEdg||06718  |''    With xlSheet.Range("N19:AM33").Borders(xlEdg
06722  |''        .LineStyle = xlContinuous               ||06719  |''        .LineStyle = xlContinuous               
06723  |''        .Weight = xlThin                        ||06720  |''        .Weight = xlThin                        
06724  |''    End With                                    ||06721  |''    End With                                    
06725  |''    With xlSheet.Range("N19:AM33").Borders(xlEdg||06722  |''    With xlSheet.Range("N19:AM33").Borders(xlEdg
06726  |''        .LineStyle = xlContinuous               ||06723  |''        .LineStyle = xlContinuous               
06727  |''        .Weight = xlThin                        ||06724  |''        .Weight = xlThin                        
06728  |''    End With                                    ||06725  |''    End With                                    
06729  |''    With xlSheet.Range("N19:AM33").Borders(xlIns||06726  |''    With xlSheet.Range("N19:AM33").Borders(xlIns
06730  |''        .LineStyle = xlContinuous               ||06727  |''        .LineStyle = xlContinuous               
06731  |''        .Weight = xlThin                        ||06728  |''        .Weight = xlThin                        
06732  |''    End With                                    ||06729  |''    End With                                    
06733  |''    '月末純資産(真中縦線)                       ||06730  |''    '月末純資産(真中縦線)                       
06734  |''    With xlSheet.Range("Y19:Y33").Borders(xlEdge||06731  |''    With xlSheet.Range("Y19:Y33").Borders(xlEdge
06735  |''        .LineStyle = xlContinuous               ||06732  |''        .LineStyle = xlContinuous               
06736  |''        .Weight = xlThin                        ||06733  |''        .Weight = xlThin                        
06737  |''    End With                                    ||06734  |''    End With                                    
06738  |''    '月末純資産(左側捺印欄　外枠)               ||06735  |''    '月末純資産(左側捺印欄　外枠)               
06739  |''    With xlSheet.Range("B56:S63").Borders(xlEdge||06736  |''    With xlSheet.Range("B56:S63").Borders(xlEdge
06740  |''        .LineStyle = xlContinuous               ||06737  |''        .LineStyle = xlContinuous               
06741  |''        .Weight = xlThin                        ||06738  |''        .Weight = xlThin                        
06742  |''    End With                                    ||06739  |''    End With                                    
06743  |''    With xlSheet.Range("B56:S63").Borders(xlEdge||06740  |''    With xlSheet.Range("B56:S63").Borders(xlEdge
06744  |''        .LineStyle = xlContinuous               ||06741  |''        .LineStyle = xlContinuous               
06745  |''        .Weight = xlThin                        ||06742  |''        .Weight = xlThin                        
06746  |''    End With                                    ||06743  |''    End With                                    
06747  |''    With xlSheet.Range("B56:S63").Borders(xlEdge||06744  |''    With xlSheet.Range("B56:S63").Borders(xlEdge
06748  |''        .LineStyle = xlContinuous               ||06745  |''        .LineStyle = xlContinuous               
06749  |''        .Weight = xlThin                        ||06746  |''        .Weight = xlThin                        
06750  |''    End With                                    ||06747  |''    End With                                    
06751  |''    With xlSheet.Range("B56:S63").Borders(xlEdge||06748  |''    With xlSheet.Range("B56:S63").Borders(xlEdge
06752  |''        .LineStyle = xlContinuous               ||06749  |''        .LineStyle = xlContinuous               
06753  |''        .Weight = xlThin                        ||06750  |''        .Weight = xlThin                        
06754  |''    End With                                    ||06751  |''    End With                                    
06755  |''    '月末純資産(左側捺印欄　上枠)               ||06752  |''    '月末純資産(左側捺印欄　上枠)               
06756  |''    With xlSheet.Range("B56:S57").Borders(xlEdge||06753  |''    With xlSheet.Range("B56:S57").Borders(xlEdge
06757  |''        .LineStyle = xlContinuous               ||06754  |''        .LineStyle = xlContinuous               
06758  |''        .Weight = xlThin                        ||06755  |''        .Weight = xlThin                        
06759  |''    End With                                    ||06756  |''    End With                                    
06760  |''    With xlSheet.Range("B56:S57").Borders(xlInsi||06757  |''    With xlSheet.Range("B56:S57").Borders(xlInsi
06761  |''        .LineStyle = xlContinuous               ||06758  |''        .LineStyle = xlContinuous               
06762  |''        .Weight = xlThin                        ||06759  |''        .Weight = xlThin                        
06763  |''    End With                                    ||06760  |''    End With                                    
06764  |''    '月末純資産(左側捺印欄　縦線)               ||06761  |''    '月末純資産(左側捺印欄　縦線)               
06765  |''    With xlSheet.Range("J57:J63").Borders(xlEdge||06762  |''    With xlSheet.Range("J57:J63").Borders(xlEdge
06766  |''        .LineStyle = xlContinuous               ||06763  |''        .LineStyle = xlContinuous               
06767  |''        .Weight = xlThin                        ||06764  |''        .Weight = xlThin                        
06768  |''    End With                                    ||06765  |''    End With                                    
06769  |''    '月末純資産(右側捺印欄　外枠)               ||06766  |''    '月末純資産(右側捺印欄　外枠)               
06770  |''    With xlSheet.Range("Z56:AQ63").Borders(xlEdg||06767  |''    With xlSheet.Range("Z56:AQ63").Borders(xlEdg
06771  |''        .LineStyle = xlContinuous               ||06768  |''        .LineStyle = xlContinuous               
06772  |''        .Weight = xlThin                        ||06769  |''        .Weight = xlThin                        
06773  |''    End With                                    ||06770  |''    End With                                    
06774  |''    With xlSheet.Range("Z56:AQ63").Borders(xlEdg||06771  |''    With xlSheet.Range("Z56:AQ63").Borders(xlEdg
06775  |''        .LineStyle = xlContinuous               ||06772  |''        .LineStyle = xlContinuous               
06776  |''        .Weight = xlThin                        ||06773  |''        .Weight = xlThin                        
06777  |''    End With                                    ||06774  |''    End With                                    
06778  |''    With xlSheet.Range("Z56:AQ63").Borders(xlEdg||06775  |''    With xlSheet.Range("Z56:AQ63").Borders(xlEdg
06779  |''        .LineStyle = xlContinuous               ||06776  |''        .LineStyle = xlContinuous               
06780  |''        .Weight = xlThin                        ||06777  |''        .Weight = xlThin                        
06781  |''    End With                                    ||06778  |''    End With                                    
06782  |''    With xlSheet.Range("Z56:AQ63").Borders(xlEdg||06779  |''    With xlSheet.Range("Z56:AQ63").Borders(xlEdg
06783  |''        .LineStyle = xlContinuous               ||06780  |''        .LineStyle = xlContinuous               
06784  |''        .Weight = xlThin                        ||06781  |''        .Weight = xlThin                        
06785  |''    End With                                    ||06782  |''    End With                                    
06786  |''    '月末純資産(右側捺印欄　上枠)               ||06783  |''    '月末純資産(右側捺印欄　上枠)               
06787  |''    With xlSheet.Range("Z56:AQ57").Borders(xlEdg||06784  |''    With xlSheet.Range("Z56:AQ57").Borders(xlEdg
06788  |''        .LineStyle = xlContinuous               ||06785  |''        .LineStyle = xlContinuous               
06789  |''        .Weight = xlThin                        ||06786  |''        .Weight = xlThin                        
06790  |''    End With                                    ||06787  |''    End With                                    
06791  |''    With xlSheet.Range("Z56:AQ57").Borders(xlEdg||06788  |''    With xlSheet.Range("Z56:AQ57").Borders(xlEdg
06792  |''        .LineStyle = xlContinuous               ||06789  |''        .LineStyle = xlContinuous               
06793  |''        .Weight = xlThin                        ||06790  |''        .Weight = xlThin                        
06794  |''    End With                                    ||06791  |''    End With                                    
06795  |''    With xlSheet.Range("Z56:AQ57").Borders(xlIns||06792  |''    With xlSheet.Range("Z56:AQ57").Borders(xlIns
06796  |''        .LineStyle = xlContinuous               ||06793  |''        .LineStyle = xlContinuous               
06797  |''        .Weight = xlThin                        ||06794  |''        .Weight = xlThin                        
06798  |''    End With                                    ||06795  |''    End With                                    
06799  |''    '月末純資産(右側捺印欄　縦線)               ||06796  |''    '月末純資産(右側捺印欄　縦線)               
06800  |''    With xlSheet.Range("AH57:AH63").Borders(xlEd||06797  |''    With xlSheet.Range("AH57:AH63").Borders(xlEd
06801  |''        .LineStyle = xlContinuous               ||06798  |''        .LineStyle = xlContinuous               
06802  |''        .Weight = xlThin                        ||06799  |''        .Weight = xlThin                        
06803  |''    End With                                    ||06800  |''    End With                                    
06804  |'    '月末純資産(外枠)                            ||06801  |'    '月末純資産(外枠)                            
06805  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge||06802  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge
06806  |'        .LineStyle = xlContinuous                ||06803  |'        .LineStyle = xlContinuous                
06807  |'        .Weight = xlThin                         ||06804  |'        .Weight = xlThin                         
06808  |'    End With                                     ||06805  |'    End With                                     
06809  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge||06806  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge
06810  |'        .LineStyle = xlContinuous                ||06807  |'        .LineStyle = xlContinuous                
06811  |'        .Weight = xlThin                         ||06808  |'        .Weight = xlThin                         
06812  |'    End With                                     ||06809  |'    End With                                     
06813  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge||06810  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge
06814  |'        .LineStyle = xlContinuous                ||06811  |'        .LineStyle = xlContinuous                
06815  |'        .Weight = xlThin                         ||06812  |'        .Weight = xlThin                         
06816  |'    End With                                     ||06813  |'    End With                                     
06817  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge||06814  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge
06818  |'        .LineStyle = xlContinuous                ||06815  |'        .LineStyle = xlContinuous                
06819  |'        .Weight = xlThin                         ||06816  |'        .Weight = xlThin                         
06820  |'    End With                                     ||06817  |'    End With                                     
06821  |'    With xlSheet.Range("N19:AN33").Borders(xlInsi||06818  |'    With xlSheet.Range("N19:AN33").Borders(xlInsi
06822  |'        .LineStyle = xlContinuous                ||06819  |'        .LineStyle = xlContinuous                
06823  |'        .Weight = xlThin                         ||06820  |'        .Weight = xlThin                         
06824  |'    End With                                     ||06821  |'    End With                                     
06825  |'    '月末純資産(真中縦線)                        ||06822  |'    '月末純資産(真中縦線)                        
06826  |'    With xlSheet.Range("Y19:Y33").Borders(xlEdgeR||06823  |'    With xlSheet.Range("Y19:Y33").Borders(xlEdgeR
06827  |'        .LineStyle = xlContinuous                ||06824  |'        .LineStyle = xlContinuous                
06828  |'        .Weight = xlThin                         ||06825  |'        .Weight = xlThin                         
06829  |'    End With                                     ||06826  |'    End With                                     
06830  |'    '月末純資産(左側捺印欄　外枠)                ||06827  |'    '月末純資産(左側捺印欄　外枠)                
06831  |'    With xlSheet.Range("B56:S63").Borders(xlEdgeL||06828  |'    With xlSheet.Range("B56:S63").Borders(xlEdgeL
06832  |'        .LineStyle = xlContinuous                ||06829  |'        .LineStyle = xlContinuous                
06833  |'        .Weight = xlThin                         ||06830  |'        .Weight = xlThin                         
06834  |'    End With                                     ||06831  |'    End With                                     
06835  |'    With xlSheet.Range("B56:S63").Borders(xlEdgeT||06832  |'    With xlSheet.Range("B56:S63").Borders(xlEdgeT
06836  |'        .LineStyle = xlContinuous                ||06833  |'        .LineStyle = xlContinuous                
06837  |'        .Weight = xlThin                         ||06834  |'        .Weight = xlThin                         
06838  |'    End With                                     ||06835  |'    End With                                     
06839  |'    With xlSheet.Range("B56:S63").Borders(xlEdgeB||06836  |'    With xlSheet.Range("B56:S63").Borders(xlEdgeB
06840  |'        .LineStyle = xlContinuous                ||06837  |'        .LineStyle = xlContinuous                
06841  |'        .Weight = xlThin                         ||06838  |'        .Weight = xlThin                         
06842  |'    End With                                     ||06839  |'    End With                                     
06843  |'    With xlSheet.Range("B56:S63").Borders(xlEdgeR||06840  |'    With xlSheet.Range("B56:S63").Borders(xlEdgeR
06844  |'        .LineStyle = xlContinuous                ||06841  |'        .LineStyle = xlContinuous                
06845  |'        .Weight = xlThin                         ||06842  |'        .Weight = xlThin                         
06846  |'    End With                                     ||06843  |'    End With                                     
06847  |'    '月末純資産(左側捺印欄　上枠)                ||06844  |'    '月末純資産(左側捺印欄　上枠)                
06848  |'    With xlSheet.Range("B56:S57").Borders(xlEdgeB||06845  |'    With xlSheet.Range("B56:S57").Borders(xlEdgeB
06849  |'        .LineStyle = xlContinuous                ||06846  |'        .LineStyle = xlContinuous                
06850  |'        .Weight = xlThin                         ||06847  |'        .Weight = xlThin                         
06851  |'    End With                                     ||06848  |'    End With                                     
06852  |'    With xlSheet.Range("B56:S57").Borders(xlInsid||06849  |'    With xlSheet.Range("B56:S57").Borders(xlInsid
06853  |'        .LineStyle = xlContinuous                ||06850  |'        .LineStyle = xlContinuous                
06854  |'        .Weight = xlThin                         ||06851  |'        .Weight = xlThin                         
06855  |'    End With                                     ||06852  |'    End With                                     
06856  |'    '月末純資産(左側捺印欄　縦線)                ||06853  |'    '月末純資産(左側捺印欄　縦線)                
06857  |'    With xlSheet.Range("J57:J63").Borders(xlEdgeR||06854  |'    With xlSheet.Range("J57:J63").Borders(xlEdgeR
06858  |'        .LineStyle = xlContinuous                ||06855  |'        .LineStyle = xlContinuous                
06859  |'        .Weight = xlThin                         ||06856  |'        .Weight = xlThin                         
06860  |'    End With                                     ||06857  |'    End With                                     
06861  |'    '月末純資産(右側捺印欄　外枠)                ||06858  |'    '月末純資産(右側捺印欄　外枠)                
06862  |'    With xlSheet.Range("X56:AO63").Borders(xlEdge||06859  |'    With xlSheet.Range("X56:AO63").Borders(xlEdge
06863  |'        .LineStyle = xlContinuous                ||06860  |'        .LineStyle = xlContinuous                
06864  |'        .Weight = xlThin                         ||06861  |'        .Weight = xlThin                         
06865  |'    End With                                     ||06862  |'    End With                                     
06866  |'    With xlSheet.Range("X56:AO63").Borders(xlEdge||06863  |'    With xlSheet.Range("X56:AO63").Borders(xlEdge
06867  |'        .LineStyle = xlContinuous                ||06864  |'        .LineStyle = xlContinuous                
06868  |'        .Weight = xlThin                         ||06865  |'        .Weight = xlThin                         
06869  |'    End With                                     ||06866  |'    End With                                     
06870  |'    With xlSheet.Range("X56:AO63").Borders(xlEdge||06867  |'    With xlSheet.Range("X56:AO63").Borders(xlEdge
06871  |'        .LineStyle = xlContinuous                ||06868  |'        .LineStyle = xlContinuous                
06872  |'        .Weight = xlThin                         ||06869  |'        .Weight = xlThin                         
06873  |'    End With                                     ||06870  |'    End With                                     
06874  |'    With xlSheet.Range("X56:AO63").Borders(xlEdge||06871  |'    With xlSheet.Range("X56:AO63").Borders(xlEdge
06875  |'        .LineStyle = xlContinuous                ||06872  |'        .LineStyle = xlContinuous                
06876  |'        .Weight = xlThin                         ||06873  |'        .Weight = xlThin                         
06877  |'    End With                                     ||06874  |'    End With                                     
06878  |'    '月末純資産(右側捺印欄　上枠)                ||06875  |'    '月末純資産(右側捺印欄　上枠)                
06879  |'    With xlSheet.Range("X56:AO57").Borders(xlEdge||06876  |'    With xlSheet.Range("X56:AO57").Borders(xlEdge
06880  |'        .LineStyle = xlContinuous                ||06877  |'        .LineStyle = xlContinuous                
06881  |'        .Weight = xlThin                         ||06878  |'        .Weight = xlThin                         
06882  |'    End With                                     ||06879  |'    End With                                     
06883  |'    With xlSheet.Range("X56:AO57").Borders(xlEdge||06880  |'    With xlSheet.Range("X56:AO57").Borders(xlEdge
06884  |'        .LineStyle = xlContinuous                ||06881  |'        .LineStyle = xlContinuous                
06885  |'        .Weight = xlThin                         ||06882  |'        .Weight = xlThin                         
06886  |'    End With                                     ||06883  |'    End With                                     
06887  |'    With xlSheet.Range("X56:AO57").Borders(xlInsi||06884  |'    With xlSheet.Range("X56:AO57").Borders(xlInsi
06888  |'        .LineStyle = xlContinuous                ||06885  |'        .LineStyle = xlContinuous                
06889  |'        .Weight = xlThin                         ||06886  |'        .Weight = xlThin                         
06890  |'    End With                                     ||06887  |'    End With                                     
06891  |'    '月末純資産(右側捺印欄　縦線)                ||06888  |'    '月末純資産(右側捺印欄　縦線)                
06892  |'    With xlSheet.Range("AF57:AF63").Borders(xlEdg||06889  |'    With xlSheet.Range("AF57:AF63").Borders(xlEdg
06893  |'        .LineStyle = xlContinuous                ||06890  |'        .LineStyle = xlContinuous                
06894  |'        .Weight = xlThin                         ||06891  |'        .Weight = xlThin                         
06895  |'    End With                                     ||06892  |'    End With                                     
06896  |'                                                 ||06893  |'                                                 
06897  |''2005/01/17 Start                                ||06894  |''2005/01/17 Start                                
06898  |''    '換算(外枠)                                 ||06895  |''    '換算(外枠)                                 
06899  |'''    With xlSheet.Range("AN19:BF28").Borders(xlE||06896  |'''    With xlSheet.Range("AN19:BF28").Borders(xlE
06900  |'''        .LineStyle = xlContinuous              ||06897  |'''        .LineStyle = xlContinuous              
06901  |'''        .Weight = xlThin                       ||06898  |'''        .Weight = xlThin                       
06902  |'''    End With                                   ||06899  |'''    End With                                   
06903  |'''    With xlSheet.Range("AN19:BF28").Borders(xlE||06900  |'''    With xlSheet.Range("AN19:BF28").Borders(xlE
06904  |'''        .LineStyle = xlContinuous              ||06901  |'''        .LineStyle = xlContinuous              
06905  |'''        .Weight = xlThin                       ||06902  |'''        .Weight = xlThin                       
06906  |'''    End With                                   ||06903  |'''    End With                                   
06907  |'''    With xlSheet.Range("AN19:BF28").Borders(xlE||06904  |'''    With xlSheet.Range("AN19:BF28").Borders(xlE
06908  |'''        .LineStyle = xlContinuous              ||06905  |'''        .LineStyle = xlContinuous              
06909  |'''        .Weight = xlThin                       ||06906  |'''        .Weight = xlThin                       
06910  |'''    End With                                   ||06907  |'''    End With                                   
06911  |'''    With xlSheet.Range("AN19:BF28").Borders(xlE||06908  |'''    With xlSheet.Range("AN19:BF28").Borders(xlE
06912  |'''        .LineStyle = xlContinuous              ||06909  |'''        .LineStyle = xlContinuous              
06913  |'''        .Weight = xlThin                       ||06910  |'''        .Weight = xlThin                       
06914  |'''    End With                                   ||06911  |'''    End With                                   
06915  |'''    With xlSheet.Range("AN19:BF28").Borders(xlI||06912  |'''    With xlSheet.Range("AN19:BF28").Borders(xlI
06916  |'''        .LineStyle = xlContinuous              ||06913  |'''        .LineStyle = xlContinuous              
06917  |'''        .Weight = xlThin                       ||06914  |'''        .Weight = xlThin                       
06918  |'''    End With                                   ||06915  |'''    End With                                   
06919  |''    '換算(縦線)                                 ||06916  |''    '換算(縦線)                                 
06920  |''    With xlSheet.Range("AM19:AM28").Borders(xlEd||06917  |''    With xlSheet.Range("AM19:AM28").Borders(xlEd
06921  |''        .LineStyle = xlContinuous               ||06918  |''        .LineStyle = xlContinuous               
06922  |''        .Weight = xlThin                        ||06919  |''        .Weight = xlThin                        
06923  |''    End With                                    ||06920  |''    End With                                    
06924  |''    With xlSheet.Range("AT19:AT28").Borders(xlEd||06921  |''    With xlSheet.Range("AT19:AT28").Borders(xlEd
06925  |''        .LineStyle = xlContinuous               ||06922  |''        .LineStyle = xlContinuous               
06926  |''        .Weight = xlThin                        ||06923  |''        .Weight = xlThin                        
06927  |''    End With                                    ||06924  |''    End With                                    
06928  |''    With xlSheet.Range("BA19:BA28").Borders(xlEd||06925  |''    With xlSheet.Range("BA19:BA28").Borders(xlEd
06929  |''        .LineStyle = xlContinuous               ||06926  |''        .LineStyle = xlContinuous               
06930  |''        .Weight = xlThin                        ||06927  |''        .Weight = xlThin                        
06931  |''    End With                                    ||06928  |''    End With                                    
06932  |''    With xlSheet.Range("BF19:BF28").Borders(xlEd||06929  |''    With xlSheet.Range("BF19:BF28").Borders(xlEd
06933  |''        .LineStyle = xlContinuous               ||06930  |''        .LineStyle = xlContinuous               
06934  |''        .Weight = xlThin                        ||06931  |''        .Weight = xlThin                        
06935  |''    End With                                    ||06932  |''    End With                                    
06936  |''                                                ||06933  |''                                                
06937  |''    '換算(横線)                                 ||06934  |''    '換算(横線)                                 
06938  |''    With xlSheet.Range("AN18:BF18").Borders(xlEd||06935  |''    With xlSheet.Range("AN18:BF18").Borders(xlEd
06939  |''        .LineStyle = xlContinuous               ||06936  |''        .LineStyle = xlContinuous               
06940  |''        .Weight = xlThin                        ||06937  |''        .Weight = xlThin                        
06941  |''    End With                                    ||06938  |''    End With                                    
06942  |''    With xlSheet.Range("AN20:BF20").Borders(xlEd||06939  |''    With xlSheet.Range("AN20:BF20").Borders(xlEd
06943  |''        .LineStyle = xlContinuous               ||06940  |''        .LineStyle = xlContinuous               
06944  |''        .Weight = xlThin                        ||06941  |''        .Weight = xlThin                        
06945  |''    End With                                    ||06942  |''    End With                                    
06946  |''    With xlSheet.Range("AN22:BF22").Borders(xlEd||06943  |''    With xlSheet.Range("AN22:BF22").Borders(xlEd
06947  |''        .LineStyle = xlContinuous               ||06944  |''        .LineStyle = xlContinuous               
06948  |''        .Weight = xlThin                        ||06945  |''        .Weight = xlThin                        
06949  |''    End With                                    ||06946  |''    End With                                    
06950  |''    With xlSheet.Range("AN24:BF24").Borders(xlEd||06947  |''    With xlSheet.Range("AN24:BF24").Borders(xlEd
06951  |''        .LineStyle = xlContinuous               ||06948  |''        .LineStyle = xlContinuous               
06952  |''        .Weight = xlThin                        ||06949  |''        .Weight = xlThin                        
06953  |''    End With                                    ||06950  |''    End With                                    
06954  |''    With xlSheet.Range("AN26:BF26").Borders(xlEd||06951  |''    With xlSheet.Range("AN26:BF26").Borders(xlEd
06955  |''        .LineStyle = xlContinuous               ||06952  |''        .LineStyle = xlContinuous               
06956  |''        .Weight = xlThin                        ||06953  |''        .Weight = xlThin                        
06957  |''    End With                                    ||06954  |''    End With                                    
06958  |''    With xlSheet.Range("AN28:BF28").Borders(xlEd||06955  |''    With xlSheet.Range("AN28:BF28").Borders(xlEd
06959  |''        .LineStyle = xlContinuous               ||06956  |''        .LineStyle = xlContinuous               
06960  |''        .Weight = xlThin                        ||06957  |''        .Weight = xlThin                        
06961  |''    End With                                    ||06958  |''    End With                                    
06962  |''                                                ||06959  |''                                                
06963  |'''    '換算(横線)                                ||06960  |'''    '換算(横線)                                
06964  |'''    With xlSheet.Range("AN19:BF20").Borders(xlE||06961  |'''    With xlSheet.Range("AN19:BF20").Borders(xlE
06965  |'''        .LineStyle = xlContinuous              ||06962  |'''        .LineStyle = xlContinuous              
06966  |'''        .Weight = xlThin                       ||06963  |'''        .Weight = xlThin                       
06967  |'''    End With                                   ||06964  |'''    End With                                   
06968  |'''    With xlSheet.Range("AN21:BF22").Borders(xlE||06965  |'''    With xlSheet.Range("AN21:BF22").Borders(xlE
06969  |'''        .LineStyle = xlContinuous              ||06966  |'''        .LineStyle = xlContinuous              
06970  |'''        .Weight = xlThin                       ||06967  |'''        .Weight = xlThin                       
06971  |'''    End With                                   ||06968  |'''    End With                                   
06972  |'''    With xlSheet.Range("AN23:BF24").Borders(xlE||06969  |'''    With xlSheet.Range("AN23:BF24").Borders(xlE
06973  |'''        .LineStyle = xlContinuous              ||06970  |'''        .LineStyle = xlContinuous              
06974  |'''        .Weight = xlThin                       ||06971  |'''        .Weight = xlThin                       
06975  |'''    End With                                   ||06972  |'''    End With                                   
06976  |'''    With xlSheet.Range("AN25:BF26").Borders(xlE||06973  |'''    With xlSheet.Range("AN25:BF26").Borders(xlE
06977  |'''        .LineStyle = xlContinuous              ||06974  |'''        .LineStyle = xlContinuous              
06978  |'''        .Weight = xlThin                       ||06975  |'''        .Weight = xlThin                       
06979  |'''    End With                                   ||06976  |'''    End With                                   
06980  |'''2005/01/12 End                                 ||06977  |'''2005/01/12 End                                 
06981  |''2005/01/17 End                                  ||06978  |''2005/01/17 End                                  
06982  |'                                                 ||06979  |'                                                 
06983  |'    '月末純資産　下線                            ||06980  |'    '月末純資産　下線                            
06984  |''        xlSheet.Range("K36:Z36").Select         ||06981  |''        xlSheet.Range("K36:Z36").Select         
06985  |''        With Selection.Borders(xlEdgeBottom)    ||06982  |''        With Selection.Borders(xlEdgeBottom)    
06986  |''            .LineStyle = xlContinuous           ||06983  |''            .LineStyle = xlContinuous           
06987  |''            .Weight = xlThin                    ||06984  |''            .Weight = xlThin                    
06988  |''        End With                                ||06985  |''        End With                                
06989  |''                                                ||06986  |''                                                
06990  |''        xlSheet.Range("AL36:AZ36").Select       ||06987  |''        xlSheet.Range("AL36:AZ36").Select       
06991  |''        With Selection.Borders(xlEdgeBottom)    ||06988  |''        With Selection.Borders(xlEdgeBottom)    
06992  |''            .LineStyle = xlContinuous           ||06989  |''            .LineStyle = xlContinuous           
06993  |''            .Weight = xlThin                    ||06990  |''            .Weight = xlThin                    
06994  |''        End With                                ||06991  |''        End With                                
06995  |'                                                 ||06992  |'                                                 
06996  |''2005/03/09 Start                                ||06993  |''2005/03/09 Start                                
06997  |''2005/03/18 Start                                ||06994  |''2005/03/18 Start                                
06998  |''2005/03/25 Start                                ||06995  |''2005/03/25 Start                                
06999  |''                If gbuMGetUPDRec.N(lRecIdx).MGET||06996  |''                If gbuMGetUPDRec.N(lRecIdx).MGET
07000  |''                And gbuMGetUPDRec.N(lRecIdx).MGE||06997  |''                And gbuMGetUPDRec.N(lRecIdx).MGE
07001  |'                If Mid(gbuMGetUPDRec.N(lRecIdx).M||06998  |'                If Mid(gbuMGetUPDRec.N(lRecIdx).M
07002  |'                And gbuMGetUPDRec.N(lRecIdx).MGET||06999  |'                And gbuMGetUPDRec.N(lRecIdx).MGET
07003  |''2005/03/25 End                                  ||07000  |''2005/03/25 End                                  
07004  |'                    xlSheet.Cells(15, 13).Value =||07001  |'                    xlSheet.Cells(15, 13).Value =
07005  |'                        CStr(Format(dStart, "YYYY||07002  |'                        CStr(Format(dStart, "YYYY
07006  |'                Else                             ||07003  |'                Else                             
07007  |'                    xlSheet.Cells(15, 13).Value =||07004  |'                    xlSheet.Cells(15, 13).Value =
07008  |'                        CStr(Format(dStart, "YYYY||07005  |'                        CStr(Format(dStart, "YYYY
07009  |'                End If                           ||07006  |'                End If                           
07010  |''2005/03/18 End                                  ||07007  |''2005/03/18 End                                  
07011  |'    'A4印刷用に上2行を削除して、プレビュー範囲内 ||07008  |'    'A4印刷用に上2行を削除して、プレビュー範囲内 
07012  |'    xlSheet.Rows("1:2").Delete Shift:=xlUp       ||07009  |'    xlSheet.Rows("1:2").Delete Shift:=xlUp       
07013  |'                                                 ||07010  |'                                                 
07014  |''2005/03/15 Start                                ||07011  |''2005/03/15 Start                                
07015  |'''2005/03/09 Start                               ||07012  |'''2005/03/09 Start                               
07016  |''''契約区分：外部委託顧問料計算　＆　NAV取得区分 ||07013  |''''契約区分：外部委託顧問料計算　＆　NAV取得区分 
07017  |'''                                               ||07014  |'''                                               
07018  |'''    If gbuMGetUPDRec.N(lRecIdx).MGET_contract_f||07015  |'''    If gbuMGetUPDRec.N(lRecIdx).MGET_contract_f
07019  |'''    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||07016  |'''    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
07020  |'''契約区分：名称使用許諾料　＆　NAV取得区分：日次||07017  |'''契約区分：名称使用許諾料　＆　NAV取得区分：日次
07021  |'''　　　　　　　　　　　　　　　　　　　　　　日 ||07018  |'''　　　　　　　　　　　　　　　　　　　　　　日 
07022  |''    If gbuMGetUPDRec.N(lRecIdx).MGET_contract_fl||07019  |''    If gbuMGetUPDRec.N(lRecIdx).MGET_contract_fl
07023  |''    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_fl||07020  |''    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_fl
07024  |''        TotalNav = dstrAvgNav                   ||07021  |''        TotalNav = dstrAvgNav                   
07025  |''    Else                                        ||07022  |''    Else                                        
07026  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_contrac||07023  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_contrac
07027  |''        And gbuMGetUPDRec.N(lRecIdx).MGET_nav_ge||07024  |''        And gbuMGetUPDRec.N(lRecIdx).MGET_nav_ge
07028  |''            TotalNav = dstrAvgNav               ||07025  |''            TotalNav = dstrAvgNav               
07029  |''            AvgNav = dstrAvgNav                 ||07026  |''            AvgNav = dstrAvgNav                 
07030  |''        End If                                  ||07027  |''        End If                                  
07031  |''    End If                                      ||07028  |''    End If                                      
07032  |''2005/03/15 End                                  ||07029  |''2005/03/15 End                                  
07033  |'                                                 ||07030  |'                                                 
07034  |''NAV取得区分：日次NAV平均(休日有)または日次NAV平 ||07031  |''NAV取得区分：日次NAV平均(休日有)または日次NAV平 
07035  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||07032  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
07036  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||07033  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
07037  |'                                                 ||07034  |'                                                 
07038  |''2005/03/09 End                                  ||07035  |''2005/03/09 End                                  
07039  |'                                                 ||07036  |'                                                 
07040  |'        J = 0                                    ||07037  |'        J = 0                                    
07041  |'        K = 0                                    ||07038  |'        K = 0                                    
07042  |'        '＋２は合計行と平均行                    ||07039  |'        '＋２は合計行と平均行                    
07043  |'        dintPage = (dlngCnt + 2) \ 108           ||07040  |'        dintPage = (dlngCnt + 2) \ 108           
07044  |'        dintAmari = (dlngCnt + 2) Mod 108        ||07041  |'        dintAmari = (dlngCnt + 2) Mod 108        
07045  |'        If dintAmari <> 0 Then                   ||07042  |'        If dintAmari <> 0 Then                   
07046  |'            dintPage = dintPage + 1              ||07043  |'            dintPage = dintPage + 1              
07047  |'        End If                                   ||07044  |'        End If                                   
07048  |'                                                 ||07045  |'                                                 
07049  |'        For L = 1 To dintPage                    ||07046  |'        For L = 1 To dintPage                    
07050  |'                                                 ||07047  |'                                                 
07051  |'            xlBook.Worksheets.Add after:=xlBook.S||07048  |'            xlBook.Worksheets.Add after:=xlBook.S
07052  |'            gProcessCnt = gProcessCnt + 1        ||07049  |'            gProcessCnt = gProcessCnt + 1        
07053  |'            Set xlSheet = xlBook.Sheets(gProcessC||07050  |'            Set xlSheet = xlBook.Sheets(gProcessC
07054  |'                                                 ||07051  |'                                                 
07055  |'            'Excelフォーマットを調整             ||07052  |'            'Excelフォーマットを調整             
07056  |'            xlSheet.Cells.ColumnWidth = 1        ||07053  |'            xlSheet.Cells.ColumnWidth = 1        
07057  |'            xlSheet.Cells.Font.Size = 11         ||07054  |'            xlSheet.Cells.Font.Size = 11         
07058  |'            'シート名を設定(日次NAV一覧**)       ||07055  |'            'シート名を設定(日次NAV一覧**)       
07059  |'                                                 ||07056  |'                                                 
07060  |''2005/03/09 Start                                ||07057  |''2005/03/09 Start                                
07061  |''            xlBook.Sheets(gProcessCnt).Name = sG||07058  |''            xlBook.Sheets(gProcessCnt).Name = sG
07062  |'            If dstrOldAccCode = sGetAccCode Then ||07059  |'            If dstrOldAccCode = sGetAccCode Then 
07063  |'                gTotalDnavCnt = gTotalDnavCnt + 1||07060  |'                gTotalDnavCnt = gTotalDnavCnt + 1
07064  |'            Else                                 ||07061  |'            Else                                 
07065  |'                gTotalDnavCnt = 1                ||07062  |'                gTotalDnavCnt = 1                
07066  |'                dstrOldAccCode = sGetAccCode     ||07063  |'                dstrOldAccCode = sGetAccCode     
07067  |'            End If                               ||07064  |'            End If                               
07068  |'            gTotalCnt = gTotalCnt + 1            ||07065  |'            gTotalCnt = gTotalCnt + 1            
07069  |'            xlBook.Sheets(gProcessCnt).Name = sGe||07066  |'            xlBook.Sheets(gProcessCnt).Name = sGe
07070  |''2005/03/09 End                                  ||07067  |''2005/03/09 End                                  
07071  |'            'シートの余白を設定                  ||07068  |'            'シートの余白を設定                  
07072  |'            xlSheet.PageSetup.TopMargin = Applica||07069  |'            xlSheet.PageSetup.TopMargin = Applica
07073  |'            xlSheet.PageSetup.BottomMargin = Appl||07070  |'            xlSheet.PageSetup.BottomMargin = Appl
07074  |'            xlSheet.PageSetup.LeftMargin = Applic||07071  |'            xlSheet.PageSetup.LeftMargin = Applic
07075  |'            xlSheet.PageSetup.RightMargin = Appli||07072  |'            xlSheet.PageSetup.RightMargin = Appli
07076  |'                                                 ||07073  |'                                                 
07077  |'            DoEvents                             ||07074  |'            DoEvents                             
07078  |'                                                 ||07075  |'                                                 
07079  |'            With xlSheet                         ||07076  |'            With xlSheet                         
07080  |'                '題目                            ||07077  |'                '題目                            
07081  |'                .Cells(5, 1).Value = sWord47     ||07078  |'                .Cells(5, 1).Value = sWord47     
07082  |'                .Cells(5, 1).Font.Size = 14      ||07079  |'                .Cells(5, 1).Font.Size = 14      
07083  |'                .Range("A5:BG5").HorizontalAlignm||07080  |'                .Range("A5:BG5").HorizontalAlignm
07084  |'                '出力日付                        ||07081  |'                '出力日付                        
07085  |'                If RTrim(txtSysOutDate.Text) = ""||07082  |'                If RTrim(txtSysOutDate.Text) = ""
07086  |'                    .Cells(3, 50).Value = sWord34||07083  |'                    .Cells(3, 50).Value = sWord34
07087  |'                    .Cells(3, 50).HorizontalAlign||07084  |'                    .Cells(3, 50).HorizontalAlign
07088  |'                Else                             ||07085  |'                Else                             
07089  |'                    .Cells(3, 43).Value = CStr(Fo||07086  |'                    .Cells(3, 43).Value = CStr(Fo
07090  |'                End If                           ||07087  |'                End If                           
07091  |'                'ファンド名                      ||07088  |'                'ファンド名                      
07092  |'                .Cells(6, 2).Value = sWord4      ||07089  |'                .Cells(6, 2).Value = sWord4      
07093  |'                .Cells(6, 11).Value = sWord19    ||07090  |'                .Cells(6, 11).Value = sWord19    
07094  |'                .Cells(6, 13).Value = gbuMGetUPDR||07091  |'                .Cells(6, 13).Value = gbuMGetUPDR
07095  |'                'ファンドコード                  ||07092  |'                'ファンドコード                  
07096  |'                .Cells(7, 2).Value = sWord4_2    ||07093  |'                .Cells(7, 2).Value = sWord4_2    
07097  |'                .Cells(7, 11).Value = sWord19    ||07094  |'                .Cells(7, 11).Value = sWord19    
07098  |'                .Cells(7, 13).NumberFormatLocal =||07095  |'                .Cells(7, 13).NumberFormatLocal =
07099  |'                .Cells(7, 13).Value = sGetAccCode||07096  |'                .Cells(7, 13).Value = sGetAccCode
07100  |'                '計算期間                        ||07097  |'                '計算期間                        
07101  |'                .Cells(8, 2).Value = sWord5      ||07098  |'                .Cells(8, 2).Value = sWord5      
07102  |'                .Cells(8, 11).Value = sWord19    ||07099  |'                .Cells(8, 11).Value = sWord19    
07103  |''2005/03/18 Start                                ||07100  |''2005/03/18 Start                                
07104  |''                .Cells(8, 13).Value = _         ||07101  |''                .Cells(8, 13).Value = _         
07105  |''                    CStr(Format(dStart, "YYYY年M||07102  |''                    CStr(Format(dStart, "YYYY年M
07106  |''                    CStr(Format(dEnd, "YYYY年M月||07103  |''                    CStr(Format(dEnd, "YYYY年M月
07107  |''                    (DateDiff("d", dStart, dEnd)||07104  |''                    (DateDiff("d", dStart, dEnd)
07108  |''2005/03/25 Start                                ||07105  |''2005/03/25 Start                                
07109  |''                If gbuMGetUPDRec.N(lRecIdx).MGET||07106  |''                If gbuMGetUPDRec.N(lRecIdx).MGET
07110  |''                And gbuMGetUPDRec.N(lRecIdx).MGE||07107  |''                And gbuMGetUPDRec.N(lRecIdx).MGE
07111  |'                If Mid(gbuMGetUPDRec.N(lRecIdx).M||07108  |'                If Mid(gbuMGetUPDRec.N(lRecIdx).M
07112  |'                And gbuMGetUPDRec.N(lRecIdx).MGET||07109  |'                And gbuMGetUPDRec.N(lRecIdx).MGET
07113  |''2005/03/25 End                                  ||07110  |''2005/03/25 End                                  
07114  |'                    .Cells(8, 13).Value = _      ||07111  |'                    .Cells(8, 13).Value = _      
07115  |'                        CStr(Format(dStart, "YYYY||07112  |'                        CStr(Format(dStart, "YYYY
07116  |'                Else                             ||07113  |'                Else                             
07117  |'                    .Cells(8, 13).Value = _      ||07114  |'                    .Cells(8, 13).Value = _      
07118  |'                        CStr(Format(dStart, "YYYY||07115  |'                        CStr(Format(dStart, "YYYY
07119  |'                End If                           ||07116  |'                End If                           
07120  |''2005/03/18 End                                  ||07117  |''2005/03/18 End                                  
07121  |'                '日付                            ||07118  |'                '日付                            
07122  |'                .Cells(10, 3).Value = sWord7     ||07119  |'                .Cells(10, 3).Value = sWord7     
07123  |'                .Range("C10:N10").HorizontalAlign||07120  |'                .Range("C10:N10").HorizontalAlign
07124  |'                '純資産                          ||07121  |'                '純資産                          
07125  |'                .Cells(10, 15).Value = sWord8    ||07122  |'                .Cells(10, 15).Value = sWord8    
07126  |'                .Range("O10:AC10").HorizontalAlig||07123  |'                .Range("O10:AC10").HorizontalAlig
07127  |'                '日付                            ||07124  |'                '日付                            
07128  |'                .Cells(10, 31).Value = sWord7    ||07125  |'                .Cells(10, 31).Value = sWord7    
07129  |'                .Range("AE10:AP10").HorizontalAli||07126  |'                .Range("AE10:AP10").HorizontalAli
07130  |'                '純資産                          ||07127  |'                '純資産                          
07131  |'                .Cells(10, 43).Value = sWord8    ||07128  |'                .Cells(10, 43).Value = sWord8    
07132  |'                .Range("AQ10:BE10").HorizontalAli||07129  |'                .Range("AQ10:BE10").HorizontalAli
07133  |'                '日付＆NAV                       ||07130  |'                '日付＆NAV                       
07134  |'                Select Case L                    ||07131  |'                Select Case L                    
07135  |'                    Case 1                       ||07132  |'                    Case 1                       
07136  |'                        dintPageIni = 1          ||07133  |'                        dintPageIni = 1          
07137  |'                    Case Else                    ||07134  |'                    Case Else                    
07138  |'                        dintPageIni = dintPageIni||07135  |'                        dintPageIni = dintPageIni
07139  |'                End Select                       ||07136  |'                End Select                       
07140  |'                For dintFor = dintPageIni To dlng||07137  |'                For dintFor = dintPageIni To dlng
07141  |'                    If J < 54 Then               ||07138  |'                    If J < 54 Then               
07142  |'                        If dintFor = dlngCnt + 1 ||07139  |'                        If dintFor = dlngCnt + 1 
07143  |'                            '合計                ||07140  |'                            '合計                
07144  |'                            .Cells(11 + J, 3).Val||07141  |'                            .Cells(11 + J, 3).Val
07145  |'                            'NAV                 ||07142  |'                            'NAV                 
07146  |'                            .Cells(11 + J, 28).Nu||07143  |'                            .Cells(11 + J, 28).Nu
07147  |'                            If gbuMGetUPDRec.N(lR||07144  |'                            If gbuMGetUPDRec.N(lR
07148  |'                                .Cells(11 + J, 28||07145  |'                                .Cells(11 + J, 28
07149  |'                            Else                 ||07146  |'                            Else                 
07150  |'                                .Cells(11 + J, 28||07147  |'                                .Cells(11 + J, 28
07151  |'                            End If               ||07148  |'                            End If               
07152  |'                            .Cells(11 + J, 28).Ho||07149  |'                            .Cells(11 + J, 28).Ho
07153  |'                        End If                   ||07150  |'                        End If                   
07154  |''2005/03/15 Start                                ||07151  |''2005/03/15 Start                                
07155  |''                        If gbuMGetUPDRec.N(lRecI||07152  |''                        If gbuMGetUPDRec.N(lRecI
07156  |''2005/03/15 End                                  ||07153  |''2005/03/15 End                                  
07157  |'                            If dintFor = dlngCnt ||07154  |'                            If dintFor = dlngCnt 
07158  |'                                '平均            ||07155  |'                                '平均            
07159  |'                                .Cells(11 + J, 3)||07156  |'                                .Cells(11 + J, 3)
07160  |'                                'NAV             ||07157  |'                                'NAV             
07161  |'                                .Cells(11 + J, 28||07158  |'                                .Cells(11 + J, 28
07162  |'                                If gbuMGetUPDRec.||07159  |'                                If gbuMGetUPDRec.
07163  |'                                    .Cells(11 + J||07160  |'                                    .Cells(11 + J
07164  |'                                Else             ||07161  |'                                Else             
07165  |'                                    .Cells(11 + J||07162  |'                                    .Cells(11 + J
07166  |'                                End If           ||07163  |'                                End If           
07167  |'                                .Cells(11 + J, 28||07164  |'                                .Cells(11 + J, 28
07168  |'                            End If               ||07165  |'                            End If               
07169  |''2005/03/15 Start                                ||07166  |''2005/03/15 Start                                
07170  |''                        End If                  ||07167  |''                        End If                  
07171  |''2005/03/15 End                                  ||07168  |''2005/03/15 End                                  
07172  |'                        If dintFor < dlngCnt + 1 ||07169  |'                        If dintFor < dlngCnt + 1 
07173  |'                            '日付                ||07170  |'                            '日付                
07174  |'                            dCalDate = CDate(gstr||07171  |'                            dCalDate = CDate(gstr
07175  |'                            .Cells(11 + J, 4).Val||07172  |'                            .Cells(11 + J, 4).Val
07176  |'                                CStr(Format(dCalD||07173  |'                                CStr(Format(dCalD
07177  |'                            'NAV                 ||07174  |'                            'NAV                 
07178  |'                            .Cells(11 + J, 28).Nu||07175  |'                            .Cells(11 + J, 28).Nu
07179  |'                            If gbuMGetUPDRec.N(lR||07176  |'                            If gbuMGetUPDRec.N(lR
07180  |'                                .Cells(11 + J, 28||07177  |'                                .Cells(11 + J, 28
07181  |'                            Else                 ||07178  |'                            Else                 
07182  |'                                .Cells(11 + J, 28||07179  |'                                .Cells(11 + J, 28
07183  |'                            End If               ||07180  |'                            End If               
07184  |'                            .Cells(11 + J, 28).Ho||07181  |'                            .Cells(11 + J, 28).Ho
07185  |'                        End If                   ||07182  |'                        End If                   
07186  |'                    Else                         ||07183  |'                    Else                         
07187  |'                        If dintFor = dlngCnt + 1 ||07184  |'                        If dintFor = dlngCnt + 1 
07188  |'                            '合計                ||07185  |'                            '合計                
07189  |'                            .Cells(11 + K, 31).Va||07186  |'                            .Cells(11 + K, 31).Va
07190  |'                            'NAV                 ||07187  |'                            'NAV                 
07191  |'                            .Cells(11 + K, 56).Nu||07188  |'                            .Cells(11 + K, 56).Nu
07192  |'                            If gbuMGetUPDRec.N(lR||07189  |'                            If gbuMGetUPDRec.N(lR
07193  |'                                .Cells(11 + K, 56||07190  |'                                .Cells(11 + K, 56
07194  |'                            Else                 ||07191  |'                            Else                 
07195  |'                                .Cells(11 + K, 56||07192  |'                                .Cells(11 + K, 56
07196  |'                            End If               ||07193  |'                            End If               
07197  |'                            .Cells(11 + K, 56).Ho||07194  |'                            .Cells(11 + K, 56).Ho
07198  |'                        End If                   ||07195  |'                        End If                   
07199  |''2005/03/15 Start                                ||07196  |''2005/03/15 Start                                
07200  |''                        If gbuMGetUPDRec.N(lRecI||07197  |''                        If gbuMGetUPDRec.N(lRecI
07201  |''2005/03/15 End                                  ||07198  |''2005/03/15 End                                  
07202  |'                            If dintFor = dlngCnt ||07199  |'                            If dintFor = dlngCnt 
07203  |'                                '平均            ||07200  |'                                '平均            
07204  |'                                .Cells(11 + K, 31||07201  |'                                .Cells(11 + K, 31
07205  |'                                'NAV             ||07202  |'                                'NAV             
07206  |'                                .Cells(11 + K, 56||07203  |'                                .Cells(11 + K, 56
07207  |'                                If gbuMGetUPDRec.||07204  |'                                If gbuMGetUPDRec.
07208  |'                                    .Cells(11 + K||07205  |'                                    .Cells(11 + K
07209  |'                                Else             ||07206  |'                                Else             
07210  |'                                    .Cells(11 + K||07207  |'                                    .Cells(11 + K
07211  |'                                End If           ||07208  |'                                End If           
07212  |'                                .Cells(11 + K, 56||07209  |'                                .Cells(11 + K, 56
07213  |'                            End If               ||07210  |'                            End If               
07214  |''2005/03/15 Start                                ||07211  |''2005/03/15 Start                                
07215  |''                        End If                  ||07212  |''                        End If                  
07216  |''2005/03/15 End                                  ||07213  |''2005/03/15 End                                  
07217  |'                        If dintFor < dlngCnt + 1 ||07214  |'                        If dintFor < dlngCnt + 1 
07218  |'                            '日付                ||07215  |'                            '日付                
07219  |'                            dCalDate = CDate(gstr||07216  |'                            dCalDate = CDate(gstr
07220  |'                            .Cells(11 + K, 32).Va||07217  |'                            .Cells(11 + K, 32).Va
07221  |'                                CStr(Format(dCalD||07218  |'                                CStr(Format(dCalD
07222  |'                            'NAV                 ||07219  |'                            'NAV                 
07223  |'                            .Cells(11 + K, 56).Nu||07220  |'                            .Cells(11 + K, 56).Nu
07224  |'                            If gbuMGetUPDRec.N(lR||07221  |'                            If gbuMGetUPDRec.N(lR
07225  |'                                .Cells(11 + K, 56||07222  |'                                .Cells(11 + K, 56
07226  |'                            Else                 ||07223  |'                            Else                 
07227  |'                                .Cells(11 + K, 56||07224  |'                                .Cells(11 + K, 56
07228  |'                            End If               ||07225  |'                            End If               
07229  |'                            .Cells(11 + K, 56).Ho||07226  |'                            .Cells(11 + K, 56).Ho
07230  |'                        End If                   ||07227  |'                        End If                   
07231  |'                        K = K + 1                ||07228  |'                        K = K + 1                
07232  |'                        If K > 53 Then           ||07229  |'                        If K > 53 Then           
07233  |'                            J = 0                ||07230  |'                            J = 0                
07234  |'                            K = 0                ||07231  |'                            K = 0                
07235  |'                            Exit For             ||07232  |'                            Exit For             
07236  |'                        End If                   ||07233  |'                        End If                   
07237  |'                    End If                       ||07234  |'                    End If                       
07238  |'                    J = J + 1                    ||07235  |'                    J = J + 1                    
07239  |'                Next dintFor                     ||07236  |'                Next dintFor                     
07240  |'                                                 ||07237  |'                                                 
07241  |'                '左側日付                        ||07238  |'                '左側日付                        
07242  |'                With xlSheet.Range("C10:N64").Bor||07239  |'                With xlSheet.Range("C10:N64").Bor
07243  |'                    .LineStyle = xlContinuous    ||07240  |'                    .LineStyle = xlContinuous    
07244  |'                    .Weight = xlThin             ||07241  |'                    .Weight = xlThin             
07245  |'                End With                         ||07242  |'                End With                         
07246  |'                With xlSheet.Range("C10:N64").Bor||07243  |'                With xlSheet.Range("C10:N64").Bor
07247  |'                    .LineStyle = xlContinuous    ||07244  |'                    .LineStyle = xlContinuous    
07248  |'                    .Weight = xlThin             ||07245  |'                    .Weight = xlThin             
07249  |'                End With                         ||07246  |'                End With                         
07250  |'                With xlSheet.Range("C10:N64").Bor||07247  |'                With xlSheet.Range("C10:N64").Bor
07251  |'                    .LineStyle = xlContinuous    ||07248  |'                    .LineStyle = xlContinuous    
07252  |'                    .Weight = xlThin             ||07249  |'                    .Weight = xlThin             
07253  |'                End With                         ||07250  |'                End With                         
07254  |'                With xlSheet.Range("C10:N64").Bor||07251  |'                With xlSheet.Range("C10:N64").Bor
07255  |'                    .LineStyle = xlContinuous    ||07252  |'                    .LineStyle = xlContinuous    
07256  |'                    .Weight = xlThin             ||07253  |'                    .Weight = xlThin             
07257  |'                End With                         ||07254  |'                End With                         
07258  |'                With xlSheet.Range("C10:N64").Bor||07255  |'                With xlSheet.Range("C10:N64").Bor
07259  |'                    .LineStyle = xlContinuous    ||07256  |'                    .LineStyle = xlContinuous    
07260  |'                    .Weight = xlThin             ||07257  |'                    .Weight = xlThin             
07261  |'                End With                         ||07258  |'                End With                         
07262  |'                                                 ||07259  |'                                                 
07263  |'                '左側純資産                      ||07260  |'                '左側純資産                      
07264  |'                With xlSheet.Range("O10:AC64").Bo||07261  |'                With xlSheet.Range("O10:AC64").Bo
07265  |'                    .LineStyle = xlContinuous    ||07262  |'                    .LineStyle = xlContinuous    
07266  |'                    .Weight = xlThin             ||07263  |'                    .Weight = xlThin             
07267  |'                End With                         ||07264  |'                End With                         
07268  |'                With xlSheet.Range("O10:AC64").Bo||07265  |'                With xlSheet.Range("O10:AC64").Bo
07269  |'                    .LineStyle = xlContinuous    ||07266  |'                    .LineStyle = xlContinuous    
07270  |'                    .Weight = xlThin             ||07267  |'                    .Weight = xlThin             
07271  |'                End With                         ||07268  |'                End With                         
07272  |'                With xlSheet.Range("O10:AC64").Bo||07269  |'                With xlSheet.Range("O10:AC64").Bo
07273  |'                    .LineStyle = xlContinuous    ||07270  |'                    .LineStyle = xlContinuous    
07274  |'                    .Weight = xlThin             ||07271  |'                    .Weight = xlThin             
07275  |'                End With                         ||07272  |'                End With                         
07276  |'                With xlSheet.Range("O10:AC64").Bo||07273  |'                With xlSheet.Range("O10:AC64").Bo
07277  |'                    .LineStyle = xlContinuous    ||07274  |'                    .LineStyle = xlContinuous    
07278  |'                    .Weight = xlThin             ||07275  |'                    .Weight = xlThin             
07279  |'                End With                         ||07276  |'                End With                         
07280  |'                With xlSheet.Range("O10:AC64").Bo||07277  |'                With xlSheet.Range("O10:AC64").Bo
07281  |'                    .LineStyle = xlContinuous    ||07278  |'                    .LineStyle = xlContinuous    
07282  |'                    .Weight = xlThin             ||07279  |'                    .Weight = xlThin             
07283  |'                End With                         ||07280  |'                End With                         
07284  |'                                                 ||07281  |'                                                 
07285  |'                '右側日付                        ||07282  |'                '右側日付                        
07286  |'                With xlSheet.Range("AE10:AP64").B||07283  |'                With xlSheet.Range("AE10:AP64").B
07287  |'                    .LineStyle = xlContinuous    ||07284  |'                    .LineStyle = xlContinuous    
07288  |'                    .Weight = xlThin             ||07285  |'                    .Weight = xlThin             
07289  |'                End With                         ||07286  |'                End With                         
07290  |'                With xlSheet.Range("AE10:AP64").B||07287  |'                With xlSheet.Range("AE10:AP64").B
07291  |'                    .LineStyle = xlContinuous    ||07288  |'                    .LineStyle = xlContinuous    
07292  |'                    .Weight = xlThin             ||07289  |'                    .Weight = xlThin             
07293  |'                End With                         ||07290  |'                End With                         
07294  |'                With xlSheet.Range("AE10:AP64").B||07291  |'                With xlSheet.Range("AE10:AP64").B
07295  |'                    .LineStyle = xlContinuous    ||07292  |'                    .LineStyle = xlContinuous    
07296  |'                    .Weight = xlThin             ||07293  |'                    .Weight = xlThin             
07297  |'                End With                         ||07294  |'                End With                         
07298  |'                With xlSheet.Range("AE10:AP64").B||07295  |'                With xlSheet.Range("AE10:AP64").B
07299  |'                    .LineStyle = xlContinuous    ||07296  |'                    .LineStyle = xlContinuous    
07300  |'                    .Weight = xlThin             ||07297  |'                    .Weight = xlThin             
07301  |'                End With                         ||07298  |'                End With                         
07302  |'                With xlSheet.Range("AE10:AP64").B||07299  |'                With xlSheet.Range("AE10:AP64").B
07303  |'                    .LineStyle = xlContinuous    ||07300  |'                    .LineStyle = xlContinuous    
07304  |'                    .Weight = xlThin             ||07301  |'                    .Weight = xlThin             
07305  |'                End With                         ||07302  |'                End With                         
07306  |'                                                 ||07303  |'                                                 
07307  |'                '右側純資産                      ||07304  |'                '右側純資産                      
07308  |'                With xlSheet.Range("AQ10:BE64").B||07305  |'                With xlSheet.Range("AQ10:BE64").B
07309  |'                    .LineStyle = xlContinuous    ||07306  |'                    .LineStyle = xlContinuous    
07310  |'                    .Weight = xlThin             ||07307  |'                    .Weight = xlThin             
07311  |'                End With                         ||07308  |'                End With                         
07312  |'                With xlSheet.Range("AQ10:BE64").B||07309  |'                With xlSheet.Range("AQ10:BE64").B
07313  |'                    .LineStyle = xlContinuous    ||07310  |'                    .LineStyle = xlContinuous    
07314  |'                    .Weight = xlThin             ||07311  |'                    .Weight = xlThin             
07315  |'                End With                         ||07312  |'                End With                         
07316  |'                With xlSheet.Range("AQ10:BE64").B||07313  |'                With xlSheet.Range("AQ10:BE64").B
07317  |'                    .LineStyle = xlContinuous    ||07314  |'                    .LineStyle = xlContinuous    
07318  |'                    .Weight = xlThin             ||07315  |'                    .Weight = xlThin             
07319  |'                End With                         ||07316  |'                End With                         
07320  |'                With xlSheet.Range("AQ10:BE64").B||07317  |'                With xlSheet.Range("AQ10:BE64").B
07321  |'                    .LineStyle = xlContinuous    ||07318  |'                    .LineStyle = xlContinuous    
07322  |'                    .Weight = xlThin             ||07319  |'                    .Weight = xlThin             
07323  |'                End With                         ||07320  |'                End With                         
07324  |'                With xlSheet.Range("AQ10:BE64").B||07321  |'                With xlSheet.Range("AQ10:BE64").B
07325  |'                    .LineStyle = xlContinuous    ||07322  |'                    .LineStyle = xlContinuous    
07326  |'                    .Weight = xlThin             ||07323  |'                    .Weight = xlThin             
07327  |'                End With                         ||07324  |'                End With                         
07328  |'                                                 ||07325  |'                                                 
07329  |'            End With                             ||07326  |'            End With                             
07330  |'            'A4印刷用に上2行を削除して、プレビュ ||07327  |'            'A4印刷用に上2行を削除して、プレビュ 
07331  |'            xlSheet.Rows("1:2").Delete Shift:=xlU||07328  |'            xlSheet.Rows("1:2").Delete Shift:=xlU
07332  |'        Next L                                   ||07329  |'        Next L                                   
07333  |'    End If                                       ||07330  |'    End If                                       
07334  |''2005/03/09 End                                  ||07331  |''2005/03/09 End                                  
07335  |'                                                 ||07332  |'                                                 
07336  |''2005/07/26 Start                                ||07333  |''2005/07/26 Start                                
07337  |'    'セル(A1)を選択する                          ||07334  |'    'セル(A1)を選択する                          
07338  |''    xlSheet.Cells(1, 1).Select                  ||07335  |''    xlSheet.Cells(1, 1).Select                  
07339  |''2005/07/26 End                                  ||07336  |''2005/07/26 End                                  
07340  |'                                                 ||07337  |'                                                 
07341  |''2005/03/09 Start                                ||07338  |''2005/03/09 Start                                
07342  |''    'A4印刷用に上2行を削除して、プレビュー範囲内||07339  |''    'A4印刷用に上2行を削除して、プレビュー範囲内
07343  |''    xlSheet.Rows("1:2").Delete Shift:=xlUp      ||07340  |''    xlSheet.Rows("1:2").Delete Shift:=xlUp      
07344  |''2005/03/09 End                                  ||07341  |''2005/03/09 End                                  
07345  |'                                                 ||07342  |'                                                 
07346  |''    '動的ファイル名部分を取得                   ||07343  |''    '動的ファイル名部分を取得                   
07347  |''    If gTotalProcessCnt = 1 Then                ||07344  |''    If gTotalProcessCnt = 1 Then                
07348  |''        Call sbFileNameChange                   ||07345  |''        Call sbFileNameChange                   
07349  |''    End If                                      ||07346  |''    End If                                      
07350  |''                                                ||07347  |''                                                
07351  |''    'Excel の Worksheet 削除用カウンタ初期化    ||07348  |''    'Excel の Worksheet 削除用カウンタ初期化    
07352  |''    Ws_Cnt = xlBook.Worksheets.Count            ||07349  |''    Ws_Cnt = xlBook.Worksheets.Count            
07353  |''    Ws_Del_Cnt2 = 0                             ||07350  |''    Ws_Del_Cnt2 = 0                             
07354  |''    '出力するデータ数のカウント(gSysoutDataCnt) ||07351  |''    '出力するデータ数のカウント(gSysoutDataCnt) 
07355  |''    If gTotalProcessCnt = gSysoutDataCnt Then   ||07352  |''    If gTotalProcessCnt = gSysoutDataCnt Then   
07356  |''        ' WorkBookが存在すれば削除              ||07353  |''        ' WorkBookが存在すれば削除              
07357  |''        If Dir(mstrFileName) <> "" Then         ||07354  |''        If Dir(mstrFileName) <> "" Then         
07358  |''            Kill (mstrFileName)                 ||07355  |''            Kill (mstrFileName)                 
07359  |''        End If                                  ||07356  |''        End If                                  
07360  |''                                                ||07357  |''                                                
07361  |''        'シート名を調査しシート削除             ||07358  |''        'シート名を調査しシート削除             
07362  |''        For Ws_Del_Cnt = 1 To Ws_Cnt            ||07359  |''        For Ws_Del_Cnt = 1 To Ws_Cnt            
07363  |''            If Left(xlBook.Worksheets(Ws_Del_Cnt||07360  |''            If Left(xlBook.Worksheets(Ws_Del_Cnt
07364  |''                'シートの削除                   ||07361  |''                'シートの削除                   
07365  |''                xlBook.Worksheets(Ws_Del_Cnt).De||07362  |''                xlBook.Worksheets(Ws_Del_Cnt).De
07366  |''                Ws_Del_Cnt = Ws_Del_Cnt - 1     ||07363  |''                Ws_Del_Cnt = Ws_Del_Cnt - 1     
07367  |''                Ws_Del_Cnt2 = Ws_Del_Cnt2 + 1   ||07364  |''                Ws_Del_Cnt2 = Ws_Del_Cnt2 + 1   
07368  |''                If Ws_Del_Cnt2 = 2 Then         ||07365  |''                If Ws_Del_Cnt2 = 2 Then         
07369  |''                    Exit For                    ||07366  |''                    Exit For                    
07370  |''                End If                          ||07367  |''                End If                          
07371  |''            End If                              ||07368  |''            End If                              
07372  |''        Next Ws_Del_Cnt                         ||07369  |''        Next Ws_Del_Cnt                         
07373  |''                                                ||07370  |''                                                
07374  |''        '見易いようにシートの1枚目を選択する    ||07371  |''        '見易いようにシートの1枚目を選択する    
07375  |''        xlBook.Worksheets(1).Select             ||07372  |''        xlBook.Worksheets(1).Select             
07376  |''                                                ||07373  |''                                                
07377  |''        xlBook.SaveAs mstrFileName              ||07374  |''        xlBook.SaveAs mstrFileName              
07378  |''        xlBook.Close                            ||07375  |''        xlBook.Close                            
07379  |''        xlApp.Quit                              ||07376  |''        xlApp.Quit                              
07380  |''                                                ||07377  |''                                                
07381  |''        Set xlApp = Nothing                     ||07378  |''        Set xlApp = Nothing                     
07382  |''        Set xlBook = Nothing                    ||07379  |''        Set xlBook = Nothing                    
07383  |''        Set xlSheet = Nothing                   ||07380  |''        Set xlSheet = Nothing                   
07384  |'                                                 ||07381  |'                                                 
07385  |''        '正常戻り値セット                       ||07382  |''        '正常戻り値セット                       
07386  |''        fnblExcelOut = True                     ||07383  |''        fnblExcelOut = True                     
07387  |''        GoTo EndProc                            ||07384  |''        GoTo EndProc                            
07388  |''    End If                                      ||07385  |''    End If                                      
07389  |''                                                ||07386  |''                                                
07390  |''    If gProcessCnt = conSheetLimit Then         ||07387  |''    If gProcessCnt = conSheetLimit Then         
07391  |''        ' WorkBookが存在すれば削除              ||07388  |''        ' WorkBookが存在すれば削除              
07392  |''        If Dir(mstrFileName) <> "" Then         ||07389  |''        If Dir(mstrFileName) <> "" Then         
07393  |''            Kill (mstrFileName)                 ||07390  |''            Kill (mstrFileName)                 
07394  |''        End If                                  ||07391  |''        End If                                  
07395  |''                                                ||07392  |''                                                
07396  |''        'シート名を調査しシート削除             ||07393  |''        'シート名を調査しシート削除             
07397  |''        For Ws_Del_Cnt = 1 To Ws_Cnt            ||07394  |''        For Ws_Del_Cnt = 1 To Ws_Cnt            
07398  |''            If Left(xlBook.Worksheets(Ws_Del_Cnt||07395  |''            If Left(xlBook.Worksheets(Ws_Del_Cnt
07399  |''                'シートの削除                   ||07396  |''                'シートの削除                   
07400  |''                xlBook.Worksheets(Ws_Del_Cnt).De||07397  |''                xlBook.Worksheets(Ws_Del_Cnt).De
07401  |''                Ws_Del_Cnt = Ws_Del_Cnt - 1     ||07398  |''                Ws_Del_Cnt = Ws_Del_Cnt - 1     
07402  |''                Ws_Del_Cnt2 = Ws_Del_Cnt2 + 1   ||07399  |''                Ws_Del_Cnt2 = Ws_Del_Cnt2 + 1   
07403  |''                If Ws_Del_Cnt2 = 2 Then         ||07400  |''                If Ws_Del_Cnt2 = 2 Then         
07404  |''                    Exit For                    ||07401  |''                    Exit For                    
07405  |''                End If                          ||07402  |''                End If                          
07406  |''            End If                              ||07403  |''            End If                              
07407  |''        Next Ws_Del_Cnt                         ||07404  |''        Next Ws_Del_Cnt                         
07408  |''                                                ||07405  |''                                                
07409  |''        '見易いようにシートの1枚目を選択する    ||07406  |''        '見易いようにシートの1枚目を選択する    
07410  |''        xlBook.Worksheets(1).Select             ||07407  |''        xlBook.Worksheets(1).Select             
07411  |''                                                ||07408  |''                                                
07412  |''        xlBook.SaveAs mstrFileName              ||07409  |''        xlBook.SaveAs mstrFileName              
07413  |''        xlBook.Close                            ||07410  |''        xlBook.Close                            
07414  |''        xlApp.Quit                              ||07411  |''        xlApp.Quit                              
07415  |''                                                ||07412  |''                                                
07416  |''        Set xlApp = Nothing                     ||07413  |''        Set xlApp = Nothing                     
07417  |''        Set xlBook = Nothing                    ||07414  |''        Set xlBook = Nothing                    
07418  |''        Set xlSheet = Nothing                   ||07415  |''        Set xlSheet = Nothing                   
07419  |''                                                ||07416  |''                                                
07420  |''        '処理回数カウンターの初期化             ||07417  |''        '処理回数カウンターの初期化             
07421  |''        gProcessCnt = 0                         ||07418  |''        gProcessCnt = 0                         
07422  |''        '保存ファイル名の修正                   ||07419  |''        '保存ファイル名の修正                   
07423  |''        gSaveFileCnt = gSaveFileCnt + 1         ||07420  |''        gSaveFileCnt = gSaveFileCnt + 1         
07424  |''        mstrFileName = mstrFileNameBK & " (" & g||07421  |''        mstrFileName = mstrFileNameBK & " (" & g
07425  |''    End If                                      ||07422  |''    End If                                      
07426  |'                                                 ||07423  |'                                                 
07427  |'    '2006/04/12 START K.Furuya 実払管理テーブル更||07424  |'    '2006/04/12 START K.Furuya 実払管理テーブル更
07428  |'    '実払管理テーブル更新処理実行                ||07425  |'    '実払管理テーブル更新処理実行                
07429  |'    If fncOtherRealComUpdateInsert(WkContractNo, ||07426  |'    If fncOtherRealComUpdateInsert(WkContractNo, 
07430  |'        intRtn = MsgBox("契約番号：" & WkContract||07427  |'        intRtn = MsgBox("契約番号：" & WkContract
07431  |'                    "の確定額の更新に失敗しました||07428  |'                    "の確定額の更新に失敗しました
07432  |'    End If                                       ||07429  |'    End If                                       
07433  |'    '2006/04/12 END   K.Furuya 実払管理テーブル更||07430  |'    '2006/04/12 END   K.Furuya 実払管理テーブル更
07434  |'                                                 ||07431  |'                                                 
07435  |'    '正常戻り値セット                            ||07432  |'    '正常戻り値セット                            
07436  |'    fnblExcelOut = True                          ||07433  |'    fnblExcelOut = True                          
07437  |'    GoTo EndProc                                 ||07434  |'    GoTo EndProc                                 
07438  |'                                                 ||07435  |'                                                 
07439  |'ErrorTrap:                                       ||07436  |'ErrorTrap:                                       
07440  |'    ' Excel を起動できない場合に発生するエラーを ||07437  |'    ' Excel を起動できない場合に発生するエラーを 
07441  |'    Select Case Err.Number                       ||07438  |'    Select Case Err.Number                       
07442  |'        Case 440               ' オートメーション||07439  |'        Case 440               ' オートメーション
07443  |'            iTries = iTries + 1                  ||07440  |'            iTries = iTries + 1                  
07444  |'            ' Excel の再起動を 5 回まで行います。||07441  |'            ' Excel の再起動を 5 回まで行います。
07445  |'            If iTries < 5 Then                   ||07442  |'            If iTries < 5 Then                   
07446  |'               Set xlApp = New Excel.Application ||07443  |'               Set xlApp = New Excel.Application 
07447  |'               Resume                            ||07444  |'               Resume                            
07448  |'            Else                                 ||07445  |'            Else                                 
07449  |'               Err.Raise Number:=vbObjectError + ||07446  |'               Err.Raise Number:=vbObjectError + 
07450  |'               Description:="Microsoft Excel を起||07447  |'               Description:="Microsoft Excel を起
07451  |'            End If                               ||07448  |'            End If                               
07452  |'        Case Else                                ||07449  |'        Case Else                                
07453  |'    End Select                                   ||07450  |'    End Select                                   
07454  |'                                                 ||07451  |'                                                 
07455  |'    'Workbookを閉じる                            ||07452  |'    'Workbookを閉じる                            
07456  |'    xlBook.Close                                 ||07453  |'    xlBook.Close                                 
07457  |'                                                 ||07454  |'                                                 
07458  |'    'Excel終了                                   ||07455  |'    'Excel終了                                   
07459  |'    xlApp.Quit                                   ||07456  |'    xlApp.Quit                                   
07460  |'                                                 ||07457  |'                                                 
07461  |'    'オブジェクトの解放                          ||07458  |'    'オブジェクトの解放                          
07462  |'    Set xlApp = Nothing                          ||07459  |'    Set xlApp = Nothing                          
07463  |'    Set xlBook = Nothing                         ||07460  |'    Set xlBook = Nothing                         
07464  |'    Set xlSheet = Nothing                        ||07461  |'    Set xlSheet = Nothing                        
07465  |'                                                 ||07462  |'                                                 
07466  |'OnErrorProc:                                     ||07463  |'OnErrorProc:                                     
07467  |'    Call subError("システムエラー", Str(Err.Numbe||07464  |'    Call subError("システムエラー", Str(Err.Numbe
07468  |'        Error, strErrCall, conTitle)             ||07465  |'        Error, strErrCall, conTitle)             
07469  |'    'マウスポインター元に戻す                    ||07466  |'    'マウスポインター元に戻す                    
07470  |'    Screen.MousePointer = vbDefault              ||07467  |'    Screen.MousePointer = vbDefault              
07471  |'    GoTo EndProc                                 ||07468  |'    GoTo EndProc                                 
07472  |'                                                 ||07469  |'                                                 
07473  |'EndProc:                                         ||07470  |'EndProc:                                         
07474  |                                                  ||07471  |                                                  
07475  |'#################################################||07472  |'#################################################
07476  |'2006/07/03 END   K.Furuya 期中料率変更契約/RAFI対||07473  |'2006/07/03 END   K.Furuya 期中料率変更契約/RAFI対
07477  |'#################################################||07474  |'#################################################
07478  |                                                  ||07475  |                                                  
07479  |                                                  ||07476  |                                                  
07480  |End Function                                      ||07477  |End Function                                      
07481  |'                                                 ||07478  |'                                                 
07482  |'=================================================||07479  |'=================================================
07483  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelEnglishOut          ||07480  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelEnglishOut          
07484  |'機能            :   確認書(英文)のExcel出力      ||07481  |'機能            :   確認書(英文)のExcel出力      
07485  |'                                                 ||07482  |'                                                 
07486  |'日付               担当　              修正内容  ||07483  |'日付               担当　              修正内容  
07487  |'-------------------------------------------------||07484  |'-------------------------------------------------
07488  |'2005/07/28         K.Nishihama<SRA>   新規作成   ||07485  |'2005/07/28         K.Nishihama<SRA>   新規作成   
07489  |'2006/08/18         K.Furuya <SRA>     期中料率変 ||07486  |'2006/08/18         K.Furuya <SRA>     期中料率変 
07490  |'                                      ソースが煩 ||07487  |'                                      ソースが煩 
07491  |'                                      作り変えの ||07488  |'                                      作り変えの 
07492  |'=================================================||07489  |'=================================================
07493  |Private Function fnblExcelEnglishOut( _           ||07490  |Private Function fnblExcelEnglishOut( _           
07494  |    ByVal lRecIdx As Long _                       ||07491  |    ByVal lRecIdx As Long _                       
07495  |) As Boolean                                      ||07492  |) As Boolean                                      
07496  |                                                  ||07493  |                                                  
07497  |'    Dim dStart      As Date     '計算期間　開始日||07494  |'    Dim dStart      As Date     '計算期間　開始日
07498  |'    Dim dEnd        As Date     '計算期間　終了日||07495  |'    Dim dEnd        As Date     '計算期間　終了日
07499  |'    Dim sSql        As String                    ||07496  |'    Dim sSql        As String                    
07500  |'    Dim sCurrencyCode As String '通貨コード(SQL文||07497  |'    Dim sCurrencyCode As String '通貨コード(SQL文
07501  |'    Dim AccCode     As String   '口座コード(SQL文||07498  |'    Dim AccCode     As String   '口座コード(SQL文
07502  |'    Dim sDate       As Date     '支払予定日      ||07499  |'    Dim sDate       As Date     '支払予定日      
07503  |'    Dim sName       As String   '担当者名        ||07500  |'    Dim sName       As String   '担当者名        
07504  |'    Dim i           As Integer  'カウンター      ||07501  |'    Dim i           As Integer  'カウンター      
07505  |'    Dim ColNum      As Integer  '部署名コンボボッ||07502  |'    Dim ColNum      As Integer  '部署名コンボボッ
07506  |'    Dim ColWord     As String   '部署名コンボボッ||07503  |'    Dim ColWord     As String   '部署名コンボボッ
07507  |'    Dim iSyouhizei  As Long     '消費税          ||07504  |'    Dim iSyouhizei  As Long     '消費税          
07508  |'    Dim iRowCnt     As Long     '月末純資産データ||07505  |'    Dim iRowCnt     As Long     '月末純資産データ
07509  |'    Dim TotalNav    As Currency '累積NAV         ||07506  |'    Dim TotalNav    As Currency '累積NAV         
07510  |'    Dim TotalRate   As Currency '累積閾値        ||07507  |'    Dim TotalRate   As Currency '累積閾値        
07511  |'    Dim cRate       As Currency '料率            ||07508  |'    Dim cRate       As Currency '料率            
07512  |'    Dim WorkRate    As Currency '一つ前の累積閾値||07509  |'    Dim WorkRate    As Currency '一つ前の累積閾値
07513  |'    Dim TotalCom    As Currency '累積投資顧問料  ||07510  |'    Dim TotalCom    As Currency '累積投資顧問料  
07514  |'    Dim lTaxNum     As Currency '消費税値        ||07511  |'    Dim lTaxNum     As Currency '消費税値        
07515  |'    Dim lMonthlyPayCom As Currency  '月別支払額  ||07512  |'    Dim lMonthlyPayCom As Currency  '月別支払額  
07516  |'    Dim lCalcNav    As Currency '計算対象NAV     ||07513  |'    Dim lCalcNav    As Currency '計算対象NAV     
07517  |'    Dim iCalcNum    As Integer  '計算期間日数    ||07514  |'    Dim iCalcNum    As Integer  '計算期間日数    
07518  |'    'Excel の Application 変数とエラーをトラップ ||07515  |'    'Excel の Application 変数とエラーをトラップ 
07519  |'    Dim iTries      As Integer                   ||07516  |'    Dim iTries      As Integer                   
07520  |'    Dim strErrCall      As String 'エラー呼出元  ||07517  |'    Dim strErrCall      As String 'エラー呼出元  
07521  |'    Const conMeModule   As String = "fnblExcelEng||07518  |'    Const conMeModule   As String = "fnblExcelEng
07522  |'    'Excel の Worksheet 削除用カウンタ変数       ||07519  |'    'Excel の Worksheet 削除用カウンタ変数       
07523  |'    Dim Ws_Cnt      As Integer                   ||07520  |'    Dim Ws_Cnt      As Integer                   
07524  |'    Dim Ws_Del_Cnt  As Integer                   ||07521  |'    Dim Ws_Del_Cnt  As Integer                   
07525  |'    Dim Ws_Del_Cnt2 As Integer                   ||07522  |'    Dim Ws_Del_Cnt2 As Integer                   
07526  |'    Dim ContNo      As String   '契約番号(SQL文作||07523  |'    Dim ContNo      As String   '契約番号(SQL文作
07527  |'    Dim NavGetCnt   As Long                      ||07524  |'    Dim NavGetCnt   As Long                      
07528  |'    Dim sGetAccCode As String                    ||07525  |'    Dim sGetAccCode As String                    
07529  |'    Dim Mnav_Flg    As String                    ||07526  |'    Dim Mnav_Flg    As String                    
07530  |'    Dim sStart As String            '計算対象　開||07527  |'    Dim sStart As String            '計算対象　開
07531  |'    Dim sEnd As String              '計算対象　終||07528  |'    Dim sEnd As String              '計算対象　終
07532  |'    Dim dstrBasedate As String      '基準日用ワー||07529  |'    Dim dstrBasedate As String      '基準日用ワー
07533  |'    Dim dstrCaldate() As String     'カレンダー日||07530  |'    Dim dstrCaldate() As String     'カレンダー日
07534  |'    Dim ddblDailynav() As Double    '日次NAV用格 ||07531  |'    Dim ddblDailynav() As Double    '日次NAV用格 
07535  |'    Dim dlngCnt As Long             '計算対象期間||07532  |'    Dim dlngCnt As Long             '計算対象期間
07536  |'    Dim dstrCaldate2 As String      'カレンダー日||07533  |'    Dim dstrCaldate2 As String      'カレンダー日
07537  |'    Dim dstrBasedate2 As String     '基準日(/編集||07534  |'    Dim dstrBasedate2 As String     '基準日(/編集
07538  |'    Dim dlngDiffdate As Long        'カレンダー日||07535  |'    Dim dlngDiffdate As Long        'カレンダー日
07539  |'    Dim dintFor As Integer          'For文用変数 ||07536  |'    Dim dintFor As Integer          'For文用変数 
07540  |'    Dim ddblTtalnav As Double       '日次NAV累積 ||07537  |'    Dim ddblTtalnav As Double       '日次NAV累積 
07541  |'    Dim dstrAvgNav As String                     ||07538  |'    Dim dstrAvgNav As String                     
07542  |'    Dim ddblNearNav As Double                    ||07539  |'    Dim ddblNearNav As Double                    
07543  |'    Dim dstrAccCd() As String                    ||07540  |'    Dim dstrAccCd() As String                    
07544  |'    Dim dstrBsCCd() As String                    ||07541  |'    Dim dstrBsCCd() As String                    
07545  |'    Dim intRtn      As Integer                   ||07542  |'    Dim intRtn      As Integer                   
07546  |'    Dim dstrDate         As String               ||07543  |'    Dim dstrDate         As String               
07547  |'    Dim dstrCurrencyCode As String               ||07544  |'    Dim dstrCurrencyCode As String               
07548  |'    Dim ddblExchangeRate As Double               ||07545  |'    Dim ddblExchangeRate As Double               
07549  |'    Dim dintPage    As Integer                   ||07546  |'    Dim dintPage    As Integer                   
07550  |'    Dim dintPageIni As Integer                   ||07547  |'    Dim dintPageIni As Integer                   
07551  |'    Dim dintAmari   As Integer                   ||07548  |'    Dim dintAmari   As Integer                   
07552  |'    Dim dCalDate    As Date                      ||07549  |'    Dim dCalDate    As Date                      
07553  |'    Dim J           As Integer                   ||07550  |'    Dim J           As Integer                   
07554  |'    Dim K           As Integer                   ||07551  |'    Dim K           As Integer                   
07555  |'    Dim L           As Integer                   ||07552  |'    Dim L           As Integer                   
07556  |'    Dim AvgNav      As Currency                  ||07553  |'    Dim AvgNav      As Currency                  
07557  |'    Dim dintFor2    As Integer                   ||07554  |'    Dim dintFor2    As Integer                   
07558  |'    Dim dlngMeisyoSu As Integer                  ||07555  |'    Dim dlngMeisyoSu As Integer                  
07559  |'    Dim dlngCntsv As Long                        ||07556  |'    Dim dlngCntsv As Long                        
07560  |'                                                 ||07557  |'                                                 
07561  |'    '戻り値初期化                                ||07558  |'    '戻り値初期化                                
07562  |'    fnblExcelEnglishOut = False                  ||07559  |'    fnblExcelEnglishOut = False                  
07563  |'    i = 0                                        ||07560  |'    i = 0                                        
07564  |'                                                 ||07561  |'                                                 
07565  |'On Error Resume Next                             ||07562  |'On Error Resume Next                             
07566  |'                                                 ||07563  |'                                                 
07567  |'    Set xlSheet = xlBook.Sheets(gProcessCnt)     ||07564  |'    Set xlSheet = xlBook.Sheets(gProcessCnt)     
07568  |'                                                 ||07565  |'                                                 
07569  |'    'Excelフォーマットを調整                     ||07566  |'    'Excelフォーマットを調整                     
07570  |'    xlSheet.Cells.ColumnWidth = 1                ||07567  |'    xlSheet.Cells.ColumnWidth = 1                
07571  |'    xlSheet.Cells.Font.Size = 11                 ||07568  |'    xlSheet.Cells.Font.Size = 11                 
07572  |'    'シート名を設定(確認書**)                    ||07569  |'    'シート名を設定(確認書**)                    
07573  |'    xlBook.Sheets(gProcessCnt).Name = sWord33a & ||07570  |'    xlBook.Sheets(gProcessCnt).Name = sWord33a & 
07574  |'    'シートの余白を設定                          ||07571  |'    'シートの余白を設定                          
07575  |'    xlSheet.PageSetup.TopMargin = Application.Inc||07572  |'    xlSheet.PageSetup.TopMargin = Application.Inc
07576  |'    xlSheet.PageSetup.BottomMargin = Application.||07573  |'    xlSheet.PageSetup.BottomMargin = Application.
07577  |'    xlSheet.PageSetup.LeftMargin = Application.In||07574  |'    xlSheet.PageSetup.LeftMargin = Application.In
07578  |'    xlSheet.PageSetup.RightMargin = Application.I||07575  |'    xlSheet.PageSetup.RightMargin = Application.I
07579  |'                                                 ||07576  |'                                                 
07580  |'    DoEvents                                     ||07577  |'    DoEvents                                     
07581  |'    With xlSheet                                 ||07578  |'    With xlSheet                                 
07582  |'        '題目                                    ||07579  |'        '題目                                    
07583  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).||07580  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).
07584  |'            Case Mid(mstrContractFlag(1), 1, 1)  ||07581  |'            Case Mid(mstrContractFlag(1), 1, 1)  
07585  |'                .Cells(5, 1).Value = sWord0d     ||07582  |'                .Cells(5, 1).Value = sWord0d     
07586  |'            Case Mid(mstrContractFlag(2), 1, 1)  ||07583  |'            Case Mid(mstrContractFlag(2), 1, 1)  
07587  |'                .Cells(5, 1).Value = sWord0e     ||07584  |'                .Cells(5, 1).Value = sWord0e     
07588  |'            Case Mid(mstrContractFlag(3), 1, 1)  ||07585  |'            Case Mid(mstrContractFlag(3), 1, 1)  
07589  |'                .Cells(5, 1).Value = sWord0f     ||07586  |'                .Cells(5, 1).Value = sWord0f     
07590  |'            Case Else                            ||07587  |'            Case Else                            
07591  |'                MsgBox "契約区分が不正です。", vb||07588  |'                MsgBox "契約区分が不正です。", vb
07592  |'        End Select                               ||07589  |'        End Select                               
07593  |'        .Cells(5, 1).Font.Size = 14              ||07590  |'        .Cells(5, 1).Font.Size = 14              
07594  |'        .Range("A5:BG5").HorizontalAlignment = xl||07591  |'        .Range("A5:BG5").HorizontalAlignment = xl
07595  |'                                                 ||07592  |'                                                 
07596  |'        '出力日付                                ||07593  |'        '出力日付                                
07597  |'        If RTrim(txtSysOutDate.Text) = "" Then   ||07594  |'        If RTrim(txtSysOutDate.Text) = "" Then   
07598  |'            .Cells(3, 50).Value = sWord34a       ||07595  |'            .Cells(3, 50).Value = sWord34a       
07599  |'            .Cells(3, 50).HorizontalAlignment = x||07596  |'            .Cells(3, 50).HorizontalAlignment = x
07600  |'        Else                                     ||07597  |'        Else                                     
07601  |'            .Cells(3, 43).NumberFormatLocal = "@"||07598  |'            .Cells(3, 43).NumberFormatLocal = "@"
07602  |'            .Cells(3, 43).Value = CStr(Format(txt||07599  |'            .Cells(3, 43).Value = CStr(Format(txt
07603  |'        End If                                   ||07600  |'        End If                                   
07604  |'                                                 ||07601  |'                                                 
07605  |'        '下記のとおり･･･                         ||07602  |'        '下記のとおり･･･                         
07606  |'        .Cells(7, 2).Value = "Dear Sirs,"        ||07603  |'        .Cells(7, 2).Value = "Dear Sirs,"        
07607  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).||07604  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).
07608  |'            Case Mid(mstrContractFlag(1), 1, 1)  ||07605  |'            Case Mid(mstrContractFlag(1), 1, 1)  
07609  |'                .Cells(8, 2).Value = sWord3d     ||07606  |'                .Cells(8, 2).Value = sWord3d     
07610  |'            Case Mid(mstrContractFlag(2), 1, 1)  ||07607  |'            Case Mid(mstrContractFlag(2), 1, 1)  
07611  |'                .Cells(8, 2).Value = sWord3e     ||07608  |'                .Cells(8, 2).Value = sWord3e     
07612  |'            Case Mid(mstrContractFlag(3), 1, 1)  ||07609  |'            Case Mid(mstrContractFlag(3), 1, 1)  
07613  |'                .Cells(8, 2).Value = sWord3f     ||07610  |'                .Cells(8, 2).Value = sWord3f     
07614  |'            Case Else                            ||07611  |'            Case Else                            
07615  |'        End Select                               ||07612  |'        End Select                               
07616  |'                                                 ||07613  |'                                                 
07617  |'        'ファンド名                              ||07614  |'        'ファンド名                              
07618  |'        .Cells(10, 2).Value = sWord4a            ||07615  |'        .Cells(10, 2).Value = sWord4a            
07619  |'        .Cells(10, 11).Value = sWord19           ||07616  |'        .Cells(10, 11).Value = sWord19           
07620  |'        .Cells(10, 13).Value = gbuMGetUPDRec.N(lR||07617  |'        .Cells(10, 13).Value = gbuMGetUPDRec.N(lR
07621  |'                                                 ||07618  |'                                                 
07622  |'        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_co||07619  |'        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_co
07623  |'        sSql = gstrEditSQLcfr_NavGetForSelectList||07620  |'        sSql = gstrEditSQLcfr_NavGetForSelectList
07624  |'        'ﾀﾞｲﾅｾｯﾄの作成                           ||07621  |'        'ﾀﾞｲﾅｾｯﾄの作成                           
07625  |'        If gintDyCreate(sSql) = False Then       ||07622  |'        If gintDyCreate(sSql) = False Then       
07626  |'            Exit Function                        ||07623  |'            Exit Function                        
07627  |'        End If                                   ||07624  |'        End If                                   
07628  |'        Do Until gblnDyEOF()                     ||07625  |'        Do Until gblnDyEOF()                     
07629  |'            '動的配列更新                        ||07626  |'            '動的配列更新                        
07630  |'            ReDim Preserve gtypcfr_navget_tbl(0 T||07627  |'            ReDim Preserve gtypcfr_navget_tbl(0 T
07631  |'            ReDim Preserve dstrAccCd(0 To NavGetC||07628  |'            ReDim Preserve dstrAccCd(0 To NavGetC
07632  |'                                                 ||07629  |'                                                 
07633  |'            'NAV取得抽出                         ||07630  |'            'NAV取得抽出                         
07634  |'            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT||07631  |'            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT
07635  |'            If NavGetCnt > 0 Then                ||07632  |'            If NavGetCnt > 0 Then                
07636  |'                sGetAccCode = sGetAccCode & " , "||07633  |'                sGetAccCode = sGetAccCode & " , "
07637  |'            Else                                 ||07634  |'            Else                                 
07638  |'                sGetAccCode = sGetAccCode & gtypc||07635  |'                sGetAccCode = sGetAccCode & gtypc
07639  |'            End If                               ||07636  |'            End If                               
07640  |'                                                 ||07637  |'                                                 
07641  |'            '口座コードの格納(１契約複数口座の場 ||07638  |'            '口座コードの格納(１契約複数口座の場 
07642  |'            dstrAccCd(NavGetCnt) = gtypcfr_navget||07639  |'            dstrAccCd(NavGetCnt) = gtypcfr_navget
07643  |'            NavGetCnt = NavGetCnt + 1            ||07640  |'            NavGetCnt = NavGetCnt + 1            
07644  |'            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                    ||07641  |'            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                    
07645  |'            Call gDyNext                         ||07642  |'            Call gDyNext                         
07646  |'        Loop                                     ||07643  |'        Loop                                     
07647  |'        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                        ||07644  |'        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                        
07648  |'        Call gblnDyClose                         ||07645  |'        Call gblnDyClose                         
07649  |'                                                 ||07646  |'                                                 
07650  |'        '１契約複数口座の場合に口座のベース通貨に||07647  |'        '１契約複数口座の場合に口座のベース通貨に
07651  |'        ReDim dstrBsCCd(0 To NavGetCnt - 1)      ||07648  |'        ReDim dstrBsCCd(0 To NavGetCnt - 1)      
07652  |'        If NavGetCnt - 1 > 0 Then                ||07649  |'        If NavGetCnt - 1 > 0 Then                
07653  |'            For dintFor = 0 To NavGetCnt - 1     ||07650  |'            For dintFor = 0 To NavGetCnt - 1     
07654  |'                sSql = ""                        ||07651  |'                sSql = ""                        
07655  |'                sSql = sSql & "SELECT ACCOUNT_COD||07652  |'                sSql = sSql & "SELECT ACCOUNT_COD
07656  |'                sSql = sSql & "WHERE ACCOUNT_CODE||07653  |'                sSql = sSql & "WHERE ACCOUNT_CODE
07657  |'                'ﾀﾞｲﾅｾｯﾄの作成                   ||07654  |'                'ﾀﾞｲﾅｾｯﾄの作成                   
07658  |'                If gintDyCreate(sSql) = False The||07655  |'                If gintDyCreate(sSql) = False The
07659  |'                    Exit Function                ||07656  |'                    Exit Function                
07660  |'                Else                             ||07657  |'                Else                             
07661  |'                    dstrBsCCd(dintFor) = gvlnDyDa||07658  |'                    dstrBsCCd(dintFor) = gvlnDyDa
07662  |'                End If                           ||07659  |'                End If                           
07663  |'                If dintFor > 0 Then              ||07660  |'                If dintFor > 0 Then              
07664  |'                    If dstrBsCCd(dintFor) <> dstr||07661  |'                    If dstrBsCCd(dintFor) <> dstr
07665  |'                        intRtn = MsgBox("ファンド||07662  |'                        intRtn = MsgBox("ファンド
07666  |'                        Exit Function            ||07663  |'                        Exit Function            
07667  |'                    End If                       ||07664  |'                    End If                       
07668  |'                End If                           ||07665  |'                End If                           
07669  |'            Next dintFor                         ||07666  |'            Next dintFor                         
07670  |'                                                 ||07667  |'                                                 
07671  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    ||07668  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    
07672  |'            Call gblnDyClose                     ||07669  |'            Call gblnDyClose                     
07673  |'                                                 ||07670  |'                                                 
07674  |'        End If                                   ||07671  |'        End If                                   
07675  |'                                                 ||07672  |'                                                 
07676  |'        'ファンドコード                          ||07673  |'        'ファンドコード                          
07677  |'        .Cells(11, 2).Value = sWord4_2a          ||07674  |'        .Cells(11, 2).Value = sWord4_2a          
07678  |'        .Cells(11, 11).Value = sWord19           ||07675  |'        .Cells(11, 11).Value = sWord19           
07679  |'        .Cells(11, 13).NumberFormatLocal = "@"   ||07676  |'        .Cells(11, 13).NumberFormatLocal = "@"   
07680  |'        .Cells(11, 13).Value = sGetAccCode       ||07677  |'        .Cells(11, 13).Value = sGetAccCode       
07681  |'                                                 ||07678  |'                                                 
07682  |'        '計算期間                                ||07679  |'        '計算期間                                
07683  |'        .Cells(13, 2).Value = sWord5a            ||07680  |'        .Cells(13, 2).Value = sWord5a            
07684  |'        .Cells(13, 11).Value = sWord19           ||07681  |'        .Cells(13, 11).Value = sWord19           
07685  |'                                                 ||07682  |'                                                 
07686  |'        '前回締日・直近締日セット                ||07683  |'        '前回締日・直近締日セット                
07687  |'        dStart = CDate(gstrDateFormat(mstrSettlem||07684  |'        dStart = CDate(gstrDateFormat(mstrSettlem
07688  |'        dEnd = CDate(gstrDateFormat(mstrNearSettl||07685  |'        dEnd = CDate(gstrDateFormat(mstrNearSettl
07689  |'        dstrDate = Replace(CStr(dEnd), "/", "")  ||07686  |'        dstrDate = Replace(CStr(dEnd), "/", "")  
07690  |'        iCalcNum = DateDiff("d", dStart, dEnd) + ||07687  |'        iCalcNum = DateDiff("d", dStart, dEnd) + 
07691  |'                                                 ||07688  |'                                                 
07692  |'        '年率                                    ||07689  |'        '年率                                    
07693  |'        .Cells(15, 2).Value = sWord10a           ||07690  |'        .Cells(15, 2).Value = sWord10a           
07694  |'        .Cells(15, 11).Value = sWord19           ||07691  |'        .Cells(15, 11).Value = sWord19           
07695  |'                                                 ||07692  |'                                                 
07696  |'        '月末純資産                              ||07693  |'        '月末純資産                              
07697  |'        .Cells(27, 2).Value = sWord6a            ||07694  |'        .Cells(27, 2).Value = sWord6a            
07698  |'        .Cells(27, 21).Value = sWord19           ||07695  |'        .Cells(27, 21).Value = sWord19           
07699  |'                                                 ||07696  |'                                                 
07700  |'        '@@@@@ 合計行を出力しないならここをコメン||07697  |'        '@@@@@ 合計行を出力しないならここをコメン
07701  |'        '合計(純資産)                            ||07698  |'        '合計(純資産)                            
07702  |'        .Cells(40, 25).Value = sWord9a           ||07699  |'        .Cells(40, 25).Value = sWord9a           
07703  |'        .Range("X40:AI40").HorizontalAlignment = ||07700  |'        .Range("X40:AI40").HorizontalAlignment = 
07704  |'                                                 ||07701  |'                                                 
07705  |''        '契約区分「1」or「2」                   ||07702  |''        '契約区分「1」or「2」                   
07706  |''        '契約区分「1」or「2」or (「3」and 取得NA||07703  |''        '契約区分「1」or「2」or (「3」and 取得NA
07707  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||07704  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
07708  |'        Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||07705  |'        Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
07709  |'        Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_con||07706  |'        Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_con
07710  |'                                                 ||07707  |'                                                 
07711  |'            '月末NAV取得                         ||07708  |'            '月末NAV取得                         
07712  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_||07709  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_
07713  |'                '月次NAVを累積                   ||07710  |'                '月次NAVを累積                   
07714  |'                For i = LBound(gtypcfr_mnav_tbl) ||07711  |'                For i = LBound(gtypcfr_mnav_tbl) 
07715  |'                    If Len(gtypcfr_mnav_tbl(i).BA||07712  |'                    If Len(gtypcfr_mnav_tbl(i).BA
07716  |'                        '日付                    ||07713  |'                        '日付                    
07717  |'                         gtypcfr_mnav_tbl(i).BASE||07714  |'                         gtypcfr_mnav_tbl(i).BASE
07718  |'                        .Cells(27 + i, 25).Value ||07715  |'                        .Cells(27 + i, 25).Value 
07719  |'                        '純資産                  ||07716  |'                        '純資産                  
07720  |'                        .Cells(27 + i, 49).Number||07717  |'                        .Cells(27 + i, 49).Number
07721  |'                                                 ||07718  |'                                                 
07722  |'                        If gbuMGetUPDRec.N(lRecId||07719  |'                        If gbuMGetUPDRec.N(lRecId
07723  |'                            .Cells(27 + i, 49).Va||07720  |'                            .Cells(27 + i, 49).Va
07724  |'                        Else                     ||07721  |'                        Else                     
07725  |'                            .Cells(27 + i, 49).Va||07722  |'                            .Cells(27 + i, 49).Va
07726  |'                        End If                   ||07723  |'                        End If                   
07727  |'                        .Cells(27 + i, 49).Horizo||07724  |'                        .Cells(27 + i, 49).Horizo
07728  |'                                                 ||07725  |'                                                 
07729  |'                        TotalNav = TotalNav + CCu||07726  |'                        TotalNav = TotalNav + CCu
07730  |'                        iRowCnt = iRowCnt + 1    ||07727  |'                        iRowCnt = iRowCnt + 1    
07731  |'                    Else                         ||07728  |'                    Else                         
07732  |'                        Mnav_Flg = 1             ||07729  |'                        Mnav_Flg = 1             
07733  |'                    End If                       ||07730  |'                    End If                       
07734  |'                                                 ||07731  |'                                                 
07735  |'                Next i                           ||07732  |'                Next i                           
07736  |'                                                 ||07733  |'                                                 
07737  |'                '保留★★（1を引く意味がわからな ||07734  |'                '保留★★（1を引く意味がわからな 
07738  |'                '日次NAVを算出                   ||07735  |'                '日次NAVを算出                   
07739  |''                If Mnav_Flg = 1 Then            ||07736  |''                If Mnav_Flg = 1 Then            
07740  |''                    i = i - 1                   ||07737  |''                    i = i - 1                   
07741  |''                End If                          ||07738  |''                End If                          
07742  |'                                                 ||07739  |'                                                 
07743  |'                If mstrDailyNav <> "" Then       ||07740  |'                If mstrDailyNav <> "" Then       
07744  |'                    '日付                        ||07741  |'                    '日付                        
07745  |'                    .Cells(27 + i, 25).NumberForm||07742  |'                    .Cells(27 + i, 25).NumberForm
07746  |'                    .Cells(27 + i, 25).Value = CS||07743  |'                    .Cells(27 + i, 25).Value = CS
07747  |'                    .Cells(27 + i, 25).Horizontal||07744  |'                    .Cells(27 + i, 25).Horizontal
07748  |'                    '純資産                      ||07745  |'                    '純資産                      
07749  |'                    .Cells(27 + i, 49).NumberForm||07746  |'                    .Cells(27 + i, 49).NumberForm
07750  |'                                                 ||07747  |'                                                 
07751  |'                    If gbuMGetUPDRec.N(lRecIdx).M||07748  |'                    If gbuMGetUPDRec.N(lRecIdx).M
07752  |'                        .Cells(27 + i, 49).Value ||07749  |'                        .Cells(27 + i, 49).Value 
07753  |'                    Else                         ||07750  |'                    Else                         
07754  |'                        .Cells(27 + i, 49).Value ||07751  |'                        .Cells(27 + i, 49).Value 
07755  |'                    End If                       ||07752  |'                    End If                       
07756  |'                                                 ||07753  |'                                                 
07757  |'                    .Cells(27 + i, 49).Horizontal||07754  |'                    .Cells(27 + i, 49).Horizontal
07758  |'                    TotalNav = TotalNav + CCur(ms||07755  |'                    TotalNav = TotalNav + CCur(ms
07759  |'                    iRowCnt = iRowCnt + 1        ||07756  |'                    iRowCnt = iRowCnt + 1        
07760  |'                                                 ||07757  |'                                                 
07761  |'                End If                           ||07758  |'                End If                           
07762  |'                                                 ||07759  |'                                                 
07763  |'                '@@@@@ 合計行を出力しないならここ||07760  |'                '@@@@@ 合計行を出力しないならここ
07764  |'                .Cells(40, 49).NumberFormatLocal ||07761  |'                .Cells(40, 49).NumberFormatLocal 
07765  |'                .Cells(40, 49).Value = CStr(Forma||07762  |'                .Cells(40, 49).Value = CStr(Forma
07766  |'                                                 ||07763  |'                                                 
07767  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET||07764  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET
07768  |'                    '@@@@@ 合計行を出力しないなら||07765  |'                    '@@@@@ 合計行を出力しないなら
07769  |'                    .Cells(40, 49).Value = CStr(F||07766  |'                    .Cells(40, 49).Value = CStr(F
07770  |'                 Else                            ||07767  |'                 Else                            
07771  |'                    '合計行を出力しないならここを||07768  |'                    '合計行を出力しないならここを
07772  |'                    .Cells(40, 49).Value = CStr(F||07769  |'                    .Cells(40, 49).Value = CStr(F
07773  |'                 End If                          ||07770  |'                 End If                          
07774  |'                 .Cells(40, 49).HorizontalAlignme||07771  |'                 .Cells(40, 49).HorizontalAlignme
07775  |'                                                 ||07772  |'                                                 
07776  |'                 '平均純資産総額                 ||07773  |'                 '平均純資産総額                 
07777  |'                 .Cells(43, 2).Value = sWord51a  ||07774  |'                 .Cells(43, 2).Value = sWord51a  
07778  |'                 .Cells(43, 16).Value = sWord19  ||07775  |'                 .Cells(43, 16).Value = sWord19  
07779  |'                                                 ||07776  |'                                                 
07780  |'                 '計算期間の純資産総額の合計(月末||07777  |'                 '計算期間の純資産総額の合計(月末
07781  |'                 .Cells(43, 28).NumberFormatLocal||07778  |'                 .Cells(43, 28).NumberFormatLocal
07782  |'                                                 ||07779  |'                                                 
07783  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET||07780  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET
07784  |'                     .Cells(43, 28).Value = CStr(||07781  |'                     .Cells(43, 28).Value = CStr(
07785  |'                 Else                            ||07782  |'                 Else                            
07786  |'                     .Cells(43, 28).Value = CStr(||07783  |'                     .Cells(43, 28).Value = CStr(
07787  |'                 End If                          ||07784  |'                 End If                          
07788  |'                                                 ||07785  |'                                                 
07789  |'                 .Cells(43, 28).HorizontalAlignme||07786  |'                 .Cells(43, 28).HorizontalAlignme
07790  |'                                                 ||07787  |'                                                 
07791  |'                 '計算期間の純資産総額の合計÷計 ||07788  |'                 '計算期間の純資産総額の合計÷計 
07792  |'                 .Cells(43, 40).NumberFormatLocal||07789  |'                 .Cells(43, 40).NumberFormatLocal
07793  |'                 dblValueIn = TotalNav / iRowCnt ||07790  |'                 dblValueIn = TotalNav / iRowCnt 
07794  |'                                                 ||07791  |'                                                 
07795  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET||07792  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET
07796  |'                     Call sbGetRoundValue2(dblVal||07793  |'                     Call sbGetRoundValue2(dblVal
07797  |'                 Else                            ||07794  |'                 Else                            
07798  |'                     Call sbGetRoundValue(dblValu||07795  |'                     Call sbGetRoundValue(dblValu
07799  |'                 End If                          ||07796  |'                 End If                          
07800  |'                                                 ||07797  |'                                                 
07801  |'                '平均NAV(計算対象NAV)            ||07798  |'                '平均NAV(計算対象NAV)            
07802  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||07799  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
07803  |'                    .Cells(43, 40).Value = CStr(F||07800  |'                    .Cells(43, 40).Value = CStr(F
07804  |'                Else                             ||07801  |'                Else                             
07805  |'                    .Cells(43, 40).Value = CStr(F||07802  |'                    .Cells(43, 40).Value = CStr(F
07806  |'                End If                           ||07803  |'                End If                           
07807  |'                                                 ||07804  |'                                                 
07808  |'                '÷??＝                          ||07805  |'                '÷??＝                          
07809  |'                          .Cells(43, 31).Value = ||07806  |'                          .Cells(43, 31).Value = 
07810  |'                                                 ||07807  |'                                                 
07811  |'            Else                                 ||07808  |'            Else                                 
07812  |'                ddblTtalnav = 0                  ||07809  |'                ddblTtalnav = 0                  
07813  |'                For dintFor = 0 To NavGetCnt - 1 ||07810  |'                For dintFor = 0 To NavGetCnt - 1 
07814  |'                                                 ||07811  |'                                                 
07815  |'                    '日次NAV平均取得             ||07812  |'                    '日次NAV平均取得             
07816  |'                    sStart = gstrDateFormat2(CStr||07813  |'                    sStart = gstrDateFormat2(CStr
07817  |'                    sEnd = gstrDateFormat2(CStr(d||07814  |'                    sEnd = gstrDateFormat2(CStr(d
07818  |'                                                 ||07815  |'                                                 
07819  |'                    '計算開始日と外部委託顧問料計||07816  |'                    '計算開始日と外部委託顧問料計
07820  |'                    If sStart = gbuMGetUPDRec.N(l||07817  |'                    If sStart = gbuMGetUPDRec.N(l
07821  |'                        sSql = ""                ||07818  |'                        sSql = ""                
07822  |'                        sSql = sSql & "SELECT EIG||07819  |'                        sSql = sSql & "SELECT EIG
07823  |'                                                 ||07820  |'                                                 
07824  |'                        'ﾀﾞｲﾅｾｯﾄの作成           ||07821  |'                        'ﾀﾞｲﾅｾｯﾄの作成           
07825  |'                        If gintDyCreate(sSql) = F||07822  |'                        If gintDyCreate(sSql) = F
07826  |'                            Exit Function        ||07823  |'                            Exit Function        
07827  |'                         Else                    ||07824  |'                         Else                    
07828  |'                            '休日の場合、翌営業日||07825  |'                            '休日の場合、翌営業日
07829  |'                            If gvlnDyDataS("EIGYO||07826  |'                            If gvlnDyDataS("EIGYO
07830  |'                                sSql = ""        ||07827  |'                                sSql = ""        
07831  |'                                sSql = sSql & "SE||07828  |'                                sSql = sSql & "SE
07832  |'                                sSql = sSql & "FR||07829  |'                                sSql = sSql & "FR
07833  |'                                sSql = sSql & "(S||07830  |'                                sSql = sSql & "(S
07834  |'                                sSql = sSql & "WH||07831  |'                                sSql = sSql & "WH
07835  |'                                                 ||07832  |'                                                 
07836  |'                                'ﾀﾞｲﾅｾｯﾄの作成   ||07833  |'                                'ﾀﾞｲﾅｾｯﾄの作成   
07837  |'                                If gintDyCreate(s||07834  |'                                If gintDyCreate(s
07838  |'                                    Exit Function||07835  |'                                    Exit Function
07839  |'                                Else             ||07836  |'                                Else             
07840  |'                                    ddblNearNav =||07837  |'                                    ddblNearNav =
07841  |'                                    sSql = ""    ||07838  |'                                    sSql = ""    
07842  |'                                    sSql = sSql &||07839  |'                                    sSql = sSql &
07843  |'                                    sSql = sSql &||07840  |'                                    sSql = sSql &
07844  |'                                    sSql = sSql &||07841  |'                                    sSql = sSql &
07845  |'                                    sSql = sSql &||07842  |'                                    sSql = sSql &
07846  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||07843  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
07847  |'                                    If gintDyCrea||07844  |'                                    If gintDyCrea
07848  |'                                        Exit Func||07845  |'                                        Exit Func
07849  |'                                     Else        ||07846  |'                                     Else        
07850  |'                                        sStart = ||07847  |'                                        sStart = 
07851  |'                                        dStart = ||07848  |'                                        dStart = 
07852  |'                                        .Cells(16||07849  |'                                        .Cells(16
07853  |'                                            CStr(||07850  |'                                            CStr(
07854  |'                                        iCalcNum ||07851  |'                                        iCalcNum 
07855  |'                                    End If       ||07852  |'                                    End If       
07856  |'                                End If           ||07853  |'                                End If           
07857  |'                            End If               ||07854  |'                            End If               
07858  |'                        End If                   ||07855  |'                        End If                   
07859  |'                    End If                       ||07856  |'                    End If                       
07860  |'                        sSql = ""                ||07857  |'                        sSql = ""                
07861  |'                        sSql = sSql & "SELECT CAL||07858  |'                        sSql = sSql & "SELECT CAL
07862  |'                        sSql = sSql & "WHERE CAL_||07859  |'                        sSql = sSql & "WHERE CAL_
07863  |'                                                 ||07860  |'                                                 
07864  |'                        'ﾀﾞｲﾅｾｯﾄの作成           ||07861  |'                        'ﾀﾞｲﾅｾｯﾄの作成           
07865  |'                        If gintDyCreate(sSql) = F||07862  |'                        If gintDyCreate(sSql) = F
07866  |'                            Exit Function        ||07863  |'                            Exit Function        
07867  |'                        End If                   ||07864  |'                        End If                   
07868  |'                                                 ||07865  |'                                                 
07869  |'                        If dlngCnt = 0 Then      ||07866  |'                        If dlngCnt = 0 Then      
07870  |'                            ReDim dstrCaldate(gbx||07867  |'                            ReDim dstrCaldate(gbx
07871  |'                            ReDim ddblDailynav(gb||07868  |'                            ReDim ddblDailynav(gb
07872  |'                        End If                   ||07869  |'                        End If                   
07873  |'                                                 ||07870  |'                                                 
07874  |'                        'EOF判定処理             ||07871  |'                        'EOF判定処理             
07875  |'                        dlngCnt = 0              ||07872  |'                        dlngCnt = 0              
07876  |'                                                 ||07873  |'                                                 
07877  |'                        Do Until gblnDyEOF()     ||07874  |'                        Do Until gblnDyEOF()     
07878  |'                            dlngCnt = dlngCnt + 1||07875  |'                            dlngCnt = dlngCnt + 1
07879  |'                            '抽出データセット    ||07876  |'                            '抽出データセット    
07880  |'                            dstrCaldate(dlngCnt) ||07877  |'                            dstrCaldate(dlngCnt) 
07881  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    ||07878  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    
07882  |'                            Call gDyNext         ||07879  |'                            Call gDyNext         
07883  |'                        Loop                     ||07880  |'                        Loop                     
07884  |'                                                 ||07881  |'                                                 
07885  |'                        '2005/08/26　START       ||07882  |'                        '2005/08/26　START       
07886  |'                        '変数sStartに格納されてい||07883  |'                        '変数sStartに格納されてい
07887  |'                        '変数sStartの直近の営業日||07884  |'                        '変数sStartの直近の営業日
07888  |'                        '（変数sStartに格納されて||07885  |'                        '（変数sStartに格納されて
07889  |'                        '　直近日付が存在しない場||07886  |'                        '　直近日付が存在しない場
07890  |'                                                 ||07887  |'                                                 
07891  |'                        sSql = ""                ||07888  |'                        sSql = ""                
07892  |'                        sSql = sSql & "SELECT MAX||07889  |'                        sSql = sSql & "SELECT MAX
07893  |'                        sSql = sSql & "FROM   CFR||07890  |'                        sSql = sSql & "FROM   CFR
07894  |'                        sSql = sSql & "WHERE  BAS||07891  |'                        sSql = sSql & "WHERE  BAS
07895  |'                        sSql = sSql & "AND    ACC||07892  |'                        sSql = sSql & "AND    ACC
07896  |'                                                 ||07893  |'                                                 
07897  |'                        'ﾀﾞｲﾅｾｯﾄの作成           ||07894  |'                        'ﾀﾞｲﾅｾｯﾄの作成           
07898  |'                        If gintDyCreate(sSql) = F||07895  |'                        If gintDyCreate(sSql) = F
07899  |'                            Exit Function        ||07896  |'                            Exit Function        
07900  |'                        End If                   ||07897  |'                        End If                   
07901  |'                                                 ||07898  |'                                                 
07902  |'                        Do Until gblnDyEOF()     ||07899  |'                        Do Until gblnDyEOF()     
07903  |'                           '抽出データセット     ||07900  |'                           '抽出データセット     
07904  |'                            sStart = gvlnDyDataS(||07901  |'                            sStart = gvlnDyDataS(
07905  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    ||07902  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    
07906  |'                            Call gDyNext         ||07903  |'                            Call gDyNext         
07907  |'                        Loop                     ||07904  |'                        Loop                     
07908  |'                                                 ||07905  |'                                                 
07909  |'                        '2005/08/26　END         ||07906  |'                        '2005/08/26　END         
07910  |'                                                 ||07907  |'                                                 
07911  |'                        sSql = ""                ||07908  |'                        sSql = ""                
07912  |'                        sSql = sSql & "SELECT ACC||07909  |'                        sSql = sSql & "SELECT ACC
07913  |'                        sSql = sSql & "WHERE (((C||07910  |'                        sSql = sSql & "WHERE (((C
07914  |'                        sSql = sSql & "AND ((CFR_||07911  |'                        sSql = sSql & "AND ((CFR_
07915  |'                        sSql = sSql & "AND ((CFR_||07912  |'                        sSql = sSql & "AND ((CFR_
07916  |'                        sSql = sSql & "ORDER BY C||07913  |'                        sSql = sSql & "ORDER BY C
07917  |'                                                 ||07914  |'                                                 
07918  |'                        If gintDyCreate(sSql) = F||07915  |'                        If gintDyCreate(sSql) = F
07919  |'                            Exit Function        ||07916  |'                            Exit Function        
07920  |'                        End If                   ||07917  |'                        End If                   
07921  |'                                                 ||07918  |'                                                 
07922  |'                        dlngCntsv = dlngCnt      ||07919  |'                        dlngCntsv = dlngCnt      
07923  |'                        dlngCnt = 0              ||07920  |'                        dlngCnt = 0              
07924  |'                                                 ||07921  |'                                                 
07925  |'                        Do Until gblnDyEOF()     ||07922  |'                        Do Until gblnDyEOF()     
07926  |'                            dlngCnt = dlngCnt + 1||07923  |'                            dlngCnt = dlngCnt + 1
07927  |'                            '抽出データセット    ||07924  |'                            '抽出データセット    
07928  |'                            dstrBasedate = gvlnDy||07925  |'                            dstrBasedate = gvlnDy
07929  |'                            If Mid(dstrCaldate(dl||07926  |'                            If Mid(dstrCaldate(dl
07930  |'                                ddblDailynav(dlng||07927  |'                                ddblDailynav(dlng
07931  |'                            Else                 ||07928  |'                            Else                 
07932  |'                                '計算開始日が外部||07929  |'                                '計算開始日が外部
07933  |'                                If ddblNearNav <>||07930  |'                                If ddblNearNav <>
07934  |'                                And dlngCnt = 1 T||07931  |'                                And dlngCnt = 1 T
07935  |'                                    dstrCaldate2 ||07932  |'                                    dstrCaldate2 
07936  |'                                    dstrBasedate2||07933  |'                                    dstrBasedate2
07937  |'                                    dlngDiffdate ||07934  |'                                    dlngDiffdate 
07938  |'                                                 ||07935  |'                                                 
07939  |'                                    For dintFor2 ||07936  |'                                    For dintFor2 
07940  |'                                        ddblDaily||07937  |'                                        ddblDaily
07941  |'                                        dlngCnt =||07938  |'                                        dlngCnt =
07942  |'                                    Next dintFor2||07939  |'                                    Next dintFor2
07943  |'                                    ddblDailynav(||07940  |'                                    ddblDailynav(
07944  |'                                Else             ||07941  |'                                Else             
07945  |'                                    '日次NAVにデ ||07942  |'                                    '日次NAVにデ 
07946  |'                                    dstrCaldate2 ||07943  |'                                    dstrCaldate2 
07947  |'                                    dstrBasedate2||07944  |'                                    dstrBasedate2
07948  |'                                    dlngDiffdate ||07945  |'                                    dlngDiffdate 
07949  |'                                                 ||07946  |'                                                 
07950  |'                                    For dintFor2 ||07947  |'                                    For dintFor2 
07951  |'                                        If ddblDa||07948  |'                                        If ddblDa
07952  |'                                            ddblD||07949  |'                                            ddblD
07953  |'                                        Else     ||07950  |'                                        Else     
07954  |'                                            '日次||07951  |'                                            '日次
07955  |'                                            intRt||07952  |'                                            intRt
07956  |'                                            vbLf ||07953  |'                                            vbLf 
07957  |'                                            vbLf ||07954  |'                                            vbLf 
07958  |'                                                v||07955  |'                                                v
07959  |'                                            Exit ||07956  |'                                            Exit 
07960  |'                                        End If   ||07957  |'                                        End If   
07961  |'                                        dlngCnt =||07958  |'                                        dlngCnt =
07962  |'                                    Next dintFor2||07959  |'                                    Next dintFor2
07963  |'                                    ddblDailynav(||07960  |'                                    ddblDailynav(
07964  |'                                End If           ||07961  |'                                End If           
07965  |'                                                 ||07962  |'                                                 
07966  |'                            End If               ||07963  |'                            End If               
07967  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    ||07964  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    
07968  |'                            Call gDyNext         ||07965  |'                            Call gDyNext         
07969  |'                        Loop                     ||07966  |'                        Loop                     
07970  |'                                                 ||07967  |'                                                 
07971  |'                    Next dintFor                 ||07968  |'                    Next dintFor                 
07972  |'                                                 ||07969  |'                                                 
07973  |'                    If dlngCntsv <> dlngCnt Then ||07970  |'                    If dlngCntsv <> dlngCnt Then 
07974  |'                        For dintFor2 = dlngCnt + ||07971  |'                        For dintFor2 = dlngCnt + 
07975  |'                            ddblDailynav(dintFor2||07972  |'                            ddblDailynav(dintFor2
07976  |'                        Next dintFor2            ||07973  |'                        Next dintFor2            
07977  |'                        dlngCnt = dlngCntsv      ||07974  |'                        dlngCnt = dlngCntsv      
07978  |'                    End If                       ||07975  |'                    End If                       
07979  |'                                                 ||07976  |'                                                 
07980  |'                    ddblTtalnav = 0              ||07977  |'                    ddblTtalnav = 0              
07981  |'                                                 ||07978  |'                                                 
07982  |'                    For dintFor2 = 1 To dlngCnt  ||07979  |'                    For dintFor2 = 1 To dlngCnt  
07983  |'                        ddblTtalnav = ddblTtalnav||07980  |'                        ddblTtalnav = ddblTtalnav
07984  |'                    Next dintFor2                ||07981  |'                    Next dintFor2                
07985  |'                                                 ||07982  |'                                                 
07986  |'                    iRowCnt = dlngCnt            ||07983  |'                    iRowCnt = dlngCnt            
07987  |'                    TotalNav = ddblTtalnav       ||07984  |'                    TotalNav = ddblTtalnav       
07988  |'                    dblValueIn = TotalNav        ||07985  |'                    dblValueIn = TotalNav        
07989  |'                    Call sbGetRoundValue2(dblValu||07986  |'                    Call sbGetRoundValue2(dblValu
07990  |'                    TotalNav = dblValueOut       ||07987  |'                    TotalNav = dblValueOut       
07991  |'                                                 ||07988  |'                                                 
07992  |'                    '平均純資産総額              ||07989  |'                    '平均純資産総額              
07993  |'                    .Cells(43, 2).Value = sWord51||07990  |'                    .Cells(43, 2).Value = sWord51
07994  |'                    .Cells(43, 16).Value = sWord1||07991  |'                    .Cells(43, 16).Value = sWord1
07995  |'                                                 ||07992  |'                                                 
07996  |'                    '計算期間の純資産総額の合計( ||07993  |'                    '計算期間の純資産総額の合計( 
07997  |'                    .Cells(43, 28).NumberFormatLo||07994  |'                    .Cells(43, 28).NumberFormatLo
07998  |'                    If gbuMGetUPDRec.N(lRecIdx).M||07995  |'                    If gbuMGetUPDRec.N(lRecIdx).M
07999  |'                        .Cells(43, 28).Value = CS||07996  |'                        .Cells(43, 28).Value = CS
08000  |'                    Else                         ||07997  |'                    Else                         
08001  |'                        .Cells(43, 28).Value = CS||07998  |'                        .Cells(43, 28).Value = CS
08002  |'                    End If                       ||07999  |'                    End If                       
08003  |'                    .Cells(43, 28).HorizontalAlig||08000  |'                    .Cells(43, 28).HorizontalAlig
08004  |'                                                 ||08001  |'                                                 
08005  |'                    '計算期間の純資産総額の合計÷||08002  |'                    '計算期間の純資産総額の合計÷
08006  |'                    .Cells(43, 40).NumberFormatLo||08003  |'                    .Cells(43, 40).NumberFormatLo
08007  |'                    dblValueIn = TotalNav / iRowC||08004  |'                    dblValueIn = TotalNav / iRowC
08008  |'                    If gbuMGetUPDRec.N(lRecIdx).M||08005  |'                    If gbuMGetUPDRec.N(lRecIdx).M
08009  |'                        Call sbGetRoundValue2(dbl||08006  |'                        Call sbGetRoundValue2(dbl
08010  |'                    Else                         ||08007  |'                    Else                         
08011  |'                        Call sbGetRoundValue(dblV||08008  |'                        Call sbGetRoundValue(dblV
08012  |'                    End If                       ||08009  |'                    End If                       
08013  |'                                                 ||08010  |'                                                 
08014  |'                    If gbuMGetUPDRec.N(lRecIdx).M||08011  |'                    If gbuMGetUPDRec.N(lRecIdx).M
08015  |'                        .Cells(43, 40).Value = CS||08012  |'                        .Cells(43, 40).Value = CS
08016  |'                    Else                         ||08013  |'                    Else                         
08017  |'                        .Cells(43, 40).Value = CS||08014  |'                        .Cells(43, 40).Value = CS
08018  |'                    End If                       ||08015  |'                    End If                       
08019  |'                    AvgNav = dblValueOut         ||08016  |'                    AvgNav = dblValueOut         
08020  |'                                                 ||08017  |'                                                 
08021  |'                    '÷??＝                      ||08018  |'                    '÷??＝                      
08022  |'                    .Cells(43, 31).Value = sWord1||08019  |'                    .Cells(43, 31).Value = sWord1
08023  |'        End If                                   ||08020  |'        End If                                   
08024  |'    Else                                         ||08021  |'    Else                                         
08025  |'On Error GoTo OnErrorProc                        ||08022  |'On Error GoTo OnErrorProc                        
08026  |'                                                 ||08023  |'                                                 
08027  |'            '契約区分「3」の場合                 ||08024  |'            '契約区分「3」の場合                 
08028  |'            ddblTtalnav = 0                      ||08025  |'            ddblTtalnav = 0                      
08029  |'            For dintFor = 0 To NavGetCnt - 1     ||08026  |'            For dintFor = 0 To NavGetCnt - 1     
08030  |'                                                 ||08027  |'                                                 
08031  |'                '日次NAV平均取得                 ||08028  |'                '日次NAV平均取得                 
08032  |'                sStart = gstrDateFormat2(CStr(dSt||08029  |'                sStart = gstrDateFormat2(CStr(dSt
08033  |'                sEnd = gstrDateFormat2(CStr(dEnd)||08030  |'                sEnd = gstrDateFormat2(CStr(dEnd)
08034  |'                                                 ||08031  |'                                                 
08035  |'                sSql = ""                        ||08032  |'                sSql = ""                        
08036  |'                sSql = sSql & "SELECT ACCOUNT_COD||08033  |'                sSql = sSql & "SELECT ACCOUNT_COD
08037  |'                sSql = sSql & "WHERE (((CFR_DAILY||08034  |'                sSql = sSql & "WHERE (((CFR_DAILY
08038  |'                sSql = sSql & "AND ((CFR_DAILY_NA||08035  |'                sSql = sSql & "AND ((CFR_DAILY_NA
08039  |'                sSql = sSql & "AND ((CFR_DAILY_NA||08036  |'                sSql = sSql & "AND ((CFR_DAILY_NA
08040  |'                sSql = sSql & "ORDER BY CFR_DAILY||08037  |'                sSql = sSql & "ORDER BY CFR_DAILY
08041  |'                                                 ||08038  |'                                                 
08042  |'                If gintDyCreate(sSql) = False The||08039  |'                If gintDyCreate(sSql) = False The
08043  |'                    Exit Function                ||08040  |'                    Exit Function                
08044  |'                End If                           ||08041  |'                End If                           
08045  |'                                                 ||08042  |'                                                 
08046  |'                If dlngCnt = 0 Then              ||08043  |'                If dlngCnt = 0 Then              
08047  |'                    ReDim dstrCaldate(gbxOraDynas||08044  |'                    ReDim dstrCaldate(gbxOraDynas
08048  |'                    ReDim ddblDailynav(gbxOraDyna||08045  |'                    ReDim ddblDailynav(gbxOraDyna
08049  |'                End If                           ||08046  |'                End If                           
08050  |'                                                 ||08047  |'                                                 
08051  |'                dlngCnt = 0                      ||08048  |'                dlngCnt = 0                      
08052  |'                                                 ||08049  |'                                                 
08053  |'                Do Until gblnDyEOF()             ||08050  |'                Do Until gblnDyEOF()             
08054  |'                    dlngCnt = dlngCnt + 1        ||08051  |'                    dlngCnt = dlngCnt + 1        
08055  |'                    '抽出データセット            ||08052  |'                    '抽出データセット            
08056  |'                    dstrCaldate(dlngCnt) = gvlnDy||08053  |'                    dstrCaldate(dlngCnt) = gvlnDy
08057  |'                    ddblDailynav(dlngCnt) = ddblD||08054  |'                    ddblDailynav(dlngCnt) = ddblD
08058  |'                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ            ||08055  |'                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ            
08059  |'                    Call gDyNext                 ||08056  |'                    Call gDyNext                 
08060  |'                Loop                             ||08057  |'                Loop                             
08061  |'                                                 ||08058  |'                                                 
08062  |'            Next dintFor                         ||08059  |'            Next dintFor                         
08063  |'                                                 ||08060  |'                                                 
08064  |'            ddblTtalnav = 0                      ||08061  |'            ddblTtalnav = 0                      
08065  |'                                                 ||08062  |'                                                 
08066  |'            For dintFor2 = 1 To dlngCnt          ||08063  |'            For dintFor2 = 1 To dlngCnt          
08067  |'                ddblTtalnav = ddblTtalnav + ddblD||08064  |'                ddblTtalnav = ddblTtalnav + ddblD
08068  |'            Next dintFor2                        ||08065  |'            Next dintFor2                        
08069  |'                                                 ||08066  |'                                                 
08070  |'            iRowCnt = dlngCnt                    ||08067  |'            iRowCnt = dlngCnt                    
08071  |'            dlngMeisyoSu = dlngCnt               ||08068  |'            dlngMeisyoSu = dlngCnt               
08072  |'                                                 ||08069  |'                                                 
08073  |'            TotalNav = ddblTtalnav               ||08070  |'            TotalNav = ddblTtalnav               
08074  |'            dblValueIn = TotalNav                ||08071  |'            dblValueIn = TotalNav                
08075  |'            Call sbGetRoundValue2(dblValueIn)    ||08072  |'            Call sbGetRoundValue2(dblValueIn)    
08076  |'            TotalNav = dblValueOut               ||08073  |'            TotalNav = dblValueOut               
08077  |'                                                 ||08074  |'                                                 
08078  |'            '計算期間の純資産総額の合計÷計算期間||08075  |'            '計算期間の純資産総額の合計÷計算期間
08079  |'            dblValueIn = TotalNav / iRowCnt      ||08076  |'            dblValueIn = TotalNav / iRowCnt      
08080  |'            iCalcNum = iRowCnt                   ||08077  |'            iCalcNum = iRowCnt                   
08081  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base||08078  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base
08082  |'                  Call sbGetRoundValue2(dblValueI||08079  |'                  Call sbGetRoundValue2(dblValueI
08083  |'            Else                                 ||08080  |'            Else                                 
08084  |'                  Call sbGetRoundValue(dblValueIn||08081  |'                  Call sbGetRoundValue(dblValueIn
08085  |'            End If                               ||08082  |'            End If                               
08086  |'            dstrAvgNav = dblValueOut             ||08083  |'            dstrAvgNav = dblValueOut             
08087  |'            AvgNav = dstrAvgNav                  ||08084  |'            AvgNav = dstrAvgNav                  
08088  |'                                                 ||08085  |'                                                 
08089  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    ||08086  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    
08090  |'            Call gblnDyClose                     ||08087  |'            Call gblnDyClose                     
08091  |'                                                 ||08088  |'                                                 
08092  |'            '平均純資産総額                      ||08089  |'            '平均純資産総額                      
08093  |'            .Cells(43, 2).Value = sWord51a       ||08090  |'            .Cells(43, 2).Value = sWord51a       
08094  |'            .Cells(43, 16).Value = sWord19       ||08091  |'            .Cells(43, 16).Value = sWord19       
08095  |'            '計算期間の純資産総額の合計(月末純資 ||08092  |'            '計算期間の純資産総額の合計(月末純資 
08096  |'            .Cells(43, 28).NumberFormatLocal = "@||08093  |'            .Cells(43, 28).NumberFormatLocal = "@
08097  |'              If gbuMGetUPDRec.N(lRecIdx).MGET_ba||08094  |'              If gbuMGetUPDRec.N(lRecIdx).MGET_ba
08098  |'                  .Cells(43, 28).Value = CStr(For||08095  |'                  .Cells(43, 28).Value = CStr(For
08099  |'              Else                               ||08096  |'              Else                               
08100  |'                  .Cells(43, 28).Value = CStr(For||08097  |'                  .Cells(43, 28).Value = CStr(For
08101  |'              End If                             ||08098  |'              End If                             
08102  |'            .Cells(43, 28).HorizontalAlignment = ||08099  |'            .Cells(43, 28).HorizontalAlignment = 
08103  |'            '÷??＝                              ||08100  |'            '÷??＝                              
08104  |'            .Cells(43, 31).Value = sWord18 & "   ||08101  |'            .Cells(43, 31).Value = sWord18 & "   
08105  |'            '計算期間の純資産総額の合計÷計算期間||08102  |'            '計算期間の純資産総額の合計÷計算期間
08106  |'            .Cells(43, 40).NumberFormatLocal = "@||08103  |'            .Cells(43, 40).NumberFormatLocal = "@
08107  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base||08104  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base
08108  |'                .Cells(43, 40).Value = CStr(Forma||08105  |'                .Cells(43, 40).Value = CStr(Forma
08109  |'            Else                                 ||08106  |'            Else                                 
08110  |'                .Cells(43, 40).Value = CStr(Forma||08107  |'                .Cells(43, 40).Value = CStr(Forma
08111  |'            End If                               ||08108  |'            End If                               
08112  |'                                                 ||08109  |'                                                 
08113  |'            ddblExchangeRate = 0                 ||08110  |'            ddblExchangeRate = 0                 
08114  |'                                                 ||08111  |'                                                 
08115  |'            '投資顧問料計算用計算対象NAVに日次平 ||08112  |'            '投資顧問料計算用計算対象NAVに日次平 
08116  |'            If dstrAvgNav = "" Then              ||08113  |'            If dstrAvgNav = "" Then              
08117  |'                lCalcNav = 0                     ||08114  |'                lCalcNav = 0                     
08118  |'            Else                                 ||08115  |'            Else                                 
08119  |'                                                 ||08116  |'                                                 
08120  |'                dblValueIn = CDbl(dstrAvgNav)    ||08117  |'                dblValueIn = CDbl(dstrAvgNav)    
08121  |'                                                 ||08118  |'                                                 
08122  |'                '@@@@@ NAV通貨から閾値通貨に換算 ||08119  |'                '@@@@@ NAV通貨から閾値通貨に換算 
08123  |'                Select Case gbuMGetUPDRec.N(lRecI||08120  |'                Select Case gbuMGetUPDRec.N(lRecI
08124  |'                  Case "1"    '固定料率          ||08121  |'                  Case "1"    '固定料率          
08125  |'                    If gbuMGetUPDRec.N(lRecIdx).M||08122  |'                    If gbuMGetUPDRec.N(lRecIdx).M
08126  |'                        'NAV通貨→JPYの為替レート||08123  |'                        'NAV通貨→JPYの為替レート
08127  |'                        dstrCurrencyCode = gbuMGe||08124  |'                        dstrCurrencyCode = gbuMGe
08128  |'                        ddblExchangeRate = fnstrE||08125  |'                        ddblExchangeRate = fnstrE
08129  |'                        If ddblExchangeRate = 0 T||08126  |'                        If ddblExchangeRate = 0 T
08130  |'                          intRtn = MsgBox("ＴＴＭ||08127  |'                          intRtn = MsgBox("ＴＴＭ
08131  |'                          vbLf & "対象通貨コード ||08128  |'                          vbLf & "対象通貨コード 
08132  |'                          vbLf & "基準日 ： [ " &||08129  |'                          vbLf & "基準日 ： [ " &
08133  |'                              vbCritical, "ＴＴＭ||08130  |'                              vbCritical, "ＴＴＭ
08134  |'                          Exit Function          ||08131  |'                          Exit Function          
08135  |'                        End If                   ||08132  |'                        End If                   
08136  |'                        'NAV通貨→JPYへレート換算||08133  |'                        'NAV通貨→JPYへレート換算
08137  |'                        dblValueIn = dblValueIn *||08134  |'                        dblValueIn = dblValueIn *
08138  |'                    End If                       ||08135  |'                    End If                       
08139  |'                                                 ||08136  |'                                                 
08140  |'                  Case "2"    '段階料率          ||08137  |'                  Case "2"    '段階料率          
08141  |'                                                 ||08138  |'                                                 
08142  |'                    If gbuMGetUPDRec.N(lRecIdx).M||08139  |'                    If gbuMGetUPDRec.N(lRecIdx).M
08143  |'                        If gbuMGetUPDRec.N(lRecId||08140  |'                        If gbuMGetUPDRec.N(lRecId
08144  |'                        Else                     ||08141  |'                        Else                     
08145  |'                            '閾値通貨→JPYの為替 ||08142  |'                            '閾値通貨→JPYの為替 
08146  |'                            dstrCurrencyCode = gb||08143  |'                            dstrCurrencyCode = gb
08147  |'                            ddblExchangeRate = fn||08144  |'                            ddblExchangeRate = fn
08148  |'                            If ddblExchangeRate =||08145  |'                            If ddblExchangeRate =
08149  |'                              intRtn = MsgBox("Ｔ||08146  |'                              intRtn = MsgBox("Ｔ
08150  |'                              vbLf & "対象通貨コ ||08147  |'                              vbLf & "対象通貨コ 
08151  |'                              vbLf & "基準日 ： [||08148  |'                              vbLf & "基準日 ： [
08152  |'                                  vbCritical, "Ｔ||08149  |'                                  vbCritical, "Ｔ
08153  |'                              Exit Function      ||08150  |'                              Exit Function      
08154  |'                            End If               ||08151  |'                            End If               
08155  |'                            'JPY→閾値通貨へレー ||08152  |'                            'JPY→閾値通貨へレー 
08156  |'                            dblValueIn = dblValue||08153  |'                            dblValueIn = dblValue
08157  |'                        End If                   ||08154  |'                        End If                   
08158  |'                    Else                         ||08155  |'                    Else                         
08159  |'                        'NAV通貨→JPYの為替レート||08156  |'                        'NAV通貨→JPYの為替レート
08160  |'                        dstrCurrencyCode = gbuMGe||08157  |'                        dstrCurrencyCode = gbuMGe
08161  |'                        ddblExchangeRate = fnstrE||08158  |'                        ddblExchangeRate = fnstrE
08162  |'                        If ddblExchangeRate = 0 T||08159  |'                        If ddblExchangeRate = 0 T
08163  |'                          intRtn = MsgBox("ＴＴＭ||08160  |'                          intRtn = MsgBox("ＴＴＭ
08164  |'                          vbLf & "対象通貨コード ||08161  |'                          vbLf & "対象通貨コード 
08165  |'                          vbLf & "基準日 ： [ " &||08162  |'                          vbLf & "基準日 ： [ " &
08166  |'                              vbCritical, "ＴＴＭ||08163  |'                              vbCritical, "ＴＴＭ
08167  |'                          Exit Function          ||08164  |'                          Exit Function          
08168  |'                        End If                   ||08165  |'                        End If                   
08169  |'                        'NAV通貨→JPYへレート換算||08166  |'                        'NAV通貨→JPYへレート換算
08170  |'                        dblValueIn = dblValueIn *||08167  |'                        dblValueIn = dblValueIn *
08171  |'                        If gbuMGetUPDRec.N(lRecId||08168  |'                        If gbuMGetUPDRec.N(lRecId
08172  |'                        Else                     ||08169  |'                        Else                     
08173  |'                            '閾値通貨→JPYの為替 ||08170  |'                            '閾値通貨→JPYの為替 
08174  |'                            dstrCurrencyCode = gb||08171  |'                            dstrCurrencyCode = gb
08175  |'                            ddblExchangeRate = fn||08172  |'                            ddblExchangeRate = fn
08176  |'                            If ddblExchangeRate =||08173  |'                            If ddblExchangeRate =
08177  |'                              intRtn = MsgBox("Ｔ||08174  |'                              intRtn = MsgBox("Ｔ
08178  |'                              vbLf & "対象通貨コ ||08175  |'                              vbLf & "対象通貨コ 
08179  |'                              vbLf & "基準日 ： [||08176  |'                              vbLf & "基準日 ： [
08180  |'                                  vbCritical, "Ｔ||08177  |'                                  vbCritical, "Ｔ
08181  |'                              Exit Function      ||08178  |'                              Exit Function      
08182  |'                            End If               ||08179  |'                            End If               
08183  |'                            'JPY→閾値通貨へ逆レ ||08180  |'                            'JPY→閾値通貨へ逆レ 
08184  |'                            dblValueIn = dblValue||08181  |'                            dblValueIn = dblValue
08185  |'                        End If                   ||08182  |'                        End If                   
08186  |'                    End If                       ||08183  |'                    End If                       
08187  |'                                                 ||08184  |'                                                 
08188  |'                End Select                       ||08185  |'                End Select                       
08189  |'                '@@@@@ NAV通貨から閾値通貨に換算 ||08186  |'                '@@@@@ NAV通貨から閾値通貨に換算 
08190  |'                Call sbGetRoundValue2(dblValueIn)||08187  |'                Call sbGetRoundValue2(dblValueIn)
08191  |'                                                 ||08188  |'                                                 
08192  |''閾値レート換算後平均NAV(計算対象NAV)            ||08189  |''閾値レート換算後平均NAV(計算対象NAV)            
08193  |'                lCalcNav = CStr(Format(dblValueOu||08190  |'                lCalcNav = CStr(Format(dblValueOu
08194  |'            End If                               ||08191  |'            End If                               
08195  |'                                                 ||08192  |'                                                 
08196  |'On Error Resume Next                             ||08193  |'On Error Resume Next                             
08197  |'        End If                                   ||08194  |'        End If                                   
08198  |'                                                 ||08195  |'                                                 
08199  |'        '投資顧問料                              ||08196  |'        '投資顧問料                              
08200  |'        Dim dRitsu As Double    '外部委託顧問料率||08197  |'        Dim dRitsu As Double    '外部委託顧問料率
08201  |'        dRitsu = 0                               ||08198  |'        dRitsu = 0                               
08202  |'        TotalRate = 0                            ||08199  |'        TotalRate = 0                            
08203  |'        ddblExchangeRate = 0                     ||08200  |'        ddblExchangeRate = 0                     
08204  |'        '計算対象NAVを変数にセット               ||08201  |'        '計算対象NAVを変数にセット               
08205  |'            lCalcNav = 0                         ||08202  |'            lCalcNav = 0                         
08206  |'            dblValueIn = TotalNav / iRowCnt      ||08203  |'            dblValueIn = TotalNav / iRowCnt      
08207  |'                                                 ||08204  |'                                                 
08208  |'            '@@@@@ NAV通貨から閾値通貨に換算 @@@@||08205  |'            '@@@@@ NAV通貨から閾値通貨に換算 @@@@
08209  |'            Select Case gbuMGetUPDRec.N(lRecIdx).||08206  |'            Select Case gbuMGetUPDRec.N(lRecIdx).
08210  |'              Case "1"    '固定料率(固定料率の場 ||08207  |'              Case "1"    '固定料率(固定料率の場 
08211  |'                                                 ||08208  |'                                                 
08212  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||08209  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
08213  |'                    'NAV通貨→JPYの為替レートを取||08210  |'                    'NAV通貨→JPYの為替レートを取
08214  |'                    dstrCurrencyCode = gbuMGetUPD||08211  |'                    dstrCurrencyCode = gbuMGetUPD
08215  |'                    ddblExchangeRate = fnstrExcha||08212  |'                    ddblExchangeRate = fnstrExcha
08216  |'                    If ddblExchangeRate = 0 Then ||08213  |'                    If ddblExchangeRate = 0 Then 
08217  |'                      intRtn = MsgBox("ＴＴＭが取||08214  |'                      intRtn = MsgBox("ＴＴＭが取
08218  |'                      vbLf & "対象通貨コード ： [||08215  |'                      vbLf & "対象通貨コード ： [
08219  |'                      vbLf & "基準日 ： [ " & Mid||08216  |'                      vbLf & "基準日 ： [ " & Mid
08220  |'                          vbCritical, "ＴＴＭ取得||08217  |'                          vbCritical, "ＴＴＭ取得
08221  |'                      Exit Function              ||08218  |'                      Exit Function              
08222  |'                    End If                       ||08219  |'                    End If                       
08223  |'                    'NAV通貨→JPYへレート換算    ||08220  |'                    'NAV通貨→JPYへレート換算    
08224  |'                    dblValueIn = dblValueIn * ddb||08221  |'                    dblValueIn = dblValueIn * ddb
08225  |'                End If                           ||08222  |'                End If                           
08226  |'                                                 ||08223  |'                                                 
08227  |'              Case "2"    '段階料率              ||08224  |'              Case "2"    '段階料率              
08228  |'                                                 ||08225  |'                                                 
08229  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||08226  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
08230  |'                    If gbuMGetUPDRec.N(lRecIdx).M||08227  |'                    If gbuMGetUPDRec.N(lRecIdx).M
08231  |'                    Else                         ||08228  |'                    Else                         
08232  |'                        '閾値通貨→JPYの為替レー ||08229  |'                        '閾値通貨→JPYの為替レー 
08233  |'                        dstrCurrencyCode = gbuMGe||08230  |'                        dstrCurrencyCode = gbuMGe
08234  |'                        ddblExchangeRate = fnstrE||08231  |'                        ddblExchangeRate = fnstrE
08235  |'                        If ddblExchangeRate = 0 T||08232  |'                        If ddblExchangeRate = 0 T
08236  |'                          intRtn = MsgBox("ＴＴＭ||08233  |'                          intRtn = MsgBox("ＴＴＭ
08237  |'                          vbLf & "対象通貨コード ||08234  |'                          vbLf & "対象通貨コード 
08238  |'                          vbLf & "基準日 ： [ " &||08235  |'                          vbLf & "基準日 ： [ " &
08239  |'                              vbCritical, "ＴＴＭ||08236  |'                              vbCritical, "ＴＴＭ
08240  |'                          Exit Function          ||08237  |'                          Exit Function          
08241  |'                        End If                   ||08238  |'                        End If                   
08242  |'                        'JPY→閾値通貨へレート換 ||08239  |'                        'JPY→閾値通貨へレート換 
08243  |'                        dblValueIn = dblValueIn *||08240  |'                        dblValueIn = dblValueIn *
08244  |'                    End If                       ||08241  |'                    End If                       
08245  |'                Else                             ||08242  |'                Else                             
08246  |'                    'NAV通貨→JPYの為替レートを取||08243  |'                    'NAV通貨→JPYの為替レートを取
08247  |'                    dstrCurrencyCode = gbuMGetUPD||08244  |'                    dstrCurrencyCode = gbuMGetUPD
08248  |'                    ddblExchangeRate = fnstrExcha||08245  |'                    ddblExchangeRate = fnstrExcha
08249  |'                    If ddblExchangeRate = 0 Then ||08246  |'                    If ddblExchangeRate = 0 Then 
08250  |'                      intRtn = MsgBox("ＴＴＭが取||08247  |'                      intRtn = MsgBox("ＴＴＭが取
08251  |'                      vbLf & "対象通貨コード ： [||08248  |'                      vbLf & "対象通貨コード ： [
08252  |'                      vbLf & "基準日 ： [ " & Mid||08249  |'                      vbLf & "基準日 ： [ " & Mid
08253  |'                          vbCritical, "ＴＴＭ取得||08250  |'                          vbCritical, "ＴＴＭ取得
08254  |'                      Exit Function              ||08251  |'                      Exit Function              
08255  |'                    End If                       ||08252  |'                    End If                       
08256  |'                    'NAV通貨→JPYへレート換算    ||08253  |'                    'NAV通貨→JPYへレート換算    
08257  |'                    dblValueIn = dblValueIn * ddb||08254  |'                    dblValueIn = dblValueIn * ddb
08258  |'                    If gbuMGetUPDRec.N(lRecIdx).M||08255  |'                    If gbuMGetUPDRec.N(lRecIdx).M
08259  |'                    Else                         ||08256  |'                    Else                         
08260  |'                        '閾値通貨→JPYの為替レー ||08257  |'                        '閾値通貨→JPYの為替レー 
08261  |'                        dstrCurrencyCode = gbuMGe||08258  |'                        dstrCurrencyCode = gbuMGe
08262  |'                        ddblExchangeRate = fnstrE||08259  |'                        ddblExchangeRate = fnstrE
08263  |'                        If ddblExchangeRate = 0 T||08260  |'                        If ddblExchangeRate = 0 T
08264  |'                          intRtn = MsgBox("ＴＴＭ||08261  |'                          intRtn = MsgBox("ＴＴＭ
08265  |'                          vbLf & "対象通貨コード ||08262  |'                          vbLf & "対象通貨コード 
08266  |'                          vbLf & "基準日 ： [ " &||08263  |'                          vbLf & "基準日 ： [ " &
08267  |'                              vbCritical, "ＴＴＭ||08264  |'                              vbCritical, "ＴＴＭ
08268  |'                          Exit Function          ||08265  |'                          Exit Function          
08269  |'                        End If                   ||08266  |'                        End If                   
08270  |'                        'JPY→閾値通貨へ逆レート ||08267  |'                        'JPY→閾値通貨へ逆レート 
08271  |'                        dblValueIn = dblValueIn /||08268  |'                        dblValueIn = dblValueIn /
08272  |'                    End If                       ||08269  |'                    End If                       
08273  |'                End If                           ||08270  |'                End If                           
08274  |'            End Select                           ||08271  |'            End Select                           
08275  |'            '@@@@@ NAV通貨から閾値通貨に換算 @@@@||08272  |'            '@@@@@ NAV通貨から閾値通貨に換算 @@@@
08276  |'            Call sbGetRoundValue2(dblValueIn)    ||08273  |'            Call sbGetRoundValue2(dblValueIn)    
08277  |'            lCalcNav = CStr(Format(dblValueOut, "||08274  |'            lCalcNav = CStr(Format(dblValueOut, "
08278  |'                                                 ||08275  |'                                                 
08279  |'        '固定料率                                ||08276  |'        '固定料率                                
08280  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_ra||08277  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_ra
08281  |'            '計算対称NAV × 外部委託顧問料率 ÷ 1||08278  |'            '計算対称NAV × 外部委託顧問料率 ÷ 1
08282  |'            dRitsu = CDbl(gbuOtherComRateGetUPDRe||08279  |'            dRitsu = CDbl(gbuOtherComRateGetUPDRe
08283  |'                                                 ||08280  |'                                                 
08284  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days||08281  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days
08285  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days||08282  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days
08286  |'                '一年間の日数：365日またはカレン ||08283  |'                '一年間の日数：365日またはカレン 
08287  |'                dblValueIn = lCalcNav * dRitsu / ||08284  |'                dblValueIn = lCalcNav * dRitsu / 
08288  |'            Else                                 ||08285  |'            Else                                 
08289  |'                '一年間の日数：360日             ||08286  |'                '一年間の日数：360日             
08290  |'                dblValueIn = lCalcNav * dRitsu / ||08287  |'                dblValueIn = lCalcNav * dRitsu / 
08291  |'            End If                               ||08288  |'            End If                               
08292  |'                                                 ||08289  |'                                                 
08293  |'        '段階料率                                ||08290  |'        '段階料率                                
08294  |'        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_othe||08291  |'        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_othe
08295  |'            '料率分ループ処理                    ||08292  |'            '料率分ループ処理                    
08296  |'            For i = LBound(gbuOtherComRateGetUPDR||08293  |'            For i = LBound(gbuOtherComRateGetUPDR
08297  |'                TotalRate = TotalRate + CCur(gbuO||08294  |'                TotalRate = TotalRate + CCur(gbuO
08298  |'                cRate = CCur(gbuOtherComRateGetUP||08295  |'                cRate = CCur(gbuOtherComRateGetUP
08299  |'                dRitsu = CDbl(gbuOtherComRateGetU||08296  |'                dRitsu = CDbl(gbuOtherComRateGetU
08300  |'                If i = UBound(gbuOtherComRateGetU||08297  |'                If i = UBound(gbuOtherComRateGetU
08301  |'                    '(前回閾値)：累積閾値 = WORK ||08298  |'                    '(前回閾値)：累積閾値 = WORK 
08302  |'                    TotalRate = WorkRate         ||08299  |'                    TotalRate = WorkRate         
08303  |'                ElseIf TotalRate <= lCalcNav Then||08300  |'                ElseIf TotalRate <= lCalcNav Then
08304  |'                    '累積投資顧問料 = 累積投資顧 ||08301  |'                    '累積投資顧問料 = 累積投資顧 
08305  |'                    dblValueIn = cRate * dRitsu /||08302  |'                    dblValueIn = cRate * dRitsu /
08306  |'                    Call sbGetRoundValue2(dblValu||08303  |'                    Call sbGetRoundValue2(dblValu
08307  |'                    TotalCom = TotalCom + dblValu||08304  |'                    TotalCom = TotalCom + dblValu
08308  |'                Else                             ||08305  |'                Else                             
08309  |'                    '(前回閾値)：累積閾値 = WORK ||08306  |'                    '(前回閾値)：累積閾値 = WORK 
08310  |'                    TotalRate = WorkRate         ||08307  |'                    TotalRate = WorkRate         
08311  |'                    Exit For                     ||08308  |'                    Exit For                     
08312  |'                End If                           ||08309  |'                End If                           
08313  |'                '累積閾値をWORKに格納(一つ前の閾 ||08310  |'                '累積閾値をWORKに格納(一つ前の閾 
08314  |'                WorkRate = TotalRate             ||08311  |'                WorkRate = TotalRate             
08315  |'            Next i                               ||08312  |'            Next i                               
08316  |'            '累積投資顧問料 = 累積投資顧問料 + ( ||08313  |'            '累積投資顧問料 = 累積投資顧問料 + ( 
08317  |'            dblValueIn = (lCalcNav - TotalRate) *||08314  |'            dblValueIn = (lCalcNav - TotalRate) *
08318  |'            TotalCom = TotalCom + dblValueIn     ||08315  |'            TotalCom = TotalCom + dblValueIn     
08319  |'                                                 ||08316  |'                                                 
08320  |'            '投資顧問料 = 累積投資顧問料 × 計算 ||08317  |'            '投資顧問料 = 累積投資顧問料 × 計算 
08321  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days||08318  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days
08322  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days||08319  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days
08323  |'                '一年間の日数：365日またはカレン ||08320  |'                '一年間の日数：365日またはカレン 
08324  |'                dblValueIn = TotalCom * iCalcNum ||08321  |'                dblValueIn = TotalCom * iCalcNum 
08325  |'            Else                                 ||08322  |'            Else                                 
08326  |'                '一年間の日数：360日             ||08323  |'                '一年間の日数：360日             
08327  |'                dblValueIn = TotalCom * iCalcNum ||08324  |'                dblValueIn = TotalCom * iCalcNum 
08328  |'            End If                               ||08325  |'            End If                               
08329  |'        End If                                   ||08326  |'        End If                                   
08330  |'                                                 ||08327  |'                                                 
08331  |'        ddblExchangeRate = 0                     ||08328  |'        ddblExchangeRate = 0                     
08332  |'                                                 ||08329  |'                                                 
08333  |'        '@@@@@ 外部委託顧問料に換算 @@@@@        ||08330  |'        '@@@@@ 外部委託顧問料に換算 @@@@@        
08334  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET||08331  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET
08335  |'          Case "1"    '固定料率                  ||08332  |'          Case "1"    '固定料率                  
08336  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||08333  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
08337  |'                Else                             ||08334  |'                Else                             
08338  |'                  '外部委託顧問料通貨→JPYの為替 ||08335  |'                  '外部委託顧問料通貨→JPYの為替 
08339  |'                  dstrCurrencyCode = gbuMGetUPDRe||08336  |'                  dstrCurrencyCode = gbuMGetUPDRe
08340  |'                  ddblExchangeRate = fnstrExchang||08337  |'                  ddblExchangeRate = fnstrExchang
08341  |'                  If ddblExchangeRate = 0 Then   ||08338  |'                  If ddblExchangeRate = 0 Then   
08342  |'                    intRtn = MsgBox("ＴＴＭが取得||08339  |'                    intRtn = MsgBox("ＴＴＭが取得
08343  |'                    vbLf & "対象通貨コード ： [ "||08340  |'                    vbLf & "対象通貨コード ： [ "
08344  |'                    vbLf & "基準日 ： [ " & Mid(d||08341  |'                    vbLf & "基準日 ： [ " & Mid(d
08345  |'                        vbCritical, "ＴＴＭ取得エ||08342  |'                        vbCritical, "ＴＴＭ取得エ
08346  |'                    Exit Function                ||08343  |'                    Exit Function                
08347  |'                  End If                         ||08344  |'                  End If                         
08348  |'                  'JPY→閾値通貨へ逆レート換算   ||08345  |'                  'JPY→閾値通貨へ逆レート換算   
08349  |'                  dblValueIn = dblValueIn / ddblE||08346  |'                  dblValueIn = dblValueIn / ddblE
08350  |'                End If                           ||08347  |'                End If                           
08351  |'                                                 ||08348  |'                                                 
08352  |'          Case "2"    '段階料率                  ||08349  |'          Case "2"    '段階料率                  
08353  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe||08350  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe
08354  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||08351  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
08355  |'                Else                             ||08352  |'                Else                             
08356  |'                    '閾値通貨→JPYの為替レートを ||08353  |'                    '閾値通貨→JPYの為替レートを 
08357  |'                    dstrCurrencyCode = gbuMGetUPD||08354  |'                    dstrCurrencyCode = gbuMGetUPD
08358  |'                    ddblExchangeRate = fnstrExcha||08355  |'                    ddblExchangeRate = fnstrExcha
08359  |'                    'JPY→閾値通貨へ逆レート換算 ||08356  |'                    'JPY→閾値通貨へ逆レート換算 
08360  |'                    dblValueIn = dblValueIn / ddb||08357  |'                    dblValueIn = dblValueIn / ddb
08361  |'                End If                           ||08358  |'                End If                           
08362  |'            Else                                 ||08359  |'            Else                                 
08363  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||08360  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
08364  |'                    '外部委託顧問料通貨→JPYの為 ||08361  |'                    '外部委託顧問料通貨→JPYの為 
08365  |'                    dstrCurrencyCode = gbuMGetUPD||08362  |'                    dstrCurrencyCode = gbuMGetUPD
08366  |'                    ddblExchangeRate = fnstrExcha||08363  |'                    ddblExchangeRate = fnstrExcha
08367  |'                    'JPY→閾値通貨へレート換算   ||08364  |'                    'JPY→閾値通貨へレート換算   
08368  |'                    dblValueIn = dblValueIn / ddb||08365  |'                    dblValueIn = dblValueIn / ddb
08369  |'                Else                             ||08366  |'                Else                             
08370  |'                    '閾値通貨→JPYの為替レートを ||08367  |'                    '閾値通貨→JPYの為替レートを 
08371  |'                    dstrCurrencyCode = gbuMGetUPD||08368  |'                    dstrCurrencyCode = gbuMGetUPD
08372  |'                    ddblExchangeRate = fnstrExcha||08369  |'                    ddblExchangeRate = fnstrExcha
08373  |'                    'JPY→閾値通貨へ逆レート換算 ||08370  |'                    'JPY→閾値通貨へ逆レート換算 
08374  |'                    dblValueIn = dblValueIn * ddb||08371  |'                    dblValueIn = dblValueIn * ddb
08375  |'                    '外部委託顧問料通貨→JPYの為 ||08372  |'                    '外部委託顧問料通貨→JPYの為 
08376  |'                    dstrCurrencyCode = gbuMGetUPD||08373  |'                    dstrCurrencyCode = gbuMGetUPD
08377  |'                    ddblExchangeRate = fnstrExcha||08374  |'                    ddblExchangeRate = fnstrExcha
08378  |'                    'JPY→閾値通貨へ逆レート換算 ||08375  |'                    'JPY→閾値通貨へ逆レート換算 
08379  |'                    dblValueIn = dblValueIn / ddb||08376  |'                    dblValueIn = dblValueIn / ddb
08380  |'                End If                           ||08377  |'                End If                           
08381  |'            End If                               ||08378  |'            End If                               
08382  |'                                                 ||08379  |'                                                 
08383  |'        End Select                               ||08380  |'        End Select                               
08384  |'        '@@@@@ 外部委託顧問料に換算 @@@@@        ||08381  |'        '@@@@@ 外部委託顧問料に換算 @@@@@        
08385  |'        Call sbGetRoundValue2(dblValueIn)        ||08382  |'        Call sbGetRoundValue2(dblValueIn)        
08386  |'        mstrMonthlyPayCom = dblValueOut          ||08383  |'        mstrMonthlyPayCom = dblValueOut          
08387  |'                                                 ||08384  |'                                                 
08388  |'        TotalRate = 0                            ||08385  |'        TotalRate = 0                            
08389  |'        '固定料率                                ||08386  |'        '固定料率                                
08390  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_ra||08387  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_ra
08391  |'            '年率1行固定                         ||08388  |'            '年率1行固定                         
08392  |'            .Cells(15, 13).Value = _             ||08389  |'            .Cells(15, 13).Value = _             
08393  |'                Format(gbuOtherComRateGetUPDRec.N||08390  |'                Format(gbuOtherComRateGetUPDRec.N
08394  |'        '段階料率                                ||08391  |'        '段階料率                                
08395  |'        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_othe||08392  |'        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_othe
08396  |'            '料率順位のデータ数により処理を分岐  ||08393  |'            '料率順位のデータ数により処理を分岐  
08397  |'            iRowCnt = 0                          ||08394  |'            iRowCnt = 0                          
08398  |'                                                 ||08395  |'                                                 
08399  |'                For i = LBound(gbuOtherComRateGet||08396  |'                For i = LBound(gbuOtherComRateGet
08400  |'                    If i = 0 Then                ||08397  |'                    If i = 0 Then                
08401  |'                        '年率1行目               ||08398  |'                        '年率1行目               
08402  |'                                                 ||08399  |'                                                 
08403  |'                        Select Case gbuMGetUPDRec||08400  |'                        Select Case gbuMGetUPDRec
08404  |'                            Case cAud            ||08401  |'                            Case cAud            
08405  |'                                .Cells(15, 13).Va||08402  |'                                .Cells(15, 13).Va
08406  |'                                    sWord26a & CS||08403  |'                                    sWord26a & CS
08407  |'                                    sAuda & sWord||08404  |'                                    sAuda & sWord
08408  |'                            Case cCad            ||08405  |'                            Case cCad            
08409  |'                                .Cells(15, 13).Va||08406  |'                                .Cells(15, 13).Va
08410  |'                                    sWord26a & CS||08407  |'                                    sWord26a & CS
08411  |'                                    sCada & sWord||08408  |'                                    sCada & sWord
08412  |'                            Case cChf            ||08409  |'                            Case cChf            
08413  |'                                .Cells(15, 13).Va||08410  |'                                .Cells(15, 13).Va
08414  |'                                    sWord26a & CS||08411  |'                                    sWord26a & CS
08415  |'                                    sChfa & sWord||08412  |'                                    sChfa & sWord
08416  |'                            Case cEur            ||08413  |'                            Case cEur            
08417  |'                                .Cells(15, 13).Va||08414  |'                                .Cells(15, 13).Va
08418  |'                                    sWord26a & CS||08415  |'                                    sWord26a & CS
08419  |'                                    sEura & sWord||08416  |'                                    sEura & sWord
08420  |'                            Case cGbp            ||08417  |'                            Case cGbp            
08421  |'                                .Cells(15, 13).Va||08418  |'                                .Cells(15, 13).Va
08422  |'                                    sWord26a & CS||08419  |'                                    sWord26a & CS
08423  |'                                    sGbpa & sWord||08420  |'                                    sGbpa & sWord
08424  |'                            Case cHkd            ||08421  |'                            Case cHkd            
08425  |'                                .Cells(15, 13).Va||08422  |'                                .Cells(15, 13).Va
08426  |'                                    sWord26a & CS||08423  |'                                    sWord26a & CS
08427  |'                                    sHkda & sWord||08424  |'                                    sHkda & sWord
08428  |'                            Case cJpy            ||08425  |'                            Case cJpy            
08429  |'                                .Cells(15, 13).Va||08426  |'                                .Cells(15, 13).Va
08430  |'                                    sWord26a & CS||08427  |'                                    sWord26a & CS
08431  |'                                    sYena & sWord||08428  |'                                    sYena & sWord
08432  |'                            Case cMyr            ||08429  |'                            Case cMyr            
08433  |'                                .Cells(15, 13).Va||08430  |'                                .Cells(15, 13).Va
08434  |'                                    sWord26a & CS||08431  |'                                    sWord26a & CS
08435  |'                                    sMyra & sWord||08432  |'                                    sMyra & sWord
08436  |'                            Case cNzd            ||08433  |'                            Case cNzd            
08437  |'                                .Cells(15, 13).Va||08434  |'                                .Cells(15, 13).Va
08438  |'                                    sWord26a & CS||08435  |'                                    sWord26a & CS
08439  |'                                    sNzda & sWord||08436  |'                                    sNzda & sWord
08440  |'                            Case cSek            ||08437  |'                            Case cSek            
08441  |'                                .Cells(15, 13).Va||08438  |'                                .Cells(15, 13).Va
08442  |'                                    sWord26a & CS||08439  |'                                    sWord26a & CS
08443  |'                                    sSeka & sWord||08440  |'                                    sSeka & sWord
08444  |'                            Case cSgd            ||08441  |'                            Case cSgd            
08445  |'                                .Cells(15, 13).Va||08442  |'                                .Cells(15, 13).Va
08446  |'                                    sWord26a & CS||08443  |'                                    sWord26a & CS
08447  |'                                    sSgda & sWord||08444  |'                                    sSgda & sWord
08448  |'                            Case cUsd            ||08445  |'                            Case cUsd            
08449  |'                                .Cells(15, 13).Va||08446  |'                                .Cells(15, 13).Va
08450  |'                                    sWord26a & CS||08447  |'                                    sWord26a & CS
08451  |'                                    sUsda & sWord||08448  |'                                    sUsda & sWord
08452  |'                            Case cNok            ||08449  |'                            Case cNok            
08453  |'                                .Cells(15, 13).Va||08450  |'                                .Cells(15, 13).Va
08454  |'                                    sWord26a & CS||08451  |'                                    sWord26a & CS
08455  |'                                    sNoka & sWord||08452  |'                                    sNoka & sWord
08456  |'                        End Select               ||08453  |'                        End Select               
08457  |'                                                 ||08454  |'                                                 
08458  |'                        '年率　累積値セット      ||08455  |'                        '年率　累積値セット      
08459  |'                        TotalRate = CCur(gbuOther||08456  |'                        TotalRate = CCur(gbuOther
08460  |'                    ElseIf i = UBound(gbuOtherCom||08457  |'                    ElseIf i = UBound(gbuOtherCom
08461  |'                        If UBound(gbuOtherComRate||08458  |'                        If UBound(gbuOtherComRate
08462  |'                            '年率最終行          ||08459  |'                            '年率最終行          
08463  |'                                                 ||08460  |'                                                 
08464  |'                            '前半金額部分        ||08461  |'                            '前半金額部分        
08465  |'                            .Cells(15 + i + UBoun||08462  |'                            .Cells(15 + i + UBoun
08466  |'                                                 ||08463  |'                                                 
08467  |'                            If gbuMGetUPDRec.N(lR||08464  |'                            If gbuMGetUPDRec.N(lR
08468  |'                                .Cells(15 + i + U||08465  |'                                .Cells(15 + i + U
08469  |'                            Else                 ||08466  |'                            Else                 
08470  |'                                .Cells(15 + i + U||08467  |'                                .Cells(15 + i + U
08471  |'                            End If               ||08468  |'                            End If               
08472  |'                                                 ||08469  |'                                                 
08473  |'                            '後半の文言          ||08470  |'                            '後半の文言          
08474  |'                            Select Case gbuMGetUP||08471  |'                            Select Case gbuMGetUP
08475  |'                                Case cAud        ||08472  |'                                Case cAud        
08476  |'                                    .Cells(15 + i||08473  |'                                    .Cells(15 + i
08477  |'                                         sAuda & ||08474  |'                                         sAuda & 
08478  |'                                Case cCad        ||08475  |'                                Case cCad        
08479  |'                                    .Cells(15 + i||08476  |'                                    .Cells(15 + i
08480  |'                                         sCada & ||08477  |'                                         sCada & 
08481  |'                                Case cChf        ||08478  |'                                Case cChf        
08482  |'                                    .Cells(15 + i||08479  |'                                    .Cells(15 + i
08483  |'                                         sChfa & ||08480  |'                                         sChfa & 
08484  |'                                Case cEur        ||08481  |'                                Case cEur        
08485  |'                                    .Cells(15 + i||08482  |'                                    .Cells(15 + i
08486  |'                                         sEura & ||08483  |'                                         sEura & 
08487  |'                                Case cGbp        ||08484  |'                                Case cGbp        
08488  |'                                    .Cells(15 + i||08485  |'                                    .Cells(15 + i
08489  |'                                         sGbpa & ||08486  |'                                         sGbpa & 
08490  |'                                Case cHkd        ||08487  |'                                Case cHkd        
08491  |'                                    .Cells(15 + i||08488  |'                                    .Cells(15 + i
08492  |'                                         sHkda & ||08489  |'                                         sHkda & 
08493  |'                                Case cJpy        ||08490  |'                                Case cJpy        
08494  |'                                    .Cells(15 + i||08491  |'                                    .Cells(15 + i
08495  |'                                         sYena & ||08492  |'                                         sYena & 
08496  |'                                Case cMyr        ||08493  |'                                Case cMyr        
08497  |'                                    .Cells(15 + i||08494  |'                                    .Cells(15 + i
08498  |'                                         sMyra & ||08495  |'                                         sMyra & 
08499  |'                                Case cNzd        ||08496  |'                                Case cNzd        
08500  |'                                    .Cells(15 + i||08497  |'                                    .Cells(15 + i
08501  |'                                         sNzda & ||08498  |'                                         sNzda & 
08502  |'                                Case cSek        ||08499  |'                                Case cSek        
08503  |'                                    .Cells(15 + i||08500  |'                                    .Cells(15 + i
08504  |'                                         sSeka & ||08501  |'                                         sSeka & 
08505  |'                                Case cSgd        ||08502  |'                                Case cSgd        
08506  |'                                    .Cells(15 + i||08503  |'                                    .Cells(15 + i
08507  |'                                         sSgda & ||08504  |'                                         sSgda & 
08508  |'                                Case cUsd        ||08505  |'                                Case cUsd        
08509  |'                                    .Cells(15 + i||08506  |'                                    .Cells(15 + i
08510  |'                                         sUsda & ||08507  |'                                         sUsda & 
08511  |'                                Case cNok        ||08508  |'                                Case cNok        
08512  |'                                    .Cells(15 + i||08509  |'                                    .Cells(15 + i
08513  |'                                         sNoka & ||08510  |'                                         sNoka & 
08514  |'                            End Select           ||08511  |'                            End Select           
08515  |'                        Else                     ||08512  |'                        Else                     
08516  |'                            '年率最終行          ||08513  |'                            '年率最終行          
08517  |'                            '前半金額部分        ||08514  |'                            '前半金額部分        
08518  |'                            .Cells(15 + i + UBoun||08515  |'                            .Cells(15 + i + UBoun
08519  |'                            If gbuMGetUPDRec.N(lR||08516  |'                            If gbuMGetUPDRec.N(lR
08520  |'                                .Cells(15 + i + U||08517  |'                                .Cells(15 + i + U
08521  |'                            Else                 ||08518  |'                            Else                 
08522  |'                                .Cells(15 + i + U||08519  |'                                .Cells(15 + i + U
08523  |'                            End If               ||08520  |'                            End If               
08524  |'                                                 ||08521  |'                                                 
08525  |'                            '後半の文言          ||08522  |'                            '後半の文言          
08526  |'                            .Cells(15 + i + UBoun||08523  |'                            .Cells(15 + i + UBoun
08527  |'                                                 ||08524  |'                                                 
08528  |'                            Select Case gbuMGetUP||08525  |'                            Select Case gbuMGetUP
08529  |'                                Case cAud        ||08526  |'                                Case cAud        
08530  |'                                    .Cells(15 + i||08527  |'                                    .Cells(15 + i
08531  |'                                         sAuda & ||08528  |'                                         sAuda & 
08532  |'                                Case cCad        ||08529  |'                                Case cCad        
08533  |'                                    .Cells(15 + i||08530  |'                                    .Cells(15 + i
08534  |'                                         sCada & ||08531  |'                                         sCada & 
08535  |'                                Case cChf        ||08532  |'                                Case cChf        
08536  |'                                    .Cells(15 + i||08533  |'                                    .Cells(15 + i
08537  |'                                         sChfa & ||08534  |'                                         sChfa & 
08538  |'                                Case cEur        ||08535  |'                                Case cEur        
08539  |'                                    .Cells(15 + i||08536  |'                                    .Cells(15 + i
08540  |'                                         sEura & ||08537  |'                                         sEura & 
08541  |'                                Case cGbp        ||08538  |'                                Case cGbp        
08542  |'                                    .Cells(15 + i||08539  |'                                    .Cells(15 + i
08543  |'                                         sGbpa & ||08540  |'                                         sGbpa & 
08544  |'                                Case cHkd        ||08541  |'                                Case cHkd        
08545  |'                                    .Cells(15 + i||08542  |'                                    .Cells(15 + i
08546  |'                                         sHkda & ||08543  |'                                         sHkda & 
08547  |'                                Case cJpy        ||08544  |'                                Case cJpy        
08548  |'                                    .Cells(15 + i||08545  |'                                    .Cells(15 + i
08549  |'                                         sYena & ||08546  |'                                         sYena & 
08550  |'                                Case cMyr        ||08547  |'                                Case cMyr        
08551  |'                                    .Cells(15 + i||08548  |'                                    .Cells(15 + i
08552  |'                                         sMyra & ||08549  |'                                         sMyra & 
08553  |'                                Case cNzd        ||08550  |'                                Case cNzd        
08554  |'                                    .Cells(15 + i||08551  |'                                    .Cells(15 + i
08555  |'                                         sNzda & ||08552  |'                                         sNzda & 
08556  |'                                Case cSek        ||08553  |'                                Case cSek        
08557  |'                                    .Cells(15 + i||08554  |'                                    .Cells(15 + i
08558  |'                                         sSeka & ||08555  |'                                         sSeka & 
08559  |'                                Case cSgd        ||08556  |'                                Case cSgd        
08560  |'                                    .Cells(15 + i||08557  |'                                    .Cells(15 + i
08561  |'                                         sSgda & ||08558  |'                                         sSgda & 
08562  |'                                Case cUsd        ||08559  |'                                Case cUsd        
08563  |'                                    .Cells(15 + i||08560  |'                                    .Cells(15 + i
08564  |'                                         sUsda & ||08561  |'                                         sUsda & 
08565  |'                                Case cNok        ||08562  |'                                Case cNok        
08566  |'                                    .Cells(15 + i||08563  |'                                    .Cells(15 + i
08567  |'                                         sNoka & ||08564  |'                                         sNoka & 
08568  |'                            End Select           ||08565  |'                            End Select           
08569  |'                        End If                   ||08566  |'                        End If                   
08570  |'                    Else                         ||08567  |'                    Else                         
08571  |'                                                 ||08568  |'                                                 
08572  |'                        '年率2行目以降           ||08569  |'                        '年率2行目以降           
08573  |'                        '前半金額部分            ||08570  |'                        '前半金額部分            
08574  |'                        .Cells(15 + i + (i - 1), ||08571  |'                        .Cells(15 + i + (i - 1), 
08575  |'                                                 ||08572  |'                                                 
08576  |'                        If gbuMGetUPDRec.N(lRecId||08573  |'                        If gbuMGetUPDRec.N(lRecId
08577  |'                            .Cells(15 + i + (i - ||08574  |'                            .Cells(15 + i + (i - 
08578  |'                              sWord28a & CStr(For||08575  |'                              sWord28a & CStr(For
08579  |'                        Else                     ||08576  |'                        Else                     
08580  |'                            .Cells(15 + i + (i - ||08577  |'                            .Cells(15 + i + (i - 
08581  |'                              sWord28a & CStr(For||08578  |'                              sWord28a & CStr(For
08582  |'                        End If                   ||08579  |'                        End If                   
08583  |'                                                 ||08580  |'                                                 
08584  |'                        '年率　累積値セット      ||08581  |'                        '年率　累積値セット      
08585  |'                        TotalRate = TotalRate + C||08582  |'                        TotalRate = TotalRate + C
08586  |'                        '後半の文言              ||08583  |'                        '後半の文言              
08587  |'                        .Cells(15 + i + i, 13).Nu||08584  |'                        .Cells(15 + i + i, 13).Nu
08588  |'                        Select Case gbuMGetUPDRec||08585  |'                        Select Case gbuMGetUPDRec
08589  |'                            Case cAud            ||08586  |'                            Case cAud            
08590  |'                                .Cells(15 + i + i||08587  |'                                .Cells(15 + i + i
08591  |'                                    sAuda & sWord||08588  |'                                    sAuda & sWord
08592  |'                                    Format(gbuOth||08589  |'                                    Format(gbuOth
08593  |'                            Case cCad            ||08590  |'                            Case cCad            
08594  |'                                .Cells(15 + i + i||08591  |'                                .Cells(15 + i + i
08595  |'                                    sCada & sWord||08592  |'                                    sCada & sWord
08596  |'                                    Format(gbuOth||08593  |'                                    Format(gbuOth
08597  |'                            Case cChf            ||08594  |'                            Case cChf            
08598  |'                                .Cells(15 + i + i||08595  |'                                .Cells(15 + i + i
08599  |'                                    sChfa & sWord||08596  |'                                    sChfa & sWord
08600  |'                                    Format(gbuOth||08597  |'                                    Format(gbuOth
08601  |'                            Case cEur            ||08598  |'                            Case cEur            
08602  |'                                .Cells(15 + i + i||08599  |'                                .Cells(15 + i + i
08603  |'                                    sEura & sWord||08600  |'                                    sEura & sWord
08604  |'                                    Format(gbuOth||08601  |'                                    Format(gbuOth
08605  |'                            Case cGbp            ||08602  |'                            Case cGbp            
08606  |'                                .Cells(15 + i + i||08603  |'                                .Cells(15 + i + i
08607  |'                                    sGbpa & sWord||08604  |'                                    sGbpa & sWord
08608  |'                                    Format(gbuOth||08605  |'                                    Format(gbuOth
08609  |'                            Case cHkd            ||08606  |'                            Case cHkd            
08610  |'                                .Cells(15 + i + i||08607  |'                                .Cells(15 + i + i
08611  |'                                    sHkda & sWord||08608  |'                                    sHkda & sWord
08612  |'                                    Format(gbuOth||08609  |'                                    Format(gbuOth
08613  |'                            Case cJpy            ||08610  |'                            Case cJpy            
08614  |'                                .Cells(15 + i + i||08611  |'                                .Cells(15 + i + i
08615  |'                                    sYena & sWord||08612  |'                                    sYena & sWord
08616  |'                                    Format(gbuOth||08613  |'                                    Format(gbuOth
08617  |'                            Case cMyr            ||08614  |'                            Case cMyr            
08618  |'                                .Cells(15 + i + i||08615  |'                                .Cells(15 + i + i
08619  |'                                    sMyra & sWord||08616  |'                                    sMyra & sWord
08620  |'                                    Format(gbuOth||08617  |'                                    Format(gbuOth
08621  |'                            Case cNzd            ||08618  |'                            Case cNzd            
08622  |'                                .Cells(15 + i + i||08619  |'                                .Cells(15 + i + i
08623  |'                                    sNzda & sWord||08620  |'                                    sNzda & sWord
08624  |'                                    Format(gbuOth||08621  |'                                    Format(gbuOth
08625  |'                            Case cSek            ||08622  |'                            Case cSek            
08626  |'                                .Cells(15 + i + i||08623  |'                                .Cells(15 + i + i
08627  |'                                    sSeka & sWord||08624  |'                                    sSeka & sWord
08628  |'                                    Format(gbuOth||08625  |'                                    Format(gbuOth
08629  |'                            Case cSgd            ||08626  |'                            Case cSgd            
08630  |'                                .Cells(15 + i + i||08627  |'                                .Cells(15 + i + i
08631  |'                                    sSgda & sWord||08628  |'                                    sSgda & sWord
08632  |'                                    Format(gbuOth||08629  |'                                    Format(gbuOth
08633  |'                            Case cUsd            ||08630  |'                            Case cUsd            
08634  |'                                .Cells(15 + i + i||08631  |'                                .Cells(15 + i + i
08635  |'                                    sUsda & sWord||08632  |'                                    sUsda & sWord
08636  |'                                    Format(gbuOth||08633  |'                                    Format(gbuOth
08637  |'                            Case cNok            ||08634  |'                            Case cNok            
08638  |'                                .Cells(15 + i + i||08635  |'                                .Cells(15 + i + i
08639  |'                                    sNoka & sWord||08636  |'                                    sNoka & sWord
08640  |'                                    Format(gbuOth||08637  |'                                    Format(gbuOth
08641  |'                        End Select               ||08638  |'                        End Select               
08642  |'                    End If                       ||08639  |'                    End If                       
08643  |'                Next i                           ||08640  |'                Next i                           
08644  |'            End If                               ||08641  |'            End If                               
08645  |'                                                 ||08642  |'                                                 
08646  |'        '投資顧問料                              ||08643  |'        '投資顧問料                              
08647  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).||08644  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).
08648  |'            Case Mid(mstrContractFlag(1), 1, 1)  ||08645  |'            Case Mid(mstrContractFlag(1), 1, 1)  
08649  |'                .Cells(46, 2).Value = sWord11d   ||08646  |'                .Cells(46, 2).Value = sWord11d   
08650  |'            Case Mid(mstrContractFlag(2), 1, 1)  ||08647  |'            Case Mid(mstrContractFlag(2), 1, 1)  
08651  |'                .Cells(46, 2).Value = sWord11e   ||08648  |'                .Cells(46, 2).Value = sWord11e   
08652  |'            Case Mid(mstrContractFlag(3), 1, 1)  ||08649  |'            Case Mid(mstrContractFlag(3), 1, 1)  
08653  |'                .Cells(46, 2).Value = sWord11f   ||08650  |'                .Cells(46, 2).Value = sWord11f   
08654  |'            Case Else                            ||08651  |'            Case Else                            
08655  |'                MsgBox "契約区分が不正です。", vb||08652  |'                MsgBox "契約区分が不正です。", vb
08656  |'        End Select                               ||08653  |'        End Select                               
08657  |'        .Cells(46, 11).Value = sWord19           ||08654  |'        .Cells(46, 11).Value = sWord19           
08658  |'                                                 ||08655  |'                                                 
08659  |'        '外部委託顧問料                          ||08656  |'        '外部委託顧問料                          
08660  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||08657  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
08661  |'            .Cells(46, 31).NumberFormatLocal = "@||08658  |'            .Cells(46, 31).NumberFormatLocal = "@
08662  |'        Else                                     ||08659  |'        Else                                     
08663  |'            .Cells(46, 29).NumberFormatLocal = "@||08660  |'            .Cells(46, 29).NumberFormatLocal = "@
08664  |'        End If                                   ||08661  |'        End If                                   
08665  |'                                                 ||08662  |'                                                 
08666  |'        '契約区分が名称使用許諾料の場合上限・下限||08663  |'        '契約区分が名称使用許諾料の場合上限・下限
08667  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||08664  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
08668  |'            '下限金額より換算した金額が小さい場合||08665  |'            '下限金額より換算した金額が小さい場合
08669  |'            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_||08666  |'            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_
08670  |'                If mstrMonthlyPayCom < CDbl(gbuMG||08667  |'                If mstrMonthlyPayCom < CDbl(gbuMG
08671  |'                    mstrMonthlyPayCom = CDbl(gbuM||08668  |'                    mstrMonthlyPayCom = CDbl(gbuM
08672  |'                End If                           ||08669  |'                End If                           
08673  |'            End If                               ||08670  |'            End If                               
08674  |'            '上限金額より換算した金額が大きい場合||08671  |'            '上限金額より換算した金額が大きい場合
08675  |'            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_||08672  |'            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_
08676  |'                If mstrMonthlyPayCom > CDbl(gbuMG||08673  |'                If mstrMonthlyPayCom > CDbl(gbuMG
08677  |'                    mstrMonthlyPayCom = CDbl(gbuM||08674  |'                    mstrMonthlyPayCom = CDbl(gbuM
08678  |'                End If                           ||08675  |'                End If                           
08679  |'            End If                               ||08676  |'            End If                               
08680  |'                                                 ||08677  |'                                                 
08681  |'            dblValueIn = CDbl(mstrMonthlyPayCom) ||08678  |'            dblValueIn = CDbl(mstrMonthlyPayCom) 
08682  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou||08679  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou
08683  |'                Call sbGetRoundValue2(dblValueIn)||08680  |'                Call sbGetRoundValue2(dblValueIn)
08684  |'            Else                                 ||08681  |'            Else                                 
08685  |'                Call sbGetRoundValue(dblValueIn) ||08682  |'                Call sbGetRoundValue(dblValueIn) 
08686  |'            End If                               ||08683  |'            End If                               
08687  |'            mstrMonthlyPayCom = dblValueOut      ||08684  |'            mstrMonthlyPayCom = dblValueOut      
08688  |'                                                 ||08685  |'                                                 
08689  |'        End If                                   ||08686  |'        End If                                   
08690  |'                                                 ||08687  |'                                                 
08691  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET||08688  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET
08692  |'            Case cAud                            ||08689  |'            Case cAud                            
08693  |'                .Cells(46, 31).Value = CStr(Forma||08690  |'                .Cells(46, 31).Value = CStr(Forma
08694  |'                .Cells(46, 32).Value = sAuda     ||08691  |'                .Cells(46, 32).Value = sAuda     
08695  |'            Case cCad                            ||08692  |'            Case cCad                            
08696  |'                .Cells(46, 31).Value = CStr(Forma||08693  |'                .Cells(46, 31).Value = CStr(Forma
08697  |'                .Cells(46, 32).Value = sCada     ||08694  |'                .Cells(46, 32).Value = sCada     
08698  |'            Case cChf                            ||08695  |'            Case cChf                            
08699  |'                .Cells(46, 31).Value = CStr(Forma||08696  |'                .Cells(46, 31).Value = CStr(Forma
08700  |'                .Cells(46, 32).Value = sChfa     ||08697  |'                .Cells(46, 32).Value = sChfa     
08701  |'            Case cEur                            ||08698  |'            Case cEur                            
08702  |'                .Cells(46, 31).Value = CStr(Forma||08699  |'                .Cells(46, 31).Value = CStr(Forma
08703  |'                .Cells(46, 32).Value = sEura     ||08700  |'                .Cells(46, 32).Value = sEura     
08704  |'            Case cGbp                            ||08701  |'            Case cGbp                            
08705  |'                .Cells(46, 31).Value = CStr(Forma||08702  |'                .Cells(46, 31).Value = CStr(Forma
08706  |'                .Cells(46, 32).Value = sGbpa     ||08703  |'                .Cells(46, 32).Value = sGbpa     
08707  |'            Case cHkd                            ||08704  |'            Case cHkd                            
08708  |'                .Cells(46, 31).Value = CStr(Forma||08705  |'                .Cells(46, 31).Value = CStr(Forma
08709  |'                .Cells(46, 32).Value = sHkda     ||08706  |'                .Cells(46, 32).Value = sHkda     
08710  |'            Case cJpy                            ||08707  |'            Case cJpy                            
08711  |'                .Cells(46, 29).Value = CStr(Forma||08708  |'                .Cells(46, 29).Value = CStr(Forma
08712  |'                .Cells(46, 32).Value = sYena     ||08709  |'                .Cells(46, 32).Value = sYena     
08713  |'            Case cMyr                            ||08710  |'            Case cMyr                            
08714  |'                .Cells(46, 31).Value = CStr(Forma||08711  |'                .Cells(46, 31).Value = CStr(Forma
08715  |'                .Cells(46, 32).Value = sMyra     ||08712  |'                .Cells(46, 32).Value = sMyra     
08716  |'            Case cNzd                            ||08713  |'            Case cNzd                            
08717  |'                .Cells(46, 31).Value = CStr(Forma||08714  |'                .Cells(46, 31).Value = CStr(Forma
08718  |'                .Cells(46, 32).Value = sNzda     ||08715  |'                .Cells(46, 32).Value = sNzda     
08719  |'            Case cSek                            ||08716  |'            Case cSek                            
08720  |'                .Cells(46, 31).Value = CStr(Forma||08717  |'                .Cells(46, 31).Value = CStr(Forma
08721  |'                .Cells(46, 32).Value = sSeka     ||08718  |'                .Cells(46, 32).Value = sSeka     
08722  |'            Case cSgd                            ||08719  |'            Case cSgd                            
08723  |'                .Cells(46, 31).Value = CStr(Forma||08720  |'                .Cells(46, 31).Value = CStr(Forma
08724  |'                .Cells(46, 32).Value = sSgda     ||08721  |'                .Cells(46, 32).Value = sSgda     
08725  |'            Case cUsd                            ||08722  |'            Case cUsd                            
08726  |'                .Cells(46, 31).Value = CStr(Forma||08723  |'                .Cells(46, 31).Value = CStr(Forma
08727  |'                .Cells(46, 32).Value = sUsda     ||08724  |'                .Cells(46, 32).Value = sUsda     
08728  |'            Case cNok                            ||08725  |'            Case cNok                            
08729  |'                .Cells(46, 31).Value = CStr(Forma||08726  |'                .Cells(46, 31).Value = CStr(Forma
08730  |'                .Cells(46, 32).Value = sNoka     ||08727  |'                .Cells(46, 32).Value = sNoka     
08731  |'        End Select                               ||08728  |'        End Select                               
08732  |'                                                 ||08729  |'                                                 
08733  |'        '顧問料                                  ||08730  |'        '顧問料                                  
08734  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||08731  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
08735  |'            .Cells(46, 31).HorizontalAlignment = ||08732  |'            .Cells(46, 31).HorizontalAlignment = 
08736  |'        Else                                     ||08733  |'        Else                                     
08737  |'            .Cells(46, 29).HorizontalAlignment = ||08734  |'            .Cells(46, 29).HorizontalAlignment = 
08738  |'        End If                                   ||08735  |'        End If                                   
08739  |'                                                 ||08736  |'                                                 
08740  |'        '契約区分が名称使用許諾料の場合上限・下限||08737  |'        '契約区分が名称使用許諾料の場合上限・下限
08741  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||08738  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
08742  |'            '上限金額                            ||08739  |'            '上限金額                            
08743  |'            .Cells(46, 45).Value = sWordCapa     ||08740  |'            .Cells(46, 45).Value = sWordCapa     
08744  |'            .Cells(46, 57).NumberFormatLocal = "@||08741  |'            .Cells(46, 57).NumberFormatLocal = "@
08745  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou||08742  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou
08746  |'                .Cells(46, 57).Value = Format(gbu||08743  |'                .Cells(46, 57).Value = Format(gbu
08747  |'            Else                                 ||08744  |'            Else                                 
08748  |'                .Cells(46, 57).Value = Format(gbu||08745  |'                .Cells(46, 57).Value = Format(gbu
08749  |'            End If                               ||08746  |'            End If                               
08750  |'                                                 ||08747  |'                                                 
08751  |'            .Cells(46, 57).HorizontalAlignment = ||08748  |'            .Cells(46, 57).HorizontalAlignment = 
08752  |'                                                 ||08749  |'                                                 
08753  |'            '下限金額                            ||08750  |'            '下限金額                            
08754  |'            .Cells(47, 45).Value = sWordFloora   ||08751  |'            .Cells(47, 45).Value = sWordFloora   
08755  |'            .Cells(47, 57).NumberFormatLocal = "@||08752  |'            .Cells(47, 57).NumberFormatLocal = "@
08756  |'                                                 ||08753  |'                                                 
08757  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou||08754  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou
08758  |'                .Cells(47, 57).Value = Format(gbu||08755  |'                .Cells(47, 57).Value = Format(gbu
08759  |'            Else                                 ||08756  |'            Else                                 
08760  |'                .Cells(47, 57).Value = Format(gbu||08757  |'                .Cells(47, 57).Value = Format(gbu
08761  |'            End If                               ||08758  |'            End If                               
08762  |'            .Cells(47, 57).HorizontalAlignment = ||08759  |'            .Cells(47, 57).HorizontalAlignment = 
08763  |'        End If                                   ||08760  |'        End If                                   
08764  |'                                                 ||08761  |'                                                 
08765  |'        ddblExchangeRate = 0                     ||08762  |'        ddblExchangeRate = 0                     
08766  |'                                                 ||08763  |'                                                 
08767  |'        dblValueIn = mstrMonthlyPayCom           ||08764  |'        dblValueIn = mstrMonthlyPayCom           
08768  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET||08765  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET
08769  |'          Case "1"    '固定料率                  ||08766  |'          Case "1"    '固定料率                  
08770  |'                                                 ||08767  |'                                                 
08771  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||08768  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
08772  |'                Else                             ||08769  |'                Else                             
08773  |'                  '外部委託顧問料通貨→JPYの為替 ||08770  |'                  '外部委託顧問料通貨→JPYの為替 
08774  |'                  dstrCurrencyCode = gbuMGetUPDRe||08771  |'                  dstrCurrencyCode = gbuMGetUPDRe
08775  |'                  ddblExchangeRate = fnstrExchang||08772  |'                  ddblExchangeRate = fnstrExchang
08776  |'                  If ddblExchangeRate = 0 Then   ||08773  |'                  If ddblExchangeRate = 0 Then   
08777  |'                    intRtn = MsgBox("ＴＴＭが取得||08774  |'                    intRtn = MsgBox("ＴＴＭが取得
08778  |'                    vbLf & "対象通貨コード ： [ "||08775  |'                    vbLf & "対象通貨コード ： [ "
08779  |'                    vbLf & "基準日 ： [ " & Mid(d||08776  |'                    vbLf & "基準日 ： [ " & Mid(d
08780  |'                        vbCritical, "ＴＴＭ取得エ||08777  |'                        vbCritical, "ＴＴＭ取得エ
08781  |'                    Exit Function                ||08778  |'                    Exit Function                
08782  |'                  End If                         ||08779  |'                  End If                         
08783  |'                  'JPY→支払通貨へレート換算     ||08780  |'                  'JPY→支払通貨へレート換算     
08784  |'                  dblValueIn = dblValueIn * ddblE||08781  |'                  dblValueIn = dblValueIn * ddblE
08785  |'                End If                           ||08782  |'                End If                           
08786  |'                                                 ||08783  |'                                                 
08787  |'          Case "2"    '段階料率                  ||08784  |'          Case "2"    '段階料率                  
08788  |'                                                 ||08785  |'                                                 
08789  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe||08786  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe
08790  |'            Else                                 ||08787  |'            Else                                 
08791  |'                '外部委託顧問料通貨→JPYの為替レ ||08788  |'                '外部委託顧問料通貨→JPYの為替レ 
08792  |'                dstrCurrencyCode = gbuMGetUPDRec.||08789  |'                dstrCurrencyCode = gbuMGetUPDRec.
08793  |'                ddblExchangeRate = fnstrExchangeR||08790  |'                ddblExchangeRate = fnstrExchangeR
08794  |'                If ddblExchangeRate = 0 Then     ||08791  |'                If ddblExchangeRate = 0 Then     
08795  |'                  intRtn = MsgBox("ＴＴＭが取得で||08792  |'                  intRtn = MsgBox("ＴＴＭが取得で
08796  |'                  vbLf & "対象通貨コード ： [ " &||08793  |'                  vbLf & "対象通貨コード ： [ " &
08797  |'                  vbLf & "基準日 ： [ " & Mid(dst||08794  |'                  vbLf & "基準日 ： [ " & Mid(dst
08798  |'                      vbCritical, "ＴＴＭ取得エラ||08795  |'                      vbCritical, "ＴＴＭ取得エラ
08799  |'                  Exit Function                  ||08796  |'                  Exit Function                  
08800  |'                End If                           ||08797  |'                End If                           
08801  |'                '外部委託顧問料通貨→JPYへレート ||08798  |'                '外部委託顧問料通貨→JPYへレート 
08802  |'                dblValueIn = dblValueIn * ddblExc||08799  |'                dblValueIn = dblValueIn * ddblExc
08803  |'            End If                               ||08800  |'            End If                               
08804  |'                                                 ||08801  |'                                                 
08805  |'        End Select                               ||08802  |'        End Select                               
08806  |'        '@@@@@ 支払に換算 @@@@@                  ||08803  |'        '@@@@@ 支払に換算 @@@@@                  
08807  |'        Call sbGetRoundValue(dblValueIn)         ||08804  |'        Call sbGetRoundValue(dblValueIn)         
08808  |'        mstrMonthlyPayCom = dblValueOut          ||08805  |'        mstrMonthlyPayCom = dblValueOut          
08809  |'                                                 ||08806  |'                                                 
08810  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe||08807  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe
08811  |'                'TTMレート                       ||08808  |'                'TTMレート                       
08812  |'                .Cells(47, 19).Value = sWord43   ||08809  |'                .Cells(47, 19).Value = sWord43   
08813  |'                .Cells(47, 33).NumberFormatLocal ||08810  |'                .Cells(47, 33).NumberFormatLocal 
08814  |'                .Cells(47, 33).Value = Format(ddb||08811  |'                .Cells(47, 33).Value = Format(ddb
08815  |'                .Cells(47, 33).HorizontalAlignmen||08812  |'                .Cells(47, 33).HorizontalAlignmen
08816  |'                .Cells(47, 34).Value = sWord44   ||08813  |'                .Cells(47, 34).Value = sWord44   
08817  |'            End If                               ||08814  |'            End If                               
08818  |'                                                 ||08815  |'                                                 
08819  |'            '支払額                              ||08816  |'            '支払額                              
08820  |'            .Cells(48, 2).Value = sWord46a       ||08817  |'            .Cells(48, 2).Value = sWord46a       
08821  |'            .Cells(48, 11).Value = sWord19       ||08818  |'            .Cells(48, 11).Value = sWord19       
08822  |'                                                 ||08819  |'                                                 
08823  |'            '税抜金額(月別支払顧問料の累計)      ||08820  |'            '税抜金額(月別支払顧問料の累計)      
08824  |'            .Cells(48, 29).NumberFormatLocal = "@||08821  |'            .Cells(48, 29).NumberFormatLocal = "@
08825  |'            .Cells(48, 29).Value = CStr(Format(ms||08822  |'            .Cells(48, 29).Value = CStr(Format(ms
08826  |'            .Cells(48, 29).HorizontalAlignment = ||08823  |'            .Cells(48, 29).HorizontalAlignment = 
08827  |'            .Cells(48, 32).Value = sYena         ||08824  |'            .Cells(48, 32).Value = sYena         
08828  |'                                                 ||08825  |'                                                 
08829  |'        '消費税計算有無：「有り」の場合のみ、消費||08826  |'        '消費税計算有無：「有り」の場合のみ、消費
08830  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc||08827  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc
08831  |'            '(消費税XX%)                         ||08828  |'            '(消費税XX%)                         
08832  |'            iSyouhizei = ddblconsumption_tax     ||08829  |'            iSyouhizei = ddblconsumption_tax     
08833  |'            .Cells(49, 32).Value = sWord22a & iSy||08830  |'            .Cells(49, 32).Value = sWord22a & iSy
08834  |'            dblValueIn = mstrMonthlyPayCom * iSyo||08831  |'            dblValueIn = mstrMonthlyPayCom * iSyo
08835  |'            Call sbGetRoundValueTax(dblValueIn)  ||08832  |'            Call sbGetRoundValueTax(dblValueIn)  
08836  |'            lTaxNum = dblValueOut                ||08833  |'            lTaxNum = dblValueOut                
08837  |'            .Cells(49, 29).NumberFormatLocal = "@||08834  |'            .Cells(49, 29).NumberFormatLocal = "@
08838  |'            .Cells(49, 29).Value = CStr(Format((l||08835  |'            .Cells(49, 29).Value = CStr(Format((l
08839  |'            .Cells(49, 29).HorizontalAlignment = ||08836  |'            .Cells(49, 29).HorizontalAlignment = 
08840  |'            '合計(消費税＋月別支払顧問料の累計)  ||08837  |'            '合計(消費税＋月別支払顧問料の累計)  
08841  |'            .Cells(50, 13).Value = sWord24a      ||08838  |'            .Cells(50, 13).Value = sWord24a      
08842  |'            dblValueIn = lTaxNum + CCur(mstrMonth||08839  |'            dblValueIn = lTaxNum + CCur(mstrMonth
08843  |'            Call sbGetRoundValue(dblValueIn)     ||08840  |'            Call sbGetRoundValue(dblValueIn)     
08844  |'            lMonthlyPayCom = dblValueOut         ||08841  |'            lMonthlyPayCom = dblValueOut         
08845  |'            .Cells(50, 29).NumberFormatLocal = "@||08842  |'            .Cells(50, 29).NumberFormatLocal = "@
08846  |'            .Cells(50, 29).Value = CStr(Format(lM||08843  |'            .Cells(50, 29).Value = CStr(Format(lM
08847  |'            .Cells(50, 29).HorizontalAlignment = ||08844  |'            .Cells(50, 29).HorizontalAlignment = 
08848  |'            '円                                  ||08845  |'            '円                                  
08849  |'            .Cells(50, 32).Value = sYena         ||08846  |'            .Cells(50, 32).Value = sYena         
08850  |'            '下線                                ||08847  |'            '下線                                
08851  |'            With xlSheet.Range("M49:AL49").Border||08848  |'            With xlSheet.Range("M49:AL49").Border
08852  |'                .LineStyle = xlContinuous        ||08849  |'                .LineStyle = xlContinuous        
08853  |'                .Weight = xlThin                 ||08850  |'                .Weight = xlThin                 
08854  |'            End With                             ||08851  |'            End With                             
08855  |'        Else                                     ||08852  |'        Else                                     
08856  |'        End If                                   ||08853  |'        End If                                   
08857  |'                                                 ||08854  |'                                                 
08858  |'        '支払予定日                              ||08855  |'        '支払予定日                              
08859  |'        .Cells(52, 2).Value = sWord13a           ||08856  |'        .Cells(52, 2).Value = sWord13a           
08860  |'        .Cells(52, 11).Value = sWord19           ||08857  |'        .Cells(52, 11).Value = sWord19           
08861  |'        .Cells(52, 13).NumberFormatLocal = "@"   ||08858  |'        .Cells(52, 13).NumberFormatLocal = "@"   
08862  |'        .Cells(52, 13).Value = CStr(Format(Trim(m||08859  |'        .Cells(52, 13).Value = CStr(Format(Trim(m
08863  |'                                                 ||08860  |'                                                 
08864  |'        '支払先                                  ||08861  |'        '支払先                                  
08865  |'        .Cells(54, 2).Value = sWord12a           ||08862  |'        .Cells(54, 2).Value = sWord12a           
08866  |'        .Cells(54, 11).Value = sWord19           ||08863  |'        .Cells(54, 11).Value = sWord19           
08867  |'        .Cells(54, 13).Value = gbuMGetUPDRec.N(lR||08864  |'        .Cells(54, 13).Value = gbuMGetUPDRec.N(lR
08868  |'                                                 ||08865  |'                                                 
08869  |'        '財務部                                  ||08866  |'        '財務部                                  
08870  |'        .Cells(60, 2).Value = sWord1a            ||08867  |'        .Cells(60, 2).Value = sWord1a            
08871  |'        .Cells(61, 2).Value = sWord2a            ||08868  |'        .Cells(61, 2).Value = sWord2a            
08872  |'                                                 ||08869  |'                                                 
08873  |'    End With                                     ||08870  |'    End With                                     
08874  |'                                                 ||08871  |'                                                 
08875  |'    '月末純資産(合計 上のライン)                 ||08872  |'    '月末純資産(合計 上のライン)                 
08876  |'    With xlSheet.Range("X39:AX40").Borders(xlInsi||08873  |'    With xlSheet.Range("X39:AX40").Borders(xlInsi
08877  |'        .LineStyle = xlContinuous                ||08874  |'        .LineStyle = xlContinuous                
08878  |'        .Weight = xlThin                         ||08875  |'        .Weight = xlThin                         
08879  |'    End With                                     ||08876  |'    End With                                     
08880  |'                                                 ||08877  |'                                                 
08881  |'    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract||08878  |'    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract
08882  |'    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_fla||08879  |'    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_fla
08883  |'                                                 ||08880  |'                                                 
08884  |'        xlSheet.Cells(13, 13).Value = _          ||08881  |'        xlSheet.Cells(13, 13).Value = _          
08885  |'            CStr(Format(dStart, "mmmm d , yyyy"))||08882  |'            CStr(Format(dStart, "mmmm d , yyyy"))
08886  |'    Else                                         ||08883  |'    Else                                         
08887  |'        xlSheet.Cells(13, 13).Value = _          ||08884  |'        xlSheet.Cells(13, 13).Value = _          
08888  |'            CStr(Format(dStart, "mmmm d , yyyy"))||08885  |'            CStr(Format(dStart, "mmmm d , yyyy"))
08889  |'    End If                                       ||08886  |'    End If                                       
08890  |'                                                 ||08887  |'                                                 
08891  |'    'A4印刷用に上2行を削除して、プレビュー範囲内 ||08888  |'    'A4印刷用に上2行を削除して、プレビュー範囲内 
08892  |'    xlSheet.Rows("1:2").Delete Shift:=xlUp       ||08889  |'    xlSheet.Rows("1:2").Delete Shift:=xlUp       
08893  |'                                                 ||08890  |'                                                 
08894  |''NAV取得区分：日次NAV平均(休日有)または日次NAV平 ||08891  |''NAV取得区分：日次NAV平均(休日有)または日次NAV平 
08895  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||08892  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
08896  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||08893  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
08897  |'                                                 ||08894  |'                                                 
08898  |'        J = 0                                    ||08895  |'        J = 0                                    
08899  |'        K = 0                                    ||08896  |'        K = 0                                    
08900  |'        '＋２は合計行と平均行                    ||08897  |'        '＋２は合計行と平均行                    
08901  |'        dintPage = (dlngCnt + 2) \ 108           ||08898  |'        dintPage = (dlngCnt + 2) \ 108           
08902  |'        dintAmari = (dlngCnt + 2) Mod 108        ||08899  |'        dintAmari = (dlngCnt + 2) Mod 108        
08903  |'        If dintAmari <> 0 Then                   ||08900  |'        If dintAmari <> 0 Then                   
08904  |'            dintPage = dintPage + 1              ||08901  |'            dintPage = dintPage + 1              
08905  |'        End If                                   ||08902  |'        End If                                   
08906  |'                                                 ||08903  |'                                                 
08907  |'        For L = 1 To dintPage                    ||08904  |'        For L = 1 To dintPage                    
08908  |'                                                 ||08905  |'                                                 
08909  |'            xlBook.Worksheets.Add after:=xlBook.S||08906  |'            xlBook.Worksheets.Add after:=xlBook.S
08910  |'            gProcessCnt = gProcessCnt + 1        ||08907  |'            gProcessCnt = gProcessCnt + 1        
08911  |'            Set xlSheet = xlBook.Sheets(gProcessC||08908  |'            Set xlSheet = xlBook.Sheets(gProcessC
08912  |'                                                 ||08909  |'                                                 
08913  |'            'Excelフォーマットを調整             ||08910  |'            'Excelフォーマットを調整             
08914  |'            xlSheet.Cells.ColumnWidth = 1        ||08911  |'            xlSheet.Cells.ColumnWidth = 1        
08915  |'            xlSheet.Cells.Font.Size = 11         ||08912  |'            xlSheet.Cells.Font.Size = 11         
08916  |'            'シート名を設定(日次NAV一覧**)       ||08913  |'            'シート名を設定(日次NAV一覧**)       
08917  |'                                                 ||08914  |'                                                 
08918  |'            If dstrOldAccCode = sGetAccCode Then ||08915  |'            If dstrOldAccCode = sGetAccCode Then 
08919  |'                gTotalDnavCnt = gTotalDnavCnt + 1||08916  |'                gTotalDnavCnt = gTotalDnavCnt + 1
08920  |'            Else                                 ||08917  |'            Else                                 
08921  |'                gTotalDnavCnt = 1                ||08918  |'                gTotalDnavCnt = 1                
08922  |'                dstrOldAccCode = sGetAccCode     ||08919  |'                dstrOldAccCode = sGetAccCode     
08923  |'            End If                               ||08920  |'            End If                               
08924  |'            gTotalCnt = gTotalCnt + 1            ||08921  |'            gTotalCnt = gTotalCnt + 1            
08925  |'            xlBook.Sheets(gProcessCnt).Name = sGe||08922  |'            xlBook.Sheets(gProcessCnt).Name = sGe
08926  |'                                                 ||08923  |'                                                 
08927  |'            'シートの余白を設定                  ||08924  |'            'シートの余白を設定                  
08928  |'            xlSheet.PageSetup.TopMargin = Applica||08925  |'            xlSheet.PageSetup.TopMargin = Applica
08929  |'            xlSheet.PageSetup.BottomMargin = Appl||08926  |'            xlSheet.PageSetup.BottomMargin = Appl
08930  |'            xlSheet.PageSetup.LeftMargin = Applic||08927  |'            xlSheet.PageSetup.LeftMargin = Applic
08931  |'            xlSheet.PageSetup.RightMargin = Appli||08928  |'            xlSheet.PageSetup.RightMargin = Appli
08932  |'                                                 ||08929  |'                                                 
08933  |'            DoEvents                             ||08930  |'            DoEvents                             
08934  |'                                                 ||08931  |'                                                 
08935  |'            With xlSheet                         ||08932  |'            With xlSheet                         
08936  |'                '題目                            ||08933  |'                '題目                            
08937  |'                .Cells(5, 1).Value = sWord47a    ||08934  |'                .Cells(5, 1).Value = sWord47a    
08938  |'                .Cells(5, 1).Font.Size = 14      ||08935  |'                .Cells(5, 1).Font.Size = 14      
08939  |'                .Range("A5:BG5").HorizontalAlignm||08936  |'                .Range("A5:BG5").HorizontalAlignm
08940  |'                '出力日付                        ||08937  |'                '出力日付                        
08941  |'                If RTrim(txtSysOutDate.Text) = ""||08938  |'                If RTrim(txtSysOutDate.Text) = ""
08942  |'                    .Cells(3, 50).NumberFormatLoc||08939  |'                    .Cells(3, 50).NumberFormatLoc
08943  |'                    .Cells(3, 50).Value = sWord34||08940  |'                    .Cells(3, 50).Value = sWord34
08944  |'                    .Cells(3, 50).HorizontalAlign||08941  |'                    .Cells(3, 50).HorizontalAlign
08945  |'                Else                             ||08942  |'                Else                             
08946  |'                    .Cells(3, 43).NumberFormatLoc||08943  |'                    .Cells(3, 43).NumberFormatLoc
08947  |'                    .Cells(3, 43).Value = CStr(Fo||08944  |'                    .Cells(3, 43).Value = CStr(Fo
08948  |'                End If                           ||08945  |'                End If                           
08949  |'                'ファンド名                      ||08946  |'                'ファンド名                      
08950  |'                .Cells(6, 2).Value = sWord4a     ||08947  |'                .Cells(6, 2).Value = sWord4a     
08951  |'                .Cells(6, 11).Value = sWord19    ||08948  |'                .Cells(6, 11).Value = sWord19    
08952  |'                .Cells(6, 13).Value = gbuMGetUPDR||08949  |'                .Cells(6, 13).Value = gbuMGetUPDR
08953  |'                'ファンドコード                  ||08950  |'                'ファンドコード                  
08954  |'                .Cells(7, 2).Value = sWord4_2a   ||08951  |'                .Cells(7, 2).Value = sWord4_2a   
08955  |'                .Cells(7, 11).Value = sWord19    ||08952  |'                .Cells(7, 11).Value = sWord19    
08956  |'                .Cells(7, 13).NumberFormatLocal =||08953  |'                .Cells(7, 13).NumberFormatLocal =
08957  |'                .Cells(7, 13).Value = sGetAccCode||08954  |'                .Cells(7, 13).Value = sGetAccCode
08958  |'                '計算期間                        ||08955  |'                '計算期間                        
08959  |'                .Cells(8, 2).Value = sWord5a     ||08956  |'                .Cells(8, 2).Value = sWord5a     
08960  |'                .Cells(8, 11).Value = sWord19    ||08957  |'                .Cells(8, 11).Value = sWord19    
08961  |'                                                 ||08958  |'                                                 
08962  |'                If Mid(gbuMGetUPDRec.N(lRecIdx).M||08959  |'                If Mid(gbuMGetUPDRec.N(lRecIdx).M
08963  |'                And gbuMGetUPDRec.N(lRecIdx).MGET||08960  |'                And gbuMGetUPDRec.N(lRecIdx).MGET
08964  |'                    .Cells(8, 13).Value = _      ||08961  |'                    .Cells(8, 13).Value = _      
08965  |'                        CStr(Format(dStart, "mmmm||08962  |'                        CStr(Format(dStart, "mmmm
08966  |'                Else                             ||08963  |'                Else                             
08967  |'                    .Cells(8, 13).Value = _      ||08964  |'                    .Cells(8, 13).Value = _      
08968  |'                        CStr(Format(dStart, "mmmm||08965  |'                        CStr(Format(dStart, "mmmm
08969  |'                End If                           ||08966  |'                End If                           
08970  |'                                                 ||08967  |'                                                 
08971  |'                '日付                            ||08968  |'                '日付                            
08972  |'                .Cells(10, 3).Value = sWord7a    ||08969  |'                .Cells(10, 3).Value = sWord7a    
08973  |'                .Range("C10:N10").HorizontalAlign||08970  |'                .Range("C10:N10").HorizontalAlign
08974  |'                '純資産                          ||08971  |'                '純資産                          
08975  |'                .Cells(10, 15).Value = sWord8a   ||08972  |'                .Cells(10, 15).Value = sWord8a   
08976  |'                .Range("O10:AC10").HorizontalAlig||08973  |'                .Range("O10:AC10").HorizontalAlig
08977  |'                '日付                            ||08974  |'                '日付                            
08978  |'                .Cells(10, 31).Value = sWord7a   ||08975  |'                .Cells(10, 31).Value = sWord7a   
08979  |'                .Range("AE10:AP10").HorizontalAli||08976  |'                .Range("AE10:AP10").HorizontalAli
08980  |'                '純資産                          ||08977  |'                '純資産                          
08981  |'                .Cells(10, 43).Value = sWord8a   ||08978  |'                .Cells(10, 43).Value = sWord8a   
08982  |'                .Range("AQ10:BE10").HorizontalAli||08979  |'                .Range("AQ10:BE10").HorizontalAli
08983  |'                '日付＆NAV                       ||08980  |'                '日付＆NAV                       
08984  |'                Select Case L                    ||08981  |'                Select Case L                    
08985  |'                    Case 1                       ||08982  |'                    Case 1                       
08986  |'                        dintPageIni = 1          ||08983  |'                        dintPageIni = 1          
08987  |'                    Case Else                    ||08984  |'                    Case Else                    
08988  |'                        dintPageIni = dintPageIni||08985  |'                        dintPageIni = dintPageIni
08989  |'                End Select                       ||08986  |'                End Select                       
08990  |'                For dintFor = dintPageIni To dlng||08987  |'                For dintFor = dintPageIni To dlng
08991  |'                    If J < 54 Then               ||08988  |'                    If J < 54 Then               
08992  |'                        If dintFor = dlngCnt + 1 ||08989  |'                        If dintFor = dlngCnt + 1 
08993  |'                            '合計                ||08990  |'                            '合計                
08994  |'                            .Cells(11 + J, 3).Val||08991  |'                            .Cells(11 + J, 3).Val
08995  |'                            'NAV                 ||08992  |'                            'NAV                 
08996  |'                            .Cells(11 + J, 28).Nu||08993  |'                            .Cells(11 + J, 28).Nu
08997  |'                            If gbuMGetUPDRec.N(lR||08994  |'                            If gbuMGetUPDRec.N(lR
08998  |'                                .Cells(11 + J, 28||08995  |'                                .Cells(11 + J, 28
08999  |'                            Else                 ||08996  |'                            Else                 
09000  |'                                .Cells(11 + J, 28||08997  |'                                .Cells(11 + J, 28
09001  |'                            End If               ||08998  |'                            End If               
09002  |'                            .Cells(11 + J, 28).Ho||08999  |'                            .Cells(11 + J, 28).Ho
09003  |'                        End If                   ||09000  |'                        End If                   
09004  |'                                                 ||09001  |'                                                 
09005  |'                            If dintFor = dlngCnt ||09002  |'                            If dintFor = dlngCnt 
09006  |'                                '平均            ||09003  |'                                '平均            
09007  |'                                .Cells(11 + J, 3)||09004  |'                                .Cells(11 + J, 3)
09008  |'                                'NAV             ||09005  |'                                'NAV             
09009  |'                                .Cells(11 + J, 28||09006  |'                                .Cells(11 + J, 28
09010  |'                                If gbuMGetUPDRec.||09007  |'                                If gbuMGetUPDRec.
09011  |'                                    .Cells(11 + J||09008  |'                                    .Cells(11 + J
09012  |'                                Else             ||09009  |'                                Else             
09013  |'                                    .Cells(11 + J||09010  |'                                    .Cells(11 + J
09014  |'                                End If           ||09011  |'                                End If           
09015  |'                                .Cells(11 + J, 28||09012  |'                                .Cells(11 + J, 28
09016  |'                            End If               ||09013  |'                            End If               
09017  |'                                                 ||09014  |'                                                 
09018  |'                        If dintFor < dlngCnt + 1 ||09015  |'                        If dintFor < dlngCnt + 1 
09019  |'                            '日付                ||09016  |'                            '日付                
09020  |'                            .Cells(11 + J, 4).Num||09017  |'                            .Cells(11 + J, 4).Num
09021  |'                            .Cells(11 + J, 4).Val||09018  |'                            .Cells(11 + J, 4).Val
09022  |'                                        CDate(gst||09019  |'                                        CDate(gst
09023  |'                            'NAV                 ||09020  |'                            'NAV                 
09024  |'                            .Cells(11 + J, 28).Nu||09021  |'                            .Cells(11 + J, 28).Nu
09025  |'                            If gbuMGetUPDRec.N(lR||09022  |'                            If gbuMGetUPDRec.N(lR
09026  |'                                .Cells(11 + J, 28||09023  |'                                .Cells(11 + J, 28
09027  |'                            Else                 ||09024  |'                            Else                 
09028  |'                                .Cells(11 + J, 28||09025  |'                                .Cells(11 + J, 28
09029  |'                            End If               ||09026  |'                            End If               
09030  |'                            .Cells(11 + J, 28).Ho||09027  |'                            .Cells(11 + J, 28).Ho
09031  |'                        End If                   ||09028  |'                        End If                   
09032  |'                    Else                         ||09029  |'                    Else                         
09033  |'                        If dintFor = dlngCnt + 1 ||09030  |'                        If dintFor = dlngCnt + 1 
09034  |'                            '合計                ||09031  |'                            '合計                
09035  |'                            .Cells(11 + K, 31).Va||09032  |'                            .Cells(11 + K, 31).Va
09036  |'                            'NAV                 ||09033  |'                            'NAV                 
09037  |'                            .Cells(11 + K, 56).Nu||09034  |'                            .Cells(11 + K, 56).Nu
09038  |'                            If gbuMGetUPDRec.N(lR||09035  |'                            If gbuMGetUPDRec.N(lR
09039  |'                                .Cells(11 + K, 56||09036  |'                                .Cells(11 + K, 56
09040  |'                            Else                 ||09037  |'                            Else                 
09041  |'                                .Cells(11 + K, 56||09038  |'                                .Cells(11 + K, 56
09042  |'                            End If               ||09039  |'                            End If               
09043  |'                            .Cells(11 + K, 56).Ho||09040  |'                            .Cells(11 + K, 56).Ho
09044  |'                        End If                   ||09041  |'                        End If                   
09045  |'                                                 ||09042  |'                                                 
09046  |'                            If dintFor = dlngCnt ||09043  |'                            If dintFor = dlngCnt 
09047  |'                                '平均            ||09044  |'                                '平均            
09048  |'                                .Cells(11 + K, 31||09045  |'                                .Cells(11 + K, 31
09049  |'                                'NAV             ||09046  |'                                'NAV             
09050  |'                                .Cells(11 + K, 56||09047  |'                                .Cells(11 + K, 56
09051  |'                                If gbuMGetUPDRec.||09048  |'                                If gbuMGetUPDRec.
09052  |'                                    .Cells(11 + K||09049  |'                                    .Cells(11 + K
09053  |'                                Else             ||09050  |'                                Else             
09054  |'                                    .Cells(11 + K||09051  |'                                    .Cells(11 + K
09055  |'                                End If           ||09052  |'                                End If           
09056  |'                                .Cells(11 + K, 56||09053  |'                                .Cells(11 + K, 56
09057  |'                            End If               ||09054  |'                            End If               
09058  |'                                                 ||09055  |'                                                 
09059  |'                        If dintFor < dlngCnt + 1 ||09056  |'                        If dintFor < dlngCnt + 1 
09060  |'                            '日付                ||09057  |'                            '日付                
09061  |'                                                 ||09058  |'                                                 
09062  |'                            .Cells(11 + K, 32).Nu||09059  |'                            .Cells(11 + K, 32).Nu
09063  |'                            .Cells(11 + K, 32).Va||09060  |'                            .Cells(11 + K, 32).Va
09064  |'                                        CDate(gst||09061  |'                                        CDate(gst
09065  |'                            'NAV                 ||09062  |'                            'NAV                 
09066  |'                            .Cells(11 + K, 56).Nu||09063  |'                            .Cells(11 + K, 56).Nu
09067  |'                            If gbuMGetUPDRec.N(lR||09064  |'                            If gbuMGetUPDRec.N(lR
09068  |'                                .Cells(11 + K, 56||09065  |'                                .Cells(11 + K, 56
09069  |'                            Else                 ||09066  |'                            Else                 
09070  |'                                .Cells(11 + K, 56||09067  |'                                .Cells(11 + K, 56
09071  |'                            End If               ||09068  |'                            End If               
09072  |'                            .Cells(11 + K, 56).Ho||09069  |'                            .Cells(11 + K, 56).Ho
09073  |'                        End If                   ||09070  |'                        End If                   
09074  |'                        K = K + 1                ||09071  |'                        K = K + 1                
09075  |'                        If K > 53 Then           ||09072  |'                        If K > 53 Then           
09076  |'                            J = 0                ||09073  |'                            J = 0                
09077  |'                            K = 0                ||09074  |'                            K = 0                
09078  |'                            Exit For             ||09075  |'                            Exit For             
09079  |'                        End If                   ||09076  |'                        End If                   
09080  |'                    End If                       ||09077  |'                    End If                       
09081  |'                    J = J + 1                    ||09078  |'                    J = J + 1                    
09082  |'                Next dintFor                     ||09079  |'                Next dintFor                     
09083  |'                                                 ||09080  |'                                                 
09084  |'                '左側日付                        ||09081  |'                '左側日付                        
09085  |''                With xlSheet.Range("C10:N64").Bo||09082  |''                With xlSheet.Range("C10:N64").Bo
09086  |''                    .LineStyle = xlContinuous   ||09083  |''                    .LineStyle = xlContinuous   
09087  |''                    .Weight = xlThin            ||09084  |''                    .Weight = xlThin            
09088  |''                End With                        ||09085  |''                End With                        
09089  |''                With xlSheet.Range("C10:N64").Bo||09086  |''                With xlSheet.Range("C10:N64").Bo
09090  |''                    .LineStyle = xlContinuous   ||09087  |''                    .LineStyle = xlContinuous   
09091  |''                    .Weight = xlThin            ||09088  |''                    .Weight = xlThin            
09092  |''                End With                        ||09089  |''                End With                        
09093  |''                With xlSheet.Range("C10:N64").Bo||09090  |''                With xlSheet.Range("C10:N64").Bo
09094  |''                    .LineStyle = xlContinuous   ||09091  |''                    .LineStyle = xlContinuous   
09095  |''                    .Weight = xlThin            ||09092  |''                    .Weight = xlThin            
09096  |''                End With                        ||09093  |''                End With                        
09097  |''                With xlSheet.Range("C10:N64").Bo||09094  |''                With xlSheet.Range("C10:N64").Bo
09098  |''                    .LineStyle = xlContinuous   ||09095  |''                    .LineStyle = xlContinuous   
09099  |''                    .Weight = xlThin            ||09096  |''                    .Weight = xlThin            
09100  |''                End With                        ||09097  |''                End With                        
09101  |''                With xlSheet.Range("C10:N64").Bo||09098  |''                With xlSheet.Range("C10:N64").Bo
09102  |''                    .LineStyle = xlContinuous   ||09099  |''                    .LineStyle = xlContinuous   
09103  |''                    .Weight = xlThin            ||09100  |''                    .Weight = xlThin            
09104  |''                End With                        ||09101  |''                End With                        
09105  |''                                                ||09102  |''                                                
09106  |''                '左側純資産                     ||09103  |''                '左側純資産                     
09107  |''                With xlSheet.Range("O10:AC64").B||09104  |''                With xlSheet.Range("O10:AC64").B
09108  |''                    .LineStyle = xlContinuous   ||09105  |''                    .LineStyle = xlContinuous   
09109  |''                    .Weight = xlThin            ||09106  |''                    .Weight = xlThin            
09110  |''                End With                        ||09107  |''                End With                        
09111  |''                With xlSheet.Range("O10:AC64").B||09108  |''                With xlSheet.Range("O10:AC64").B
09112  |''                    .LineStyle = xlContinuous   ||09109  |''                    .LineStyle = xlContinuous   
09113  |''                    .Weight = xlThin            ||09110  |''                    .Weight = xlThin            
09114  |''                End With                        ||09111  |''                End With                        
09115  |''                With xlSheet.Range("O10:AC64").B||09112  |''                With xlSheet.Range("O10:AC64").B
09116  |''                    .LineStyle = xlContinuous   ||09113  |''                    .LineStyle = xlContinuous   
09117  |''                    .Weight = xlThin            ||09114  |''                    .Weight = xlThin            
09118  |''                End With                        ||09115  |''                End With                        
09119  |''                With xlSheet.Range("O10:AC64").B||09116  |''                With xlSheet.Range("O10:AC64").B
09120  |''                    .LineStyle = xlContinuous   ||09117  |''                    .LineStyle = xlContinuous   
09121  |''                    .Weight = xlThin            ||09118  |''                    .Weight = xlThin            
09122  |''                End With                        ||09119  |''                End With                        
09123  |''                With xlSheet.Range("O10:AC64").B||09120  |''                With xlSheet.Range("O10:AC64").B
09124  |''                    .LineStyle = xlContinuous   ||09121  |''                    .LineStyle = xlContinuous   
09125  |''                    .Weight = xlThin            ||09122  |''                    .Weight = xlThin            
09126  |''                End With                        ||09123  |''                End With                        
09127  |''                                                ||09124  |''                                                
09128  |''                '右側日付                       ||09125  |''                '右側日付                       
09129  |''                With xlSheet.Range("AE10:AP64").||09126  |''                With xlSheet.Range("AE10:AP64").
09130  |''                    .LineStyle = xlContinuous   ||09127  |''                    .LineStyle = xlContinuous   
09131  |''                    .Weight = xlThin            ||09128  |''                    .Weight = xlThin            
09132  |''                End With                        ||09129  |''                End With                        
09133  |''                With xlSheet.Range("AE10:AP64").||09130  |''                With xlSheet.Range("AE10:AP64").
09134  |''                    .LineStyle = xlContinuous   ||09131  |''                    .LineStyle = xlContinuous   
09135  |''                    .Weight = xlThin            ||09132  |''                    .Weight = xlThin            
09136  |''                End With                        ||09133  |''                End With                        
09137  |''                With xlSheet.Range("AE10:AP64").||09134  |''                With xlSheet.Range("AE10:AP64").
09138  |''                    .LineStyle = xlContinuous   ||09135  |''                    .LineStyle = xlContinuous   
09139  |''                    .Weight = xlThin            ||09136  |''                    .Weight = xlThin            
09140  |''                End With                        ||09137  |''                End With                        
09141  |''                With xlSheet.Range("AE10:AP64").||09138  |''                With xlSheet.Range("AE10:AP64").
09142  |''                    .LineStyle = xlContinuous   ||09139  |''                    .LineStyle = xlContinuous   
09143  |''                    .Weight = xlThin            ||09140  |''                    .Weight = xlThin            
09144  |''                End With                        ||09141  |''                End With                        
09145  |''                With xlSheet.Range("AE10:AP64").||09142  |''                With xlSheet.Range("AE10:AP64").
09146  |''                    .LineStyle = xlContinuous   ||09143  |''                    .LineStyle = xlContinuous   
09147  |''                    .Weight = xlThin            ||09144  |''                    .Weight = xlThin            
09148  |''                End With                        ||09145  |''                End With                        
09149  |''                                                ||09146  |''                                                
09150  |''                '右側純資産                     ||09147  |''                '右側純資産                     
09151  |''                With xlSheet.Range("AQ10:BE64").||09148  |''                With xlSheet.Range("AQ10:BE64").
09152  |''                    .LineStyle = xlContinuous   ||09149  |''                    .LineStyle = xlContinuous   
09153  |''                    .Weight = xlThin            ||09150  |''                    .Weight = xlThin            
09154  |''                End With                        ||09151  |''                End With                        
09155  |''                With xlSheet.Range("AQ10:BE64").||09152  |''                With xlSheet.Range("AQ10:BE64").
09156  |''                    .LineStyle = xlContinuous   ||09153  |''                    .LineStyle = xlContinuous   
09157  |''                    .Weight = xlThin            ||09154  |''                    .Weight = xlThin            
09158  |''                End With                        ||09155  |''                End With                        
09159  |''                With xlSheet.Range("AQ10:BE64").||09156  |''                With xlSheet.Range("AQ10:BE64").
09160  |''                    .LineStyle = xlContinuous   ||09157  |''                    .LineStyle = xlContinuous   
09161  |''                    .Weight = xlThin            ||09158  |''                    .Weight = xlThin            
09162  |''                End With                        ||09159  |''                End With                        
09163  |''                With xlSheet.Range("AQ10:BE64").||09160  |''                With xlSheet.Range("AQ10:BE64").
09164  |''                    .LineStyle = xlContinuous   ||09161  |''                    .LineStyle = xlContinuous   
09165  |''                    .Weight = xlThin            ||09162  |''                    .Weight = xlThin            
09166  |''                End With                        ||09163  |''                End With                        
09167  |''                With xlSheet.Range("AQ10:BE64").||09164  |''                With xlSheet.Range("AQ10:BE64").
09168  |''                    .LineStyle = xlContinuous   ||09165  |''                    .LineStyle = xlContinuous   
09169  |''                    .Weight = xlThin            ||09166  |''                    .Weight = xlThin            
09170  |''                End With                        ||09167  |''                End With                        
09171  |'                                                 ||09168  |'                                                 
09172  |'            End With                             ||09169  |'            End With                             
09173  |'            'A4印刷用に上2行を削除して、プレビュ ||09170  |'            'A4印刷用に上2行を削除して、プレビュ 
09174  |'            xlSheet.Rows("1:2").Delete Shift:=xlU||09171  |'            xlSheet.Rows("1:2").Delete Shift:=xlU
09175  |'        Next L                                   ||09172  |'        Next L                                   
09176  |'    End If                                       ||09173  |'    End If                                       
09177  |'                                                 ||09174  |'                                                 
09178  |'    '正常戻り値セット                            ||09175  |'    '正常戻り値セット                            
09179  |'    fnblExcelEnglishOut = True                   ||09176  |'    fnblExcelEnglishOut = True                   
09180  |'    GoTo EndProc                                 ||09177  |'    GoTo EndProc                                 
09181  |'                                                 ||09178  |'                                                 
09182  |'ErrorTrap:                                       ||09179  |'ErrorTrap:                                       
09183  |'    ' Excel を起動できない場合に発生するエラーを ||09180  |'    ' Excel を起動できない場合に発生するエラーを 
09184  |'    Select Case Err.Number                       ||09181  |'    Select Case Err.Number                       
09185  |'        Case 440               ' オートメーション||09182  |'        Case 440               ' オートメーション
09186  |'            iTries = iTries + 1                  ||09183  |'            iTries = iTries + 1                  
09187  |'            ' Excel の再起動を 5 回まで行います。||09184  |'            ' Excel の再起動を 5 回まで行います。
09188  |'            If iTries < 5 Then                   ||09185  |'            If iTries < 5 Then                   
09189  |'               Set xlApp = New Excel.Application ||09186  |'               Set xlApp = New Excel.Application 
09190  |'               Resume                            ||09187  |'               Resume                            
09191  |'            Else                                 ||09188  |'            Else                                 
09192  |'               Err.Raise Number:=vbObjectError + ||09189  |'               Err.Raise Number:=vbObjectError + 
09193  |'               Description:="Microsoft Excel を起||09190  |'               Description:="Microsoft Excel を起
09194  |'            End If                               ||09191  |'            End If                               
09195  |'        Case Else                                ||09192  |'        Case Else                                
09196  |'    End Select                                   ||09193  |'    End Select                                   
09197  |'                                                 ||09194  |'                                                 
09198  |'    'Workbookを閉じる                            ||09195  |'    'Workbookを閉じる                            
09199  |'    xlBook.Close                                 ||09196  |'    xlBook.Close                                 
09200  |'                                                 ||09197  |'                                                 
09201  |'    'Excel終了                                   ||09198  |'    'Excel終了                                   
09202  |'    xlApp.Quit                                   ||09199  |'    xlApp.Quit                                   
09203  |'                                                 ||09200  |'                                                 
09204  |'    'オブジェクトの解放                          ||09201  |'    'オブジェクトの解放                          
09205  |'    Set xlApp = Nothing                          ||09202  |'    Set xlApp = Nothing                          
09206  |'    Set xlBook = Nothing                         ||09203  |'    Set xlBook = Nothing                         
09207  |'    Set xlSheet = Nothing                        ||09204  |'    Set xlSheet = Nothing                        
09208  |'                                                 ||09205  |'                                                 
09209  |'OnErrorProc:                                     ||09206  |'OnErrorProc:                                     
09210  |'    Call subError("システムエラー", Str(Err.Numbe||09207  |'    Call subError("システムエラー", Str(Err.Numbe
09211  |'        Error, strErrCall, conTitle)             ||09208  |'        Error, strErrCall, conTitle)             
09212  |'    'マウスポインター元に戻す                    ||09209  |'    'マウスポインター元に戻す                    
09213  |'    Screen.MousePointer = vbDefault              ||09210  |'    Screen.MousePointer = vbDefault              
09214  |'    GoTo EndProc                                 ||09211  |'    GoTo EndProc                                 
09215  |'                                                 ||09212  |'                                                 
09216  |'EndProc:                                         ||09213  |'EndProc:                                         
09217  |                                                  ||09214  |                                                  
09218  |End Function                                      ||09215  |End Function                                      
09219  |                                                  ||09216  |                                                  
09220  |'=================================================||09217  |'=================================================
09221  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbFileNameChange             ||09218  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbFileNameChange             
09222  |'機能            :   保存するファイル名部分を抽出 ||09219  |'機能            :   保存するファイル名部分を抽出 
09223  |'                                                 ||09220  |'                                                 
09224  |'日付               担当　              修正内容  ||09221  |'日付               担当　              修正内容  
09225  |'-------------------------------------------------||09222  |'-------------------------------------------------
09226  |'2004/08/11         M.Katoh<SRA>       新規作成   ||09223  |'2004/08/11         M.Katoh<SRA>       新規作成   
09227  |'=================================================||09224  |'=================================================
09228  |Private Sub sbFileNameChange()                    ||09225  |Private Sub sbFileNameChange()                    
09229  |                                                  ||09226  |                                                  
09230  |    Dim NumLen As Integer                         ||09227  |    Dim NumLen As Integer                         
09231  |    Dim FName As String                           ||09228  |    Dim FName As String                           
09232  |                                                  ||09229  |                                                  
09233  |    'ファイル名格納変数の「.xls」前部分を取り出す ||09230  |    'ファイル名格納変数の「.xls」前部分を取り出す 
09234  |    NumLen = InStr(mstrFileNameBK, ".xls")        ||09231  |    NumLen = InStr(mstrFileNameBK, ".xls")        
09235  |    mstrFileNameBK = Left(mstrFileNameBK, NumLen -||09232  |    mstrFileNameBK = Left(mstrFileNameBK, NumLen -
09236  |                                                  ||09233  |                                                  
09237  |End Sub                                           ||09234  |End Sub                                           
09238  |                                                  ||09235  |                                                  
09239  |'=================================================||09236  |'=================================================
09240  |'処理内容  システムエラー処理                     ||09237  |'処理内容  システムエラー処理                     
09241  |'備考                                             ||09238  |'備考                                             
09242  |'概要       ：msgbox(システムエラー／DBエラー)表示||09239  |'概要       ：msgbox(システムエラー／DBエラー)表示
09243  |'ﾌﾟﾛｼｼﾞｬ-名 ：subError                            ||09240  |'ﾌﾟﾛｼｼﾞｬ-名 ：subError                            
09244  |'ｲﾝﾀ-ﾌｪ-ｽ   ：call subError(ErrMsg As String, ErrN||09241  |'ｲﾝﾀ-ﾌｪ-ｽ   ：call subError(ErrMsg As String, ErrN
09245  |'ﾊﾟﾗﾒ-ﾀ     ：(IN)ErrMsg   :エラーメッセージ      ||09242  |'ﾊﾟﾗﾒ-ﾀ     ：(IN)ErrMsg   :エラーメッセージ      
09246  |'           ：(IN)ErrNumber:"str(Err.Number)":On E||09243  |'           ：(IN)ErrNumber:"str(Err.Number)":On E
09247  |'           ：             :その他:str(制御系／共 ||09244  |'           ：             :その他:str(制御系／共 
09248  |'           ：(IN)ErrSource:Err.Source:On Error Go||09245  |'           ：(IN)ErrSource:Err.Source:On Error Go
09249  |'           ：             :その他:エラー発生元の ||09246  |'           ：             :その他:エラー発生元の 
09250  |'           ：(IN)ErrDescription:"Err.Description"||09247  |'           ：(IN)ErrDescription:"Err.Description"
09251  |'           ：             :その他:エラーメッセー ||09248  |'           ：             :その他:エラーメッセー 
09252  |'           ：(IN)ErrCall:エラー呼出元            ||09249  |'           ：(IN)ErrCall:エラー呼出元            
09253  |'           ：(IN)ErrTitle:メッセージBOXに出すタイ||09250  |'           ：(IN)ErrTitle:メッセージBOXに出すタイ
09254  |'                                                 ||09251  |'                                                 
09255  |'日付         担当               内容             ||09252  |'日付         担当               内容             
09256  |'------------ ----------------- ------------------||09253  |'------------ ----------------- ------------------
09257  |'2004/03/03   H.Yonehara <SRA>  新規作成          ||09254  |'2004/03/03   H.Yonehara <SRA>  新規作成          
09258  |'=================================================||09255  |'=================================================
09259  |Private Sub subError(ErrMsg As String, ErrNumber A||09256  |Private Sub subError(ErrMsg As String, ErrNumber A
09260  |    On Error GoTo OnErrorProc                     ||09257  |    On Error GoTo OnErrorProc                     
09261  |                                                  ||09258  |                                                  
09262  |    Const conMeModule As String = "subError" '当モ||09259  |    Const conMeModule As String = "subError" '当モ
09263  |    Dim strErrCall As String        'エラー呼出元 ||09260  |    Dim strErrCall As String        'エラー呼出元 
09264  |    Dim intRtn As Integer           '関数戻り値(in||09261  |    Dim intRtn As Integer           '関数戻り値(in
09265  |                                                  ||09262  |                                                  
09266  |    'エラー呼出元設定                             ||09263  |    'エラー呼出元設定                             
09267  |    strErrCall = conMeForm & ":" & conMeModule    ||09264  |    strErrCall = conMeForm & ":" & conMeModule    
09268  |                                                  ||09265  |                                                  
09269  |    mblnFinishStatus = False    ' 異常終了        ||09266  |    mblnFinishStatus = False    ' 異常終了        
09270  |                                                  ||09267  |                                                  
09271  |    intRtn = MsgBox(ErrMsg & vbCrLf & "[ErrNumber=||09268  |    intRtn = MsgBox(ErrMsg & vbCrLf & "[ErrNumber=
09272  |            ErrNumber & "]" & vbCrLf & "[ErrSource||09269  |            ErrNumber & "]" & vbCrLf & "[ErrSource
09273  |            ErrSource & "]" & vbCrLf & "[ErrCall="||09270  |            ErrSource & "]" & vbCrLf & "[ErrCall="
09274  |            ErrCall & "]" & vbCrLf & "[ErrDescript||09271  |            ErrCall & "]" & vbCrLf & "[ErrDescript
09275  |            ErrDescription & "]", _               ||09272  |            ErrDescription & "]", _               
09276  |            (vbOKOnly + vbCritical), ErrTitle)    ||09273  |            (vbOKOnly + vbCritical), ErrTitle)    
09277  |    If (mblnFlgUnload = True) Then                ||09274  |    If (mblnFlgUnload = True) Then                
09278  |        Unload Me                                 ||09275  |        Unload Me                                 
09279  |    End If                                        ||09276  |    End If                                        
09280  |                                                  ||09277  |                                                  
09281  |    GoTo EndProc                                  ||09278  |    GoTo EndProc                                  
09282  |                                                  ||09279  |                                                  
09283  |OnErrorProc:                                      ||09280  |OnErrorProc:                                      
09284  |    intRtn = MsgBox("システムエラー" & vbCrLf & "[||09281  |    intRtn = MsgBox("システムエラー" & vbCrLf & "[
09285  |                Str(Err.Number) & "]" & vbCrLf & "||09282  |                Str(Err.Number) & "]" & vbCrLf & "
09286  |                Err.Source & "]" & vbCrLf & "[ErrC||09283  |                Err.Source & "]" & vbCrLf & "[ErrC
09287  |                "subErr" & "]" & vbCrLf & "[ErrDes||09284  |                "subErr" & "]" & vbCrLf & "[ErrDes
09288  |                Error & "]", _                    ||09285  |                Error & "]", _                    
09289  |                (vbOKOnly + vbCritical), ErrTitle)||09286  |                (vbOKOnly + vbCritical), ErrTitle)
09290  |    If (mblnFlgUnload = True) Then                ||09287  |    If (mblnFlgUnload = True) Then                
09291  |        Unload Me                                 ||09288  |        Unload Me                                 
09292  |    End If                                        ||09289  |    End If                                        
09293  |    Exit Sub                                      ||09290  |    Exit Sub                                      
09294  |                                                  ||09291  |                                                  
09295  |ErrorProc:                                        ||09292  |ErrorProc:                                        
09296  |    If (mblnFlgUnload = True) Then                ||09293  |    If (mblnFlgUnload = True) Then                
09297  |        Unload Me                                 ||09294  |        Unload Me                                 
09298  |    End If                                        ||09295  |    End If                                        
09299  |    Exit Sub                                      ||09296  |    Exit Sub                                      
09300  |                                                  ||09297  |                                                  
09301  |EndProc:                                          ||09298  |EndProc:                                          
09302  |    If (mblnFlgUnload = True) Then                ||09299  |    If (mblnFlgUnload = True) Then                
09303  |        Unload Me                                 ||09300  |        Unload Me                                 
09304  |    End If                                        ||09301  |    End If                                        
09305  |                                                  ||09302  |                                                  
09306  |End Sub                                           ||09303  |End Sub                                           
09307  |                                                  ||09304  |                                                  
09308  |'2005/07/26 Start                                 ||09305  |'2005/07/26 Start                                 
09309  |'出力対象チェックボックス動作は「チェックボックス ||09306  |'出力対象チェックボックス動作は「チェックボックス 
09310  |'となった為、全てコメント                         ||09307  |'となった為、全てコメント                         
09311  |''================================================||09308  |''================================================
09312  |''処理内容     chkAllSelect_Click時モジュール     ||09309  |''処理内容     chkAllSelect_Click時モジュール     
09313  |''備考                                            ||09310  |''備考                                            
09314  |''                                                ||09311  |''                                                
09315  |''日付         担当               内容            ||09312  |''日付         担当               内容            
09316  |''------------ ----------------- -----------------||09313  |''------------ ----------------- -----------------
09317  |''2004/08/26   M.Katoh <SRA>     新規作成         ||09314  |''2004/08/26   M.Katoh <SRA>     新規作成         
09318  |''================================================||09315  |''================================================
09319  |'Private Sub chkAllSelect_Click()                 ||09316  |'Private Sub chkAllSelect_Click()                 
09320  |'    Dim lCnt As Long                             ||09317  |'    Dim lCnt As Long                             
09321  |'    With fgridMakePrint                          ||09318  |'    With fgridMakePrint                          
09322  |'        '出力列を選択する                        ||09319  |'        '出力列を選択する                        
09323  |'        .Col = conColSysOutbln                   ||09320  |'        .Col = conColSysOutbln                   
09324  |'        If chkAllSelect.Value <> False Then      ||09321  |'        If chkAllSelect.Value <> False Then      
09325  |'            For lCnt = 0 To .Rows - 2            ||09322  |'            For lCnt = 0 To .Rows - 2            
09326  |'                .Row = lCnt + 1                  ||09323  |'                .Row = lCnt + 1                  
09327  |'                'チェックボックスをONする        ||09324  |'                'チェックボックスをONする        
09328  |'                .Text = 1                        ||09325  |'                .Text = 1                        
09329  |'            Next lCnt                            ||09326  |'            Next lCnt                            
09330  |'        Else                                     ||09327  |'        Else                                     
09331  |'            For lCnt = 0 To .Rows - 2            ||09328  |'            For lCnt = 0 To .Rows - 2            
09332  |'                .Row = lCnt + 1                  ||09329  |'                .Row = lCnt + 1                  
09333  |'                'チェックボックスをOFFする       ||09330  |'                'チェックボックスをOFFする       
09334  |'                .Text = 0                        ||09331  |'                .Text = 0                        
09335  |'            Next lCnt                            ||09332  |'            Next lCnt                            
09336  |'        End If                                   ||09333  |'        End If                                   
09337  |'    End With                                     ||09334  |'    End With                                     
09338  |'End Sub                                          ||09335  |'End Sub                                          
09339  |'2005/07/26　End                                  ||09336  |'2005/07/26　End                                  
09340  |                                                  ||09337  |                                                  
09341  |Private Sub txtInputName_GotFocus()               ||09338  |Private Sub txtInputName_GotFocus()               
09342  |    '反転表示                                     ||09339  |    '反転表示                                     
09343  |    Call gTextHanten(txtInputName)                ||09340  |    Call gTextHanten(txtInputName)                
09344  |End Sub                                           ||09341  |End Sub                                           
09345  |                                                  ||09342  |                                                  
09346  |Private Sub txtInputName_LostFocus()              ||09343  |Private Sub txtInputName_LostFocus()              
09347  |    'バイト数チェック                             ||09344  |    'バイト数チェック                             
09348  |    Call gTextByteChk(txtInputName, 128)          ||09345  |    Call gTextByteChk(txtInputName, 128)          
09349  |End Sub                                           ||09346  |End Sub                                           
09350  |                                                  ||09347  |                                                  
09351  |Private Sub txtSysOutDate_GotFocus()              ||09348  |Private Sub txtSysOutDate_GotFocus()              
09352  |    '反転表示                                     ||09349  |    '反転表示                                     
09353  |    Call gTextHanten(txtSysOutDate)               ||09350  |    Call gTextHanten(txtSysOutDate)               
09354  |End Sub                                           ||09351  |End Sub                                           
09355  |                                                  ||09352  |                                                  
09356  |Private Sub txtSysOutDate_KeyPress(KeyAscii As Int||09353  |Private Sub txtSysOutDate_KeyPress(KeyAscii As Int
09357  |    '半角数字のみ入力可                           ||09354  |    '半角数字のみ入力可                           
09358  |    Call gChkInputChar(KeyAscii, "0001010")       ||09355  |    Call gChkInputChar(KeyAscii, "0001010")       
09359  |End Sub                                           ||09356  |End Sub                                           
09360  |                                                  ||09357  |                                                  
09361  |Private Sub txtSysOutDate_LostFocus()             ||09358  |Private Sub txtSysOutDate_LostFocus()             
09362  |    '日付変換処理                                 ||09359  |    '日付変換処理                                 
09363  |    Call gTextDate_Lostfocus(txtSysOutDate, 1)    ||09360  |    Call gTextDate_Lostfocus(txtSysOutDate, 1)    
09364  |    If txtSysOutDate.BackColor = COLOR_ERR Then   ||09361  |    If txtSysOutDate.BackColor = COLOR_ERR Then   
09365  |        MsgSend "出力日付：暦日エラー　　　　", vb||09362  |        MsgSend "出力日付：暦日エラー　　　　", vb
09366  |        txtSysOutDate.SetFocus                    ||09363  |        txtSysOutDate.SetFocus                    
09367  |    End If                                        ||09364  |    End If                                        
09368  |End Sub                                           ||09365  |End Sub                                           
09369  |                                                  ||09366  |                                                  
09370  |Private Sub txtInputTax_GotFocus()                ||09367  |Private Sub txtInputTax_GotFocus()                
09371  |    '反転表示                                     ||09368  |    '反転表示                                     
09372  |    Call gTextHanten(txtInputTax)                 ||09369  |    Call gTextHanten(txtInputTax)                 
09373  |End Sub                                           ||09370  |End Sub                                           
09374  |                                                  ||09371  |                                                  
09375  |Private Sub txtInputTax_KeyPress(KeyAscii As Integ||09372  |Private Sub txtInputTax_KeyPress(KeyAscii As Integ
09376  |    '半角数字のみ入力可                           ||09373  |    '半角数字のみ入力可                           
09377  |    Call gChkInputChar(KeyAscii, "0001010")       ||09374  |    Call gChkInputChar(KeyAscii, "0001010")       
09378  |End Sub                                           ||09375  |End Sub                                           
09379  |                                                  ||09376  |                                                  
09380  |Private Sub txtInputTax_LostFocus()               ||09377  |Private Sub txtInputTax_LostFocus()               
09381  |    If txtInputTax.Text <> "" Then                ||09378  |    If txtInputTax.Text <> "" Then                
09382  |        If IsNumeric(txtInputTax.Text) = False The||09379  |        If IsNumeric(txtInputTax.Text) = False The
09383  |            MsgBox "数値を入力してください", vbInf||09380  |            MsgBox "数値を入力してください", vbInf
09384  |            txtInputTax.SetFocus                  ||09381  |            txtInputTax.SetFocus                  
09385  |        End If                                    ||09382  |        End If                                    
09386  |    End If                                        ||09383  |    End If                                        
09387  |End Sub                                           ||09384  |End Sub                                           
09388  |                                                  ||09385  |                                                  
09389  |'=================================================||09386  |'=================================================
09390  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMakePrintFlexGridIni       ||09387  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMakePrintFlexGridIni       
09391  |'機能            :   確認書作成VSFlexGrid初期設定 ||09388  |'機能            :   確認書作成VSFlexGrid初期設定 
09392  |'                                                 ||09389  |'                                                 
09393  |'日付               担当　              修正内容  ||09390  |'日付               担当　              修正内容  
09394  |'-------------------------------------------------||09391  |'-------------------------------------------------
09395  |'2004/05/14         M.Katoh<SRA>       新規作成   ||09392  |'2004/05/14         M.Katoh<SRA>       新規作成   
09396  |'2004/12/29         M.Yamazaki<SRA>    NAV取得区分||09393  |'2004/12/29         M.Yamazaki<SRA>    NAV取得区分
09397  |'2005/01/11         M.Yamazaki<SRA>    列追加     ||09394  |'2005/01/11         M.Yamazaki<SRA>    列追加     
09398  |'2005/01/17         M.Yamazaki<SRA>    列追加をせ ||09395  |'2005/01/17         M.Yamazaki<SRA>    列追加をせ 
09399  |'2005/02/02         M.Yamazaki<SRA>    前回締日営 ||09396  |'2005/02/02         M.Yamazaki<SRA>    前回締日営 
09400  |'2005/03/09         M.Yamazaki<SRA>    消費税計算 ||09397  |'2005/03/09         M.Yamazaki<SRA>    消費税計算 
09401  |'2005/07/25         K.Nishihama<SRA>   英文チェッ ||09398  |'2005/07/25         K.Nishihama<SRA>   英文チェッ 
09402  |'2008/03/12         K.Furuya<SRA>      ファンド決 ||09399  |'2008/03/12         K.Furuya<SRA>      ファンド決 
09403  |'=================================================||09400  |'=================================================
09404  |Private Sub sbMakePrintFlexGridIni()              ||09401  |Private Sub sbMakePrintFlexGridIni()              
09405  |                                                  ||09402  |                                                  
09406  |    Dim iIdx As Integer                           ||09403  |    Dim iIdx As Integer                           
09407  |                                                  ||09404  |                                                  
09408  |    With fgridMakePrint                           ||09405  |    With fgridMakePrint                           
09409  |        'VSFlexGrid初期設定                       ||09406  |        'VSFlexGrid初期設定                       
09410  |        .Height = 3855                            ||09407  |        .Height = 3855                            
09411  |'2008/03/12 START ファンド決算期間での外部委託顧問||09408  |'2008/03/12 START ファンド決算期間での外部委託顧問
09412  |'        .Width = 9375                            ||09409  |'        .Width = 9375                            
09413  |        .Width = 13000                            ||09410  |        .Width = 13000                            
09414  |'2008/03/12 END   ファンド決算期間での外部委託顧問||09411  |'2008/03/12 END   ファンド決算期間での外部委託顧問
09415  |        .Left = 120                               ||09412  |        .Left = 120                               
09416  |        .Top = 1560                               ||09413  |        .Top = 1560                               
09417  |        .Col = -1                                 ||09414  |        .Col = -1                                 
09418  |'2005/01/11 Start                                 ||09415  |'2005/01/11 Start                                 
09419  |''2004/12/29 Start                                ||09416  |''2004/12/29 Start                                
09420  |''        .Cols = 17                              ||09417  |''        .Cols = 17                              
09421  |'        .Cols = 20                               ||09418  |'        .Cols = 20                               
09422  |''2004/12/29 End                                  ||09419  |''2004/12/29 End                                  
09423  |'2005/03/09 Start                                 ||09420  |'2005/03/09 Start                                 
09424  |''2005/01/17 Start                                ||09421  |''2005/01/17 Start                                
09425  |''        .Cols = 28                              ||09422  |''        .Cols = 28                              
09426  |'''2005/01/11 End                                 ||09423  |'''2005/01/11 End                                 
09427  |''2005/02/02 Start                                ||09424  |''2005/02/02 Start                                
09428  |''        .Cols = 24                              ||09425  |''        .Cols = 24                              
09429  |'        .Cols = 25                               ||09426  |'        .Cols = 25                               
09430  |''2005/02/02 End                                  ||09427  |''2005/02/02 End                                  
09431  |''2005/01/17 End                                  ||09428  |''2005/01/17 End                                  
09432  |'        .Cols = 26                               ||09429  |'        .Cols = 26                               
09433  |'2005/03/09 End                                   ||09430  |'2005/03/09 End                                   
09434  |                                                  ||09431  |                                                  
09435  |'2005/07/25 Start                                 ||09432  |'2005/07/25 Start                                 
09436  |'        .Cols = 28                               ||09433  |'        .Cols = 28                               
09437  |'2005/07/25 End                                   ||09434  |'2005/07/25 End                                   
09438  |'2008/03/12 START ファンド決算期間での外部委託顧問||09435  |'2008/03/12 START ファンド決算期間での外部委託顧問
09439  |        .Cols = 30                                ||09436  |        .Cols = 30                                
09440  |'2008/03/12 END   ファンド決算期間での外部委託顧問||09437  |'2008/03/12 END   ファンド決算期間での外部委託顧問
09441  |                                                  ||09438  |                                                  
09442  |        .Row = -1                                 ||09439  |        .Row = -1                                 
09443  |        .Rows = 1                                 ||09440  |        .Rows = 1                                 
09444  |                                                  ||09441  |                                                  
09445  |        .Row = 0                                  ||09442  |        .Row = 0                                  
09446  |        '行単位選択                               ||09443  |        '行単位選択                               
09447  |        .Clear flexClearScrollable, flexClearText ||09444  |        .Clear flexClearScrollable, flexClearText 
09448  |        .Visible = False                          ||09445  |        .Visible = False                          
09449  |                                                  ||09446  |                                                  
09450  |        For iIdx = .LeftCol - 1 To .Cols - 1      ||09447  |        For iIdx = .LeftCol - 1 To .Cols - 1      
09451  |            .Col = iIdx                           ||09448  |            .Col = iIdx                           
09452  |            Select Case iIdx                      ||09449  |            Select Case iIdx                      
09453  |                Case 0                            ||09450  |                Case 0                            
09454  |                    .ColWidth(iIdx) = 200         ||09451  |                    .ColWidth(iIdx) = 200         
09455  |                    .Text = ""                    ||09452  |                    .Text = ""                    
09456  |                Case 1                            ||09453  |                Case 1                            
09457  |                    .ColWidth(iIdx) = 540         ||09454  |                    .ColWidth(iIdx) = 540         
09458  |                    .Text = "出力"                ||09455  |                    .Text = "出力"                
09459  |'2005/07/25 Start                                 ||09456  |'2005/07/25 Start                                 
09460  |                Case 2                            ||09457  |                Case 2                            
09461  |                    .ColWidth(iIdx) = 540         ||09458  |                    .ColWidth(iIdx) = 540         
09462  |                    .Text = "英文"                ||09459  |                    .Text = "英文"                
09463  |'2005/07/25 Start                                 ||09460  |'2005/07/25 Start                                 
09464  |                                                  ||09461  |                                                  
09465  |                Case 3                            ||09462  |                Case 3                            
09466  |'2005/03/09 Start                                 ||09463  |'2005/03/09 Start                                 
09467  |'                    .ColWidth(iIdx) = 1000       ||09464  |'                    .ColWidth(iIdx) = 1000       
09468  |                    .ColWidth(iIdx) = 1605        ||09465  |                    .ColWidth(iIdx) = 1605        
09469  |'2005/03/09 End                                   ||09466  |'2005/03/09 End                                   
09470  |                    .Text = "契約番号"            ||09467  |                    .Text = "契約番号"            
09471  |                Case 4                            ||09468  |                Case 4                            
09472  |                    .ColWidth(iIdx) = 1800        ||09469  |                    .ColWidth(iIdx) = 1800        
09473  |                    .Text = "契約名"              ||09470  |                    .Text = "契約名"              
09474  |'2005/08/04 Start                                 ||09471  |'2005/08/04 Start                                 
09475  |                Case 5                            ||09472  |                Case 5                            
09476  |                    .ColWidth(iIdx) = 1700        ||09473  |                    .ColWidth(iIdx) = 1700        
09477  |                    .Text = "契約名[英]"          ||09474  |                    .Text = "契約名[英]"          
09478  |'2005/08/04 End                                   ||09475  |'2005/08/04 End                                   
09479  |                Case 6                            ||09476  |                Case 6                            
09480  |                    .ColWidth(iIdx) = 1700        ||09477  |                    .ColWidth(iIdx) = 1700        
09481  |                    .Text = "契約区分"            ||09478  |                    .Text = "契約区分"            
09482  |                Case 7                            ||09479  |                Case 7                            
09483  |                    .ColWidth(iIdx) = 1100        ||09480  |                    .ColWidth(iIdx) = 1100        
09484  |                    .Text = "締日営業日翌日"      ||09481  |                    .Text = "締日営業日翌日"      
09485  |                Case 8                            ||09482  |                Case 8                            
09486  |                    .ColWidth(iIdx) = 1100        ||09483  |                    .ColWidth(iIdx) = 1100        
09487  |                    .Text = "締日"                ||09484  |                    .Text = "締日"                
09488  |                Case 9                            ||09485  |                Case 9                            
09489  |                    .ColWidth(iIdx) = 1000        ||09486  |                    .ColWidth(iIdx) = 1000        
09490  |                    .Text = "口座コード"          ||09487  |                    .Text = "口座コード"          
09491  |                Case 10                           ||09488  |                Case 10                           
09492  |                    .ColWidth(iIdx) = 1600        ||09489  |                    .ColWidth(iIdx) = 1600        
09493  |                    .Text = "口座名"              ||09490  |                    .Text = "口座名"              
09494  |                Case 11                           ||09491  |                Case 11                           
09495  |                    .ColWidth(iIdx) = 1000        ||09492  |                    .ColWidth(iIdx) = 1000        
09496  |                    .Text = "通貨コード"          ||09493  |                    .Text = "通貨コード"          
09497  |                Case 12                           ||09494  |                Case 12                           
09498  |                    .ColWidth(iIdx) = 1080        ||09495  |                    .ColWidth(iIdx) = 1080        
09499  |                    .Text = "適用開始日"          ||09496  |                    .Text = "適用開始日"          
09500  |                Case 13                           ||09497  |                Case 13                           
09501  |                    .ColWidth(iIdx) = 1080        ||09498  |                    .ColWidth(iIdx) = 1080        
09502  |                    .Text = "適用終了日"          ||09499  |                    .Text = "適用終了日"          
09503  |                Case 14                           ||09500  |                Case 14                           
09504  |                    .ColWidth(iIdx) = 1350        ||09501  |                    .ColWidth(iIdx) = 1350        
09505  |                    .Text = "運用会社コード"      ||09502  |                    .Text = "運用会社コード"      
09506  |                Case 15                           ||09503  |                Case 15                           
09507  |                    .ColWidth(iIdx) = 1840        ||09504  |                    .ColWidth(iIdx) = 1840        
09508  |                    .Text = "運用会社名"          ||09505  |                    .Text = "運用会社名"          
09509  |                Case 16                           ||09506  |                Case 16                           
09510  |                    .ColWidth(iIdx) = 1840        ||09507  |                    .ColWidth(iIdx) = 1840        
09511  |                    .Text = "運用会社名[英]"      ||09508  |                    .Text = "運用会社名[英]"      
09512  |                Case 17                           ||09509  |                Case 17                           
09513  |                    .ColWidth(iIdx) = 900         ||09510  |                    .ColWidth(iIdx) = 900         
09514  |                    .Text = "ルールNo"            ||09511  |                    .Text = "ルールNo"            
09515  |                Case 18                           ||09512  |                Case 18                           
09516  |                    .ColWidth(iIdx) = 900         ||09513  |                    .ColWidth(iIdx) = 900         
09517  |                    .Text = "料率区分"            ||09514  |                    .Text = "料率区分"            
09518  |'2004/12/29 Start                                 ||09515  |'2004/12/29 Start                                 
09519  |'                Case 16                          ||09516  |'                Case 16                          
09520  |'                    .ColWidth(iIdx) = 1080       ||09517  |'                    .ColWidth(iIdx) = 1080       
09521  |'                    .Text = "支払予定日"         ||09518  |'                    .Text = "支払予定日"         
09522  |                Case 19                           ||09519  |                Case 19                           
09523  |                    .ColWidth(iIdx) = 900         ||09520  |                    .ColWidth(iIdx) = 900         
09524  |                    .Text = "NAV取得区分"         ||09521  |                    .Text = "NAV取得区分"         
09525  |                Case 20                           ||09522  |                Case 20                           
09526  |                    .ColWidth(iIdx) = 900         ||09523  |                    .ColWidth(iIdx) = 900         
09527  |                    .Text = "上限金額"            ||09524  |                    .Text = "上限金額"            
09528  |                Case 21                           ||09525  |                Case 21                           
09529  |                    .ColWidth(iIdx) = 900         ||09526  |                    .ColWidth(iIdx) = 900         
09530  |                    .Text = "下限金額"            ||09527  |                    .Text = "下限金額"            
09531  |                Case 22                           ||09528  |                Case 22                           
09532  |                    .ColWidth(iIdx) = 1080        ||09529  |                    .ColWidth(iIdx) = 1080        
09533  |                    .Text = "支払予定日"          ||09530  |                    .Text = "支払予定日"          
09534  |'2004/12/29 End                                   ||09531  |'2004/12/29 End                                   
09535  |'2005/01/11 Start                                 ||09532  |'2005/01/11 Start                                 
09536  |                Case 23                           ||09533  |                Case 23                           
09537  |                    .ColWidth(iIdx) = 1080        ||09534  |                    .ColWidth(iIdx) = 1080        
09538  |                    .Text = "NAV通貨"             ||09535  |                    .Text = "NAV通貨"             
09539  |                Case 24                           ||09536  |                Case 24                           
09540  |                    .ColWidth(iIdx) = 1080        ||09537  |                    .ColWidth(iIdx) = 1080        
09541  |                    .Text = "閾値通貨"            ||09538  |                    .Text = "閾値通貨"            
09542  |                Case 25                           ||09539  |                Case 25                           
09543  |                    .ColWidth(iIdx) = 1080        ||09540  |                    .ColWidth(iIdx) = 1080        
09544  |                    .Text = "顧問料通貨"          ||09541  |                    .Text = "顧問料通貨"          
09545  |'2005/01/17 Start                                 ||09542  |'2005/01/17 Start                                 
09546  |'                Case 23                          ||09543  |'                Case 23                          
09547  |'                    .ColWidth(iIdx) = 1560       ||09544  |'                    .ColWidth(iIdx) = 1560       
09548  |'                    .Text = "NAV→閾値"          ||09545  |'                    .Text = "NAV→閾値"          
09549  |'                Case 24                          ||09546  |'                Case 24                          
09550  |'                    .ColWidth(iIdx) = 1560       ||09547  |'                    .ColWidth(iIdx) = 1560       
09551  |'                    .Text = "NAV→顧問料"        ||09548  |'                    .Text = "NAV→顧問料"        
09552  |'                Case 25                          ||09549  |'                Case 25                          
09553  |'                    .ColWidth(iIdx) = 1560       ||09550  |'                    .ColWidth(iIdx) = 1560       
09554  |'                    .Text = "閾値→顧問料"       ||09551  |'                    .Text = "閾値→顧問料"       
09555  |'                Case 26                          ||09552  |'                Case 26                          
09556  |'                    .ColWidth(iIdx) = 1560       ||09553  |'                    .ColWidth(iIdx) = 1560       
09557  |'                    .Text = "顧問料→支払(円)"   ||09554  |'                    .Text = "顧問料→支払(円)"   
09558  |'                Case 27                          ||09555  |'                Case 27                          
09559  |'                    .ColWidth(iIdx) = 900        ||09556  |'                    .ColWidth(iIdx) = 900        
09560  |'                    .Text = "一年間の日数"       ||09557  |'                    .Text = "一年間の日数"       
09561  |''2005/01/11 End                                  ||09558  |''2005/01/11 End                                  
09562  |                Case 26                           ||09559  |                Case 26                           
09563  |                    .ColWidth(iIdx) = 900         ||09560  |                    .ColWidth(iIdx) = 900         
09564  |                    .Text = "一年間の日数"        ||09561  |                    .Text = "一年間の日数"        
09565  |'2005/01/17 End                                   ||09562  |'2005/01/17 End                                   
09566  |'2005/02/02 Start                                 ||09563  |'2005/02/02 Start                                 
09567  |                Case 27                           ||09564  |                Case 27                           
09568  |                    .ColWidth(iIdx) = 900         ||09565  |                    .ColWidth(iIdx) = 900         
09569  |                    .Text = "消費税計算有無"      ||09566  |                    .Text = "消費税計算有無"      
09570  |'2005/02/02 End                                   ||09567  |'2005/02/02 End                                   
09571  |'2008/03/12 START ファンド決算期間での外部委託顧問||09568  |'2008/03/12 START ファンド決算期間での外部委託顧問
09572  |                Case 28                           ||09569  |                Case 28                           
09573  |                    .ColWidth(iIdx) = 1500        ||09570  |                    .ColWidth(iIdx) = 1500        
09574  |                    .Text = "ファンド計算FROM"    ||09571  |                    .Text = "ファンド計算FROM"    
09575  |                Case 29                           ||09572  |                Case 29                           
09576  |                    .ColWidth(iIdx) = 1500        ||09573  |                    .ColWidth(iIdx) = 1500        
09577  |                    .Text = "ファンド計算TO"      ||09574  |                    .Text = "ファンド計算TO"      
09578  |'2008/03/12 END   ファンド決算期間での外部委託顧問||09575  |'2008/03/12 END   ファンド決算期間での外部委託顧問
09579  |            End Select                            ||09576  |            End Select                            
09580  |        Next iIdx                                 ||09577  |        Next iIdx                                 
09581  |    End With                                      ||09578  |    End With                                      
09582  |                                                  ||09579  |                                                  
09583  |End Sub                                           ||09580  |End Sub                                           
09584  |                                                  ||09581  |                                                  
09585  |'=================================================||09582  |'=================================================
09586  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnMakePrintDataSet           ||09583  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnMakePrintDataSet           
09587  |'機能            :   確認書作成テーブルデータ抽出 ||09584  |'機能            :   確認書作成テーブルデータ抽出 
09588  |'                                                 ||09585  |'                                                 
09589  |'日付               担当　              修正内容  ||09586  |'日付               担当　              修正内容  
09590  |'-------------------------------------------------||09587  |'-------------------------------------------------
09591  |'2004/08/06         M.Katoh<SRA>       新規作成   ||09588  |'2004/08/06         M.Katoh<SRA>       新規作成   
09592  |'2005/01/18         M.Yamazaki<SRA>    無効フラグ ||09589  |'2005/01/18         M.Yamazaki<SRA>    無効フラグ 
09593  |'2005/02/02         M.Yamazaki<SRA>    ストアドを ||09590  |'2005/02/02         M.Yamazaki<SRA>    ストアドを 
09594  |'2005/02/03         M.Yamazaki<SRA>    ストアド名 ||09591  |'2005/02/03         M.Yamazaki<SRA>    ストアド名 
09595  |'2005/03/09         M.Yamazaki<SRA>    消費税テー ||09592  |'2005/03/09         M.Yamazaki<SRA>    消費税テー 
09596  |'2005/04/21         M.Yamazaki<SRA>    パフォーマ ||09593  |'2005/04/21         M.Yamazaki<SRA>    パフォーマ 
09597  |'2005/04/22         M.Yamazaki<SRA>    顧問料計算 ||09594  |'2005/04/22         M.Yamazaki<SRA>    顧問料計算 
09598  |'2005/04/22         M.Yamazaki<SRA>    重複データ ||09595  |'2005/04/22         M.Yamazaki<SRA>    重複データ 
09599  |'=================================================||09596  |'=================================================
09600  |Private Function fnMakePrintDataSet() As Boolean  ||09597  |Private Function fnMakePrintDataSet() As Boolean  
09601  |                                                  ||09598  |                                                  
09602  |    Const conMeModule   As String = "fnMakePrintDa||09599  |    Const conMeModule   As String = "fnMakePrintDa
09603  |    Dim strErrCall      As String        'エラー呼||09600  |    Dim strErrCall      As String        'エラー呼
09604  |    Dim sSql            As String                 ||09601  |    Dim sSql            As String                 
09605  |    Dim lRecCnt         As Long                   ||09602  |    Dim lRecCnt         As Long                   
09606  |    Dim sWorkWhere      As String                 ||09603  |    Dim sWorkWhere      As String                 
09607  |    Dim lActiveIdx      As Long                   ||09604  |    Dim lActiveIdx      As Long                   
09608  |    Dim iRet            As Integer                ||09605  |    Dim iRet            As Integer                
09609  |'2005/04/22 Start                                 ||09606  |'2005/04/22 Start                                 
09610  |'    Dim lRowCnt         As Long                  ||09607  |'    Dim lRowCnt         As Long                  
09611  |'2005/04/22 End                                   ||09608  |'2005/04/22 End                                   
09612  |    Dim SettleDate      As String                 ||09609  |    Dim SettleDate      As String                 
09613  |    Dim ComCalcStart    As String                 ||09610  |    Dim ComCalcStart    As String                 
09614  |'2005/01/18 Start                                 ||09611  |'2005/01/18 Start                                 
09615  |    Dim dintAccCnt      As Integer                ||09612  |    Dim dintAccCnt      As Integer                
09616  |'2005/01/18 End                                   ||09613  |'2005/01/18 End                                   
09617  |                                                  ||09614  |                                                  
09618  |'2005/04/21 Start                                 ||09615  |'2005/04/21 Start                                 
09619  |    Dim lRecCnt3 As Long                          ||09616  |    Dim lRecCnt3 As Long                          
09620  |    Dim strCONTRACTNo As String                   ||09617  |    Dim strCONTRACTNo As String                   
09621  |    Dim dstrSvDate As String                      ||09618  |    Dim dstrSvDate As String                      
09622  |    Dim dstrWkDate As String                      ||09619  |    Dim dstrWkDate As String                      
09623  |    Dim dblnEdit As Boolean                       ||09620  |    Dim dblnEdit As Boolean                       
09624  |    Dim lCnt As Long                              ||09621  |    Dim lCnt As Long                              
09625  |    Dim intRtn As Integer                         ||09622  |    Dim intRtn As Integer                         
09626  |    Dim dstrWkDateFlg As String                   ||09623  |    Dim dstrWkDateFlg As String                   
09627  |    Dim ComCalcEnd    As String                   ||09624  |    Dim ComCalcEnd    As String                   
09628  |    Dim J As Long                                 ||09625  |    Dim J As Long                                 
09629  |    Dim K As Long                                 ||09626  |    Dim K As Long                                 
09630  |    Dim L As Long                                 ||09627  |    Dim L As Long                                 
09631  |    Dim M As Long                                 ||09628  |    Dim M As Long                                 
09632  |    Dim N As Long                                 ||09629  |    Dim N As Long                                 
09633  |    Dim O As Long                                 ||09630  |    Dim O As Long                                 
09634  |    Dim P As Long                                 ||09631  |    Dim P As Long                                 
09635  |'2005/04/21 End                                   ||09632  |'2005/04/21 End                                   
09636  |'2005/04/26 Start                                 ||09633  |'2005/04/26 Start                                 
09637  |    Dim dstrUseEnd As String                      ||09634  |    Dim dstrUseEnd As String                      
09638  |'2005/04/26 End                                   ||09635  |'2005/04/26 End                                   
09639  |                                                  ||09636  |                                                  
09640  |    '初期処理                                     ||09637  |    '初期処理                                     
09641  |    fnMakePrintDataSet = False                    ||09638  |    fnMakePrintDataSet = False                    
09642  |                                                  ||09639  |                                                  
09643  |    'エラー呼出元設定                             ||09640  |    'エラー呼出元設定                             
09644  |    strErrCall = conMeForm & ":" & conMeModule    ||09641  |    strErrCall = conMeForm & ":" & conMeModule    
09645  |                                                  ||09642  |                                                  
09646  |    'ｲﾝﾃﾞｯｸｽ初期化                                ||09643  |    'ｲﾝﾃﾞｯｸｽ初期化                                
09647  |    lRecCnt = 0                                   ||09644  |    lRecCnt = 0                                   
09648  |    lRowCnt = 0                                   ||09645  |    lRowCnt = 0                                   
09649  |    lActiveIdx = 0                                ||09646  |    lActiveIdx = 0                                
09650  |    'DBオープン                                   ||09647  |    'DBオープン                                   
09651  |    If Not gintDbOpen() Then                      ||09648  |    If Not gintDbOpen() Then                      
09652  |        Exit Function                             ||09649  |        Exit Function                             
09653  |    End If                                        ||09650  |    End If                                        
09654  |                                                  ||09651  |                                                  
09655  |'2005/03/09 Start                                 ||09652  |'2005/03/09 Start                                 
09656  |    'SQL文作成                                    ||09653  |    'SQL文作成                                    
09657  |    sSql = "SELECT CONSUMPTION_TAX FROM CFR_CONSUM||09654  |    sSql = "SELECT CONSUMPTION_TAX FROM CFR_CONSUM
09658  |                                                  ||09655  |                                                  
09659  |    'ﾀﾞｲﾅｾｯﾄの作成                                ||09656  |    'ﾀﾞｲﾅｾｯﾄの作成                                
09660  |    If (gintDyCreate(sSql) = False) Then          ||09657  |    If (gintDyCreate(sSql) = False) Then          
09661  |        Call subError("DBエラー", Str(9999), "gint||09658  |        Call subError("DBエラー", Str(9999), "gint
09662  |            "DB関数エラー", strErrCall, conTitle) ||09659  |            "DB関数エラー", strErrCall, conTitle) 
09663  |        Exit Function                             ||09660  |        Exit Function                             
09664  |    End If                                        ||09661  |    End If                                        
09665  |                                                  ||09662  |                                                  
09666  |    '                                             ||09663  |    '                                             
09667  |    ddblconsumption_tax = gvlnDyDataN("CONSUMPTION||09664  |    ddblconsumption_tax = gvlnDyDataN("CONSUMPTION
09668  |'2005/03/09 End                                   ||09665  |'2005/03/09 End                                   
09669  |                                                  ||09666  |                                                  
09670  |    'SQL文作成                                    ||09667  |    'SQL文作成                                    
09671  |    sSql = gstrEditSQLcfr_MonthlyCalcNavForSelect(||09668  |    sSql = gstrEditSQLcfr_MonthlyCalcNavForSelect(
09672  |                                                  ||09669  |                                                  
09673  |    'ﾀﾞｲﾅｾｯﾄの作成                                ||09670  |    'ﾀﾞｲﾅｾｯﾄの作成                                
09674  |    If (gintDyCreate(sSql) = False) Then          ||09671  |    If (gintDyCreate(sSql) = False) Then          
09675  |        Call subError("DBエラー", Str(9999), "gint||09672  |        Call subError("DBエラー", Str(9999), "gint
09676  |            "DB関数エラー", strErrCall, conTitle) ||09673  |            "DB関数エラー", strErrCall, conTitle) 
09677  |        Exit Function                             ||09674  |        Exit Function                             
09678  |    End If                                        ||09675  |    End If                                        
09679  |                                                  ||09676  |                                                  
09680  |    '配列初期化                                   ||09677  |    '配列初期化                                   
09681  |    ReDim gbuMGetUPDRec.N(0)                      ||09678  |    ReDim gbuMGetUPDRec.N(0)                      
09682  |                                                  ||09679  |                                                  
09683  |    'EOF判定処理                                  ||09680  |    'EOF判定処理                                  
09684  |    Do Until gblnDyEOF()                          ||09681  |    Do Until gblnDyEOF()                          
09685  |        '対象データ抽出                           ||09682  |        '対象データ抽出                           
09686  |        '配列にセット                             ||09683  |        '配列にセット                             
09687  |        Call sbMGetDataGet(lRecCnt)               ||09684  |        Call sbMGetDataGet(lRecCnt)               
09688  |        lRecCnt = lRecCnt + 1                     ||09685  |        lRecCnt = lRecCnt + 1                     
09689  |        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                         ||09686  |        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                         
09690  |        Call gDyNext                              ||09687  |        Call gDyNext                              
09691  |    Loop                                          ||09688  |    Loop                                          
09692  |                                                  ||09689  |                                                  
09693  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             ||09690  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             
09694  |    Call gblnDyClose                              ||09691  |    Call gblnDyClose                              
09695  |                                                  ||09692  |                                                  
09696  |    'グリッドデータセット処理                     ||09693  |    'グリッドデータセット処理                     
09697  |    lRecCnt = 0                                   ||09694  |    lRecCnt = 0                                   
09698  |    For lRecCnt = LBound(gbuMGetUPDRec.N) To UBoun||09695  |    For lRecCnt = LBound(gbuMGetUPDRec.N) To UBoun
09699  |                                                  ||09696  |                                                  
09700  |'2005/04/22 Start                                 ||09697  |'2005/04/22 Start                                 
09701  |        If Len(gbuMGetUPDRec.N(lRecCnt).MGET_com_c||09698  |        If Len(gbuMGetUPDRec.N(lRecCnt).MGET_com_c
09702  |'            If Replace(DateAdd("yyyy", 1, CDate(M||09699  |'            If Replace(DateAdd("yyyy", 1, CDate(M
09703  |            If Replace(DateAdd("yyyy", 1, CDate(Mi||09700  |            If Replace(DateAdd("yyyy", 1, CDate(Mi
09704  |                GoTo NextData                     ||09701  |                GoTo NextData                     
09705  |            End If                                ||09702  |            End If                                
09706  |        End If                                    ||09703  |        End If                                    
09707  |'2005/04/22 End                                   ||09704  |'2005/04/22 End                                   
09708  |'2005/04/21 Start                                 ||09705  |'2005/04/21 Start                                 
09709  |        'SQL文作成                                ||09706  |        'SQL文作成                                
09710  |        strCONTRACTNo = gbuMGetUPDRec.N(lRecCnt).M||09707  |        strCONTRACTNo = gbuMGetUPDRec.N(lRecCnt).M
09711  |                                                  ||09708  |                                                  
09712  |        '外部委託顧問料締日テーブル取得用SQL作成  ||09709  |        '外部委託顧問料締日テーブル取得用SQL作成  
09713  |        sSql = gstrEditSQLcfr_Settlement_dateForSe||09710  |        sSql = gstrEditSQLcfr_Settlement_dateForSe
09714  |        'ﾀﾞｲﾅｾｯﾄの作成                            ||09711  |        'ﾀﾞｲﾅｾｯﾄの作成                            
09715  |        If (gintDyCreate(sSql) = False) Then      ||09712  |        If (gintDyCreate(sSql) = False) Then      
09716  |            Call subError("DBエラー", Str(9999), "||09713  |            Call subError("DBエラー", Str(9999), "
09717  |                "DB関数エラー", strErrCall, conTit||09714  |                "DB関数エラー", strErrCall, conTit
09718  |            Exit Function                         ||09715  |            Exit Function                         
09719  |        End If                                    ||09716  |        End If                                    
09720  |        '件数取得                                 ||09717  |        '件数取得                                 
09721  |        lCnt = gvlnDyDataN("REC_CNT")             ||09718  |        lCnt = gvlnDyDataN("REC_CNT")             
09722  |        '通常締日件数チェック                     ||09719  |        '通常締日件数チェック                     
09723  |        If lCnt = 0 Then                          ||09720  |        If lCnt = 0 Then                          
09724  |            intRtn = MsgBox("締日が正しく設定され ||09721  |            intRtn = MsgBox("締日が正しく設定され 
09725  |                        vbLf & "契約番号 ： [ " & ||09722  |                        vbLf & "契約番号 ： [ " & 
09726  |                        vbLf & "に通常締日を設定し||09723  |                        vbLf & "に通常締日を設定し
09727  |                        vbCritical, "外部委託顧問 ||09724  |                        vbCritical, "外部委託顧問 
09728  |            Exit Function                         ||09725  |            Exit Function                         
09729  |        End If                                    ||09726  |        End If                                    
09730  |'2005/04/21 End                                   ||09727  |'2005/04/21 End                                   
09731  |                                                  ||09728  |                                                  
09732  |        mstrSettlementDate = ""                   ||09729  |        mstrSettlementDate = ""                   
09733  |        SettleDate = gbuMGetUPDRec.N(lRecCnt).MGET||09730  |        SettleDate = gbuMGetUPDRec.N(lRecCnt).MGET
09734  |        '締日が閏年かどうか判定                   ||09731  |        '締日が閏年かどうか判定                   
09735  |        If Mid(SettleDate, 5, 4) = conUrudoshi The||09732  |        If Mid(SettleDate, 5, 4) = conUrudoshi The
09736  |            '閏年チェック                         ||09733  |            '閏年チェック                         
09737  |            If fnblnUrudoshiCheck(Mid(SettleDate, ||09734  |            If fnblnUrudoshiCheck(Mid(SettleDate, 
09738  |                mstrSettlementDate = Mid(SettleDat||09735  |                mstrSettlementDate = Mid(SettleDat
09739  |            Else                                  ||09736  |            Else                                  
09740  |                mstrSettlementDate = SettleDate   ||09737  |                mstrSettlementDate = SettleDate   
09741  |            End If                                ||09738  |            End If                                
09742  |        Else                                      ||09739  |        Else                                      
09743  |            mstrSettlementDate = gbuMGetUPDRec.N(l||09740  |            mstrSettlementDate = gbuMGetUPDRec.N(l
09744  |        End If                                    ||09741  |        End If                                    
09745  |'2005/04/21 Start                                 ||09742  |'2005/04/21 Start                                 
09746  |        dstrWkDate = mstrSettlementDate           ||09743  |        dstrWkDate = mstrSettlementDate           
09747  |        If fnChkSettlementDate(dstrWkDate, 1) <> F||09744  |        If fnChkSettlementDate(dstrWkDate, 1) <> F
09748  |            dstrSvSettlementDate = mstrNearSettleD||09745  |            dstrSvSettlementDate = mstrNearSettleD
09749  |        End If                                    ||09746  |        End If                                    
09750  |'2005/04/21 End                                   ||09747  |'2005/04/21 End                                   
09751  |                                                  ||09748  |                                                  
09752  |'2005/01/18 Start                                 ||09749  |'2005/01/18 Start                                 
09753  |'        '締日の営業日チェック                    ||09750  |'        '締日の営業日チェック                    
09754  |'        If fnChkSettlementDate(mstrSettlementDate||09751  |'        If fnChkSettlementDate(mstrSettlementDate
09755  |'            '顧問料計算開始日をチェック(顧問料計 ||09752  |'            '顧問料計算開始日をチェック(顧問料計 
09756  |'            ComCalcStart = gbuMGetUPDRec.N(lRecCn||09753  |'            ComCalcStart = gbuMGetUPDRec.N(lRecCn
09757  |'            If mstrSettlementDate >= ComCalcStart||09754  |'            If mstrSettlementDate >= ComCalcStart
09758  |'                If mstrSettlementDate <> "" Then ||09755  |'                If mstrSettlementDate <> "" Then 
09759  |'                    'グリッドの行カウンターアップ||09756  |'                    'グリッドの行カウンターアップ
09760  |'                    lRowCnt = lRowCnt + 1        ||09757  |'                    lRowCnt = lRowCnt + 1        
09761  |'                    'グリッドにセット            ||09758  |'                    'グリッドにセット            
09762  |'                    Call sbMakePrintFlexGridDataS||09759  |'                    Call sbMakePrintFlexGridDataS
09763  |'                End If                           ||09760  |'                End If                           
09764  |'            End If                               ||09761  |'            End If                               
09765  |'        End If                                   ||09762  |'        End If                                   
09766  |                                                  ||09763  |                                                  
09767  |        If gbuMGetUPDRec.N(lRecCnt).MGET_acc_inval||09764  |        If gbuMGetUPDRec.N(lRecCnt).MGET_acc_inval
09768  |            sSql = ""                             ||09765  |            sSql = ""                             
09769  |            sSql = sSql & "SELECT COUNT(*) ACC_CNT||09766  |            sSql = sSql & "SELECT COUNT(*) ACC_CNT
09770  |            sSql = sSql & "FROM CFR01.CFR_ACCOUNT_||09767  |            sSql = sSql & "FROM CFR01.CFR_ACCOUNT_
09771  |            sSql = sSql & "WHERE ACCOUNT_CODE = '"||09768  |            sSql = sSql & "WHERE ACCOUNT_CODE = '"
09772  |            'ﾀﾞｲﾅｾｯﾄの作成                        ||09769  |            'ﾀﾞｲﾅｾｯﾄの作成                        
09773  |            If gintDyCreate(sSql) = False Then    ||09770  |            If gintDyCreate(sSql) = False Then    
09774  |                Exit Function                     ||09771  |                Exit Function                     
09775  |            Else                                  ||09772  |            Else                                  
09776  |                dintAccCnt = gvlnDyDataN("ACC_CNT"||09773  |                dintAccCnt = gvlnDyDataN("ACC_CNT"
09777  |            End If                                ||09774  |            End If                                
09778  |            If dintAccCnt > 1 Then                ||09775  |            If dintAccCnt > 1 Then                
09779  |            Else                                  ||09776  |            Else                                  
09780  |                '締日の営業日チェック             ||09777  |                '締日の営業日チェック             
09781  |                If fnChkSettlementDate(mstrSettlem||09778  |                If fnChkSettlementDate(mstrSettlem
09782  |                    '顧問料計算開始日をチェック(顧||09779  |                    '顧問料計算開始日をチェック(顧
09783  |                    ComCalcStart = gbuMGetUPDRec.N||09780  |                    ComCalcStart = gbuMGetUPDRec.N
09784  |'2005/04/26 Start                                 ||09781  |'2005/04/26 Start                                 
09785  |                    ComCalcEnd = gbuMGetUPDRec.N(l||09782  |                    ComCalcEnd = gbuMGetUPDRec.N(l
09786  |'2005/04/26 End                                   ||09783  |'2005/04/26 End                                   
09787  |                    If mstrSettlementDate >= ComCa||09784  |                    If mstrSettlementDate >= ComCa
09788  |                        If mstrSettlementDate <> "||09785  |                        If mstrSettlementDate <> "
09789  |'2005/02/02 Start                                 ||09786  |'2005/02/02 Start                                 
09790  |'                            'グリッドの行カウンタ||09787  |'                            'グリッドの行カウンタ
09791  |'                            lRowCnt = lRowCnt + 1||09788  |'                            lRowCnt = lRowCnt + 1
09792  |'                            'グリッドにセット    ||09789  |'                            'グリッドにセット    
09793  |'                            Call sbMakePrintFlexG||09790  |'                            Call sbMakePrintFlexG
09794  |'2005/04/21 Start                                 ||09791  |'2005/04/21 Start                                 
09795  |'                            'ストアド呼び出し(有 ||09792  |'                            'ストアド呼び出し(有 
09796  |'                            sSql = ""            ||09793  |'                            sSql = ""            
09797  |''2005/02/03 Start                                ||09794  |''2005/02/03 Start                                
09798  |''                            sSql = sSql & "SELEC||09795  |''                            sSql = sSql & "SELEC
09799  |'                            sSql = sSql & "SELECT||09796  |'                            sSql = sSql & "SELECT
09800  |''2005/02/03 End                                  ||09797  |''2005/02/03 End                                  
09801  |'                            sSql = sSql & gbuMGet||09798  |'                            sSql = sSql & gbuMGet
09802  |''2005/02/07 Start                                ||09799  |''2005/02/07 Start                                
09803  |''                            sSql = sSql & gbuMGe||09800  |''                            sSql = sSql & gbuMGe
09804  |'                            sSql = sSql & mstrSet||09801  |'                            sSql = sSql & mstrSet
09805  |''2005/02/07 End                                  ||09802  |''2005/02/07 End                                  
09806  |'                            sSql = sSql & mstrbas||09803  |'                            sSql = sSql & mstrbas
09807  |'                            sSql = sSql & "FROM D||09804  |'                            sSql = sSql & "FROM D
09808  |'                            'ﾀﾞｲﾅｾｯﾄの作成       ||09805  |'                            'ﾀﾞｲﾅｾｯﾄの作成       
09809  |'                            If gintDyCreate(sSql)||09806  |'                            If gintDyCreate(sSql)
09810  |'                                Exit Function    ||09807  |'                                Exit Function    
09811  |'                            Else                 ||09808  |'                            Else                 
09812  |'                                If gvlnDyDataS("s||09809  |'                                If gvlnDyDataS("s
09813  |'                                And Len(gvlnDyDat||09810  |'                                And Len(gvlnDyDat
09814  |'                                '                ||09811  |'                                '                
09815  |'                                    dstrShimebi =||09812  |'                                    dstrShimebi =
09816  |''                                    'カレンダー ||09813  |''                                    'カレンダー 
09817  |''                                    sSql = gstrE||09814  |''                                    sSql = gstrE
09818  |''                                    'ﾀﾞｲﾅｾｯﾄの作||09815  |''                                    'ﾀﾞｲﾅｾｯﾄの作
09819  |''                                    If gintDyCre||09816  |''                                    If gintDyCre
09820  |''                                        Exit Fun||09817  |''                                        Exit Fun
09821  |''                                    End If      ||09818  |''                                    End If      
09822  |'                                    'グリッドの行||09819  |'                                    'グリッドの行
09823  |'                                    lRowCnt = lRo||09820  |'                                    lRowCnt = lRo
09824  |'                                    '前回締日営業||09821  |'                                    '前回締日営業
09825  |''                                    gbuMGetUPDRe||09822  |''                                    gbuMGetUPDRe
09826  |'                                    gbuMGetUPDRec||09823  |'                                    gbuMGetUPDRec
09827  |'                                    'グリッドにセ||09824  |'                                    'グリッドにセ
09828  |'                                    Call sbMakePr||09825  |'                                    Call sbMakePr
09829  |'                                Else             ||09826  |'                                Else             
09830  |'                                    '読み飛ばし  ||09827  |'                                    '読み飛ばし  
09831  |'                                End If           ||09828  |'                                End If           
09832  |'                            End If               ||09829  |'                            End If               
09833  |''2005/02/02 End                                  ||09830  |''2005/02/02 End                                  
09834  |                            'SQL文作成            ||09831  |                            'SQL文作成            
09835  |                            strCONTRACTNo = gbuMGe||09832  |                            strCONTRACTNo = gbuMGe
09836  |                                                  ||09833  |                                                  
09837  |'                            If strCONTRACTNo = "B||09834  |'                            If strCONTRACTNo = "B
09838  |'                            If strCONTRACTNo = "T||09835  |'                            If strCONTRACTNo = "T
09839  |'                            If strCONTRACTNo = "W||09836  |'                            If strCONTRACTNo = "W
09840  |'                                MsgBox strCONTRAC||09837  |'                                MsgBox strCONTRAC
09841  |'                            End If               ||09838  |'                            End If               
09842  |                                                  ||09839  |                                                  
09843  |                            If Mid(mstrSettlementD||09840  |                            If Mid(mstrSettlementD
09844  |                                mstrSettlementDate||09841  |                                mstrSettlementDate
09845  |                            End If                ||09842  |                            End If                
09846  |                            '外部委託顧問料締日テ ||09843  |                            '外部委託顧問料締日テ 
09847  |                            sSql = gstrEditSQLcfr_||09844  |                            sSql = gstrEditSQLcfr_
09848  |                                                  ||09845  |                                                  
09849  |                            'ﾀﾞｲﾅｾｯﾄの作成        ||09846  |                            'ﾀﾞｲﾅｾｯﾄの作成        
09850  |                            If (gintDyCreate(sSql)||09847  |                            If (gintDyCreate(sSql)
09851  |                                Call subError("DB ||09848  |                                Call subError("DB 
09852  |                                    "DB関数エラー"||09849  |                                    "DB関数エラー"
09853  |                                Exit Function     ||09850  |                                Exit Function     
09854  |                            End If                ||09851  |                            End If                
09855  |                                                  ||09852  |                                                  
09856  |                            '初期化               ||09853  |                            '初期化               
09857  |                            lRecCnt3 = 0          ||09854  |                            lRecCnt3 = 0          
09858  |                            lRecCnt2 = 0          ||09855  |                            lRecCnt2 = 0          
09859  |                            dstrSvDate = ""       ||09856  |                            dstrSvDate = ""       
09860  |                            dstrUseEnd = ""       ||09857  |                            dstrUseEnd = ""       
09861  |                            Call sbMgetSettlementD||09858  |                            Call sbMgetSettlementD
09862  |                                                  ||09859  |                                                  
09863  |                            'EOF判定処理          ||09860  |                            'EOF判定処理          
09864  |                            Do Until gblnDyEOF()  ||09861  |                            Do Until gblnDyEOF()  
09865  |                                '対象データ抽出し ||09862  |                                '対象データ抽出し 
09866  |                                Call sbMGetSettlem||09863  |                                Call sbMGetSettlem
09867  |                                Call sbMGetSettlem||09864  |                                Call sbMGetSettlem
09868  |                                If Len(gbuMGetSett||09865  |                                If Len(gbuMGetSett
09869  |                                    lRecCnt3 = lRe||09866  |                                    lRecCnt3 = lRe
09870  |                                End If            ||09867  |                                End If            
09871  |                                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ ||09868  |                                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ 
09872  |                                Call gDyNext      ||09869  |                                Call gDyNext      
09873  |                            Loop                  ||09870  |                            Loop                  
09874  |                                                  ||09871  |                                                  
09875  |                            '対象締日取得         ||09872  |                            '対象締日取得         
09876  |                            With gbuMGetSettlement||09873  |                            With gbuMGetSettlement
09877  |                                If lRecCnt3 > 1 _ ||09874  |                                If lRecCnt3 > 1 _ 
09878  |                                Or lRecCnt2 > 0 Th||09875  |                                Or lRecCnt2 > 0 Th
09879  |                                    For K = 0 To l||09876  |                                    For K = 0 To l
09880  |                                        If Mid(gbu||09877  |                                        If Mid(gbu
09881  |                                        Or Mid(Rep||09878  |                                        Or Mid(Rep
09882  |                                            If lRe||09879  |                                            If lRe
09883  |                                                Fo||09880  |                                                Fo
09884  |'2005/04/26 Start                                 ||09881  |'2005/04/26 Start                                 
09885  |                                                  ||09882  |                                                  
09886  |                                                  ||09883  |                                                  
09887  |                                                  ||09884  |                                                  
09888  |                                                  ||09885  |                                                  
09889  |                                                  ||09886  |                                                  
09890  |                                                  ||09887  |                                                  
09891  |                                                  ||09888  |                                                  
09892  |                                                  ||09889  |                                                  
09893  |                                                  ||09890  |                                                  
09894  |                                                  ||09891  |                                                  
09895  |'2005/04/26 End                                   ||09892  |'2005/04/26 End                                   
09896  |                                                  ||09893  |                                                  
09897  |                                                  ||09894  |                                                  
09898  |                                                  ||09895  |                                                  
09899  |                                                  ||09896  |                                                  
09900  |                                                  ||09897  |                                                  
09901  |                                                  ||09898  |                                                  
09902  |                                                  ||09899  |                                                  
09903  |                                                  ||09900  |                                                  
09904  |                                                  ||09901  |                                                  
09905  |                                                  ||09902  |                                                  
09906  |                                                  ||09903  |                                                  
09907  |                                                  ||09904  |                                                  
09908  |                                                  ||09905  |                                                  
09909  |                                                  ||09906  |                                                  
09910  |                                                  ||09907  |                                                  
09911  |                                                  ||09908  |                                                  
09912  |                                                  ||09909  |                                                  
09913  |                                                  ||09910  |                                                  
09914  |                                                  ||09911  |                                                  
09915  |                                                  ||09912  |                                                  
09916  |                                                  ||09913  |                                                  
09917  |                                                  ||09914  |                                                  
09918  |                                                  ||09915  |                                                  
09919  |                                                  ||09916  |                                                  
09920  |                                                  ||09917  |                                                  
09921  |                                                  ||09918  |                                                  
09922  |                                                  ||09919  |                                                  
09923  |                                                  ||09920  |                                                  
09924  |                                                  ||09921  |                                                  
09925  |                                                  ||09922  |                                                  
09926  |                                                Ne||09923  |                                                Ne
09927  |                                            Else  ||09924  |                                            Else  
09928  |                                            End If||09925  |                                            End If
09929  |                                            '前回 ||09926  |                                            '前回 
09930  |                                            For M ||09927  |                                            For M 
09931  |                                                If||09928  |                                                If
09932  |                                                An||09929  |                                                An
09933  |                                                El||09930  |                                                El
09934  |                                                  ||09931  |                                                  
09935  |                                                  ||09932  |                                                  
09936  |                                                  ||09933  |                                                  
09937  |                                                  ||09934  |                                                  
09938  |                                                  ||09935  |                                                  
09939  |                                                  ||09936  |                                                  
09940  |                                                  ||09937  |                                                  
09941  |                                                En||09938  |                                                En
09942  |                                                If||09939  |                                                If
09943  |                                                  ||09940  |                                                  
09944  |                                                  ||09941  |                                                  
09945  |                                                  ||09942  |                                                  
09946  |                                                  ||09943  |                                                  
09947  |                                                  ||09944  |                                                  
09948  |                                                  ||09945  |                                                  
09949  |                                                  ||09946  |                                                  
09950  |                                                  ||09947  |                                                  
09951  |                                                  ||09948  |                                                  
09952  |                                                  ||09949  |                                                  
09953  |                                                  ||09950  |                                                  
09954  |                                                  ||09951  |                                                  
09955  |                                                  ||09952  |                                                  
09956  |                                                  ||09953  |                                                  
09957  |                                                  ||09954  |                                                  
09958  |                                                  ||09955  |                                                  
09959  |                                                  ||09956  |                                                  
09960  |                                                  ||09957  |                                                  
09961  |                                                  ||09958  |                                                  
09962  |                                                  ||09959  |                                                  
09963  |                                                  ||09960  |                                                  
09964  |                                                  ||09961  |                                                  
09965  |                                                  ||09962  |                                                  
09966  |                                                  ||09963  |                                                  
09967  |                                                  ||09964  |                                                  
09968  |                                                  ||09965  |                                                  
09969  |                                                  ||09966  |                                                  
09970  |                                                  ||09967  |                                                  
09971  |                                                  ||09968  |                                                  
09972  |                                                  ||09969  |                                                  
09973  |                                                  ||09970  |                                                  
09974  |                                                  ||09971  |                                                  
09975  |                                                  ||09972  |                                                  
09976  |                                                  ||09973  |                                                  
09977  |                                                  ||09974  |                                                  
09978  |                                                  ||09975  |                                                  
09979  |                                                  ||09976  |                                                  
09980  |                                                  ||09977  |                                                  
09981  |                                                  ||09978  |                                                  
09982  |                                                  ||09979  |                                                  
09983  |                                                  ||09980  |                                                  
09984  |                                                  ||09981  |                                                  
09985  |                                                  ||09982  |                                                  
09986  |                                                  ||09983  |                                                  
09987  |                                                  ||09984  |                                                  
09988  |                                                  ||09985  |                                                  
09989  |                                                  ||09986  |                                                  
09990  |                                                  ||09987  |                                                  
09991  |                                                  ||09988  |                                                  
09992  |                                                  ||09989  |                                                  
09993  |                                                  ||09990  |                                                  
09994  |                                                  ||09991  |                                                  
09995  |                                                  ||09992  |                                                  
09996  |                                                  ||09993  |                                                  
09997  |                                                  ||09994  |                                                  
09998  |                                                  ||09995  |                                                  
09999  |                                                  ||09996  |                                                  
10000  |                                                  ||09997  |                                                  
10001  |                                                  ||09998  |                                                  
10002  |                                                  ||09999  |                                                  
10003  |                                                  ||10000  |                                                  
10004  |                                                  ||10001  |                                                  
10005  |                                                  ||10002  |                                                  
10006  |                                                  ||10003  |                                                  
10007  |                                                  ||10004  |                                                  
10008  |                                                  ||10005  |                                                  
10009  |                                                  ||10006  |                                                  
10010  |                                                  ||10007  |                                                  
10011  |                                                  ||10008  |                                                  
10012  |                                                  ||10009  |                                                  
10013  |                                                  ||10010  |                                                  
10014  |                                                  ||10011  |                                                  
10015  |                                                  ||10012  |                                                  
10016  |                                                  ||10013  |                                                  
10017  |                                                  ||10014  |                                                  
10018  |                                                  ||10015  |                                                  
10019  |                                                  ||10016  |                                                  
10020  |                                                  ||10017  |                                                  
10021  |                                                  ||10018  |                                                  
10022  |                                                  ||10019  |                                                  
10023  |                                                  ||10020  |                                                  
10024  |                                                  ||10021  |                                                  
10025  |                                                  ||10022  |                                                  
10026  |                                                  ||10023  |                                                  
10027  |                                                  ||10024  |                                                  
10028  |                                                  ||10025  |                                                  
10029  |                                                  ||10026  |                                                  
10030  |                                                  ||10027  |                                                  
10031  |                                                  ||10028  |                                                  
10032  |                                                  ||10029  |                                                  
10033  |                                                  ||10030  |                                                  
10034  |                                                  ||10031  |                                                  
10035  |                                                  ||10032  |                                                  
10036  |                                                  ||10033  |                                                  
10037  |                                                  ||10034  |                                                  
10038  |                                                  ||10035  |                                                  
10039  |                                                  ||10036  |                                                  
10040  |                                                  ||10037  |                                                  
10041  |                                                  ||10038  |                                                  
10042  |                                                  ||10039  |                                                  
10043  |                                                  ||10040  |                                                  
10044  |                                                  ||10041  |                                                  
10045  |                                                  ||10042  |                                                  
10046  |                                                  ||10043  |                                                  
10047  |                                                  ||10044  |                                                  
10048  |                                                  ||10045  |                                                  
10049  |                                                  ||10046  |                                                  
10050  |                                                  ||10047  |                                                  
10051  |                                                  ||10048  |                                                  
10052  |                                                  ||10049  |                                                  
10053  |                                                  ||10050  |                                                  
10054  |                                                  ||10051  |                                                  
10055  |                                                  ||10052  |                                                  
10056  |                                                  ||10053  |                                                  
10057  |                                                  ||10054  |                                                  
10058  |                                                  ||10055  |                                                  
10059  |                                                  ||10056  |                                                  
10060  |                                                  ||10057  |                                                  
10061  |                                                  ||10058  |                                                  
10062  |                                                  ||10059  |                                                  
10063  |                                                  ||10060  |                                                  
10064  |                                                  ||10061  |                                                  
10065  |                                                En||10062  |                                                En
10066  |                                            Next M||10063  |                                            Next M
10067  |                                            Exit F||10064  |                                            Exit F
10068  |                                        Else      ||10065  |                                        Else      
10069  |                                        End If    ||10066  |                                        End If    
10070  |                                    Next K        ||10067  |                                    Next K        
10071  |                                Else              ||10068  |                                Else              
10072  |                                    '締が年1回    ||10069  |                                    '締が年1回    
10073  |                                    If Mid(gbuMGet||10070  |                                    If Mid(gbuMGet
10074  |                                    Or Mid(Replace||10071  |                                    Or Mid(Replace
10075  |                                        If lRecCnt||10072  |                                        If lRecCnt
10076  |                                            If gbu||10073  |                                            If gbu
10077  |                                            And gb||10074  |                                            And gb
10078  |                                                If||10075  |                                                If
10079  |                                                  ||10076  |                                                  
10080  |                                                El||10077  |                                                El
10081  |                                                En||10078  |                                                En
10082  |                                            Else  ||10079  |                                            Else  
10083  |                                            End If||10080  |                                            End If
10084  |                                        Else      ||10081  |                                        Else      
10085  |                                        End If    ||10082  |                                        End If    
10086  |                                        '前回締日 ||10083  |                                        '前回締日 
10087  |                                        dstrWkDate||10084  |                                        dstrWkDate
10088  |                                        If fnChkSe||10085  |                                        If fnChkSe
10089  |                                            gbuMGe||10086  |                                            gbuMGe
10090  |                                        End If    ||10087  |                                        End If    
10091  |                                        If gbuMGet||10088  |                                        If gbuMGet
10092  |                                        Else      ||10089  |                                        Else      
10093  |                                            gbuMGe||10090  |                                            gbuMGe
10094  |                                        End If    ||10091  |                                        End If    
10095  |                                    End If        ||10092  |                                    End If        
10096  |                                End If            ||10093  |                                End If            
10097  |                            End With              ||10094  |                            End With              
10098  |'2005/04/26 Start                                 ||10095  |'2005/04/26 Start                                 
10099  |'                            gbuMGetUPDRec.N(lRecC||10096  |'                            gbuMGetUPDRec.N(lRecC
10100  |                            If ComCalcStart <> "" ||10097  |                            If ComCalcStart <> "" 
10101  |                                If ComCalcStart > ||10098  |                                If ComCalcStart > 
10102  |                                    gbuMGetUPDRec.||10099  |                                    gbuMGetUPDRec.
10103  |                                Else              ||10100  |                                Else              
10104  |                                    gbuMGetUPDRec.||10101  |                                    gbuMGetUPDRec.
10105  |                                End If            ||10102  |                                End If            
10106  |                                If dstrSvDate <> "||10103  |                                If dstrSvDate <> "
10107  |                                    If dstrSvDate ||10104  |                                    If dstrSvDate 
10108  |                                        gbuMGetUPD||10105  |                                        gbuMGetUPD
10109  |                                    End If        ||10106  |                                    End If        
10110  |                                End If            ||10107  |                                End If            
10111  |                                If dstrUseEnd <> "||10108  |                                If dstrUseEnd <> "
10112  |                                    If dstrUseEnd ||10109  |                                    If dstrUseEnd 
10113  |                                        gbuMGetUPD||10110  |                                        gbuMGetUPD
10114  |                                    End If        ||10111  |                                    End If        
10115  |                                End If            ||10112  |                                End If            
10116  |                            Else                  ||10113  |                            Else                  
10117  |                                gbuMGetUPDRec.N(lR||10114  |                                gbuMGetUPDRec.N(lR
10118  |                            End If                ||10115  |                            End If                
10119  |                            If ComCalcEnd <> "" Th||10116  |                            If ComCalcEnd <> "" Th
10120  |                                If ComCalcEnd < gb||10117  |                                If ComCalcEnd < gb
10121  |                                    gbuMGetUPDRec.||10118  |                                    gbuMGetUPDRec.
10122  |'2005/04/XX Start                                 ||10119  |'2005/04/XX Start                                 
10123  |                                Else              ||10120  |                                Else              
10124  |                                    If ComCalcEnd ||10121  |                                    If ComCalcEnd 
10125  |                                        dstrSvSett||10122  |                                        dstrSvSett
10126  |                                    End If        ||10123  |                                    End If        
10127  |'2005/04/XX End                                   ||10124  |'2005/04/XX End                                   
10128  |                                End If            ||10125  |                                End If            
10129  |                            End If                ||10126  |                            End If                
10130  |'2005/04/XX Start                                 ||10127  |'2005/04/XX Start                                 
10131  |                            If ComCalcStart <> "" ||10128  |                            If ComCalcStart <> "" 
10132  |                            And ComCalcEnd <> "" T||10129  |                            And ComCalcEnd <> "" T
10133  |                                If dstrSvSettlemen||10130  |                                If dstrSvSettlemen
10134  |                                And dstrSvSettleme||10131  |                                And dstrSvSettleme
10135  |                                Else              ||10132  |                                Else              
10136  |                                    GoTo NextData ||10133  |                                    GoTo NextData 
10137  |                                End If            ||10134  |                                End If            
10138  |                            End If                ||10135  |                            End If                
10139  |'2005/04/XX End                                   ||10136  |'2005/04/XX End                                   
10140  |'2005/04/26 End                                   ||10137  |'2005/04/26 End                                   
10141  |                            'グリッドの行カウンタ ||10138  |                            'グリッドの行カウンタ 
10142  |                            lRowCnt = lRowCnt + 1 ||10139  |                            lRowCnt = lRowCnt + 1 
10143  |                            'グリッドにセット     ||10140  |                            'グリッドにセット     
10144  |                            Call sbMakePrintFlexGr||10141  |                            Call sbMakePrintFlexGr
10145  |'2005/04/21 End                                   ||10142  |'2005/04/21 End                                   
10146  |                        End If                    ||10143  |                        End If                    
10147  |                    End If                        ||10144  |                    End If                        
10148  |                End If                            ||10145  |                End If                            
10149  |            End If                                ||10146  |            End If                                
10150  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||10147  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
10151  |            Call gblnDyClose                      ||10148  |            Call gblnDyClose                      
10152  |        Else                                      ||10149  |        Else                                      
10153  |                '締日の営業日チェック             ||10150  |                '締日の営業日チェック             
10154  |                If fnChkSettlementDate(mstrSettlem||10151  |                If fnChkSettlementDate(mstrSettlem
10155  |                    '顧問料計算開始日をチェック(顧||10152  |                    '顧問料計算開始日をチェック(顧
10156  |                    ComCalcStart = gbuMGetUPDRec.N||10153  |                    ComCalcStart = gbuMGetUPDRec.N
10157  |'2005/04/26 Start                                 ||10154  |'2005/04/26 Start                                 
10158  |                    ComCalcEnd = gbuMGetUPDRec.N(l||10155  |                    ComCalcEnd = gbuMGetUPDRec.N(l
10159  |'2005/04/26 End                                   ||10156  |'2005/04/26 End                                   
10160  |                    If mstrSettlementDate >= ComCa||10157  |                    If mstrSettlementDate >= ComCa
10161  |                        If mstrSettlementDate <> "||10158  |                        If mstrSettlementDate <> "
10162  |'2005/02/02 Start                                 ||10159  |'2005/02/02 Start                                 
10163  |'                            'グリッドの行カウンタ||10160  |'                            'グリッドの行カウンタ
10164  |'                            lRowCnt = lRowCnt + 1||10161  |'                            lRowCnt = lRowCnt + 1
10165  |'                            'グリッドにセット    ||10162  |'                            'グリッドにセット    
10166  |'                            Call sbMakePrintFlexG||10163  |'                            Call sbMakePrintFlexG
10167  |'2005/04/21 Start                                 ||10164  |'2005/04/21 Start                                 
10168  |'                            'ストアド呼び出し(有 ||10165  |'                            'ストアド呼び出し(有 
10169  |'                            sSql = ""            ||10166  |'                            sSql = ""            
10170  |''2005/02/03 Start                                ||10167  |''2005/02/03 Start                                
10171  |''                            sSql = sSql & "SELEC||10168  |''                            sSql = sSql & "SELEC
10172  |'                            sSql = sSql & "SELECT||10169  |'                            sSql = sSql & "SELECT
10173  |''2005/02/03 End                                  ||10170  |''2005/02/03 End                                  
10174  |'                            sSql = sSql & gbuMGet||10171  |'                            sSql = sSql & gbuMGet
10175  |''2005/02/07 Start                                ||10172  |''2005/02/07 Start                                
10176  |''                            sSql = sSql & gbuMGe||10173  |''                            sSql = sSql & gbuMGe
10177  |'                            sSql = sSql & mstrSet||10174  |'                            sSql = sSql & mstrSet
10178  |''2005/02/07 End                                  ||10175  |''2005/02/07 End                                  
10179  |'                            sSql = sSql & mstrbas||10176  |'                            sSql = sSql & mstrbas
10180  |'                            sSql = sSql & "FROM D||10177  |'                            sSql = sSql & "FROM D
10181  |'                            'ﾀﾞｲﾅｾｯﾄの作成       ||10178  |'                            'ﾀﾞｲﾅｾｯﾄの作成       
10182  |'                            If gintDyCreate(sSql)||10179  |'                            If gintDyCreate(sSql)
10183  |'                                Exit Function    ||10180  |'                                Exit Function    
10184  |'                            Else                 ||10181  |'                            Else                 
10185  |'                                If gvlnDyDataS("s||10182  |'                                If gvlnDyDataS("s
10186  |'                                And Len(gvlnDyDat||10183  |'                                And Len(gvlnDyDat
10187  |'                                '                ||10184  |'                                '                
10188  |'                                    dstrShimebi =||10185  |'                                    dstrShimebi =
10189  |''                                    'カレンダー ||10186  |''                                    'カレンダー 
10190  |''                                    sSql = gstrE||10187  |''                                    sSql = gstrE
10191  |''                                    'ﾀﾞｲﾅｾｯﾄの作||10188  |''                                    'ﾀﾞｲﾅｾｯﾄの作
10192  |''                                    If gintDyCre||10189  |''                                    If gintDyCre
10193  |''                                        Exit Fun||10190  |''                                        Exit Fun
10194  |''                                    End If      ||10191  |''                                    End If      
10195  |'                                    'グリッドの行||10192  |'                                    'グリッドの行
10196  |'                                    lRowCnt = lRo||10193  |'                                    lRowCnt = lRo
10197  |'                                    '前回締日営業||10194  |'                                    '前回締日営業
10198  |''                                    gbuMGetUPDRe||10195  |''                                    gbuMGetUPDRe
10199  |'                                    gbuMGetUPDRec||10196  |'                                    gbuMGetUPDRec
10200  |'                                    'グリッドにセ||10197  |'                                    'グリッドにセ
10201  |'                                    Call sbMakePr||10198  |'                                    Call sbMakePr
10202  |'                                Else             ||10199  |'                                Else             
10203  |'                                    '読み飛ばし  ||10200  |'                                    '読み飛ばし  
10204  |'                                End If           ||10201  |'                                End If           
10205  |'                            End If               ||10202  |'                            End If               
10206  |''2005/02/02 End                                  ||10203  |''2005/02/02 End                                  
10207  |                            'SQL文作成            ||10204  |                            'SQL文作成            
10208  |                            strCONTRACTNo = gbuMGe||10205  |                            strCONTRACTNo = gbuMGe
10209  |                                                  ||10206  |                                                  
10210  |'                            If strCONTRACTNo = "B||10207  |'                            If strCONTRACTNo = "B
10211  |'                            If strCONTRACTNo = "T||10208  |'                            If strCONTRACTNo = "T
10212  |'                            If strCONTRACTNo = "W||10209  |'                            If strCONTRACTNo = "W
10213  |'                                MsgBox strCONTRAC||10210  |'                                MsgBox strCONTRAC
10214  |'                            End If               ||10211  |'                            End If               
10215  |                                                  ||10212  |                                                  
10216  |                            If Mid(mstrSettlementD||10213  |                            If Mid(mstrSettlementD
10217  |                                mstrSettlementDate||10214  |                                mstrSettlementDate
10218  |                            End If                ||10215  |                            End If                
10219  |                            '外部委託顧問料締日テ ||10216  |                            '外部委託顧問料締日テ 
10220  |                            sSql = gstrEditSQLcfr_||10217  |                            sSql = gstrEditSQLcfr_
10221  |                                                  ||10218  |                                                  
10222  |                            'ﾀﾞｲﾅｾｯﾄの作成        ||10219  |                            'ﾀﾞｲﾅｾｯﾄの作成        
10223  |                            If (gintDyCreate(sSql)||10220  |                            If (gintDyCreate(sSql)
10224  |                                Call subError("DB ||10221  |                                Call subError("DB 
10225  |                                    "DB関数エラー"||10222  |                                    "DB関数エラー"
10226  |                                Exit Function     ||10223  |                                Exit Function     
10227  |                            End If                ||10224  |                            End If                
10228  |                                                  ||10225  |                                                  
10229  |                            '初期化               ||10226  |                            '初期化               
10230  |                            lRecCnt3 = 0          ||10227  |                            lRecCnt3 = 0          
10231  |                            lRecCnt2 = 0          ||10228  |                            lRecCnt2 = 0          
10232  |                            dstrSvDate = ""       ||10229  |                            dstrSvDate = ""       
10233  |                            dstrUseEnd = ""       ||10230  |                            dstrUseEnd = ""       
10234  |                            Call sbMgetSettlementD||10231  |                            Call sbMgetSettlementD
10235  |                                                  ||10232  |                                                  
10236  |                            'EOF判定処理          ||10233  |                            'EOF判定処理          
10237  |                            Do Until gblnDyEOF()  ||10234  |                            Do Until gblnDyEOF()  
10238  |                                '対象データ抽出し ||10235  |                                '対象データ抽出し 
10239  |                                Call sbMGetSettlem||10236  |                                Call sbMGetSettlem
10240  |                                Call sbMGetSettlem||10237  |                                Call sbMGetSettlem
10241  |                                If Len(gbuMGetSett||10238  |                                If Len(gbuMGetSett
10242  |                                    lRecCnt3 = lRe||10239  |                                    lRecCnt3 = lRe
10243  |                                End If            ||10240  |                                End If            
10244  |                                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ ||10241  |                                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ 
10245  |                                Call gDyNext      ||10242  |                                Call gDyNext      
10246  |                            Loop                  ||10243  |                            Loop                  
10247  |                                                  ||10244  |                                                  
10248  |                            '対象締日取得         ||10245  |                            '対象締日取得         
10249  |                            With gbuMGetSettlement||10246  |                            With gbuMGetSettlement
10250  |                                If lRecCnt3 > 1 _ ||10247  |                                If lRecCnt3 > 1 _ 
10251  |                                Or lRecCnt2 > 0 Th||10248  |                                Or lRecCnt2 > 0 Th
10252  |                                    For K = 0 To l||10249  |                                    For K = 0 To l
10253  |                                        If Mid(gbu||10250  |                                        If Mid(gbu
10254  |                                        Or Mid(Rep||10251  |                                        Or Mid(Rep
10255  |                                            If lRe||10252  |                                            If lRe
10256  |                                                Fo||10253  |                                                Fo
10257  |'2005/04/26 Start                                 ||10254  |'2005/04/26 Start                                 
10258  |                                                  ||10255  |                                                  
10259  |                                                  ||10256  |                                                  
10260  |                                                  ||10257  |                                                  
10261  |                                                  ||10258  |                                                  
10262  |                                                  ||10259  |                                                  
10263  |                                                  ||10260  |                                                  
10264  |                                                  ||10261  |                                                  
10265  |                                                  ||10262  |                                                  
10266  |                                                  ||10263  |                                                  
10267  |                                                  ||10264  |                                                  
10268  |'2005/04/26 End                                   ||10265  |'2005/04/26 End                                   
10269  |                                                  ||10266  |                                                  
10270  |                                                  ||10267  |                                                  
10271  |                                                  ||10268  |                                                  
10272  |                                                  ||10269  |                                                  
10273  |                                                  ||10270  |                                                  
10274  |                                                  ||10271  |                                                  
10275  |                                                  ||10272  |                                                  
10276  |                                                  ||10273  |                                                  
10277  |                                                  ||10274  |                                                  
10278  |                                                  ||10275  |                                                  
10279  |                                                  ||10276  |                                                  
10280  |                                                  ||10277  |                                                  
10281  |                                                  ||10278  |                                                  
10282  |                                                  ||10279  |                                                  
10283  |                                                  ||10280  |                                                  
10284  |                                                  ||10281  |                                                  
10285  |                                                  ||10282  |                                                  
10286  |                                                  ||10283  |                                                  
10287  |                                                  ||10284  |                                                  
10288  |                                                  ||10285  |                                                  
10289  |                                                  ||10286  |                                                  
10290  |                                                  ||10287  |                                                  
10291  |                                                  ||10288  |                                                  
10292  |                                                  ||10289  |                                                  
10293  |                                                  ||10290  |                                                  
10294  |                                                  ||10291  |                                                  
10295  |                                                  ||10292  |                                                  
10296  |                                                  ||10293  |                                                  
10297  |                                                  ||10294  |                                                  
10298  |                                                  ||10295  |                                                  
10299  |                                                Ne||10296  |                                                Ne
10300  |                                            Else  ||10297  |                                            Else  
10301  |                                            End If||10298  |                                            End If
10302  |                                            '前回 ||10299  |                                            '前回 
10303  |                                            For M ||10300  |                                            For M 
10304  |                                                If||10301  |                                                If
10305  |                                                An||10302  |                                                An
10306  |                                                El||10303  |                                                El
10307  |                                                  ||10304  |                                                  
10308  |                                                  ||10305  |                                                  
10309  |                                                  ||10306  |                                                  
10310  |                                                  ||10307  |                                                  
10311  |                                                  ||10308  |                                                  
10312  |                                                  ||10309  |                                                  
10313  |                                                  ||10310  |                                                  
10314  |                                                En||10311  |                                                En
10315  |                                                If||10312  |                                                If
10316  |                                                  ||10313  |                                                  
10317  |                                                  ||10314  |                                                  
10318  |                                                  ||10315  |                                                  
10319  |                                                  ||10316  |                                                  
10320  |                                                  ||10317  |                                                  
10321  |                                                  ||10318  |                                                  
10322  |                                                  ||10319  |                                                  
10323  |                                                  ||10320  |                                                  
10324  |                                                  ||10321  |                                                  
10325  |                                                  ||10322  |                                                  
10326  |                                                  ||10323  |                                                  
10327  |                                                  ||10324  |                                                  
10328  |                                                  ||10325  |                                                  
10329  |                                                  ||10326  |                                                  
10330  |                                                  ||10327  |                                                  
10331  |                                                  ||10328  |                                                  
10332  |                                                  ||10329  |                                                  
10333  |                                                  ||10330  |                                                  
10334  |                                                  ||10331  |                                                  
10335  |                                                  ||10332  |                                                  
10336  |                                                  ||10333  |                                                  
10337  |                                                  ||10334  |                                                  
10338  |                                                  ||10335  |                                                  
10339  |                                                  ||10336  |                                                  
10340  |                                                  ||10337  |                                                  
10341  |                                                  ||10338  |                                                  
10342  |                                                  ||10339  |                                                  
10343  |                                                  ||10340  |                                                  
10344  |                                                  ||10341  |                                                  
10345  |                                                  ||10342  |                                                  
10346  |                                                  ||10343  |                                                  
10347  |                                                  ||10344  |                                                  
10348  |                                                  ||10345  |                                                  
10349  |                                                  ||10346  |                                                  
10350  |                                                  ||10347  |                                                  
10351  |                                                  ||10348  |                                                  
10352  |                                                  ||10349  |                                                  
10353  |                                                  ||10350  |                                                  
10354  |                                                  ||10351  |                                                  
10355  |                                                  ||10352  |                                                  
10356  |                                                  ||10353  |                                                  
10357  |                                                  ||10354  |                                                  
10358  |                                                  ||10355  |                                                  
10359  |                                                  ||10356  |                                                  
10360  |                                                  ||10357  |                                                  
10361  |                                                  ||10358  |                                                  
10362  |                                                  ||10359  |                                                  
10363  |                                                  ||10360  |                                                  
10364  |                                                  ||10361  |                                                  
10365  |                                                  ||10362  |                                                  
10366  |                                                  ||10363  |                                                  
10367  |                                                  ||10364  |                                                  
10368  |                                                  ||10365  |                                                  
10369  |                                                  ||10366  |                                                  
10370  |                                                  ||10367  |                                                  
10371  |                                                  ||10368  |                                                  
10372  |                                                  ||10369  |                                                  
10373  |                                                  ||10370  |                                                  
10374  |                                                  ||10371  |                                                  
10375  |                                                  ||10372  |                                                  
10376  |                                                  ||10373  |                                                  
10377  |                                                  ||10374  |                                                  
10378  |                                                  ||10375  |                                                  
10379  |                                                  ||10376  |                                                  
10380  |                                                  ||10377  |                                                  
10381  |                                                  ||10378  |                                                  
10382  |                                                  ||10379  |                                                  
10383  |                                                  ||10380  |                                                  
10384  |                                                  ||10381  |                                                  
10385  |                                                  ||10382  |                                                  
10386  |                                                  ||10383  |                                                  
10387  |                                                  ||10384  |                                                  
10388  |                                                  ||10385  |                                                  
10389  |                                                  ||10386  |                                                  
10390  |                                                  ||10387  |                                                  
10391  |                                                  ||10388  |                                                  
10392  |                                                  ||10389  |                                                  
10393  |                                                  ||10390  |                                                  
10394  |                                                  ||10391  |                                                  
10395  |                                                  ||10392  |                                                  
10396  |                                                  ||10393  |                                                  
10397  |                                                  ||10394  |                                                  
10398  |                                                  ||10395  |                                                  
10399  |                                                  ||10396  |                                                  
10400  |                                                  ||10397  |                                                  
10401  |                                                  ||10398  |                                                  
10402  |                                                  ||10399  |                                                  
10403  |                                                  ||10400  |                                                  
10404  |                                                  ||10401  |                                                  
10405  |                                                  ||10402  |                                                  
10406  |                                                  ||10403  |                                                  
10407  |                                                  ||10404  |                                                  
10408  |                                                  ||10405  |                                                  
10409  |                                                  ||10406  |                                                  
10410  |                                                  ||10407  |                                                  
10411  |                                                  ||10408  |                                                  
10412  |                                                  ||10409  |                                                  
10413  |                                                  ||10410  |                                                  
10414  |                                                  ||10411  |                                                  
10415  |                                                  ||10412  |                                                  
10416  |                                                  ||10413  |                                                  
10417  |                                                  ||10414  |                                                  
10418  |                                                  ||10415  |                                                  
10419  |                                                  ||10416  |                                                  
10420  |                                                  ||10417  |                                                  
10421  |                                                  ||10418  |                                                  
10422  |                                                  ||10419  |                                                  
10423  |                                                  ||10420  |                                                  
10424  |                                                  ||10421  |                                                  
10425  |                                                  ||10422  |                                                  
10426  |                                                  ||10423  |                                                  
10427  |                                                  ||10424  |                                                  
10428  |                                                  ||10425  |                                                  
10429  |                                                  ||10426  |                                                  
10430  |                                                  ||10427  |                                                  
10431  |                                                  ||10428  |                                                  
10432  |                                                  ||10429  |                                                  
10433  |                                                  ||10430  |                                                  
10434  |                                                  ||10431  |                                                  
10435  |                                                  ||10432  |                                                  
10436  |                                                  ||10433  |                                                  
10437  |                                                  ||10434  |                                                  
10438  |                                                En||10435  |                                                En
10439  |                                            Next M||10436  |                                            Next M
10440  |                                            Exit F||10437  |                                            Exit F
10441  |                                        Else      ||10438  |                                        Else      
10442  |                                        End If    ||10439  |                                        End If    
10443  |                                    Next K        ||10440  |                                    Next K        
10444  |                                Else              ||10441  |                                Else              
10445  |                                    '締が年1回    ||10442  |                                    '締が年1回    
10446  |                                    If Mid(gbuMGet||10443  |                                    If Mid(gbuMGet
10447  |                                    Or Mid(Replace||10444  |                                    Or Mid(Replace
10448  |                                        If lRecCnt||10445  |                                        If lRecCnt
10449  |                                            If gbu||10446  |                                            If gbu
10450  |                                            And gb||10447  |                                            And gb
10451  |                                                If||10448  |                                                If
10452  |                                                  ||10449  |                                                  
10453  |                                                El||10450  |                                                El
10454  |                                                En||10451  |                                                En
10455  |                                            Else  ||10452  |                                            Else  
10456  |                                            End If||10453  |                                            End If
10457  |                                        Else      ||10454  |                                        Else      
10458  |                                        End If    ||10455  |                                        End If    
10459  |                                        '前回締日 ||10456  |                                        '前回締日 
10460  |                                        dstrWkDate||10457  |                                        dstrWkDate
10461  |                                        If fnChkSe||10458  |                                        If fnChkSe
10462  |                                            gbuMGe||10459  |                                            gbuMGe
10463  |                                        End If    ||10460  |                                        End If    
10464  |                                        If gbuMGet||10461  |                                        If gbuMGet
10465  |                                        Else      ||10462  |                                        Else      
10466  |                                            gbuMGe||10463  |                                            gbuMGe
10467  |                                        End If    ||10464  |                                        End If    
10468  |                                    End If        ||10465  |                                    End If        
10469  |                                End If            ||10466  |                                End If            
10470  |                            End With              ||10467  |                            End With              
10471  |'2005/04/26 Start                                 ||10468  |'2005/04/26 Start                                 
10472  |'                            gbuMGetUPDRec.N(lRecC||10469  |'                            gbuMGetUPDRec.N(lRecC
10473  |                            If ComCalcStart <> "" ||10470  |                            If ComCalcStart <> "" 
10474  |                                If ComCalcStart > ||10471  |                                If ComCalcStart > 
10475  |                                    gbuMGetUPDRec.||10472  |                                    gbuMGetUPDRec.
10476  |                                Else              ||10473  |                                Else              
10477  |                                    gbuMGetUPDRec.||10474  |                                    gbuMGetUPDRec.
10478  |                                End If            ||10475  |                                End If            
10479  |                                If dstrSvDate <> "||10476  |                                If dstrSvDate <> "
10480  |                                    If dstrSvDate ||10477  |                                    If dstrSvDate 
10481  |                                        gbuMGetUPD||10478  |                                        gbuMGetUPD
10482  |                                    End If        ||10479  |                                    End If        
10483  |                                End If            ||10480  |                                End If            
10484  |                                If dstrUseEnd <> "||10481  |                                If dstrUseEnd <> "
10485  |                                    If dstrUseEnd ||10482  |                                    If dstrUseEnd 
10486  |                                        gbuMGetUPD||10483  |                                        gbuMGetUPD
10487  |                                    End If        ||10484  |                                    End If        
10488  |                                End If            ||10485  |                                End If            
10489  |                            Else                  ||10486  |                            Else                  
10490  |                                gbuMGetUPDRec.N(lR||10487  |                                gbuMGetUPDRec.N(lR
10491  |                            End If                ||10488  |                            End If                
10492  |                            If ComCalcEnd <> "" Th||10489  |                            If ComCalcEnd <> "" Th
10493  |                                If ComCalcEnd < gb||10490  |                                If ComCalcEnd < gb
10494  |                                    gbuMGetUPDRec.||10491  |                                    gbuMGetUPDRec.
10495  |'2005/04/XX Start                                 ||10492  |'2005/04/XX Start                                 
10496  |                                Else              ||10493  |                                Else              
10497  |                                    If ComCalcEnd ||10494  |                                    If ComCalcEnd 
10498  |                                        dstrSvSett||10495  |                                        dstrSvSett
10499  |                                    End If        ||10496  |                                    End If        
10500  |'2005/04/XX End                                   ||10497  |'2005/04/XX End                                   
10501  |                                End If            ||10498  |                                End If            
10502  |                            End If                ||10499  |                            End If                
10503  |'2005/04/XX Start                                 ||10500  |'2005/04/XX Start                                 
10504  |                            If ComCalcStart <> "" ||10501  |                            If ComCalcStart <> "" 
10505  |                            And ComCalcEnd <> "" T||10502  |                            And ComCalcEnd <> "" T
10506  |                                If dstrSvSettlemen||10503  |                                If dstrSvSettlemen
10507  |                                And dstrSvSettleme||10504  |                                And dstrSvSettleme
10508  |                                Else              ||10505  |                                Else              
10509  |                                    GoTo NextData ||10506  |                                    GoTo NextData 
10510  |                                End If            ||10507  |                                End If            
10511  |                            End If                ||10508  |                            End If                
10512  |'2005/04/XX End                                   ||10509  |'2005/04/XX End                                   
10513  |'2005/04/26 End                                   ||10510  |'2005/04/26 End                                   
10514  |                            'グリッドの行カウンタ ||10511  |                            'グリッドの行カウンタ 
10515  |                            lRowCnt = lRowCnt + 1 ||10512  |                            lRowCnt = lRowCnt + 1 
10516  |                            'グリッドにセット     ||10513  |                            'グリッドにセット     
10517  |                            Call sbMakePrintFlexGr||10514  |                            Call sbMakePrintFlexGr
10518  |'2005/04/21 End                                   ||10515  |'2005/04/21 End                                   
10519  |                        End If                    ||10516  |                        End If                    
10520  |'2005/04/XX Start                                 ||10517  |'2005/04/XX Start                                 
10521  |                    Else                          ||10518  |                    Else                          
10522  |                        If ComCalcEnd <> "" Then  ||10519  |                        If ComCalcEnd <> "" Then  
10523  |'                            If strCONTRACTNo = "W||10520  |'                            If strCONTRACTNo = "W
10524  |'                                MsgBox strCONTRAC||10521  |'                                MsgBox strCONTRAC
10525  |'                            End If               ||10522  |'                            End If               
10526  |                            '通常締日件数チェック ||10523  |                            '通常締日件数チェック 
10527  |                            If lCnt > 1 Then      ||10524  |                            If lCnt > 1 Then      
10528  |                            Else                  ||10525  |                            Else                  
10529  |                                dstrSvSettlementDa||10526  |                                dstrSvSettlementDa
10530  |                                gbuMGetUPDRec.N(lR||10527  |                                gbuMGetUPDRec.N(lR
10531  |                                'グリッドの行カウ ||10528  |                                'グリッドの行カウ 
10532  |                                lRowCnt = lRowCnt ||10529  |                                lRowCnt = lRowCnt 
10533  |                                'グリッドにセット ||10530  |                                'グリッドにセット 
10534  |                                Call sbMakePrintFl||10531  |                                Call sbMakePrintFl
10535  |                            End If                ||10532  |                            End If                
10536  |                        End If                    ||10533  |                        End If                    
10537  |'2005/04/XX End                                   ||10534  |'2005/04/XX End                                   
10538  |                    End If                        ||10535  |                    End If                        
10539  |                End If                            ||10536  |                End If                            
10540  |        End If                                    ||10537  |        End If                                    
10541  |'2005/01/18 End                                   ||10538  |'2005/01/18 End                                   
10542  |'        End If                                   ||10539  |'        End If                                   
10543  |'2005/04/21 Start                                 ||10540  |'2005/04/21 Start                                 
10544  |NextData:                                         ||10541  |NextData:                                         
10545  |'2005/04/21 End                                   ||10542  |'2005/04/21 End                                   
10546  |    Next lRecCnt                                  ||10543  |    Next lRecCnt                                  
10547  |                                                  ||10544  |                                                  
10548  |    With fgridMakePrint                           ||10545  |    With fgridMakePrint                           
10549  |        '抽出０件の場合は出力ボタンを無効にする   ||10546  |        '抽出０件の場合は出力ボタンを無効にする   
10550  |        If lRowCnt = 0 Then                       ||10547  |        If lRowCnt = 0 Then                       
10551  |            cmdMake.Enabled = False               ||10548  |            cmdMake.Enabled = False               
10552  |            iRet = MsgBox("出力情報がありません。"||10549  |            iRet = MsgBox("出力情報がありません。"
10553  |            .Editable = flexEDNone        'グリッ ||10550  |            .Editable = flexEDNone        'グリッ 
10554  |        Else                                      ||10551  |        Else                                      
10555  |            cmdMake.Enabled = True                ||10552  |            cmdMake.Enabled = True                
10556  |            .Editable = flexEDKbdMouse    'グリッ ||10553  |            .Editable = flexEDKbdMouse    'グリッ 
10557  |            .Select 1, 0                          ||10554  |            .Select 1, 0                          
10558  |        End If                                    ||10555  |        End If                                    
10559  |                                                  ||10556  |                                                  
10560  |        'スクロールバー表示・非表示設定           ||10557  |        'スクロールバー表示・非表示設定           
10561  |        If lRowCnt < 16 Then                      ||10558  |        If lRowCnt < 16 Then                      
10562  |            .Left = .Left + 120                   ||10559  |            .Left = .Left + 120                   
10563  |            .Width = .Width - 240                 ||10560  |            .Width = .Width - 240                 
10564  |        End If                                    ||10561  |        End If                                    
10565  |                                                  ||10562  |                                                  
10566  |        If lRowCnt > 1 Then                       ||10563  |        If lRowCnt > 1 Then                       
10567  |            '表示行設定                           ||10564  |            '表示行設定                           
10568  |            .TopRow = lActiveIdx                  ||10565  |            .TopRow = lActiveIdx                  
10569  |            lActiveIdx = lActiveIdx + 1           ||10566  |            lActiveIdx = lActiveIdx + 1           
10570  |            .Row = lActiveIdx                     ||10567  |            .Row = lActiveIdx                     
10571  |        End If                                    ||10568  |        End If                                    
10572  |                                                  ||10569  |                                                  
10573  |        'グリッド表示                             ||10570  |        'グリッド表示                             
10574  |        .Visible = True                           ||10571  |        .Visible = True                           
10575  |    End With                                      ||10572  |    End With                                      
10576  |                                                  ||10573  |                                                  
10577  |    '戻り値セット                                 ||10574  |    '戻り値セット                                 
10578  |    fnMakePrintDataSet = True                     ||10575  |    fnMakePrintDataSet = True                     
10579  |                                                  ||10576  |                                                  
10580  |End Function                                      ||10577  |End Function                                      
10581  |                                                  ||10578  |                                                  
10582  |'=================================================||10579  |'=================================================
10583  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMakePrintFlexGridDataSet   ||10580  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMakePrintFlexGridDataSet   
10584  |'機能            :   オラクル抽出結果をMakePrintFl||10581  |'機能            :   オラクル抽出結果をMakePrintFl
10585  |'                                                 ||10582  |'                                                 
10586  |'日付               担当　              修正内容  ||10583  |'日付               担当　              修正内容  
10587  |'-------------------------------------------------||10584  |'-------------------------------------------------
10588  |'2004/08/06         M.Katoh<SRA>       新規作成   ||10585  |'2004/08/06         M.Katoh<SRA>       新規作成   
10589  |'2004/12/29         M.Yamazaki<SRA>    NAV取得区分||10586  |'2004/12/29         M.Yamazaki<SRA>    NAV取得区分
10590  |'2005/01/11         M.Yamazaki<SRA>    列追加     ||10587  |'2005/01/11         M.Yamazaki<SRA>    列追加     
10591  |'2005/01/14         M.Yamazaki<SRA>    各通貨(NAV ||10588  |'2005/01/14         M.Yamazaki<SRA>    各通貨(NAV 
10592  |'2005/01/17         M.Yamazaki<SRA>    列追加をせ ||10589  |'2005/01/17         M.Yamazaki<SRA>    列追加をせ 
10593  |'2005/02/02         M.Yamazaki<SRA>    前回締日営 ||10590  |'2005/02/02         M.Yamazaki<SRA>    前回締日営 
10594  |'2005/03/09         M.Yamazaki<SRA>    消費税計算 ||10591  |'2005/03/09         M.Yamazaki<SRA>    消費税計算 
10595  |'2005/04/22         M.Yamazaki<SRA>    重複データ ||10592  |'2005/04/22         M.Yamazaki<SRA>    重複データ 
10596  |'2005/07/25         K.Nishihama<SRA>   英文チェッ ||10593  |'2005/07/25         K.Nishihama<SRA>   英文チェッ 
10597  |'2005/08/04         K.Nishihama<SRA>   契約名[英],||10594  |'2005/08/04         K.Nishihama<SRA>   契約名[英],
10598  |'2006/05/29         K.Furuya<SRA>      外部委託顧 ||10595  |'2006/05/29         K.Furuya<SRA>      外部委託顧 
10599  |'2008/03/12         K.Furuya<SRA>      ファンド決 ||10596  |'2008/03/12         K.Furuya<SRA>      ファンド決 
10600  |'=================================================||10597  |'=================================================
10601  |Private Sub sbMakePrintFlexGridDataSet( _         ||10598  |Private Sub sbMakePrintFlexGridDataSet( _         
10602  |    ByVal lRow As Long, _                         ||10599  |    ByVal lRow As Long, _                         
10603  |    ByVal lArrayCnt As Long _                     ||10600  |    ByVal lArrayCnt As Long _                     
10604  |)                                                 ||10601  |)                                                 
10605  |                                                  ||10602  |                                                  
10606  |    Dim iIdx            As Integer                ||10603  |    Dim iIdx            As Integer                
10607  |    Dim sStr            As String                 ||10604  |    Dim sStr            As String                 
10608  |'2005/04/22 Start                                 ||10605  |'2005/04/22 Start                                 
10609  |    Dim dstrContno      As String                 ||10606  |    Dim dstrContno      As String                 
10610  |    Dim dstrSettdate    As String                 ||10607  |    Dim dstrSettdate    As String                 
10611  |    Dim dstrAccountcd   As String                 ||10608  |    Dim dstrAccountcd   As String                 
10612  |'2005/04/22 End                                   ||10609  |'2005/04/22 End                                   
10613  |'2006/05/29 START K.Furuya RAFI対応               ||10610  |'2006/05/29 START K.Furuya RAFI対応               
10614  |    Dim strCode         As String                 ||10611  |    Dim strCode         As String                 
10615  |'2006/05/29 END   K.Furuya RAFI対応               ||10612  |'2006/05/29 END   K.Furuya RAFI対応               
10616  |                                                  ||10613  |                                                  
10617  |                                                  ||10614  |                                                  
10618  |    '列ｲﾝﾃﾞｯｸｽ初期化                              ||10615  |    '列ｲﾝﾃﾞｯｸｽ初期化                              
10619  |    iIdx = 0                                      ||10616  |    iIdx = 0                                      
10620  |                                                  ||10617  |                                                  
10621  |    With fgridMakePrint                           ||10618  |    With fgridMakePrint                           
10622  |                                                  ||10619  |                                                  
10623  |'2005/04/22 Start                                 ||10620  |'2005/04/22 Start                                 
10624  |        If lRow > 1 Then                          ||10621  |        If lRow > 1 Then                          
10625  |            '前行を指定                           ||10622  |            '前行を指定                           
10626  |            lRow = lRow - 1                       ||10623  |            lRow = lRow - 1                       
10627  |            .Col = 2                              ||10624  |            .Col = 2                              
10628  |            dstrContno = .Text                    ||10625  |            dstrContno = .Text                    
10629  |            .Col = 6                              ||10626  |            .Col = 6                              
10630  |            dstrSettdate = Replace(.Text, "/", "")||10627  |            dstrSettdate = Replace(.Text, "/", "")
10631  |            .Col = 7                              ||10628  |            .Col = 7                              
10632  |            dstrAccountcd = .Text                 ||10629  |            dstrAccountcd = .Text                 
10633  |            If dstrContno = gbuMGetUPDRec.N(lArray||10630  |            If dstrContno = gbuMGetUPDRec.N(lArray
10634  |            And dstrSettdate = dstrSvSettlementDat||10631  |            And dstrSettdate = dstrSvSettlementDat
10635  |            And dstrAccountcd = gbuMGetUPDRec.N(lA||10632  |            And dstrAccountcd = gbuMGetUPDRec.N(lA
10636  |                lRowCnt = lRowCnt - 1             ||10633  |                lRowCnt = lRowCnt - 1             
10637  |                Exit Sub                          ||10634  |                Exit Sub                          
10638  |            End If                                ||10635  |            End If                                
10639  |            '行を戻す                             ||10636  |            '行を戻す                             
10640  |            lRow = lRow + 1                       ||10637  |            lRow = lRow + 1                       
10641  |        End If                                    ||10638  |        End If                                    
10642  |'2005/04/22 End                                   ||10639  |'2005/04/22 End                                   
10643  |                                                  ||10640  |                                                  
10644  |        '最終行を設定                             ||10641  |        '最終行を設定                             
10645  |        .Rows = lRow + 1                          ||10642  |        .Rows = lRow + 1                          
10646  |        '行を指定                                 ||10643  |        '行を指定                                 
10647  |        .Row = lRow                               ||10644  |        .Row = lRow                               
10648  |                                                  ||10645  |                                                  
10649  |        '出力                                     ||10646  |        '出力                                     
10650  |        iIdx = iIdx + 1                           ||10647  |        iIdx = iIdx + 1                           
10651  |        .Col = iIdx: .Text = 0                    ||10648  |        .Col = iIdx: .Text = 0                    
10652  |                                                  ||10649  |                                                  
10653  |'2005/07/25 Start                                 ||10650  |'2005/07/25 Start                                 
10654  |        '英文                                     ||10651  |        '英文                                     
10655  |        iIdx = iIdx + 1                           ||10652  |        iIdx = iIdx + 1                           
10656  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10653  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10657  |'2005/07/25 End                                   ||10654  |'2005/07/25 End                                   
10658  |                                                  ||10655  |                                                  
10659  |        '契約番号                                 ||10656  |        '契約番号                                 
10660  |        iIdx = iIdx + 1                           ||10657  |        iIdx = iIdx + 1                           
10661  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10658  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10662  |        '契約名                                   ||10659  |        '契約名                                   
10663  |        iIdx = iIdx + 1                           ||10660  |        iIdx = iIdx + 1                           
10664  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10661  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10665  |                                                  ||10662  |                                                  
10666  |'2005/08/04 Start                                 ||10663  |'2005/08/04 Start                                 
10667  |        '契約名[英]                               ||10664  |        '契約名[英]                               
10668  |        iIdx = iIdx + 1                           ||10665  |        iIdx = iIdx + 1                           
10669  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10666  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10670  |'2005/08/04 End                                   ||10667  |'2005/08/04 End                                   
10671  |                                                  ||10668  |                                                  
10672  |        '契約区分                                 ||10669  |        '契約区分                                 
10673  |        iIdx = iIdx + 1                           ||10670  |        iIdx = iIdx + 1                           
10674  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10671  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10675  |                                                  ||10672  |                                                  
10676  |'2006/05/29 START K.Furuya RAFI対応(INIファイル取 ||10673  |'2006/05/29 START K.Furuya RAFI対応(INIファイル取 
10677  |'        Select Case .Text                        ||10674  |'        Select Case .Text                        
10678  |'            Case 1  '投信外部委託顧問料計算      ||10675  |'            Case 1  '投信外部委託顧問料計算      
10679  |'                .Text = mstrContractFlag(1)      ||10676  |'                .Text = mstrContractFlag(1)      
10680  |'            Case 2  '業務サービス計算            ||10677  |'            Case 2  '業務サービス計算            
10681  |'                .Text = mstrContractFlag(2)      ||10678  |'                .Text = mstrContractFlag(2)      
10682  |'            Case 3  '名称使用許諾料計算          ||10679  |'            Case 3  '名称使用許諾料計算          
10683  |'                .Text = mstrContractFlag(3)      ||10680  |'                .Text = mstrContractFlag(3)      
10684  |'                                                 ||10681  |'                                                 
10685  |''2005/03/09 Start                                ||10682  |''2005/03/09 Start                                
10686  |''            Case 4  '業務サービス料(外貨)       ||10683  |''            Case 4  '業務サービス料(外貨)       
10687  |''                .Text = mstrContractFlag(4)     ||10684  |''                .Text = mstrContractFlag(4)     
10688  |''2005/03/09 End                                  ||10685  |''2005/03/09 End                                  
10689  |'        End Select                               ||10686  |'        End Select                               
10690  |        strCode = .Text                           ||10687  |        strCode = .Text                           
10691  |        .Text = gstrConstNameGet(CONTRACT_FLAG, st||10688  |        .Text = gstrConstNameGet(CONTRACT_FLAG, st
10692  |'2006/05/29 END   K.Furuya RAFI対応               ||10689  |'2006/05/29 END   K.Furuya RAFI対応               
10693  |                                                  ||10690  |                                                  
10694  |        '締日営業日翌日                           ||10691  |        '締日営業日翌日                           
10695  |        iIdx = iIdx + 1                           ||10692  |        iIdx = iIdx + 1                           
10696  |        sStr = gbuMGetUPDRec.N(lArrayCnt).MGET_set||10693  |        sStr = gbuMGetUPDRec.N(lArrayCnt).MGET_set
10697  |        If Len(sStr) = 4 Then                     ||10694  |        If Len(sStr) = 4 Then                     
10698  |            sStr = Mid(sStr, 1, 2) & "/" & Mid(sSt||10695  |            sStr = Mid(sStr, 1, 2) & "/" & Mid(sSt
10699  |        End If                                    ||10696  |        End If                                    
10700  |        .Col = iIdx: .Text = sStr                 ||10697  |        .Col = iIdx: .Text = sStr                 
10701  |        '締日                                     ||10698  |        '締日                                     
10702  |        iIdx = iIdx + 1                           ||10699  |        iIdx = iIdx + 1                           
10703  |        sStr = gbuMGetUPDRec.N(lArrayCnt).MGET_set||10700  |        sStr = gbuMGetUPDRec.N(lArrayCnt).MGET_set
10704  |        If Len(sStr) = 8 Then                     ||10701  |        If Len(sStr) = 8 Then                     
10705  |            sStr = Mid(sStr, 1, 4) & "/" & Mid(sSt||10702  |            sStr = Mid(sStr, 1, 4) & "/" & Mid(sSt
10706  |        End If                                    ||10703  |        End If                                    
10707  |        .Col = iIdx: .Text = sStr                 ||10704  |        .Col = iIdx: .Text = sStr                 
10708  |        '口座コード                               ||10705  |        '口座コード                               
10709  |        iIdx = iIdx + 1                           ||10706  |        iIdx = iIdx + 1                           
10710  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10707  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10711  |        '口座名                                   ||10708  |        '口座名                                   
10712  |        iIdx = iIdx + 1                           ||10709  |        iIdx = iIdx + 1                           
10713  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10710  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10714  |        '通貨コード                               ||10711  |        '通貨コード                               
10715  |        iIdx = iIdx + 1                           ||10712  |        iIdx = iIdx + 1                           
10716  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10713  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10717  |        '適用開始日                               ||10714  |        '適用開始日                               
10718  |        iIdx = iIdx + 1                           ||10715  |        iIdx = iIdx + 1                           
10719  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10716  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10720  |        '適用終了日                               ||10717  |        '適用終了日                               
10721  |        iIdx = iIdx + 1                           ||10718  |        iIdx = iIdx + 1                           
10722  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10719  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10723  |        '運用会社コード                           ||10720  |        '運用会社コード                           
10724  |        iIdx = iIdx + 1                           ||10721  |        iIdx = iIdx + 1                           
10725  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10722  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10726  |        '運用会社名                               ||10723  |        '運用会社名                               
10727  |        iIdx = iIdx + 1                           ||10724  |        iIdx = iIdx + 1                           
10728  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10725  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10729  |                                                  ||10726  |                                                  
10730  |'2005/08/04 Start                                 ||10727  |'2005/08/04 Start                                 
10731  |        '運用会社名[英]                           ||10728  |        '運用会社名[英]                           
10732  |        iIdx = iIdx + 1                           ||10729  |        iIdx = iIdx + 1                           
10733  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10730  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10734  |'2005/08/04 End                                   ||10731  |'2005/08/04 End                                   
10735  |                                                  ||10732  |                                                  
10736  |        'ルールNo                                 ||10733  |        'ルールNo                                 
10737  |        iIdx = iIdx + 1                           ||10734  |        iIdx = iIdx + 1                           
10738  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10735  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10739  |        '料率区分                                 ||10736  |        '料率区分                                 
10740  |        iIdx = iIdx + 1                           ||10737  |        iIdx = iIdx + 1                           
10741  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10738  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10742  |'2004/12/29 Start                                 ||10739  |'2004/12/29 Start                                 
10743  |        'NAV取得区分                              ||10740  |        'NAV取得区分                              
10744  |        iIdx = iIdx + 1                           ||10741  |        iIdx = iIdx + 1                           
10745  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10742  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10746  |        '上限金額                                 ||10743  |        '上限金額                                 
10747  |                                                  ||10744  |                                                  
10748  |        iIdx = iIdx + 1                           ||10745  |        iIdx = iIdx + 1                           
10749  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10746  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10750  |        '下限金額                                 ||10747  |        '下限金額                                 
10751  |        iIdx = iIdx + 1                           ||10748  |        iIdx = iIdx + 1                           
10752  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10749  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10753  |'2004/12/29 End                                   ||10750  |'2004/12/29 End                                   
10754  |        '支払予定日                               ||10751  |        '支払予定日                               
10755  |        iIdx = iIdx + 1                           ||10752  |        iIdx = iIdx + 1                           
10756  |        .Col = iIdx: .Text = ""                   ||10753  |        .Col = iIdx: .Text = ""                   
10757  |'2005/01/11 Start                                 ||10754  |'2005/01/11 Start                                 
10758  |        'NAV通貨                                  ||10755  |        'NAV通貨                                  
10759  |        iIdx = iIdx + 1                           ||10756  |        iIdx = iIdx + 1                           
10760  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10757  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10761  |        '閾値通貨                                 ||10758  |        '閾値通貨                                 
10762  |        iIdx = iIdx + 1                           ||10759  |        iIdx = iIdx + 1                           
10763  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10760  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10764  |        '顧問料通貨                               ||10761  |        '顧問料通貨                               
10765  |        iIdx = iIdx + 1                           ||10762  |        iIdx = iIdx + 1                           
10766  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10763  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10767  |'2005/01/17 Start                                 ||10764  |'2005/01/17 Start                                 
10768  |'        'NAV通貨→閾値通貨換算レート             ||10765  |'        'NAV通貨→閾値通貨換算レート             
10769  |'        iIdx = iIdx + 1                          ||10766  |'        iIdx = iIdx + 1                          
10770  |'        .Col = iIdx: .Text = ""                  ||10767  |'        .Col = iIdx: .Text = ""                  
10771  |'        'NAV通貨→顧問料通貨換算レート           ||10768  |'        'NAV通貨→顧問料通貨換算レート           
10772  |'        iIdx = iIdx + 1                          ||10769  |'        iIdx = iIdx + 1                          
10773  |'        .Col = iIdx: .Text = ""                  ||10770  |'        .Col = iIdx: .Text = ""                  
10774  |'        '閾値通貨→顧問料通貨換算レート          ||10771  |'        '閾値通貨→顧問料通貨換算レート          
10775  |'        iIdx = iIdx + 1                          ||10772  |'        iIdx = iIdx + 1                          
10776  |'        .Col = iIdx: .Text = ""                  ||10773  |'        .Col = iIdx: .Text = ""                  
10777  |'        '顧問料レート→支払(円)換算レート        ||10774  |'        '顧問料レート→支払(円)換算レート        
10778  |'        iIdx = iIdx + 1                          ||10775  |'        iIdx = iIdx + 1                          
10779  |'        .Col = iIdx: .Text = ""                  ||10776  |'        .Col = iIdx: .Text = ""                  
10780  |'2005/01/17 End                                   ||10777  |'2005/01/17 End                                   
10781  |        '一年間の日数                             ||10778  |        '一年間の日数                             
10782  |        iIdx = iIdx + 1                           ||10779  |        iIdx = iIdx + 1                           
10783  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10780  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10784  |'2005/01/11 End                                   ||10781  |'2005/01/11 End                                   
10785  |'2005/03/09 Start                                 ||10782  |'2005/03/09 Start                                 
10786  |        '消費税計算有無                           ||10783  |        '消費税計算有無                           
10787  |        iIdx = iIdx + 1                           ||10784  |        iIdx = iIdx + 1                           
10788  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10785  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10789  |'2005/03/09 End                                   ||10786  |'2005/03/09 End                                   
10790  |'2008/03/12 START ファンド決算期間での外部委託顧問||10787  |'2008/03/12 START ファンド決算期間での外部委託顧問
10791  |        'ファンド計算FROM                         ||10788  |        'ファンド計算FROM                         
10792  |        iIdx = iIdx + 1                           ||10789  |        iIdx = iIdx + 1                           
10793  |        .Col = iIdx: .Text = ""                   ||10790  |        .Col = iIdx: .Text = ""                   
10794  |        'ファンド計算TO                           ||10791  |        'ファンド計算TO                           
10795  |        iIdx = iIdx + 1                           ||10792  |        iIdx = iIdx + 1                           
10796  |        .Col = iIdx: .Text = ""                   ||10793  |        .Col = iIdx: .Text = ""                   
10797  |'2008/03/12 END   ファンド決算期間での外部委託顧問||10794  |'2008/03/12 END   ファンド決算期間での外部委託顧問
10798  |                                                  ||10795  |                                                  
10799  |                                                  ||10796  |                                                  
10800  |''debug                                           ||10797  |''debug                                           
10801  |'        .Col = iIdx: .Text = Date   '←リリース時||10798  |'        .Col = iIdx: .Text = Date   '←リリース時
10802  |                                                  ||10799  |                                                  
10803  |        If (lRow > 0) Then                        ||10800  |        If (lRow > 0) Then                        
10804  |            .Cell(flexcpBackColor, 1, conColSysOut||10801  |            .Cell(flexcpBackColor, 1, conColSysOut
10805  |            .Cell(flexcpBackColor, 1, conColPayMen||10802  |            .Cell(flexcpBackColor, 1, conColPayMen
10806  |'2008/03/12 START ファンド決算期間での外部委託顧問||10803  |'2008/03/12 START ファンド決算期間での外部委託顧問
10807  |            .Cell(flexcpBackColor, 1, conColFndCal||10804  |            .Cell(flexcpBackColor, 1, conColFndCal
10808  |            .Cell(flexcpBackColor, 1, conColFndCal||10805  |            .Cell(flexcpBackColor, 1, conColFndCal
10809  |'2008/03/12 END   ファンド決算期間での外部委託顧問||10806  |'2008/03/12 END   ファンド決算期間での外部委託顧問
10810  |                                                  ||10807  |                                                  
10811  |'2005/01/17 Start                                 ||10808  |'2005/01/17 Start                                 
10812  |''2005/01/11 Start                                ||10809  |''2005/01/11 Start                                
10813  |'            .Cell(flexcpBackColor, 1, conColNavAm||10810  |'            .Cell(flexcpBackColor, 1, conColNavAm
10814  |'            .Cell(flexcpBackColor, 1, conColNavCo||10811  |'            .Cell(flexcpBackColor, 1, conColNavCo
10815  |'            .Cell(flexcpBackColor, 1, conColAmoun||10812  |'            .Cell(flexcpBackColor, 1, conColAmoun
10816  |'            .Cell(flexcpBackColor, 1, conColComPa||10813  |'            .Cell(flexcpBackColor, 1, conColComPa
10817  |''2005/01/11 End                                  ||10814  |''2005/01/11 End                                  
10818  |''2005/01/14 Start                                ||10815  |''2005/01/14 Start                                
10819  |'            'NAV通貨 VS. 閾値通貨 初期値設定(NAV ||10816  |'            'NAV通貨 VS. 閾値通貨 初期値設定(NAV 
10820  |'            If fgridMakePrint.Cell(flexcpText, lR||10817  |'            If fgridMakePrint.Cell(flexcpText, lR
10821  |'                fgridMakePrint.Cell(flexcpText, l||10818  |'                fgridMakePrint.Cell(flexcpText, l
10822  |'            End If                               ||10819  |'            End If                               
10823  |'            'NAV通貨 VS. 外部委託顧問料通貨 初期 ||10820  |'            'NAV通貨 VS. 外部委託顧問料通貨 初期 
10824  |'            If fgridMakePrint.Cell(flexcpText, lR||10821  |'            If fgridMakePrint.Cell(flexcpText, lR
10825  |'                fgridMakePrint.Cell(flexcpText, l||10822  |'                fgridMakePrint.Cell(flexcpText, l
10826  |'            End If                               ||10823  |'            End If                               
10827  |'            '閾値通貨 VS. 外部委託顧問料通貨 初期||10824  |'            '閾値通貨 VS. 外部委託顧問料通貨 初期
10828  |'            If fgridMakePrint.Cell(flexcpText, lR||10825  |'            If fgridMakePrint.Cell(flexcpText, lR
10829  |'                fgridMakePrint.Cell(flexcpText, l||10826  |'                fgridMakePrint.Cell(flexcpText, l
10830  |'            End If                               ||10827  |'            End If                               
10831  |'            '外部委託顧問料通貨 VS. 支払通貨('JPY||10828  |'            '外部委託顧問料通貨 VS. 支払通貨('JPY
10832  |'            If fgridMakePrint.Cell(flexcpText, lR||10829  |'            If fgridMakePrint.Cell(flexcpText, lR
10833  |'                fgridMakePrint.Cell(flexcpText, l||10830  |'                fgridMakePrint.Cell(flexcpText, l
10834  |'            End If                               ||10831  |'            End If                               
10835  |''2005/01/14 End                                  ||10832  |''2005/01/14 End                                  
10836  |'2005/01/17 End                                   ||10833  |'2005/01/17 End                                   
10837  |        End If                                    ||10834  |        End If                                    
10838  |                                                  ||10835  |                                                  
10839  |    End With                                      ||10836  |    End With                                      
10840  |                                                  ||10837  |                                                  
10841  |End Sub                                           ||10838  |End Sub                                           
10842  |                                                  ||10839  |                                                  
10843  |'=================================================||10840  |'=================================================
10844  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnNyuryokuCheck              ||10841  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnNyuryokuCheck              
10845  |'機能            :   確認書作成画面入力データチェ ||10842  |'機能            :   確認書作成画面入力データチェ 
10846  |'                                                 ||10843  |'                                                 
10847  |'日付               担当　              修正内容  ||10844  |'日付               担当　              修正内容  
10848  |'-------------------------------------------------||10845  |'-------------------------------------------------
10849  |'2004/08/06         M.Katoh<SRA>       新規作成   ||10846  |'2004/08/06         M.Katoh<SRA>       新規作成   
10850  |'2005/01/11         M.Yamazaki<SRA>    変更可能列 ||10847  |'2005/01/11         M.Yamazaki<SRA>    変更可能列 
10851  |'2005/01/17         M.Yamazaki<SRA>    変更可能列 ||10848  |'2005/01/17         M.Yamazaki<SRA>    変更可能列 
10852  |'2008/03/12         K.Furuya<SRA>      ファンド決 ||10849  |'2008/03/12         K.Furuya<SRA>      ファンド決 
10853  |'=================================================||10850  |'=================================================
10854  |Private Function fnNyuryokuCheck() As Boolean     ||10851  |Private Function fnNyuryokuCheck() As Boolean     
10855  |                                                  ||10852  |                                                  
10856  |    Dim Cnt As Integer                            ||10853  |    Dim Cnt As Integer                            
10857  |'2008/03/12 START ファンド決算期間での外部委託顧問||10854  |'2008/03/12 START ファンド決算期間での外部委託顧問
10858  |    Dim strCalcFrom     As String  'ファンド計算FR||10855  |    Dim strCalcFrom     As String  'ファンド計算FR
10859  |    Dim strCalcTo       As String  'ファンド計算TO||10856  |    Dim strCalcTo       As String  'ファンド計算TO
10860  |'2008/03/12 END   ファンド決算期間での外部委託顧問||10857  |'2008/03/12 END   ファンド決算期間での外部委託顧問
10861  |                                                  ||10858  |                                                  
10862  |    '戻り値初期化                                 ||10859  |    '戻り値初期化                                 
10863  |    fnNyuryokuCheck = False                       ||10860  |    fnNyuryokuCheck = False                       
10864  |    gSysoutDataCnt = 0                            ||10861  |    gSysoutDataCnt = 0                            
10865  |                                                  ||10862  |                                                  
10866  |'2008/03/12 START ファンド決算期間での外部委託顧問||10863  |'2008/03/12 START ファンド決算期間での外部委託顧問
10867  |    '変数初期化                                   ||10864  |    '変数初期化                                   
10868  |    strCalcFrom = ""                              ||10865  |    strCalcFrom = ""                              
10869  |    strCalcTo = ""                                ||10866  |    strCalcTo = ""                                
10870  |'2008/03/12 END   ファンド決算期間での外部委託顧問||10867  |'2008/03/12 END   ファンド決算期間での外部委託顧問
10871  |                                                  ||10868  |                                                  
10872  |    '担当者                                       ||10869  |    '担当者                                       
10873  |    If gblnCheckNull(txtInputName) = False Then Ex||10870  |    If gblnCheckNull(txtInputName) = False Then Ex
10874  |    '部署名                                       ||10871  |    '部署名                                       
10875  |    If gblnCheckCombo(cboBumonFlag) = False Then E||10872  |    If gblnCheckCombo(cboBumonFlag) = False Then E
10876  |                                                  ||10873  |                                                  
10877  |    '支払予定日チェック                           ||10874  |    '支払予定日チェック                           
10878  |    With fgridMakePrint                           ||10875  |    With fgridMakePrint                           
10879  |'        For Cnt = LBound(gbuMGetUPDRec.N) To UBou||10876  |'        For Cnt = LBound(gbuMGetUPDRec.N) To UBou
10880  |        For Cnt = 1 To .Rows - 1                  ||10877  |        For Cnt = 1 To .Rows - 1                  
10881  |            .Col = conColSysOutbln                ||10878  |            .Col = conColSysOutbln                
10882  |            .Row = Cnt                            ||10879  |            .Row = Cnt                            
10883  |            If .Text = True Then                  ||10880  |            If .Text = True Then                  
10884  |                '出力データ数カウント             ||10881  |                '出力データ数カウント             
10885  |                gSysoutDataCnt = gSysoutDataCnt + ||10882  |                gSysoutDataCnt = gSysoutDataCnt + 
10886  |                '支払予定日をセット               ||10883  |                '支払予定日をセット               
10887  |                .Col = conColPayMentDate          ||10884  |                .Col = conColPayMentDate          
10888  |                If .Text = "" Then                ||10885  |                If .Text = "" Then                
10889  |                    .BackColorSel = COLOR_ERR     ||10886  |                    .BackColorSel = COLOR_ERR     
10890  |                    MsgBox "支払予定日を入力してく||10887  |                    MsgBox "支払予定日を入力してく
10891  |                    Exit Function                 ||10888  |                    Exit Function                 
10892  |                Else                              ||10889  |                Else                              
10893  |                    If IsDate(.Text) = False Then ||10890  |                    If IsDate(.Text) = False Then 
10894  |                        .BackColorSel = COLOR_ERR ||10891  |                        .BackColorSel = COLOR_ERR 
10895  |                        MsgBox "支払予定日の入力が||10892  |                        MsgBox "支払予定日の入力が
10896  |                        Exit Function             ||10893  |                        Exit Function             
10897  |                    Else                          ||10894  |                    Else                          
10898  |                        .BackColorSel = COLOR_CHG_||10895  |                        .BackColorSel = COLOR_CHG_
10899  |                    End If                        ||10896  |                    End If                        
10900  |                End If                            ||10897  |                End If                            
10901  |'2008/03/12 START ファンド決算期間での外部委託顧問||10898  |'2008/03/12 START ファンド決算期間での外部委託顧問
10902  |                'ファンド計算FROMをセット         ||10899  |                'ファンド計算FROMをセット         
10903  |                .Col = conColFndCalcFrom          ||10900  |                .Col = conColFndCalcFrom          
10904  |                strCalcFrom = .Text               ||10901  |                strCalcFrom = .Text               
10905  |                'ファンド計算TOをセット           ||10902  |                'ファンド計算TOをセット           
10906  |                .Col = conColFndCalcTo            ||10903  |                .Col = conColFndCalcTo            
10907  |                strCalcTo = .Text                 ||10904  |                strCalcTo = .Text                 
10908  |                'FROMとTOのどちらかに入力があれば ||10905  |                'FROMとTOのどちらかに入力があれば 
10909  |                If strCalcFrom <> "" Or strCalcTo ||10906  |                If strCalcFrom <> "" Or strCalcTo 
10910  |                    'FROMが未入力の場合キャンセル ||10907  |                    'FROMが未入力の場合キャンセル 
10911  |                    If strCalcFrom = "" Then      ||10908  |                    If strCalcFrom = "" Then      
10912  |                        .Col = conColFndCalcFrom  ||10909  |                        .Col = conColFndCalcFrom  
10913  |                        .BackColorSel = COLOR_ERR ||10910  |                        .BackColorSel = COLOR_ERR 
10914  |                        MsgBox "ファンド計算FROMを||10911  |                        MsgBox "ファンド計算FROMを
10915  |                        Exit Function             ||10912  |                        Exit Function             
10916  |                    ElseIf strCalcTo = "" Then    ||10913  |                    ElseIf strCalcTo = "" Then    
10917  |                        .Col = conColFndCalcTo    ||10914  |                        .Col = conColFndCalcTo    
10918  |                        .BackColorSel = COLOR_ERR ||10915  |                        .BackColorSel = COLOR_ERR 
10919  |                        MsgBox "ファンド計算TOを入||10916  |                        MsgBox "ファンド計算TOを入
10920  |                        Exit Function             ||10917  |                        Exit Function             
10921  |                    Else                          ||10918  |                    Else                          
10922  |                        'FROMの入力値の整合性をチ ||10919  |                        'FROMの入力値の整合性をチ 
10923  |                        If IsDate(strCalcFrom) = F||10920  |                        If IsDate(strCalcFrom) = F
10924  |                            .Col = conColFndCalcFr||10921  |                            .Col = conColFndCalcFr
10925  |                            .BackColorSel = COLOR_||10922  |                            .BackColorSel = COLOR_
10926  |                            MsgBox "ファンド計算FR||10923  |                            MsgBox "ファンド計算FR
10927  |                            Exit Function         ||10924  |                            Exit Function         
10928  |                        Else                      ||10925  |                        Else                      
10929  |                            .Col = conColFndCalcFr||10926  |                            .Col = conColFndCalcFr
10930  |                            .BackColorSel = COLOR_||10927  |                            .BackColorSel = COLOR_
10931  |                        End If                    ||10928  |                        End If                    
10932  |                        'TOの入力値の整合性をチェ ||10929  |                        'TOの入力値の整合性をチェ 
10933  |                        If IsDate(strCalcTo) = Fal||10930  |                        If IsDate(strCalcTo) = Fal
10934  |                            .Col = conColFndCalcTo||10931  |                            .Col = conColFndCalcTo
10935  |                            .BackColorSel = COLOR_||10932  |                            .BackColorSel = COLOR_
10936  |                            MsgBox "ファンド計算TO||10933  |                            MsgBox "ファンド計算TO
10937  |                            Exit Function         ||10934  |                            Exit Function         
10938  |                        Else                      ||10935  |                        Else                      
10939  |                            .Col = conColFndCalcTo||10936  |                            .Col = conColFndCalcTo
10940  |                            .BackColorSel = COLOR_||10937  |                            .BackColorSel = COLOR_
10941  |                        End If                    ||10938  |                        End If                    
10942  |                        'FROM > TO の入力チェック ||10939  |                        'FROM > TO の入力チェック 
10943  |                        If CDate(strCalcFrom) > CD||10940  |                        If CDate(strCalcFrom) > CD
10944  |                            .Col = conColFndCalcTo||10941  |                            .Col = conColFndCalcTo
10945  |                            .BackColorSel = COLOR_||10942  |                            .BackColorSel = COLOR_
10946  |                            MsgBox "ファンド計算TO||10943  |                            MsgBox "ファンド計算TO
10947  |                            Exit Function         ||10944  |                            Exit Function         
10948  |                        Else                      ||10945  |                        Else                      
10949  |                            .Col = conColFndCalcTo||10946  |                            .Col = conColFndCalcTo
10950  |                            .BackColorSel = COLOR_||10947  |                            .BackColorSel = COLOR_
10951  |                        End If                    ||10948  |                        End If                    
10952  |                    End If                        ||10949  |                    End If                        
10953  |                End If                            ||10950  |                End If                            
10954  |'2008/03/12 END   ファンド決算期間での外部委託顧問||10951  |'2008/03/12 END   ファンド決算期間での外部委託顧問
10955  |                                                  ||10952  |                                                  
10956  |'2005/01/17 Start                                 ||10953  |'2005/01/17 Start                                 
10957  |''2005/01/11 Start                                ||10954  |''2005/01/11 Start                                
10958  |'                'NAV通貨→閾値通貨換算レートをセ ||10955  |'                'NAV通貨→閾値通貨換算レートをセ 
10959  |'                .Col = conColOtherRateRuleFlag   ||10956  |'                .Col = conColOtherRateRuleFlag   
10960  |'                If .Text = "2" Then              ||10957  |'                If .Text = "2" Then              
10961  |'                    .Col = conColNavAmount       ||10958  |'                    .Col = conColNavAmount       
10962  |'                    If .Text = "" Then           ||10959  |'                    If .Text = "" Then           
10963  |'                        .BackColorSel = COLOR_ERR||10960  |'                        .BackColorSel = COLOR_ERR
10964  |'                        MsgBox "NAV通貨→閾値通貨||10961  |'                        MsgBox "NAV通貨→閾値通貨
10965  |'                        Exit Function            ||10962  |'                        Exit Function            
10966  |'                    Else                         ||10963  |'                    Else                         
10967  |'                        If IsNumeric(.Text) = Fal||10964  |'                        If IsNumeric(.Text) = Fal
10968  |'                            .BackColorSel = COLOR||10965  |'                            .BackColorSel = COLOR
10969  |'                            MsgBox "NAV通貨→閾値||10966  |'                            MsgBox "NAV通貨→閾値
10970  |'                            Exit Function        ||10967  |'                            Exit Function        
10971  |'                        Else                     ||10968  |'                        Else                     
10972  |'                            .BackColorSel = COLOR||10969  |'                            .BackColorSel = COLOR
10973  |'                        End If                   ||10970  |'                        End If                   
10974  |'                    End If                       ||10971  |'                    End If                       
10975  |'                End If                           ||10972  |'                End If                           
10976  |'                'NAV通貨→顧問料通貨換算レートを ||10973  |'                'NAV通貨→顧問料通貨換算レートを 
10977  |'                .Col = conColNavCom              ||10974  |'                .Col = conColNavCom              
10978  |'                If .Text = "" Then               ||10975  |'                If .Text = "" Then               
10979  |'                    .BackColorSel = COLOR_ERR    ||10976  |'                    .BackColorSel = COLOR_ERR    
10980  |'                    MsgBox "NAV通貨→顧問料通貨換||10977  |'                    MsgBox "NAV通貨→顧問料通貨換
10981  |'                    Exit Function                ||10978  |'                    Exit Function                
10982  |'                Else                             ||10979  |'                Else                             
10983  |'                    If IsNumeric(.Text) = False T||10980  |'                    If IsNumeric(.Text) = False T
10984  |'                        .BackColorSel = COLOR_ERR||10981  |'                        .BackColorSel = COLOR_ERR
10985  |'                        MsgBox "NAV通貨→顧問料通||10982  |'                        MsgBox "NAV通貨→顧問料通
10986  |'                        Exit Function            ||10983  |'                        Exit Function            
10987  |'                    Else                         ||10984  |'                    Else                         
10988  |'                        .BackColorSel = COLOR_CHG||10985  |'                        .BackColorSel = COLOR_CHG
10989  |'                    End If                       ||10986  |'                    End If                       
10990  |'                End If                           ||10987  |'                End If                           
10991  |'                '閾値通貨→顧問料通貨換算レートを||10988  |'                '閾値通貨→顧問料通貨換算レートを
10992  |'                .Col = conColOtherRateRuleFlag   ||10989  |'                .Col = conColOtherRateRuleFlag   
10993  |'                If .Text = "2" Then              ||10990  |'                If .Text = "2" Then              
10994  |'                    .Col = conColAmountCom       ||10991  |'                    .Col = conColAmountCom       
10995  |'                    If .Text = "" Then           ||10992  |'                    If .Text = "" Then           
10996  |'                        .BackColorSel = COLOR_ERR||10993  |'                        .BackColorSel = COLOR_ERR
10997  |'                        MsgBox "閾値通貨→顧問料 ||10994  |'                        MsgBox "閾値通貨→顧問料 
10998  |'                        Exit Function            ||10995  |'                        Exit Function            
10999  |'                    Else                         ||10996  |'                    Else                         
11000  |'                        If IsNumeric(.Text) = Fal||10997  |'                        If IsNumeric(.Text) = Fal
11001  |'                            .BackColorSel = COLOR||10998  |'                            .BackColorSel = COLOR
11002  |'                            MsgBox "閾値通貨→顧 ||10999  |'                            MsgBox "閾値通貨→顧 
11003  |'                            Exit Function        ||11000  |'                            Exit Function        
11004  |'                        Else                     ||11001  |'                        Else                     
11005  |'                            .BackColorSel = COLOR||11002  |'                            .BackColorSel = COLOR
11006  |'                        End If                   ||11003  |'                        End If                   
11007  |'                    End If                       ||11004  |'                    End If                       
11008  |'                End If                           ||11005  |'                End If                           
11009  |'                '顧問料レート→支払(円)換算レート||11006  |'                '顧問料レート→支払(円)換算レート
11010  |'                .Col = conColComPay              ||11007  |'                .Col = conColComPay              
11011  |'                If .Text = "" Then               ||11008  |'                If .Text = "" Then               
11012  |'                    .BackColorSel = COLOR_ERR    ||11009  |'                    .BackColorSel = COLOR_ERR    
11013  |'                    MsgBox "顧問料レート→支払(円||11010  |'                    MsgBox "顧問料レート→支払(円
11014  |'                    Exit Function                ||11011  |'                    Exit Function                
11015  |'                Else                             ||11012  |'                Else                             
11016  |'                    If IsNumeric(.Text) = False T||11013  |'                    If IsNumeric(.Text) = False T
11017  |'                        .BackColorSel = COLOR_ERR||11014  |'                        .BackColorSel = COLOR_ERR
11018  |'                        MsgBox "顧問料レート→支 ||11015  |'                        MsgBox "顧問料レート→支 
11019  |'                        Exit Function            ||11016  |'                        Exit Function            
11020  |'                    Else                         ||11017  |'                    Else                         
11021  |'                        .BackColorSel = COLOR_CHG||11018  |'                        .BackColorSel = COLOR_CHG
11022  |'                    End If                       ||11019  |'                    End If                       
11023  |'                End If                           ||11020  |'                End If                           
11024  |''2005/01/11 End                                  ||11021  |''2005/01/11 End                                  
11025  |'2005/01/17 End                                   ||11022  |'2005/01/17 End                                   
11026  |            End If                                ||11023  |            End If                                
11027  |        Next Cnt                                  ||11024  |        Next Cnt                                  
11028  |    End With                                      ||11025  |    End With                                      
11029  |                                                  ||11026  |                                                  
11030  |    '戻り値セット                                 ||11027  |    '戻り値セット                                 
11031  |    fnNyuryokuCheck = True                        ||11028  |    fnNyuryokuCheck = True                        
11032  |                                                  ||11029  |                                                  
11033  |End Function                                      ||11030  |End Function                                      
11034  |                                                  ||11031  |                                                  
11035  |'=================================================||11032  |'=================================================
11036  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbGridDataGet                ||11033  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbGridDataGet                
11037  |'機能            :   グリッドデータ取得処理       ||11034  |'機能            :   グリッドデータ取得処理       
11038  |'                                                 ||11035  |'                                                 
11039  |'日付               担当　              修正内容  ||11036  |'日付               担当　              修正内容  
11040  |'-------------------------------------------------||11037  |'-------------------------------------------------
11041  |'2004/08/10         M.Katoh<SRA>       新規作成   ||11038  |'2004/08/10         M.Katoh<SRA>       新規作成   
11042  |'2004/09/02         M.Yamazaki<SRA>    複数ページ ||11039  |'2004/09/02         M.Yamazaki<SRA>    複数ページ 
11043  |'2004/12/29         M.Yamazaki<SRA>    NAV取得区分||11040  |'2004/12/29         M.Yamazaki<SRA>    NAV取得区分
11044  |'2005/01/11         M.Yamazaki<SRA>    列追加     ||11041  |'2005/01/11         M.Yamazaki<SRA>    列追加     
11045  |'2005/01/17         M.Yamazaki<SRA>    列追加をせ ||11042  |'2005/01/17         M.Yamazaki<SRA>    列追加をせ 
11046  |'2005/02/02         M.Yamazaki<SRA>    前回締日営 ||11043  |'2005/02/02         M.Yamazaki<SRA>    前回締日営 
11047  |'2005/03/09         M.Yamazaki<SRA>    消費税計算 ||11044  |'2005/03/09         M.Yamazaki<SRA>    消費税計算 
11048  |'2008/03/12         K.Furuya<SRA>      ファンド決 ||11045  |'2008/03/12         K.Furuya<SRA>      ファンド決 
11049  |'=================================================||11046  |'=================================================
11050  |Private Sub sbGridDataGet( _                      ||11047  |Private Sub sbGridDataGet( _                      
11051  |    ByVal lRow As Long, _                         ||11048  |    ByVal lRow As Long, _                         
11052  |    ByVal lDimRow As Long _                       ||11049  |    ByVal lDimRow As Long _                       
11053  |)                                                 ||11050  |)                                                 
11054  |                                                  ||11051  |                                                  
11055  |'2008/03/12 START ファンド決算期間での外部委託顧問||11052  |'2008/03/12 START ファンド決算期間での外部委託顧問
11056  |    Dim strFndCalcFrom      As String  'ファンド計||11053  |    Dim strFndCalcFrom      As String  'ファンド計
11057  |    Dim strFndCalcTo        As String  'ファンド計||11054  |    Dim strFndCalcTo        As String  'ファンド計
11058  |'2008/03/12 END   ファンド決算期間での外部委託顧問||11055  |'2008/03/12 END   ファンド決算期間での外部委託顧問
11059  |                                                  ||11056  |                                                  
11060  |    '変数初期化                                   ||11057  |    '変数初期化                                   
11061  |    strFndCalcFrom = ""                           ||11058  |    strFndCalcFrom = ""                           
11062  |    strFndCalcTo = ""                             ||11059  |    strFndCalcTo = ""                             
11063  |                                                  ||11060  |                                                  
11064  |    '動的配列更新                                 ||11061  |    '動的配列更新                                 
11065  |    ReDim Preserve gbuMGetUPDRec.N(0 To lDimRow)  ||11062  |    ReDim Preserve gbuMGetUPDRec.N(0 To lDimRow)  
11066  |                                                  ||11063  |                                                  
11067  |                                                  ||11064  |                                                  
11068  |    With fgridMakePrint                           ||11065  |    With fgridMakePrint                           
11069  |        .Row = lRow + 1                           ||11066  |        .Row = lRow + 1                           
11070  |'2005/07/26 Start                                 ||11067  |'2005/07/26 Start                                 
11071  |        .Col = 2        '英文                     ||11068  |        .Col = 2        '英文                     
11072  |        gbuMGetUPDRec.N(lDimRow).MGET_company_flag||11069  |        gbuMGetUPDRec.N(lDimRow).MGET_company_flag
11073  |'2005/07/26 End                                   ||11070  |'2005/07/26 End                                   
11074  |        .Col = 3        '契約番号                 ||11071  |        .Col = 3        '契約番号                 
11075  |        gbuMGetUPDRec.N(lDimRow).MGET_contract_no ||11072  |        gbuMGetUPDRec.N(lDimRow).MGET_contract_no 
11076  |        .Col = 4        '契約名                   ||11073  |        .Col = 4        '契約名                   
11077  |        gbuMGetUPDRec.N(lDimRow).MGET_contract_nam||11074  |        gbuMGetUPDRec.N(lDimRow).MGET_contract_nam
11078  |'2005/08/04 Start                                 ||11075  |'2005/08/04 Start                                 
11079  |        .Col = 5        '契約名[英]               ||11076  |        .Col = 5        '契約名[英]               
11080  |        gbuMGetUPDRec.N(lDimRow).MGET_contract_nam||11077  |        gbuMGetUPDRec.N(lDimRow).MGET_contract_nam
11081  |'2005/08/04 End                                   ||11078  |'2005/08/04 End                                   
11082  |        .Col = 6        '契約区分                 ||11079  |        .Col = 6        '契約区分                 
11083  |        gbuMGetUPDRec.N(lDimRow).MGET_contract_fla||11080  |        gbuMGetUPDRec.N(lDimRow).MGET_contract_fla
11084  |'2008/03/12 START ファンド決算期間での外部委託顧問||11081  |'2008/03/12 START ファンド決算期間での外部委託顧問
11085  |'        .Col = 7        '締日営業日翌日          ||11082  |'        .Col = 7        '締日営業日翌日          
11086  |'        gbuMGetUPDRec.N(lDimRow).MGET_settlement_||11083  |'        gbuMGetUPDRec.N(lDimRow).MGET_settlement_
11087  |'        gbuMGetUPDRec.N(lDimRow).MGET_yokujitu = ||11084  |'        gbuMGetUPDRec.N(lDimRow).MGET_yokujitu = 
11088  |'        .Col = 8        '締日                    ||11085  |'        .Col = 8        '締日                    
11089  |'        gbuMGetUPDRec.N(lDimRow).MGET_settlement_||11086  |'        gbuMGetUPDRec.N(lDimRow).MGET_settlement_
11090  |        'ファンド計算FROM                         ||11087  |        'ファンド計算FROM                         
11091  |        .Col = conColFndCalcFrom                  ||11088  |        .Col = conColFndCalcFrom                  
11092  |        strFndCalcFrom = .Text                    ||11089  |        strFndCalcFrom = .Text                    
11093  |        'ファンド計算TO                           ||11090  |        'ファンド計算TO                           
11094  |        .Col = conColFndCalcTo                    ||11091  |        .Col = conColFndCalcTo                    
11095  |        strFndCalcTo = .Text                      ||11092  |        strFndCalcTo = .Text                      
11096  |        If Trim(strFndCalcFrom) <> "" And Trim(str||11093  |        If Trim(strFndCalcFrom) <> "" And Trim(str
11097  |            '締日営業日翌日                       ||11094  |            '締日営業日翌日                       
11098  |            gbuMGetUPDRec.N(lDimRow).MGET_settleme||11095  |            gbuMGetUPDRec.N(lDimRow).MGET_settleme
11099  |            gbuMGetUPDRec.N(lDimRow).MGET_yokujitu||11096  |            gbuMGetUPDRec.N(lDimRow).MGET_yokujitu
11100  |            '締日                                 ||11097  |            '締日                                 
11101  |            gbuMGetUPDRec.N(lDimRow).MGET_settleme||11098  |            gbuMGetUPDRec.N(lDimRow).MGET_settleme
11102  |        'ファンド決算期間計算の場合実払いテーブル ||11099  |        'ファンド決算期間計算の場合実払いテーブル 
11103  |            gbuMGetUPDRec.N(lDimRow).MGET_other_re||11100  |            gbuMGetUPDRec.N(lDimRow).MGET_other_re
11104  |        Else                                      ||11101  |        Else                                      
11105  |            .Col = 7        '締日営業日翌日       ||11102  |            .Col = 7        '締日営業日翌日       
11106  |            gbuMGetUPDRec.N(lDimRow).MGET_settleme||11103  |            gbuMGetUPDRec.N(lDimRow).MGET_settleme
11107  |            gbuMGetUPDRec.N(lDimRow).MGET_yokujitu||11104  |            gbuMGetUPDRec.N(lDimRow).MGET_yokujitu
11108  |            .Col = 8        '締日                 ||11105  |            .Col = 8        '締日                 
11109  |            gbuMGetUPDRec.N(lDimRow).MGET_settleme||11106  |            gbuMGetUPDRec.N(lDimRow).MGET_settleme
11110  |        'ファン決算期間ド計算の場合実払いテーブル ||11107  |        'ファン決算期間ド計算の場合実払いテーブル 
11111  |            gbuMGetUPDRec.N(lDimRow).MGET_other_re||11108  |            gbuMGetUPDRec.N(lDimRow).MGET_other_re
11112  |        End If                                    ||11109  |        End If                                    
11113  |'2008/03/12 START ファンド決算期間での外部委託顧問||11110  |'2008/03/12 START ファンド決算期間での外部委託顧問
11114  |        .Col = 9        '口座コード               ||11111  |        .Col = 9        '口座コード               
11115  |        gbuMGetUPDRec.N(lDimRow).MGET_account_code||11112  |        gbuMGetUPDRec.N(lDimRow).MGET_account_code
11116  |        .Col = 10        '口座名                  ||11113  |        .Col = 10        '口座名                  
11117  |        gbuMGetUPDRec.N(lDimRow).MGET_account_name||11114  |        gbuMGetUPDRec.N(lDimRow).MGET_account_name
11118  |        .Col = 11       '通貨コード               ||11115  |        .Col = 11       '通貨コード               
11119  |        gbuMGetUPDRec.N(lDimRow).MGET_base_currenc||11116  |        gbuMGetUPDRec.N(lDimRow).MGET_base_currenc
11120  |        .Col = 12       '適用開始日               ||11117  |        .Col = 12       '適用開始日               
11121  |        gbuMGetUPDRec.N(lDimRow).MGET_com_calc_sta||11118  |        gbuMGetUPDRec.N(lDimRow).MGET_com_calc_sta
11122  |        .Col = 13       '適用終了日               ||11119  |        .Col = 13       '適用終了日               
11123  |        gbuMGetUPDRec.N(lDimRow).MGET_com_calc_end||11120  |        gbuMGetUPDRec.N(lDimRow).MGET_com_calc_end
11124  |        .Col = 14       '運用会社コード           ||11121  |        .Col = 14       '運用会社コード           
11125  |        gbuMGetUPDRec.N(lDimRow).MGET_company_code||11122  |        gbuMGetUPDRec.N(lDimRow).MGET_company_code
11126  |        .Col = 15       '運用会社名               ||11123  |        .Col = 15       '運用会社名               
11127  |        gbuMGetUPDRec.N(lDimRow).MGET_company_name||11124  |        gbuMGetUPDRec.N(lDimRow).MGET_company_name
11128  |'2005/08/04 Start                                 ||11125  |'2005/08/04 Start                                 
11129  |        .Col = 16       '運用会社名[英]           ||11126  |        .Col = 16       '運用会社名[英]           
11130  |        gbuMGetUPDRec.N(lDimRow).MGET_company_name||11127  |        gbuMGetUPDRec.N(lDimRow).MGET_company_name
11131  |'2005/08/04 End                                   ||11128  |'2005/08/04 End                                   
11132  |        .Col = 17       'ルールNo                 ||11129  |        .Col = 17       'ルールNo                 
11133  |        gbuMGetUPDRec.N(lDimRow).MGET_OTHER_COM_RU||11130  |        gbuMGetUPDRec.N(lDimRow).MGET_OTHER_COM_RU
11134  |        .Col = 18       '料率区分                 ||11131  |        .Col = 18       '料率区分                 
11135  |        gbuMGetUPDRec.N(lDimRow).MGET_other_rate_r||11132  |        gbuMGetUPDRec.N(lDimRow).MGET_other_rate_r
11136  |'2004/12/29 Start                                 ||11133  |'2004/12/29 Start                                 
11137  |        .Col = 19       'NAV取得区分              ||11134  |        .Col = 19       'NAV取得区分              
11138  |        gbuMGetUPDRec.N(lDimRow).MGET_nav_get_flag||11135  |        gbuMGetUPDRec.N(lDimRow).MGET_nav_get_flag
11139  |        .Col = 20       '上限金額                 ||11136  |        .Col = 20       '上限金額                 
11140  |        gbuMGetUPDRec.N(lDimRow).MGET_cap = .Text ||11137  |        gbuMGetUPDRec.N(lDimRow).MGET_cap = .Text 
11141  |        .Col = 21       '下限金額                 ||11138  |        .Col = 21       '下限金額                 
11142  |        gbuMGetUPDRec.N(lDimRow).MGET_floor = .Tex||11139  |        gbuMGetUPDRec.N(lDimRow).MGET_floor = .Tex
11143  |'2004/12/29 End                                   ||11140  |'2004/12/29 End                                   
11144  |'2004/09/02 Start                                 ||11141  |'2004/09/02 Start                                 
11145  |        .Col = conColPayMentDate    '支払予定日   ||11142  |        .Col = conColPayMentDate    '支払予定日   
11146  |        gbuMGetUPDRec.N(lDimRow).MGET_payment_date||11143  |        gbuMGetUPDRec.N(lDimRow).MGET_payment_date
11147  |'2004/09/02 End                                   ||11144  |'2004/09/02 End                                   
11148  |'2005/01/11 Start                                 ||11145  |'2005/01/11 Start                                 
11149  |        .Col = 23       'NAV通貨                  ||11146  |        .Col = 23       'NAV通貨                  
11150  |        gbuMGetUPDRec.N(lDimRow).MGET_base_currenc||11147  |        gbuMGetUPDRec.N(lDimRow).MGET_base_currenc
11151  |        .Col = 24       '閾値通貨                 ||11148  |        .Col = 24       '閾値通貨                 
11152  |        gbuMGetUPDRec.N(lDimRow).MGET_amount_curre||11149  |        gbuMGetUPDRec.N(lDimRow).MGET_amount_curre
11153  |        .Col = 25       '顧問料通貨               ||11150  |        .Col = 25       '顧問料通貨               
11154  |        gbuMGetUPDRec.N(lDimRow).MGET_other_com_cu||11151  |        gbuMGetUPDRec.N(lDimRow).MGET_other_com_cu
11155  |'2005/01/17 Start                                 ||11152  |'2005/01/17 Start                                 
11156  |'        .Col = 23                                ||11153  |'        .Col = 23                                
11157  |'        gbuMGetUPDRec.N(lDimRow).MGET_NavAmount =||11154  |'        gbuMGetUPDRec.N(lDimRow).MGET_NavAmount =
11158  |'        .Col = 24                                ||11155  |'        .Col = 24                                
11159  |'        gbuMGetUPDRec.N(lDimRow).MGET_NavCom = .T||11156  |'        gbuMGetUPDRec.N(lDimRow).MGET_NavCom = .T
11160  |'        .Col = 25                                ||11157  |'        .Col = 25                                
11161  |'        gbuMGetUPDRec.N(lDimRow).MGET_AmountCom =||11158  |'        gbuMGetUPDRec.N(lDimRow).MGET_AmountCom =
11162  |'        .Col = 26                                ||11159  |'        .Col = 26                                
11163  |'        gbuMGetUPDRec.N(lDimRow).MGET_ComPay = .T||11160  |'        gbuMGetUPDRec.N(lDimRow).MGET_ComPay = .T
11164  |'        .Col = 27                                ||11161  |'        .Col = 27                                
11165  |'        gbuMGetUPDRec.N(lDimRow).MGET_days_in_a_y||11162  |'        gbuMGetUPDRec.N(lDimRow).MGET_days_in_a_y
11166  |''2005/01/11 End                                  ||11163  |''2005/01/11 End                                  
11167  |        .Col = 26       '一年間の日数             ||11164  |        .Col = 26       '一年間の日数             
11168  |        gbuMGetUPDRec.N(lDimRow).MGET_days_in_a_ye||11165  |        gbuMGetUPDRec.N(lDimRow).MGET_days_in_a_ye
11169  |'2005/01/17 End                                   ||11166  |'2005/01/17 End                                   
11170  |        .Col = 27 '       消費税計算有無          ||11167  |        .Col = 27 '       消費税計算有無          
11171  |        gbuMGetUPDRec.N(lDimRow).MGET_tax_calc_fla||11168  |        gbuMGetUPDRec.N(lDimRow).MGET_tax_calc_fla
11172  |    End With                                      ||11169  |    End With                                      
11173  |'2005/07/26 End                                   ||11170  |'2005/07/26 End                                   
11174  |                                                  ||11171  |                                                  
11175  |End Sub                                           ||11172  |End Sub                                           
11176  |                                                  ||11173  |                                                  
11177  |'=================================================||11174  |'=================================================
11178  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblnUrudoshiCheck           ||11175  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblnUrudoshiCheck           
11179  |'機能            :   閏年判定関数                 ||11176  |'機能            :   閏年判定関数                 
11180  |'概要            :   指定したYYYY年2月29日が存在す||11177  |'概要            :   指定したYYYY年2月29日が存在す
11181  |'                    指定したYYYY年2月29日が存在し||11178  |'                    指定したYYYY年2月29日が存在し
11182  |'                                                 ||11179  |'                                                 
11183  |'日付               担当　              修正内容  ||11180  |'日付               担当　              修正内容  
11184  |'-------------------------------------------------||11181  |'-------------------------------------------------
11185  |'2004/08/13         M.Katoh<SRA>       新規作成   ||11182  |'2004/08/13         M.Katoh<SRA>       新規作成   
11186  |'=================================================||11183  |'=================================================
11187  |Private Function fnblnUrudoshiCheck( _            ||11184  |Private Function fnblnUrudoshiCheck( _            
11188  |    ByVal sYear As String _                       ||11185  |    ByVal sYear As String _                       
11189  |) As Boolean                                      ||11186  |) As Boolean                                      
11190  |                                                  ||11187  |                                                  
11191  |    '戻り値初期化                                 ||11188  |    '戻り値初期化                                 
11192  |    fnblnUrudoshiCheck = False                    ||11189  |    fnblnUrudoshiCheck = False                    
11193  |                                                  ||11190  |                                                  
11194  |    '指定年の２月２９日があればうるう年           ||11191  |    '指定年の２月２９日があればうるう年           
11195  |    If IsDate(sYear & "/2/29") Then               ||11192  |    If IsDate(sYear & "/2/29") Then               
11196  |        '日付型データーと判断される（２月２９日が ||11193  |        '日付型データーと判断される（２月２９日が 
11197  |        fnblnUrudoshiCheck = True                 ||11194  |        fnblnUrudoshiCheck = True                 
11198  |'    Else                                         ||11195  |'    Else                                         
11199  |        '日付型データーで無いと判断される（２月２ ||11196  |        '日付型データーで無いと判断される（２月２ 
11200  |'        fnblnUrudoshiCheck = False               ||11197  |'        fnblnUrudoshiCheck = False               
11201  |    End If                                        ||11198  |    End If                                        
11202  |                                                  ||11199  |                                                  
11203  |End Function                                      ||11200  |End Function                                      
11204  |                                                  ||11201  |                                                  
11205  |'=================================================||11202  |'=================================================
11206  |'処理内容     四捨五入：sbGetRoundValue           ||11203  |'処理内容     四捨五入：sbGetRoundValue           
11207  |'備考         小数点第一位で四捨五入する          ||11204  |'備考         小数点第一位で四捨五入する          
11208  |'                                                 ||11205  |'                                                 
11209  |'引数         dblValueIn:四捨五入対象値           ||11206  |'引数         dblValueIn:四捨五入対象値           
11210  |'                                                 ||11207  |'                                                 
11211  |'日付         担当               内容             ||11208  |'日付         担当               内容             
11212  |'------------ ----------------- ------------------||11209  |'------------ ----------------- ------------------
11213  |'2004/11/17   M.Yamazaki<SRA>   新規作成          ||11210  |'2004/11/17   M.Yamazaki<SRA>   新規作成          
11214  |'=================================================||11211  |'=================================================
11215  |Private Function sbGetRoundValue( _               ||11212  |Private Function sbGetRoundValue( _               
11216  |    ByVal dblValueIn As Double _                  ||11213  |    ByVal dblValueIn As Double _                  
11217  |) As Double                                       ||11214  |) As Double                                       
11218  |                                                  ||11215  |                                                  
11219  |    Dim dblNum As Double                          ||11216  |    Dim dblNum As Double                          
11220  |    Dim iPos   As Integer                         ||11217  |    Dim iPos   As Integer                         
11221  |                                                  ||11218  |                                                  
11222  |    dblValueOut = 0                               ||11219  |    dblValueOut = 0                               
11223  |                                                  ||11220  |                                                  
11224  |    iPos = InStr(dblValueIn, ".")                 ||11221  |    iPos = InStr(dblValueIn, ".")                 
11225  |                                                  ||11222  |                                                  
11226  |    If iPos <> 0 Then                             ||11223  |    If iPos <> 0 Then                             
11227  |        If CInt(Mid(CStr(dblValueIn), iPos + 1, 1)||11224  |        If CInt(Mid(CStr(dblValueIn), iPos + 1, 1)
11228  |           dblNum = CDbl(Mid(CStr(dblValueIn), 1, ||11225  |           dblNum = CDbl(Mid(CStr(dblValueIn), 1, 
11229  |           dblNum = dblNum + 1                    ||11226  |           dblNum = dblNum + 1                    
11230  |        Else                                      ||11227  |        Else                                      
11231  |           dblNum = CDbl(Mid(CStr(dblValueIn), 1, ||11228  |           dblNum = CDbl(Mid(CStr(dblValueIn), 1, 
11232  |        End If                                    ||11229  |        End If                                    
11233  |    Else                                          ||11230  |    Else                                          
11234  |        dblNum = dblValueIn                       ||11231  |        dblNum = dblValueIn                       
11235  |    End If                                        ||11232  |    End If                                        
11236  |                                                  ||11233  |                                                  
11237  |    dblValueOut = dblNum                          ||11234  |    dblValueOut = dblNum                          
11238  |                                                  ||11235  |                                                  
11239  |End Function                                      ||11236  |End Function                                      
11240  |                                                  ||11237  |                                                  
11241  |'=================================================||11238  |'=================================================
11242  |'処理内容     四捨五入：sbGetRoundValue2          ||11239  |'処理内容     四捨五入：sbGetRoundValue2          
11243  |'備考         小数点第四位で四捨五入する          ||11240  |'備考         小数点第四位で四捨五入する          
11244  |'                                                 ||11241  |'                                                 
11245  |'引数         dblValueIn:四捨五入対象値           ||11242  |'引数         dblValueIn:四捨五入対象値           
11246  |'                                                 ||11243  |'                                                 
11247  |'日付         担当               内容             ||11244  |'日付         担当               内容             
11248  |'------------ ----------------- ------------------||11245  |'------------ ----------------- ------------------
11249  |'2005/01/13   M.Yamazaki<SRA>   新規作成          ||11246  |'2005/01/13   M.Yamazaki<SRA>   新規作成          
11250  |'=================================================||11247  |'=================================================
11251  |Private Function sbGetRoundValue2( _              ||11248  |Private Function sbGetRoundValue2( _              
11252  |    ByVal dblValueIn As Double _                  ||11249  |    ByVal dblValueIn As Double _                  
11253  |) As Double                                       ||11250  |) As Double                                       
11254  |                                                  ||11251  |                                                  
11255  |    Dim dblNum As Double                          ||11252  |    Dim dblNum As Double                          
11256  |    Dim iPos   As Integer                         ||11253  |    Dim iPos   As Integer                         
11257  |    Dim iLen   As Integer                         ||11254  |    Dim iLen   As Integer                         
11258  |                                                  ||11255  |                                                  
11259  |    dblValueOut = 0                               ||11256  |    dblValueOut = 0                               
11260  |                                                  ||11257  |                                                  
11261  |    iPos = InStr(dblValueIn, ".")                 ||11258  |    iPos = InStr(dblValueIn, ".")                 
11262  |    iLen = Len(CStr(dblValueIn))                  ||11259  |    iLen = Len(CStr(dblValueIn))                  
11263  |                                                  ||11260  |                                                  
11264  |    If iPos <> 0 Then                             ||11261  |    If iPos <> 0 Then                             
11265  |        If iLen - iPos > 3 Then                   ||11262  |        If iLen - iPos > 3 Then                   
11266  |            If CInt(Mid(CStr(dblValueIn), iPos + 4||11263  |            If CInt(Mid(CStr(dblValueIn), iPos + 4
11267  |               dblNum = CDbl(Mid(CStr(dblValueIn),||11264  |               dblNum = CDbl(Mid(CStr(dblValueIn),
11268  |               dblNum = dblNum + 0.001            ||11265  |               dblNum = dblNum + 0.001            
11269  |            Else                                  ||11266  |            Else                                  
11270  |               dblNum = CDbl(Mid(CStr(dblValueIn),||11267  |               dblNum = CDbl(Mid(CStr(dblValueIn),
11271  |            End If                                ||11268  |            End If                                
11272  |        Else                                      ||11269  |        Else                                      
11273  |            dblNum = dblValueIn                   ||11270  |            dblNum = dblValueIn                   
11274  |        End If                                    ||11271  |        End If                                    
11275  |    Else                                          ||11272  |    Else                                          
11276  |        dblNum = dblValueIn                       ||11273  |        dblNum = dblValueIn                       
11277  |    End If                                        ||11274  |    End If                                        
11278  |                                                  ||11275  |                                                  
11279  |    dblValueOut = dblNum                          ||11276  |    dblValueOut = dblNum                          
11280  |                                                  ||11277  |                                                  
11281  |End Function                                      ||11278  |End Function                                      
11282  |                                                  ||11279  |                                                  
11283  |'=================================================||11280  |'=================================================
11284  |'処理内容     四捨五入：sbGetRoundValueTax        ||11281  |'処理内容     四捨五入：sbGetRoundValueTax        
11285  |'備考         小数点第一位以降を切り捨てる        ||11282  |'備考         小数点第一位以降を切り捨てる        
11286  |'                                                 ||11283  |'                                                 
11287  |'引数         dblValueIn:切捨て対象値             ||11284  |'引数         dblValueIn:切捨て対象値             
11288  |'                                                 ||11285  |'                                                 
11289  |'日付         担当               内容             ||11286  |'日付         担当               内容             
11290  |'------------ ----------------- ------------------||11287  |'------------ ----------------- ------------------
11291  |'2004/11/17   M.Yamazaki<SRA>   新規作成          ||11288  |'2004/11/17   M.Yamazaki<SRA>   新規作成          
11292  |'=================================================||11289  |'=================================================
11293  |Private Function sbGetRoundValueTax( _            ||11290  |Private Function sbGetRoundValueTax( _            
11294  |    ByVal dblValueIn As Double _                  ||11291  |    ByVal dblValueIn As Double _                  
11295  |) As Double                                       ||11292  |) As Double                                       
11296  |                                                  ||11293  |                                                  
11297  |    Dim dblNum As Double                          ||11294  |    Dim dblNum As Double                          
11298  |    Dim iPos   As Integer                         ||11295  |    Dim iPos   As Integer                         
11299  |                                                  ||11296  |                                                  
11300  |    dblValueOut = 0                               ||11297  |    dblValueOut = 0                               
11301  |                                                  ||11298  |                                                  
11302  |    iPos = InStr(dblValueIn, ".")                 ||11299  |    iPos = InStr(dblValueIn, ".")                 
11303  |                                                  ||11300  |                                                  
11304  |    If iPos <> 0 Then                             ||11301  |    If iPos <> 0 Then                             
11305  |        dblNum = CDbl(Mid(CStr(dblValueIn), 1, iPo||11302  |        dblNum = CDbl(Mid(CStr(dblValueIn), 1, iPo
11306  |    Else                                          ||11303  |    Else                                          
11307  |        dblNum = dblValueIn                       ||11304  |        dblNum = dblValueIn                       
11308  |    End If                                        ||11305  |    End If                                        
11309  |                                                  ||11306  |                                                  
11310  |    dblValueOut = dblNum                          ||11307  |    dblValueOut = dblNum                          
11311  |                                                  ||11308  |                                                  
11312  |End Function                                      ||11309  |End Function                                      
11313  |                                                  ||11310  |                                                  
11314  |'=================================================||11311  |'=================================================
11315  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnRateChk                    ||11312  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnRateChk                    
11316  |'機能            :   レート入力チェック           ||11313  |'機能            :   レート入力チェック           
11317  |'                                                 ||11314  |'                                                 
11318  |'日付               担当　              修正内容  ||11315  |'日付               担当　              修正内容  
11319  |'-------------------------------------------------||11316  |'-------------------------------------------------
11320  |'2005/01/11         M.Yamazaki<SRA>     新規作成  ||11317  |'2005/01/11         M.Yamazaki<SRA>     新規作成  
11321  |'=================================================||11318  |'=================================================
11322  |Private Function fnRateChk(Rate As String) As Bool||11319  |Private Function fnRateChk(Rate As String) As Bool
11323  |    Dim dBuf         As Double                    ||11320  |    Dim dBuf         As Double                    
11324  |    Dim bErrFlg      As Boolean                   ||11321  |    Dim bErrFlg      As Boolean                   
11325  |    Dim iPos         As Integer                   ||11322  |    Dim iPos         As Integer                   
11326  |    Dim iLen         As Integer                   ||11323  |    Dim iLen         As Integer                   
11327  |    Dim sBuf         As String                    ||11324  |    Dim sBuf         As String                    
11328  |                                                  ||11325  |                                                  
11329  |    '入力数値チェック                             ||11326  |    '入力数値チェック                             
11330  |    'フラグ初期化                                 ||11327  |    'フラグ初期化                                 
11331  |    fnRateChk = False                             ||11328  |    fnRateChk = False                             
11332  |    '                                             ||11329  |    '                                             
11333  |    If IsNumeric(Rate) = False Then               ||11330  |    If IsNumeric(Rate) = False Then               
11334  |        fnRateChk = True                          ||11331  |        fnRateChk = True                          
11335  |        Exit Function                             ||11332  |        Exit Function                             
11336  |    End If                                        ||11333  |    End If                                        
11337  |    'データ抽出                                   ||11334  |    'データ抽出                                   
11338  |    dBuf = CDbl(gDelChar(Rate, ","))              ||11335  |    dBuf = CDbl(gDelChar(Rate, ","))              
11339  |    sBuf = gDelChar(Rate, ",")                    ||11336  |    sBuf = gDelChar(Rate, ",")                    
11340  |    iPos = InStr(sBuf, ".")                       ||11337  |    iPos = InStr(sBuf, ".")                       
11341  |    iLen = Len(sBuf)                              ||11338  |    iLen = Len(sBuf)                              
11342  |'''''    '１１桁以上はエラー                      ||11339  |'''''    '１１桁以上はエラー                      
11343  |'''''    If iPos > 12 _                           ||11340  |'''''    If iPos > 12 _                           
11344  |'''''    Or (iPos = 0 _                           ||11341  |'''''    Or (iPos = 0 _                           
11345  |'''''    And iLen >= 12) Then                     ||11342  |'''''    And iLen >= 12) Then                     
11346  |'''''        fnRateChk = True                     ||11343  |'''''        fnRateChk = True                     
11347  |'''''    End If                                   ||11344  |'''''    End If                                   
11348  |'''''    '小数１０桁以上はエラー                  ||11345  |'''''    '小数１０桁以上はエラー                  
11349  |'''''    If iLen - iPos > 10 _                    ||11346  |'''''    If iLen - iPos > 10 _                    
11350  |'''''    And iPos > 0 Then                        ||11347  |'''''    And iPos > 0 Then                        
11351  |'''''        fnRateChk = True                     ||11348  |'''''        fnRateChk = True                     
11352  |'''''    End If                                   ||11349  |'''''    End If                                   
11353  |    '４桁以上はエラー                             ||11350  |    '４桁以上はエラー                             
11354  |    If iPos > 4 _                                 ||11351  |    If iPos > 4 _                                 
11355  |    Or (iPos = 0 _                                ||11352  |    Or (iPos = 0 _                                
11356  |    And iLen >= 4) Then                           ||11353  |    And iLen >= 4) Then                           
11357  |        fnRateChk = True                          ||11354  |        fnRateChk = True                          
11358  |    End If                                        ||11355  |    End If                                        
11359  |    '小数４桁以上はエラー                         ||11356  |    '小数４桁以上はエラー                         
11360  |    If iLen - iPos > 3 _                          ||11357  |    If iLen - iPos > 3 _                          
11361  |    And iPos > 0 Then                             ||11358  |    And iPos > 0 Then                             
11362  |        fnRateChk = True                          ||11359  |        fnRateChk = True                          
11363  |    End If                                        ||11360  |    End If                                        
11364  |                                                  ||11361  |                                                  
11365  |End Function                                      ||11362  |End Function                                      
11366  |                                                  ||11363  |                                                  
11367  |'=================================================||11364  |'=================================================
11368  |'処理内容     為替レート取得：fnstrExchangeRate   ||11365  |'処理内容     為替レート取得：fnstrExchangeRate   
11369  |'備考         TTMの直近為替レートを取得する       ||11366  |'備考         TTMの直近為替レートを取得する       
11370  |'                                                 ||11367  |'                                                 
11371  |'日付         担当               内容             ||11368  |'日付         担当               内容             
11372  |'------------ ----------------- ------------------||11369  |'------------ ----------------- ------------------
11373  |'2005/01/17   M.Yamazaki <SRA>     新規作成       ||11370  |'2005/01/17   M.Yamazaki <SRA>     新規作成       
11374  |'=================================================||11371  |'=================================================
11375  |Private Function fnstrExchangeRate( _             ||11372  |Private Function fnstrExchangeRate( _             
11376  |    dstrDate As String, _                         ||11373  |    dstrDate As String, _                         
11377  |    dstrCurrencyCode As String _                  ||11374  |    dstrCurrencyCode As String _                  
11378  |) As Double                                       ||11375  |) As Double                                       
11379  |                                                  ||11376  |                                                  
11380  |On Error GoTo OnErrorProc                         ||11377  |On Error GoTo OnErrorProc                         
11381  |                                                  ||11378  |                                                  
11382  |    Dim sSql        As String                     ||11379  |    Dim sSql        As String                     
11383  |    Dim strErrCall  As String        'エラー呼出元||11380  |    Dim strErrCall  As String        'エラー呼出元
11384  |                                                  ||11381  |                                                  
11385  |    sSql = ""                                     ||11382  |    sSql = ""                                     
11386  |    sSql = sSql & "SELECT  "                      ||11383  |    sSql = sSql & "SELECT  "                      
11387  |    sSql = sSql & "TBL_TTM1.currency_code TBL_TTM1||11384  |    sSql = sSql & "TBL_TTM1.currency_code TBL_TTM1
11388  |    sSql = sSql & "TBL_TTM1.base_date TBL_TTM1_bas||11385  |    sSql = sSql & "TBL_TTM1.base_date TBL_TTM1_bas
11389  |    sSql = sSql & "TBL_TTM1.base_currency_code TBL||11386  |    sSql = sSql & "TBL_TTM1.base_currency_code TBL
11390  |    sSql = sSql & "TBL_TTM1.exchange_rate TBL_TTM1||11387  |    sSql = sSql & "TBL_TTM1.exchange_rate TBL_TTM1
11391  |    sSql = sSql & "FROM (SELECT "                 ||11388  |    sSql = sSql & "FROM (SELECT "                 
11392  |    sSql = sSql & "WK_TTM.currency_code, "        ||11389  |    sSql = sSql & "WK_TTM.currency_code, "        
11393  |    sSql = sSql & "TO_CHAR(TO_DATE(WK_TTM.base_dat||11390  |    sSql = sSql & "TO_CHAR(TO_DATE(WK_TTM.base_dat
11394  |    sSql = sSql & "NVL(WK_TTM.base_currency_code,'||11391  |    sSql = sSql & "NVL(WK_TTM.base_currency_code,'
11395  |    sSql = sSql & "TO_CHAR(WK_TTM.exchange_rate,'f||11392  |    sSql = sSql & "TO_CHAR(WK_TTM.exchange_rate,'f
11396  |    sSql = sSql & "FROM cfr_ttm_tbl WK_TTM "      ||11393  |    sSql = sSql & "FROM cfr_ttm_tbl WK_TTM "      
11397  |    sSql = sSql & "WHERE "                        ||11394  |    sSql = sSql & "WHERE "                        
11398  |    sSql = sSql & "(WK_TTM.base_date,WK_TTM.base_c||11395  |    sSql = sSql & "(WK_TTM.base_date,WK_TTM.base_c
11399  |    sSql = sSql & "FROM cfr_ttm_tbl TTM1 "        ||11396  |    sSql = sSql & "FROM cfr_ttm_tbl TTM1 "        
11400  |    sSql = sSql & "WHERE TTM1.base_currency_code =||11397  |    sSql = sSql & "WHERE TTM1.base_currency_code =
11401  |    sSql = sSql & "AND TTM1.base_date <= '"       ||11398  |    sSql = sSql & "AND TTM1.base_date <= '"       
11402  |    sSql = sSql & dstrDate                        ||11399  |    sSql = sSql & dstrDate                        
11403  |    sSql = sSql & "' "                            ||11400  |    sSql = sSql & "' "                            
11404  |    sSql = sSql & "GROUP BY TTM1.base_currency_cod||11401  |    sSql = sSql & "GROUP BY TTM1.base_currency_cod
11405  |    sSql = sSql & "AND WK_TTM.currency_code = '"  ||11402  |    sSql = sSql & "AND WK_TTM.currency_code = '"  
11406  |    sSql = sSql & dstrCurrencyCode                ||11403  |    sSql = sSql & dstrCurrencyCode                
11407  |    sSql = sSql & "') TBL_TTM1"                   ||11404  |    sSql = sSql & "') TBL_TTM1"                   
11408  |    'ﾀﾞｲﾅｾｯﾄの作成                                ||11405  |    'ﾀﾞｲﾅｾｯﾄの作成                                
11409  |    If gintDyCreate(sSql) = False Then            ||11406  |    If gintDyCreate(sSql) = False Then            
11410  |        Exit Function                             ||11407  |        Exit Function                             
11411  |    Else                                          ||11408  |    Else                                          
11412  |        fnstrExchangeRate = gvlnDyDataN("TBL_TTM1_||11409  |        fnstrExchangeRate = gvlnDyDataN("TBL_TTM1_
11413  |    End If                                        ||11410  |    End If                                        
11414  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             ||11411  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             
11415  |    Call gblnDyClose                              ||11412  |    Call gblnDyClose                              
11416  |                                                  ||11413  |                                                  
11417  |    Exit Function                                 ||11414  |    Exit Function                                 
11418  |                                                  ||11415  |                                                  
11419  |OnErrorProc:                                      ||11416  |OnErrorProc:                                      
11420  |    Call subError("システムエラー", Str(Err.Number||11417  |    Call subError("システムエラー", Str(Err.Number
11421  |        Error, strErrCall, conTitle)              ||11418  |        Error, strErrCall, conTitle)              
11422  |    Exit Function                                 ||11419  |    Exit Function                                 
11423  |                                                  ||11420  |                                                  
11424  |EndProc:                                          ||11421  |EndProc:                                          
11425  |    Exit Function                                 ||11422  |    Exit Function                                 
11426  |                                                  ||11423  |                                                  
11427  |End Function                                      ||11424  |End Function                                      
11428  |                                                  ||11425  |                                                  
11429  |'=================================================||11426  |'=================================================
11430  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMgetSettlementDataIni      ||11427  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMgetSettlementDataIni      
11431  |'機能            :   対象外部委託顧問料締日取得テ ||11428  |'機能            :   対象外部委託顧問料締日取得テ 
11432  |'                                                 ||11429  |'                                                 
11433  |'日付               担当                修正内容  ||11430  |'日付               担当                修正内容  
11434  |'-------------------------------------------------||11431  |'-------------------------------------------------
11435  |'2005/04/21         M.Yamazaki<SRA>     新規作成  ||11432  |'2005/04/21         M.Yamazaki<SRA>     新規作成  
11436  |'=================================================||11433  |'=================================================
11437  |Private Sub sbMgetSettlementDataIni()             ||11434  |Private Sub sbMgetSettlementDataIni()             
11438  |                                                  ||11435  |                                                  
11439  |    Dim i As Integer                              ||11436  |    Dim i As Integer                              
11440  |                                                  ||11437  |                                                  
11441  |    For i = 0 To 999                              ||11438  |    For i = 0 To 999                              
11442  |        With gbuMGetSettlementUPDRec.N(i)         ||11439  |        With gbuMGetSettlementUPDRec.N(i)         
11443  |            .MGET_contract_no = ""                ||11440  |            .MGET_contract_no = ""                
11444  |            .MGET_settlement_date = ""            ||11441  |            .MGET_settlement_date = ""            
11445  |            .MGET_use_date_start = ""             ||11442  |            .MGET_use_date_start = ""             
11446  |            .MGET_use_date_end = ""               ||11443  |            .MGET_use_date_end = ""               
11447  |            .MGET_yyyy_settlement_date = ""       ||11444  |            .MGET_yyyy_settlement_date = ""       
11448  |            .MGET_flag = ""                       ||11445  |            .MGET_flag = ""                       
11449  |        End With                                  ||11446  |        End With                                  
11450  |        With gbuMGetSettlementUPDRec.O(i)         ||11447  |        With gbuMGetSettlementUPDRec.O(i)         
11451  |            .MGET_contract_no = ""                ||11448  |            .MGET_contract_no = ""                
11452  |            .MGET_settlement_date = ""            ||11449  |            .MGET_settlement_date = ""            
11453  |            .MGET_use_date_start = ""             ||11450  |            .MGET_use_date_start = ""             
11454  |            .MGET_use_date_end = ""               ||11451  |            .MGET_use_date_end = ""               
11455  |            .MGET_yyyy_settlement_date = ""       ||11452  |            .MGET_yyyy_settlement_date = ""       
11456  |            .MGET_flag = ""                       ||11453  |            .MGET_flag = ""                       
11457  |        End With                                  ||11454  |        End With                                  
11458  |    Next i                                        ||11455  |    Next i                                        
11459  |                                                  ||11456  |                                                  
11460  |End Sub                                           ||11457  |End Sub                                           
11461  |                                                  ||11458  |                                                  
11462  |'=================================================||11459  |'=================================================
11463  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMGetSettlementDataGet      ||11460  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMGetSettlementDataGet      
11464  |'機能            :   対象外部委託顧問料締日取得テ ||11461  |'機能            :   対象外部委託顧問料締日取得テ 
11465  |'                                                 ||11462  |'                                                 
11466  |'日付               担当                修正内容  ||11463  |'日付               担当                修正内容  
11467  |'-------------------------------------------------||11464  |'-------------------------------------------------
11468  |'2005/04/21         M.Yamazaki<SRA>     新規作成  ||11465  |'2005/04/21         M.Yamazaki<SRA>     新規作成  
11469  |'=================================================||11466  |'=================================================
11470  |Private Sub sbMGetSettlementDataGet( _            ||11467  |Private Sub sbMGetSettlementDataGet( _            
11471  |    ByVal lRecIdx As Long _                       ||11468  |    ByVal lRecIdx As Long _                       
11472  |)                                                 ||11469  |)                                                 
11473  |                                                  ||11470  |                                                  
11474  |    Dim dstr_Settlement_date As String            ||11471  |    Dim dstr_Settlement_date As String            
11475  |                                                  ||11472  |                                                  
11476  |    With gbuMGetSettlementUPDRec.N(lRecIdx)       ||11473  |    With gbuMGetSettlementUPDRec.N(lRecIdx)       
11477  |        If lRecIdx <> 0 Then                      ||11474  |        If lRecIdx <> 0 Then                      
11478  |            If Mid(gbuMGetSettlementUPDRec.N(lRecI||11475  |            If Mid(gbuMGetSettlementUPDRec.N(lRecI
11479  |'2005/04/26 Start                                 ||11476  |'2005/04/26 Start                                 
11480  |'                gbuMGetSettlementUPDRec.N(lRecIdx||11477  |'                gbuMGetSettlementUPDRec.N(lRecIdx
11481  |'                gbuMGetSettlementUPDRec.N(lRecIdx||11478  |'                gbuMGetSettlementUPDRec.N(lRecIdx
11482  |'                Exit Sub                         ||11479  |'                Exit Sub                         
11483  |                If gbuMGetSettlementUPDRec.N(lRecI||11480  |                If gbuMGetSettlementUPDRec.N(lRecI
11484  |                And gbuMGetSettlementUPDRec.N(lRec||11481  |                And gbuMGetSettlementUPDRec.N(lRec
11485  |                Else                              ||11482  |                Else                              
11486  |                    gbuMGetSettlementUPDRec.N(lRec||11483  |                    gbuMGetSettlementUPDRec.N(lRec
11487  |                    gbuMGetSettlementUPDRec.N(lRec||11484  |                    gbuMGetSettlementUPDRec.N(lRec
11488  |                    Exit Sub                      ||11485  |                    Exit Sub                      
11489  |                End If                            ||11486  |                End If                            
11490  |'2005/04/26 End                                   ||11487  |'2005/04/26 End                                   
11491  |            End If                                ||11488  |            End If                                
11492  |        End If                                    ||11489  |        End If                                    
11493  |        .MGET_contract_no = gvlnDyDataS("contract_||11490  |        .MGET_contract_no = gvlnDyDataS("contract_
11494  |        .MGET_settlement_date = gvlnDyDataS("Settl||11491  |        .MGET_settlement_date = gvlnDyDataS("Settl
11495  |        .MGET_use_date_start = gvlnDyDataS("Use_Da||11492  |        .MGET_use_date_start = gvlnDyDataS("Use_Da
11496  |        .MGET_use_date_end = gvlnDyDataS("Use_Date||11493  |        .MGET_use_date_end = gvlnDyDataS("Use_Date
11497  |        '締日が閏年かどうか判定                   ||11494  |        '締日が閏年かどうか判定                   
11498  |        dstr_Settlement_date = gvlnDyDataS("yyyy_s||11495  |        dstr_Settlement_date = gvlnDyDataS("yyyy_s
11499  |        If Mid(dstr_Settlement_date, 5, 4) = conUr||11496  |        If Mid(dstr_Settlement_date, 5, 4) = conUr
11500  |            '閏年チェック                         ||11497  |            '閏年チェック                         
11501  |            If fnblnUrudoshiCheck(Mid(dstr_Settlem||11498  |            If fnblnUrudoshiCheck(Mid(dstr_Settlem
11502  |                dstr_Settlement_date = Mid(dstr_Se||11499  |                dstr_Settlement_date = Mid(dstr_Se
11503  |            End If                                ||11500  |            End If                                
11504  |        Else                                      ||11501  |        Else                                      
11505  |            dstr_Settlement_date = gvlnDyDataS("yy||11502  |            dstr_Settlement_date = gvlnDyDataS("yy
11506  |        End If                                    ||11503  |        End If                                    
11507  |        .MGET_yyyy_settlement_date = dstr_Settleme||11504  |        .MGET_yyyy_settlement_date = dstr_Settleme
11508  |    End With                                      ||11505  |    End With                                      
11509  |                                                  ||11506  |                                                  
11510  |End Sub                                           ||11507  |End Sub                                           
11511  |                                                  ||11508  |                                                  
11512  |'=================================================||11509  |'=================================================
11513  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMGetSettlementDataGet2     ||11510  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMGetSettlementDataGet2     
11514  |'機能            :   対象外部委託顧問料締日取得テ ||11511  |'機能            :   対象外部委託顧問料締日取得テ 
11515  |'                                                 ||11512  |'                                                 
11516  |'日付               担当                修正内容  ||11513  |'日付               担当                修正内容  
11517  |'-------------------------------------------------||11514  |'-------------------------------------------------
11518  |'2005/04/21         M.Yamazaki<SRA>     新規作成  ||11515  |'2005/04/21         M.Yamazaki<SRA>     新規作成  
11519  |'=================================================||11516  |'=================================================
11520  |Private Sub sbMGetSettlementDataGet2( _           ||11517  |Private Sub sbMGetSettlementDataGet2( _           
11521  |    ByVal lRecIdx As Long _                       ||11518  |    ByVal lRecIdx As Long _                       
11522  |)                                                 ||11519  |)                                                 
11523  |                                                  ||11520  |                                                  
11524  |    Dim dstr_Settlement_date As String            ||11521  |    Dim dstr_Settlement_date As String            
11525  |                                                  ||11522  |                                                  
11526  |    If lRecIdx <> 0 Then                          ||11523  |    If lRecIdx <> 0 Then                          
11527  |        If Mid(gbuMGetSettlementUPDRec.N(lRecIdx -||11524  |        If Mid(gbuMGetSettlementUPDRec.N(lRecIdx -
11528  |'2005/04/26 Start                                 ||11525  |'2005/04/26 Start                                 
11529  |'            gbuMGetSettlementUPDRec.O(lRecIdx - 1||11526  |'            gbuMGetSettlementUPDRec.O(lRecIdx - 1
11530  |'            gbuMGetSettlementUPDRec.N(lRecIdx - 1||11527  |'            gbuMGetSettlementUPDRec.N(lRecIdx - 1
11531  |'            Exit Sub                             ||11528  |'            Exit Sub                             
11532  |                If gbuMGetSettlementUPDRec.N(lRecI||11529  |                If gbuMGetSettlementUPDRec.N(lRecI
11533  |                And gbuMGetSettlementUPDRec.N(lRec||11530  |                And gbuMGetSettlementUPDRec.N(lRec
11534  |                Else                              ||11531  |                Else                              
11535  |                    gbuMGetSettlementUPDRec.O(lRec||11532  |                    gbuMGetSettlementUPDRec.O(lRec
11536  |                    gbuMGetSettlementUPDRec.N(lRec||11533  |                    gbuMGetSettlementUPDRec.N(lRec
11537  |                    If gvlnDyDataS("Use_Date_start||11534  |                    If gvlnDyDataS("Use_Date_start
11538  |                    And gvlnDyDataS("Use_Date_End"||11535  |                    And gvlnDyDataS("Use_Date_End"
11539  |                        gbuMGetSettlementUPDRec.N(||11536  |                        gbuMGetSettlementUPDRec.N(
11540  |                        gbuMGetSettlementUPDRec.N(||11537  |                        gbuMGetSettlementUPDRec.N(
11541  |                        gbuMGetSettlementUPDRec.O(||11538  |                        gbuMGetSettlementUPDRec.O(
11542  |                        gbuMGetSettlementUPDRec.O(||11539  |                        gbuMGetSettlementUPDRec.O(
11543  |                        lRecCnt2 = lRecCnt2 + 1   ||11540  |                        lRecCnt2 = lRecCnt2 + 1   
11544  |                    End If                        ||11541  |                    End If                        
11545  |                    Exit Sub                      ||11542  |                    Exit Sub                      
11546  |                End If                            ||11543  |                End If                            
11547  |'2005/04/26 End                                   ||11544  |'2005/04/26 End                                   
11548  |        End If                                    ||11545  |        End If                                    
11549  |    End If                                        ||11546  |    End If                                        
11550  |                                                  ||11547  |                                                  
11551  |    If gbuMGetSettlementUPDRec.N(lRecIdx).MGET_use||11548  |    If gbuMGetSettlementUPDRec.N(lRecIdx).MGET_use
11552  |                                                  ||11549  |                                                  
11553  |        With gbuMGetSettlementUPDRec.O(lRecCnt2)  ||11550  |        With gbuMGetSettlementUPDRec.O(lRecCnt2)  
11554  |            .MGET_contract_no = gbuMGetSettlementU||11551  |            .MGET_contract_no = gbuMGetSettlementU
11555  |            .MGET_settlement_date = gbuMGetSettlem||11552  |            .MGET_settlement_date = gbuMGetSettlem
11556  |            .MGET_use_date_start = gbuMGetSettleme||11553  |            .MGET_use_date_start = gbuMGetSettleme
11557  |            .MGET_use_date_end = gbuMGetSettlement||11554  |            .MGET_use_date_end = gbuMGetSettlement
11558  |            '締日が閏年かどうか判定               ||11555  |            '締日が閏年かどうか判定               
11559  |            dstr_Settlement_date = gbuMGetSettleme||11556  |            dstr_Settlement_date = gbuMGetSettleme
11560  |            If Mid(dstr_Settlement_date, 5, 4) = c||11557  |            If Mid(dstr_Settlement_date, 5, 4) = c
11561  |                '閏年チェック                     ||11558  |                '閏年チェック                     
11562  |                If fnblnUrudoshiCheck(Mid(dstr_Set||11559  |                If fnblnUrudoshiCheck(Mid(dstr_Set
11563  |                    dstr_Settlement_date = Mid(dst||11560  |                    dstr_Settlement_date = Mid(dst
11564  |                End If                            ||11561  |                End If                            
11565  |            Else                                  ||11562  |            Else                                  
11566  |                dstr_Settlement_date = gbuMGetSett||11563  |                dstr_Settlement_date = gbuMGetSett
11567  |            End If                                ||11564  |            End If                                
11568  |            .MGET_yyyy_settlement_date = dstr_Sett||11565  |            .MGET_yyyy_settlement_date = dstr_Sett
11569  |        End With                                  ||11566  |        End With                                  
11570  |                                                  ||11567  |                                                  
11571  |        lRecCnt2 = lRecCnt2 + 1                   ||11568  |        lRecCnt2 = lRecCnt2 + 1                   
11572  |    End If                                        ||11569  |    End If                                        
11573  |                                                  ||11570  |                                                  
11574  |End Sub                                           ||11571  |End Sub                                           
11575  |                                                  ||11572  |                                                  
11576  |'=================================================||11573  |'=================================================
11577  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMGetSettlementDataGet_1    ||11574  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMGetSettlementDataGet_1    
11578  |'機能            :   対象外部委託顧問料締日取得テ ||11575  |'機能            :   対象外部委託顧問料締日取得テ 
11579  |'                                                 ||11576  |'                                                 
11580  |'日付               担当                修正内容  ||11577  |'日付               担当                修正内容  
11581  |'-------------------------------------------------||11578  |'-------------------------------------------------
11582  |'2005/04/21         M.Yamazaki<SRA>     新規作成  ||11579  |'2005/04/21         M.Yamazaki<SRA>     新規作成  
11583  |'=================================================||11580  |'=================================================
11584  |Private Sub sbMGetSettlementDataGet_1( _          ||11581  |Private Sub sbMGetSettlementDataGet_1( _          
11585  |    ByVal lRecIdx As Long _                       ||11582  |    ByVal lRecIdx As Long _                       
11586  |)                                                 ||11583  |)                                                 
11587  |                                                  ||11584  |                                                  
11588  |    With gbuMGetSettlementUPDRec.N(lRecIdx)       ||11585  |    With gbuMGetSettlementUPDRec.N(lRecIdx)       
11589  |        .MGET_yyyy_settlement_date = Replace(CStr(||11586  |        .MGET_yyyy_settlement_date = Replace(CStr(
11590  |    End With                                      ||11587  |    End With                                      
11591  |                                                  ||11588  |                                                  
11592  |End Sub                                           ||11589  |End Sub                                           
11593  |                                                  ||11590  |                                                  
11594  |                                                  ||11591  |                                                  
11595  |                                                  ||11592  |                                                  
11596  |                                                  ||11593  |                                                  
11597  |                                                  ||11594  |                                                  
11598  |                                                  ||11595  |                                                  
11599  |                                                  ||11596  |                                                  
11600  |                                                  ||11597  |                                                  
11601  |                                                  ||11598  |                                                  
11602  |                                                  ||11599  |                                                  
11603  |                                                  ||11600  |                                                  
11604  |                                                  ||11601  |                                                  
11605  |                                                  ||11602  |                                                  
11606  |                                                  ||11603  |                                                  
11607  |                                                  ||11604  |                                                  
11608  |                                                  ||11605  |                                                  
11609  |                                                  ||11606  |                                                  
11610  |                                                  ||11607  |                                                  
11611  |                                                  ||11608  |                                                  
11612  |                                                  ||11609  |                                                  
11613  |                                                  ||11610  |                                                  
11614  |                                                  ||11611  |                                                  
11615  |                                                  ||11612  |                                                  
11616  |                                                  ||11613  |                                                  
11617  |                                                  ||11614  |                                                  
11618  |'=================================================||11615  |'=================================================
11619  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblMakePrint_New            ||11616  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblMakePrint_New            
11620  |'機能            :   確認書のExcel出力            ||11617  |'機能            :   確認書のExcel出力            
11621  |'                                                 ||11618  |'                                                 
11622  |'日付               担当　              修正内容  ||11619  |'日付               担当　              修正内容  
11623  |'-------------------------------------------------||11620  |'-------------------------------------------------
11624  |'2006/07/03         K.Furuya <SRA>     期中料率変 ||11621  |'2006/07/03         K.Furuya <SRA>     期中料率変 
11625  |'                                      fnblMakePri||11622  |'                                      fnblMakePri
11626  |'=================================================||11623  |'=================================================
11627  |Private Function fnblMakePrint_New() As Boolean   ||11624  |Private Function fnblMakePrint_New() As Boolean   
11628  |                                                  ||11625  |                                                  
11629  |    Dim sSql            As String                 ||11626  |    Dim sSql            As String                 
11630  |    Dim lRecCnt         As Long                   ||11627  |    Dim lRecCnt         As Long                   
11631  |    Dim lRecDayCnt      As Long                   ||11628  |    Dim lRecDayCnt      As Long                   
11632  |    Dim lGridCnt        As Long                   ||11629  |    Dim lGridCnt        As Long                   
11633  |    Dim Cnt             As Long                   ||11630  |    Dim Cnt             As Long                   
11634  |    Dim MonthlyCnt      As Long                   ||11631  |    Dim MonthlyCnt      As Long                   
11635  |    Dim sStart          As String                 ||11632  |    Dim sStart          As String                 
11636  |    Dim sEnd            As String                 ||11633  |    Dim sEnd            As String                 
11637  |    Dim sContractNo     As String                 ||11634  |    Dim sContractNo     As String                 
11638  |    Dim sCurrencyCode   As String                 ||11635  |    Dim sCurrencyCode   As String                 
11639  |    Dim sBaseDate       As String                 ||11636  |    Dim sBaseDate       As String                 
11640  |    Dim sSettleDate     As String                 ||11637  |    Dim sSettleDate     As String                 
11641  |    Dim sRuleNo         As String                 ||11638  |    Dim sRuleNo         As String                 
11642  |    Dim sPayDate        As String                 ||11639  |    Dim sPayDate        As String                 
11643  |    Dim ParaYear        As String                 ||11640  |    Dim ParaYear        As String                 
11644  |    Dim ParaMonth       As String                 ||11641  |    Dim ParaMonth       As String                 
11645  |    Dim ParaDay         As String                 ||11642  |    Dim ParaDay         As String                 
11646  |    Dim sZenkai         As String                 ||11643  |    Dim sZenkai         As String                 
11647  |    Dim sNearMonth      As String                 ||11644  |    Dim sNearMonth      As String                 
11648  |    Dim LastYearFlag    As Boolean                ||11645  |    Dim LastYearFlag    As Boolean                
11649  |    Dim strErrCall      As String                 ||11646  |    Dim strErrCall      As String                 
11650  |    Const conMeModule   As String = "fnblMakePrint||11647  |    Const conMeModule   As String = "fnblMakePrint
11651  |    Dim sContNo         As String                 ||11648  |    Dim sContNo         As String                 
11652  |    Dim ddblNav As Double                         ||11649  |    Dim ddblNav As Double                         
11653  |    Dim ddblCnt As Double                         ||11650  |    Dim ddblCnt As Double                         
11654  |    Dim ddblNavTotal                              ||11651  |    Dim ddblNavTotal                              
11655  |    Dim ddblBabyMotherRate As Double              ||11652  |    Dim ddblBabyMotherRate As Double              
11656  |    Dim dstrMonthOld As String                    ||11653  |    Dim dstrMonthOld As String                    
11657  |    Dim dstrMonthNew As String                    ||11654  |    Dim dstrMonthNew As String                    
11658  |    Dim i As Integer                              ||11655  |    Dim i As Integer                              
11659  |    Dim RuleNoCnt                   As Integer  ' ||11656  |    Dim RuleNoCnt                   As Integer  ' 
11660  |    Dim KityuFlg                    As Boolean  ' ||11657  |    Dim KityuFlg                    As Boolean  ' 
11661  |                                                  ||11658  |                                                  
11662  |On Error GoTo OnErrorProc                         ||11659  |On Error GoTo OnErrorProc                         
11663  |                                                  ||11660  |                                                  
11664  |    '戻り値初期化                                 ||11661  |    '戻り値初期化                                 
11665  |    fnblMakePrint_New = False                     ||11662  |    fnblMakePrint_New = False                     
11666  |                                                  ||11663  |                                                  
11667  |    'エラー呼出元設定                             ||11664  |    'エラー呼出元設定                             
11668  |    strErrCall = conMeForm & ":" & conMeModule    ||11665  |    strErrCall = conMeForm & ":" & conMeModule    
11669  |                                                  ||11666  |                                                  
11670  |    '初期化                                       ||11667  |    '初期化                                       
11671  |    lRecCnt = 0                                   ||11668  |    lRecCnt = 0                                   
11672  |    lRecDayCnt = 0                                ||11669  |    lRecDayCnt = 0                                
11673  |    gProcessCnt = 0                               ||11670  |    gProcessCnt = 0                               
11674  |    lGridCnt = 0                                  ||11671  |    lGridCnt = 0                                  
11675  |    ddblNav = 0                                   ||11672  |    ddblNav = 0                                   
11676  |    ddblCnt = 0                                   ||11673  |    ddblCnt = 0                                   
11677  |                                                  ||11674  |                                                  
11678  |    'DBオープン                                   ||11675  |    'DBオープン                                   
11679  |    If Not gintDbOpen() Then                      ||11676  |    If Not gintDbOpen() Then                      
11680  |        Exit Function                             ||11677  |        Exit Function                             
11681  |    End If                                        ||11678  |    End If                                        
11682  |                                                  ||11679  |                                                  
11683  |    'グリッドデータを配列に格納する               ||11680  |    'グリッドデータを配列に格納する               
11684  |    '配列初期化                                   ||11681  |    '配列初期化                                   
11685  |    ReDim gbuMGetUPDRec.N(0)                      ||11682  |    ReDim gbuMGetUPDRec.N(0)                      
11686  |    'スプレット表示件数が１件以上の場合のみ       ||11683  |    'スプレット表示件数が１件以上の場合のみ       
11687  |    With fgridMakePrint                           ||11684  |    With fgridMakePrint                           
11688  |        If .Rows > 1 Then                         ||11685  |        If .Rows > 1 Then                         
11689  |            'グリッドデータセット処理             ||11686  |            'グリッドデータセット処理             
11690  |            For lGridCnt = 0 To .Rows - 2         ||11687  |            For lGridCnt = 0 To .Rows - 2         
11691  |                '出力列を選択する                 ||11688  |                '出力列を選択する                 
11692  |                .Col = conColSysOutbln            ||11689  |                .Col = conColSysOutbln            
11693  |                .Row = lGridCnt + 1               ||11690  |                .Row = lGridCnt + 1               
11694  |                If .Text = True Then              ||11691  |                If .Text = True Then              
11695  |                    '対象データ抽出               ||11692  |                    '対象データ抽出               
11696  |                    Call sbGridDataGet(lGridCnt, l||11693  |                    Call sbGridDataGet(lGridCnt, l
11697  |                    '配列の要素数設定カウンターア ||11694  |                    '配列の要素数設定カウンターア 
11698  |                    lRecCnt = lRecCnt + 1         ||11695  |                    lRecCnt = lRecCnt + 1         
11699  |                End If                            ||11696  |                End If                            
11700  |            Next lGridCnt                         ||11697  |            Next lGridCnt                         
11701  |        Else                                      ||11698  |        Else                                      
11702  |            MsgBox "グリッドデータがないですよ！",||11699  |            MsgBox "グリッドデータがないですよ！",
11703  |            Exit Function                         ||11700  |            Exit Function                         
11704  |        End If                                    ||11701  |        End If                                    
11705  |        '後で使うので、カウンター変数を初期化     ||11702  |        '後で使うので、カウンター変数を初期化     
11706  |        lRecCnt = 0                               ||11703  |        lRecCnt = 0                               
11707  |    End With                                      ||11704  |    End With                                      
11708  |                                                  ||11705  |                                                  
11709  |    '取得した契約番号分ループする                 ||11706  |    '取得した契約番号分ループする                 
11710  |    For Cnt = LBound(gbuMGetUPDRec.N) To UBound(gb||11707  |    For Cnt = LBound(gbuMGetUPDRec.N) To UBound(gb
11711  |        '変数の初期化                             ||11708  |        '変数の初期化                             
11712  |        mstrPaymentDate = ""                      ||11709  |        mstrPaymentDate = ""                      
11713  |        mstrNearSettleDate = ""                   ||11710  |        mstrNearSettleDate = ""                   
11714  |        mstrSettlementDate = ""                   ||11711  |        mstrSettlementDate = ""                   
11715  |        msAccCode = ""                            ||11712  |        msAccCode = ""                            
11716  |        msMotherAccCode = ""                      ||11713  |        msMotherAccCode = ""                      
11717  |        msAssetFlg = ""                           ||11714  |        msAssetFlg = ""                           
11718  |        msContNo = ""                             ||11715  |        msContNo = ""                             
11719  |        MonthlyCnt = 0                            ||11716  |        MonthlyCnt = 0                            
11720  |        LastYearFlag = False                      ||11717  |        LastYearFlag = False                      
11721  |                                                  ||11718  |                                                  
11722  |        '契約毎のシート番号を付番する             ||11719  |        '契約毎のシート番号を付番する             
11723  |        gTotalCnt = gTotalCnt + 1                 ||11720  |        gTotalCnt = gTotalCnt + 1                 
11724  |                                                  ||11721  |                                                  
11725  |        '支払予定日をセット                       ||11722  |        '支払予定日をセット                       
11726  |        sPayDate = gbuMGetUPDRec.N(Cnt).MGET_payme||11723  |        sPayDate = gbuMGetUPDRec.N(Cnt).MGET_payme
11727  |        mstrPaymentDate = gbuMGetUPDRec.N(Cnt).MGE||11724  |        mstrPaymentDate = gbuMGetUPDRec.N(Cnt).MGE
11728  |        '処理回数をカウントアップ                 ||11725  |        '処理回数をカウントアップ                 
11729  |        gProcessCnt = gProcessCnt + 1             ||11726  |        gProcessCnt = gProcessCnt + 1             
11730  |        '外部委託顧問料締日取得                   ||11727  |        '外部委託顧問料締日取得                   
11731  |        sContractNo = gbuMGetUPDRec.N(Cnt).MGET_co||11728  |        sContractNo = gbuMGetUPDRec.N(Cnt).MGET_co
11732  |        sSettleDate = gbuMGetUPDRec.N(Cnt).MGET_se||11729  |        sSettleDate = gbuMGetUPDRec.N(Cnt).MGET_se
11733  |        '基準年をセット                           ||11730  |        '基準年をセット                           
11734  |        mstrbaseYear = Mid(sSettleDate, 1, 4)     ||11731  |        mstrbaseYear = Mid(sSettleDate, 1, 4)     
11735  |        '直近締日を設定                           ||11732  |        '直近締日を設定                           
11736  |        mstrNearSettleDate = sSettleDate          ||11733  |        mstrNearSettleDate = sSettleDate          
11737  |                                                  ||11734  |                                                  
11738  |        '前回締日営業日翌日の設定                 ||11735  |        '前回締日営業日翌日の設定                 
11739  |        mstrSettlementDate = gbuMGetUPDRec.N(Cnt).||11736  |        mstrSettlementDate = gbuMGetUPDRec.N(Cnt).
11740  |        '顧問料計算開始日・終了日との整合性をチェ ||11737  |        '顧問料計算開始日・終了日との整合性をチェ 
11741  |        sStart = gbuMGetUPDRec.N(Cnt).MGET_com_cal||11738  |        sStart = gbuMGetUPDRec.N(Cnt).MGET_com_cal
11742  |        sEnd = gbuMGetUPDRec.N(Cnt).MGET_com_calc_||11739  |        sEnd = gbuMGetUPDRec.N(Cnt).MGET_com_calc_
11743  |        '前回締日 < 顧問料計算開始日 の場合、顧問 ||11740  |        '前回締日 < 顧問料計算開始日 の場合、顧問 
11744  |        If sStart <> "" Then                      ||11741  |        If sStart <> "" Then                      
11745  |            If mstrSettlementDate < sStart Then   ||11742  |            If mstrSettlementDate < sStart Then   
11746  |                mstrSettlementDate = sStart       ||11743  |                mstrSettlementDate = sStart       
11747  |            End If                                ||11744  |            End If                                
11748  |        End If                                    ||11745  |        End If                                    
11749  |                                                  ||11746  |                                                  
11750  |        '直近締日 < 顧問料計算終了日 の場合、顧問 ||11747  |        '直近締日 < 顧問料計算終了日 の場合、顧問 
11751  |        If sEnd <> "" Then                        ||11748  |        If sEnd <> "" Then                        
11752  |            If mstrNearSettleDate > sEnd Then     ||11749  |            If mstrNearSettleDate > sEnd Then     
11753  |                mstrNearSettleDate = sEnd         ||11750  |                mstrNearSettleDate = sEnd         
11754  |            End If                                ||11751  |            End If                                
11755  |        End If                                    ||11752  |        End If                                    
11756  |                                                  ||11753  |                                                  
11757  |'SQL文の作成(外部委託顧問料資産種別取得)          ||11754  |'SQL文の作成(外部委託顧問料資産種別取得)          
11758  |        msContNo = gbuMGetUPDRec.N(Cnt).MGET_contr||11755  |        msContNo = gbuMGetUPDRec.N(Cnt).MGET_contr
11759  |        sSql = gstrEditSQLcfr_OtherComRuleAssetFlg||11756  |        sSql = gstrEditSQLcfr_OtherComRuleAssetFlg
11760  |        'ﾀﾞｲﾅｾｯﾄの作成                            ||11757  |        'ﾀﾞｲﾅｾｯﾄの作成                            
11761  |        If gintDyCreate(sSql) = False Then        ||11758  |        If gintDyCreate(sSql) = False Then        
11762  |            Exit Function                         ||11759  |            Exit Function                         
11763  |        End If                                    ||11760  |        End If                                    
11764  |        'EOF判定処理                              ||11761  |        'EOF判定処理                              
11765  |        If Not gblnDyEOF() Then                   ||11762  |        If Not gblnDyEOF() Then                   
11766  |            msAccCode = Trim(gvlnDyDataS("ACCOUNT_||11763  |            msAccCode = Trim(gvlnDyDataS("ACCOUNT_
11767  |            msMotherAccCode = Trim(gvlnDyDataS("MO||11764  |            msMotherAccCode = Trim(gvlnDyDataS("MO
11768  |            msAssetFlg = gvlnDyDataN("ASSET_FLAG")||11765  |            msAssetFlg = gvlnDyDataN("ASSET_FLAG")
11769  |        'マザーファンドが存在しない場合は資産種類 ||11766  |        'マザーファンドが存在しない場合は資産種類 
11770  |        Else                                      ||11767  |        Else                                      
11771  |            msAssetFlg = "0"                      ||11768  |            msAssetFlg = "0"                      
11772  |        End If                                    ||11769  |        End If                                    
11773  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         ||11770  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         
11774  |        Call gblnDyClose                          ||11771  |        Call gblnDyClose                          
11775  |                                                  ||11772  |                                                  
11776  |        '資産種類がマザー組入資産の場合、マザーフ ||11773  |        '資産種類がマザー組入資産の場合、マザーフ 
11777  |        If msAssetFlg = "1" Then                  ||11774  |        If msAssetFlg = "1" Then                  
11778  |            sSql = gstrEditSQLcfr_BaseCurrencyCode||11775  |            sSql = gstrEditSQLcfr_BaseCurrencyCode
11779  |            'ﾀﾞｲﾅｾｯﾄの作成                        ||11776  |            'ﾀﾞｲﾅｾｯﾄの作成                        
11780  |            If gintDyCreate(sSql) = False Then    ||11777  |            If gintDyCreate(sSql) = False Then    
11781  |                Exit Function                     ||11778  |                Exit Function                     
11782  |            End If                                ||11779  |            End If                                
11783  |            'EOF判定処理                          ||11780  |            'EOF判定処理                          
11784  |            If Not gblnDyEOF() Then               ||11781  |            If Not gblnDyEOF() Then               
11785  |                'マザーファンドコードの口座ベース ||11782  |                'マザーファンドコードの口座ベース 
11786  |                gbuMGetUPDRec.N(Cnt).MGET_base_cur||11783  |                gbuMGetUPDRec.N(Cnt).MGET_base_cur
11787  |            End If                                ||11784  |            End If                                
11788  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||11785  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
11789  |            Call gblnDyClose                      ||11786  |            Call gblnDyClose                      
11790  |        End If                                    ||11787  |        End If                                    
11791  |                                                  ||11788  |                                                  
11792  |'SQL文の作成(外部委託顧問料率取得)                ||11789  |'SQL文の作成(外部委託顧問料率取得)                
11793  |        '計算期間の開始日と終了日に含まれる適用期 ||11790  |        '計算期間の開始日と終了日に含まれる適用期 
11794  |        'ルールNoの期中料率を全て取得する｡        ||11791  |        'ルールNoの期中料率を全て取得する｡        
11795  |        sSql = gstrEditSQLcfr_OtherComRateForSelec||11792  |        sSql = gstrEditSQLcfr_OtherComRateForSelec
11796  |            sContractNo, mstrSettlementDate, mstrN||11793  |            sContractNo, mstrSettlementDate, mstrN
11797  |'        sSql = gstrEditSQLcfr_OtherComRateForSele||11794  |'        sSql = gstrEditSQLcfr_OtherComRateForSele
11798  |            sContractNo, 1)                       ||11795  |            sContractNo, 1)                       
11799  |                                                  ||11796  |                                                  
11800  |        'ﾀﾞｲﾅｾｯﾄの作成                            ||11797  |        'ﾀﾞｲﾅｾｯﾄの作成                            
11801  |        If gintDyCreate(sSql) = False Then        ||11798  |        If gintDyCreate(sSql) = False Then        
11802  |            Exit Function                         ||11799  |            Exit Function                         
11803  |        End If                                    ||11800  |        End If                                    
11804  |        '配列初期化                               ||11801  |        '配列初期化                               
11805  |        ReDim gbuOtherComRateGetUPDRec.N(0)       ||11802  |        ReDim gbuOtherComRateGetUPDRec.N(0)       
11806  |        MonthlyCnt = 0                            ||11803  |        MonthlyCnt = 0                            
11807  |        'EOF判定処理                              ||11804  |        'EOF判定処理                              
11808  |        Do Until gblnDyEOF()                      ||11805  |        Do Until gblnDyEOF()                      
11809  |            '対象データ抽出                       ||11806  |            '対象データ抽出                       
11810  |            Call sbOtherComDataGet(MonthlyCnt)    ||11807  |            Call sbOtherComDataGet(MonthlyCnt)    
11811  |            MonthlyCnt = MonthlyCnt + 1           ||11808  |            MonthlyCnt = MonthlyCnt + 1           
11812  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     ||11809  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     
11813  |            Call gDyNext                          ||11810  |            Call gDyNext                          
11814  |        Loop                                      ||11811  |        Loop                                      
11815  |                                                  ||11812  |                                                  
11816  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         ||11813  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         
11817  |        Call gblnDyClose                          ||11814  |        Call gblnDyClose                          
11818  |                                                  ||11815  |                                                  
11819  |        '外部委託顧問料ルールNoの数を取得         ||11816  |        '外部委託顧問料ルールNoの数を取得         
11820  |        RuleNoCnt = 0                             ||11817  |        RuleNoCnt = 0                             
11821  |        RuleNoCnt = gbuOtherComRateGetUPDRec.N(0).||11818  |        RuleNoCnt = gbuOtherComRateGetUPDRec.N(0).
11822  |                                                  ||11819  |                                                  
11823  |        '期中料率変更契約か識別する               ||11820  |        '期中料率変更契約か識別する               
11824  |        If RuleNoCnt > 1 Then                     ||11821  |        If RuleNoCnt > 1 Then                     
11825  |            KityuFlg = True  '期中変更有り        ||11822  |            KityuFlg = True  '期中変更有り        
11826  |        Else                                      ||11823  |        Else                                      
11827  |            KityuFlg = False '期中変更無し        ||11824  |            KityuFlg = False '期中変更無し        
11828  |        End If                                    ||11825  |        End If                                    
11829  |                                                  ||11826  |                                                  
11830  |'確認書の作成                                     ||11827  |'確認書の作成                                     
11831  |                                                  ||11828  |                                                  
11832  |        If gProcessCnt <> 1 Then                  ||11829  |        If gProcessCnt <> 1 Then                  
11833  |            '2回目以降はシートの追加              ||11830  |            '2回目以降はシートの追加              
11834  |            xlBook.Worksheets.Add after:=xlBook.Sh||11831  |            xlBook.Worksheets.Add after:=xlBook.Sh
11835  |        Else                                      ||11832  |        Else                                      
11836  |            '1回目はオブジェクトの設定            ||11833  |            '1回目はオブジェクトの設定            
11837  |            Set xlApp = CreateObject("Excel.Applic||11834  |            Set xlApp = CreateObject("Excel.Applic
11838  |            Set xlBook = xlApp.Workbooks.Add      ||11835  |            Set xlBook = xlApp.Workbooks.Add      
11839  |        End If                                    ||11836  |        End If                                    
11840  |        Set xlSheet = xlBook.Sheets(gProcessCnt)  ||11837  |        Set xlSheet = xlBook.Sheets(gProcessCnt)  
11841  |                                                  ||11838  |                                                  
11842  |        '期中料率変更無し                         ||11839  |        '期中料率変更無し                         
11843  |        If KityuFlg = False Then                  ||11840  |        If KityuFlg = False Then                  
11844  |            If fnblExcelOut_NotChgRate(Cnt) = Fals||11841  |            If fnblExcelOut_NotChgRate(Cnt) = Fals
11845  |                MsgBox "確認書の作成でエラーが発生||11842  |                MsgBox "確認書の作成でエラーが発生
11846  |                Exit Function                     ||11843  |                Exit Function                     
11847  |            End If                                ||11844  |            End If                                
11848  |                                                  ||11845  |                                                  
11849  |            If gbuMGetUPDRec.N(Cnt).MGET_company_f||11846  |            If gbuMGetUPDRec.N(Cnt).MGET_company_f
11850  |                xlBook.Worksheets.Add after:=xlBoo||11847  |                xlBook.Worksheets.Add after:=xlBoo
11851  |                gProcessCnt = gProcessCnt + 1     ||11848  |                gProcessCnt = gProcessCnt + 1     
11852  |                                                  ||11849  |                                                  
11853  |                If fnblExcelEnglishOut_NotChgRate(||11850  |                If fnblExcelEnglishOut_NotChgRate(
11854  |                    MsgBox "英文確認書の作成でエラ||11851  |                    MsgBox "英文確認書の作成でエラ
11855  |                    Exit Function                 ||11852  |                    Exit Function                 
11856  |                End If                            ||11853  |                End If                            
11857  |            End If                                ||11854  |            End If                                
11858  |        '期中料率変更有り                         ||11855  |        '期中料率変更有り                         
11859  |        Else                                      ||11856  |        Else                                      
11860  |            If fnblExcelOut_ChangeRate(Cnt) = Fals||11857  |            If fnblExcelOut_ChangeRate(Cnt) = Fals
11861  |                MsgBox "確認書の作成でエラーが発生||11858  |                MsgBox "確認書の作成でエラーが発生
11862  |                Exit Function                     ||11859  |                Exit Function                     
11863  |            End If                                ||11860  |            End If                                
11864  |                                                  ||11861  |                                                  
11865  |            If gbuMGetUPDRec.N(Cnt).MGET_company_f||11862  |            If gbuMGetUPDRec.N(Cnt).MGET_company_f
11866  |                xlBook.Worksheets.Add after:=xlBoo||11863  |                xlBook.Worksheets.Add after:=xlBoo
11867  |                gProcessCnt = gProcessCnt + 1     ||11864  |                gProcessCnt = gProcessCnt + 1     
11868  |                                                  ||11865  |                                                  
11869  |                If fnblExcelEnglishOut_ChangeRate(||11866  |                If fnblExcelEnglishOut_ChangeRate(
11870  |                    MsgBox "英文確認書の作成でエラ||11867  |                    MsgBox "英文確認書の作成でエラ
11871  |                    Exit Function                 ||11868  |                    Exit Function                 
11872  |                End If                            ||11869  |                End If                            
11873  |            End If                                ||11870  |            End If                                
11874  |        End If                                    ||11871  |        End If                                    
11875  |                                                  ||11872  |                                                  
11876  |        'Excel の Worksheet 削除用カウンタ変数    ||11873  |        'Excel の Worksheet 削除用カウンタ変数    
11877  |        Dim Ws_Cnt      As Integer                ||11874  |        Dim Ws_Cnt      As Integer                
11878  |        Dim Ws_Del_Cnt  As Integer                ||11875  |        Dim Ws_Del_Cnt  As Integer                
11879  |        Dim Ws_Del_Cnt2 As Integer                ||11876  |        Dim Ws_Del_Cnt2 As Integer                
11880  |                                                  ||11877  |                                                  
11881  |                                                  ||11878  |                                                  
11882  |        '動的ファイル名部分を取得                 ||11879  |        '動的ファイル名部分を取得                 
11883  |        If gTotalProcessCnt = 1 Then              ||11880  |        If gTotalProcessCnt = 1 Then              
11884  |            Call sbFileNameChange                 ||11881  |            Call sbFileNameChange                 
11885  |        End If                                    ||11882  |        End If                                    
11886  |                                                  ||11883  |                                                  
11887  |        'Excel の Worksheet 削除用カウンタ初期化  ||11884  |        'Excel の Worksheet 削除用カウンタ初期化  
11888  |        Ws_Cnt = xlBook.Worksheets.Count          ||11885  |        Ws_Cnt = xlBook.Worksheets.Count          
11889  |        Ws_Del_Cnt2 = 0                           ||11886  |        Ws_Del_Cnt2 = 0                           
11890  |        '出力するデータ数のカウント(gSysoutDataCnt||11887  |        '出力するデータ数のカウント(gSysoutDataCnt
11891  |        If gTotalProcessCnt = gSysoutDataCnt Then ||11888  |        If gTotalProcessCnt = gSysoutDataCnt Then 
11892  |            ' WorkBookが存在すれば削除            ||11889  |            ' WorkBookが存在すれば削除            
11893  |            If Dir(mstrFileName) <> "" Then       ||11890  |            If Dir(mstrFileName) <> "" Then       
11894  |                Kill (mstrFileName)               ||11891  |                Kill (mstrFileName)               
11895  |            End If                                ||11892  |            End If                                
11896  |                                                  ||11893  |                                                  
11897  |            'シート名を調査しシート削除           ||11894  |            'シート名を調査しシート削除           
11898  |            For Ws_Del_Cnt = 1 To Ws_Cnt          ||11895  |            For Ws_Del_Cnt = 1 To Ws_Cnt          
11899  |                If Left(xlBook.Worksheets(Ws_Del_C||11896  |                If Left(xlBook.Worksheets(Ws_Del_C
11900  |                    'シートの削除                 ||11897  |                    'シートの削除                 
11901  |                    Application.DisplayAlerts = Fa||11898  |                    Application.DisplayAlerts = Fa
11902  |                    xlBook.Worksheets(Ws_Del_Cnt).||11899  |                    xlBook.Worksheets(Ws_Del_Cnt).
11903  |                    Application.DisplayAlerts = Tr||11900  |                    Application.DisplayAlerts = Tr
11904  |                    Ws_Del_Cnt = Ws_Del_Cnt - 1   ||11901  |                    Ws_Del_Cnt = Ws_Del_Cnt - 1   
11905  |                    Ws_Del_Cnt2 = Ws_Del_Cnt2 + 1 ||11902  |                    Ws_Del_Cnt2 = Ws_Del_Cnt2 + 1 
11906  |                    If Ws_Del_Cnt2 = 2 Then       ||11903  |                    If Ws_Del_Cnt2 = 2 Then       
11907  |                        Exit For                  ||11904  |                        Exit For                  
11908  |                    End If                        ||11905  |                    End If                        
11909  |                End If                            ||11906  |                End If                            
11910  |            Next Ws_Del_Cnt                       ||11907  |            Next Ws_Del_Cnt                       
11911  |                                                  ||11908  |                                                  
11912  |            '見易いようにシートの1枚目を選択する  ||11909  |            '見易いようにシートの1枚目を選択する  
11913  |            xlBook.Worksheets(1).Select           ||11910  |            xlBook.Worksheets(1).Select           
11914  |                                                  ||11911  |                                                  
11915  |            xlBook.SaveAs mstrFileName            ||11912  |            xlBook.SaveAs mstrFileName            
11916  |            xlBook.Close                          ||11913  |            xlBook.Close                          
11917  |            xlApp.Quit                            ||11914  |            xlApp.Quit                            
11918  |                                                  ||11915  |                                                  
11919  |            Set xlApp = Nothing                   ||11916  |            Set xlApp = Nothing                   
11920  |            Set xlBook = Nothing                  ||11917  |            Set xlBook = Nothing                  
11921  |            Set xlSheet = Nothing                 ||11918  |            Set xlSheet = Nothing                 
11922  |                                                  ||11919  |                                                  
11923  |            '処理回数カウンターの初期化           ||11920  |            '処理回数カウンターの初期化           
11924  |            gProcessCnt = 0                       ||11921  |            gProcessCnt = 0                       
11925  |            '保存ファイル名の修正                 ||11922  |            '保存ファイル名の修正                 
11926  |            gSaveFileCnt = gSaveFileCnt + 1       ||11923  |            gSaveFileCnt = gSaveFileCnt + 1       
11927  |            mstrFileName = mstrFileNameBK & " (" &||11924  |            mstrFileName = mstrFileNameBK & " (" &
11928  |        End If                                    ||11925  |        End If                                    
11929  |        '料率格納配列を消去する                   ||11926  |        '料率格納配列を消去する                   
11930  |        Erase gtypOtherComRec                     ||11927  |        Erase gtypOtherComRec                     
11931  |    Next Cnt                                      ||11928  |    Next Cnt                                      
11932  |                                                  ||11929  |                                                  
11933  |    '正常戻り値セット                             ||11930  |    '正常戻り値セット                             
11934  |    fnblMakePrint_New = True                      ||11931  |    fnblMakePrint_New = True                      
11935  |    GoTo EndProc                                  ||11932  |    GoTo EndProc                                  
11936  |                                                  ||11933  |                                                  
11937  |OnErrorProc:                                      ||11934  |OnErrorProc:                                      
11938  |    Call subError("システムエラー", Str(Err.Number||11935  |    Call subError("システムエラー", Str(Err.Number
11939  |        Error, strErrCall, conTitle)              ||11936  |        Error, strErrCall, conTitle)              
11940  |    'マウスポインター元に戻す                     ||11937  |    'マウスポインター元に戻す                     
11941  |    Screen.MousePointer = vbDefault               ||11938  |    Screen.MousePointer = vbDefault               
11942  |                                                  ||11939  |                                                  
11943  |EndProc:                                          ||11940  |EndProc:                                          
11944  |                                                  ||11941  |                                                  
11945  |End Function                                      ||11942  |End Function                                      
11946  |                                                  ||11943  |                                                  
11947  |'=================================================||11944  |'=================================================
11948  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelOut_NotChgRate      ||11945  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelOut_NotChgRate      
11949  |'機能            :   確認書のExcel出力(料率変更無 ||11946  |'機能            :   確認書のExcel出力(料率変更無 
11950  |'                                                 ||11947  |'                                                 
11951  |'日付               担当　              修正内容  ||11948  |'日付               担当　              修正内容  
11952  |'-------------------------------------------------||11949  |'-------------------------------------------------
11953  |'2006/07/03         K.Furuya <SRA>     RAFI対応   ||11950  |'2006/07/03         K.Furuya <SRA>     RAFI対応   
11954  |'                                      fnblExcelOu||11951  |'                                      fnblExcelOu
11955  |'2008/02/20         K.Furuya <SRA>     時価総額基 ||11952  |'2008/02/20         K.Furuya <SRA>     時価総額基 
11956  |'2008/03/26         K.Furuya<SRA>      ファンド決 ||11953  |'2008/03/26         K.Furuya<SRA>      ファンド決 
11957  |'2014/02/19         M.Takada   <SRA>   【管理会計 ||11954  |'2014/02/19         M.Takada   <SRA>   【管理会計 
11958  |'=================================================||11955  |'=================================================
11959  |Private Function fnblExcelOut_NotChgRate( _       ||11956  |Private Function fnblExcelOut_NotChgRate( _       
11960  |    ByVal lRecIdx As Long _                       ||11957  |    ByVal lRecIdx As Long _                       
11961  |) As Boolean                                      ||11958  |) As Boolean                                      
11962  |                                                  ||11959  |                                                  
11963  |                                                  ||11960  |                                                  
11964  |    Dim dStart      As Date     '計算期間　開始日 ||11961  |    Dim dStart      As Date     '計算期間　開始日 
11965  |    Dim dEnd        As Date     '計算期間　終了日 ||11962  |    Dim dEnd        As Date     '計算期間　終了日 
11966  |    Dim sSql        As String                     ||11963  |    Dim sSql        As String                     
11967  |    Dim sCurrencyCode As String '通貨コード(SQL文 ||11964  |    Dim sCurrencyCode As String '通貨コード(SQL文 
11968  |    Dim AccCode     As String   '口座コード(SQL文 ||11965  |    Dim AccCode     As String   '口座コード(SQL文 
11969  |    Dim sDate       As Date     '支払予定日       ||11966  |    Dim sDate       As Date     '支払予定日       
11970  |    Dim sName       As String   '担当者名         ||11967  |    Dim sName       As String   '担当者名         
11971  |    Dim i           As Integer  'カウンター       ||11968  |    Dim i           As Integer  'カウンター       
11972  |    Dim ColNum      As Integer  '部署名コンボボッ ||11969  |    Dim ColNum      As Integer  '部署名コンボボッ 
11973  |    Dim ColWord     As String   '部署名コンボボッ ||11970  |    Dim ColWord     As String   '部署名コンボボッ 
11974  |    Dim iSyouhizei  As Long     '消費税           ||11971  |    Dim iSyouhizei  As Long     '消費税           
11975  |    Dim iRowCnt     As Long     '月末純資産データ ||11972  |    Dim iRowCnt     As Long     '月末純資産データ 
11976  |    Dim TotalNav    As Currency '累積NAV          ||11973  |    Dim TotalNav    As Currency '累積NAV          
11977  |    Dim TotalRate   As Currency '累積閾値         ||11974  |    Dim TotalRate   As Currency '累積閾値         
11978  |    Dim cRate       As Currency '料率             ||11975  |    Dim cRate       As Currency '料率             
11979  |    Dim WorkRate    As Currency '一つ前の累積閾値 ||11976  |    Dim WorkRate    As Currency '一つ前の累積閾値 
11980  |    Dim TotalCom    As Currency '累積投資顧問料   ||11977  |    Dim TotalCom    As Currency '累積投資顧問料   
11981  |    Dim lTaxNum     As Currency '消費税値         ||11978  |    Dim lTaxNum     As Currency '消費税値         
11982  |    Dim lMonthlyPayCom As Currency  '月別支払額   ||11979  |    Dim lMonthlyPayCom As Currency  '月別支払額   
11983  |    Dim lCalcNav    As Currency '計算対象NAV      ||11980  |    Dim lCalcNav    As Currency '計算対象NAV      
11984  |    Dim iCalcNum    As Integer  '計算期間日数     ||11981  |    Dim iCalcNum    As Integer  '計算期間日数     
11985  |    'Excel の Application 変数とエラーをトラップす||11982  |    'Excel の Application 変数とエラーをトラップす
11986  |    Dim iTries      As Integer                    ||11983  |    Dim iTries      As Integer                    
11987  |    Dim strErrCall      As String 'エラー呼出元   ||11984  |    Dim strErrCall      As String 'エラー呼出元   
11988  |    Const conMeModule   As String = "fnblExcelOut_||11985  |    Const conMeModule   As String = "fnblExcelOut_
11989  |    'Excel の Worksheet 削除用カウンタ変数        ||11986  |    'Excel の Worksheet 削除用カウンタ変数        
11990  |    Dim Ws_Cnt      As Integer                    ||11987  |    Dim Ws_Cnt      As Integer                    
11991  |    Dim Ws_Del_Cnt  As Integer                    ||11988  |    Dim Ws_Del_Cnt  As Integer                    
11992  |    Dim Ws_Del_Cnt2 As Integer                    ||11989  |    Dim Ws_Del_Cnt2 As Integer                    
11993  |    Dim ContNo      As String   '契約番号(SQL文作 ||11990  |    Dim ContNo      As String   '契約番号(SQL文作 
11994  |    Dim NavGetCnt   As Long                       ||11991  |    Dim NavGetCnt   As Long                       
11995  |    Dim sGetAccCode As String                     ||11992  |    Dim sGetAccCode As String                     
11996  |    Dim Mnav_Flg    As String                     ||11993  |    Dim Mnav_Flg    As String                     
11997  |    Dim sStart As String            '計算対象　開 ||11994  |    Dim sStart As String            '計算対象　開 
11998  |    Dim sEnd As String              '計算対象　終 ||11995  |    Dim sEnd As String              '計算対象　終 
11999  |    Dim dstrBasedate As String      '基準日用ワー ||11996  |    Dim dstrBasedate As String      '基準日用ワー 
12000  |    Dim dstrCaldate() As String     'カレンダー日 ||11997  |    Dim dstrCaldate() As String     'カレンダー日 
12001  |    Dim ddblDailynav() As Double    '日次NAV用格納||11998  |    Dim ddblDailynav() As Double    '日次NAV用格納
12002  |    Dim dlngCnt As Long             '計算対象期間 ||11999  |    Dim dlngCnt As Long             '計算対象期間 
12003  |    Dim dstrCaldate2 As String      'カレンダー日 ||12000  |    Dim dstrCaldate2 As String      'カレンダー日 
12004  |    Dim dstrBasedate2 As String     '基準日(/編集)||12001  |    Dim dstrBasedate2 As String     '基準日(/編集)
12005  |    Dim dlngDiffdate As Long        'カレンダー日 ||12002  |    Dim dlngDiffdate As Long        'カレンダー日 
12006  |    Dim dintFor As Integer          'For文用変数  ||12003  |    Dim dintFor As Integer          'For文用変数  
12007  |    Dim ddblTtalnav As Double       '日次NAV累積用||12004  |    Dim ddblTtalnav As Double       '日次NAV累積用
12008  |    Dim dstrAvgNav As String                      ||12005  |    Dim dstrAvgNav As String                      
12009  |    Dim ddblNearNav As Double                     ||12006  |    Dim ddblNearNav As Double                     
12010  |    Dim dstrAccCd() As String                     ||12007  |    Dim dstrAccCd() As String                     
12011  |    Dim dstrBsCCd() As String                     ||12008  |    Dim dstrBsCCd() As String                     
12012  |    Dim intRtn      As Integer                    ||12009  |    Dim intRtn      As Integer                    
12013  |    Dim dstrDate         As String                ||12010  |    Dim dstrDate         As String                
12014  |    Dim dstrCurrencyCode As String                ||12011  |    Dim dstrCurrencyCode As String                
12015  |    Dim ddblExchangeRate As Double                ||12012  |    Dim ddblExchangeRate As Double                
12016  |    Dim dintPage    As Integer                    ||12013  |    Dim dintPage    As Integer                    
12017  |    Dim dintPageIni As Integer                    ||12014  |    Dim dintPageIni As Integer                    
12018  |    Dim dintAmari   As Integer                    ||12015  |    Dim dintAmari   As Integer                    
12019  |    Dim dCalDate    As Date                       ||12016  |    Dim dCalDate    As Date                       
12020  |    Dim J           As Integer                    ||12017  |    Dim J           As Integer                    
12021  |    Dim K           As Integer                    ||12018  |    Dim K           As Integer                    
12022  |    Dim L           As Integer                    ||12019  |    Dim L           As Integer                    
12023  |    Dim AvgNav      As Currency                   ||12020  |    Dim AvgNav      As Currency                   
12024  |    Dim dintFor2    As Integer                    ||12021  |    Dim dintFor2    As Integer                    
12025  |    Dim dlngMeisyoSu As Integer                   ||12022  |    Dim dlngMeisyoSu As Integer                   
12026  |    Dim dlngCntsv As Long                         ||12023  |    Dim dlngCntsv As Long                         
12027  |                                                  ||12024  |                                                  
12028  |    '2006/04/12 START K.Furuya 実払管理テーブル更 ||12025  |    '2006/04/12 START K.Furuya 実払管理テーブル更 
12029  |    Dim WkContractNo        As String             ||12026  |    Dim WkContractNo        As String             
12030  |    Dim WkCurCode           As String             ||12027  |    Dim WkCurCode           As String             
12031  |    Dim WkSettlementDate    As String             ||12028  |    Dim WkSettlementDate    As String             
12032  |    Dim WkFixComC           As String             ||12029  |    Dim WkFixComC           As String             
12033  |    Dim WkFixComJ           As String             ||12030  |    Dim WkFixComJ           As String             
12034  |    Dim WkRealComC          As String             ||12031  |    Dim WkRealComC          As String             
12035  |    Dim WkRealComJ          As String             ||12032  |    Dim WkRealComJ          As String             
12036  |    '2006/04/12 END   K.Furuya 実払管理テーブル更 ||12033  |    '2006/04/12 END   K.Furuya 実払管理テーブル更 
12037  |    '2006/07/08 START K.Furuya RAFI対応           ||12034  |    '2006/07/08 START K.Furuya RAFI対応           
12038  |    Dim ddblNearBabyMotherRate      As Double   ' ||12035  |    Dim ddblNearBabyMotherRate      As Double   ' 
12039  |    Dim MonthlyCnt                  As Long       ||12036  |    Dim MonthlyCnt                  As Long       
12040  |    Dim dblNavTotal                 As Double   ' ||12037  |    Dim dblNavTotal                 As Double   ' 
12041  |    '2006/07/08 END   K.Furuya RAFI対応           ||12038  |    '2006/07/08 END   K.Furuya RAFI対応           
12042  |                                                  ||12039  |                                                  
12043  |    '戻り値初期化                                 ||12040  |    '戻り値初期化                                 
12044  |    fnblExcelOut_NotChgRate = False               ||12041  |    fnblExcelOut_NotChgRate = False               
12045  |    i = 0                                         ||12042  |    i = 0                                         
12046  |                                                  ||12043  |                                                  
12047  |On Error Resume Next                              ||12044  |On Error Resume Next                              
12048  |                                                  ||12045  |                                                  
12049  |    'Excelフォーマットを調整                      ||12046  |    'Excelフォーマットを調整                      
12050  |    xlSheet.Cells.ColumnWidth = 1                 ||12047  |    xlSheet.Cells.ColumnWidth = 1                 
12051  |    xlSheet.Cells.Font.Size = 11                  ||12048  |    xlSheet.Cells.Font.Size = 11                  
12052  |                                                  ||12049  |                                                  
12053  |    'シート名を設定(確認書**)                     ||12050  |    'シート名を設定(確認書**)                     
12054  |    '契約毎のシート番号を付番する                 ||12051  |    '契約毎のシート番号を付番する                 
12055  |    'xlBook.Sheets(gProcessCnt).Name = sWord33 & (||12052  |    'xlBook.Sheets(gProcessCnt).Name = sWord33 & (
12056  |    xlBook.Sheets(gProcessCnt).Name = sWord33 & gT||12053  |    xlBook.Sheets(gProcessCnt).Name = sWord33 & gT
12057  |                                                  ||12054  |                                                  
12058  |    'シートの余白を設定                           ||12055  |    'シートの余白を設定                           
12059  |    xlSheet.PageSetup.TopMargin = Application.Inch||12056  |    xlSheet.PageSetup.TopMargin = Application.Inch
12060  |    xlSheet.PageSetup.BottomMargin = Application.I||12057  |    xlSheet.PageSetup.BottomMargin = Application.I
12061  |    xlSheet.PageSetup.LeftMargin = Application.Inc||12058  |    xlSheet.PageSetup.LeftMargin = Application.Inc
12062  |    xlSheet.PageSetup.RightMargin = Application.In||12059  |    xlSheet.PageSetup.RightMargin = Application.In
12063  |                                                  ||12060  |                                                  
12064  |    '総計の出力処理カウンターアップ               ||12061  |    '総計の出力処理カウンターアップ               
12065  |    gTotalProcessCnt = gTotalProcessCnt + 1       ||12062  |    gTotalProcessCnt = gTotalProcessCnt + 1       
12066  |                                                  ||12063  |                                                  
12067  |    DoEvents                                      ||12064  |    DoEvents                                      
12068  |    With xlSheet                                  ||12065  |    With xlSheet                                  
12069  |        '題目                                     ||12066  |        '題目                                     
12070  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||12067  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
12071  |            Case Mid(mstrContractFlag(1), 1, 1)   ||12068  |            Case Mid(mstrContractFlag(1), 1, 1)   
12072  |                .Cells(5, 1).Value = sWord0a      ||12069  |                .Cells(5, 1).Value = sWord0a      
12073  |            Case Mid(mstrContractFlag(2), 1, 1)   ||12070  |            Case Mid(mstrContractFlag(2), 1, 1)   
12074  |                .Cells(5, 1).Value = sWord0b      ||12071  |                .Cells(5, 1).Value = sWord0b      
12075  |            Case Mid(mstrContractFlag(3), 1, 1)   ||12072  |            Case Mid(mstrContractFlag(3), 1, 1)   
12076  |                .Cells(5, 1).Value = sWord0c      ||12073  |                .Cells(5, 1).Value = sWord0c      
12077  |            Case Else                             ||12074  |            Case Else                             
12078  |                MsgBox "契約区分が不正です。", vbC||12075  |                MsgBox "契約区分が不正です。", vbC
12079  |        End Select                                ||12076  |        End Select                                
12080  |        'フォントサイズ                           ||12077  |        'フォントサイズ                           
12081  |        .Cells(5, 1).Font.Size = 14               ||12078  |        .Cells(5, 1).Font.Size = 14               
12082  |        'フォント位置                             ||12079  |        'フォント位置                             
12083  |        .Range("A5:BG5").HorizontalAlignment = xlC||12080  |        .Range("A5:BG5").HorizontalAlignment = xlC
12084  |        '出力日付文字                             ||12081  |        '出力日付文字                             
12085  |        If RTrim(txtSysOutDate.Text) = "" Then    ||12082  |        If RTrim(txtSysOutDate.Text) = "" Then    
12086  |            .Cells(3, 50).Value = sWord34         ||12083  |            .Cells(3, 50).Value = sWord34         
12087  |            .Cells(3, 50).HorizontalAlignment = xl||12084  |            .Cells(3, 50).HorizontalAlignment = xl
12088  |        Else                                      ||12085  |        Else                                      
12089  |            .Cells(3, 43).Value = CStr(Format(txtS||12086  |            .Cells(3, 43).Value = CStr(Format(txtS
12090  |        End If                                    ||12087  |        End If                                    
12091  |        '財務部　担当者                           ||12088  |        '財務部　担当者                           
12092  |        sName = RTrim(txtInputName.Text)          ||12089  |        sName = RTrim(txtInputName.Text)          
12093  |        '財務部                                   ||12090  |        '財務部                                   
12094  |        .Cells(7, 37).Value = sWord1              ||12091  |        .Cells(7, 37).Value = sWord1              
12095  |        .Cells(8, 39).Value = sWord2 & sName      ||12092  |        .Cells(8, 39).Value = sWord2 & sName      
12096  |        '下記のとおり･･･ ,文言                    ||12093  |        '下記のとおり･･･ ,文言                    
12097  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||12094  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
12098  |            Case Mid(mstrContractFlag(1), 1, 1)   ||12095  |            Case Mid(mstrContractFlag(1), 1, 1)   
12099  |                .Cells(10, 2).Value = sWord3a     ||12096  |                .Cells(10, 2).Value = sWord3a     
12100  |            Case Mid(mstrContractFlag(2), 1, 1)   ||12097  |            Case Mid(mstrContractFlag(2), 1, 1)   
12101  |                .Cells(10, 2).Value = sWord3b     ||12098  |                .Cells(10, 2).Value = sWord3b     
12102  |            Case Mid(mstrContractFlag(3), 1, 1)   ||12099  |            Case Mid(mstrContractFlag(3), 1, 1)   
12103  |                .Cells(10, 2).Value = sWord3c     ||12100  |                .Cells(10, 2).Value = sWord3c     
12104  |            Case Else                             ||12101  |            Case Else                             
12105  |        End Select                                ||12102  |        End Select                                
12106  |        'ファンド名: ,文言                        ||12103  |        'ファンド名: ,文言                        
12107  |        .Cells(12, 2).Value = sWord4              ||12104  |        .Cells(12, 2).Value = sWord4              
12108  |        .Cells(12, 11).Value = sWord19            ||12105  |        .Cells(12, 11).Value = sWord19            
12109  |        .Cells(12, 13).Value = gbuMGetUPDRec.N(lRe||12106  |        .Cells(12, 13).Value = gbuMGetUPDRec.N(lRe
12110  |        'ファンドコード: ,文言                    ||12107  |        'ファンドコード: ,文言                    
12111  |        .Cells(13, 2).Value = sWord4_2            ||12108  |        .Cells(13, 2).Value = sWord4_2            
12112  |        .Cells(13, 11).Value = sWord19            ||12109  |        .Cells(13, 11).Value = sWord19            
12113  |        .Cells(13, 13).NumberFormatLocal = "@"    ||12110  |        .Cells(13, 13).NumberFormatLocal = "@"    
12114  |        '契約番号                                 ||12111  |        '契約番号                                 
12115  |        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_con||12112  |        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_con
12116  |                                                  ||12113  |                                                  
12117  |        'RAFI対応 START                           ||12114  |        'RAFI対応 START                           
12118  |        'NAV取得SQL                               ||12115  |        'NAV取得SQL                               
12119  |        '外部委託顧問料ルールの資産種類によって取 ||12116  |        '外部委託顧問料ルールの資産種類によって取 
12120  |        '純資産                                   ||12117  |        '純資産                                   
12121  |        If msAssetFlg = "0" Then                  ||12118  |        If msAssetFlg = "0" Then                  
12122  |            sSql = gstrEditSQLcfr_NavGetForSelectL||12119  |            sSql = gstrEditSQLcfr_NavGetForSelectL
12123  |        'マザー組入資産                           ||12120  |        'マザー組入資産                           
12124  |        Else                                      ||12121  |        Else                                      
12125  |            sSql = gstrEditSQLcfr_MotherAccGetForS||12122  |            sSql = gstrEditSQLcfr_MotherAccGetForS
12126  |        End If                                    ||12123  |        End If                                    
12127  |                                                  ||12124  |                                                  
12128  |        'ﾀﾞｲﾅｾｯﾄの作成                            ||12125  |        'ﾀﾞｲﾅｾｯﾄの作成                            
12129  |        If gintDyCreate(sSql) = False Then        ||12126  |        If gintDyCreate(sSql) = False Then        
12130  |            Exit Function                         ||12127  |            Exit Function                         
12131  |        End If                                    ||12128  |        End If                                    
12132  |                                                  ||12129  |                                                  
12133  |        '2006/04/12 START K.Furuya 実払管理テーブ ||12130  |        '2006/04/12 START K.Furuya 実払管理テーブ 
12134  |        '契約番号を取得                           ||12131  |        '契約番号を取得                           
12135  |        WkContractNo = ""                         ||12132  |        WkContractNo = ""                         
12136  |        WkContractNo = ContNo                     ||12133  |        WkContractNo = ContNo                     
12137  |        '2006/04/12 END   K.Furuya 実払管理テーブ ||12134  |        '2006/04/12 END   K.Furuya 実払管理テーブ 
12138  |                                                  ||12135  |                                                  
12139  |        Do Until gblnDyEOF()                      ||12136  |        Do Until gblnDyEOF()                      
12140  |            '動的配列更新                         ||12137  |            '動的配列更新                         
12141  |            ReDim Preserve gtypcfr_navget_tbl(0 To||12138  |            ReDim Preserve gtypcfr_navget_tbl(0 To
12142  |            ReDim Preserve dstrAccCd(0 To NavGetCn||12139  |            ReDim Preserve dstrAccCd(0 To NavGetCn
12143  |            'NAV取得抽出                          ||12140  |            'NAV取得抽出                          
12144  |            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT_||12141  |            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT_
12145  |            If NavGetCnt > 0 Then                 ||12142  |            If NavGetCnt > 0 Then                 
12146  |                sGetAccCode = sGetAccCode & " , " ||12143  |                sGetAccCode = sGetAccCode & " , " 
12147  |            Else                                  ||12144  |            Else                                  
12148  |                sGetAccCode = sGetAccCode & gtypcf||12145  |                sGetAccCode = sGetAccCode & gtypcf
12149  |            End If                                ||12146  |            End If                                
12150  |            '口座コードの格納(１契約複数口座の場合||12147  |            '口座コードの格納(１契約複数口座の場合
12151  |            dstrAccCd(NavGetCnt) = gtypcfr_navget_||12148  |            dstrAccCd(NavGetCnt) = gtypcfr_navget_
12152  |            NavGetCnt = NavGetCnt + 1             ||12149  |            NavGetCnt = NavGetCnt + 1             
12153  |            'マザー組入資産の場合ベビーファンドコ ||12150  |            'マザー組入資産の場合ベビーファンドコ 
12154  |            If msAssetFlg = "1" Then              ||12151  |            If msAssetFlg = "1" Then              
12155  |                msBabyAccountCode = ""            ||12152  |                msBabyAccountCode = ""            
12156  |                msBabyAccountCode = Trim(gvlnDyDat||12153  |                msBabyAccountCode = Trim(gvlnDyDat
12157  |            End If                                ||12154  |            End If                                
12158  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     ||12155  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     
12159  |            Call gDyNext                          ||12156  |            Call gDyNext                          
12160  |         Loop                                     ||12157  |         Loop                                     
12161  |        'RAFI対応 END                             ||12158  |        'RAFI対応 END                             
12162  |                                                  ||12159  |                                                  
12163  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         ||12160  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         
12164  |        Call gblnDyClose                          ||12161  |        Call gblnDyClose                          
12165  |                                                  ||12162  |                                                  
12166  |        '１契約複数口座の場合に口座のベース通貨に ||12163  |        '１契約複数口座の場合に口座のベース通貨に 
12167  |        ReDim dstrBsCCd(0 To NavGetCnt - 1)       ||12164  |        ReDim dstrBsCCd(0 To NavGetCnt - 1)       
12168  |        If NavGetCnt - 1 > 0 Then                 ||12165  |        If NavGetCnt - 1 > 0 Then                 
12169  |            For dintFor = 0 To NavGetCnt - 1      ||12166  |            For dintFor = 0 To NavGetCnt - 1      
12170  |                sSql = ""                         ||12167  |                sSql = ""                         
12171  |                sSql = sSql & "SELECT ACCOUNT_CODE||12168  |                sSql = sSql & "SELECT ACCOUNT_CODE
12172  |                sSql = sSql & "WHERE ACCOUNT_CODE ||12169  |                sSql = sSql & "WHERE ACCOUNT_CODE 
12173  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||12170  |                'ﾀﾞｲﾅｾｯﾄの作成                    
12174  |                If gintDyCreate(sSql) = False Then||12171  |                If gintDyCreate(sSql) = False Then
12175  |                    Exit Function                 ||12172  |                    Exit Function                 
12176  |                Else                              ||12173  |                Else                              
12177  |                    dstrBsCCd(dintFor) = gvlnDyDat||12174  |                    dstrBsCCd(dintFor) = gvlnDyDat
12178  |                End If                            ||12175  |                End If                            
12179  |                If dintFor > 0 Then               ||12176  |                If dintFor > 0 Then               
12180  |                    If dstrBsCCd(dintFor) <> dstrB||12177  |                    If dstrBsCCd(dintFor) <> dstrB
12181  |                        intRtn = MsgBox("ファンド ||12178  |                        intRtn = MsgBox("ファンド 
12182  |                        Exit Function             ||12179  |                        Exit Function             
12183  |                    End If                        ||12180  |                    End If                        
12184  |                End If                            ||12181  |                End If                            
12185  |            Next dintFor                          ||12182  |            Next dintFor                          
12186  |                                                  ||12183  |                                                  
12187  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||12184  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
12188  |            Call gblnDyClose                      ||12185  |            Call gblnDyClose                      
12189  |                                                  ||12186  |                                                  
12190  |        End If                                    ||12187  |        End If                                    
12191  |                                                  ||12188  |                                                  
12192  |        '口座コードをセルに配置                   ||12189  |        '口座コードをセルに配置                   
12193  |        'RAFI対応 START                           ||12190  |        'RAFI対応 START                           
12194  |        '純資産の場合                             ||12191  |        '純資産の場合                             
12195  |        If msAssetFlg = "0" Then                  ||12192  |        If msAssetFlg = "0" Then                  
12196  |            .Cells(13, 13).Value = sGetAccCode    ||12193  |            .Cells(13, 13).Value = sGetAccCode    
12197  |        'マザー組入資産の場合                     ||12194  |        'マザー組入資産の場合                     
12198  |        Else                                      ||12195  |        Else                                      
12199  |            .Cells(13, 13).Value = msBabyAccountCo||12196  |            .Cells(13, 13).Value = msBabyAccountCo
12200  |        End If                                    ||12197  |        End If                                    
12201  |        'RAFI対応 END                             ||12198  |        'RAFI対応 END                             
12202  |        '計算期間: ,文言                          ||12199  |        '計算期間: ,文言                          
12203  |        .Cells(15, 2).Value = sWord5              ||12200  |        .Cells(15, 2).Value = sWord5              
12204  |        .Cells(15, 11).Value = sWord19            ||12201  |        .Cells(15, 11).Value = sWord19            
12205  |        '前回締日・直近締日セット                 ||12202  |        '前回締日・直近締日セット                 
12206  |        dStart = CDate(gstrDateFormat(mstrSettleme||12203  |        dStart = CDate(gstrDateFormat(mstrSettleme
12207  |        dEnd = CDate(gstrDateFormat(mstrNearSettle||12204  |        dEnd = CDate(gstrDateFormat(mstrNearSettle
12208  |        dstrDate = Replace(CStr(dEnd), "/", "")   ||12205  |        dstrDate = Replace(CStr(dEnd), "/", "")   
12209  |                                                  ||12206  |                                                  
12210  |        '2006/04/12 START K.Furuya 実払管理テーブ ||12207  |        '2006/04/12 START K.Furuya 実払管理テーブ 
12211  |        '締日を取得                               ||12208  |        '締日を取得                               
12212  |        WkSettlementDate = ""                     ||12209  |        WkSettlementDate = ""                     
12213  |        WkSettlementDate = dstrDate               ||12210  |        WkSettlementDate = dstrDate               
12214  |        '2006/04/12 END   K.Furuya 実払管理テーブ ||12211  |        '2006/04/12 END   K.Furuya 実払管理テーブ 
12215  |                                                  ||12212  |                                                  
12216  |        '前回締日から直近締日の(日数 +1)を取得    ||12213  |        '前回締日から直近締日の(日数 +1)を取得    
12217  |        iCalcNum = DateDiff("d", dStart, dEnd) + 1||12214  |        iCalcNum = DateDiff("d", dStart, dEnd) + 1
12218  |                                                  ||12215  |                                                  
12219  |                                                  ||12216  |                                                  
12220  |                                                  ||12217  |                                                  
12221  |        '純資産総額: ,文言                        ||12218  |        '純資産総額: ,文言                        
12222  |        .Cells(17, 2).Value = sWord50             ||12219  |        .Cells(17, 2).Value = sWord50             
12223  |        .Cells(17, 11).Value = sWord19            ||12220  |        .Cells(17, 11).Value = sWord19            
12224  |                                                  ||12221  |                                                  
12225  |        '月末純資産: ,文言                        ||12222  |        '月末純資産: ,文言                        
12226  |        .Cells(19, 2).Value = sWord6              ||12223  |        .Cells(19, 2).Value = sWord6              
12227  |        .Cells(19, 11).Value = sWord19            ||12224  |        .Cells(19, 11).Value = sWord19            
12228  |                                                  ||12225  |                                                  
12229  |        '純資産 ,表中の文言                       ||12226  |        '純資産 ,表中の文言                       
12230  |        .Cells(19, 26).Value = sWord8             ||12227  |        .Cells(19, 26).Value = sWord8             
12231  |        .Range("Z19:AN19").HorizontalAlignment = x||12228  |        .Range("Z19:AN19").HorizontalAlignment = x
12232  |'2005/03/09 Start @@@@@ 合計行を出力しないならここ||12229  |'2005/03/09 Start @@@@@ 合計行を出力しないならここ
12233  |        '合計(純資産) ,表中の文言                 ||12230  |        '合計(純資産) ,表中の文言                 
12234  |        .Cells(33, 14).Value = sWord9             ||12231  |        .Cells(33, 14).Value = sWord9             
12235  |        .Range("N33:Y33").HorizontalAlignment = xl||12232  |        .Range("N33:Y33").HorizontalAlignment = xl
12236  |'2005/03/09 End @@@@@ 合計行を出力しないならここを||12233  |'2005/03/09 End @@@@@ 合計行を出力しないならここを
12237  |        '日付 ,表中の文言                         ||12234  |        '日付 ,表中の文言                         
12238  |        .Cells(19, 14).Value = sWord7             ||12235  |        .Cells(19, 14).Value = sWord7             
12239  |        .Range("N19:Y19").HorizontalAlignment = xl||12236  |        .Range("N19:Y19").HorizontalAlignment = xl
12240  |                                                  ||12237  |                                                  
12241  |        iRowCnt = 0                               ||12238  |        iRowCnt = 0                               
12242  |        TotalNav = 0                              ||12239  |        TotalNav = 0                              
12243  |        Mnav_Flg = 0                              ||12240  |        Mnav_Flg = 0                              
12244  |                                                  ||12241  |                                                  
12245  |'契約区分を判断する                               ||12242  |'契約区分を判断する                               
12246  |'        '契約区分「1」or「2」or (「3」and 取得NAV||12243  |'        '契約区分「1」or「2」or (「3」and 取得NAV
12247  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||12244  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
12248  |            Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c||12245  |            Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c
12249  |            Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_||12246  |            Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_
12250  |            And gbuMGetUPDRec.N(lRecIdx).MGET_nav_||12247  |            And gbuMGetUPDRec.N(lRecIdx).MGET_nav_
12251  |'取得NAV区分[1]                                   ||12248  |'取得NAV区分[1]                                   
12252  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g||12249  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g
12253  |                '月次NAVを取得する                ||12250  |                '月次NAVを取得する                
12254  |                Call sbMonthlyNAV_GetNotChgRate(lR||12251  |                Call sbMonthlyNAV_GetNotChgRate(lR
12255  |                                                  ||12252  |                                                  
12256  |                '月次NAVを累積                    ||12253  |                '月次NAVを累積                    
12257  |                For i = LBound(gtypcfr_mnav_tbl) T||12254  |                For i = LBound(gtypcfr_mnav_tbl) T
12258  |                    If Len(gtypcfr_mnav_tbl(i).BAS||12255  |                    If Len(gtypcfr_mnav_tbl(i).BAS
12259  |                        '日付                     ||12256  |                        '日付                     
12260  |                        .Cells(20 + i, 15).Value =||12257  |                        .Cells(20 + i, 15).Value =
12261  |                                WordYear & CInt(Mi||12258  |                                WordYear & CInt(Mi
12262  |                        '純資産                   ||12259  |                        '純資産                   
12263  |                        .Cells(20 + i, 39).NumberF||12260  |                        .Cells(20 + i, 39).NumberF
12264  |                        If gbuMGetUPDRec.N(lRecIdx||12261  |                        If gbuMGetUPDRec.N(lRecIdx
12265  |                            .Cells(20 + i, 39).Val||12262  |                            .Cells(20 + i, 39).Val
12266  |                        Else                      ||12263  |                        Else                      
12267  |                            .Cells(20 + i, 39).Val||12264  |                            .Cells(20 + i, 39).Val
12268  |                        End If                    ||12265  |                        End If                    
12269  |                        .Cells(20 + i, 39).Horizon||12266  |                        .Cells(20 + i, 39).Horizon
12270  |                        TotalNav = TotalNav + CCur||12267  |                        TotalNav = TotalNav + CCur
12271  |                        iRowCnt = iRowCnt + 1     ||12268  |                        iRowCnt = iRowCnt + 1     
12272  |                    Else                          ||12269  |                    Else                          
12273  |                        Mnav_Flg = 1              ||12270  |                        Mnav_Flg = 1              
12274  |                    End If                        ||12271  |                    End If                        
12275  |                Next i                            ||12272  |                Next i                            
12276  |                '日次NAVを算出                    ||12273  |                '日次NAVを算出                    
12277  |                If Mnav_Flg = 1 Then              ||12274  |                If Mnav_Flg = 1 Then              
12278  |                    i = i - 1                     ||12275  |                    i = i - 1                     
12279  |                End If                            ||12276  |                End If                            
12280  |                If mstrDailyNav <> "" Then        ||12277  |                If mstrDailyNav <> "" Then        
12281  |                    '日付                         ||12278  |                    '日付                         
12282  |                    .Cells(20 + i, 15).Value = CSt||12279  |                    .Cells(20 + i, 15).Value = CSt
12283  |                    '純資産                       ||12280  |                    '純資産                       
12284  |                    .Cells(20 + i, 39).NumberForma||12281  |                    .Cells(20 + i, 39).NumberForma
12285  |                    If gbuMGetUPDRec.N(lRecIdx).MG||12282  |                    If gbuMGetUPDRec.N(lRecIdx).MG
12286  |                        .Cells(20 + i, 39).Value =||12283  |                        .Cells(20 + i, 39).Value =
12287  |                    Else                          ||12284  |                    Else                          
12288  |                        .Cells(20 + i, 39).Value =||12285  |                        .Cells(20 + i, 39).Value =
12289  |                    End If                        ||12286  |                    End If                        
12290  |                    .Cells(20 + i, 39).HorizontalA||12287  |                    .Cells(20 + i, 39).HorizontalA
12291  |                    TotalNav = TotalNav + CCur(mst||12288  |                    TotalNav = TotalNav + CCur(mst
12292  |                    iRowCnt = iRowCnt + 1         ||12289  |                    iRowCnt = iRowCnt + 1         
12293  |                End If                            ||12290  |                End If                            
12294  |                  '合計(月末純資産)               ||12291  |                  '合計(月末純資産)               
12295  |                '合計行を出力しないならここをコメ ||12292  |                '合計行を出力しないならここをコメ 
12296  |                .Cells(33, 39).NumberFormatLocal =||12293  |                .Cells(33, 39).NumberFormatLocal =
12297  |                .Cells(17, 23).NumberFormatLocal =||12294  |                .Cells(17, 23).NumberFormatLocal =
12298  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||12295  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
12299  |                    '合計行を出力しないならここを ||12296  |                    '合計行を出力しないならここを 
12300  |                    .Cells(33, 39).Value = CStr(Fo||12297  |                    .Cells(33, 39).Value = CStr(Fo
12301  |                    .Cells(17, 23).Value = CStr(Fo||12298  |                    .Cells(17, 23).Value = CStr(Fo
12302  |                Else                              ||12299  |                Else                              
12303  |                    '合計行を出力しないならここを ||12300  |                    '合計行を出力しないならここを 
12304  |                    .Cells(33, 39).Value = CStr(Fo||12301  |                    .Cells(33, 39).Value = CStr(Fo
12305  |                    .Cells(17, 23).Value = CStr(Fo||12302  |                    .Cells(17, 23).Value = CStr(Fo
12306  |                End If                            ||12303  |                End If                            
12307  |                '合計行を出力しないならここをコメ ||12304  |                '合計行を出力しないならここをコメ 
12308  |                .Cells(33, 39).HorizontalAlignment||12305  |                .Cells(33, 39).HorizontalAlignment
12309  |                .Cells(17, 23).HorizontalAlignment||12306  |                .Cells(17, 23).HorizontalAlignment
12310  |                '平均純資産総額                   ||12307  |                '平均純資産総額                   
12311  |                .Cells(36, 2).Value = sWord51     ||12308  |                .Cells(36, 2).Value = sWord51     
12312  |                .Cells(36, 11).Value = sWord19    ||12309  |                .Cells(36, 11).Value = sWord19    
12313  |                  '計算期間の純資産総額の合計(月末||12310  |                  '計算期間の純資産総額の合計(月末
12314  |                .Cells(36, 23).NumberFormatLocal =||12311  |                .Cells(36, 23).NumberFormatLocal =
12315  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||12312  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
12316  |                    .Cells(36, 23).Value = CStr(Fo||12313  |                    .Cells(36, 23).Value = CStr(Fo
12317  |                Else                              ||12314  |                Else                              
12318  |                    .Cells(36, 23).Value = CStr(Fo||12315  |                    .Cells(36, 23).Value = CStr(Fo
12319  |                End If                            ||12316  |                End If                            
12320  |                .Cells(36, 23).HorizontalAlignment||12317  |                .Cells(36, 23).HorizontalAlignment
12321  |                  '計算期間の純資産総額の合計÷計 ||12318  |                  '計算期間の純資産総額の合計÷計 
12322  |                .Cells(36, 35).NumberFormatLocal =||12319  |                .Cells(36, 35).NumberFormatLocal =
12323  |                dblValueIn = TotalNav / iRowCnt   ||12320  |                dblValueIn = TotalNav / iRowCnt   
12324  |                                                  ||12321  |                                                  
12325  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||12322  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
12326  |                      Call sbGetRoundValue2(dblVal||12323  |                      Call sbGetRoundValue2(dblVal
12327  |                Else                              ||12324  |                Else                              
12328  |                      Call sbGetRoundValue(dblValu||12325  |                      Call sbGetRoundValue(dblValu
12329  |                End If                            ||12326  |                End If                            
12330  |                '平均NAV(計算対象NAV)             ||12327  |                '平均NAV(計算対象NAV)             
12331  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||12328  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
12332  |                    .Cells(36, 35).Value = CStr(Fo||12329  |                    .Cells(36, 35).Value = CStr(Fo
12333  |                Else                              ||12330  |                Else                              
12334  |                    .Cells(36, 35).Value = CStr(Fo||12331  |                    .Cells(36, 35).Value = CStr(Fo
12335  |                End If                            ||12332  |                End If                            
12336  |                '÷??＝ ,文言                     ||12333  |                '÷??＝ ,文言                     
12337  |                .Cells(36, 26).Value = sWord18 & "||12334  |                .Cells(36, 26).Value = sWord18 & "
12338  |                                                  ||12335  |                                                  
12339  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||12336  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
12340  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_n||12337  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_n
12341  |            '=====================================||12338  |            '=====================================
12342  |            '==                                   ||12339  |            '==                                   
12343  |            '==  '4':日次時価総額平均(休日込)の計 ||12340  |            '==  '4':日次時価総額平均(休日込)の計 
12344  |            '==                                   ||12341  |            '==                                   
12345  |            '=====================================||12342  |            '=====================================
12346  |                ddblTtalnav = 0                   ||12343  |                ddblTtalnav = 0                   
12347  |                For dintFor = 0 To NavGetCnt - 1  ||12344  |                For dintFor = 0 To NavGetCnt - 1  
12348  |                                                  ||12345  |                                                  
12349  |                    '日次時価総額平均取得         ||12346  |                    '日次時価総額平均取得         
12350  |                    sStart = gstrDateFormat2(CStr(||12347  |                    sStart = gstrDateFormat2(CStr(
12351  |                    sEnd = gstrDateFormat2(CStr(dE||12348  |                    sEnd = gstrDateFormat2(CStr(dE
12352  |                                                  ||12349  |                                                  
12353  |                    '計算開始日と外部委託顧問料計 ||12350  |                    '計算開始日と外部委託顧問料計 
12354  |                    If sStart = gbuMGetUPDRec.N(lR||12351  |                    If sStart = gbuMGetUPDRec.N(lR
12355  |                        '== SQL1 ==               ||12352  |                        '== SQL1 ==               
12356  |                        sSql = ""                 ||12353  |                        sSql = ""                 
12357  |                        sSql = sSql & "SELECT EIGY||12354  |                        sSql = sSql & "SELECT EIGY
12358  |                                                  ||12355  |                                                  
12359  |                        'ﾀﾞｲﾅｾｯﾄの作成            ||12356  |                        'ﾀﾞｲﾅｾｯﾄの作成            
12360  |                        If gintDyCreate(sSql) = Fa||12357  |                        If gintDyCreate(sSql) = Fa
12361  |                            Exit Function         ||12358  |                            Exit Function         
12362  |                        Else                      ||12359  |                        Else                      
12363  |                            '計算開始日が休日の場 ||12360  |                            '計算開始日が休日の場 
12364  |                            If gvlnDyDataS("EIGYO_||12361  |                            If gvlnDyDataS("EIGYO_
12365  |                                '翌営業日の時価総 ||12362  |                                '翌営業日の時価総 
12366  |                                '== SQL2 ==       ||12363  |                                '== SQL2 ==       
12367  |                                sSql = ""         ||12364  |                                sSql = ""         
12368  |                                sSql = sSql & "SEL||12365  |                                sSql = sSql & "SEL
12369  |                                sSql = sSql & "FRO||12366  |                                sSql = sSql & "FRO
12370  |                                sSql = sSql & "(SE||12367  |                                sSql = sSql & "(SE
12371  |                                sSql = sSql & "WHE||12368  |                                sSql = sSql & "WHE
12372  |                                                  ||12369  |                                                  
12373  |                                'ﾀﾞｲﾅｾｯﾄの作成    ||12370  |                                'ﾀﾞｲﾅｾｯﾄの作成    
12374  |                                If gintDyCreate(sS||12371  |                                If gintDyCreate(sS
12375  |                                    Exit Function ||12372  |                                    Exit Function 
12376  |                                Else              ||12373  |                                Else              
12377  |                                    ddblNearNav = ||12374  |                                    ddblNearNav = 
12378  |'2008/03/06 START 時価総額基準の外部委託顧問料対応||12375  |'2008/03/06 START 時価総額基準の外部委託顧問料対応
12379  |'                                    '翌営業日の計||12376  |'                                    '翌営業日の計
12380  |'                                    '== SQL3 ==  ||12377  |'                                    '== SQL3 ==  
12381  |'                                    sSql = ""    ||12378  |'                                    sSql = ""    
12382  |'                                    sSql = sSql &||12379  |'                                    sSql = sSql &
12383  |'                                    sSql = sSql &||12380  |'                                    sSql = sSql &
12384  |'                                    sSql = sSql &||12381  |'                                    sSql = sSql &
12385  |'                                    sSql = sSql &||12382  |'                                    sSql = sSql &
12386  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||12383  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
12387  |'                                    If gintDyCrea||12384  |'                                    If gintDyCrea
12388  |'                                        Exit Func||12385  |'                                        Exit Func
12389  |'                                    Else         ||12386  |'                                    Else         
12390  |'                                        '計算開始||12387  |'                                        '計算開始
12391  |'                                        sStart = ||12388  |'                                        sStart = 
12392  |'                                        dStart = ||12389  |'                                        dStart = 
12393  |'                                        .Cells(15||12390  |'                                        .Cells(15
12394  |'                                            CStr(||12391  |'                                            CStr(
12395  |'                                        iCalcNum ||12392  |'                                        iCalcNum 
12396  |'                                    End If       ||12393  |'                                    End If       
12397  |'2008/03/06 END   時価総額基準の外部委託顧問料対応||12394  |'2008/03/06 END   時価総額基準の外部委託顧問料対応
12398  |                                End If            ||12395  |                                End If            
12399  |                                'RAFI対応 START   ||12396  |                                'RAFI対応 START   
12400  |                                '翌営業日のマザー ||12397  |                                '翌営業日のマザー 
12401  |                                If msAssetFlg = "1||12398  |                                If msAssetFlg = "1
12402  |                                    '== SQL4 ==   ||12399  |                                    '== SQL4 ==   
12403  |                                    sSql = ""     ||12400  |                                    sSql = ""     
12404  |                                    sSql = sSql & ||12401  |                                    sSql = sSql & 
12405  |                                    sSql = sSql & ||12402  |                                    sSql = sSql & 
12406  |                                    sSql = sSql & ||12403  |                                    sSql = sSql & 
12407  |                                    sSql = sSql & ||12404  |                                    sSql = sSql & 
12408  |                                    sSql = sSql & ||12405  |                                    sSql = sSql & 
12409  |                                    sSql = sSql & ||12406  |                                    sSql = sSql & 
12410  |                                    sSql = sSql & ||12407  |                                    sSql = sSql & 
12411  |                                    sSql = sSql & ||12408  |                                    sSql = sSql & 
12412  |                                    sSql = sSql & ||12409  |                                    sSql = sSql & 
12413  |                                    sSql = sSql & ||12410  |                                    sSql = sSql & 
12414  |                                    sSql = sSql & ||12411  |                                    sSql = sSql & 
12415  |                                    sSql = sSql & ||12412  |                                    sSql = sSql & 
12416  |                                    sSql = sSql & ||12413  |                                    sSql = sSql & 
12417  |                                    sSql = sSql & ||12414  |                                    sSql = sSql & 
12418  |                                    sSql = sSql & ||12415  |                                    sSql = sSql & 
12419  |                                    sSql = sSql & ||12416  |                                    sSql = sSql & 
12420  |                                    sSql = sSql & ||12417  |                                    sSql = sSql & 
12421  |                                    sSql = sSql & ||12418  |                                    sSql = sSql & 
12422  |                                    sSql = sSql & ||12419  |                                    sSql = sSql & 
12423  |                                    sSql = sSql & ||12420  |                                    sSql = sSql & 
12424  |                                    sSql = sSql & ||12421  |                                    sSql = sSql & 
12425  |                                    sSql = sSql & ||12422  |                                    sSql = sSql & 
12426  |                                    sSql = sSql & ||12423  |                                    sSql = sSql & 
12427  |                                    sSql = sSql & ||12424  |                                    sSql = sSql & 
12428  |                                                  ||12425  |                                                  
12429  |                                    'ﾀﾞｲﾅｾｯﾄの作成||12426  |                                    'ﾀﾞｲﾅｾｯﾄの作成
12430  |                                                  ||12427  |                                                  
12431  |                                    If gintDyCreat||12428  |                                    If gintDyCreat
12432  |                                        Exit Funct||12429  |                                        Exit Funct
12433  |                                    Else          ||12430  |                                    Else          
12434  |                                        ddblNearBa||12431  |                                        ddblNearBa
12435  |                                    End If        ||12432  |                                    End If        
12436  |                                End If            ||12433  |                                End If            
12437  |                                'RAFI対応 END     ||12434  |                                'RAFI対応 END     
12438  |                            End If                ||12435  |                            End If                
12439  |                        End If                    ||12436  |                        End If                    
12440  |                    End If                        ||12437  |                    End If                        
12441  |                    '計算開始日から計算終了日まで ||12438  |                    '計算開始日から計算終了日まで 
12442  |                    '== SQL5 ==                   ||12439  |                    '== SQL5 ==                   
12443  |                    sSql = ""                     ||12440  |                    sSql = ""                     
12444  |                    sSql = sSql & "SELECT CAL_YYYY||12441  |                    sSql = sSql & "SELECT CAL_YYYY
12445  |                    sSql = sSql & "WHERE CAL_YYYY ||12442  |                    sSql = sSql & "WHERE CAL_YYYY 
12446  |                                                  ||12443  |                                                  
12447  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||12444  |                    'ﾀﾞｲﾅｾｯﾄの作成                
12448  |                    If gintDyCreate(sSql) = False ||12445  |                    If gintDyCreate(sSql) = False 
12449  |                        Exit Function             ||12446  |                        Exit Function             
12450  |                    End If                        ||12447  |                    End If                        
12451  |                                                  ||12448  |                                                  
12452  |                    If dlngCnt = 0 Then           ||12449  |                    If dlngCnt = 0 Then           
12453  |                        ReDim dstrCaldate(gbxOraDy||12450  |                        ReDim dstrCaldate(gbxOraDy
12454  |                        ReDim ddblDailynav(gbxOraD||12451  |                        ReDim ddblDailynav(gbxOraD
12455  |                    End If                        ||12452  |                    End If                        
12456  |                                                  ||12453  |                                                  
12457  |                    'EOF判定処理                  ||12454  |                    'EOF判定処理                  
12458  |                    dlngCnt = 0                   ||12455  |                    dlngCnt = 0                   
12459  |                                                  ||12456  |                                                  
12460  |                    Do Until gblnDyEOF()          ||12457  |                    Do Until gblnDyEOF()          
12461  |                        dlngCnt = dlngCnt + 1     ||12458  |                        dlngCnt = dlngCnt + 1     
12462  |                        '抽出データセット         ||12459  |                        '抽出データセット         
12463  |                        dstrCaldate(dlngCnt) = gvl||12460  |                        dstrCaldate(dlngCnt) = gvl
12464  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||12461  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
12465  |                        Call gDyNext              ||12462  |                        Call gDyNext              
12466  |                    Loop                          ||12463  |                    Loop                          
12467  |                                                  ||12464  |                                                  
12468  |                                                  ||12465  |                                                  
12469  |                    '2005/08/26　START            ||12466  |                    '2005/08/26　START            
12470  |                    '変数sStartに格納されている日 ||12467  |                    '変数sStartに格納されている日 
12471  |                    '変数sStartの直近の営業日の日 ||12468  |                    '変数sStartの直近の営業日の日 
12472  |                    '（変数sStartに格納されている ||12469  |                    '（変数sStartに格納されている 
12473  |                    '　直近日付が存在しない場合は ||12470  |                    '　直近日付が存在しない場合は 
12474  |                                                  ||12471  |                                                  
12475  |                    '計算開始日の日次時価総額基準 ||12472  |                    '計算開始日の日次時価総額基準 
12476  |                    '== SQL6 ==                   ||12473  |                    '== SQL6 ==                   
12477  |                    sSql = ""                     ||12474  |                    sSql = ""                     
12478  |                    sSql = sSql & "SELECT MAX(BASE||12475  |                    sSql = sSql & "SELECT MAX(BASE
12479  |                    sSql = sSql & "FROM   CFR_DAIL||12476  |                    sSql = sSql & "FROM   CFR_DAIL
12480  |                    sSql = sSql & "WHERE  BASE_DAT||12477  |                    sSql = sSql & "WHERE  BASE_DAT
12481  |                    sSql = sSql & "AND    ACCOUNT_||12478  |                    sSql = sSql & "AND    ACCOUNT_
12482  |                                                  ||12479  |                                                  
12483  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||12480  |                    'ﾀﾞｲﾅｾｯﾄの作成                
12484  |                    If gintDyCreate(sSql) = False ||12481  |                    If gintDyCreate(sSql) = False 
12485  |                        Exit Function             ||12482  |                        Exit Function             
12486  |                    End If                        ||12483  |                    End If                        
12487  |                                                  ||12484  |                                                  
12488  |                    Do Until gblnDyEOF()          ||12485  |                    Do Until gblnDyEOF()          
12489  |                       '抽出データセット          ||12486  |                       '抽出データセット          
12490  |                        sStart = gvlnDyDataS("BASE||12487  |                        sStart = gvlnDyDataS("BASE
12491  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||12488  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
12492  |                        Call gDyNext              ||12489  |                        Call gDyNext              
12493  |                    Loop                          ||12490  |                    Loop                          
12494  |                                                  ||12491  |                                                  
12495  |                    'RAFI対応 START               ||12492  |                    'RAFI対応 START               
12496  |                    '純資産の場合                 ||12493  |                    '純資産の場合                 
12497  |                    If msAssetFlg = "0" Then      ||12494  |                    If msAssetFlg = "0" Then      
12498  |                        '計算開始日から計算終了日 ||12495  |                        '計算開始日から計算終了日 
12499  |                        '== SQL7 ==               ||12496  |                        '== SQL7 ==               
12500  |                        sSql = ""                 ||12497  |                        sSql = ""                 
12501  |                        sSql = sSql & "SELECT ACCO||12498  |                        sSql = sSql & "SELECT ACCO
12502  |                        sSql = sSql & "WHERE CFR_D||12499  |                        sSql = sSql & "WHERE CFR_D
12503  |                        sSql = sSql & "AND   (CFR_||12500  |                        sSql = sSql & "AND   (CFR_
12504  |                        sSql = sSql & "ORDER BY CF||12501  |                        sSql = sSql & "ORDER BY CF
12505  |                    'マザー組入資産の場合         ||12502  |                    'マザー組入資産の場合         
12506  |                    Else                          ||12503  |                    Else                          
12507  |                        '計算開始日から計算終了日 ||12504  |                        '計算開始日から計算終了日 
12508  |                        '== SQL8 ==               ||12505  |                        '== SQL8 ==               
12509  |                        sSql = ""                 ||12506  |                        sSql = ""                 
12510  |                        sSql = sSql & "SELECT"    ||12507  |                        sSql = sSql & "SELECT"    
12511  |                        sSql = sSql & "    a.ACCOU||12508  |                        sSql = sSql & "    a.ACCOU
12512  |                        sSql = sSql & "    a.BASE_||12509  |                        sSql = sSql & "    a.BASE_
12513  |                        sSql = sSql & "    a.MARKE||12510  |                        sSql = sSql & "    a.MARKE
12514  |                        sSql = sSql & "    b.BABY_||12511  |                        sSql = sSql & "    b.BABY_
12515  |                        sSql = sSql & "    b.BABY_||12512  |                        sSql = sSql & "    b.BABY_
12516  |                        sSql = sSql & " FROM"     ||12513  |                        sSql = sSql & " FROM"     
12517  |                        sSql = sSql & "    CFR_DAI||12514  |                        sSql = sSql & "    CFR_DAI
12518  |                        sSql = sSql & " WHERE"    ||12515  |                        sSql = sSql & " WHERE"    
12519  |                        sSql = sSql & "    b.BABY_||12516  |                        sSql = sSql & "    b.BABY_
12520  |                        sSql = sSql & "    b.MOTHE||12517  |                        sSql = sSql & "    b.MOTHE
12521  |                        sSql = sSql & "    b.BASE_||12518  |                        sSql = sSql & "    b.BASE_
12522  |                        sSql = sSql & "    a.ACCOU||12519  |                        sSql = sSql & "    a.ACCOU
12523  |                        sSql = sSql & "    (a.BASE||12520  |                        sSql = sSql & "    (a.BASE
12524  |                        sSql = sSql & "    a.BASE_||12521  |                        sSql = sSql & "    a.BASE_
12525  |                        sSql = sSql & " ORDER BY" ||12522  |                        sSql = sSql & " ORDER BY" 
12526  |                        sSql = sSql & "    a.BASE_||12523  |                        sSql = sSql & "    a.BASE_
12527  |                    End If                        ||12524  |                    End If                        
12528  |                    'RAFI対応 END                 ||12525  |                    'RAFI対応 END                 
12529  |                                                  ||12526  |                                                  
12530  |                    If gintDyCreate(sSql) = False ||12527  |                    If gintDyCreate(sSql) = False 
12531  |                        Exit Function             ||12528  |                        Exit Function             
12532  |                    End If                        ||12529  |                    End If                        
12533  |                                                  ||12530  |                                                  
12534  |                    dlngCntsv = dlngCnt           ||12531  |                    dlngCntsv = dlngCnt           
12535  |                    dlngCnt = 0                   ||12532  |                    dlngCnt = 0                   
12536  |                                                  ||12533  |                                                  
12537  |                    Do Until gblnDyEOF()          ||12534  |                    Do Until gblnDyEOF()          
12538  |                        dlngCnt = dlngCnt + 1     ||12535  |                        dlngCnt = dlngCnt + 1     
12539  |                        '抽出データセット         ||12536  |                        '抽出データセット         
12540  |                        dstrBasedate = gvlnDyDataS||12537  |                        dstrBasedate = gvlnDyDataS
12541  |                        If Mid(dstrCaldate(dlngCnt||12538  |                        If Mid(dstrCaldate(dlngCnt
12542  |                            'RAFI対応 START       ||12539  |                            'RAFI対応 START       
12543  |                            '純資産の場合         ||12540  |                            '純資産の場合         
12544  |                            If msAssetFlg = "0" Th||12541  |                            If msAssetFlg = "0" Th
12545  |                                ddblDailynav(dlngC||12542  |                                ddblDailynav(dlngC
12546  |                            'マザー組入資産の場合 ||12543  |                            'マザー組入資産の場合 
12547  |                            Else                  ||12544  |                            Else                  
12548  |                                ddblDailynav(dlngC||12545  |                                ddblDailynav(dlngC
12549  |                            End If                ||12546  |                            End If                
12550  |                            'RAFI対応 END         ||12547  |                            'RAFI対応 END         
12551  |                        Else                      ||12548  |                        Else                      
12552  |                            '計算開始日が外部委託 ||12549  |                            '計算開始日が外部委託 
12553  |                            If ddblNearNav <> 0 An||12550  |                            If ddblNearNav <> 0 An
12554  |                                dstrCaldate2 = Mid||12551  |                                dstrCaldate2 = Mid
12555  |                                dstrBasedate2 = Mi||12552  |                                dstrBasedate2 = Mi
12556  |                                dlngDiffdate = Dat||12553  |                                dlngDiffdate = Dat
12557  |                                                  ||12554  |                                                  
12558  |                                For dintFor2 = 1 T||12555  |                                For dintFor2 = 1 T
12559  |                                    'RAFI対応 STAR||12556  |                                    'RAFI対応 STAR
12560  |                                    '純資産の場合 ||12557  |                                    '純資産の場合 
12561  |                                    If msAssetFlg ||12558  |                                    If msAssetFlg 
12562  |                                        ddblDailyn||12559  |                                        ddblDailyn
12563  |                                    'マザー組入資 ||12560  |                                    'マザー組入資 
12564  |                                    Else          ||12561  |                                    Else          
12565  |                                        ddblDailyn||12562  |                                        ddblDailyn
12566  |                                    End If        ||12563  |                                    End If        
12567  |                                    'RAFI対応 END ||12564  |                                    'RAFI対応 END 
12568  |                                    dlngCnt = dlng||12565  |                                    dlngCnt = dlng
12569  |                                Next dintFor2     ||12566  |                                Next dintFor2     
12570  |                                'RAFI対応 START   ||12567  |                                'RAFI対応 START   
12571  |                                '純資産の場合     ||12568  |                                '純資産の場合     
12572  |                                If msAssetFlg = "0||12569  |                                If msAssetFlg = "0
12573  |                                    ddblDailynav(d||12570  |                                    ddblDailynav(d
12574  |                                'マザー組入資産の ||12571  |                                'マザー組入資産の 
12575  |                                Else              ||12572  |                                Else              
12576  |                                    ddblDailynav(d||12573  |                                    ddblDailynav(d
12577  |                                End If            ||12574  |                                End If            
12578  |                                'RAFI対応 END     ||12575  |                                'RAFI対応 END     
12579  |                            Else                  ||12576  |                            Else                  
12580  |                                '日次NAVにデータが||12577  |                                '日次NAVにデータが
12581  |                                dstrCaldate2 = Mid||12578  |                                dstrCaldate2 = Mid
12582  |                                dstrBasedate2 = Mi||12579  |                                dstrBasedate2 = Mi
12583  |                                dlngDiffdate = Dat||12580  |                                dlngDiffdate = Dat
12584  |                                                  ||12581  |                                                  
12585  |                                For dintFor2 = 1 T||12582  |                                For dintFor2 = 1 T
12586  |                                    If ddblDailyna||12583  |                                    If ddblDailyna
12587  |                                        ddblDailyn||12584  |                                        ddblDailyn
12588  |                                    Else          ||12585  |                                    Else          
12589  |                                        '日次NAVに||12586  |                                        '日次NAVに
12590  |                                        intRtn = M||12587  |                                        intRtn = M
12591  |                                        vbLf & "対||12588  |                                        vbLf & "対
12592  |                                        vbLf & "基||12589  |                                        vbLf & "基
12593  |                                            vbCrit||12590  |                                            vbCrit
12594  |                                        Exit Funct||12591  |                                        Exit Funct
12595  |                                    End If        ||12592  |                                    End If        
12596  |                                    dlngCnt = dlng||12593  |                                    dlngCnt = dlng
12597  |                                Next dintFor2     ||12594  |                                Next dintFor2     
12598  |                                'RAFI対応 START   ||12595  |                                'RAFI対応 START   
12599  |                                '純資産の場合     ||12596  |                                '純資産の場合     
12600  |                                If msAssetFlg = "0||12597  |                                If msAssetFlg = "0
12601  |                                    ddblDailynav(d||12598  |                                    ddblDailynav(d
12602  |                                'マザー組入資産の ||12599  |                                'マザー組入資産の 
12603  |                                Else              ||12600  |                                Else              
12604  |                                    ddblDailynav(d||12601  |                                    ddblDailynav(d
12605  |                                End If            ||12602  |                                End If            
12606  |                                'RAFI対応 END     ||12603  |                                'RAFI対応 END     
12607  |                            End If                ||12604  |                            End If                
12608  |                                                  ||12605  |                                                  
12609  |                        End If                    ||12606  |                        End If                    
12610  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||12607  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
12611  |                        Call gDyNext              ||12608  |                        Call gDyNext              
12612  |                    Loop                          ||12609  |                    Loop                          
12613  |                                                  ||12610  |                                                  
12614  |                Next dintFor                      ||12611  |                Next dintFor                      
12615  |                                                  ||12612  |                                                  
12616  |                If dlngCntsv <> dlngCnt Then      ||12613  |                If dlngCntsv <> dlngCnt Then      
12617  |                    For dintFor2 = dlngCnt + 1 To ||12614  |                    For dintFor2 = dlngCnt + 1 To 
12618  |                        ddblDailynav(dintFor2) = d||12615  |                        ddblDailynav(dintFor2) = d
12619  |                    Next dintFor2                 ||12616  |                    Next dintFor2                 
12620  |                    dlngCnt = dlngCntsv           ||12617  |                    dlngCnt = dlngCntsv           
12621  |                End If                            ||12618  |                End If                            
12622  |                                                  ||12619  |                                                  
12623  |                ddblTtalnav = 0                   ||12620  |                ddblTtalnav = 0                   
12624  |                                                  ||12621  |                                                  
12625  |                For dintFor2 = 1 To dlngCnt       ||12622  |                For dintFor2 = 1 To dlngCnt       
12626  |                    ddblTtalnav = ddblTtalnav + dd||12623  |                    ddblTtalnav = ddblTtalnav + dd
12627  |                Next dintFor2                     ||12624  |                Next dintFor2                     
12628  |                                                  ||12625  |                                                  
12629  |                iRowCnt = dlngCnt                 ||12626  |                iRowCnt = dlngCnt                 
12630  |                TotalNav = ddblTtalnav            ||12627  |                TotalNav = ddblTtalnav            
12631  |                dblValueIn = TotalNav             ||12628  |                dblValueIn = TotalNav             
12632  |                Call sbGetRoundValue2(dblValueIn) ||12629  |                Call sbGetRoundValue2(dblValueIn) 
12633  |                TotalNav = dblValueOut            ||12630  |                TotalNav = dblValueOut            
12634  |                '合計(月末純資産)                 ||12631  |                '合計(月末純資産)                 
12635  |                .Cells(17, 23).NumberFormatLocal =||12632  |                .Cells(17, 23).NumberFormatLocal =
12636  |                .Cells(17, 23).Value = CStr(Format||12633  |                .Cells(17, 23).Value = CStr(Format
12637  |                .Cells(17, 23).HorizontalAlignment||12634  |                .Cells(17, 23).HorizontalAlignment
12638  |                '平均純資産総額                   ||12635  |                '平均純資産総額                   
12639  |                .Cells(36, 2).Value = sWord51     ||12636  |                .Cells(36, 2).Value = sWord51     
12640  |                .Cells(36, 11).Value = sWord19    ||12637  |                .Cells(36, 11).Value = sWord19    
12641  |                '計算期間の純資産総額の合計(月末純||12638  |                '計算期間の純資産総額の合計(月末純
12642  |                .Cells(36, 23).NumberFormatLocal =||12639  |                .Cells(36, 23).NumberFormatLocal =
12643  |                .Cells(36, 23).Value = CStr(Format||12640  |                .Cells(36, 23).Value = CStr(Format
12644  |                .Cells(36, 23).HorizontalAlignment||12641  |                .Cells(36, 23).HorizontalAlignment
12645  |                '計算期間の純資産総額の合計÷計算 ||12642  |                '計算期間の純資産総額の合計÷計算 
12646  |                .Cells(36, 35).NumberFormatLocal =||12643  |                .Cells(36, 35).NumberFormatLocal =
12647  |                dblValueIn = TotalNav / iRowCnt   ||12644  |                dblValueIn = TotalNav / iRowCnt   
12648  |                Call sbGetRoundValue(dblValueIn)  ||12645  |                Call sbGetRoundValue(dblValueIn)  
12649  |                .Cells(36, 35).Value = CStr(Format||12646  |                .Cells(36, 35).Value = CStr(Format
12650  |                AvgNav = dblValueOut              ||12647  |                AvgNav = dblValueOut              
12651  |                '÷??＝ ,文言                     ||12648  |                '÷??＝ ,文言                     
12652  |                .Cells(36, 26).Value = sWord18 & "||12649  |                .Cells(36, 26).Value = sWord18 & "
12653  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||12650  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
12654  |                                                  ||12651  |                                                  
12655  |            Else                                  ||12652  |            Else                                  
12656  |'取得NAV区分[1]以外(取得NAV区分='2')              ||12653  |'取得NAV区分[1]以外(取得NAV区分='2')              
12657  |                ddblTtalnav = 0                   ||12654  |                ddblTtalnav = 0                   
12658  |                For dintFor = 0 To NavGetCnt - 1  ||12655  |                For dintFor = 0 To NavGetCnt - 1  
12659  |                                                  ||12656  |                                                  
12660  |                    '日次NAV平均取得              ||12657  |                    '日次NAV平均取得              
12661  |                    sStart = gstrDateFormat2(CStr(||12658  |                    sStart = gstrDateFormat2(CStr(
12662  |                    sEnd = gstrDateFormat2(CStr(dE||12659  |                    sEnd = gstrDateFormat2(CStr(dE
12663  |                                                  ||12660  |                                                  
12664  |                    '計算開始日と外部委託顧問料計 ||12661  |                    '計算開始日と外部委託顧問料計 
12665  |                    If sStart = gbuMGetUPDRec.N(lR||12662  |                    If sStart = gbuMGetUPDRec.N(lR
12666  |                        '== SQL1 ==               ||12663  |                        '== SQL1 ==               
12667  |                        sSql = ""                 ||12664  |                        sSql = ""                 
12668  |                        sSql = sSql & "SELECT EIGY||12665  |                        sSql = sSql & "SELECT EIGY
12669  |                                                  ||12666  |                                                  
12670  |                        'ﾀﾞｲﾅｾｯﾄの作成            ||12667  |                        'ﾀﾞｲﾅｾｯﾄの作成            
12671  |                        If gintDyCreate(sSql) = Fa||12668  |                        If gintDyCreate(sSql) = Fa
12672  |                            Exit Function         ||12669  |                            Exit Function         
12673  |                        Else                      ||12670  |                        Else                      
12674  |                            '計算開始日が休日の場 ||12671  |                            '計算開始日が休日の場 
12675  |                            If gvlnDyDataS("EIGYO_||12672  |                            If gvlnDyDataS("EIGYO_
12676  |                                '翌営業日のNAVを取||12673  |                                '翌営業日のNAVを取
12677  |                                '== SQL2 ==       ||12674  |                                '== SQL2 ==       
12678  |                                sSql = ""         ||12675  |                                sSql = ""         
12679  |                                sSql = sSql & "SEL||12676  |                                sSql = sSql & "SEL
12680  |                                sSql = sSql & "FRO||12677  |                                sSql = sSql & "FRO
12681  |                                sSql = sSql & "(SE||12678  |                                sSql = sSql & "(SE
12682  |                                sSql = sSql & "WHE||12679  |                                sSql = sSql & "WHE
12683  |                                                  ||12680  |                                                  
12684  |                                'ﾀﾞｲﾅｾｯﾄの作成    ||12681  |                                'ﾀﾞｲﾅｾｯﾄの作成    
12685  |                                If gintDyCreate(sS||12682  |                                If gintDyCreate(sS
12686  |                                    Exit Function ||12683  |                                    Exit Function 
12687  |                                Else              ||12684  |                                Else              
12688  |                                    ddblNearNav = ||12685  |                                    ddblNearNav = 
12689  |'2008/03/06 START 時価総額基準の外部委託顧問料対応||12686  |'2008/03/06 START 時価総額基準の外部委託顧問料対応
12690  |'                                    '翌営業日の計||12687  |'                                    '翌営業日の計
12691  |'                                    '== SQL3 ==  ||12688  |'                                    '== SQL3 ==  
12692  |'                                    sSql = ""    ||12689  |'                                    sSql = ""    
12693  |'                                    sSql = sSql &||12690  |'                                    sSql = sSql &
12694  |'                                    sSql = sSql &||12691  |'                                    sSql = sSql &
12695  |'                                    sSql = sSql &||12692  |'                                    sSql = sSql &
12696  |'                                    sSql = sSql &||12693  |'                                    sSql = sSql &
12697  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||12694  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
12698  |'                                    If gintDyCrea||12695  |'                                    If gintDyCrea
12699  |'                                        Exit Func||12696  |'                                        Exit Func
12700  |'                                    Else         ||12697  |'                                    Else         
12701  |'                                        '計算開始||12698  |'                                        '計算開始
12702  |'                                        sStart = ||12699  |'                                        sStart = 
12703  |'                                        dStart = ||12700  |'                                        dStart = 
12704  |'                                        .Cells(15||12701  |'                                        .Cells(15
12705  |'                                            CStr(||12702  |'                                            CStr(
12706  |'                                        iCalcNum ||12703  |'                                        iCalcNum 
12707  |'                                    End If       ||12704  |'                                    End If       
12708  |'2008/03/06 END   時価総額基準の外部委託顧問料対応||12705  |'2008/03/06 END   時価総額基準の外部委託顧問料対応
12709  |                                End If            ||12706  |                                End If            
12710  |                                'RAFI対応 START   ||12707  |                                'RAFI対応 START   
12711  |                                '翌営業日のマザー ||12708  |                                '翌営業日のマザー 
12712  |                                If msAssetFlg = "1||12709  |                                If msAssetFlg = "1
12713  |                                    '== SQL4 ==   ||12710  |                                    '== SQL4 ==   
12714  |                                    sSql = ""     ||12711  |                                    sSql = ""     
12715  |                                    sSql = sSql & ||12712  |                                    sSql = sSql & 
12716  |                                    sSql = sSql & ||12713  |                                    sSql = sSql & 
12717  |                                    sSql = sSql & ||12714  |                                    sSql = sSql & 
12718  |                                    sSql = sSql & ||12715  |                                    sSql = sSql & 
12719  |                                    sSql = sSql & ||12716  |                                    sSql = sSql & 
12720  |                                    sSql = sSql & ||12717  |                                    sSql = sSql & 
12721  |                                    sSql = sSql & ||12718  |                                    sSql = sSql & 
12722  |                                    sSql = sSql & ||12719  |                                    sSql = sSql & 
12723  |                                    sSql = sSql & ||12720  |                                    sSql = sSql & 
12724  |                                    sSql = sSql & ||12721  |                                    sSql = sSql & 
12725  |                                    sSql = sSql & ||12722  |                                    sSql = sSql & 
12726  |                                    sSql = sSql & ||12723  |                                    sSql = sSql & 
12727  |                                    sSql = sSql & ||12724  |                                    sSql = sSql & 
12728  |                                    sSql = sSql & ||12725  |                                    sSql = sSql & 
12729  |                                    sSql = sSql & ||12726  |                                    sSql = sSql & 
12730  |                                    sSql = sSql & ||12727  |                                    sSql = sSql & 
12731  |                                    sSql = sSql & ||12728  |                                    sSql = sSql & 
12732  |                                    sSql = sSql & ||12729  |                                    sSql = sSql & 
12733  |                                    sSql = sSql & ||12730  |                                    sSql = sSql & 
12734  |                                    sSql = sSql & ||12731  |                                    sSql = sSql & 
12735  |                                    sSql = sSql & ||12732  |                                    sSql = sSql & 
12736  |                                    sSql = sSql & ||12733  |                                    sSql = sSql & 
12737  |                                    sSql = sSql & ||12734  |                                    sSql = sSql & 
12738  |                                    sSql = sSql & ||12735  |                                    sSql = sSql & 
12739  |                                    'ﾀﾞｲﾅｾｯﾄの作成||12736  |                                    'ﾀﾞｲﾅｾｯﾄの作成
12740  |                                                  ||12737  |                                                  
12741  |                                    If gintDyCreat||12738  |                                    If gintDyCreat
12742  |                                        Exit Funct||12739  |                                        Exit Funct
12743  |                                    Else          ||12740  |                                    Else          
12744  |                                        ddblNearBa||12741  |                                        ddblNearBa
12745  |                                    End If        ||12742  |                                    End If        
12746  |                                End If            ||12743  |                                End If            
12747  |                                'RAFI対応 END     ||12744  |                                'RAFI対応 END     
12748  |                            End If                ||12745  |                            End If                
12749  |                        End If                    ||12746  |                        End If                    
12750  |                    End If                        ||12747  |                    End If                        
12751  |                    '計算開始日から計算終了日まで ||12748  |                    '計算開始日から計算終了日まで 
12752  |                    '== SQL5 ==                   ||12749  |                    '== SQL5 ==                   
12753  |                    sSql = ""                     ||12750  |                    sSql = ""                     
12754  |                    sSql = sSql & "SELECT CAL_YYYY||12751  |                    sSql = sSql & "SELECT CAL_YYYY
12755  |                    sSql = sSql & "WHERE CAL_YYYY ||12752  |                    sSql = sSql & "WHERE CAL_YYYY 
12756  |                                                  ||12753  |                                                  
12757  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||12754  |                    'ﾀﾞｲﾅｾｯﾄの作成                
12758  |                    If gintDyCreate(sSql) = False ||12755  |                    If gintDyCreate(sSql) = False 
12759  |                        Exit Function             ||12756  |                        Exit Function             
12760  |                    End If                        ||12757  |                    End If                        
12761  |                                                  ||12758  |                                                  
12762  |                    If dlngCnt = 0 Then           ||12759  |                    If dlngCnt = 0 Then           
12763  |                        ReDim dstrCaldate(gbxOraDy||12760  |                        ReDim dstrCaldate(gbxOraDy
12764  |                        ReDim ddblDailynav(gbxOraD||12761  |                        ReDim ddblDailynav(gbxOraD
12765  |                    End If                        ||12762  |                    End If                        
12766  |                                                  ||12763  |                                                  
12767  |                    'EOF判定処理                  ||12764  |                    'EOF判定処理                  
12768  |                    dlngCnt = 0                   ||12765  |                    dlngCnt = 0                   
12769  |                                                  ||12766  |                                                  
12770  |                    Do Until gblnDyEOF()          ||12767  |                    Do Until gblnDyEOF()          
12771  |                        dlngCnt = dlngCnt + 1     ||12768  |                        dlngCnt = dlngCnt + 1     
12772  |                        '抽出データセット         ||12769  |                        '抽出データセット         
12773  |                        dstrCaldate(dlngCnt) = gvl||12770  |                        dstrCaldate(dlngCnt) = gvl
12774  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||12771  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
12775  |                        Call gDyNext              ||12772  |                        Call gDyNext              
12776  |                    Loop                          ||12773  |                    Loop                          
12777  |                                                  ||12774  |                                                  
12778  |                                                  ||12775  |                                                  
12779  |                    '2005/08/26　START            ||12776  |                    '2005/08/26　START            
12780  |                    '変数sStartに格納されている日 ||12777  |                    '変数sStartに格納されている日 
12781  |                    '変数sStartの直近の営業日の日 ||12778  |                    '変数sStartの直近の営業日の日 
12782  |                    '（変数sStartに格納されている ||12779  |                    '（変数sStartに格納されている 
12783  |                    '　直近日付が存在しない場合は ||12780  |                    '　直近日付が存在しない場合は 
12784  |                                                  ||12781  |                                                  
12785  |                    '計算開始日の日次NAV基準日を取||12782  |                    '計算開始日の日次NAV基準日を取
12786  |                    '== SQL6 ==                   ||12783  |                    '== SQL6 ==                   
12787  |                    sSql = ""                     ||12784  |                    sSql = ""                     
12788  |                    sSql = sSql & "SELECT MAX(BASE||12785  |                    sSql = sSql & "SELECT MAX(BASE
12789  |                    sSql = sSql & "FROM   CFR_DAIL||12786  |                    sSql = sSql & "FROM   CFR_DAIL
12790  |                    sSql = sSql & "WHERE  BASE_DAT||12787  |                    sSql = sSql & "WHERE  BASE_DAT
12791  |                    sSql = sSql & "AND    ACCOUNT_||12788  |                    sSql = sSql & "AND    ACCOUNT_
12792  |                                                  ||12789  |                                                  
12793  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||12790  |                    'ﾀﾞｲﾅｾｯﾄの作成                
12794  |                    If gintDyCreate(sSql) = False ||12791  |                    If gintDyCreate(sSql) = False 
12795  |                        Exit Function             ||12792  |                        Exit Function             
12796  |                    End If                        ||12793  |                    End If                        
12797  |                                                  ||12794  |                                                  
12798  |                    Do Until gblnDyEOF()          ||12795  |                    Do Until gblnDyEOF()          
12799  |                       '抽出データセット          ||12796  |                       '抽出データセット          
12800  |                        sStart = gvlnDyDataS("BASE||12797  |                        sStart = gvlnDyDataS("BASE
12801  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||12798  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
12802  |                        Call gDyNext              ||12799  |                        Call gDyNext              
12803  |                    Loop                          ||12800  |                    Loop                          
12804  |                                                  ||12801  |                                                  
12805  |                    'RAFI対応 START               ||12802  |                    'RAFI対応 START               
12806  |                    '純資産の場合                 ||12803  |                    '純資産の場合                 
12807  |                    If msAssetFlg = "0" Then      ||12804  |                    If msAssetFlg = "0" Then      
12808  |                        '計算開始日から計算終了日 ||12805  |                        '計算開始日から計算終了日 
12809  |                        '== SQL7 ==               ||12806  |                        '== SQL7 ==               
12810  |                        sSql = ""                 ||12807  |                        sSql = ""                 
12811  |                        sSql = sSql & "SELECT ACCO||12808  |                        sSql = sSql & "SELECT ACCO
12812  |                        sSql = sSql & "WHERE (((CF||12809  |                        sSql = sSql & "WHERE (((CF
12813  |                        sSql = sSql & "AND ((CFR_D||12810  |                        sSql = sSql & "AND ((CFR_D
12814  |                        sSql = sSql & "AND ((CFR_D||12811  |                        sSql = sSql & "AND ((CFR_D
12815  |                        sSql = sSql & "ORDER BY CF||12812  |                        sSql = sSql & "ORDER BY CF
12816  |                    'マザー組入資産の場合         ||12813  |                    'マザー組入資産の場合         
12817  |                    Else                          ||12814  |                    Else                          
12818  |                        '計算開始日から計算終了日 ||12815  |                        '計算開始日から計算終了日 
12819  |                        '== SQL8 ==               ||12816  |                        '== SQL8 ==               
12820  |                        sSql = ""                 ||12817  |                        sSql = ""                 
12821  |                        sSql = sSql & "SELECT"    ||12818  |                        sSql = sSql & "SELECT"    
12822  |                        sSql = sSql & "    a.ACCOU||12819  |                        sSql = sSql & "    a.ACCOU
12823  |                        sSql = sSql & "    a.BASE_||12820  |                        sSql = sSql & "    a.BASE_
12824  |                        sSql = sSql & "    a.NET_A||12821  |                        sSql = sSql & "    a.NET_A
12825  |                        sSql = sSql & "    b.BABY_||12822  |                        sSql = sSql & "    b.BABY_
12826  |                        sSql = sSql & "    b.BABY_||12823  |                        sSql = sSql & "    b.BABY_
12827  |                        sSql = sSql & " FROM"     ||12824  |                        sSql = sSql & " FROM"     
12828  |                        sSql = sSql & "    CFR_DAI||12825  |                        sSql = sSql & "    CFR_DAI
12829  |                        sSql = sSql & " WHERE"    ||12826  |                        sSql = sSql & " WHERE"    
12830  |                        sSql = sSql & "    b.BABY_||12827  |                        sSql = sSql & "    b.BABY_
12831  |                        sSql = sSql & "    b.MOTHE||12828  |                        sSql = sSql & "    b.MOTHE
12832  |                        sSql = sSql & "    b.BASE_||12829  |                        sSql = sSql & "    b.BASE_
12833  |                        sSql = sSql & "    a.ACCOU||12830  |                        sSql = sSql & "    a.ACCOU
12834  |                        sSql = sSql & "    (a.BASE||12831  |                        sSql = sSql & "    (a.BASE
12835  |                        sSql = sSql & "    a.BASE_||12832  |                        sSql = sSql & "    a.BASE_
12836  |                        sSql = sSql & "    a.CURRE||12833  |                        sSql = sSql & "    a.CURRE
12837  |                        sSql = sSql & "    a.ASSET||12834  |                        sSql = sSql & "    a.ASSET
12838  |                        sSql = sSql & " ORDER BY" ||12835  |                        sSql = sSql & " ORDER BY" 
12839  |                        sSql = sSql & "    a.BASE_||12836  |                        sSql = sSql & "    a.BASE_
12840  |                    End If                        ||12837  |                    End If                        
12841  |                    'RAFI対応 END                 ||12838  |                    'RAFI対応 END                 
12842  |                                                  ||12839  |                                                  
12843  |                    If gintDyCreate(sSql) = False ||12840  |                    If gintDyCreate(sSql) = False 
12844  |                        Exit Function             ||12841  |                        Exit Function             
12845  |                    End If                        ||12842  |                    End If                        
12846  |                                                  ||12843  |                                                  
12847  |                    dlngCntsv = dlngCnt           ||12844  |                    dlngCntsv = dlngCnt           
12848  |                    dlngCnt = 0                   ||12845  |                    dlngCnt = 0                   
12849  |                                                  ||12846  |                                                  
12850  |                    Do Until gblnDyEOF()          ||12847  |                    Do Until gblnDyEOF()          
12851  |                        dlngCnt = dlngCnt + 1     ||12848  |                        dlngCnt = dlngCnt + 1     
12852  |                        '抽出データセット         ||12849  |                        '抽出データセット         
12853  |                        dstrBasedate = gvlnDyDataS||12850  |                        dstrBasedate = gvlnDyDataS
12854  |                        If Mid(dstrCaldate(dlngCnt||12851  |                        If Mid(dstrCaldate(dlngCnt
12855  |                            'RAFI対応 START       ||12852  |                            'RAFI対応 START       
12856  |                            '純資産の場合         ||12853  |                            '純資産の場合         
12857  |                            If msAssetFlg = "0" Th||12854  |                            If msAssetFlg = "0" Th
12858  |                                ddblDailynav(dlngC||12855  |                                ddblDailynav(dlngC
12859  |                            'マザー組入資産の場合 ||12856  |                            'マザー組入資産の場合 
12860  |                            Else                  ||12857  |                            Else                  
12861  |                                ddblDailynav(dlngC||12858  |                                ddblDailynav(dlngC
12862  |                            End If                ||12859  |                            End If                
12863  |                            'RAFI対応 END         ||12860  |                            'RAFI対応 END         
12864  |                        Else                      ||12861  |                        Else                      
12865  |                            '計算開始日が外部委託 ||12862  |                            '計算開始日が外部委託 
12866  |                            If ddblNearNav <> 0 An||12863  |                            If ddblNearNav <> 0 An
12867  |                                dstrCaldate2 = Mid||12864  |                                dstrCaldate2 = Mid
12868  |                                dstrBasedate2 = Mi||12865  |                                dstrBasedate2 = Mi
12869  |                                dlngDiffdate = Dat||12866  |                                dlngDiffdate = Dat
12870  |                                                  ||12867  |                                                  
12871  |                                For dintFor2 = 1 T||12868  |                                For dintFor2 = 1 T
12872  |                                    'RAFI対応 STAR||12869  |                                    'RAFI対応 STAR
12873  |                                    '純資産の場合 ||12870  |                                    '純資産の場合 
12874  |                                    If msAssetFlg ||12871  |                                    If msAssetFlg 
12875  |                                        ddblDailyn||12872  |                                        ddblDailyn
12876  |                                    'マザー組入資 ||12873  |                                    'マザー組入資 
12877  |                                    Else          ||12874  |                                    Else          
12878  |                                        ddblDailyn||12875  |                                        ddblDailyn
12879  |                                    End If        ||12876  |                                    End If        
12880  |                                    'RAFI対応 END ||12877  |                                    'RAFI対応 END 
12881  |                                    dlngCnt = dlng||12878  |                                    dlngCnt = dlng
12882  |                                Next dintFor2     ||12879  |                                Next dintFor2     
12883  |                                'RAFI対応 START   ||12880  |                                'RAFI対応 START   
12884  |                                '純資産の場合     ||12881  |                                '純資産の場合     
12885  |                                If msAssetFlg = "0||12882  |                                If msAssetFlg = "0
12886  |                                    ddblDailynav(d||12883  |                                    ddblDailynav(d
12887  |                                'マザー組入資産の ||12884  |                                'マザー組入資産の 
12888  |                                Else              ||12885  |                                Else              
12889  |                                    ddblDailynav(d||12886  |                                    ddblDailynav(d
12890  |                                End If            ||12887  |                                End If            
12891  |                                'RAFI対応 END     ||12888  |                                'RAFI対応 END     
12892  |                            Else                  ||12889  |                            Else                  
12893  |                                '日次NAVにデータが||12890  |                                '日次NAVにデータが
12894  |                                dstrCaldate2 = Mid||12891  |                                dstrCaldate2 = Mid
12895  |                                dstrBasedate2 = Mi||12892  |                                dstrBasedate2 = Mi
12896  |                                dlngDiffdate = Dat||12893  |                                dlngDiffdate = Dat
12897  |                                                  ||12894  |                                                  
12898  |                                For dintFor2 = 1 T||12895  |                                For dintFor2 = 1 T
12899  |                                    If ddblDailyna||12896  |                                    If ddblDailyna
12900  |                                        ddblDailyn||12897  |                                        ddblDailyn
12901  |                                    Else          ||12898  |                                    Else          
12902  |                                        '日次NAVに||12899  |                                        '日次NAVに
12903  |                                        intRtn = M||12900  |                                        intRtn = M
12904  |                                        vbLf & "対||12901  |                                        vbLf & "対
12905  |                                        vbLf & "基||12902  |                                        vbLf & "基
12906  |                                            vbCrit||12903  |                                            vbCrit
12907  |                                        Exit Funct||12904  |                                        Exit Funct
12908  |                                    End If        ||12905  |                                    End If        
12909  |                                    dlngCnt = dlng||12906  |                                    dlngCnt = dlng
12910  |                                Next dintFor2     ||12907  |                                Next dintFor2     
12911  |                                'RAFI対応 START   ||12908  |                                'RAFI対応 START   
12912  |                                '純資産の場合     ||12909  |                                '純資産の場合     
12913  |                                If msAssetFlg = "0||12910  |                                If msAssetFlg = "0
12914  |                                    ddblDailynav(d||12911  |                                    ddblDailynav(d
12915  |                                'マザー組入資産の ||12912  |                                'マザー組入資産の 
12916  |                                Else              ||12913  |                                Else              
12917  |                                    ddblDailynav(d||12914  |                                    ddblDailynav(d
12918  |                                End If            ||12915  |                                End If            
12919  |                                'RAFI対応 END     ||12916  |                                'RAFI対応 END     
12920  |                            End If                ||12917  |                            End If                
12921  |                                                  ||12918  |                                                  
12922  |                        End If                    ||12919  |                        End If                    
12923  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||12920  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
12924  |                        Call gDyNext              ||12921  |                        Call gDyNext              
12925  |                    Loop                          ||12922  |                    Loop                          
12926  |                                                  ||12923  |                                                  
12927  |                Next dintFor                      ||12924  |                Next dintFor                      
12928  |                                                  ||12925  |                                                  
12929  |                If dlngCntsv <> dlngCnt Then      ||12926  |                If dlngCntsv <> dlngCnt Then      
12930  |                    For dintFor2 = dlngCnt + 1 To ||12927  |                    For dintFor2 = dlngCnt + 1 To 
12931  |                        ddblDailynav(dintFor2) = d||12928  |                        ddblDailynav(dintFor2) = d
12932  |                    Next dintFor2                 ||12929  |                    Next dintFor2                 
12933  |                    dlngCnt = dlngCntsv           ||12930  |                    dlngCnt = dlngCntsv           
12934  |                End If                            ||12931  |                End If                            
12935  |                                                  ||12932  |                                                  
12936  |                ddblTtalnav = 0                   ||12933  |                ddblTtalnav = 0                   
12937  |                                                  ||12934  |                                                  
12938  |                For dintFor2 = 1 To dlngCnt       ||12935  |                For dintFor2 = 1 To dlngCnt       
12939  |                    ddblTtalnav = ddblTtalnav + dd||12936  |                    ddblTtalnav = ddblTtalnav + dd
12940  |                Next dintFor2                     ||12937  |                Next dintFor2                     
12941  |                                                  ||12938  |                                                  
12942  |                iRowCnt = dlngCnt                 ||12939  |                iRowCnt = dlngCnt                 
12943  |                TotalNav = ddblTtalnav            ||12940  |                TotalNav = ddblTtalnav            
12944  |                dblValueIn = TotalNav             ||12941  |                dblValueIn = TotalNav             
12945  |                Call sbGetRoundValue2(dblValueIn) ||12942  |                Call sbGetRoundValue2(dblValueIn) 
12946  |                TotalNav = dblValueOut            ||12943  |                TotalNav = dblValueOut            
12947  |                '合計(月末純資産)                 ||12944  |                '合計(月末純資産)                 
12948  |                .Cells(17, 23).NumberFormatLocal =||12945  |                .Cells(17, 23).NumberFormatLocal =
12949  |                    If gbuMGetUPDRec.N(lRecIdx).MG||12946  |                    If gbuMGetUPDRec.N(lRecIdx).MG
12950  |                        .Cells(17, 23).Value = CSt||12947  |                        .Cells(17, 23).Value = CSt
12951  |                    Else                          ||12948  |                    Else                          
12952  |                        .Cells(17, 23).Value = CSt||12949  |                        .Cells(17, 23).Value = CSt
12953  |                    End If                        ||12950  |                    End If                        
12954  |                .Cells(17, 23).HorizontalAlignment||12951  |                .Cells(17, 23).HorizontalAlignment
12955  |                '平均純資産総額                   ||12952  |                '平均純資産総額                   
12956  |                .Cells(36, 2).Value = sWord51     ||12953  |                .Cells(36, 2).Value = sWord51     
12957  |                .Cells(36, 11).Value = sWord19    ||12954  |                .Cells(36, 11).Value = sWord19    
12958  |                '計算期間の純資産総額の合計(月末純||12955  |                '計算期間の純資産総額の合計(月末純
12959  |                .Cells(36, 23).NumberFormatLocal =||12956  |                .Cells(36, 23).NumberFormatLocal =
12960  |                    If gbuMGetUPDRec.N(lRecIdx).MG||12957  |                    If gbuMGetUPDRec.N(lRecIdx).MG
12961  |                        .Cells(36, 23).Value = CSt||12958  |                        .Cells(36, 23).Value = CSt
12962  |                    Else                          ||12959  |                    Else                          
12963  |                        .Cells(36, 23).Value = CSt||12960  |                        .Cells(36, 23).Value = CSt
12964  |                    End If                        ||12961  |                    End If                        
12965  |                .Cells(36, 23).HorizontalAlignment||12962  |                .Cells(36, 23).HorizontalAlignment
12966  |                '計算期間の純資産総額の合計÷計算 ||12963  |                '計算期間の純資産総額の合計÷計算 
12967  |                .Cells(36, 35).NumberFormatLocal =||12964  |                .Cells(36, 35).NumberFormatLocal =
12968  |                dblValueIn = TotalNav / iRowCnt   ||12965  |                dblValueIn = TotalNav / iRowCnt   
12969  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||12966  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
12970  |                    Call sbGetRoundValue2(dblValue||12967  |                    Call sbGetRoundValue2(dblValue
12971  |                Else                              ||12968  |                Else                              
12972  |                    Call sbGetRoundValue(dblValueI||12969  |                    Call sbGetRoundValue(dblValueI
12973  |                End If                            ||12970  |                End If                            
12974  |                    If gbuMGetUPDRec.N(lRecIdx).MG||12971  |                    If gbuMGetUPDRec.N(lRecIdx).MG
12975  |                        .Cells(36, 35).Value = CSt||12972  |                        .Cells(36, 35).Value = CSt
12976  |                    Else                          ||12973  |                    Else                          
12977  |                        .Cells(36, 35).Value = CSt||12974  |                        .Cells(36, 35).Value = CSt
12978  |                    End If                        ||12975  |                    End If                        
12979  |                AvgNav = dblValueOut              ||12976  |                AvgNav = dblValueOut              
12980  |                '÷??＝ ,文言                     ||12977  |                '÷??＝ ,文言                     
12981  |                .Cells(36, 26).Value = sWord18 & "||12978  |                .Cells(36, 26).Value = sWord18 & "
12982  |            End If                                ||12979  |            End If                                
12983  |'契約区分：名称使用許諾料計算　かつ　日次NAV(休日 ||12980  |'契約区分：名称使用許諾料計算　かつ　日次NAV(休日 
12984  |        Else                                      ||12981  |        Else                                      
12985  |                                                  ||12982  |                                                  
12986  |On Error GoTo OnErrorProc                         ||12983  |On Error GoTo OnErrorProc                         
12987  |                                                  ||12984  |                                                  
12988  |            '契約区分「3」の場合                  ||12985  |            '契約区分「3」の場合                  
12989  |            ddblTtalnav = 0                       ||12986  |            ddblTtalnav = 0                       
12990  |            For dintFor = 0 To NavGetCnt - 1      ||12987  |            For dintFor = 0 To NavGetCnt - 1      
12991  |                '日次NAV平均取得                  ||12988  |                '日次NAV平均取得                  
12992  |                sStart = gstrDateFormat2(CStr(dSta||12989  |                sStart = gstrDateFormat2(CStr(dSta
12993  |                sEnd = gstrDateFormat2(CStr(dEnd),||12990  |                sEnd = gstrDateFormat2(CStr(dEnd),
12994  |                                                  ||12991  |                                                  
12995  |                'RAFI対応 START                   ||12992  |                'RAFI対応 START                   
12996  |                '純資産の場合                     ||12993  |                '純資産の場合                     
12997  |                If msAssetFlg = "0" Then          ||12994  |                If msAssetFlg = "0" Then          
12998  |                    '計算開始日から計算終了日まで ||12995  |                    '計算開始日から計算終了日まで 
12999  |                    sSql = ""                     ||12996  |                    sSql = ""                     
13000  |                    sSql = sSql & "SELECT ACCOUNT_||12997  |                    sSql = sSql & "SELECT ACCOUNT_
13001  |                    sSql = sSql & "WHERE (((CFR_DA||12998  |                    sSql = sSql & "WHERE (((CFR_DA
13002  |                    sSql = sSql & "AND ((CFR_DAILY||12999  |                    sSql = sSql & "AND ((CFR_DAILY
13003  |                    sSql = sSql & "AND ((CFR_DAILY||13000  |                    sSql = sSql & "AND ((CFR_DAILY
13004  |                    sSql = sSql & "ORDER BY CFR_DA||13001  |                    sSql = sSql & "ORDER BY CFR_DA
13005  |                'マザー組入資産の場合             ||13002  |                'マザー組入資産の場合             
13006  |                Else                              ||13003  |                Else                              
13007  |                    '計算開始日から計算終了日まで ||13004  |                    '計算開始日から計算終了日まで 
13008  |                    sSql = ""                     ||13005  |                    sSql = ""                     
13009  |                    sSql = sSql & "SELECT"        ||13006  |                    sSql = sSql & "SELECT"        
13010  |                    sSql = sSql & "    a.ACCOUNT_C||13007  |                    sSql = sSql & "    a.ACCOUNT_C
13011  |                    sSql = sSql & "    a.BASE_DATE||13008  |                    sSql = sSql & "    a.BASE_DATE
13012  |                    sSql = sSql & "    a.NET_ASSET||13009  |                    sSql = sSql & "    a.NET_ASSET
13013  |                    sSql = sSql & "    b.BABY_MOTH||13010  |                    sSql = sSql & "    b.BABY_MOTH
13014  |                    sSql = sSql & "    b.BABY_MOTH||13011  |                    sSql = sSql & "    b.BABY_MOTH
13015  |                    sSql = sSql & " FROM"         ||13012  |                    sSql = sSql & " FROM"         
13016  |                    sSql = sSql & "    CFR_DAILY_N||13013  |                    sSql = sSql & "    CFR_DAILY_N
13017  |                    sSql = sSql & " WHERE"        ||13014  |                    sSql = sSql & " WHERE"        
13018  |                    sSql = sSql & "    b.BABY_ACCO||13015  |                    sSql = sSql & "    b.BABY_ACCO
13019  |                    sSql = sSql & "    b.MOTHER_AC||13016  |                    sSql = sSql & "    b.MOTHER_AC
13020  |                    sSql = sSql & "    b.BASE_DATE||13017  |                    sSql = sSql & "    b.BASE_DATE
13021  |                    sSql = sSql & "    a.ACCOUNT_C||13018  |                    sSql = sSql & "    a.ACCOUNT_C
13022  |                    sSql = sSql & "    (a.BASE_DAT||13019  |                    sSql = sSql & "    (a.BASE_DAT
13023  |                    sSql = sSql & "    a.BASE_DATE||13020  |                    sSql = sSql & "    a.BASE_DATE
13024  |                    sSql = sSql & "    a.CURRENCY_||13021  |                    sSql = sSql & "    a.CURRENCY_
13025  |                    sSql = sSql & "    a.ASSET_TYP||13022  |                    sSql = sSql & "    a.ASSET_TYP
13026  |                    sSql = sSql & " ORDER BY"     ||13023  |                    sSql = sSql & " ORDER BY"     
13027  |                    sSql = sSql & "    a.BASE_DATE||13024  |                    sSql = sSql & "    a.BASE_DATE
13028  |                End If                            ||13025  |                End If                            
13029  |                'RAFI対応 END                     ||13026  |                'RAFI対応 END                     
13030  |                                                  ||13027  |                                                  
13031  |                If gintDyCreate(sSql) = False Then||13028  |                If gintDyCreate(sSql) = False Then
13032  |                    Exit Function                 ||13029  |                    Exit Function                 
13033  |                End If                            ||13030  |                End If                            
13034  |                                                  ||13031  |                                                  
13035  |                If dlngCnt = 0 Then               ||13032  |                If dlngCnt = 0 Then               
13036  |                    ReDim dstrCaldate(gbxOraDynase||13033  |                    ReDim dstrCaldate(gbxOraDynase
13037  |                    ReDim ddblDailynav(gbxOraDynas||13034  |                    ReDim ddblDailynav(gbxOraDynas
13038  |                End If                            ||13035  |                End If                            
13039  |                                                  ||13036  |                                                  
13040  |                dlngCnt = 0                       ||13037  |                dlngCnt = 0                       
13041  |                                                  ||13038  |                                                  
13042  |                Do Until gblnDyEOF()              ||13039  |                Do Until gblnDyEOF()              
13043  |                    dlngCnt = dlngCnt + 1         ||13040  |                    dlngCnt = dlngCnt + 1         
13044  |                    'RAFI対応 START               ||13041  |                    'RAFI対応 START               
13045  |                    '純資産の場合                 ||13042  |                    '純資産の場合                 
13046  |                    If msAssetFlg = "0" Then      ||13043  |                    If msAssetFlg = "0" Then      
13047  |                        '抽出データセット         ||13044  |                        '抽出データセット         
13048  |                        dstrCaldate(dlngCnt) = gvl||13045  |                        dstrCaldate(dlngCnt) = gvl
13049  |                        ddblDailynav(dlngCnt) = dd||13046  |                        ddblDailynav(dlngCnt) = dd
13050  |                    'マザー組入資産の場合         ||13047  |                    'マザー組入資産の場合         
13051  |                    Else                          ||13048  |                    Else                          
13052  |                        dstrCaldate(dlngCnt) = gvl||13049  |                        dstrCaldate(dlngCnt) = gvl
13053  |                        ddblDailynav(dlngCnt) = dd||13050  |                        ddblDailynav(dlngCnt) = dd
13054  |                    End If                        ||13051  |                    End If                        
13055  |                    'RAFI対応 END                 ||13052  |                    'RAFI対応 END                 
13056  |                                                  ||13053  |                                                  
13057  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             ||13054  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             
13058  |                    Call gDyNext                  ||13055  |                    Call gDyNext                  
13059  |                Loop                              ||13056  |                Loop                              
13060  |                                                  ||13057  |                                                  
13061  |            Next dintFor                          ||13058  |            Next dintFor                          
13062  |                                                  ||13059  |                                                  
13063  |            ddblTtalnav = 0                       ||13060  |            ddblTtalnav = 0                       
13064  |                                                  ||13061  |                                                  
13065  |            For dintFor2 = 1 To dlngCnt           ||13062  |            For dintFor2 = 1 To dlngCnt           
13066  |                ddblTtalnav = ddblTtalnav + ddblDa||13063  |                ddblTtalnav = ddblTtalnav + ddblDa
13067  |            Next dintFor2                         ||13064  |            Next dintFor2                         
13068  |                                                  ||13065  |                                                  
13069  |            iRowCnt = dlngCnt                     ||13066  |            iRowCnt = dlngCnt                     
13070  |            dlngMeisyoSu = dlngCnt                ||13067  |            dlngMeisyoSu = dlngCnt                
13071  |            TotalNav = ddblTtalnav                ||13068  |            TotalNav = ddblTtalnav                
13072  |            dblValueIn = TotalNav                 ||13069  |            dblValueIn = TotalNav                 
13073  |            Call sbGetRoundValue2(dblValueIn)     ||13070  |            Call sbGetRoundValue2(dblValueIn)     
13074  |            TotalNav = dblValueOut                ||13071  |            TotalNav = dblValueOut                
13075  |                                                  ||13072  |                                                  
13076  |            '計算期間の純資産総額の合計÷計算期間 ||13073  |            '計算期間の純資産総額の合計÷計算期間 
13077  |            dblValueIn = TotalNav / iRowCnt       ||13074  |            dblValueIn = TotalNav / iRowCnt       
13078  |            iCalcNum = iRowCnt                    ||13075  |            iCalcNum = iRowCnt                    
13079  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||13076  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
13080  |                  Call sbGetRoundValue2(dblValueIn||13077  |                  Call sbGetRoundValue2(dblValueIn
13081  |            Else                                  ||13078  |            Else                                  
13082  |                  Call sbGetRoundValue(dblValueIn)||13079  |                  Call sbGetRoundValue(dblValueIn)
13083  |            End If                                ||13080  |            End If                                
13084  |            dstrAvgNav = dblValueOut              ||13081  |            dstrAvgNav = dblValueOut              
13085  |            AvgNav = dstrAvgNav                   ||13082  |            AvgNav = dstrAvgNav                   
13086  |                                                  ||13083  |                                                  
13087  |                                                  ||13084  |                                                  
13088  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||13085  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
13089  |            Call gblnDyClose                      ||13086  |            Call gblnDyClose                      
13090  |            .Cells(17, 23).NumberFormatLocal = "@"||13087  |            .Cells(17, 23).NumberFormatLocal = "@"
13091  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||13088  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
13092  |                .Cells(17, 23).Value = CStr(Format||13089  |                .Cells(17, 23).Value = CStr(Format
13093  |            Else                                  ||13090  |            Else                                  
13094  |                .Cells(17, 23).Value = CStr(Format||13091  |                .Cells(17, 23).Value = CStr(Format
13095  |            End If                                ||13092  |            End If                                
13096  |            .Cells(17, 23).HorizontalAlignment = x||13093  |            .Cells(17, 23).HorizontalAlignment = x
13097  |            '平均純資産総額                       ||13094  |            '平均純資産総額                       
13098  |            .Cells(36, 2).Value = sWord51         ||13095  |            .Cells(36, 2).Value = sWord51         
13099  |            .Cells(36, 11).Value = sWord19        ||13096  |            .Cells(36, 11).Value = sWord19        
13100  |            '計算期間の純資産総額の合計(月末純資産||13097  |            '計算期間の純資産総額の合計(月末純資産
13101  |            .Cells(36, 23).NumberFormatLocal = "@"||13098  |            .Cells(36, 23).NumberFormatLocal = "@"
13102  |              If gbuMGetUPDRec.N(lRecIdx).MGET_bas||13099  |              If gbuMGetUPDRec.N(lRecIdx).MGET_bas
13103  |                  .Cells(36, 23).Value = CStr(Form||13100  |                  .Cells(36, 23).Value = CStr(Form
13104  |              Else                                ||13101  |              Else                                
13105  |                  .Cells(36, 23).Value = CStr(Form||13102  |                  .Cells(36, 23).Value = CStr(Form
13106  |              End If                              ||13103  |              End If                              
13107  |            .Cells(36, 23).HorizontalAlignment = x||13104  |            .Cells(36, 23).HorizontalAlignment = x
13108  |            '÷??＝                               ||13105  |            '÷??＝                               
13109  |            .Cells(36, 26).Value = sWord18 & "   "||13106  |            .Cells(36, 26).Value = sWord18 & "   "
13110  |            '計算期間の純資産総額の合計÷計算期間 ||13107  |            '計算期間の純資産総額の合計÷計算期間 
13111  |            .Cells(36, 35).NumberFormatLocal = "@"||13108  |            .Cells(36, 35).NumberFormatLocal = "@"
13112  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||13109  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
13113  |                .Cells(36, 35).Value = CStr(Format||13110  |                .Cells(36, 35).Value = CStr(Format
13114  |            Else                                  ||13111  |            Else                                  
13115  |                .Cells(36, 35).Value = CStr(Format||13112  |                .Cells(36, 35).Value = CStr(Format
13116  |            End If                                ||13113  |            End If                                
13117  |            ddblExchangeRate = 0                  ||13114  |            ddblExchangeRate = 0                  
13118  |            '投資顧問料計算用計算対象NAVに日次平均||13115  |            '投資顧問料計算用計算対象NAVに日次平均
13119  |            If dstrAvgNav = "" Then               ||13116  |            If dstrAvgNav = "" Then               
13120  |                lCalcNav = 0                      ||13117  |                lCalcNav = 0                      
13121  |            Else                                  ||13118  |            Else                                  
13122  |                dblValueIn = CDbl(dstrAvgNav)     ||13119  |                dblValueIn = CDbl(dstrAvgNav)     
13123  |                '@@@@@ NAV通貨から閾値通貨に換算 @||13120  |                '@@@@@ NAV通貨から閾値通貨に換算 @
13124  |                Select Case gbuMGetUPDRec.N(lRecId||13121  |                Select Case gbuMGetUPDRec.N(lRecId
13125  |                  Case "1"    '固定料率           ||13122  |                  Case "1"    '固定料率           
13126  |                    If gbuMGetUPDRec.N(lRecIdx).MG||13123  |                    If gbuMGetUPDRec.N(lRecIdx).MG
13127  |                        'NAV通貨→JPYの為替レート ||13124  |                        'NAV通貨→JPYの為替レート 
13128  |                        dstrCurrencyCode = gbuMGet||13125  |                        dstrCurrencyCode = gbuMGet
13129  |                        ddblExchangeRate = fnstrEx||13126  |                        ddblExchangeRate = fnstrEx
13130  |                        If ddblExchangeRate = 0 Th||13127  |                        If ddblExchangeRate = 0 Th
13131  |                          intRtn = MsgBox("ＴＴＭ ||13128  |                          intRtn = MsgBox("ＴＴＭ 
13132  |                          vbLf & "対象通貨コード  ||13129  |                          vbLf & "対象通貨コード  
13133  |                          vbLf & "基準日 ： [ " & ||13130  |                          vbLf & "基準日 ： [ " & 
13134  |                              vbCritical, "ＴＴＭ ||13131  |                              vbCritical, "ＴＴＭ 
13135  |                          Exit Function           ||13132  |                          Exit Function           
13136  |                        End If                    ||13133  |                        End If                    
13137  |                        'NAV通貨→JPYへレート換算 ||13134  |                        'NAV通貨→JPYへレート換算 
13138  |                        dblValueIn = dblValueIn * ||13135  |                        dblValueIn = dblValueIn * 
13139  |                    End If                        ||13136  |                    End If                        
13140  |                  Case "2"    '段階料率           ||13137  |                  Case "2"    '段階料率           
13141  |                    If gbuMGetUPDRec.N(lRecIdx).MG||13138  |                    If gbuMGetUPDRec.N(lRecIdx).MG
13142  |                        If gbuMGetUPDRec.N(lRecIdx||13139  |                        If gbuMGetUPDRec.N(lRecIdx
13143  |                        Else                      ||13140  |                        Else                      
13144  |                            '閾値通貨→JPYの為替レ||13141  |                            '閾値通貨→JPYの為替レ
13145  |                            dstrCurrencyCode = gbu||13142  |                            dstrCurrencyCode = gbu
13146  |                            ddblExchangeRate = fns||13143  |                            ddblExchangeRate = fns
13147  |                            If ddblExchangeRate = ||13144  |                            If ddblExchangeRate = 
13148  |                              intRtn = MsgBox("Ｔ ||13145  |                              intRtn = MsgBox("Ｔ 
13149  |                              vbLf & "対象通貨コー||13146  |                              vbLf & "対象通貨コー
13150  |                              vbLf & "基準日 ： [ ||13147  |                              vbLf & "基準日 ： [ 
13151  |                                  vbCritical, "Ｔ ||13148  |                                  vbCritical, "Ｔ 
13152  |                              Exit Function       ||13149  |                              Exit Function       
13153  |                            End If                ||13150  |                            End If                
13154  |                            'JPY→閾値通貨へレート||13151  |                            'JPY→閾値通貨へレート
13155  |                            dblValueIn = dblValueI||13152  |                            dblValueIn = dblValueI
13156  |                        End If                    ||13153  |                        End If                    
13157  |                    Else                          ||13154  |                    Else                          
13158  |                        'NAV通貨→JPYの為替レート ||13155  |                        'NAV通貨→JPYの為替レート 
13159  |                        dstrCurrencyCode = gbuMGet||13156  |                        dstrCurrencyCode = gbuMGet
13160  |                        ddblExchangeRate = fnstrEx||13157  |                        ddblExchangeRate = fnstrEx
13161  |                        If ddblExchangeRate = 0 Th||13158  |                        If ddblExchangeRate = 0 Th
13162  |                          intRtn = MsgBox("ＴＴＭ ||13159  |                          intRtn = MsgBox("ＴＴＭ 
13163  |                          vbLf & "対象通貨コード  ||13160  |                          vbLf & "対象通貨コード  
13164  |                          vbLf & "基準日 ： [ " & ||13161  |                          vbLf & "基準日 ： [ " & 
13165  |                              vbCritical, "ＴＴＭ ||13162  |                              vbCritical, "ＴＴＭ 
13166  |                          Exit Function           ||13163  |                          Exit Function           
13167  |                        End If                    ||13164  |                        End If                    
13168  |                        'NAV通貨→JPYへレート換算 ||13165  |                        'NAV通貨→JPYへレート換算 
13169  |                        dblValueIn = dblValueIn * ||13166  |                        dblValueIn = dblValueIn * 
13170  |                        If gbuMGetUPDRec.N(lRecIdx||13167  |                        If gbuMGetUPDRec.N(lRecIdx
13171  |                        Else                      ||13168  |                        Else                      
13172  |                            '閾値通貨→JPYの為替レ||13169  |                            '閾値通貨→JPYの為替レ
13173  |                            dstrCurrencyCode = gbu||13170  |                            dstrCurrencyCode = gbu
13174  |                            ddblExchangeRate = fns||13171  |                            ddblExchangeRate = fns
13175  |                            If ddblExchangeRate = ||13172  |                            If ddblExchangeRate = 
13176  |                              intRtn = MsgBox("Ｔ ||13173  |                              intRtn = MsgBox("Ｔ 
13177  |                              vbLf & "対象通貨コー||13174  |                              vbLf & "対象通貨コー
13178  |                              vbLf & "基準日 ： [ ||13175  |                              vbLf & "基準日 ： [ 
13179  |                                  vbCritical, "Ｔ ||13176  |                                  vbCritical, "Ｔ 
13180  |                              Exit Function       ||13177  |                              Exit Function       
13181  |                            End If                ||13178  |                            End If                
13182  |                            'JPY→閾値通貨へ逆レー||13179  |                            'JPY→閾値通貨へ逆レー
13183  |                            dblValueIn = dblValueI||13180  |                            dblValueIn = dblValueI
13184  |                        End If                    ||13181  |                        End If                    
13185  |                    End If                        ||13182  |                    End If                        
13186  |                End Select                        ||13183  |                End Select                        
13187  |                '@@@@@ NAV通貨から閾値通貨に換算 @||13184  |                '@@@@@ NAV通貨から閾値通貨に換算 @
13188  |                Call sbGetRoundValue2(dblValueIn) ||13185  |                Call sbGetRoundValue2(dblValueIn) 
13189  |                '閾値レート換算後平均NAV(計算対象N||13186  |                '閾値レート換算後平均NAV(計算対象N
13190  |                lCalcNav = CStr(Format(dblValueOut||13187  |                lCalcNav = CStr(Format(dblValueOut
13191  |            End If                                ||13188  |            End If                                
13192  |                                                  ||13189  |                                                  
13193  |On Error Resume Next                              ||13190  |On Error Resume Next                              
13194  |        End If                                    ||13191  |        End If                                    
13195  |                                                  ||13192  |                                                  
13196  |        '投資顧問料                               ||13193  |        '投資顧問料                               
13197  |        Dim dRitsu As Double    '外部委託顧問料率 ||13194  |        Dim dRitsu As Double    '外部委託顧問料率 
13198  |        dRitsu = 0                                ||13195  |        dRitsu = 0                                
13199  |        TotalRate = 0                             ||13196  |        TotalRate = 0                             
13200  |        ddblExchangeRate = 0                      ||13197  |        ddblExchangeRate = 0                      
13201  |        '計算対象NAVを変数にセット                ||13198  |        '計算対象NAVを変数にセット                
13202  |        lCalcNav = 0                              ||13199  |        lCalcNav = 0                              
13203  |        dblValueIn = TotalNav / iRowCnt           ||13200  |        dblValueIn = TotalNav / iRowCnt           
13204  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    ||13201  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    
13205  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||13202  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
13206  |          Case "1"    '固定料率(固定料率の場合は、||13203  |          Case "1"    '固定料率(固定料率の場合は、
13207  |              'NAV通貨と外部委託顧問料通貨が相違  ||13204  |              'NAV通貨と外部委託顧問料通貨が相違  
13208  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||13205  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
13209  |                'NAV通貨→JPYの為替レートを取得   ||13206  |                'NAV通貨→JPYの為替レートを取得   
13210  |                dstrCurrencyCode = gbuMGetUPDRec.N||13207  |                dstrCurrencyCode = gbuMGetUPDRec.N
13211  |                ddblExchangeRate = fnstrExchangeRa||13208  |                ddblExchangeRate = fnstrExchangeRa
13212  |                If ddblExchangeRate = 0 Then      ||13209  |                If ddblExchangeRate = 0 Then      
13213  |                  intRtn = MsgBox("ＴＴＭが取得で ||13210  |                  intRtn = MsgBox("ＴＴＭが取得で 
13214  |                  vbLf & "対象通貨コード ： [ " & ||13211  |                  vbLf & "対象通貨コード ： [ " & 
13215  |                  vbLf & "基準日 ： [ " & Mid(dstr||13212  |                  vbLf & "基準日 ： [ " & Mid(dstr
13216  |                      vbCritical, "ＴＴＭ取得エラ ||13213  |                      vbCritical, "ＴＴＭ取得エラ 
13217  |                  Exit Function                   ||13214  |                  Exit Function                   
13218  |                End If                            ||13215  |                End If                            
13219  |                'NAV通貨→JPYへレート換算         ||13216  |                'NAV通貨→JPYへレート換算         
13220  |                dblValueIn = dblValueIn * ddblExch||13217  |                dblValueIn = dblValueIn * ddblExch
13221  |            End If                                ||13218  |            End If                                
13222  |          Case "2"    '段階料率                   ||13219  |          Case "2"    '段階料率                   
13223  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||13220  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
13224  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||13221  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
13225  |                Else                              ||13222  |                Else                              
13226  |                    '閾値通貨→JPYの為替レートを取||13223  |                    '閾値通貨→JPYの為替レートを取
13227  |                    dstrCurrencyCode = gbuMGetUPDR||13224  |                    dstrCurrencyCode = gbuMGetUPDR
13228  |                    ddblExchangeRate = fnstrExchan||13225  |                    ddblExchangeRate = fnstrExchan
13229  |                    If ddblExchangeRate = 0 Then  ||13226  |                    If ddblExchangeRate = 0 Then  
13230  |                      intRtn = MsgBox("ＴＴＭが取 ||13227  |                      intRtn = MsgBox("ＴＴＭが取 
13231  |                      vbLf & "対象通貨コード ： [ ||13228  |                      vbLf & "対象通貨コード ： [ 
13232  |                      vbLf & "基準日 ： [ " & Mid(||13229  |                      vbLf & "基準日 ： [ " & Mid(
13233  |                          vbCritical, "ＴＴＭ取得 ||13230  |                          vbCritical, "ＴＴＭ取得 
13234  |                      Exit Function               ||13231  |                      Exit Function               
13235  |                    End If                        ||13232  |                    End If                        
13236  |                    'JPY→閾値通貨へレート換算    ||13233  |                    'JPY→閾値通貨へレート換算    
13237  |                    dblValueIn = dblValueIn * ddbl||13234  |                    dblValueIn = dblValueIn * ddbl
13238  |                End If                            ||13235  |                End If                            
13239  |            Else                                  ||13236  |            Else                                  
13240  |                'NAV通貨→JPYの為替レートを取得   ||13237  |                'NAV通貨→JPYの為替レートを取得   
13241  |                dstrCurrencyCode = gbuMGetUPDRec.N||13238  |                dstrCurrencyCode = gbuMGetUPDRec.N
13242  |                ddblExchangeRate = fnstrExchangeRa||13239  |                ddblExchangeRate = fnstrExchangeRa
13243  |                If ddblExchangeRate = 0 Then      ||13240  |                If ddblExchangeRate = 0 Then      
13244  |                  intRtn = MsgBox("ＴＴＭが取得で ||13241  |                  intRtn = MsgBox("ＴＴＭが取得で 
13245  |                  vbLf & "対象通貨コード ： [ " & ||13242  |                  vbLf & "対象通貨コード ： [ " & 
13246  |                  vbLf & "基準日 ： [ " & Mid(dstr||13243  |                  vbLf & "基準日 ： [ " & Mid(dstr
13247  |                      vbCritical, "ＴＴＭ取得エラ ||13244  |                      vbCritical, "ＴＴＭ取得エラ 
13248  |                  Exit Function                   ||13245  |                  Exit Function                   
13249  |                End If                            ||13246  |                End If                            
13250  |                'NAV通貨→JPYへレート換算         ||13247  |                'NAV通貨→JPYへレート換算         
13251  |                dblValueIn = dblValueIn * ddblExch||13248  |                dblValueIn = dblValueIn * ddblExch
13252  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||13249  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
13253  |                Else                              ||13250  |                Else                              
13254  |                    '閾値通貨→JPYの為替レートを取||13251  |                    '閾値通貨→JPYの為替レートを取
13255  |                    dstrCurrencyCode = gbuMGetUPDR||13252  |                    dstrCurrencyCode = gbuMGetUPDR
13256  |                    ddblExchangeRate = fnstrExchan||13253  |                    ddblExchangeRate = fnstrExchan
13257  |                    If ddblExchangeRate = 0 Then  ||13254  |                    If ddblExchangeRate = 0 Then  
13258  |                      intRtn = MsgBox("ＴＴＭが取 ||13255  |                      intRtn = MsgBox("ＴＴＭが取 
13259  |                      vbLf & "対象通貨コード ： [ ||13256  |                      vbLf & "対象通貨コード ： [ 
13260  |                      vbLf & "基準日 ： [ " & Mid(||13257  |                      vbLf & "基準日 ： [ " & Mid(
13261  |                          vbCritical, "ＴＴＭ取得 ||13258  |                          vbCritical, "ＴＴＭ取得 
13262  |                      Exit Function               ||13259  |                      Exit Function               
13263  |                    End If                        ||13260  |                    End If                        
13264  |                    'JPY→閾値通貨へ逆レート換算  ||13261  |                    'JPY→閾値通貨へ逆レート換算  
13265  |                    dblValueIn = dblValueIn / ddbl||13262  |                    dblValueIn = dblValueIn / ddbl
13266  |                End If                            ||13263  |                End If                            
13267  |            End If                                ||13264  |            End If                                
13268  |        End Select                                ||13265  |        End Select                                
13269  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    ||13266  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    
13270  |        Call sbGetRoundValue2(dblValueIn)         ||13267  |        Call sbGetRoundValue2(dblValueIn)         
13271  |        lCalcNav = CStr(Format(dblValueOut, "#,##0||13268  |        lCalcNav = CStr(Format(dblValueOut, "#,##0
13272  |        '固定料率                                 ||13269  |        '固定料率                                 
13273  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat||13270  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat
13274  |            '計算対称NAV × 外部委託顧問料率 ÷ 10||13271  |            '計算対称NAV × 外部委託顧問料率 ÷ 10
13275  |            dRitsu = CDbl(gbuOtherComRateGetUPDRec||13272  |            dRitsu = CDbl(gbuOtherComRateGetUPDRec
13276  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_||13273  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_
13277  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_||13274  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_
13278  |                '一年間の日数：365日またはカレンダ||13275  |                '一年間の日数：365日またはカレンダ
13279  |                dblValueIn = lCalcNav * dRitsu / 1||13276  |                dblValueIn = lCalcNav * dRitsu / 1
13280  |            Else                                  ||13277  |            Else                                  
13281  |                '一年間の日数：360日              ||13278  |                '一年間の日数：360日              
13282  |                dblValueIn = lCalcNav * dRitsu / 1||13279  |                dblValueIn = lCalcNav * dRitsu / 1
13283  |            End If                                ||13280  |            End If                                
13284  |                                                  ||13281  |                                                  
13285  |        '段階料率                                 ||13282  |        '段階料率                                 
13286  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other||13283  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other
13287  |            '料率分ループ処理                     ||13284  |            '料率分ループ処理                     
13288  |            For i = LBound(gbuOtherComRateGetUPDRe||13285  |            For i = LBound(gbuOtherComRateGetUPDRe
13289  |                TotalRate = TotalRate + CCur(gbuOt||13286  |                TotalRate = TotalRate + CCur(gbuOt
13290  |                cRate = CCur(gbuOtherComRateGetUPD||13287  |                cRate = CCur(gbuOtherComRateGetUPD
13291  |                dRitsu = CDbl(gbuOtherComRateGetUP||13288  |                dRitsu = CDbl(gbuOtherComRateGetUP
13292  |                If i = UBound(gbuOtherComRateGetUP||13289  |                If i = UBound(gbuOtherComRateGetUP
13293  |                    '(前回閾値)：累積閾値 = WORK閾||13290  |                    '(前回閾値)：累積閾値 = WORK閾
13294  |                    TotalRate = WorkRate          ||13291  |                    TotalRate = WorkRate          
13295  |                ElseIf TotalRate <= lCalcNav Then ||13292  |                ElseIf TotalRate <= lCalcNav Then 
13296  |                    '累積投資顧問料 = 累積投資顧問||13293  |                    '累積投資顧問料 = 累積投資顧問
13297  |                    dblValueIn = cRate * dRitsu / ||13294  |                    dblValueIn = cRate * dRitsu / 
13298  |                    Call sbGetRoundValue2(dblValue||13295  |                    Call sbGetRoundValue2(dblValue
13299  |                    TotalCom = TotalCom + dblValue||13296  |                    TotalCom = TotalCom + dblValue
13300  |                Else                              ||13297  |                Else                              
13301  |                    '(前回閾値)：累積閾値 = WORK閾||13298  |                    '(前回閾値)：累積閾値 = WORK閾
13302  |                    TotalRate = WorkRate          ||13299  |                    TotalRate = WorkRate          
13303  |                    Exit For                      ||13300  |                    Exit For                      
13304  |                End If                            ||13301  |                End If                            
13305  |                '累積閾値をWORKに格納(一つ前の閾値||13302  |                '累積閾値をWORKに格納(一つ前の閾値
13306  |                WorkRate = TotalRate              ||13303  |                WorkRate = TotalRate              
13307  |            Next i                                ||13304  |            Next i                                
13308  |            '累積投資顧問料 = 累積投資顧問料 + (計||13305  |            '累積投資顧問料 = 累積投資顧問料 + (計
13309  |            dblValueIn = (lCalcNav - TotalRate) * ||13306  |            dblValueIn = (lCalcNav - TotalRate) * 
13310  |            TotalCom = TotalCom + dblValueIn      ||13307  |            TotalCom = TotalCom + dblValueIn      
13311  |            '投資顧問料 = 累積投資顧問料 × 計算期||13308  |            '投資顧問料 = 累積投資顧問料 × 計算期
13312  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_||13309  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_
13313  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_||13310  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_
13314  |                '一年間の日数：365日またはカレンダ||13311  |                '一年間の日数：365日またはカレンダ
13315  |                dblValueIn = TotalCom * iCalcNum /||13312  |                dblValueIn = TotalCom * iCalcNum /
13316  |            Else                                  ||13313  |            Else                                  
13317  |                '一年間の日数：360日              ||13314  |                '一年間の日数：360日              
13318  |                dblValueIn = TotalCom * iCalcNum /||13315  |                dblValueIn = TotalCom * iCalcNum /
13319  |            End If                                ||13316  |            End If                                
13320  |        End If                                    ||13317  |        End If                                    
13321  |        ddblExchangeRate = 0                      ||13318  |        ddblExchangeRate = 0                      
13322  |        '@@@@@ 外部委託顧問料に換算 @@@@@         ||13319  |        '@@@@@ 外部委託顧問料に換算 @@@@@         
13323  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||13320  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
13324  |          Case "1"    '固定料率                   ||13321  |          Case "1"    '固定料率                   
13325  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o||13322  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o
13326  |                Else                              ||13323  |                Else                              
13327  |                  '外部委託顧問料通貨→JPYの為替レ||13324  |                  '外部委託顧問料通貨→JPYの為替レ
13328  |                  dstrCurrencyCode = gbuMGetUPDRec||13325  |                  dstrCurrencyCode = gbuMGetUPDRec
13329  |                  ddblExchangeRate = fnstrExchange||13326  |                  ddblExchangeRate = fnstrExchange
13330  |                  If ddblExchangeRate = 0 Then    ||13327  |                  If ddblExchangeRate = 0 Then    
13331  |                    intRtn = MsgBox("ＴＴＭが取得 ||13328  |                    intRtn = MsgBox("ＴＴＭが取得 
13332  |                    vbLf & "対象通貨コード ： [ " ||13329  |                    vbLf & "対象通貨コード ： [ " 
13333  |                    vbLf & "基準日 ： [ " & Mid(ds||13330  |                    vbLf & "基準日 ： [ " & Mid(ds
13334  |                        vbCritical, "ＴＴＭ取得エ ||13331  |                        vbCritical, "ＴＴＭ取得エ 
13335  |                    Exit Function                 ||13332  |                    Exit Function                 
13336  |                  End If                          ||13333  |                  End If                          
13337  |                  'JPY→閾値通貨へ逆レート換算    ||13334  |                  'JPY→閾値通貨へ逆レート換算    
13338  |                  dblValueIn = dblValueIn / ddblEx||13335  |                  dblValueIn = dblValueIn / ddblEx
13339  |                End If                            ||13336  |                End If                            
13340  |          Case "2"    '段階料率                   ||13337  |          Case "2"    '段階料率                   
13341  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||13338  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
13342  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||13339  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
13343  |                Else                              ||13340  |                Else                              
13344  |                    '閾値通貨→JPYの為替レートを取||13341  |                    '閾値通貨→JPYの為替レートを取
13345  |                    dstrCurrencyCode = gbuMGetUPDR||13342  |                    dstrCurrencyCode = gbuMGetUPDR
13346  |                    ddblExchangeRate = fnstrExchan||13343  |                    ddblExchangeRate = fnstrExchan
13347  |                    'JPY→閾値通貨へ逆レート換算  ||13344  |                    'JPY→閾値通貨へ逆レート換算  
13348  |                    dblValueIn = dblValueIn / ddbl||13345  |                    dblValueIn = dblValueIn / ddbl
13349  |                End If                            ||13346  |                End If                            
13350  |            Else                                  ||13347  |            Else                                  
13351  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||13348  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
13352  |                    '外部委託顧問料通貨→JPYの為替||13349  |                    '外部委託顧問料通貨→JPYの為替
13353  |                    dstrCurrencyCode = gbuMGetUPDR||13350  |                    dstrCurrencyCode = gbuMGetUPDR
13354  |                    ddblExchangeRate = fnstrExchan||13351  |                    ddblExchangeRate = fnstrExchan
13355  |                    'JPY→閾値通貨へレート換算    ||13352  |                    'JPY→閾値通貨へレート換算    
13356  |                    dblValueIn = dblValueIn / ddbl||13353  |                    dblValueIn = dblValueIn / ddbl
13357  |                Else                              ||13354  |                Else                              
13358  |                    '閾値通貨→JPYの為替レートを取||13355  |                    '閾値通貨→JPYの為替レートを取
13359  |                    dstrCurrencyCode = gbuMGetUPDR||13356  |                    dstrCurrencyCode = gbuMGetUPDR
13360  |                    ddblExchangeRate = fnstrExchan||13357  |                    ddblExchangeRate = fnstrExchan
13361  |                    'JPY→閾値通貨へ逆レート換算  ||13358  |                    'JPY→閾値通貨へ逆レート換算  
13362  |                    dblValueIn = dblValueIn * ddbl||13359  |                    dblValueIn = dblValueIn * ddbl
13363  |                    '外部委託顧問料通貨→JPYの為替||13360  |                    '外部委託顧問料通貨→JPYの為替
13364  |                    dstrCurrencyCode = gbuMGetUPDR||13361  |                    dstrCurrencyCode = gbuMGetUPDR
13365  |                    ddblExchangeRate = fnstrExchan||13362  |                    ddblExchangeRate = fnstrExchan
13366  |                    'JPY→閾値通貨へ逆レート換算  ||13363  |                    'JPY→閾値通貨へ逆レート換算  
13367  |                    dblValueIn = dblValueIn / ddbl||13364  |                    dblValueIn = dblValueIn / ddbl
13368  |                End If                            ||13365  |                End If                            
13369  |            End If                                ||13366  |            End If                                
13370  |        End Select                                ||13367  |        End Select                                
13371  |        '@@@@@ 外部委託顧問料に換算 @@@@@         ||13368  |        '@@@@@ 外部委託顧問料に換算 @@@@@         
13372  |        Call sbGetRoundValue2(dblValueIn)         ||13369  |        Call sbGetRoundValue2(dblValueIn)         
13373  |        mstrMonthlyPayCom = dblValueOut           ||13370  |        mstrMonthlyPayCom = dblValueOut           
13374  |        ': ,文言                                  ||13371  |        ': ,文言                                  
13375  |        .Cells(39, 11).Value = sWord19            ||13372  |        .Cells(39, 11).Value = sWord19            
13376  |        '年率 ,文言                               ||13373  |        '年率 ,文言                               
13377  |        .Cells(39, 2).Value = sWord10             ||13374  |        .Cells(39, 2).Value = sWord10             
13378  |        TotalRate = 0                             ||13375  |        TotalRate = 0                             
13379  |                                                  ||13376  |                                                  
13380  |        '年率の設定                               ||13377  |        '年率の設定                               
13381  |        Call sbExcelNetAssetValue(TotalRate, lRecI||13378  |        Call sbExcelNetAssetValue(TotalRate, lRecI
13382  |                                                  ||13379  |                                                  
13383  |        '投資顧問料                               ||13380  |        '投資顧問料                               
13384  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||13381  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
13385  |            Case Mid(mstrContractFlag(1), 1, 1)   ||13382  |            Case Mid(mstrContractFlag(1), 1, 1)   
13386  |                .Cells(46, 2).Value = sWord11a    ||13383  |                .Cells(46, 2).Value = sWord11a    
13387  |            Case Mid(mstrContractFlag(2), 1, 1)   ||13384  |            Case Mid(mstrContractFlag(2), 1, 1)   
13388  |                .Cells(46, 2).Value = sWord11b    ||13385  |                .Cells(46, 2).Value = sWord11b    
13389  |            Case Mid(mstrContractFlag(3), 1, 1)   ||13386  |            Case Mid(mstrContractFlag(3), 1, 1)   
13390  |                .Cells(46, 2).Value = sWord11c    ||13387  |                .Cells(46, 2).Value = sWord11c    
13391  |            Case Else                             ||13388  |            Case Else                             
13392  |                MsgBox "契約区分が不正です。", vbC||13389  |                MsgBox "契約区分が不正です。", vbC
13393  |        End Select                                ||13390  |        End Select                                
13394  |        .Cells(46, 11).Value = sWord19            ||13391  |        .Cells(46, 11).Value = sWord19            
13395  |        '外部委託顧問料                           ||13392  |        '外部委託顧問料                           
13396  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||13393  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
13397  |            .Cells(46, 31).NumberFormatLocal = "@"||13394  |            .Cells(46, 31).NumberFormatLocal = "@"
13398  |        Else                                      ||13395  |        Else                                      
13399  |            .Cells(46, 29).NumberFormatLocal = "@"||13396  |            .Cells(46, 29).NumberFormatLocal = "@"
13400  |        End If                                    ||13397  |        End If                                    
13401  |        '契約区分が名称使用許諾料の場合上限・下限 ||13398  |        '契約区分が名称使用許諾料の場合上限・下限 
13402  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||13399  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
13403  |            '下限金額より換算した金額が小さい場合 ||13400  |            '下限金額より換算した金額が小さい場合 
13404  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_f||13401  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_f
13405  |                If mstrMonthlyPayCom < CDbl(gbuMGe||13402  |                If mstrMonthlyPayCom < CDbl(gbuMGe
13406  |                    mstrMonthlyPayCom = CDbl(gbuMG||13403  |                    mstrMonthlyPayCom = CDbl(gbuMG
13407  |                End If                            ||13404  |                End If                            
13408  |            End If                                ||13405  |            End If                                
13409  |            '上限金額より換算した金額が大きい場合 ||13406  |            '上限金額より換算した金額が大きい場合 
13410  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_c||13407  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_c
13411  |                If mstrMonthlyPayCom > CDbl(gbuMGe||13408  |                If mstrMonthlyPayCom > CDbl(gbuMGe
13412  |                    mstrMonthlyPayCom = CDbl(gbuMG||13409  |                    mstrMonthlyPayCom = CDbl(gbuMG
13413  |                End If                            ||13410  |                End If                            
13414  |            End If                                ||13411  |            End If                                
13415  |            dblValueIn = CDbl(mstrMonthlyPayCom)  ||13412  |            dblValueIn = CDbl(mstrMonthlyPayCom)  
13416  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||13413  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
13417  |                Call sbGetRoundValue2(dblValueIn) ||13414  |                Call sbGetRoundValue2(dblValueIn) 
13418  |            Else                                  ||13415  |            Else                                  
13419  |                Call sbGetRoundValue(dblValueIn)  ||13416  |                Call sbGetRoundValue(dblValueIn)  
13420  |            End If                                ||13417  |            End If                                
13421  |            mstrMonthlyPayCom = dblValueOut       ||13418  |            mstrMonthlyPayCom = dblValueOut       
13422  |        End If                                    ||13419  |        End If                                    
13423  |        '外部委託顧問料通貨                       ||13420  |        '外部委託顧問料通貨                       
13424  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||13421  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
13425  |            Case cAud                             ||13422  |            Case cAud                             
13426  |                .Cells(46, 31).Value = CStr(Format||13423  |                .Cells(46, 31).Value = CStr(Format
13427  |                .Cells(46, 32).Value = sAud       ||13424  |                .Cells(46, 32).Value = sAud       
13428  |            Case cCad                             ||13425  |            Case cCad                             
13429  |                .Cells(46, 31).Value = CStr(Format||13426  |                .Cells(46, 31).Value = CStr(Format
13430  |                .Cells(46, 32).Value = sCad       ||13427  |                .Cells(46, 32).Value = sCad       
13431  |            Case cChf                             ||13428  |            Case cChf                             
13432  |                .Cells(46, 31).Value = CStr(Format||13429  |                .Cells(46, 31).Value = CStr(Format
13433  |                .Cells(46, 32).Value = sChf       ||13430  |                .Cells(46, 32).Value = sChf       
13434  |            Case cEur                             ||13431  |            Case cEur                             
13435  |                .Cells(46, 31).Value = CStr(Format||13432  |                .Cells(46, 31).Value = CStr(Format
13436  |                .Cells(46, 32).Value = sEur       ||13433  |                .Cells(46, 32).Value = sEur       
13437  |            Case cGbp                             ||13434  |            Case cGbp                             
13438  |                .Cells(46, 31).Value = CStr(Format||13435  |                .Cells(46, 31).Value = CStr(Format
13439  |                .Cells(46, 32).Value = sGbp       ||13436  |                .Cells(46, 32).Value = sGbp       
13440  |            Case cHkd                             ||13437  |            Case cHkd                             
13441  |                .Cells(46, 31).Value = CStr(Format||13438  |                .Cells(46, 31).Value = CStr(Format
13442  |                .Cells(46, 32).Value = sHkd       ||13439  |                .Cells(46, 32).Value = sHkd       
13443  |            Case cJpy                             ||13440  |            Case cJpy                             
13444  |                .Cells(46, 29).Value = CStr(Format||13441  |                .Cells(46, 29).Value = CStr(Format
13445  |                .Cells(46, 32).Value = sYen       ||13442  |                .Cells(46, 32).Value = sYen       
13446  |            Case cMyr                             ||13443  |            Case cMyr                             
13447  |                .Cells(46, 31).Value = CStr(Format||13444  |                .Cells(46, 31).Value = CStr(Format
13448  |                .Cells(46, 32).Value = sMyr       ||13445  |                .Cells(46, 32).Value = sMyr       
13449  |            Case cNzd                             ||13446  |            Case cNzd                             
13450  |                .Cells(46, 31).Value = CStr(Format||13447  |                .Cells(46, 31).Value = CStr(Format
13451  |                .Cells(46, 32).Value = sNzd       ||13448  |                .Cells(46, 32).Value = sNzd       
13452  |            Case cSek                             ||13449  |            Case cSek                             
13453  |                .Cells(46, 31).Value = CStr(Format||13450  |                .Cells(46, 31).Value = CStr(Format
13454  |                .Cells(46, 32).Value = sSek       ||13451  |                .Cells(46, 32).Value = sSek       
13455  |            Case cSgd                             ||13452  |            Case cSgd                             
13456  |                .Cells(46, 31).Value = CStr(Format||13453  |                .Cells(46, 31).Value = CStr(Format
13457  |                .Cells(46, 32).Value = sSgd       ||13454  |                .Cells(46, 32).Value = sSgd       
13458  |            Case cUsd                             ||13455  |            Case cUsd                             
13459  |                .Cells(46, 31).Value = CStr(Format||13456  |                .Cells(46, 31).Value = CStr(Format
13460  |                .Cells(46, 32).Value = sUsd       ||13457  |                .Cells(46, 32).Value = sUsd       
13461  |            Case cNok                             ||13458  |            Case cNok                             
13462  |                .Cells(46, 31).Value = CStr(Format||13459  |                .Cells(46, 31).Value = CStr(Format
13463  |                .Cells(46, 32).Value = sNok       ||13460  |                .Cells(46, 32).Value = sNok       
13464  |        End Select                                ||13461  |        End Select                                
13465  |                                                  ||13462  |                                                  
13466  |        '顧問料                                   ||13463  |        '顧問料                                   
13467  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||13464  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
13468  |            .Cells(46, 31).HorizontalAlignment = x||13465  |            .Cells(46, 31).HorizontalAlignment = x
13469  |        Else                                      ||13466  |        Else                                      
13470  |            .Cells(46, 29).HorizontalAlignment = x||13467  |            .Cells(46, 29).HorizontalAlignment = x
13471  |        End If                                    ||13468  |        End If                                    
13472  |                                                  ||13469  |                                                  
13473  |        '契約区分が名称使用許諾料の場合上限・下限 ||13470  |        '契約区分が名称使用許諾料の場合上限・下限 
13474  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||13471  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
13475  |            '上限金額                             ||13472  |            '上限金額                             
13476  |            .Cells(46, 39).Value = sWordCap       ||13473  |            .Cells(46, 39).Value = sWordCap       
13477  |            .Cells(46, 57).NumberFormatLocal = "@"||13474  |            .Cells(46, 57).NumberFormatLocal = "@"
13478  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||13475  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
13479  |                .Cells(46, 57).Value = Format(gbuM||13476  |                .Cells(46, 57).Value = Format(gbuM
13480  |            Else                                  ||13477  |            Else                                  
13481  |                .Cells(46, 57).Value = Format(gbuM||13478  |                .Cells(46, 57).Value = Format(gbuM
13482  |            End If                                ||13479  |            End If                                
13483  |            .Cells(46, 57).HorizontalAlignment = x||13480  |            .Cells(46, 57).HorizontalAlignment = x
13484  |            '下限金額                             ||13481  |            '下限金額                             
13485  |            .Cells(47, 39).Value = sWordFloor     ||13482  |            .Cells(47, 39).Value = sWordFloor     
13486  |            .Cells(47, 57).NumberFormatLocal = "@"||13483  |            .Cells(47, 57).NumberFormatLocal = "@"
13487  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||13484  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
13488  |                .Cells(47, 57).Value = Format(gbuM||13485  |                .Cells(47, 57).Value = Format(gbuM
13489  |            Else                                  ||13486  |            Else                                  
13490  |                .Cells(47, 57).Value = Format(gbuM||13487  |                .Cells(47, 57).Value = Format(gbuM
13491  |            End If                                ||13488  |            End If                                
13492  |            .Cells(47, 57).HorizontalAlignment = x||13489  |            .Cells(47, 57).HorizontalAlignment = x
13493  |        End If                                    ||13490  |        End If                                    
13494  |                                                  ||13491  |                                                  
13495  |        ddblExchangeRate = 0                      ||13492  |        ddblExchangeRate = 0                      
13496  |        '@@@@@ 支払に換算 @@@@@                   ||13493  |        '@@@@@ 支払に換算 @@@@@                   
13497  |        dblValueIn = mstrMonthlyPayCom            ||13494  |        dblValueIn = mstrMonthlyPayCom            
13498  |                                                  ||13495  |                                                  
13499  |        '2006/04/12 START K.Furuya 実払管理テーブ ||13496  |        '2006/04/12 START K.Furuya 実払管理テーブ 
13500  |        '通貨円以外の場合確定顧問料通貨を取得     ||13497  |        '通貨円以外の場合確定顧問料通貨を取得     
13501  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||13498  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
13502  |            WkFixComC = ""                        ||13499  |            WkFixComC = ""                        
13503  |            WkRealComC = ""                       ||13500  |            WkRealComC = ""                       
13504  |            WkFixComC = mstrMonthlyPayCom         ||13501  |            WkFixComC = mstrMonthlyPayCom         
13505  |            WkRealComC = mstrMonthlyPayCom        ||13502  |            WkRealComC = mstrMonthlyPayCom        
13506  |        End If                                    ||13503  |        End If                                    
13507  |        '通貨を取得                               ||13504  |        '通貨を取得                               
13508  |        WkCurCode = ""                            ||13505  |        WkCurCode = ""                            
13509  |        WkCurCode = Trim(gbuMGetUPDRec.N(lRecIdx).||13506  |        WkCurCode = Trim(gbuMGetUPDRec.N(lRecIdx).
13510  |        '2006/04/12 END   K.Furuya 実払管理テーブ ||13507  |        '2006/04/12 END   K.Furuya 実払管理テーブ 
13511  |                                                  ||13508  |                                                  
13512  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||13509  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
13513  |          Case "1"    '固定料率                   ||13510  |          Case "1"    '固定料率                   
13514  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o||13511  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o
13515  |                Else                              ||13512  |                Else                              
13516  |                  '外部委託顧問料通貨→JPYの為替レ||13513  |                  '外部委託顧問料通貨→JPYの為替レ
13517  |                  dstrCurrencyCode = gbuMGetUPDRec||13514  |                  dstrCurrencyCode = gbuMGetUPDRec
13518  |                  ddblExchangeRate = fnstrExchange||13515  |                  ddblExchangeRate = fnstrExchange
13519  |                  If ddblExchangeRate = 0 Then    ||13516  |                  If ddblExchangeRate = 0 Then    
13520  |                    intRtn = MsgBox("ＴＴＭが取得 ||13517  |                    intRtn = MsgBox("ＴＴＭが取得 
13521  |                    vbLf & "対象通貨コード ： [ " ||13518  |                    vbLf & "対象通貨コード ： [ " 
13522  |                    vbLf & "基準日 ： [ " & Mid(ds||13519  |                    vbLf & "基準日 ： [ " & Mid(ds
13523  |                        vbCritical, "ＴＴＭ取得エ ||13520  |                        vbCritical, "ＴＴＭ取得エ 
13524  |                    Exit Function                 ||13521  |                    Exit Function                 
13525  |                  End If                          ||13522  |                  End If                          
13526  |                  'JPY→支払通貨へレート換算      ||13523  |                  'JPY→支払通貨へレート換算      
13527  |                  dblValueIn = dblValueIn * ddblEx||13524  |                  dblValueIn = dblValueIn * ddblEx
13528  |                End If                            ||13525  |                End If                            
13529  |          Case "2"    '段階料率                   ||13526  |          Case "2"    '段階料率                   
13530  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||13527  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
13531  |            Else                                  ||13528  |            Else                                  
13532  |                '外部委託顧問料通貨→JPYの為替レー||13529  |                '外部委託顧問料通貨→JPYの為替レー
13533  |                dstrCurrencyCode = gbuMGetUPDRec.N||13530  |                dstrCurrencyCode = gbuMGetUPDRec.N
13534  |                ddblExchangeRate = fnstrExchangeRa||13531  |                ddblExchangeRate = fnstrExchangeRa
13535  |                If ddblExchangeRate = 0 Then      ||13532  |                If ddblExchangeRate = 0 Then      
13536  |                  intRtn = MsgBox("ＴＴＭが取得で ||13533  |                  intRtn = MsgBox("ＴＴＭが取得で 
13537  |                  vbLf & "対象通貨コード ： [ " & ||13534  |                  vbLf & "対象通貨コード ： [ " & 
13538  |                  vbLf & "基準日 ： [ " & Mid(dstr||13535  |                  vbLf & "基準日 ： [ " & Mid(dstr
13539  |                      vbCritical, "ＴＴＭ取得エラ ||13536  |                      vbCritical, "ＴＴＭ取得エラ 
13540  |                  Exit Function                   ||13537  |                  Exit Function                   
13541  |                End If                            ||13538  |                End If                            
13542  |                '外部委託顧問料通貨→JPYへレート換||13539  |                '外部委託顧問料通貨→JPYへレート換
13543  |                dblValueIn = dblValueIn * ddblExch||13540  |                dblValueIn = dblValueIn * ddblExch
13544  |            End If                                ||13541  |            End If                                
13545  |        End Select                                ||13542  |        End Select                                
13546  |        '@@@@@ 支払に換算 @@@@@                   ||13543  |        '@@@@@ 支払に換算 @@@@@                   
13547  |        Call sbGetRoundValue(dblValueIn)          ||13544  |        Call sbGetRoundValue(dblValueIn)          
13548  |        mstrMonthlyPayCom = dblValueOut           ||13545  |        mstrMonthlyPayCom = dblValueOut           
13549  |                                                  ||13546  |                                                  
13550  |        '2006/04/12 START K.Furuya 実払管理テーブ ||13547  |        '2006/04/12 START K.Furuya 実払管理テーブ 
13551  |        '確定額と実払額を取得                     ||13548  |        '確定額と実払額を取得                     
13552  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||13549  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
13553  |            WkFixComC = ""                        ||13550  |            WkFixComC = ""                        
13554  |            WkFixComJ = ""                        ||13551  |            WkFixComJ = ""                        
13555  |            WkRealComC = ""                       ||13552  |            WkRealComC = ""                       
13556  |            WkRealComJ = ""                       ||13553  |            WkRealComJ = ""                       
13557  |            WkFixComC = mstrMonthlyPayCom         ||13554  |            WkFixComC = mstrMonthlyPayCom         
13558  |            WkFixComJ = mstrMonthlyPayCom         ||13555  |            WkFixComJ = mstrMonthlyPayCom         
13559  |            WkRealComC = mstrMonthlyPayCom        ||13556  |            WkRealComC = mstrMonthlyPayCom        
13560  |            WkRealComJ = mstrMonthlyPayCom        ||13557  |            WkRealComJ = mstrMonthlyPayCom        
13561  |        Else                                      ||13558  |        Else                                      
13562  |            WkFixComJ = ""                        ||13559  |            WkFixComJ = ""                        
13563  |            WkRealComJ = ""                       ||13560  |            WkRealComJ = ""                       
13564  |            WkFixComJ = mstrMonthlyPayCom         ||13561  |            WkFixComJ = mstrMonthlyPayCom         
13565  |            WkRealComJ = mstrMonthlyPayCom        ||13562  |            WkRealComJ = mstrMonthlyPayCom        
13566  |        End If                                    ||13563  |        End If                                    
13567  |        '2006/04/12 END   K.Furuya 実払管理テーブ ||13564  |        '2006/04/12 END   K.Furuya 実払管理テーブ 
13568  |                                                  ||13565  |                                                  
13569  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||13566  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
13570  |            'TTMレート                            ||13567  |            'TTMレート                            
13571  |            .Cells(47, 19).Value = sWord43        ||13568  |            .Cells(47, 19).Value = sWord43        
13572  |            .Cells(47, 33).NumberFormatLocal = "@"||13569  |            .Cells(47, 33).NumberFormatLocal = "@"
13573  |            .Cells(47, 33).Value = Format(ddblExch||13570  |            .Cells(47, 33).Value = Format(ddblExch
13574  |            .Cells(47, 33).HorizontalAlignment = x||13571  |            .Cells(47, 33).HorizontalAlignment = x
13575  |            .Cells(47, 34).Value = sWord44        ||13572  |            .Cells(47, 34).Value = sWord44        
13576  |        End If                                    ||13573  |        End If                                    
13577  |        '支払額                                   ||13574  |        '支払額                                   
13578  |        .Cells(48, 2).Value = sWord46             ||13575  |        .Cells(48, 2).Value = sWord46             
13579  |        .Cells(48, 11).Value = sWord19            ||13576  |        .Cells(48, 11).Value = sWord19            
13580  |        '税抜金額(月別支払顧問料の累計)           ||13577  |        '税抜金額(月別支払顧問料の累計)           
13581  |        .Cells(48, 29).NumberFormatLocal = "@"    ||13578  |        .Cells(48, 29).NumberFormatLocal = "@"    
13582  |        .Cells(48, 29).Value = CStr(Format(mstrMon||13579  |        .Cells(48, 29).Value = CStr(Format(mstrMon
13583  |        .Cells(48, 29).HorizontalAlignment = xlRig||13580  |        .Cells(48, 29).HorizontalAlignment = xlRig
13584  |        .Cells(48, 32).Value = sYen               ||13581  |        .Cells(48, 32).Value = sYen               
13585 L|                                                  ||13582 R|                                                  
13586  |        '消費税計算有無：「有り」の場合のみ、消費 ||13583  |        '消費税計算有無：「有り」の場合のみ、消費 
13587  |        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc_||13584  |        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc_
13588  |'2014/02/19 START M.Takada 【管理会計】消費税率変 ||13585  |'2014/02/19 START M.Takada 【管理会計】消費税率変 
13589  |            '(消費税XX%)                          ||13586  |            '(消費税XX%)                          
13590  |            'iSyouhizei = ddblconsumption_tax     ||13587  |            'iSyouhizei = ddblconsumption_tax     
13591  |            '.Cells(49, 32).Value = sWord22 & iSyo||13588  |            '.Cells(49, 32).Value = sWord22 & iSyo
13592  |            'dblValueIn = mstrMonthlyPayCom * iSyo||13589  |            'dblValueIn = mstrMonthlyPayCom * iSyo
13593  |            'Call sbGetRoundValueTax(dblValueIn)  ||13590  |            'Call sbGetRoundValueTax(dblValueIn)  
13594  |            'lTaxNum = dblValueOut                ||13591  |            'lTaxNum = dblValueOut                
13595  |            '.Cells(49, 29).NumberFormatLocal = "@||13592  |            '.Cells(49, 29).NumberFormatLocal = "@
13596  |            '.Cells(49, 29).Value = CStr(Format((l||13593  |            '.Cells(49, 29).Value = CStr(Format((l
13597  |            '.Cells(49, 29).HorizontalAlignment = ||13594  |            '.Cells(49, 29).HorizontalAlignment = 
13598  |            '合計(消費税＋月別支払顧問料の累計)   ||13595  |            '合計(消費税＋月別支払顧問料の累計)   
13599  |            '.Cells(50, 13).Value = sWord24       ||13596  |            '.Cells(50, 13).Value = sWord24       
13600  |            'dblValueIn = lTaxNum + CCur(mstrMonth||13597  |            'dblValueIn = lTaxNum + CCur(mstrMonth
13601  |            'Call sbGetRoundValue(dblValueIn)     ||13598  |            'Call sbGetRoundValue(dblValueIn)     
13602  |            'lMonthlyPayCom = dblValueOut         ||13599  |            'lMonthlyPayCom = dblValueOut         
13603  |            '.Cells(50, 29).NumberFormatLocal = "@||13600  |            '.Cells(50, 29).NumberFormatLocal = "@
13604  |            '.Cells(50, 29).Value = CStr(Format(lM||13601  |            '.Cells(50, 29).Value = CStr(Format(lM
13605  |            '.Cells(50, 29).HorizontalAlignment = ||13602  |            '.Cells(50, 29).HorizontalAlignment = 
13606  |            '円                                   ||13603  |            '円                                   
13607  |            '.Cells(50, 32).Value = sYen          ||13604  |            '.Cells(50, 32).Value = sYen          
13608  |            '下線                                 ||13605  |            '下線                                 
13609  |            'With xlSheet.Range("M49:AL49").Border||13606  |            'With xlSheet.Range("M49:AL49").Border
13610  |            '    .LineStyle = xlContinuous        ||13607  |            '    .LineStyle = xlContinuous        
13611  |            '    .Weight = xlThin                 ||13608  |            '    .Weight = xlThin                 
13612  |            'End With                             ||13609  |            'End With                             
       |                                                  ||13610 R|                                                  
13613  |            Call Tax_calc(dStart, dEnd)     '消費 ||13611  |            Call Tax_calc(dStart, dEnd)     '消費 
13614  |            If Tax_Flg = True Then                ||13612  |            If Tax_Flg = True Then                
13615  |                '計算期間中に消費税率が変更となる ||13613  |                '計算期間中に消費税率が変更となる 
13616  |                .Cells(49, 32).Value = sWord71    ||13614  |                .Cells(49, 32).Value = sWord71    
13617 L|                .Cells(49, 32).Font.Size = 10     ||       |                                                  
13618  |                .Cells(49, 29).NumberFormatLocal =||13615  |                .Cells(49, 29).NumberFormatLocal =
13619  |                '算出した税額を該当セルに設定する ||13616  |                '算出した税額を該当セルに設定する 
13620 L|                .Cells(49, 29).Value = CStr(Format||13617 R|                .Cells(49, 29).Value = CStr(Format
13621  |                .Cells(49, 29).HorizontalAlignment||13618  |                .Cells(49, 29).HorizontalAlignment
13622  |                '下線                             ||13619  |                '下線                             
13623 L|                With xlSheet.Range("M49:AH49").Bor||13620 R|                .Range("M49:AH49").Borders (xlEdge
13624 L|                            .LineStyle = xlContinu||13621 R|                .LineStyle = xlContinuous         
13625 L|                            .Weight = xlThin      ||13622 R|                .Weight = xlThin                  
13626 L|                End With                          ||       |                                                  
13627  |                                                  ||13623  |                                                  
13628  |                '注釈文言を出力する               ||13624  |                '注釈文言を出力する               
13629  |                .Cells(48, 36).Value = sWord64    ||13625  |                .Cells(48, 36).Value = sWord64    
13630  |                .Cells(48, 36).FontSize = 10      ||13626  |                .Cells(48, 36).FontSize = 10      
13631  |                .Cells(49, 36).Value = sWord65    ||13627  |                .Cells(49, 36).Value = sWord65    
13632  |                .Cells(49, 36).FontSize = 10      ||13628  |                .Cells(49, 36).FontSize = 10      
13633  |                                                  ||13629  |                                                  
13634  |            Else                                  ||13630  |            Else                                  
13635  |                '計算期間中に消費税率が変更となら ||13631  |                '計算期間中に消費税率が変更となら 
13636  |                '.Cells(49, 32).Value = sWord22 & ||13632  |                '.Cells(49, 32).Value = sWord22 & 
13637 L|                '.Cells(49, 32).Value = sWord22 & ||13633 R|                .Cells(49, 32).Value = sWord22 & s
13638  |                'dblValueIn = mstrMonthlyPayCom * ||13634  |                'dblValueIn = mstrMonthlyPayCom * 
13639 L|                .Cells(49, 32).Value = sWord22 & s||13635 R|                .Cells(49, 29).NumberFormatLocal =
13640 L|                '.Cells(49, 29).NumberFormatLocal ||       |                                                  
13641  |                '算出した税額を該当セルに設定する ||13636  |                '算出した税額を該当セルに設定する 
13642 L|                '.Cells(49, 29).Value = CStr(Forma||13637 R|                .Cells(49, 29).Value = CStr(Format
13643 L|                '.Cells(49, 29).HorizontalAlignmen||13638 R|                .Cells(49, 29).HorizontalAlignment
13644  |                '下線                             ||13639  |                '下線                             
13645 L|                'With xlSheet.Range("M49:AL49").Bo||13640 R|                .Range("M49:AL49").Borders (xlEdge
13646 L|                '            .LineStyle = xlContin||13641 R|                .LineStyle = xlContinuous         
13647 L|                '            .Weight = xlThin     ||13642 R|                .Weight = xlThin                  
13648 L|                'End With                         ||       |                                                  
13649  |            End If                                ||13643  |            End If                                
13650  |            '合計(消費税＋月別支払顧問料の累計)   ||13644  |            '合計(消費税＋月別支払顧問料の累計)   
13651  |            .Cells(50, 13).Value = sWord24        ||13645  |            .Cells(50, 13).Value = sWord24        
13652  |            .Cells(50, 29).NumberFormatLocal = "@"||13646  |            .Cells(50, 29).NumberFormatLocal = "@"
13653 L|            '.Cells(50, 29).Value = CStr(Format(Su||13647 R|            .Cells(50, 29).Value = CStr(Format((.C
13654 L|            .Cells(50, 29).Value = CStr(Format(CCu||       |                                                  
13655  |            .Cells(50, 29).HorizontalAlignment = x||13648  |            .Cells(50, 29).HorizontalAlignment = x
13656  |            '円                                   ||13649  |            '円                                   
13657  |            .Cells(50, 32).Value = sYen           ||13650  |            .Cells(50, 32).Value = sYen           
13658  |                                                  ||13651  |                                                  
13659  |            '下線                                 ||13652  |            '下線                                 
13660  |            'With xlSheet.Range("M49:AL49").Border||13653  |            'With xlSheet.Range("M49:AL49").Border
13661  |            '    .LineStyle = xlContinuous        ||13654  |            '    .LineStyle = xlContinuous        
13662  |            '    .Weight = xlThin                 ||13655  |            '    .Weight = xlThin                 
13663  |            'End With                             ||13656  |            'End With                             
13664  |                                                  ||13657  |                                                  
13665  |'2014/02/19 End M.Takada 【管理会計】消費税率変更 ||13658  |'2014/02/19 End M.Takada 【管理会計】消費税率変更 
13666  |        Else                                      ||13659  |        Else                                      
13667  |        End If                                    ||13660  |        End If                                    
13668  |                                                  ||13661  |                                                  
13669  |        '支払先                                   ||13662  |        '支払先                                   
13670  |        .Cells(52, 2).Value = sWord12             ||13663  |        .Cells(52, 2).Value = sWord12             
13671  |        .Cells(52, 11).Value = sWord19            ||13664  |        .Cells(52, 11).Value = sWord19            
13672  |        .Cells(52, 13).Value = gbuMGetUPDRec.N(lRe||13665  |        .Cells(52, 13).Value = gbuMGetUPDRec.N(lRe
13673  |        '支払予定日                               ||13666  |        '支払予定日                               
13674  |        .Cells(54, 2).Value = sWord13             ||13667  |        .Cells(54, 2).Value = sWord13             
13675  |        .Cells(54, 11).Value = sWord19            ||13668  |        .Cells(54, 11).Value = sWord19            
13676  |        '支払予定日                               ||13669  |        '支払予定日                               
13677  |        sDate = Trim(mstrPaymentDate)             ||13670  |        sDate = Trim(mstrPaymentDate)             
13678  |        .Cells(54, 13).Value = _                  ||13671  |        .Cells(54, 13).Value = _                  
13679  |            Format(sDate, "YYYY") & WordYear & _  ||13672  |            Format(sDate, "YYYY") & WordYear & _  
13680  |            Format(sDate, "M") & WordMonth & _    ||13673  |            Format(sDate, "M") & WordMonth & _    
13681  |            Format(sDate, "D") & WordDay          ||13674  |            Format(sDate, "D") & WordDay          
13682  |        '部署名                                   ||13675  |        '部署名                                   
13683  |        'コンボ左の数字取得                       ||13676  |        'コンボ左の数字取得                       
13684  |        ColNum = Trim(gstrComboCodeGet(cboBumonFla||13677  |        ColNum = Trim(gstrComboCodeGet(cboBumonFla
13685  |        'コンボ「：」以下の文字列                 ||13678  |        'コンボ「：」以下の文字列                 
13686  |        ColWord = Trim(gstrComboDataGet(cboBumonFl||13679  |        ColWord = Trim(gstrComboDataGet(cboBumonFl
13687  |        .Cells(56, 2).Value = ColWord             ||13680  |        .Cells(56, 2).Value = ColWord             
13688  |        .Range("B56:S56").HorizontalAlignment = xl||13681  |        .Range("B56:S56").HorizontalAlignment = xl
13689  |        '担当者印                                 ||13682  |        '担当者印                                 
13690  |        .Cells(57, 2).Value = sWord15             ||13683  |        .Cells(57, 2).Value = sWord15             
13691  |        .Range("B57:J57").HorizontalAlignment = xl||13684  |        .Range("B57:J57").HorizontalAlignment = xl
13692  |        '検印                                     ||13685  |        '検印                                     
13693  |        .Cells(57, 11).Value = sWord16            ||13686  |        .Cells(57, 11).Value = sWord16            
13694  |        .Range("K57:S57").HorizontalAlignment = xl||13687  |        .Range("K57:S57").HorizontalAlignment = xl
13695  |        '財務部                                   ||13688  |        '財務部                                   
13696  |        .Cells(56, 24).Value = sWord35            ||13689  |        .Cells(56, 24).Value = sWord35            
13697  |        .Range("X56:AO56").HorizontalAlignment = x||13690  |        .Range("X56:AO56").HorizontalAlignment = x
13698  |        '精査印                                   ||13691  |        '精査印                                   
13699  |        .Cells(57, 24).Value = sWord17            ||13692  |        .Cells(57, 24).Value = sWord17            
13700  |        .Range("X57:AF57").HorizontalAlignment = x||13693  |        .Range("X57:AF57").HorizontalAlignment = x
13701  |        '検印                                     ||13694  |        '検印                                     
13702  |        .Cells(57, 33).Value = sWord16            ||13695  |        .Cells(57, 33).Value = sWord16            
13703  |        .Range("AG57:AO57").HorizontalAlignment = ||13696  |        .Range("AG57:AO57").HorizontalAlignment = 
13704  |                                                  ||13697  |                                                  
13705  |    End With                                      ||13698  |    End With                                      
13706  |                                                  ||13699  |                                                  
13707  |    '月末純資産(外枠)                             ||13700  |    '月末純資産(外枠)                             
13708  |    With xlSheet.Range("N19:AN33").Borders(xlEdgeL||13701  |    With xlSheet.Range("N19:AN33").Borders(xlEdgeL
13709  |        .LineStyle = xlContinuous                 ||13702  |        .LineStyle = xlContinuous                 
13710  |        .Weight = xlThin                          ||13703  |        .Weight = xlThin                          
13711  |    End With                                      ||13704  |    End With                                      
13712  |    With xlSheet.Range("N19:AN33").Borders(xlEdgeT||13705  |    With xlSheet.Range("N19:AN33").Borders(xlEdgeT
13713  |        .LineStyle = xlContinuous                 ||13706  |        .LineStyle = xlContinuous                 
13714  |        .Weight = xlThin                          ||13707  |        .Weight = xlThin                          
13715  |    End With                                      ||13708  |    End With                                      
13716  |    With xlSheet.Range("N19:AN33").Borders(xlEdgeB||13709  |    With xlSheet.Range("N19:AN33").Borders(xlEdgeB
13717  |        .LineStyle = xlContinuous                 ||13710  |        .LineStyle = xlContinuous                 
13718  |        .Weight = xlThin                          ||13711  |        .Weight = xlThin                          
13719  |    End With                                      ||13712  |    End With                                      
13720  |    With xlSheet.Range("N19:AN33").Borders(xlEdgeR||13713  |    With xlSheet.Range("N19:AN33").Borders(xlEdgeR
13721  |        .LineStyle = xlContinuous                 ||13714  |        .LineStyle = xlContinuous                 
13722  |        .Weight = xlThin                          ||13715  |        .Weight = xlThin                          
13723  |    End With                                      ||13716  |    End With                                      
13724  |    With xlSheet.Range("N19:AN33").Borders(xlInsid||13717  |    With xlSheet.Range("N19:AN33").Borders(xlInsid
13725  |        .LineStyle = xlContinuous                 ||13718  |        .LineStyle = xlContinuous                 
13726  |        .Weight = xlThin                          ||13719  |        .Weight = xlThin                          
13727  |    End With                                      ||13720  |    End With                                      
13728  |    '月末純資産(真中縦線)                         ||13721  |    '月末純資産(真中縦線)                         
13729  |    With xlSheet.Range("Y19:Y33").Borders(xlEdgeRi||13722  |    With xlSheet.Range("Y19:Y33").Borders(xlEdgeRi
13730  |        .LineStyle = xlContinuous                 ||13723  |        .LineStyle = xlContinuous                 
13731  |        .Weight = xlThin                          ||13724  |        .Weight = xlThin                          
13732  |    End With                                      ||13725  |    End With                                      
13733  |    '月末純資産(左側捺印欄　外枠)                 ||13726  |    '月末純資産(左側捺印欄　外枠)                 
13734  |    With xlSheet.Range("B56:S63").Borders(xlEdgeLe||13727  |    With xlSheet.Range("B56:S63").Borders(xlEdgeLe
13735  |        .LineStyle = xlContinuous                 ||13728  |        .LineStyle = xlContinuous                 
13736  |        .Weight = xlThin                          ||13729  |        .Weight = xlThin                          
13737  |    End With                                      ||13730  |    End With                                      
13738  |    With xlSheet.Range("B56:S63").Borders(xlEdgeTo||13731  |    With xlSheet.Range("B56:S63").Borders(xlEdgeTo
13739  |        .LineStyle = xlContinuous                 ||13732  |        .LineStyle = xlContinuous                 
13740  |        .Weight = xlThin                          ||13733  |        .Weight = xlThin                          
13741  |    End With                                      ||13734  |    End With                                      
13742  |    With xlSheet.Range("B56:S63").Borders(xlEdgeBo||13735  |    With xlSheet.Range("B56:S63").Borders(xlEdgeBo
13743  |        .LineStyle = xlContinuous                 ||13736  |        .LineStyle = xlContinuous                 
13744  |        .Weight = xlThin                          ||13737  |        .Weight = xlThin                          
13745  |    End With                                      ||13738  |    End With                                      
13746  |    With xlSheet.Range("B56:S63").Borders(xlEdgeRi||13739  |    With xlSheet.Range("B56:S63").Borders(xlEdgeRi
13747  |        .LineStyle = xlContinuous                 ||13740  |        .LineStyle = xlContinuous                 
13748  |        .Weight = xlThin                          ||13741  |        .Weight = xlThin                          
13749  |    End With                                      ||13742  |    End With                                      
13750  |    '月末純資産(左側捺印欄　上枠)                 ||13743  |    '月末純資産(左側捺印欄　上枠)                 
13751  |    With xlSheet.Range("B56:S57").Borders(xlEdgeBo||13744  |    With xlSheet.Range("B56:S57").Borders(xlEdgeBo
13752  |        .LineStyle = xlContinuous                 ||13745  |        .LineStyle = xlContinuous                 
13753  |        .Weight = xlThin                          ||13746  |        .Weight = xlThin                          
13754  |    End With                                      ||13747  |    End With                                      
13755  |    With xlSheet.Range("B56:S57").Borders(xlInside||13748  |    With xlSheet.Range("B56:S57").Borders(xlInside
13756  |        .LineStyle = xlContinuous                 ||13749  |        .LineStyle = xlContinuous                 
13757  |        .Weight = xlThin                          ||13750  |        .Weight = xlThin                          
13758  |    End With                                      ||13751  |    End With                                      
13759  |    '月末純資産(左側捺印欄　縦線)                 ||13752  |    '月末純資産(左側捺印欄　縦線)                 
13760  |    With xlSheet.Range("J57:J63").Borders(xlEdgeRi||13753  |    With xlSheet.Range("J57:J63").Borders(xlEdgeRi
13761  |        .LineStyle = xlContinuous                 ||13754  |        .LineStyle = xlContinuous                 
13762  |        .Weight = xlThin                          ||13755  |        .Weight = xlThin                          
13763  |    End With                                      ||13756  |    End With                                      
13764  |    '月末純資産(右側捺印欄　外枠)                 ||13757  |    '月末純資産(右側捺印欄　外枠)                 
13765  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeL||13758  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeL
13766  |        .LineStyle = xlContinuous                 ||13759  |        .LineStyle = xlContinuous                 
13767  |        .Weight = xlThin                          ||13760  |        .Weight = xlThin                          
13768  |    End With                                      ||13761  |    End With                                      
13769  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeT||13762  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeT
13770  |        .LineStyle = xlContinuous                 ||13763  |        .LineStyle = xlContinuous                 
13771  |        .Weight = xlThin                          ||13764  |        .Weight = xlThin                          
13772  |    End With                                      ||13765  |    End With                                      
13773  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeB||13766  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeB
13774  |        .LineStyle = xlContinuous                 ||13767  |        .LineStyle = xlContinuous                 
13775  |        .Weight = xlThin                          ||13768  |        .Weight = xlThin                          
13776  |    End With                                      ||13769  |    End With                                      
13777  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeR||13770  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeR
13778  |        .LineStyle = xlContinuous                 ||13771  |        .LineStyle = xlContinuous                 
13779  |        .Weight = xlThin                          ||13772  |        .Weight = xlThin                          
13780  |    End With                                      ||13773  |    End With                                      
13781  |    '月末純資産(右側捺印欄　上枠)                 ||13774  |    '月末純資産(右側捺印欄　上枠)                 
13782  |    With xlSheet.Range("X56:AO57").Borders(xlEdgeT||13775  |    With xlSheet.Range("X56:AO57").Borders(xlEdgeT
13783  |        .LineStyle = xlContinuous                 ||13776  |        .LineStyle = xlContinuous                 
13784  |        .Weight = xlThin                          ||13777  |        .Weight = xlThin                          
13785  |    End With                                      ||13778  |    End With                                      
13786  |    With xlSheet.Range("X56:AO57").Borders(xlEdgeB||13779  |    With xlSheet.Range("X56:AO57").Borders(xlEdgeB
13787  |        .LineStyle = xlContinuous                 ||13780  |        .LineStyle = xlContinuous                 
13788  |        .Weight = xlThin                          ||13781  |        .Weight = xlThin                          
13789  |    End With                                      ||13782  |    End With                                      
13790  |    With xlSheet.Range("X56:AO57").Borders(xlInsid||13783  |    With xlSheet.Range("X56:AO57").Borders(xlInsid
13791  |        .LineStyle = xlContinuous                 ||13784  |        .LineStyle = xlContinuous                 
13792  |        .Weight = xlThin                          ||13785  |        .Weight = xlThin                          
13793  |    End With                                      ||13786  |    End With                                      
13794  |    '月末純資産(右側捺印欄　縦線)                 ||13787  |    '月末純資産(右側捺印欄　縦線)                 
13795  |    With xlSheet.Range("AF57:AF63").Borders(xlEdge||13788  |    With xlSheet.Range("AF57:AF63").Borders(xlEdge
13796  |        .LineStyle = xlContinuous                 ||13789  |        .LineStyle = xlContinuous                 
13797  |        .Weight = xlThin                          ||13790  |        .Weight = xlThin                          
13798  |    End With                                      ||13791  |    End With                                      
13799  |                                                  ||13792  |                                                  
13800  |                                                  ||13793  |                                                  
13801  |    '月末純資産　下線                             ||13794  |    '月末純資産　下線                             
13802  |    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract_||13795  |    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract_
13803  |    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||13796  |    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
13804  |        xlSheet.Cells(15, 13).Value = _           ||13797  |        xlSheet.Cells(15, 13).Value = _           
13805  |            CStr(Format(dStart, "YYYY年M月D日")) &||13798  |            CStr(Format(dStart, "YYYY年M月D日")) &
13806  |    Else                                          ||13799  |    Else                                          
13807  |        xlSheet.Cells(15, 13).Value = _           ||13800  |        xlSheet.Cells(15, 13).Value = _           
13808  |            CStr(Format(dStart, "YYYY年M月D日")) &||13801  |            CStr(Format(dStart, "YYYY年M月D日")) &
13809  |    End If                                        ||13802  |    End If                                        
13810  |    'A4印刷用に上2行を削除して、プレビュー範囲内に||13803  |    'A4印刷用に上2行を削除して、プレビュー範囲内に
13811  |    xlSheet.Rows("1:2").Delete Shift:=xlUp        ||13804  |    xlSheet.Rows("1:2").Delete Shift:=xlUp        
13812  |                                                  ||13805  |                                                  
13813  |'=================================================||13806  |'=================================================
13814  |'== 　　　　日次NAV/日時時価総額の別表作成エリア  ||13807  |'== 　　　　日次NAV/日時時価総額の別表作成エリア  
13815  |'=================================================||13808  |'=================================================
13816  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||13809  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
13817  |'    'NAV取得区分：日次NAV平均(休日有)または日次NA||13810  |'    'NAV取得区分：日次NAV平均(休日有)または日次NA
13818  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||13811  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
13819  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||13812  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
13820  |                                                  ||13813  |                                                  
13821  |    'NAV取得区分：日次NAV平均(休日有)、日次NAV平均||13814  |    'NAV取得区分：日次NAV平均(休日有)、日次NAV平均
13822  |    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag ||13815  |    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag 
13823  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||13816  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
13824  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||13817  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
13825  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||13818  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
13826  |                                                  ||13819  |                                                  
13827  |        gTotalDnavCnt = 0                         ||13820  |        gTotalDnavCnt = 0                         
13828  |        J = 0                                     ||13821  |        J = 0                                     
13829  |        K = 0                                     ||13822  |        K = 0                                     
13830  |        '＋２は合計行と平均行                     ||13823  |        '＋２は合計行と平均行                     
13831  |        dintPage = (dlngCnt + 2) \ 108            ||13824  |        dintPage = (dlngCnt + 2) \ 108            
13832  |        dintAmari = (dlngCnt + 2) Mod 108         ||13825  |        dintAmari = (dlngCnt + 2) Mod 108         
13833  |        If dintAmari <> 0 Then                    ||13826  |        If dintAmari <> 0 Then                    
13834  |            dintPage = dintPage + 1               ||13827  |            dintPage = dintPage + 1               
13835  |        End If                                    ||13828  |        End If                                    
13836  |                                                  ||13829  |                                                  
13837  |        For L = 1 To dintPage                     ||13830  |        For L = 1 To dintPage                     
13838  |                                                  ||13831  |                                                  
13839  |            xlBook.Worksheets.Add after:=xlBook.Sh||13832  |            xlBook.Worksheets.Add after:=xlBook.Sh
13840  |            gProcessCnt = gProcessCnt + 1         ||13833  |            gProcessCnt = gProcessCnt + 1         
13841  |            Set xlSheet = xlBook.Sheets(gProcessCn||13834  |            Set xlSheet = xlBook.Sheets(gProcessCn
13842  |                                                  ||13835  |                                                  
13843  |            'Excelフォーマットを調整              ||13836  |            'Excelフォーマットを調整              
13844  |            xlSheet.Cells.ColumnWidth = 1         ||13837  |            xlSheet.Cells.ColumnWidth = 1         
13845  |            xlSheet.Cells.Font.Size = 11          ||13838  |            xlSheet.Cells.Font.Size = 11          
13846 L|                                                  ||       |                                                  
13847  |            'シート名を設定(日次NAV一覧**)        ||13839  |            'シート名を設定(日次NAV一覧**)        
13848  |            'RAFI対応 START                       ||13840  |            'RAFI対応 START                       
13849  |            '純資産の場合                         ||13841  |            '純資産の場合                         
13850  |            If msAssetFlg = "0" Then              ||13842  |            If msAssetFlg = "0" Then              
13851  |                If dstrOldAccCode = sGetAccCode Th||13843  |                If dstrOldAccCode = sGetAccCode Th
13852  |                    gTotalDnavCnt = gTotalDnavCnt ||13844  |                    gTotalDnavCnt = gTotalDnavCnt 
13853  |                Else                              ||13845  |                Else                              
13854  |                    gTotalDnavCnt = 1             ||13846  |                    gTotalDnavCnt = 1             
13855  |                    dstrOldAccCode = sGetAccCode  ||13847  |                    dstrOldAccCode = sGetAccCode  
13856  |                End If                            ||13848  |                End If                            
13857  |            'マザー組入資産の場合                 ||13849  |            'マザー組入資産の場合                 
13858  |            Else                                  ||13850  |            Else                                  
13859  |                If dstrOldAccCode = msBabyAccountC||13851  |                If dstrOldAccCode = msBabyAccountC
13860  |                    gTotalDnavCnt = gTotalDnavCnt ||13852  |                    gTotalDnavCnt = gTotalDnavCnt 
13861  |                Else                              ||13853  |                Else                              
13862  |                    gTotalDnavCnt = 1             ||13854  |                    gTotalDnavCnt = 1             
13863  |                    dstrOldAccCode = msBabyAccount||13855  |                    dstrOldAccCode = msBabyAccount
13864  |                End If                            ||13856  |                End If                            
13865  |            End If                                ||13857  |            End If                                
13866  |            'RAFI対応 END                         ||13858  |            'RAFI対応 END                         
13867  |                                                  ||13859  |                                                  
13868  |            'gTotalCnt = gTotalCnt + 1            ||13860  |            'gTotalCnt = gTotalCnt + 1            
13869  |            'RAFI対応 START                       ||13861  |            'RAFI対応 START                       
13870  |            '純資産の場合                         ||13862  |            '純資産の場合                         
13871  |            If msAssetFlg = "0" Then              ||13863  |            If msAssetFlg = "0" Then              
13872  |                '複数ページの場合                 ||13864  |                '複数ページの場合                 
13873  |                If dintPage > 1 Then              ||13865  |                If dintPage > 1 Then              
13874  |                    xlBook.Sheets(gProcessCnt).Nam||13866  |                    xlBook.Sheets(gProcessCnt).Nam
13875  |                Else                              ||13867  |                Else                              
13876  |                    xlBook.Sheets(gProcessCnt).Nam||13868  |                    xlBook.Sheets(gProcessCnt).Nam
13877  |                End If                            ||13869  |                End If                            
13878  |            'マザー組入資産の場合                 ||13870  |            'マザー組入資産の場合                 
13879  |            Else                                  ||13871  |            Else                                  
13880  |                '複数ページの場合                 ||13872  |                '複数ページの場合                 
13881  |                If dintPage > 1 Then              ||13873  |                If dintPage > 1 Then              
13882  |                    xlBook.Sheets(gProcessCnt).Nam||13874  |                    xlBook.Sheets(gProcessCnt).Nam
13883  |                Else                              ||13875  |                Else                              
13884  |                    xlBook.Sheets(gProcessCnt).Nam||13876  |                    xlBook.Sheets(gProcessCnt).Nam
13885  |                End If                            ||13877  |                End If                            
13886  |            End If                                ||13878  |            End If                                
13887  |            'RAFI対応 END                         ||13879  |            'RAFI対応 END                         
13888  |            'シートの余白を設定                   ||13880  |            'シートの余白を設定                   
13889  |            xlSheet.PageSetup.TopMargin = Applicat||13881  |            xlSheet.PageSetup.TopMargin = Applicat
13890  |            xlSheet.PageSetup.BottomMargin = Appli||13882  |            xlSheet.PageSetup.BottomMargin = Appli
13891  |            xlSheet.PageSetup.LeftMargin = Applica||13883  |            xlSheet.PageSetup.LeftMargin = Applica
13892  |            xlSheet.PageSetup.RightMargin = Applic||13884  |            xlSheet.PageSetup.RightMargin = Applic
13893  |                                                  ||13885  |                                                  
13894  |            DoEvents                              ||13886  |            DoEvents                              
13895  |                                                  ||13887  |                                                  
13896  |            With xlSheet                          ||13888  |            With xlSheet                          
13897  |                '題目                             ||13889  |                '題目                             
13898  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||13890  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
13899  |                '取得NAV区分が4:日次時価総額平均の||13891  |                '取得NAV区分が4:日次時価総額平均の
13900  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||13892  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
13901  |                    .Cells(5, 1).Value = sWord63  ||13893  |                    .Cells(5, 1).Value = sWord63  
13902  |                Else                              ||13894  |                Else                              
13903  |                    .Cells(5, 1).Value = sWord47  ||13895  |                    .Cells(5, 1).Value = sWord47  
13904  |                End If                            ||13896  |                End If                            
13905  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||13897  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
13906  |                .Cells(5, 1).Font.Size = 14       ||13898  |                .Cells(5, 1).Font.Size = 14       
13907  |                .Range("A5:BG5").HorizontalAlignme||13899  |                .Range("A5:BG5").HorizontalAlignme
13908  |                '出力日付                         ||13900  |                '出力日付                         
13909  |                If RTrim(txtSysOutDate.Text) = "" ||13901  |                If RTrim(txtSysOutDate.Text) = "" 
13910  |                    .Cells(3, 50).Value = sWord34 ||13902  |                    .Cells(3, 50).Value = sWord34 
13911  |                    .Cells(3, 50).HorizontalAlignm||13903  |                    .Cells(3, 50).HorizontalAlignm
13912  |                Else                              ||13904  |                Else                              
13913  |                    .Cells(3, 43).Value = CStr(For||13905  |                    .Cells(3, 43).Value = CStr(For
13914  |                End If                            ||13906  |                End If                            
13915  |                'ファンド名                       ||13907  |                'ファンド名                       
13916  |                .Cells(6, 2).Value = sWord4       ||13908  |                .Cells(6, 2).Value = sWord4       
13917  |                .Cells(6, 11).Value = sWord19     ||13909  |                .Cells(6, 11).Value = sWord19     
13918  |                .Cells(6, 13).Value = gbuMGetUPDRe||13910  |                .Cells(6, 13).Value = gbuMGetUPDRe
13919  |                'ファンドコード                   ||13911  |                'ファンドコード                   
13920  |                .Cells(7, 2).Value = sWord4_2     ||13912  |                .Cells(7, 2).Value = sWord4_2     
13921  |                .Cells(7, 11).Value = sWord19     ||13913  |                .Cells(7, 11).Value = sWord19     
13922  |                .Cells(7, 13).NumberFormatLocal = ||13914  |                .Cells(7, 13).NumberFormatLocal = 
13923  |                'RAFI対応 START                   ||13915  |                'RAFI対応 START                   
13924  |                '純資産の場合                     ||13916  |                '純資産の場合                     
13925  |                If msAssetFlg = "0" Then          ||13917  |                If msAssetFlg = "0" Then          
13926  |                    .Cells(7, 13).Value = sGetAccC||13918  |                    .Cells(7, 13).Value = sGetAccC
13927  |                'マザー組入資産の場合             ||13919  |                'マザー組入資産の場合             
13928  |                Else                              ||13920  |                Else                              
13929  |                    .Cells(7, 13).Value = msBabyAc||13921  |                    .Cells(7, 13).Value = msBabyAc
13930  |                End If                            ||13922  |                End If                            
13931  |                'RAFI対応 END                     ||13923  |                'RAFI対応 END                     
13932  |                                                  ||13924  |                                                  
13933  |                '計算期間                         ||13925  |                '計算期間                         
13934  |                .Cells(8, 2).Value = sWord5       ||13926  |                .Cells(8, 2).Value = sWord5       
13935  |                .Cells(8, 11).Value = sWord19     ||13927  |                .Cells(8, 11).Value = sWord19     
13936  |                If Mid(gbuMGetUPDRec.N(lRecIdx).MG||13928  |                If Mid(gbuMGetUPDRec.N(lRecIdx).MG
13937  |                And gbuMGetUPDRec.N(lRecIdx).MGET_||13929  |                And gbuMGetUPDRec.N(lRecIdx).MGET_
13938  |                    .Cells(8, 13).Value = _       ||13930  |                    .Cells(8, 13).Value = _       
13939  |                        CStr(Format(dStart, "YYYY ||13931  |                        CStr(Format(dStart, "YYYY 
13940  |                Else                              ||13932  |                Else                              
13941  |                    .Cells(8, 13).Value = _       ||13933  |                    .Cells(8, 13).Value = _       
13942  |                        CStr(Format(dStart, "YYYY ||13934  |                        CStr(Format(dStart, "YYYY 
13943  |                End If                            ||13935  |                End If                            
13944  |                '日付                             ||13936  |                '日付                             
13945  |                .Cells(10, 3).Value = sWord7      ||13937  |                .Cells(10, 3).Value = sWord7      
13946  |                .Range("C10:N10").HorizontalAlignm||13938  |                .Range("C10:N10").HorizontalAlignm
13947  |                '純資産                           ||13939  |                '純資産                           
13948  |                .Cells(10, 15).Value = sWord8     ||13940  |                .Cells(10, 15).Value = sWord8     
13949  |                .Range("O10:AC10").HorizontalAlign||13941  |                .Range("O10:AC10").HorizontalAlign
13950  |                '日付                             ||13942  |                '日付                             
13951  |                .Cells(10, 31).Value = sWord7     ||13943  |                .Cells(10, 31).Value = sWord7     
13952  |                .Range("AE10:AP10").HorizontalAlig||13944  |                .Range("AE10:AP10").HorizontalAlig
13953  |                '純資産                           ||13945  |                '純資産                           
13954  |                .Cells(10, 43).Value = sWord8     ||13946  |                .Cells(10, 43).Value = sWord8     
13955  |                .Range("AQ10:BE10").HorizontalAlig||13947  |                .Range("AQ10:BE10").HorizontalAlig
13956  |                '日付＆NAV                        ||13948  |                '日付＆NAV                        
13957  |                Select Case L                     ||13949  |                Select Case L                     
13958  |                    Case 1                        ||13950  |                    Case 1                        
13959  |                        dintPageIni = 1           ||13951  |                        dintPageIni = 1           
13960  |                    Case Else                     ||13952  |                    Case Else                     
13961  |                        dintPageIni = dintPageIni ||13953  |                        dintPageIni = dintPageIni 
13962  |                End Select                        ||13954  |                End Select                        
13963  |                For dintFor = dintPageIni To dlngC||13955  |                For dintFor = dintPageIni To dlngC
13964  |                    If J < 54 Then                ||13956  |                    If J < 54 Then                
13965  |                        If dintFor = dlngCnt + 1 T||13957  |                        If dintFor = dlngCnt + 1 T
13966  |                            '合計                 ||13958  |                            '合計                 
13967  |                            .Cells(11 + J, 3).Valu||13959  |                            .Cells(11 + J, 3).Valu
13968  |                            'NAV                  ||13960  |                            'NAV                  
13969  |                            .Cells(11 + J, 28).Num||13961  |                            .Cells(11 + J, 28).Num
13970  |                            If gbuMGetUPDRec.N(lRe||13962  |                            If gbuMGetUPDRec.N(lRe
13971  |                                .Cells(11 + J, 28)||13963  |                                .Cells(11 + J, 28)
13972  |                            Else                  ||13964  |                            Else                  
13973  |                                .Cells(11 + J, 28)||13965  |                                .Cells(11 + J, 28)
13974  |                            End If                ||13966  |                            End If                
13975  |                            .Cells(11 + J, 28).Hor||13967  |                            .Cells(11 + J, 28).Hor
13976  |                        End If                    ||13968  |                        End If                    
13977  |                        If dintFor = dlngCnt + 2 T||13969  |                        If dintFor = dlngCnt + 2 T
13978  |                            '平均                 ||13970  |                            '平均                 
13979  |                            .Cells(11 + J, 3).Valu||13971  |                            .Cells(11 + J, 3).Valu
13980  |                            'NAV                  ||13972  |                            'NAV                  
13981  |                            .Cells(11 + J, 28).Num||13973  |                            .Cells(11 + J, 28).Num
13982  |                            If gbuMGetUPDRec.N(lRe||13974  |                            If gbuMGetUPDRec.N(lRe
13983  |                                .Cells(11 + J, 28)||13975  |                                .Cells(11 + J, 28)
13984  |                            Else                  ||13976  |                            Else                  
13985  |                                .Cells(11 + J, 28)||13977  |                                .Cells(11 + J, 28)
13986  |                            End If                ||13978  |                            End If                
13987  |                            .Cells(11 + J, 28).Hor||13979  |                            .Cells(11 + J, 28).Hor
13988  |                        End If                    ||13980  |                        End If                    
13989  |                        If dintFor < dlngCnt + 1 T||13981  |                        If dintFor < dlngCnt + 1 T
13990  |                            '日付                 ||13982  |                            '日付                 
13991  |                            dCalDate = CDate(gstrD||13983  |                            dCalDate = CDate(gstrD
13992  |                            .Cells(11 + J, 4).Valu||13984  |                            .Cells(11 + J, 4).Valu
13993  |                                CStr(Format(dCalDa||13985  |                                CStr(Format(dCalDa
13994  |                            'NAV                  ||13986  |                            'NAV                  
13995  |                            .Cells(11 + J, 28).Num||13987  |                            .Cells(11 + J, 28).Num
13996  |                            If gbuMGetUPDRec.N(lRe||13988  |                            If gbuMGetUPDRec.N(lRe
13997  |                                .Cells(11 + J, 28)||13989  |                                .Cells(11 + J, 28)
13998  |                            Else                  ||13990  |                            Else                  
13999  |                                .Cells(11 + J, 28)||13991  |                                .Cells(11 + J, 28)
14000  |                            End If                ||13992  |                            End If                
14001  |                            .Cells(11 + J, 28).Hor||13993  |                            .Cells(11 + J, 28).Hor
14002  |                        End If                    ||13994  |                        End If                    
14003  |                    Else                          ||13995  |                    Else                          
14004  |                        If dintFor = dlngCnt + 1 T||13996  |                        If dintFor = dlngCnt + 1 T
14005  |                            '合計                 ||13997  |                            '合計                 
14006  |                            .Cells(11 + K, 31).Val||13998  |                            .Cells(11 + K, 31).Val
14007  |                            'NAV                  ||13999  |                            'NAV                  
14008  |                            .Cells(11 + K, 56).Num||14000  |                            .Cells(11 + K, 56).Num
14009  |                            If gbuMGetUPDRec.N(lRe||14001  |                            If gbuMGetUPDRec.N(lRe
14010  |                                .Cells(11 + K, 56)||14002  |                                .Cells(11 + K, 56)
14011  |                            Else                  ||14003  |                            Else                  
14012  |                                .Cells(11 + K, 56)||14004  |                                .Cells(11 + K, 56)
14013  |                            End If                ||14005  |                            End If                
14014  |                            .Cells(11 + K, 56).Hor||14006  |                            .Cells(11 + K, 56).Hor
14015  |                        End If                    ||14007  |                        End If                    
14016  |                        If dintFor = dlngCnt + 2 T||14008  |                        If dintFor = dlngCnt + 2 T
14017  |                            '平均                 ||14009  |                            '平均                 
14018  |                            .Cells(11 + K, 31).Val||14010  |                            .Cells(11 + K, 31).Val
14019  |                            'NAV                  ||14011  |                            'NAV                  
14020  |                            .Cells(11 + K, 56).Num||14012  |                            .Cells(11 + K, 56).Num
14021  |                            If gbuMGetUPDRec.N(lRe||14013  |                            If gbuMGetUPDRec.N(lRe
14022  |                                .Cells(11 + K, 56)||14014  |                                .Cells(11 + K, 56)
14023  |                            Else                  ||14015  |                            Else                  
14024  |                                .Cells(11 + K, 56)||14016  |                                .Cells(11 + K, 56)
14025  |                            End If                ||14017  |                            End If                
14026  |                            .Cells(11 + K, 56).Hor||14018  |                            .Cells(11 + K, 56).Hor
14027  |                        End If                    ||14019  |                        End If                    
14028  |                        If dintFor < dlngCnt + 1 T||14020  |                        If dintFor < dlngCnt + 1 T
14029  |                            '日付                 ||14021  |                            '日付                 
14030  |                            dCalDate = CDate(gstrD||14022  |                            dCalDate = CDate(gstrD
14031  |                            .Cells(11 + K, 32).Val||14023  |                            .Cells(11 + K, 32).Val
14032  |                                CStr(Format(dCalDa||14024  |                                CStr(Format(dCalDa
14033  |                            'NAV                  ||14025  |                            'NAV                  
14034  |                            .Cells(11 + K, 56).Num||14026  |                            .Cells(11 + K, 56).Num
14035  |                            If gbuMGetUPDRec.N(lRe||14027  |                            If gbuMGetUPDRec.N(lRe
14036  |                                .Cells(11 + K, 56)||14028  |                                .Cells(11 + K, 56)
14037  |                            Else                  ||14029  |                            Else                  
14038  |                                .Cells(11 + K, 56)||14030  |                                .Cells(11 + K, 56)
14039  |                            End If                ||14031  |                            End If                
14040  |                            .Cells(11 + K, 56).Hor||14032  |                            .Cells(11 + K, 56).Hor
14041  |                        End If                    ||14033  |                        End If                    
14042  |                        K = K + 1                 ||14034  |                        K = K + 1                 
14043  |                        If K > 53 Then            ||14035  |                        If K > 53 Then            
14044  |                            J = 0                 ||14036  |                            J = 0                 
14045  |                            K = 0                 ||14037  |                            K = 0                 
14046  |                            Exit For              ||14038  |                            Exit For              
14047  |                        End If                    ||14039  |                        End If                    
14048  |                    End If                        ||14040  |                    End If                        
14049  |                    J = J + 1                     ||14041  |                    J = J + 1                     
14050  |                Next dintFor                      ||14042  |                Next dintFor                      
14051  |                                                  ||14043  |                                                  
14052  |                '左側日付                         ||14044  |                '左側日付                         
14053  |                With xlSheet.Range("C10:N64").Bord||14045  |                With xlSheet.Range("C10:N64").Bord
14054  |                    .LineStyle = xlContinuous     ||14046  |                    .LineStyle = xlContinuous     
14055  |                    .Weight = xlThin              ||14047  |                    .Weight = xlThin              
14056  |                End With                          ||14048  |                End With                          
14057  |                With xlSheet.Range("C10:N64").Bord||14049  |                With xlSheet.Range("C10:N64").Bord
14058  |                    .LineStyle = xlContinuous     ||14050  |                    .LineStyle = xlContinuous     
14059  |                    .Weight = xlThin              ||14051  |                    .Weight = xlThin              
14060  |                End With                          ||14052  |                End With                          
14061  |                With xlSheet.Range("C10:N64").Bord||14053  |                With xlSheet.Range("C10:N64").Bord
14062  |                    .LineStyle = xlContinuous     ||14054  |                    .LineStyle = xlContinuous     
14063  |                    .Weight = xlThin              ||14055  |                    .Weight = xlThin              
14064  |                End With                          ||14056  |                End With                          
14065  |                With xlSheet.Range("C10:N64").Bord||14057  |                With xlSheet.Range("C10:N64").Bord
14066  |                    .LineStyle = xlContinuous     ||14058  |                    .LineStyle = xlContinuous     
14067  |                    .Weight = xlThin              ||14059  |                    .Weight = xlThin              
14068  |                End With                          ||14060  |                End With                          
14069  |                With xlSheet.Range("C10:N64").Bord||14061  |                With xlSheet.Range("C10:N64").Bord
14070  |                    .LineStyle = xlContinuous     ||14062  |                    .LineStyle = xlContinuous     
14071  |                    .Weight = xlThin              ||14063  |                    .Weight = xlThin              
14072  |                End With                          ||14064  |                End With                          
14073  |                                                  ||14065  |                                                  
14074  |                '左側純資産                       ||14066  |                '左側純資産                       
14075  |                With xlSheet.Range("O10:AC64").Bor||14067  |                With xlSheet.Range("O10:AC64").Bor
14076  |                    .LineStyle = xlContinuous     ||14068  |                    .LineStyle = xlContinuous     
14077  |                    .Weight = xlThin              ||14069  |                    .Weight = xlThin              
14078  |                End With                          ||14070  |                End With                          
14079  |                With xlSheet.Range("O10:AC64").Bor||14071  |                With xlSheet.Range("O10:AC64").Bor
14080  |                    .LineStyle = xlContinuous     ||14072  |                    .LineStyle = xlContinuous     
14081  |                    .Weight = xlThin              ||14073  |                    .Weight = xlThin              
14082  |                End With                          ||14074  |                End With                          
14083  |                With xlSheet.Range("O10:AC64").Bor||14075  |                With xlSheet.Range("O10:AC64").Bor
14084  |                    .LineStyle = xlContinuous     ||14076  |                    .LineStyle = xlContinuous     
14085  |                    .Weight = xlThin              ||14077  |                    .Weight = xlThin              
14086  |                End With                          ||14078  |                End With                          
14087  |                With xlSheet.Range("O10:AC64").Bor||14079  |                With xlSheet.Range("O10:AC64").Bor
14088  |                    .LineStyle = xlContinuous     ||14080  |                    .LineStyle = xlContinuous     
14089  |                    .Weight = xlThin              ||14081  |                    .Weight = xlThin              
14090  |                End With                          ||14082  |                End With                          
14091  |                With xlSheet.Range("O10:AC64").Bor||14083  |                With xlSheet.Range("O10:AC64").Bor
14092  |                    .LineStyle = xlContinuous     ||14084  |                    .LineStyle = xlContinuous     
14093  |                    .Weight = xlThin              ||14085  |                    .Weight = xlThin              
14094  |                End With                          ||14086  |                End With                          
14095  |                                                  ||14087  |                                                  
14096  |                '右側日付                         ||14088  |                '右側日付                         
14097  |                With xlSheet.Range("AE10:AP64").Bo||14089  |                With xlSheet.Range("AE10:AP64").Bo
14098  |                    .LineStyle = xlContinuous     ||14090  |                    .LineStyle = xlContinuous     
14099  |                    .Weight = xlThin              ||14091  |                    .Weight = xlThin              
14100  |                End With                          ||14092  |                End With                          
14101  |                With xlSheet.Range("AE10:AP64").Bo||14093  |                With xlSheet.Range("AE10:AP64").Bo
14102  |                    .LineStyle = xlContinuous     ||14094  |                    .LineStyle = xlContinuous     
14103  |                    .Weight = xlThin              ||14095  |                    .Weight = xlThin              
14104  |                End With                          ||14096  |                End With                          
14105  |                With xlSheet.Range("AE10:AP64").Bo||14097  |                With xlSheet.Range("AE10:AP64").Bo
14106  |                    .LineStyle = xlContinuous     ||14098  |                    .LineStyle = xlContinuous     
14107  |                    .Weight = xlThin              ||14099  |                    .Weight = xlThin              
14108  |                End With                          ||14100  |                End With                          
14109  |                With xlSheet.Range("AE10:AP64").Bo||14101  |                With xlSheet.Range("AE10:AP64").Bo
14110  |                    .LineStyle = xlContinuous     ||14102  |                    .LineStyle = xlContinuous     
14111  |                    .Weight = xlThin              ||14103  |                    .Weight = xlThin              
14112  |                End With                          ||14104  |                End With                          
14113  |                With xlSheet.Range("AE10:AP64").Bo||14105  |                With xlSheet.Range("AE10:AP64").Bo
14114  |                    .LineStyle = xlContinuous     ||14106  |                    .LineStyle = xlContinuous     
14115  |                    .Weight = xlThin              ||14107  |                    .Weight = xlThin              
14116  |                End With                          ||14108  |                End With                          
14117  |                                                  ||14109  |                                                  
14118  |                '右側純資産                       ||14110  |                '右側純資産                       
14119  |                With xlSheet.Range("AQ10:BE64").Bo||14111  |                With xlSheet.Range("AQ10:BE64").Bo
14120  |                    .LineStyle = xlContinuous     ||14112  |                    .LineStyle = xlContinuous     
14121  |                    .Weight = xlThin              ||14113  |                    .Weight = xlThin              
14122  |                End With                          ||14114  |                End With                          
14123  |                With xlSheet.Range("AQ10:BE64").Bo||14115  |                With xlSheet.Range("AQ10:BE64").Bo
14124  |                    .LineStyle = xlContinuous     ||14116  |                    .LineStyle = xlContinuous     
14125  |                    .Weight = xlThin              ||14117  |                    .Weight = xlThin              
14126  |                End With                          ||14118  |                End With                          
14127  |                With xlSheet.Range("AQ10:BE64").Bo||14119  |                With xlSheet.Range("AQ10:BE64").Bo
14128  |                    .LineStyle = xlContinuous     ||14120  |                    .LineStyle = xlContinuous     
14129  |                    .Weight = xlThin              ||14121  |                    .Weight = xlThin              
14130  |                End With                          ||14122  |                End With                          
14131  |                With xlSheet.Range("AQ10:BE64").Bo||14123  |                With xlSheet.Range("AQ10:BE64").Bo
14132  |                    .LineStyle = xlContinuous     ||14124  |                    .LineStyle = xlContinuous     
14133  |                    .Weight = xlThin              ||14125  |                    .Weight = xlThin              
14134  |                End With                          ||14126  |                End With                          
14135  |                With xlSheet.Range("AQ10:BE64").Bo||14127  |                With xlSheet.Range("AQ10:BE64").Bo
14136  |                    .LineStyle = xlContinuous     ||14128  |                    .LineStyle = xlContinuous     
14137  |                    .Weight = xlThin              ||14129  |                    .Weight = xlThin              
14138  |                End With                          ||14130  |                End With                          
14139  |                                                  ||14131  |                                                  
14140  |            End With                              ||14132  |            End With                              
14141  |            'A4印刷用に上2行を削除して、プレビュー||14133  |            'A4印刷用に上2行を削除して、プレビュー
14142  |            xlSheet.Rows("1:2").Delete Shift:=xlUp||14134  |            xlSheet.Rows("1:2").Delete Shift:=xlUp
14143  |        Next L                                    ||14135  |        Next L                                    
14144  |    End If                                        ||14136  |    End If                                        
14145  |    'セル(A1)を選択する                           ||14137  |    'セル(A1)を選択する                           
14146  |                                                  ||14138  |                                                  
14147  |                                                  ||14139  |                                                  
14148  |                                                  ||14140  |                                                  
14149  |                                                  ||14141  |                                                  
14150  |'2006/04/12 START K.Furuya 実払管理テーブル更新対 ||14142  |'2006/04/12 START K.Furuya 実払管理テーブル更新対 
14151  |    '実払管理テーブル更新処理実行                 ||14143  |    '実払管理テーブル更新処理実行                 
14152  |'2008/03/26 START ファンド決算期間での外部委託顧問||14144  |'2008/03/26 START ファンド決算期間での外部委託顧問
14153  |    'ファンド決算期間計算の場合実払いテーブル更新 ||14145  |    'ファンド決算期間計算の場合実払いテーブル更新 
14154  |    If gbuMGetUPDRec.N(lRecIdx).MGET_other_real_fl||14146  |    If gbuMGetUPDRec.N(lRecIdx).MGET_other_real_fl
14155  |        If fncOtherRealComUpdateInsert(WkContractN||14147  |        If fncOtherRealComUpdateInsert(WkContractN
14156  |                WkFixComC, WkFixComJ, WkRealComC, ||14148  |                WkFixComC, WkFixComJ, WkRealComC, 
14157  |            intRtn = MsgBox("契約番号：" & WkContr||14149  |            intRtn = MsgBox("契約番号：" & WkContr
14158  |                        "の確定額の更新に失敗しま ||14150  |                        "の確定額の更新に失敗しま 
14159  |        End If                                    ||14151  |        End If                                    
14160  |    End If                                        ||14152  |    End If                                        
14161  |'2008/03/26 END   ファンド決算期間での外部委託顧問||14153  |'2008/03/26 END   ファンド決算期間での外部委託顧問
14162  |'2006/04/12 END   K.Furuya 実払管理テーブル更新対 ||14154  |'2006/04/12 END   K.Furuya 実払管理テーブル更新対 
14163  |                                                  ||14155  |                                                  
14164  |'2014/02/19 START M.Takada 【管理会計】消費税率変 ||14156  |'2014/02/19 START M.Takada 【管理会計】消費税率変 
14165 L|  '消費税率変更がある場合、｢消費税額内訳書｣を出力 ||14157 R|  '消費税率変更がある場合、{消費税額内訳書｣を出力 
14166  |  '消費税額の分割算出用フラグで出力判定を実施(Fals||14158  |  '消費税額の分割算出用フラグで出力判定を実施(Fals
14167  |    If Tax_Flg = True Then                        ||14159  |    If Tax_Flg = True Then                        
14168  |                                                  ||14160  |                                                  
14169  |        '計算期間が消費税変更適用日を跨ぐ場合、消 ||14161  |        '計算期間が消費税変更適用日を跨ぐ場合、消 
14170  |        xlBook.Worksheets.Add after:=xlBook.Sheets||14162  |        xlBook.Worksheets.Add after:=xlBook.Sheets
14171 L|        gProcessCnt = gProcessCnt + 1             ||14163 R|        'Excelフォーマットを調整                  
14172 L|        Set xlSheet = xlBook.Sheets(gProcessCnt)  ||14164 R|        ActiveSheet.Cells.ColumnWidth = 1         
14173 L|                                                  ||14165 R|        ActiveSheet.Cells.Font.Size = 11          
14174 L|        'シート名を設定(内訳書**)                 ||14166 R|                                                  
14175 L|        '契約毎のシート番号を付番する             ||14167 R|    With xlSheet                                  
14176 L|        xlBook.Sheets(gProcessCnt).Name = sWord72 ||14168 R|        '作成日                                   
       |                                                  ||14169 R|        If RTrim(txtSysOutDate.Text) = "" Then    
       |                                                  ||14170 R|            .Cells(3, 50).Value = sWord34         
       |                                                  ||14171 R|            .Cells(3, 50).HorizontalAlignment = xl
       |                                                  ||14172 R|        Else                                      
       |                                                  ||14173 R|            .Cells(3, 43).Value = CStr(Format(txtS
25499 M|        End If                                    ||14174 R|        End If                                    
       |                                                  ||14175 R|        'タイトル                                 
       |                                                  ||14176 R|        .Cells(5, 1).Value = sWord0d              
       |                                                  ||14177 R|        .Range("A5:BG5").HorizontalAlignment = xlC
       |                                                  ||14178 R|        '財務部　担当者                           
       |                                                  ||14179 R|        sName = RTrim(txtInputName.Text)          
       |                                                  ||14180 R|        '財務部                                   
       |                                                  ||14181 R|        .Cells(7, 37).Value = sWord1              
       |                                                  ||14182 R|        .Cells(8, 39).Value = sWord2 & sName      
       |                                                  ||14183 R|                                                  
       |                                                  ||14184 R|        '下記のとおり･･･ ,文言                    
       |                                                  ||14185 R|        .Cells(10, 2).Value = sWordComment        
       |                                                  ||14186 R|                                                  
       |                                                  ||14187 R|        'ファンド名: ,文言                        
       |                                                  ||14188 R|        .Cells(12, 2).Value = sWord4              
       |                                                  ||14189 R|        .Cells(12, 11).Value = sWord19            
       |                                                  ||14190 R|        .Cells(12, 13).Value = gbuMGetUPDRec.N(lRe
       |                                                  ||14191 R|                                                  
       |                                                  ||14192 R|        'ファンドコード: ,文言                    
       |                                                  ||14193 R|        .Cells(13, 2).Value = sWord4_2            
       |                                                  ||14194 R|        .Cells(13, 11).Value = sWord19            
       |                                                  ||14195 R|        If msAssetFlg = "0" Then                  
       |                                                  ||14196 R|            .Cells(13, 13).Value = sGetAccCode    
       |                                                  ||14197 R|        'マザー組入資産の場合                     
       |                                                  ||14198 R|        Else                                      
       |                                                  ||14199 R|            .Cells(13, 13).Value = msBabyAccountCo
       |                                                  ||14200 R|        End If                                    
       |                                                  ||14201 R|                                                  
       |                                                  ||14202 R|        '計算期間: ,文言                          
       |                                                  ||14203 R|        .Cells(15, 2).Value = sWord5              
       |                                                  ||14204 R|        .Cells(15, 11).Value = sWord19            
       |                                                  ||14205 R|        .Cells(15, 13).Value = _                  
       |                                                  ||14206 R|        CStr(Format(dStart, "YYYY年M月D日")) & sWo
       |                                                  ||14207 R|                                                  
       |                                                  ||14208 R|        '投資顧問料                               
       |                                                  ||14209 R|        .Cells(17, 2).Value = sWord11a            
       |                                                  ||14210 R|        .Cells(17, 11).Value = sWord19            
       |                                                  ||14211 R|        .Cells(17, 29).NumberFormatLocal = "@"    
       |                                                  ||14212 R|        .Cells(17, 29).Value = CStr(Format(mstrMon
       |                                                  ||14213 R|        .Cells(17, 29).HorizontalAlignment = xlRig
       |                                                  ||14214 R|        .Cells(17, 32).Value = sYen               
       |                                                  ||14215 R|                                                  
       |                                                  ||14216 R|                                                  
       |                                                  ||14217 R|        '(適用前)消費税率                         
       |                                                  ||14218 R|        .Cells(21, 2).Value = sWord66             
       |                                                  ||14219 R|        .Cells(21, 11).Value = sWord19            
       |                                                  ||14220 R|        .Cells(21, 13).Value = strTaxRate(2) & sWo
       |                                                  ||14221 R|                                                  
       |                                                  ||14222 R|        '(適用前)税率適用期間                     
       |                                                  ||14223 R|        .Cells(22, 2).Value = sWord67             
       |                                                  ||14224 R|        .Cells(22, 11).Value = sWord19            
       |                                                  ||14225 R|        .Cells(22, 13).Value = _                  
       |                                                  ||14226 R|        CStr(Format(dStart, "YYYY年M月D日")) & sWo
       |                                                  ||14227 R|                                                  
       |                                                  ||14228 R|        '(適用前)支払額                           
       |                                                  ||14229 R|        .Cells(23, 2).Value = sWord68             
       |                                                  ||14230 R|        .Cells(23, 11).Value = sWord19            
       |                                                  ||14231 R|        .Cells(23, 29).NumberFormatLocal = "@"    
       |                                                  ||14232 R|        .Cells(23, 29).Value = CStr(Format(strPayN
       |                                                  ||14233 R|        .Cells(23, 29).HorizontalAlignment = xlRig
       |                                                  ||14234 R|        .Cells(23, 32).Value = sYen               
       |                                                  ||14235 R|                                                  
       |                                                  ||14236 R|        '(適用前)消費税額                         
       |                                                  ||14237 R|        .Cells(24, 2).Value = sWord69             
       |                                                  ||14238 R|        .Cells(24, 11).Value = sWord19            
       |                                                  ||14239 R|        .Cells(24, 29).NumberFormatLocal = "@"    
       |                                                  ||14240 R|        .Cells(24, 29).Value = CStr(Format(strTaxN
       |                                                  ||14241 R|        .Cells(24, 29).HorizontalAlignment = xlRig
       |                                                  ||14242 R|        .Cells(24, 32).Value = sYen               
       |                                                  ||14243 R|                                                  
       |                                                  ||14244 R|                                                  
       |                                                  ||14245 R|        '(適用後)消費税率                         
       |                                                  ||14246 R|        .Cells(28, 2).Value = sWord66             
       |                                                  ||14247 R|        .Cells(28, 11).Value = sWord19            
       |                                                  ||14248 R|        .Cells(28, 13).Value = strTaxRate(1) & sWo
       |                                                  ||14249 R|                                                  
       |                                                  ||14250 R|        '(適用後)税率適用期間                     
       |                                                  ||14251 R|        .Cells(29, 2).Value = sWord67             
       |                                                  ||14252 R|        .Cells(29, 11).Value = sWord19            
       |                                                  ||14253 R|        .Cells(29, 13).Value = _                  
       |                                                  ||14254 R|        CStr(Format(strUse_Date, "YYYY年M月D日")) 
       |                                                  ||14255 R|                                                  
       |                                                  ||14256 R|        '(適用後)支払額                           
       |                                                  ||14257 R|        .Cells(30, 2).Value = sWord68             
       |                                                  ||14258 R|        .Cells(30, 11).Value = sWord19            
       |                                                  ||14259 R|        .Cells(30, 29).NumberFormatLocal = "@"    
       |                                                  ||14260 R|        .Cells(30, 29).Value = CStr(Format(strPayN
       |                                                  ||14261 R|        .Cells(30, 29).HorizontalAlignment = xlRig
       |                                                  ||14262 R|        .Cells(30, 32).Value = sYen               
       |                                                  ||14263 R|                                                  
       |                                                  ||14264 R|        '(適用後)消費税額                         
       |                                                  ||14265 R|        .Cells(31, 2).Value = sWord69             
       |                                                  ||14266 R|        .Cells(31, 11).Value = sWord19            
       |                                                  ||14267 R|        .Cells(31, 29).NumberFormatLocal = "@"    
       |                                                  ||14268 R|        .Cells(31, 29).Value = CStr(Format(strTaxN
       |                                                  ||14269 R|        .Cells(31, 29).HorizontalAlignment = xlRig
       |                                                  ||14270 R|        .Cells(31, 32).Value = sYen               
14190 M|                                                  ||14271 R|                                                  
14177  |                                                  ||14272  |                                                  
14178 L|        'Excelフォーマットを調整                  ||       |                                                  
14179 L|        xlSheet.Cells.ColumnWidth = 1             ||       |                                                  
14180 L|        xlSheet.Cells.Font.Size = 11              ||       |                                                  
14181 L|        xlSheet.PageSetup.TopMargin = Application.||       |                                                  
14182 L|        xlSheet.PageSetup.BottomMargin = Applicati||       |                                                  
14183 L|        xlSheet.PageSetup.LeftMargin = Application||       |                                                  
14184 L|        xlSheet.PageSetup.RightMargin = Applicatio||       |                                                  
14185 L|                                                  ||       |                                                  
14186 L|'        '総計の出力処理カウンターアップ          ||       |                                                  
14187 L|'        gTotalProcessCnt = gTotalProcessCnt + 1  ||       |                                                  
14188 L|                                                  ||       |                                                  
14189 L|'        DoEvents                                 ||       |                                                  
14190 L|                                                  ||14271 M|                                                  
14191 L|        With xlSheet                              ||14273 R|        '合計                                     
14192 L|            '作成日                               ||14274 R|        .Cells(35, 2).Value = sWord70             
14193 L|            If RTrim(txtSysOutDate.Text) = "" Then||14275 R|                                                  
14194 L|                .Cells(3, 50).Value = sWord34     ||14276 R|        '支払額                                   
14195 L|                .Cells(3, 50).HorizontalAlignment ||14277 R|        .Cells(36, 2).Value = sWord68             
       |                                                  ||14278 R|        .Cells(36, 11).Value = sWord19            
       |                                                  ||14279 R|        .Cells(36, 29).NumberFormatLocal = "@"    
       |                                                  ||14280 R|        .Cells(36, 29).Value = CStr(Format(.Cells(
       |                                                  ||14281 R|        .Cells(36, 29).HorizontalAlignment = xlRig
       |                                                  ||14282 R|        .Cells(36, 32).Value = sYen               
       |                                                  ||14283 R|                                                  
       |                                                  ||14284 R|        '消費税額                                 
       |                                                  ||14285 R|        .Cells(37, 2).Value = sWord69             
       |                                                  ||14286 R|        .Cells(37, 11).Value = sWord19            
       |                                                  ||14287 R|        .Cells(37, 29).NumberFormatLocal = "@"    
       |                                                  ||14288 R|        .Cells(37, 29).Value = CStr(Format(.Cells(
       |                                                  ||14289 R|        .Cells(37, 29).HorizontalAlignment = xlRig
       |                                                  ||14290 R|        .Cells(37, 32).Value = sYen               
       |                                                  ||14291 R|                                                  
       |                                                  ||14292 R|        '合計額                                   
       |                                                  ||14293 R|        .Cells(37, 13).Value = sWord24            
       |                                                  ||14294 R|        .Cells(37, 29).NumberFormatLocal = "@"    
       |                                                  ||14295 R|        .Cells(37, 29).Value = CStr(Format(.Cells(
       |                                                  ||14296 R|        .Cells(37, 29).HorizontalAlignment = xlRig
       |                                                  ||14297 R|        .Cells(37, 32).Value = sYen               
       |                                                  ||14298 R|                                                  
       |                                                  ||14299 R|                                                  
14196 L|            Else                                  ||25530 M|            Else                                  
14197 L|                .Cells(3, 43).Value = CStr(Format(||       |                                                  
14198 L|            End If                                ||       |                                                  
14199 L|            'タイトル                             ||       |                                                  
14200 L|            .Cells(5, 1).Value = sWordTitle       ||       |                                                  
14201 L|            .Range("A5:BG5").HorizontalAlignment =||       |                                                  
14202 L|            '財務部　担当者                       ||       |                                                  
14203 L|            sName = RTrim(txtInputName.Text)      ||       |                                                  
14204 L|            '財務部                               ||       |                                                  
14205 L|            .Cells(7, 37).Value = sWord1          ||       |                                                  
14206 L|            .Cells(8, 39).Value = sWord2 & sName  ||       |                                                  
14207 L|                                                  ||       |                                                  
14208 L|            '下記のとおり･･･ ,文言                ||       |                                                  
14209 L|            .Cells(10, 2).Value = sWordComment    ||       |                                                  
14210 L|                                                  ||       |                                                  
14211 L|            'ファンド名: ,文言                    ||       |                                                  
14212 L|            .Cells(12, 2).Value = sWord4          ||       |                                                  
14213 L|            .Cells(12, 11).Value = sWord19        ||       |                                                  
14214 L|            .Cells(12, 13).Value = gbuMGetUPDRec.N||       |                                                  
14215 L|                                                  ||       |                                                  
14216 L|            'ファンドコード: ,文言                ||       |                                                  
14217 L|            .Cells(13, 2).Value = sWord4_2        ||       |                                                  
14218 L|            .Cells(13, 11).Value = sWord19        ||       |                                                  
14219 L|            .Cells(13, 13).NumberFormatLocal = "@"||       |                                                  
14220 L|            If msAssetFlg = "0" Then              ||       |                                                  
14221 L|                .Cells(13, 13).Value = sGetAccCode||       |                                                  
14222 L|            'マザー組入資産の場合                 ||       |                                                  
14223 L|            Else                                  ||       |                                                  
14224 L|                .Cells(13, 13).Value = msBabyAccou||       |                                                  
14225 L|            End If                                ||       |                                                  
14226 L|                                                  ||       |                                                  
14227 L|            '計算期間: ,文言                      ||       |                                                  
14228 L|            .Cells(15, 2).Value = sWord5          ||       |                                                  
14229 L|            .Cells(15, 11).Value = sWord19        ||       |                                                  
14230 L|            .Cells(15, 13).Value = _              ||       |                                                  
14231 L|            CStr(Format(dStart, "YYYY年M月D日")) &||       |                                                  
14232 L|                                                  ||       |                                                  
14233 L|            '投資顧問料                           ||       |                                                  
14234 L|            .Cells(17, 2).Value = sWord11a        ||       |                                                  
14235 L|            .Cells(17, 11).Value = sWord19        ||       |                                                  
14236 L|            .Cells(17, 29).NumberFormatLocal = "@"||       |                                                  
14237 L|            .Cells(17, 29).Value = CStr(Format(mst||       |                                                  
14238 L|            .Cells(17, 29).HorizontalAlignment = x||       |                                                  
14239 L|            .Cells(17, 32).Value = sYen           ||       |                                                  
14240 L|                                                  ||       |                                                  
14241 L|                                                  ||       |                                                  
14242 L|            '(適用前)消費税率                     ||       |                                                  
14243 L|            .Cells(21, 2).Value = sWord66         ||       |                                                  
14244 L|            .Cells(21, 11).Value = sWord19        ||       |                                                  
14245 L|            .Cells(21, 13).Value = strTaxRate(2) &||       |                                                  
14246 L|                                                  ||       |                                                  
14247 L|            '(適用前)税率適用期間                 ||       |                                                  
14248 L|            .Cells(22, 2).Value = sWord67         ||       |                                                  
14249 L|            .Cells(22, 11).Value = sWord19        ||       |                                                  
14250 L|            .Cells(22, 13).Value = _              ||       |                                                  
14251 L|            CStr(Format(dStart, "YYYY年M月D日")) &||       |                                                  
14252 L|                                                  ||       |                                                  
14253 L|            '(適用前)支払額                       ||       |                                                  
14254 L|            .Cells(23, 2).Value = sWord68         ||       |                                                  
14255 L|            .Cells(23, 11).Value = sWord19        ||       |                                                  
14256 L|            .Cells(23, 29).NumberFormatLocal = "@"||       |                                                  
14257 L|            .Cells(23, 29).Value = CStr(Format(str||       |                                                  
14258 L|            .Cells(23, 29).HorizontalAlignment = x||       |                                                  
14259 L|            .Cells(23, 32).Value = sYen           ||       |                                                  
14260 L|                                                  ||       |                                                  
14261 L|            '(適用前)消費税額                     ||       |                                                  
14262 L|            .Cells(24, 2).Value = sWord69         ||       |                                                  
14263 L|            .Cells(24, 11).Value = sWord19        ||       |                                                  
14264 L|            .Cells(24, 29).NumberFormatLocal = "@"||       |                                                  
14265 L|            .Cells(24, 29).Value = CStr(Format(str||       |                                                  
14266 L|            .Cells(24, 29).HorizontalAlignment = x||       |                                                  
14267 L|            .Cells(24, 32).Value = sYen           ||       |                                                  
14268 L|                                                  ||       |                                                  
14269 L|                                                  ||       |                                                  
14270 L|            '(適用後)消費税率                     ||       |                                                  
14271 L|            .Cells(28, 2).Value = sWord66         ||       |                                                  
14272 L|            .Cells(28, 11).Value = sWord19        ||       |                                                  
14273 L|            .Cells(28, 13).Value = strTaxRate(1) &||       |                                                  
14274 L|                                                  ||       |                                                  
14275 L|            '(適用後)税率適用期間                 ||       |                                                  
14276 L|            .Cells(29, 2).Value = sWord67         ||       |                                                  
14277 L|            .Cells(29, 11).Value = sWord19        ||       |                                                  
14278 L|            .Cells(29, 13).Value = _              ||       |                                                  
14279 L|            CStr(Format(strUse_Date, "YYYY年M月D日||       |                                                  
14280 L|                                                  ||       |                                                  
14281 L|            '(適用後)支払額                       ||       |                                                  
14282 L|            .Cells(30, 2).Value = sWord68         ||       |                                                  
14283 L|            .Cells(30, 11).Value = sWord19        ||       |                                                  
14284 L|            .Cells(30, 29).NumberFormatLocal = "@"||       |                                                  
14285 L|            .Cells(30, 29).Value = CStr(Format(str||       |                                                  
14286 L|            .Cells(30, 29).HorizontalAlignment = x||       |                                                  
14287 L|            .Cells(30, 32).Value = sYen           ||       |                                                  
14288 L|                                                  ||       |                                                  
14289 L|            '(適用後)消費税額                     ||       |                                                  
14290 L|            .Cells(31, 2).Value = sWord69         ||       |                                                  
14291 L|            .Cells(31, 11).Value = sWord19        ||       |                                                  
14292 L|            .Cells(31, 29).NumberFormatLocal = "@"||       |                                                  
14293 L|            .Cells(31, 29).Value = CStr(Format(str||       |                                                  
14294 L|            .Cells(31, 29).HorizontalAlignment = x||       |                                                  
14295 L|            .Cells(31, 32).Value = sYen           ||       |                                                  
14296 L|                                                  ||       |                                                  
14297 L|                                                  ||       |                                                  
14298 L|            '合計                                 ||       |                                                  
14299 L|            .Cells(35, 2).Value = sWord70         ||       |                                                  
14300 L|                                                  ||       |                                                  
14301 L|            '支払額                               ||       |                                                  
14302 L|            .Cells(36, 2).Value = sWord68         ||       |                                                  
14303 L|            .Cells(36, 11).Value = sWord19        ||       |                                                  
14304 L|            .Cells(36, 29).NumberFormatLocal = "@"||       |                                                  
14305 L|            .Cells(36, 29).Value = CStr(Format(CCu||       |                                                  
14306 L|            .Cells(36, 29).HorizontalAlignment = x||       |                                                  
14307 L|            .Cells(36, 32).Value = sYen           ||       |                                                  
14308 L|                                                  ||       |                                                  
14309 L|            '消費税額                             ||       |                                                  
14310 L|            .Cells(37, 2).Value = sWord69         ||       |                                                  
14311 L|            .Cells(37, 11).Value = sWord19        ||       |                                                  
14312 L|            .Cells(37, 29).NumberFormatLocal = "@"||       |                                                  
14313 L|            .Cells(37, 29).Value = CStr(Format(CCu||       |                                                  
14314 L|            .Cells(37, 29).HorizontalAlignment = x||       |                                                  
14315 L|            .Cells(37, 32).Value = sYen           ||       |                                                  
14316 L|                                                  ||       |                                                  
14317 L|            '合計額                               ||       |                                                  
14318 L|            .Cells(37, 13).Value = sWord24        ||       |                                                  
14319 L|            .Cells(37, 29).NumberFormatLocal = "@"||       |                                                  
14320 L|            .Cells(37, 29).Value = CStr(Format(CCu||       |                                                  
14321 L|            .Cells(37, 29).HorizontalAlignment = x||       |                                                  
14322 L|            .Cells(37, 32).Value = sYen           ||       |                                                  
14323 L|        End With                                  ||       |                                                  
14324  |    Else                                          ||14300  |    Else                                          
14325  |        '跨がない場合｢消費税額内訳書｣は出力しない ||14301  |        '跨がない場合｢消費税額内訳書｣は出力しない 
14326  |    End If                                        ||14302  |    End If                                        
14327  |'2014/02/19 END   M.Takada 【管理会計】消費税率変 ||14303  |'2014/02/19 END   M.Takada 【管理会計】消費税率変 
       |                                                  ||14304 R|                                                  
14328  |    '正常戻り値セット                             ||14305  |    '正常戻り値セット                             
14329  |    fnblExcelOut_NotChgRate = True                ||14306  |    fnblExcelOut_NotChgRate = True                
14330  |    GoTo EndProc                                  ||14307  |    GoTo EndProc                                  
14331  |                                                  ||14308  |                                                  
14332  |ErrorTrap:                                        ||14309  |ErrorTrap:                                        
14333  |    ' Excel を起動できない場合に発生するエラーをト||14310  |    ' Excel を起動できない場合に発生するエラーをト
14334  |    Select Case Err.Number                        ||14311  |    Select Case Err.Number                        
14335  |        Case 440               ' オートメーション ||14312  |        Case 440               ' オートメーション 
14336  |            iTries = iTries + 1                   ||14313  |            iTries = iTries + 1                   
14337  |            ' Excel の再起動を 5 回まで行います。 ||14314  |            ' Excel の再起動を 5 回まで行います。 
14338  |            If iTries < 5 Then                    ||14315  |            If iTries < 5 Then                    
14339  |               Set xlApp = New Excel.Application  ||14316  |               Set xlApp = New Excel.Application  
14340  |               Resume                             ||14317  |               Resume                             
14341  |            Else                                  ||14318  |            Else                                  
14342  |               Err.Raise Number:=vbObjectError + 2||14319  |               Err.Raise Number:=vbObjectError + 2
14343  |               Description:="Microsoft Excel を起 ||14320  |               Description:="Microsoft Excel を起 
14344  |            End If                                ||14321  |            End If                                
14345  |        Case Else                                 ||14322  |        Case Else                                 
14346  |    End Select                                    ||14323  |    End Select                                    
14347  |                                                  ||14324  |                                                  
14348  |    'Workbookを閉じる                             ||14325  |    'Workbookを閉じる                             
14349  |    xlBook.Close                                  ||14326  |    xlBook.Close                                  
14350  |                                                  ||14327  |                                                  
14351  |    'Excel終了                                    ||14328  |    'Excel終了                                    
14352  |    xlApp.Quit                                    ||14329  |    xlApp.Quit                                    
14353  |                                                  ||14330  |                                                  
14354  |    'オブジェクトの解放                           ||14331  |    'オブジェクトの解放                           
14355  |    Set xlApp = Nothing                           ||14332  |    Set xlApp = Nothing                           
14356  |    Set xlBook = Nothing                          ||14333  |    Set xlBook = Nothing                          
14357  |    Set xlSheet = Nothing                         ||14334  |    Set xlSheet = Nothing                         
14358  |                                                  ||14335  |                                                  
14359  |OnErrorProc:                                      ||14336  |OnErrorProc:                                      
14360  |    Call subError("システムエラー", Str(Err.Number||14337  |    Call subError("システムエラー", Str(Err.Number
14361  |        Error, strErrCall, conTitle)              ||14338  |        Error, strErrCall, conTitle)              
14362  |    'マウスポインター元に戻す                     ||14339  |    'マウスポインター元に戻す                     
14363  |    Screen.MousePointer = vbDefault               ||14340  |    Screen.MousePointer = vbDefault               
14364  |    GoTo EndProc                                  ||14341  |    GoTo EndProc                                  
14365  |                                                  ||14342  |                                                  
14366  |EndProc:                                          ||14343  |EndProc:                                          
14367  |                                                  ||14344  |                                                  
14368  |End Function                                      ||14345  |End Function                                      
14369  |                                                  ||14346  |                                                  
14370  |'=================================================||14347  |'=================================================
14371  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnSetOtherComRate            ||14348  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnSetOtherComRate            
14372  |'機能            :   料率変更有りの外部委託顧問料 ||14349  |'機能            :   料率変更有りの外部委託顧問料 
14373  |'                                                 ||14350  |'                                                 
14374  |'パラメータ 　   :    NavKbn = 取得NAV区分(1:月末N||14351  |'パラメータ 　   :    NavKbn = 取得NAV区分(1:月末N
14375  |'                     AssetKbn = 資産種類(0:純資産||14352  |'                     AssetKbn = 資産種類(0:純資産
14376  |'                     BabyAccCd = マザー組入資産の||14353  |'                     BabyAccCd = マザー組入資産の
14377  |'                     AccCD = マザー組入資産の場合||14354  |'                     AccCD = マザー組入資産の場合
14378  |'                             NAV区分が3の場合の口||14355  |'                             NAV区分が3の場合の口
14379  |'                     CurrencyCd = ベース通貨コー ||14356  |'                     CurrencyCd = ベース通貨コー 
14380  |'                     AsstType = 資産コード(省略可||14357  |'                     AsstType = 資産コード(省略可
14381  |'                     StrDate = 計算開始日(省略不 ||14358  |'                     StrDate = 計算開始日(省略不 
14382  |'                     strFlg = 計算開始日選択フラ ||14359  |'                     strFlg = 計算開始日選択フラ 
14383  |'                                                 ||14360  |'                                                 
14384  |'日付               担当　              修正内容  ||14361  |'日付               担当　              修正内容  
14385  |'-------------------------------------------------||14362  |'-------------------------------------------------
14386  |'2006/07/18         K.Furuya <SRA>     新規作成　 ||14363  |'2006/07/18         K.Furuya <SRA>     新規作成　 
14387  |'2008/03/03         K.Furuya <SRA>     時価総額基 ||14364  |'2008/03/03         K.Furuya <SRA>     時価総額基 
14388  |'=================================================||14365  |'=================================================
14389  |Private Function fnSetOtherComRate( _             ||14366  |Private Function fnSetOtherComRate( _             
14390  |    ByVal NavKbn As String, _                     ||14367  |    ByVal NavKbn As String, _                     
14391  |    ByVal AssetKbn As String, _                   ||14368  |    ByVal AssetKbn As String, _                   
14392  |    Optional BabyAccCd As String = " ", _         ||14369  |    Optional BabyAccCd As String = " ", _         
14393  |    Optional AccCD As String = " ", _             ||14370  |    Optional AccCD As String = " ", _             
14394  |    Optional CurrencyCode As String = " ", _      ||14371  |    Optional CurrencyCode As String = " ", _      
14395  |    Optional AssetType As String = " ", _         ||14372  |    Optional AssetType As String = " ", _         
14396  |    Optional strDate As String = " ", _           ||14373  |    Optional strDate As String = " ", _           
14397  |    Optional strFlg As String = " ") As Boolean   ||14374  |    Optional strFlg As String = " ") As Boolean   
14398  |                                                  ||14375  |                                                  
14399  |    Dim strRuleNo                   As Integer  ' ||14376  |    Dim strRuleNo                   As Integer  ' 
14400  |    Dim endRuleNo                   As Integer  ' ||14377  |    Dim endRuleNo                   As Integer  ' 
14401  |    Dim i                           As Integer    ||14378  |    Dim i                           As Integer    
14402  |    Dim J                           As Integer    ||14379  |    Dim J                           As Integer    
14403  |    Dim K                           As Integer    ||14380  |    Dim K                           As Integer    
14404  |    Dim N                           As Integer    ||14381  |    Dim N                           As Integer    
14405  |                                                  ||14382  |                                                  
14406  |    Dim strSQL                      As String     ||14383  |    Dim strSQL                      As String     
14407  |    Dim RecCnt                      As Integer  ' ||14384  |    Dim RecCnt                      As Integer  ' 
14408  |                                                  ||14385  |                                                  
14409  |    fnSetOtherComRate = False                     ||14386  |    fnSetOtherComRate = False                     
14410  |                                                  ||14387  |                                                  
14411  |    '比較ルールNo変数の初期化                     ||14388  |    '比較ルールNo変数の初期化                     
14412  |    strRuleNo = 0                                 ||14389  |    strRuleNo = 0                                 
14413  |    endRuleNo = 0                                 ||14390  |    endRuleNo = 0                                 
14414  |    'ルールNoのループ変数を初期化                 ||14391  |    'ルールNoのループ変数を初期化                 
14415  |    J = 0                                         ||14392  |    J = 0                                         
14416  |    '定義体配列の初期化                           ||14393  |    '定義体配列の初期化                           
14417  |    ReDim gtypOtherComRec(0)                      ||14394  |    ReDim gtypOtherComRec(0)                      
14418  |    ReDim gtypOtherComRec(0).APPLY_OTHER_COM_RATE(||14395  |    ReDim gtypOtherComRec(0).APPLY_OTHER_COM_RATE(
14419  |                                                  ||14396  |                                                  
14420  |    '料率変更毎の計算期間日数、順位、料率、レート ||14397  |    '料率変更毎の計算期間日数、順位、料率、レート 
14421  |    For i = LBound(gbuOtherComRateGetUPDRec.N) To ||14398  |    For i = LBound(gbuOtherComRateGetUPDRec.N) To 
14422  |        'ルールNoを取得                           ||14399  |        'ルールNoを取得                           
14423  |        strRuleNo = gbuOtherComRateGetUPDRec.N(i).||14400  |        strRuleNo = gbuOtherComRateGetUPDRec.N(i).
14424  |        '最初のレコードの場合は必ず入る           ||14401  |        '最初のレコードの場合は必ず入る           
14425  |        If i = 0 Then                             ||14402  |        If i = 0 Then                             
14426  |            '利率順位のループ変数を初期化         ||14403  |            '利率順位のループ変数を初期化         
14427  |            K = 0                                 ||14404  |            K = 0                                 
14428  |            ReDim Preserve gtypOtherComRec(J)     ||14405  |            ReDim Preserve gtypOtherComRec(J)     
14429  |            ReDim Preserve gtypOtherComRec(J).APPL||14406  |            ReDim Preserve gtypOtherComRec(J).APPL
14430  |            gtypOtherComRec(J).APPLY_CONTRACT_NO =||14407  |            gtypOtherComRec(J).APPLY_CONTRACT_NO =
14431  |            'レコードの最初の場合計算開始日を適用 ||14408  |            'レコードの最初の場合計算開始日を適用 
14432  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||14409  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
14433  |            If strFlg = "0" Then                  ||14410  |            If strFlg = "0" Then                  
14434  |                gtypOtherComRec(J).APPLY_START_DAT||14411  |                gtypOtherComRec(J).APPLY_START_DAT
14435  |            Else                                  ||14412  |            Else                                  
14436  |                gtypOtherComRec(J).APPLY_START_DAT||14413  |                gtypOtherComRec(J).APPLY_START_DAT
14437  |            End If                                ||14414  |            End If                                
14438  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||14415  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
14439  |            'レコードの最後の場合計算終了日を適用 ||14416  |            'レコードの最後の場合計算終了日を適用 
14440  |                                                  ||14417  |                                                  
14441  |            If gbuOtherComRateGetUPDRec.N(J).RGET_||14418  |            If gbuOtherComRateGetUPDRec.N(J).RGET_
14442  |                gtypOtherComRec(J).APPLY_END_DATE ||14419  |                gtypOtherComRec(J).APPLY_END_DATE 
14443  |            'レコードの途中の場合ルールNoの適用終 ||14420  |            'レコードの途中の場合ルールNoの適用終 
14444  |            Else                                  ||14421  |            Else                                  
14445  |                gtypOtherComRec(J).APPLY_END_DATE ||14422  |                gtypOtherComRec(J).APPLY_END_DATE 
14446  |            End If                                ||14423  |            End If                                
14447  |            gtypOtherComRec(J).APPLY_OTHER_COM_RUL||14424  |            gtypOtherComRec(J).APPLY_OTHER_COM_RUL
14448  |            '通貨コードをセット                   ||14425  |            '通貨コードをセット                   
14449  |            gtypOtherComRec(J).APPLY_BASE_CURRENCY||14426  |            gtypOtherComRec(J).APPLY_BASE_CURRENCY
14450  |            '計算日数を取得                       ||14427  |            '計算日数を取得                       
14451  |            '取得NAV区分が"3"の場合               ||14428  |            '取得NAV区分が"3"の場合               
14452  |            If NavKbn = "3" Then                  ||14429  |            If NavKbn = "3" Then                  
14453  |                '資産種類が純資産の場合           ||14430  |                '資産種類が純資産の場合           
14454  |                If AssetKbn = "0" Then            ||14431  |                If AssetKbn = "0" Then            
14455  |                    'SQL文生成(変更料率期間取得)  ||14432  |                    'SQL文生成(変更料率期間取得)  
14456  |                    strSQL = ""                   ||14433  |                    strSQL = ""                   
14457  |                    strSQL = strSQL & "SELECT"    ||14434  |                    strSQL = strSQL & "SELECT"    
14458  |                    strSQL = strSQL & "    BASE_DA||14435  |                    strSQL = strSQL & "    BASE_DA
14459  |                    strSQL = strSQL & " FROM"     ||14436  |                    strSQL = strSQL & " FROM"     
14460  |                    strSQL = strSQL & "    CFR_DAI||14437  |                    strSQL = strSQL & "    CFR_DAI
14461  |                    strSQL = strSQL & " WHERE"    ||14438  |                    strSQL = strSQL & " WHERE"    
14462  |                    strSQL = strSQL & "    CFR_DAI||14439  |                    strSQL = strSQL & "    CFR_DAI
14463  |                    strSQL = strSQL & "    (CFR_DA||14440  |                    strSQL = strSQL & "    (CFR_DA
14464  |                    strSQL = strSQL & "    CFR_DAI||14441  |                    strSQL = strSQL & "    CFR_DAI
14465  |                    strSQL = strSQL & "    CFR_DAI||14442  |                    strSQL = strSQL & "    CFR_DAI
14466  |                    strSQL = strSQL & "    CFR_DAI||14443  |                    strSQL = strSQL & "    CFR_DAI
14467  |                'マザー組入資産の場合             ||14444  |                'マザー組入資産の場合             
14468  |                ElseIf AssetKbn = "1" Then        ||14445  |                ElseIf AssetKbn = "1" Then        
14469  |                    strSQL = ""                   ||14446  |                    strSQL = ""                   
14470  |                    strSQL = strSQL & "SELECT"    ||14447  |                    strSQL = strSQL & "SELECT"    
14471  |                    strSQL = strSQL & "    a.BASE_||14448  |                    strSQL = strSQL & "    a.BASE_
14472  |                    strSQL = strSQL & " FROM"     ||14449  |                    strSQL = strSQL & " FROM"     
14473  |                    strSQL = strSQL & "    CFR_DAI||14450  |                    strSQL = strSQL & "    CFR_DAI
14474  |                    strSQL = strSQL & " WHERE"    ||14451  |                    strSQL = strSQL & " WHERE"    
14475  |                    strSQL = strSQL & "    b.BABY_||14452  |                    strSQL = strSQL & "    b.BABY_
14476  |                    strSQL = strSQL & "    b.BASE_||14453  |                    strSQL = strSQL & "    b.BASE_
14477  |                    strSQL = strSQL & "    a.ACCOU||14454  |                    strSQL = strSQL & "    a.ACCOU
14478  |                    strSQL = strSQL & "    (a.BASE||14455  |                    strSQL = strSQL & "    (a.BASE
14479  |                    strSQL = strSQL & "    a.BASE_||14456  |                    strSQL = strSQL & "    a.BASE_
14480  |                    strSQL = strSQL & "    a.CURRE||14457  |                    strSQL = strSQL & "    a.CURRE
14481  |                    strSQL = strSQL & "    a.ASSET||14458  |                    strSQL = strSQL & "    a.ASSET
14482  |                End If                            ||14459  |                End If                            
14483  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||14460  |                'ﾀﾞｲﾅｾｯﾄの作成                    
14484  |                If gintDyCreate(strSQL) = False Th||14461  |                If gintDyCreate(strSQL) = False Th
14485  |                    Exit Function                 ||14462  |                    Exit Function                 
14486  |                End If                            ||14463  |                End If                            
14487  |                If gbxOraDynaset.RecordCount = 0 T||14464  |                If gbxOraDynaset.RecordCount = 0 T
14488  |                    Exit Function                 ||14465  |                    Exit Function                 
14489  |                End If                            ||14466  |                End If                            
14490  |                '計算期間の日数を取得する         ||14467  |                '計算期間の日数を取得する         
14491  |                RecCnt = 0                        ||14468  |                RecCnt = 0                        
14492  |                RecCnt = gbxOraDynaset.RecordCount||14469  |                RecCnt = gbxOraDynaset.RecordCount
14493  |                '計算期間の日数をセット           ||14470  |                '計算期間の日数をセット           
14494  |                gtypOtherComRec(J).APPLY_CALC_DAYS||14471  |                gtypOtherComRec(J).APPLY_CALC_DAYS
14495  |                '適用開始日と適用終了日を再設定す ||14472  |                '適用開始日と適用終了日を再設定す 
14496  |                For N = 1 To RecCnt               ||14473  |                For N = 1 To RecCnt               
14497  |                    '平日適用開始日を再設定する   ||14474  |                    '平日適用開始日を再設定する   
14498  |                    If N = 1 Then                 ||14475  |                    If N = 1 Then                 
14499  |                        gtypOtherComRec(J).APPLY_D||14476  |                        gtypOtherComRec(J).APPLY_D
14500  |                    '平日適用終了日を再設定する   ||14477  |                    '平日適用終了日を再設定する   
14501  |                    ElseIf N = RecCnt Then        ||14478  |                    ElseIf N = RecCnt Then        
14502  |                        gtypOtherComRec(J).APPLY_D||14479  |                        gtypOtherComRec(J).APPLY_D
14503  |                    End If                        ||14480  |                    End If                        
14504  |                                                  ||14481  |                                                  
14505  |                    '次レコードへ                 ||14482  |                    '次レコードへ                 
14506  |                    Call gDyNext                  ||14483  |                    Call gDyNext                  
14507  |                Next N                            ||14484  |                Next N                            
14508  |            '取得NAV区分が"3"以外の場合           ||14485  |            '取得NAV区分が"3"以外の場合           
14509  |            Else                                  ||14486  |            Else                                  
14510  |                gtypOtherComRec(J).APPLY_CALC_DAYS||14487  |                gtypOtherComRec(J).APPLY_CALC_DAYS
14511  |                                    DateDiff("d", ||14488  |                                    DateDiff("d", 
14512  |                                                  ||14489  |                                                  
14513  |            End If                                ||14490  |            End If                                
14514  |                                                  ||14491  |                                                  
14515  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14492  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14516  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14493  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14517  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14494  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14518  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14495  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14519  |        '前レコードのルールNoと現ルールNoが異なる ||14496  |        '前レコードのルールNoと現ルールNoが異なる 
14520  |        ElseIf strRuleNo <> endRuleNo Then        ||14497  |        ElseIf strRuleNo <> endRuleNo Then        
14521  |            'ルールNoのループ変数をインクリメント ||14498  |            'ルールNoのループ変数をインクリメント 
14522  |            J = J + 1                             ||14499  |            J = J + 1                             
14523  |            '利率順位のループ変数を初期化         ||14500  |            '利率順位のループ変数を初期化         
14524  |            K = 0                                 ||14501  |            K = 0                                 
14525  |            ReDim Preserve gtypOtherComRec(J)     ||14502  |            ReDim Preserve gtypOtherComRec(J)     
14526  |            ReDim Preserve gtypOtherComRec(J).APPL||14503  |            ReDim Preserve gtypOtherComRec(J).APPL
14527  |            gtypOtherComRec(J).APPLY_CONTRACT_NO =||14504  |            gtypOtherComRec(J).APPLY_CONTRACT_NO =
14528  |            'レコードの適用開始日を代入           ||14505  |            'レコードの適用開始日を代入           
14529  |            gtypOtherComRec(J).APPLY_START_DATE = ||14506  |            gtypOtherComRec(J).APPLY_START_DATE = 
14530  |            'レコードの最後の場合計算終了日を適用 ||14507  |            'レコードの最後の場合計算終了日を適用 
14531  |            If gbuOtherComRateGetUPDRec.N(J).RGET_||14508  |            If gbuOtherComRateGetUPDRec.N(J).RGET_
14532  |                gtypOtherComRec(J).APPLY_END_DATE ||14509  |                gtypOtherComRec(J).APPLY_END_DATE 
14533  |            'レコードの途中の場合ルールNoの適用終 ||14510  |            'レコードの途中の場合ルールNoの適用終 
14534  |            Else                                  ||14511  |            Else                                  
14535  |                gtypOtherComRec(J).APPLY_END_DATE ||14512  |                gtypOtherComRec(J).APPLY_END_DATE 
14536  |            End If                                ||14513  |            End If                                
14537  |            gtypOtherComRec(J).APPLY_OTHER_COM_RUL||14514  |            gtypOtherComRec(J).APPLY_OTHER_COM_RUL
14538  |            '通貨コードをセット                   ||14515  |            '通貨コードをセット                   
14539  |            gtypOtherComRec(J).APPLY_BASE_CURRENCY||14516  |            gtypOtherComRec(J).APPLY_BASE_CURRENCY
14540  |            '計算日数を取得                       ||14517  |            '計算日数を取得                       
14541  |            '取得NAV区分が"3"の場合               ||14518  |            '取得NAV区分が"3"の場合               
14542  |            If NavKbn = "3" Then                  ||14519  |            If NavKbn = "3" Then                  
14543  |                '資産種類が純資産の場合           ||14520  |                '資産種類が純資産の場合           
14544  |                If AssetKbn = "0" Then            ||14521  |                If AssetKbn = "0" Then            
14545  |                    'SQL文生成(変更料率期間取得)  ||14522  |                    'SQL文生成(変更料率期間取得)  
14546  |                    strSQL = ""                   ||14523  |                    strSQL = ""                   
14547  |                    strSQL = strSQL & "SELECT"    ||14524  |                    strSQL = strSQL & "SELECT"    
14548  |                    strSQL = strSQL & "    BASE_DA||14525  |                    strSQL = strSQL & "    BASE_DA
14549  |                    strSQL = strSQL & " FROM"     ||14526  |                    strSQL = strSQL & " FROM"     
14550  |                    strSQL = strSQL & "    CFR_DAI||14527  |                    strSQL = strSQL & "    CFR_DAI
14551  |                    strSQL = strSQL & " WHERE"    ||14528  |                    strSQL = strSQL & " WHERE"    
14552  |                    strSQL = strSQL & "    CFR_DAI||14529  |                    strSQL = strSQL & "    CFR_DAI
14553  |                    strSQL = strSQL & "    (CFR_DA||14530  |                    strSQL = strSQL & "    (CFR_DA
14554  |                    strSQL = strSQL & "    CFR_DAI||14531  |                    strSQL = strSQL & "    CFR_DAI
14555  |                    strSQL = strSQL & "    CFR_DAI||14532  |                    strSQL = strSQL & "    CFR_DAI
14556  |                    strSQL = strSQL & "    CFR_DAI||14533  |                    strSQL = strSQL & "    CFR_DAI
14557  |                'マザー組入資産の場合             ||14534  |                'マザー組入資産の場合             
14558  |                ElseIf AssetKbn = "1" Then        ||14535  |                ElseIf AssetKbn = "1" Then        
14559  |                    strSQL = ""                   ||14536  |                    strSQL = ""                   
14560  |                    strSQL = strSQL & "SELECT"    ||14537  |                    strSQL = strSQL & "SELECT"    
14561  |                    strSQL = strSQL & "    a.BASE_||14538  |                    strSQL = strSQL & "    a.BASE_
14562  |                    strSQL = strSQL & " FROM"     ||14539  |                    strSQL = strSQL & " FROM"     
14563  |                    strSQL = strSQL & "    CFR_DAI||14540  |                    strSQL = strSQL & "    CFR_DAI
14564  |                    strSQL = strSQL & " WHERE"    ||14541  |                    strSQL = strSQL & " WHERE"    
14565  |                    strSQL = strSQL & "    b.BABY_||14542  |                    strSQL = strSQL & "    b.BABY_
14566  |                    strSQL = strSQL & "    b.BASE_||14543  |                    strSQL = strSQL & "    b.BASE_
14567  |                    strSQL = strSQL & "    a.ACCOU||14544  |                    strSQL = strSQL & "    a.ACCOU
14568  |                    strSQL = strSQL & "    (a.BASE||14545  |                    strSQL = strSQL & "    (a.BASE
14569  |                    strSQL = strSQL & "    a.BASE_||14546  |                    strSQL = strSQL & "    a.BASE_
14570  |                    strSQL = strSQL & "    a.CURRE||14547  |                    strSQL = strSQL & "    a.CURRE
14571  |                    strSQL = strSQL & "    a.ASSET||14548  |                    strSQL = strSQL & "    a.ASSET
14572  |                End If                            ||14549  |                End If                            
14573  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||14550  |                'ﾀﾞｲﾅｾｯﾄの作成                    
14574  |                If gintDyCreate(strSQL) = False Th||14551  |                If gintDyCreate(strSQL) = False Th
14575  |                    Exit Function                 ||14552  |                    Exit Function                 
14576  |                End If                            ||14553  |                End If                            
14577  |                If gbxOraDynaset.RecordCount = 0 T||14554  |                If gbxOraDynaset.RecordCount = 0 T
14578  |                    Exit Function                 ||14555  |                    Exit Function                 
14579  |                End If                            ||14556  |                End If                            
14580  |                '計算期間の日数を取得する         ||14557  |                '計算期間の日数を取得する         
14581  |                RecCnt = 0                        ||14558  |                RecCnt = 0                        
14582  |                RecCnt = gbxOraDynaset.RecordCount||14559  |                RecCnt = gbxOraDynaset.RecordCount
14583  |                '計算期間の日数をセット           ||14560  |                '計算期間の日数をセット           
14584  |                gtypOtherComRec(J).APPLY_CALC_DAYS||14561  |                gtypOtherComRec(J).APPLY_CALC_DAYS
14585  |                '適用開始日と適用終了日を再設定す ||14562  |                '適用開始日と適用終了日を再設定す 
14586  |                For N = 1 To RecCnt               ||14563  |                For N = 1 To RecCnt               
14587  |                    '平日適用開始日を再設定する   ||14564  |                    '平日適用開始日を再設定する   
14588  |                    If N = 1 Then                 ||14565  |                    If N = 1 Then                 
14589  |                        gtypOtherComRec(J).APPLY_D||14566  |                        gtypOtherComRec(J).APPLY_D
14590  |                    '平日適用終了日を再設定する   ||14567  |                    '平日適用終了日を再設定する   
14591  |                    ElseIf N = RecCnt Then        ||14568  |                    ElseIf N = RecCnt Then        
14592  |                        gtypOtherComRec(J).APPLY_D||14569  |                        gtypOtherComRec(J).APPLY_D
14593  |                    End If                        ||14570  |                    End If                        
14594  |                                                  ||14571  |                                                  
14595  |                    '次レコードへ                 ||14572  |                    '次レコードへ                 
14596  |                    Call gDyNext                  ||14573  |                    Call gDyNext                  
14597  |                Next N                            ||14574  |                Next N                            
14598  |            '取得NAV区分が"3"以外の場合           ||14575  |            '取得NAV区分が"3"以外の場合           
14599  |            Else                                  ||14576  |            Else                                  
14600  |                gtypOtherComRec(J).APPLY_CALC_DAYS||14577  |                gtypOtherComRec(J).APPLY_CALC_DAYS
14601  |                                    DateDiff("d", ||14578  |                                    DateDiff("d", 
14602  |                                                  ||14579  |                                                  
14603  |            End If                                ||14580  |            End If                                
14604  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14581  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14605  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14582  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14606  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14583  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14607  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14584  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14608  |        Else                                      ||14585  |        Else                                      
14609  |            '利率順位のループ変数をインクリメント ||14586  |            '利率順位のループ変数をインクリメント 
14610  |            K = K + 1                             ||14587  |            K = K + 1                             
14611  |            ReDim Preserve gtypOtherComRec(J).APPL||14588  |            ReDim Preserve gtypOtherComRec(J).APPL
14612  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14589  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14613  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14590  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14614  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14591  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14615  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14592  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14616  |        End If                                    ||14593  |        End If                                    
14617  |        '現ルールNoを前ルールNo変数に代入         ||14594  |        '現ルールNoを前ルールNo変数に代入         
14618  |        endRuleNo = strRuleNo                     ||14595  |        endRuleNo = strRuleNo                     
14619  |    Next i                                        ||14596  |    Next i                                        
14620  |                                                  ||14597  |                                                  
14621  |    fnSetOtherComRate = True                      ||14598  |    fnSetOtherComRate = True                      
14622  |                                                  ||14599  |                                                  
14623  |End Function                                      ||14600  |End Function                                      
14624  |                                                  ||14601  |                                                  
14625  |                                                  ||14602  |                                                  
14626  |'=================================================||14603  |'=================================================
14627  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbExcelNetAssetValue         ||14604  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbExcelNetAssetValue         
14628  |'機能            :   確認書の年率出力             ||14605  |'機能            :   確認書の年率出力             
14629  |'                                                 ||14606  |'                                                 
14630  |'日付               担当　              修正内容  ||14607  |'日付               担当　              修正内容  
14631  |'-------------------------------------------------||14608  |'-------------------------------------------------
14632  |'2006/07/19         K.Furuya <SRA>     新規作成(期||14609  |'2006/07/19         K.Furuya <SRA>     新規作成(期
14633  |'=================================================||14610  |'=================================================
14634  |Private Sub sbExcelNetAssetValue(ByVal TotalRate A||14611  |Private Sub sbExcelNetAssetValue(ByVal TotalRate A
14635  |    Dim i       As Integer                        ||14612  |    Dim i       As Integer                        
14636  |    Dim iRowCnt As Long                           ||14613  |    Dim iRowCnt As Long                           
14637  |                                                  ||14614  |                                                  
14638  |    With xlSheet                                  ||14615  |    With xlSheet                                  
14639  |        '固定料率                                 ||14616  |        '固定料率                                 
14640  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat||14617  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat
14641  |            '年率1行固定                          ||14618  |            '年率1行固定                          
14642  |            .Cells(39, 13).Value = _              ||14619  |            .Cells(39, 13).Value = _              
14643  |                sWord30 & Format(gbuOtherComRateGe||14620  |                sWord30 & Format(gbuOtherComRateGe
14644  |        '段階料率                                 ||14621  |        '段階料率                                 
14645  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other||14622  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other
14646  |            '料率順位のデータ数により処理を分岐   ||14623  |            '料率順位のデータ数により処理を分岐   
14647  |            iRowCnt = 0                           ||14624  |            iRowCnt = 0                           
14648  |            If UBound(gbuOtherComRateGetUPDRec.N) ||14625  |            If UBound(gbuOtherComRateGetUPDRec.N) 
14649  |                '料率データが4件以上のときは行間な||14626  |                '料率データが4件以上のときは行間な
14650  |                For i = LBound(gbuOtherComRateGetU||14627  |                For i = LBound(gbuOtherComRateGetU
14651  |                    If i = 0 Then                 ||14628  |                    If i = 0 Then                 
14652  |                        '年率1行目                ||14629  |                        '年率1行目                
14653  |                        Select Case gbuMGetUPDRec.||14630  |                        Select Case gbuMGetUPDRec.
14654  |                            Case cAud             ||14631  |                            Case cAud             
14655  |                                .Cells(39, 13).Val||14632  |                                .Cells(39, 13).Val
14656  |                                    sWord26 & CStr||14633  |                                    sWord26 & CStr
14657  |                                    sAud & sWord27||14634  |                                    sAud & sWord27
14658  |                            Case cCad             ||14635  |                            Case cCad             
14659  |                                .Cells(39, 13).Val||14636  |                                .Cells(39, 13).Val
14660  |                                    sWord26 & CStr||14637  |                                    sWord26 & CStr
14661  |                                    sCad & sWord27||14638  |                                    sCad & sWord27
14662  |                            Case cChf             ||14639  |                            Case cChf             
14663  |                                .Cells(39, 13).Val||14640  |                                .Cells(39, 13).Val
14664  |                                    sWord26 & CStr||14641  |                                    sWord26 & CStr
14665  |                                    sChf & sWord27||14642  |                                    sChf & sWord27
14666  |                            Case cEur             ||14643  |                            Case cEur             
14667  |                                .Cells(39, 13).Val||14644  |                                .Cells(39, 13).Val
14668  |                                    sWord26 & CStr||14645  |                                    sWord26 & CStr
14669  |                                    sEur & sWord27||14646  |                                    sEur & sWord27
14670  |                            Case cGbp             ||14647  |                            Case cGbp             
14671  |                                .Cells(39, 13).Val||14648  |                                .Cells(39, 13).Val
14672  |                                    sWord26 & CStr||14649  |                                    sWord26 & CStr
14673  |                                    sGbp & sWord27||14650  |                                    sGbp & sWord27
14674  |                            Case cHkd             ||14651  |                            Case cHkd             
14675  |                                .Cells(39, 13).Val||14652  |                                .Cells(39, 13).Val
14676  |                                    sWord26 & CStr||14653  |                                    sWord26 & CStr
14677  |                                    sHkd & sWord27||14654  |                                    sHkd & sWord27
14678  |                            Case cJpy             ||14655  |                            Case cJpy             
14679  |                                .Cells(39, 13).Val||14656  |                                .Cells(39, 13).Val
14680  |                                    sWord26 & CStr||14657  |                                    sWord26 & CStr
14681  |                                    sYen & sWord27||14658  |                                    sYen & sWord27
14682  |                            Case cMyr             ||14659  |                            Case cMyr             
14683  |                                .Cells(39, 13).Val||14660  |                                .Cells(39, 13).Val
14684  |                                    sWord26 & CStr||14661  |                                    sWord26 & CStr
14685  |                                    sMyr & sWord27||14662  |                                    sMyr & sWord27
14686  |                            Case cNzd             ||14663  |                            Case cNzd             
14687  |                                .Cells(39, 13).Val||14664  |                                .Cells(39, 13).Val
14688  |                                    sWord26 & CStr||14665  |                                    sWord26 & CStr
14689  |                                    sNzd & sWord27||14666  |                                    sNzd & sWord27
14690  |                            Case cSek             ||14667  |                            Case cSek             
14691  |                                .Cells(39, 13).Val||14668  |                                .Cells(39, 13).Val
14692  |                                    sWord26 & CStr||14669  |                                    sWord26 & CStr
14693  |                                    sSek & sWord27||14670  |                                    sSek & sWord27
14694  |                            Case cSgd             ||14671  |                            Case cSgd             
14695  |                                .Cells(39, 13).Val||14672  |                                .Cells(39, 13).Val
14696  |                                    sWord26 & CStr||14673  |                                    sWord26 & CStr
14697  |                                    sSgd & sWord27||14674  |                                    sSgd & sWord27
14698  |                            Case cUsd             ||14675  |                            Case cUsd             
14699  |                                .Cells(39, 13).Val||14676  |                                .Cells(39, 13).Val
14700  |                                    sWord26 & CStr||14677  |                                    sWord26 & CStr
14701  |                                    sUsd & sWord27||14678  |                                    sUsd & sWord27
14702  |                            Case cNok             ||14679  |                            Case cNok             
14703  |                                .Cells(39, 13).Val||14680  |                                .Cells(39, 13).Val
14704  |                                    sWord26 & CStr||14681  |                                    sWord26 & CStr
14705  |                                    sNok & sWord27||14682  |                                    sNok & sWord27
14706  |                        End Select                ||14683  |                        End Select                
14707  |                        '年率　累積値セット       ||14684  |                        '年率　累積値セット       
14708  |                        TotalRate = CCur(gbuOtherC||14685  |                        TotalRate = CCur(gbuOtherC
14709  |                    ElseIf i = UBound(gbuOtherComR||14686  |                    ElseIf i = UBound(gbuOtherComR
14710  |                        '年率最終行               ||14687  |                        '年率最終行               
14711  |                        '前半金額部分             ||14688  |                        '前半金額部分             
14712  |                        .Cells(39 + i, 23).NumberF||14689  |                        .Cells(39 + i, 23).NumberF
14713  |                        If gbuMGetUPDRec.N(lRecIdx||14690  |                        If gbuMGetUPDRec.N(lRecIdx
14714  |                            .Cells(39 + i, 23).Val||14691  |                            .Cells(39 + i, 23).Val
14715  |                        Else                      ||14692  |                        Else                      
14716  |                            .Cells(39 + i, 23).Val||14693  |                            .Cells(39 + i, 23).Val
14717  |                        End If                    ||14694  |                        End If                    
14718  |                        .Cells(39 + i, 23).Horizon||14695  |                        .Cells(39 + i, 23).Horizon
14719  |                        '後半の文言               ||14696  |                        '後半の文言               
14720  |                        Select Case gbuMGetUPDRec.||14697  |                        Select Case gbuMGetUPDRec.
14721  |                            Case cAud             ||14698  |                            Case cAud             
14722  |                                .Cells(39 + i, 24)||14699  |                                .Cells(39 + i, 24)
14723  |                                    sAud & sWord31||14700  |                                    sAud & sWord31
14724  |                            Case cCad             ||14701  |                            Case cCad             
14725  |                                .Cells(39 + i, 24)||14702  |                                .Cells(39 + i, 24)
14726  |                                    sCad & sWord31||14703  |                                    sCad & sWord31
14727  |                            Case cChf             ||14704  |                            Case cChf             
14728  |                                .Cells(39 + i, 24)||14705  |                                .Cells(39 + i, 24)
14729  |                                    sChf & sWord31||14706  |                                    sChf & sWord31
14730  |                            Case cEur             ||14707  |                            Case cEur             
14731  |                                .Cells(39 + i, 24)||14708  |                                .Cells(39 + i, 24)
14732  |                                    sEur & sWord31||14709  |                                    sEur & sWord31
14733  |                            Case cGbp             ||14710  |                            Case cGbp             
14734  |                                .Cells(39 + i, 24)||14711  |                                .Cells(39 + i, 24)
14735  |                                    sGbp & sWord31||14712  |                                    sGbp & sWord31
14736  |                            Case cHkd             ||14713  |                            Case cHkd             
14737  |                                .Cells(39 + i, 24)||14714  |                                .Cells(39 + i, 24)
14738  |                                    sHkd & sWord31||14715  |                                    sHkd & sWord31
14739  |                            Case cJpy             ||14716  |                            Case cJpy             
14740  |                                .Cells(39 + i, 24)||14717  |                                .Cells(39 + i, 24)
14741  |                                    sYen & sWord31||14718  |                                    sYen & sWord31
14742  |                            Case cMyr             ||14719  |                            Case cMyr             
14743  |                                .Cells(39 + i, 24)||14720  |                                .Cells(39 + i, 24)
14744  |                                    sMyr & sWord31||14721  |                                    sMyr & sWord31
14745  |                            Case cNzd             ||14722  |                            Case cNzd             
14746  |                                .Cells(39 + i, 24)||14723  |                                .Cells(39 + i, 24)
14747  |                                    sNzd & sWord31||14724  |                                    sNzd & sWord31
14748  |                            Case cSek             ||14725  |                            Case cSek             
14749  |                                .Cells(39 + i, 24)||14726  |                                .Cells(39 + i, 24)
14750  |                                    sSek & sWord31||14727  |                                    sSek & sWord31
14751  |                            Case cSgd             ||14728  |                            Case cSgd             
14752  |                                .Cells(39 + i, 24)||14729  |                                .Cells(39 + i, 24)
14753  |                                    sSgd & sWord31||14730  |                                    sSgd & sWord31
14754  |                            Case cUsd             ||14731  |                            Case cUsd             
14755  |                                .Cells(39 + i, 24)||14732  |                                .Cells(39 + i, 24)
14756  |                                    sUsd & sWord31||14733  |                                    sUsd & sWord31
14757  |                            Case cNok             ||14734  |                            Case cNok             
14758  |                                .Cells(39 + i, 24)||14735  |                                .Cells(39 + i, 24)
14759  |                                    sNok & sWord31||14736  |                                    sNok & sWord31
14760  |                        End Select                ||14737  |                        End Select                
14761  |                    Else                          ||14738  |                    Else                          
14762  |                        '年率2行目以降            ||14739  |                        '年率2行目以降            
14763  |                        '前半金額部分             ||14740  |                        '前半金額部分             
14764  |                        .Cells(39 + i, 23).NumberF||14741  |                        .Cells(39 + i, 23).NumberF
14765  |                        If gbuMGetUPDRec.N(lRecIdx||14742  |                        If gbuMGetUPDRec.N(lRecIdx
14766  |                            .Cells(39 + i, 23).Val||14743  |                            .Cells(39 + i, 23).Val
14767  |                        Else                      ||14744  |                        Else                      
14768  |                            .Cells(39 + i, 23).Val||14745  |                            .Cells(39 + i, 23).Val
14769  |                        End If                    ||14746  |                        End If                    
14770  |                        .Cells(39 + i, 23).Horizon||14747  |                        .Cells(39 + i, 23).Horizon
14771  |                        '年率　累積値セット       ||14748  |                        '年率　累積値セット       
14772  |                        TotalRate = TotalRate + CC||14749  |                        TotalRate = TotalRate + CC
14773  |                        '後半の文言               ||14750  |                        '後半の文言               
14774  |                        Select Case gbuMGetUPDRec.||14751  |                        Select Case gbuMGetUPDRec.
14775  |                            Case cAud             ||14752  |                            Case cAud             
14776  |                                .Cells(39 + i, 24)||14753  |                                .Cells(39 + i, 24)
14777  |                                    sAud & sWord29||14754  |                                    sAud & sWord29
14778  |                                    Format(gbuOthe||14755  |                                    Format(gbuOthe
14779  |                            Case cCad             ||14756  |                            Case cCad             
14780  |                                .Cells(39 + i, 24)||14757  |                                .Cells(39 + i, 24)
14781  |                                    sCad & sWord29||14758  |                                    sCad & sWord29
14782  |                                    Format(gbuOthe||14759  |                                    Format(gbuOthe
14783  |                            Case cChf             ||14760  |                            Case cChf             
14784  |                                .Cells(39 + i, 24)||14761  |                                .Cells(39 + i, 24)
14785  |                                    sChf & sWord29||14762  |                                    sChf & sWord29
14786  |                                    Format(gbuOthe||14763  |                                    Format(gbuOthe
14787  |                            Case cEur             ||14764  |                            Case cEur             
14788  |                                .Cells(39 + i, 24)||14765  |                                .Cells(39 + i, 24)
14789  |                                    sEur & sWord29||14766  |                                    sEur & sWord29
14790  |                                    Format(gbuOthe||14767  |                                    Format(gbuOthe
14791  |                            Case cGbp             ||14768  |                            Case cGbp             
14792  |                                .Cells(39 + i, 24)||14769  |                                .Cells(39 + i, 24)
14793  |                                    sGbp & sWord29||14770  |                                    sGbp & sWord29
14794  |                                    Format(gbuOthe||14771  |                                    Format(gbuOthe
14795  |                            Case cHkd             ||14772  |                            Case cHkd             
14796  |                                .Cells(39 + i, 24)||14773  |                                .Cells(39 + i, 24)
14797  |                                    sHkd & sWord29||14774  |                                    sHkd & sWord29
14798  |                                    Format(gbuOthe||14775  |                                    Format(gbuOthe
14799  |                            Case cJpy             ||14776  |                            Case cJpy             
14800  |                                .Cells(39 + i, 24)||14777  |                                .Cells(39 + i, 24)
14801  |                                    sYen & sWord29||14778  |                                    sYen & sWord29
14802  |                                    Format(gbuOthe||14779  |                                    Format(gbuOthe
14803  |                            Case cMyr             ||14780  |                            Case cMyr             
14804  |                                .Cells(39 + i, 24)||14781  |                                .Cells(39 + i, 24)
14805  |                                    sMyr & sWord29||14782  |                                    sMyr & sWord29
14806  |                                    Format(gbuOthe||14783  |                                    Format(gbuOthe
14807  |                            Case cNzd             ||14784  |                            Case cNzd             
14808  |                                .Cells(39 + i, 24)||14785  |                                .Cells(39 + i, 24)
14809  |                                    sNzd & sWord29||14786  |                                    sNzd & sWord29
14810  |                                    Format(gbuOthe||14787  |                                    Format(gbuOthe
14811  |                            Case cSek             ||14788  |                            Case cSek             
14812  |                                .Cells(39 + i, 24)||14789  |                                .Cells(39 + i, 24)
14813  |                                    sSek & sWord29||14790  |                                    sSek & sWord29
14814  |                                    Format(gbuOthe||14791  |                                    Format(gbuOthe
14815  |                            Case cSgd             ||14792  |                            Case cSgd             
14816  |                                .Cells(39 + i, 24)||14793  |                                .Cells(39 + i, 24)
14817  |                                    sSgd & sWord29||14794  |                                    sSgd & sWord29
14818  |                                    Format(gbuOthe||14795  |                                    Format(gbuOthe
14819  |                            Case cUsd             ||14796  |                            Case cUsd             
14820  |                                .Cells(39 + i, 24)||14797  |                                .Cells(39 + i, 24)
14821  |                                    sUsd & sWord29||14798  |                                    sUsd & sWord29
14822  |                                    Format(gbuOthe||14799  |                                    Format(gbuOthe
14823  |                            Case cNok             ||14800  |                            Case cNok             
14824  |                                .Cells(39 + i, 24)||14801  |                                .Cells(39 + i, 24)
14825  |                                    sNok & sWord29||14802  |                                    sNok & sWord29
14826  |                                    Format(gbuOthe||14803  |                                    Format(gbuOthe
14827  |                        End Select                ||14804  |                        End Select                
14828  |                    End If                        ||14805  |                    End If                        
14829  |                Next i                            ||14806  |                Next i                            
14830  |            Else                                  ||14807  |            Else                                  
14831  |                '料率データが3件以下のときは行間あ||14808  |                '料率データが3件以下のときは行間あ
14832  |                For i = LBound(gbuOtherComRateGetU||14809  |                For i = LBound(gbuOtherComRateGetU
14833  |                    If i = 0 Then                 ||14810  |                    If i = 0 Then                 
14834  |                        '年率1行目                ||14811  |                        '年率1行目                
14835  |                        Select Case gbuMGetUPDRec.||14812  |                        Select Case gbuMGetUPDRec.
14836  |                            Case cAud             ||14813  |                            Case cAud             
14837  |                                .Cells(39, 13).Val||14814  |                                .Cells(39, 13).Val
14838  |                                    sWord26 & CStr||14815  |                                    sWord26 & CStr
14839  |                                    sAud & sWord27||14816  |                                    sAud & sWord27
14840  |                            Case cCad             ||14817  |                            Case cCad             
14841  |                                .Cells(39, 13).Val||14818  |                                .Cells(39, 13).Val
14842  |                                    sWord26 & CStr||14819  |                                    sWord26 & CStr
14843  |                                    sCad & sWord27||14820  |                                    sCad & sWord27
14844  |                            Case cChf             ||14821  |                            Case cChf             
14845  |                                .Cells(39, 13).Val||14822  |                                .Cells(39, 13).Val
14846  |                                    sWord26 & CStr||14823  |                                    sWord26 & CStr
14847  |                                    sChf & sWord27||14824  |                                    sChf & sWord27
14848  |                            Case cEur             ||14825  |                            Case cEur             
14849  |                                .Cells(39, 13).Val||14826  |                                .Cells(39, 13).Val
14850  |                                    sWord26 & CStr||14827  |                                    sWord26 & CStr
14851  |                                    sEur & sWord27||14828  |                                    sEur & sWord27
14852  |                            Case cGbp             ||14829  |                            Case cGbp             
14853  |                                .Cells(39, 13).Val||14830  |                                .Cells(39, 13).Val
14854  |                                    sWord26 & CStr||14831  |                                    sWord26 & CStr
14855  |                                    sGbp & sWord27||14832  |                                    sGbp & sWord27
14856  |                            Case cHkd             ||14833  |                            Case cHkd             
14857  |                                .Cells(39, 13).Val||14834  |                                .Cells(39, 13).Val
14858  |                                    sWord26 & CStr||14835  |                                    sWord26 & CStr
14859  |                                    sHkd & sWord27||14836  |                                    sHkd & sWord27
14860  |                            Case cJpy             ||14837  |                            Case cJpy             
14861  |                                .Cells(39, 13).Val||14838  |                                .Cells(39, 13).Val
14862  |                                    sWord26 & CStr||14839  |                                    sWord26 & CStr
14863  |                                    sYen & sWord27||14840  |                                    sYen & sWord27
14864  |                            Case cMyr             ||14841  |                            Case cMyr             
14865  |                                .Cells(39, 13).Val||14842  |                                .Cells(39, 13).Val
14866  |                                    sWord26 & CStr||14843  |                                    sWord26 & CStr
14867  |                                    sMyr & sWord27||14844  |                                    sMyr & sWord27
14868  |                            Case cNzd             ||14845  |                            Case cNzd             
14869  |                                .Cells(39, 13).Val||14846  |                                .Cells(39, 13).Val
14870  |                                    sWord26 & CStr||14847  |                                    sWord26 & CStr
14871  |                                    sNzd & sWord27||14848  |                                    sNzd & sWord27
14872  |                            Case cSek             ||14849  |                            Case cSek             
14873  |                                .Cells(39, 13).Val||14850  |                                .Cells(39, 13).Val
14874  |                                    sWord26 & CStr||14851  |                                    sWord26 & CStr
14875  |                                    sSek & sWord27||14852  |                                    sSek & sWord27
14876  |                            Case cSgd             ||14853  |                            Case cSgd             
14877  |                                .Cells(39, 13).Val||14854  |                                .Cells(39, 13).Val
14878  |                                    sWord26 & CStr||14855  |                                    sWord26 & CStr
14879  |                                    sSgd & sWord27||14856  |                                    sSgd & sWord27
14880  |                            Case cUsd             ||14857  |                            Case cUsd             
14881  |                                .Cells(39, 13).Val||14858  |                                .Cells(39, 13).Val
14882  |                                    sWord26 & CStr||14859  |                                    sWord26 & CStr
14883  |                                    sUsd & sWord27||14860  |                                    sUsd & sWord27
14884  |                            Case cNok             ||14861  |                            Case cNok             
14885  |                                .Cells(39, 13).Val||14862  |                                .Cells(39, 13).Val
14886  |                                    sWord26 & CStr||14863  |                                    sWord26 & CStr
14887  |                                    sNok & sWord27||14864  |                                    sNok & sWord27
14888  |                        End Select                ||14865  |                        End Select                
14889  |                        '年率　累積値セット       ||14866  |                        '年率　累積値セット       
14890  |                        TotalRate = CCur(gbuOtherC||14867  |                        TotalRate = CCur(gbuOtherC
14891  |                    ElseIf i = UBound(gbuOtherComR||14868  |                    ElseIf i = UBound(gbuOtherComR
14892  |                        If UBound(gbuOtherComRateG||14869  |                        If UBound(gbuOtherComRateG
14893  |                            '年率最終行           ||14870  |                            '年率最終行           
14894  |                            '前半金額部分         ||14871  |                            '前半金額部分         
14895  |                            .Cells(39 + i + 2, 23)||14872  |                            .Cells(39 + i + 2, 23)
14896  |                            If gbuMGetUPDRec.N(lRe||14873  |                            If gbuMGetUPDRec.N(lRe
14897  |                                .Cells(39 + i + 2,||14874  |                                .Cells(39 + i + 2,
14898  |                            Else                  ||14875  |                            Else                  
14899  |                                .Cells(39 + i + 2,||14876  |                                .Cells(39 + i + 2,
14900  |                            End If                ||14877  |                            End If                
14901  |                            .Cells(39 + i + 2, 23)||14878  |                            .Cells(39 + i + 2, 23)
14902  |                            '後半の文言           ||14879  |                            '後半の文言           
14903  |                            Select Case gbuMGetUPD||14880  |                            Select Case gbuMGetUPD
14904  |                                Case cAud         ||14881  |                                Case cAud         
14905  |                                    .Cells(39 + i ||14882  |                                    .Cells(39 + i 
14906  |                                        sAud & sWo||14883  |                                        sAud & sWo
14907  |                                Case cCad         ||14884  |                                Case cCad         
14908  |                                    .Cells(39 + i ||14885  |                                    .Cells(39 + i 
14909  |                                        sCad & sWo||14886  |                                        sCad & sWo
14910  |                                Case cChf         ||14887  |                                Case cChf         
14911  |                                    .Cells(39 + i ||14888  |                                    .Cells(39 + i 
14912  |                                        sChf & sWo||14889  |                                        sChf & sWo
14913  |                                Case cEur         ||14890  |                                Case cEur         
14914  |                                    .Cells(39 + i ||14891  |                                    .Cells(39 + i 
14915  |                                        sEur & sWo||14892  |                                        sEur & sWo
14916  |                                Case cGbp         ||14893  |                                Case cGbp         
14917  |                                    .Cells(39 + i ||14894  |                                    .Cells(39 + i 
14918  |                                        sGbp & sWo||14895  |                                        sGbp & sWo
14919  |                                Case cHkd         ||14896  |                                Case cHkd         
14920  |                                    .Cells(39 + i ||14897  |                                    .Cells(39 + i 
14921  |                                        sHkd & sWo||14898  |                                        sHkd & sWo
14922  |                                Case cJpy         ||14899  |                                Case cJpy         
14923  |                                    .Cells(39 + i ||14900  |                                    .Cells(39 + i 
14924  |                                        sYen & sWo||14901  |                                        sYen & sWo
14925  |                                Case cMyr         ||14902  |                                Case cMyr         
14926  |                                    .Cells(39 + i ||14903  |                                    .Cells(39 + i 
14927  |                                        sMyr & sWo||14904  |                                        sMyr & sWo
14928  |                                Case cNzd         ||14905  |                                Case cNzd         
14929  |                                    .Cells(39 + i ||14906  |                                    .Cells(39 + i 
14930  |                                        sNzd & sWo||14907  |                                        sNzd & sWo
14931  |                                Case cSek         ||14908  |                                Case cSek         
14932  |                                    .Cells(39 + i ||14909  |                                    .Cells(39 + i 
14933  |                                        sSek & sWo||14910  |                                        sSek & sWo
14934  |                                Case cSgd         ||14911  |                                Case cSgd         
14935  |                                    .Cells(39 + i ||14912  |                                    .Cells(39 + i 
14936  |                                        sSgd & sWo||14913  |                                        sSgd & sWo
14937  |                                Case cUsd         ||14914  |                                Case cUsd         
14938  |                                    .Cells(39 + i ||14915  |                                    .Cells(39 + i 
14939  |                                        sUsd & sWo||14916  |                                        sUsd & sWo
14940  |                                Case cNok         ||14917  |                                Case cNok         
14941  |                                    .Cells(39 + i ||14918  |                                    .Cells(39 + i 
14942  |                                        sNok & sWo||14919  |                                        sNok & sWo
14943  |                            End Select            ||14920  |                            End Select            
14944  |                        Else                      ||14921  |                        Else                      
14945  |                            '年率最終行           ||14922  |                            '年率最終行           
14946  |                            '前半金額部分         ||14923  |                            '前半金額部分         
14947  |                            .Cells(39 + i + 1, 23)||14924  |                            .Cells(39 + i + 1, 23)
14948  |                            If gbuMGetUPDRec.N(lRe||14925  |                            If gbuMGetUPDRec.N(lRe
14949  |                                .Cells(39 + i + 1,||14926  |                                .Cells(39 + i + 1,
14950  |                            Else                  ||14927  |                            Else                  
14951  |                                .Cells(39 + i + 1,||14928  |                                .Cells(39 + i + 1,
14952  |                            End If                ||14929  |                            End If                
14953  |                            .Cells(39 + i + 1, 23)||14930  |                            .Cells(39 + i + 1, 23)
14954  |                            '後半の文言           ||14931  |                            '後半の文言           
14955  |                            Select Case gbuMGetUPD||14932  |                            Select Case gbuMGetUPD
14956  |                                Case cAud         ||14933  |                                Case cAud         
14957  |                                    .Cells(39 + i ||14934  |                                    .Cells(39 + i 
14958  |                                        sAud & sWo||14935  |                                        sAud & sWo
14959  |                                Case cCad         ||14936  |                                Case cCad         
14960  |                                    .Cells(39 + i ||14937  |                                    .Cells(39 + i 
14961  |                                        sCad & sWo||14938  |                                        sCad & sWo
14962  |                                Case cChf         ||14939  |                                Case cChf         
14963  |                                    .Cells(39 + i ||14940  |                                    .Cells(39 + i 
14964  |                                        sChf & sWo||14941  |                                        sChf & sWo
14965  |                                Case cEur         ||14942  |                                Case cEur         
14966  |                                    .Cells(39 + i ||14943  |                                    .Cells(39 + i 
14967  |                                        sEur & sWo||14944  |                                        sEur & sWo
14968  |                                Case cGbp         ||14945  |                                Case cGbp         
14969  |                                    .Cells(39 + i ||14946  |                                    .Cells(39 + i 
14970  |                                        sGbp & sWo||14947  |                                        sGbp & sWo
14971  |                                Case cHkd         ||14948  |                                Case cHkd         
14972  |                                    .Cells(39 + i ||14949  |                                    .Cells(39 + i 
14973  |                                        sHkd & sWo||14950  |                                        sHkd & sWo
14974  |                                Case cJpy         ||14951  |                                Case cJpy         
14975  |                                    .Cells(39 + i ||14952  |                                    .Cells(39 + i 
14976  |                                        sYen & sWo||14953  |                                        sYen & sWo
14977  |                                Case cMyr         ||14954  |                                Case cMyr         
14978  |                                    .Cells(39 + i ||14955  |                                    .Cells(39 + i 
14979  |                                        sMyr & sWo||14956  |                                        sMyr & sWo
14980  |                                Case cNzd         ||14957  |                                Case cNzd         
14981  |                                    .Cells(39 + i ||14958  |                                    .Cells(39 + i 
14982  |                                        sNzd & sWo||14959  |                                        sNzd & sWo
14983  |                                Case cSek         ||14960  |                                Case cSek         
14984  |                                    .Cells(39 + i ||14961  |                                    .Cells(39 + i 
14985  |                                        sSek & sWo||14962  |                                        sSek & sWo
14986  |                                Case cSgd         ||14963  |                                Case cSgd         
14987  |                                    .Cells(39 + i ||14964  |                                    .Cells(39 + i 
14988  |                                        sSgd & sWo||14965  |                                        sSgd & sWo
14989  |                                Case cUsd         ||14966  |                                Case cUsd         
14990  |                                    .Cells(39 + i ||14967  |                                    .Cells(39 + i 
14991  |                                        sUsd & sWo||14968  |                                        sUsd & sWo
14992  |                                Case cNok         ||14969  |                                Case cNok         
14993  |                                    .Cells(39 + i ||14970  |                                    .Cells(39 + i 
14994  |                                        sNok & sWo||14971  |                                        sNok & sWo
14995  |                            End Select            ||14972  |                            End Select            
14996  |                        End If                    ||14973  |                        End If                    
14997  |                    Else                          ||14974  |                    Else                          
14998  |                        '年率2行目以降            ||14975  |                        '年率2行目以降            
14999  |                        '前半金額部分             ||14976  |                        '前半金額部分             
15000  |                        .Cells(39 + i + 1, 23).Num||14977  |                        .Cells(39 + i + 1, 23).Num
15001  |                        If gbuMGetUPDRec.N(lRecIdx||14978  |                        If gbuMGetUPDRec.N(lRecIdx
15002  |                            .Cells(39 + i + 1, 23)||14979  |                            .Cells(39 + i + 1, 23)
15003  |                        Else                      ||14980  |                        Else                      
15004  |                            .Cells(39 + i + 1, 23)||14981  |                            .Cells(39 + i + 1, 23)
15005  |                        End If                    ||14982  |                        End If                    
15006  |                        .Cells(39 + i + 1, 23).Hor||14983  |                        .Cells(39 + i + 1, 23).Hor
15007  |                        '年率　累積値セット       ||14984  |                        '年率　累積値セット       
15008  |                        TotalRate = TotalRate + CC||14985  |                        TotalRate = TotalRate + CC
15009  |                        '後半の文言               ||14986  |                        '後半の文言               
15010  |                        Select Case gbuMGetUPDRec.||14987  |                        Select Case gbuMGetUPDRec.
15011  |                            Case cAud             ||14988  |                            Case cAud             
15012  |                                .Cells(39 + i + 1,||14989  |                                .Cells(39 + i + 1,
15013  |                                    sAud & sWord29||14990  |                                    sAud & sWord29
15014  |                                    Format(gbuOthe||14991  |                                    Format(gbuOthe
15015  |                            Case cCad             ||14992  |                            Case cCad             
15016  |                                .Cells(39 + i + 1,||14993  |                                .Cells(39 + i + 1,
15017  |                                    sCad & sWord29||14994  |                                    sCad & sWord29
15018  |                                    Format(gbuOthe||14995  |                                    Format(gbuOthe
15019  |                            Case cChf             ||14996  |                            Case cChf             
15020  |                                .Cells(39 + i + 1,||14997  |                                .Cells(39 + i + 1,
15021  |                                    sChf & sWord29||14998  |                                    sChf & sWord29
15022  |                                    Format(gbuOthe||14999  |                                    Format(gbuOthe
15023  |                            Case cEur             ||15000  |                            Case cEur             
15024  |                                .Cells(39 + i + 1,||15001  |                                .Cells(39 + i + 1,
15025  |                                    sEur & sWord29||15002  |                                    sEur & sWord29
15026  |                                    Format(gbuOthe||15003  |                                    Format(gbuOthe
15027  |                            Case cGbp             ||15004  |                            Case cGbp             
15028  |                                .Cells(39 + i + 1,||15005  |                                .Cells(39 + i + 1,
15029  |                                    sGbp & sWord29||15006  |                                    sGbp & sWord29
15030  |                                    Format(gbuOthe||15007  |                                    Format(gbuOthe
15031  |                            Case cHkd             ||15008  |                            Case cHkd             
15032  |                                .Cells(39 + i + 1,||15009  |                                .Cells(39 + i + 1,
15033  |                                    sHkd & sWord29||15010  |                                    sHkd & sWord29
15034  |                                    Format(gbuOthe||15011  |                                    Format(gbuOthe
15035  |                            Case cJpy             ||15012  |                            Case cJpy             
15036  |                                .Cells(39 + i + 1,||15013  |                                .Cells(39 + i + 1,
15037  |                                    sYen & sWord29||15014  |                                    sYen & sWord29
15038  |                                    Format(gbuOthe||15015  |                                    Format(gbuOthe
15039  |                            Case cMyr             ||15016  |                            Case cMyr             
15040  |                                .Cells(39 + i + 1,||15017  |                                .Cells(39 + i + 1,
15041  |                                    sMyr & sWord29||15018  |                                    sMyr & sWord29
15042  |                                    Format(gbuOthe||15019  |                                    Format(gbuOthe
15043  |                            Case cNzd             ||15020  |                            Case cNzd             
15044  |                                .Cells(39 + i + 1,||15021  |                                .Cells(39 + i + 1,
15045  |                                    sNzd & sWord29||15022  |                                    sNzd & sWord29
15046  |                                    Format(gbuOthe||15023  |                                    Format(gbuOthe
15047  |                            Case cSek             ||15024  |                            Case cSek             
15048  |                                .Cells(39 + i + 1,||15025  |                                .Cells(39 + i + 1,
15049  |                                    sSek & sWord29||15026  |                                    sSek & sWord29
15050  |                                    Format(gbuOthe||15027  |                                    Format(gbuOthe
15051  |                            Case cSgd             ||15028  |                            Case cSgd             
15052  |                                .Cells(39 + i + 1,||15029  |                                .Cells(39 + i + 1,
15053  |                                    sSgd & sWord29||15030  |                                    sSgd & sWord29
15054  |                                    Format(gbuOthe||15031  |                                    Format(gbuOthe
15055  |                            Case cUsd             ||15032  |                            Case cUsd             
15056  |                                .Cells(39 + i + 1,||15033  |                                .Cells(39 + i + 1,
15057  |                                    sUsd & sWord29||15034  |                                    sUsd & sWord29
15058  |                                    Format(gbuOthe||15035  |                                    Format(gbuOthe
15059  |                            Case cNok             ||15036  |                            Case cNok             
15060  |                                .Cells(39 + i + 1,||15037  |                                .Cells(39 + i + 1,
15061  |                                    sNok & sWord29||15038  |                                    sNok & sWord29
15062  |                                    Format(gbuOthe||15039  |                                    Format(gbuOthe
15063  |                        End Select                ||15040  |                        End Select                
15064  |                    End If                        ||15041  |                    End If                        
15065  |                Next i                            ||15042  |                Next i                            
15066  |            End If                                ||15043  |            End If                                
15067  |        End If                                    ||15044  |        End If                                    
15068  |    End With                                      ||15045  |    End With                                      
15069  |End Sub                                           ||15046  |End Sub                                           
15070  |                                                  ||15047  |                                                  
15071  |'=================================================||15048  |'=================================================
15072  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbExcelChgRateSheetOut       ||15049  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbExcelChgRateSheetOut       
15073  |'機能            :   確認書の料率変更履歴出力     ||15050  |'機能            :   確認書の料率変更履歴出力     
15074  |'                                                 ||15051  |'                                                 
15075  |'日付               担当　              修正内容  ||15052  |'日付               担当　              修正内容  
15076  |'-------------------------------------------------||15053  |'-------------------------------------------------
15077  |'2006/07/19         K.Furuya <SRA>     新規作成(期||15054  |'2006/07/19         K.Furuya <SRA>     新規作成(期
15078  |'=================================================||15055  |'=================================================
15079  |Private Sub sbExcelChgRateSheetOut( _             ||15056  |Private Sub sbExcelChgRateSheetOut( _             
15080  |    ByVal sGetAccCode As String, _                ||15057  |    ByVal sGetAccCode As String, _                
15081  |    ByVal TotalRate As Currency, _                ||15058  |    ByVal TotalRate As Currency, _                
15082  |    ByVal lRecIdx As Long, _                      ||15059  |    ByVal lRecIdx As Long, _                      
15083  |    ByVal StartDate As Date, _                    ||15060  |    ByVal StartDate As Date, _                    
15084  |    ByVal EndDate As Date, _                      ||15061  |    ByVal EndDate As Date, _                      
15085  |    ByVal dlngMeisyoSu As Integer, _              ||15062  |    ByVal dlngMeisyoSu As Integer, _              
15086  |    ByVal NavGetFlg As String _                   ||15063  |    ByVal NavGetFlg As String _                   
15087  |    )                                             ||15064  |    )                                             
15088  |    Dim i       As Integer                        ||15065  |    Dim i       As Integer                        
15089  |    Dim J       As Integer                        ||15066  |    Dim J       As Integer                        
15090  |    Dim Idx_i   As Integer                        ||15067  |    Dim Idx_i   As Integer                        
15091  |    Dim Idx_j   As Integer                        ||15068  |    Dim Idx_j   As Integer                        
15092  |    Dim Add_i   As Integer                        ||15069  |    Dim Add_i   As Integer                        
15093  |    Dim PgIndx  As Integer                        ||15070  |    Dim PgIndx  As Integer                        
15094  |    Dim RateCnt As Integer                        ||15071  |    Dim RateCnt As Integer                        
15095  |    Dim AddRateCnt As Integer                     ||15072  |    Dim AddRateCnt As Integer                     
15096  |    Dim iPage   As Integer                        ||15073  |    Dim iPage   As Integer                        
15097  |    Dim GenPage As Integer                        ||15074  |    Dim GenPage As Integer                        
15098  |    Dim iAmari  As Integer                        ||15075  |    Dim iAmari  As Integer                        
15099  |    Dim SetPoint As Integer                       ||15076  |    Dim SetPoint As Integer                       
15100  |    Dim StartLine As Integer                      ||15077  |    Dim StartLine As Integer                      
15101  |    Const StartPoint As Integer = 12              ||15078  |    Const StartPoint As Integer = 12              
15102  |    Const FixedLine As Integer = 6                ||15079  |    Const FixedLine As Integer = 6                
15103  |    Const DivideLine As Integer = 4               ||15080  |    Const DivideLine As Integer = 4               
15104  |    Const KikanLine As Integer = 1                ||15081  |    Const KikanLine As Integer = 1                
15105  |    Const AddLine As Integer = 2                  ||15082  |    Const AddLine As Integer = 2                  
15106  |                                                  ||15083  |                                                  
15107  |                                                  ||15084  |                                                  
15108  |    RateCnt = 0                                   ||15085  |    RateCnt = 0                                   
15109  |                                                  ||15086  |                                                  
15110  |    If gbuMGetUPDRec.N(lRecIdx).MGET_other_rate_ru||15087  |    If gbuMGetUPDRec.N(lRecIdx).MGET_other_rate_ru
15111  |        For i = LBound(gtypOtherComRec) To UBound(||15088  |        For i = LBound(gtypOtherComRec) To UBound(
15112  |            For J = LBound(gtypOtherComRec(i).APPL||15089  |            For J = LBound(gtypOtherComRec(i).APPL
15113  |                '料率の数を積算                   ||15090  |                '料率の数を積算                   
15114  |                RateCnt = RateCnt + 1             ||15091  |                RateCnt = RateCnt + 1             
15115  |            Next J                                ||15092  |            Next J                                
15116  |            If i = UBound(gtypOtherComRec) Then   ||15093  |            If i = UBound(gtypOtherComRec) Then   
15117  |                RateCnt = RateCnt + AddLine       ||15094  |                RateCnt = RateCnt + AddLine       
15118  |            Else                                  ||15095  |            Else                                  
15119  |                RateCnt = RateCnt + FixedLine + Ad||15096  |                RateCnt = RateCnt + FixedLine + Ad
15120  |            End If                                ||15097  |            End If                                
15121  |        Next i                                    ||15098  |        Next i                                    
15122  |    Else                                          ||15099  |    Else                                          
15123  |        For i = LBound(gtypOtherComRec) To UBound(||15100  |        For i = LBound(gtypOtherComRec) To UBound(
15124  |            For J = LBound(gtypOtherComRec(i).APPL||15101  |            For J = LBound(gtypOtherComRec(i).APPL
15125  |                '料率の数を積算                   ||15102  |                '料率の数を積算                   
15126  |                RateCnt = RateCnt + 1             ||15103  |                RateCnt = RateCnt + 1             
15127  |            Next J                                ||15104  |            Next J                                
15128  |            If i = UBound(gtypOtherComRec) Then   ||15105  |            If i = UBound(gtypOtherComRec) Then   
15129  |                RateCnt = RateCnt + AddLine       ||15106  |                RateCnt = RateCnt + AddLine       
15130  |            Else                                  ||15107  |            Else                                  
15131  |                RateCnt = RateCnt + DivideLine + A||15108  |                RateCnt = RateCnt + DivideLine + A
15132  |            End If                                ||15109  |            End If                                
15133  |        Next i                                    ||15110  |        Next i                                    
15134  |    End If                                        ||15111  |    End If                                        
15135  |                                                  ||15112  |                                                  
15136  |    '頁数を計算する                               ||15113  |    '頁数を計算する                               
15137  |    iPage = RateCnt \ 51 '51は有効行数            ||15114  |    iPage = RateCnt \ 51 '51は有効行数            
15138  |    '頁が割切れるか計算する                       ||15115  |    '頁が割切れるか計算する                       
15139  |    iAmari = RateCnt Mod 51                       ||15116  |    iAmari = RateCnt Mod 51                       
15140  |    '頁が割切れない場合は一頁増やす               ||15117  |    '頁が割切れない場合は一頁増やす               
15141  |    If iAmari <> 0 Then                           ||15118  |    If iAmari <> 0 Then                           
15142  |        iPage = iPage + 1                         ||15119  |        iPage = iPage + 1                         
15143  |    End If                                        ||15120  |    End If                                        
15144  |                                                  ||15121  |                                                  
15145  |    'ループの開始ポジション変数を初期化           ||15122  |    'ループの開始ポジション変数を初期化           
15146  |    SetPoint = 0                                  ||15123  |    SetPoint = 0                                  
15147  |    'ループ変数のインクリメント変数を初期化       ||15124  |    'ループ変数のインクリメント変数を初期化       
15148  |    Add_i = 0                                     ||15125  |    Add_i = 0                                     
15149  |    'シート番号を初期化                           ||15126  |    'シート番号を初期化                           
15150  |    gTotalDnavCnt = 0                             ||15127  |    gTotalDnavCnt = 0                             
15151  |                                                  ||15128  |                                                  
15152  |    For PgIndx = 1 To iPage                       ||15129  |    For PgIndx = 1 To iPage                       
15153  |        'ルール単位の料率文言の行数取得変数の初期 ||15130  |        'ルール単位の料率文言の行数取得変数の初期 
15154  |        RateCnt = StartPoint                      ||15131  |        RateCnt = StartPoint                      
15155  |        AddRateCnt = 0                            ||15132  |        AddRateCnt = 0                            
15156  |                                                  ||15133  |                                                  
15157  |                                                  ||15134  |                                                  
15158  |        'スタート行をセット                       ||15135  |        'スタート行をセット                       
15159  |        StartLine = StartPoint                    ||15136  |        StartLine = StartPoint                    
15160  |                                                  ||15137  |                                                  
15161  |        xlBook.Worksheets.Add after:=xlBook.Sheets||15138  |        xlBook.Worksheets.Add after:=xlBook.Sheets
15162  |        gProcessCnt = gProcessCnt + 1             ||15139  |        gProcessCnt = gProcessCnt + 1             
15163  |        Set xlSheet = xlBook.Sheets(gProcessCnt)  ||15140  |        Set xlSheet = xlBook.Sheets(gProcessCnt)  
15164  |                                                  ||15141  |                                                  
15165  |        'Excelフォーマットを調整                  ||15142  |        'Excelフォーマットを調整                  
15166  |        xlSheet.Cells.ColumnWidth = 1             ||15143  |        xlSheet.Cells.ColumnWidth = 1             
15167  |        xlSheet.Cells.Font.Size = 11              ||15144  |        xlSheet.Cells.Font.Size = 11              
15168  |        'シート名を設定(日次NAV一覧**)            ||15145  |        'シート名を設定(日次NAV一覧**)            
15169  |                                                  ||15146  |                                                  
15170  |        If dstrOldAccCode = sGetAccCode Then      ||15147  |        If dstrOldAccCode = sGetAccCode Then      
15171  |            gTotalDnavCnt = gTotalDnavCnt + 1     ||15148  |            gTotalDnavCnt = gTotalDnavCnt + 1     
15172  |        Else                                      ||15149  |        Else                                      
15173  |            gTotalDnavCnt = 1                     ||15150  |            gTotalDnavCnt = 1                     
15174  |            dstrOldAccCode = sGetAccCode          ||15151  |            dstrOldAccCode = sGetAccCode          
15175  |        End If                                    ||15152  |        End If                                    
15176  |        'gTotalCnt = gTotalCnt + 1                ||15153  |        'gTotalCnt = gTotalCnt + 1                
15177  |        'xlBook.Sheets(gProcessCnt).Name = sWord53||15154  |        'xlBook.Sheets(gProcessCnt).Name = sWord53
15178  |        '複数ページの場合                         ||15155  |        '複数ページの場合                         
15179  |        If iPage > 1 Then                         ||15156  |        If iPage > 1 Then                         
15180  |            xlBook.Sheets(gProcessCnt).Name = sWor||15157  |            xlBook.Sheets(gProcessCnt).Name = sWor
15181  |        Else                                      ||15158  |        Else                                      
15182  |            xlBook.Sheets(gProcessCnt).Name = sWor||15159  |            xlBook.Sheets(gProcessCnt).Name = sWor
15183  |        End If                                    ||15160  |        End If                                    
15184  |        'シートの余白を設定                       ||15161  |        'シートの余白を設定                       
15185  |        xlSheet.PageSetup.TopMargin = Application.||15162  |        xlSheet.PageSetup.TopMargin = Application.
15186  |        xlSheet.PageSetup.BottomMargin = Applicati||15163  |        xlSheet.PageSetup.BottomMargin = Applicati
15187  |        xlSheet.PageSetup.LeftMargin = Application||15164  |        xlSheet.PageSetup.LeftMargin = Application
15188  |        xlSheet.PageSetup.RightMargin = Applicatio||15165  |        xlSheet.PageSetup.RightMargin = Applicatio
15189  |                                                  ||15166  |                                                  
15190  |        DoEvents                                  ||15167  |        DoEvents                                  
15191  |                                                  ||15168  |                                                  
15192  |                                                  ||15169  |                                                  
15193  |        With xlSheet                              ||15170  |        With xlSheet                              
15194  |            '題目                                 ||15171  |            '題目                                 
15195  |            .Cells(5, 1).Value = sWord53          ||15172  |            .Cells(5, 1).Value = sWord53          
15196  |            .Cells(5, 1).Font.Size = 14           ||15173  |            .Cells(5, 1).Font.Size = 14           
15197  |            .Range("A5:BG5").HorizontalAlignment =||15174  |            .Range("A5:BG5").HorizontalAlignment =
15198  |            '出力日付                             ||15175  |            '出力日付                             
15199  |            If RTrim(txtSysOutDate.Text) = "" Then||15176  |            If RTrim(txtSysOutDate.Text) = "" Then
15200  |                .Cells(3, 50).Value = sWord34     ||15177  |                .Cells(3, 50).Value = sWord34     
15201  |                .Cells(3, 50).HorizontalAlignment ||15178  |                .Cells(3, 50).HorizontalAlignment 
15202  |            Else                                  ||15179  |            Else                                  
15203  |                .Cells(3, 43).Value = CStr(Format(||15180  |                .Cells(3, 43).Value = CStr(Format(
15204  |            End If                                ||15181  |            End If                                
15205  |            'ファンド名                           ||15182  |            'ファンド名                           
15206  |            .Cells(7, 2).Value = sWord4           ||15183  |            .Cells(7, 2).Value = sWord4           
15207  |            .Cells(7, 12).Value = sWord19         ||15184  |            .Cells(7, 12).Value = sWord19         
15208  |            .Cells(7, 14).NumberFormatLocal = "@" ||15185  |            .Cells(7, 14).NumberFormatLocal = "@" 
15209  |            .Cells(7, 14).Value = gbuMGetUPDRec.N(||15186  |            .Cells(7, 14).Value = gbuMGetUPDRec.N(
15210  |            'ファンドコード                       ||15187  |            'ファンドコード                       
15211  |            .Cells(8, 2).Value = sWord4_2         ||15188  |            .Cells(8, 2).Value = sWord4_2         
15212  |            .Cells(8, 12).Value = sWord19         ||15189  |            .Cells(8, 12).Value = sWord19         
15213  |            .Cells(8, 14).NumberFormatLocal = "@" ||15190  |            .Cells(8, 14).NumberFormatLocal = "@" 
15214  |            .Cells(8, 14).Value = sGetAccCode     ||15191  |            .Cells(8, 14).Value = sGetAccCode     
15215  |                                                  ||15192  |                                                  
15216  |            '計算期間                             ||15193  |            '計算期間                             
15217  |            .Cells(10, 2).Value = sWord5          ||15194  |            .Cells(10, 2).Value = sWord5          
15218  |            .Cells(10, 12).Value = sWord19        ||15195  |            .Cells(10, 12).Value = sWord19        
15219  |            '名称許諾料計算で日次(休日無し)       ||15196  |            '名称許諾料計算で日次(休日無し)       
15220  |            If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c||15197  |            If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c
15221  |            And gbuMGetUPDRec.N(lRecIdx).MGET_nav_||15198  |            And gbuMGetUPDRec.N(lRecIdx).MGET_nav_
15222  |                .Cells(10, 14).Value = _          ||15199  |                .Cells(10, 14).Value = _          
15223  |                    CStr(Format(StartDate, "YYYY年||15200  |                    CStr(Format(StartDate, "YYYY年
15224  |            Else                                  ||15201  |            Else                                  
15225  |                .Cells(10, 14).Value = _          ||15202  |                .Cells(10, 14).Value = _          
15226  |                    CStr(Format(StartDate, "YYYY年||15203  |                    CStr(Format(StartDate, "YYYY年
15227  |            End If                                ||15204  |            End If                                
15228  |            '固定料率                             ||15205  |            '固定料率                             
15229  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||15206  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
15230  |                '年率1行固定                      ||15207  |                '年率1行固定                      
15231  |                For i = SetPoint To UBound(gtypOth||15208  |                For i = SetPoint To UBound(gtypOth
15232  |                                                  ||15209  |                                                  
15233  |                    'ループ変数のインクリメント変 ||15210  |                    'ループ変数のインクリメント変 
15234  |                    Add_i = Add_i + 1             ||15211  |                    Add_i = Add_i + 1             
15235  |                                                  ||15212  |                                                  
15236  |                    For J = LBound(gtypOtherComRec||15213  |                    For J = LBound(gtypOtherComRec
15237  |                    '適用期間                     ||15214  |                    '適用期間                     
15238  |                        .Cells(StartLine, 2).Value||15215  |                        .Cells(StartLine, 2).Value
15239  |                        .Cells(StartLine, 12).Valu||15216  |                        .Cells(StartLine, 12).Valu
15240  |                        '名称許諾料計算で日次(休日||15217  |                        '名称許諾料計算で日次(休日
15241  |                        If Mid(gbuMGetUPDRec.N(lRe||15218  |                        If Mid(gbuMGetUPDRec.N(lRe
15242  |                        And gbuMGetUPDRec.N(lRecId||15219  |                        And gbuMGetUPDRec.N(lRecId
15243  |                            .Cells(StartLine, 14).||15220  |                            .Cells(StartLine, 14).
15244  |                                CStr(Format(gstrDa||15221  |                                CStr(Format(gstrDa
15245  |                                sWord20 & CStr(For||15222  |                                sWord20 & CStr(For
15246  |                                sWord59 & sWord43 ||15223  |                                sWord59 & sWord43 
15247  |                        Else                      ||15224  |                        Else                      
15248  |                            .Cells(StartLine, 14).||15225  |                            .Cells(StartLine, 14).
15249  |                                CStr(Format(gstrDa||15226  |                                CStr(Format(gstrDa
15250  |                                sWord20 & CStr(For||15227  |                                sWord20 & CStr(For
15251  |                                sWord59 & sWord43 ||15228  |                                sWord59 & sWord43 
15252  |                        End If                    ||15229  |                        End If                    
15253  |                    '平均純資産総額               ||15230  |                    '平均純資産総額               
15254  |                        .Cells(StartLine + KikanLi||15231  |                        .Cells(StartLine + KikanLi
15255  |                        .Cells(StartLine + KikanLi||15232  |                        .Cells(StartLine + KikanLi
15256  |                        '計算期間の純資産総額の合 ||15233  |                        '計算期間の純資産総額の合 
15257  |                        .Cells(StartLine + KikanLi||15234  |                        .Cells(StartLine + KikanLi
15258  |                        If gtypOtherComRec(i).APPL||15235  |                        If gtypOtherComRec(i).APPL
15259  |                            .Cells(StartLine + Kik||15236  |                            .Cells(StartLine + Kik
15260  |                        Else                      ||15237  |                        Else                      
15261  |                            .Cells(StartLine + Kik||15238  |                            .Cells(StartLine + Kik
15262  |                        End If                    ||15239  |                        End If                    
15263  |                        .Cells(StartLine + KikanLi||15240  |                        .Cells(StartLine + KikanLi
15264  |                        '計算期間の純資産総額の合 ||15241  |                        '計算期間の純資産総額の合 
15265  |                        .Cells(StartLine + KikanLi||15242  |                        .Cells(StartLine + KikanLi
15266  |                        'NAV区分が '1' の場合（月 ||15243  |                        'NAV区分が '1' の場合（月 
15267  |                        If NavGetFlg = "1" Then   ||15244  |                        If NavGetFlg = "1" Then   
15268  |                            dblValueIn = gtypOther||15245  |                            dblValueIn = gtypOther
15269  |                        '日次の場合               ||15246  |                        '日次の場合               
15270  |                        Else                      ||15247  |                        Else                      
15271  |                            dblValueIn = gtypOther||15248  |                            dblValueIn = gtypOther
15272  |                        End If                    ||15249  |                        End If                    
15273  |                        If gtypOtherComRec(i).APPL||15250  |                        If gtypOtherComRec(i).APPL
15274  |                              Call sbGetRoundValue||15251  |                              Call sbGetRoundValue
15275  |                        Else                      ||15252  |                        Else                      
15276  |                              Call sbGetRoundValue||15253  |                              Call sbGetRoundValue
15277  |                        End If                    ||15254  |                        End If                    
15278  |                        '平均NAV(計算対象NAV)     ||15255  |                        '平均NAV(計算対象NAV)     
15279  |                        If gtypOtherComRec(i).APPL||15256  |                        If gtypOtherComRec(i).APPL
15280  |                            .Cells(StartLine + Kik||15257  |                            .Cells(StartLine + Kik
15281  |                        Else                      ||15258  |                        Else                      
15282  |                            .Cells(StartLine + Kik||15259  |                            .Cells(StartLine + Kik
15283  |                        End If                    ||15260  |                        End If                    
15284  |                        '÷??＝ ,文言             ||15261  |                        '÷??＝ ,文言             
15285  |                        'NAV区分が '1' の場合（月 ||15262  |                        'NAV区分が '1' の場合（月 
15286  |                        If NavGetFlg = "1" Then   ||15263  |                        If NavGetFlg = "1" Then   
15287  |                            .Cells(StartLine + Kik||15264  |                            .Cells(StartLine + Kik
15288  |                        '日次の場合               ||15265  |                        '日次の場合               
15289  |                        Else                      ||15266  |                        Else                      
15290  |                            .Cells(StartLine + Kik||15267  |                            .Cells(StartLine + Kik
15291  |                        End If                    ||15268  |                        End If                    
15292  |                    '年率                         ||15269  |                    '年率                         
15293  |                        .Cells(StartLine + AddLine||15270  |                        .Cells(StartLine + AddLine
15294  |                        .Cells(StartLine + AddLine||15271  |                        .Cells(StartLine + AddLine
15295  |                        .Cells(StartLine + AddLine||15272  |                        .Cells(StartLine + AddLine
15296  |                            sWord30 & Format(gtypO||15273  |                            sWord30 & Format(gtypO
15297  |                        '年率文言の行数をカウント ||15274  |                        '年率文言の行数をカウント 
15298  |                        RateCnt = RateCnt + 2     ||15275  |                        RateCnt = RateCnt + 2     
15299  |                    Next J                        ||15276  |                    Next J                        
15300  |                    '年率文言の行数にスペース行を ||15277  |                    '年率文言の行数にスペース行を 
15301  |                    RateCnt = RateCnt + FixedLine ||15278  |                    RateCnt = RateCnt + FixedLine 
15302  |                                                  ||15279  |                                                  
15303  |                    '次料率の行数を取得する       ||15280  |                    '次料率の行数を取得する       
15304  |                    '配列の要素の最大値までを取得 ||15281  |                    '配列の要素の最大値までを取得 
15305  |                    If i < UBound(gtypOtherComRec)||15282  |                    If i < UBound(gtypOtherComRec)
15306  |                        For Idx_i = i + 1 To i + 1||15283  |                        For Idx_i = i + 1 To i + 1
15307  |                            For Idx_j = LBound(gty||15284  |                            For Idx_j = LBound(gty
15308  |                                '料率の数を積算   ||15285  |                                '料率の数を積算   
15309  |                                AddRateCnt = AddRa||15286  |                                AddRateCnt = AddRa
15310  |                            Next Idx_j            ||15287  |                            Next Idx_j            
15311  |                            AddRateCnt = AddRateCn||15288  |                            AddRateCnt = AddRateCn
15312  |                        Next Idx_i                ||15289  |                        Next Idx_i                
15313  |                    End If                        ||15290  |                    End If                        
15314  |                                                  ||15291  |                                                  
15315  |                    '行数を計算する               ||15292  |                    '行数を計算する               
15316  |                    GenPage = RateCnt + AddRateCnt||15293  |                    GenPage = RateCnt + AddRateCnt
15317  |                                                  ||15294  |                                                  
15318  |                    AddRateCnt = 0                ||15295  |                    AddRateCnt = 0                
15319  |                                                  ||15296  |                                                  
15320  |                    '行数が溢れたら改ページ       ||15297  |                    '行数が溢れたら改ページ       
15321  |                    If conSheetLastLine < GenPage ||15298  |                    If conSheetLastLine < GenPage 
15322  |                        'ループの開始ポジション変 ||15299  |                        'ループの開始ポジション変 
15323  |                        SetPoint = Add_i          ||15300  |                        SetPoint = Add_i          
15324  |                        Exit For                  ||15301  |                        Exit For                  
15325  |                    End If                        ||15302  |                    End If                        
15326  |                                                  ||15303  |                                                  
15327  |                    '次の開始行をセット           ||15304  |                    '次の開始行をセット           
15328  |                    RateCnt = RateCnt + 1         ||15305  |                    RateCnt = RateCnt + 1         
15329  |                    StartLine = RateCnt           ||15306  |                    StartLine = RateCnt           
15330  |                Next i                            ||15307  |                Next i                            
15331  |            '段階料率                             ||15308  |            '段階料率                             
15332  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_o||15309  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_o
15333  |                For i = SetPoint To UBound(gtypOth||15310  |                For i = SetPoint To UBound(gtypOth
15334  |                    'ループ変数のインクリメント変 ||15311  |                    'ループ変数のインクリメント変 
15335  |                    Add_i = Add_i + 1             ||15312  |                    Add_i = Add_i + 1             
15336  |                    TotalRate = 0                 ||15313  |                    TotalRate = 0                 
15337  |                    '適用期間一行目               ||15314  |                    '適用期間一行目               
15338  |                    For J = LBound(gtypOtherComRec||15315  |                    For J = LBound(gtypOtherComRec
15339  |                        If J = 0 Then             ||15316  |                        If J = 0 Then             
15340  |                        '年率1行目                ||15317  |                        '年率1行目                
15341  |                        '適用期間                 ||15318  |                        '適用期間                 
15342  |                            .Cells(StartLine + J, ||15319  |                            .Cells(StartLine + J, 
15343  |                            .Cells(StartLine + J, ||15320  |                            .Cells(StartLine + J, 
15344  |                            '名称許諾料計算で日次(||15321  |                            '名称許諾料計算で日次(
15345  |                            If Mid(gbuMGetUPDRec.N||15322  |                            If Mid(gbuMGetUPDRec.N
15346  |                            And gbuMGetUPDRec.N(lR||15323  |                            And gbuMGetUPDRec.N(lR
15347  |                                .Cells(StartLine +||15324  |                                .Cells(StartLine +
15348  |                                    CStr(Format(gs||15325  |                                    CStr(Format(gs
15349  |                                    sWord20 & CStr||15326  |                                    sWord20 & CStr
15350  |                                    sWord59 & sWor||15327  |                                    sWord59 & sWor
15351  |                            Else                  ||15328  |                            Else                  
15352  |                                .Cells(StartLine +||15329  |                                .Cells(StartLine +
15353  |                                    CStr(Format(gs||15330  |                                    CStr(Format(gs
15354  |                                    sWord20 & CStr||15331  |                                    sWord20 & CStr
15355  |                                    sWord59 & sWor||15332  |                                    sWord59 & sWor
15356  |                            End If                ||15333  |                            End If                
15357  |                        '平均純資産総額           ||15334  |                        '平均純資産総額           
15358  |                            .Cells(StartLine + Kik||15335  |                            .Cells(StartLine + Kik
15359  |                            .Cells(StartLine + Kik||15336  |                            .Cells(StartLine + Kik
15360  |                            '計算期間の純資産総額 ||15337  |                            '計算期間の純資産総額 
15361  |                            .Cells(StartLine + Kik||15338  |                            .Cells(StartLine + Kik
15362  |                            If gtypOtherComRec(i).||15339  |                            If gtypOtherComRec(i).
15363  |                                .Cells(StartLine +||15340  |                                .Cells(StartLine +
15364  |                            Else                  ||15341  |                            Else                  
15365  |                                .Cells(StartLine +||15342  |                                .Cells(StartLine +
15366  |                            End If                ||15343  |                            End If                
15367  |                            .Cells(StartLine + Kik||15344  |                            .Cells(StartLine + Kik
15368  |                            '計算期間の純資産総額 ||15345  |                            '計算期間の純資産総額 
15369  |                            .Cells(StartLine + Kik||15346  |                            .Cells(StartLine + Kik
15370  |                            'NAV区分が '1' の場合 ||15347  |                            'NAV区分が '1' の場合 
15371  |                            If NavGetFlg = "1" The||15348  |                            If NavGetFlg = "1" The
15372  |                                dblValueIn = gtypO||15349  |                                dblValueIn = gtypO
15373  |                            '日次の場合           ||15350  |                            '日次の場合           
15374  |                            Else                  ||15351  |                            Else                  
15375  |                                dblValueIn = gtypO||15352  |                                dblValueIn = gtypO
15376  |                            End If                ||15353  |                            End If                
15377  |                            If gtypOtherComRec(i).||15354  |                            If gtypOtherComRec(i).
15378  |                                  Call sbGetRoundV||15355  |                                  Call sbGetRoundV
15379  |                            Else                  ||15356  |                            Else                  
15380  |                                  Call sbGetRoundV||15357  |                                  Call sbGetRoundV
15381  |                            End If                ||15358  |                            End If                
15382  |                            '平均NAV(計算対象NAV) ||15359  |                            '平均NAV(計算対象NAV) 
15383  |                            If gtypOtherComRec(i).||15360  |                            If gtypOtherComRec(i).
15384  |                                .Cells(StartLine +||15361  |                                .Cells(StartLine +
15385  |                            Else                  ||15362  |                            Else                  
15386  |                                .Cells(StartLine +||15363  |                                .Cells(StartLine +
15387  |                            End If                ||15364  |                            End If                
15388  |                            '÷??＝ ,文言         ||15365  |                            '÷??＝ ,文言         
15389  |                            'NAV区分が '1' の場合 ||15366  |                            'NAV区分が '1' の場合 
15390  |                            If NavGetFlg = "1" The||15367  |                            If NavGetFlg = "1" The
15391  |                                .Cells(StartLine +||15368  |                                .Cells(StartLine +
15392  |                            '日次の場合           ||15369  |                            '日次の場合           
15393  |                            Else                  ||15370  |                            Else                  
15394  |                                .Cells(StartLine +||15371  |                                .Cells(StartLine +
15395  |                            End If                ||15372  |                            End If                
15396  |                        '年率                     ||15373  |                        '年率                     
15397  |                            .Cells(StartLine + Add||15374  |                            .Cells(StartLine + Add
15398  |                            .Cells(StartLine + Add||15375  |                            .Cells(StartLine + Add
15399  |                            Select Case gbuMGetUPD||15376  |                            Select Case gbuMGetUPD
15400  |                                Case cAud         ||15377  |                                Case cAud         
15401  |                                    .Cells(StartLi||15378  |                                    .Cells(StartLi
15402  |                                        sWord26 & ||15379  |                                        sWord26 & 
15403  |                                        sAud & sWo||15380  |                                        sAud & sWo
15404  |                                Case cCad         ||15381  |                                Case cCad         
15405  |                                    .Cells(StartLi||15382  |                                    .Cells(StartLi
15406  |                                        sWord26 & ||15383  |                                        sWord26 & 
15407  |                                        sCad & sWo||15384  |                                        sCad & sWo
15408  |                                Case cChf         ||15385  |                                Case cChf         
15409  |                                    .Cells(StartLi||15386  |                                    .Cells(StartLi
15410  |                                        sWord26 & ||15387  |                                        sWord26 & 
15411  |                                        sChf & sWo||15388  |                                        sChf & sWo
15412  |                                Case cEur         ||15389  |                                Case cEur         
15413  |                                    .Cells(StartLi||15390  |                                    .Cells(StartLi
15414  |                                        sWord26 & ||15391  |                                        sWord26 & 
15415  |                                        sEur & sWo||15392  |                                        sEur & sWo
15416  |                                Case cGbp         ||15393  |                                Case cGbp         
15417  |                                    .Cells(StartLi||15394  |                                    .Cells(StartLi
15418  |                                        sWord26 & ||15395  |                                        sWord26 & 
15419  |                                        sGbp & sWo||15396  |                                        sGbp & sWo
15420  |                                Case cHkd         ||15397  |                                Case cHkd         
15421  |                                    .Cells(StartLi||15398  |                                    .Cells(StartLi
15422  |                                        sWord26 & ||15399  |                                        sWord26 & 
15423  |                                        sHkd & sWo||15400  |                                        sHkd & sWo
15424  |                                Case cJpy         ||15401  |                                Case cJpy         
15425  |                                    .Cells(StartLi||15402  |                                    .Cells(StartLi
15426  |                                        sWord26 & ||15403  |                                        sWord26 & 
15427  |                                        sYen & sWo||15404  |                                        sYen & sWo
15428  |                                Case cMyr         ||15405  |                                Case cMyr         
15429  |                                    .Cells(StartLi||15406  |                                    .Cells(StartLi
15430  |                                        sWord26 & ||15407  |                                        sWord26 & 
15431  |                                        sMyr & sWo||15408  |                                        sMyr & sWo
15432  |                                Case cNzd         ||15409  |                                Case cNzd         
15433  |                                    .Cells(StartLi||15410  |                                    .Cells(StartLi
15434  |                                        sWord26 & ||15411  |                                        sWord26 & 
15435  |                                        sNzd & sWo||15412  |                                        sNzd & sWo
15436  |                                Case cSek         ||15413  |                                Case cSek         
15437  |                                    .Cells(StartLi||15414  |                                    .Cells(StartLi
15438  |                                        sWord26 & ||15415  |                                        sWord26 & 
15439  |                                        sSek & sWo||15416  |                                        sSek & sWo
15440  |                                Case cSgd         ||15417  |                                Case cSgd         
15441  |                                    .Cells(StartLi||15418  |                                    .Cells(StartLi
15442  |                                        sWord26 & ||15419  |                                        sWord26 & 
15443  |                                        sSgd & sWo||15420  |                                        sSgd & sWo
15444  |                                Case cUsd         ||15421  |                                Case cUsd         
15445  |                                    .Cells(StartLi||15422  |                                    .Cells(StartLi
15446  |                                        sWord26 & ||15423  |                                        sWord26 & 
15447  |                                        sUsd & sWo||15424  |                                        sUsd & sWo
15448  |                                Case cNok         ||15425  |                                Case cNok         
15449  |                                    .Cells(StartLi||15426  |                                    .Cells(StartLi
15450  |                                        sWord26 & ||15427  |                                        sWord26 & 
15451  |                                        sNok & sWo||15428  |                                        sNok & sWo
15452  |                            End Select            ||15429  |                            End Select            
15453  |                            '年率　累積値セット   ||15430  |                            '年率　累積値セット   
15454  |                            TotalRate = CCur(gtypO||15431  |                            TotalRate = CCur(gtypO
15455  |                                                  ||15432  |                                                  
15456  |                            '年率文言の行数をカウ ||15433  |                            '年率文言の行数をカウ 
15457  |                            RateCnt = RateCnt + 2 ||15434  |                            RateCnt = RateCnt + 2 
15458  |                        ElseIf J = UBound(gtypOthe||15435  |                        ElseIf J = UBound(gtypOthe
15459  |                            '年率最終行           ||15436  |                            '年率最終行           
15460  |                            '前半金額部分         ||15437  |                            '前半金額部分         
15461  |                            .Cells(StartLine + Add||15438  |                            .Cells(StartLine + Add
15462  |                            If gbuMGetUPDRec.N(lRe||15439  |                            If gbuMGetUPDRec.N(lRe
15463  |                                .Cells(StartLine +||15440  |                                .Cells(StartLine +
15464  |                            Else                  ||15441  |                            Else                  
15465  |                                .Cells(StartLine +||15442  |                                .Cells(StartLine +
15466  |                            End If                ||15443  |                            End If                
15467  |                            .Cells(StartLine + Add||15444  |                            .Cells(StartLine + Add
15468  |                            '後半の文言           ||15445  |                            '後半の文言           
15469  |                            Select Case gbuMGetUPD||15446  |                            Select Case gbuMGetUPD
15470  |                                Case cAud         ||15447  |                                Case cAud         
15471  |                                    .Cells(StartLi||15448  |                                    .Cells(StartLi
15472  |                                        sAud & sWo||15449  |                                        sAud & sWo
15473  |                                Case cCad         ||15450  |                                Case cCad         
15474  |                                    .Cells(StartLi||15451  |                                    .Cells(StartLi
15475  |                                        sCad & sWo||15452  |                                        sCad & sWo
15476  |                                Case cChf         ||15453  |                                Case cChf         
15477  |                                    .Cells(StartLi||15454  |                                    .Cells(StartLi
15478  |                                        sChf & sWo||15455  |                                        sChf & sWo
15479  |                                Case cEur         ||15456  |                                Case cEur         
15480  |                                    .Cells(StartLi||15457  |                                    .Cells(StartLi
15481  |                                        sEur & sWo||15458  |                                        sEur & sWo
15482  |                                Case cGbp         ||15459  |                                Case cGbp         
15483  |                                    .Cells(StartLi||15460  |                                    .Cells(StartLi
15484  |                                        sGbp & sWo||15461  |                                        sGbp & sWo
15485  |                                Case cHkd         ||15462  |                                Case cHkd         
15486  |                                    .Cells(StartLi||15463  |                                    .Cells(StartLi
15487  |                                        sHkd & sWo||15464  |                                        sHkd & sWo
15488  |                                Case cJpy         ||15465  |                                Case cJpy         
15489  |                                    .Cells(StartLi||15466  |                                    .Cells(StartLi
15490  |                                        sYen & sWo||15467  |                                        sYen & sWo
15491  |                                Case cMyr         ||15468  |                                Case cMyr         
15492  |                                    .Cells(StartLi||15469  |                                    .Cells(StartLi
15493  |                                        sMyr & sWo||15470  |                                        sMyr & sWo
15494  |                                Case cNzd         ||15471  |                                Case cNzd         
15495  |                                    .Cells(StartLi||15472  |                                    .Cells(StartLi
15496  |                                        sNzd & sWo||15473  |                                        sNzd & sWo
15497  |                                Case cSek         ||15474  |                                Case cSek         
15498  |                                    .Cells(StartLi||15475  |                                    .Cells(StartLi
15499  |                                        sSek & sWo||15476  |                                        sSek & sWo
15500  |                                Case cSgd         ||15477  |                                Case cSgd         
15501  |                                    .Cells(StartLi||15478  |                                    .Cells(StartLi
15502  |                                        sSgd & sWo||15479  |                                        sSgd & sWo
15503  |                                Case cUsd         ||15480  |                                Case cUsd         
15504  |                                    .Cells(StartLi||15481  |                                    .Cells(StartLi
15505  |                                        sUsd & sWo||15482  |                                        sUsd & sWo
15506  |                                Case cNok         ||15483  |                                Case cNok         
15507  |                                    .Cells(StartLi||15484  |                                    .Cells(StartLi
15508  |                                        sNok & sWo||15485  |                                        sNok & sWo
15509  |                            End Select            ||15486  |                            End Select            
15510  |                            '年率文言の行数をカウ ||15487  |                            '年率文言の行数をカウ 
15511  |                            RateCnt = RateCnt + 1 ||15488  |                            RateCnt = RateCnt + 1 
15512  |                        Else                      ||15489  |                        Else                      
15513  |                            '年率2行目以降        ||15490  |                            '年率2行目以降        
15514  |                            '前半金額部分         ||15491  |                            '前半金額部分         
15515  |                            .Cells(StartLine + Add||15492  |                            .Cells(StartLine + Add
15516  |                            If gbuMGetUPDRec.N(lRe||15493  |                            If gbuMGetUPDRec.N(lRe
15517  |                                .Cells(StartLine +||15494  |                                .Cells(StartLine +
15518  |                            Else                  ||15495  |                            Else                  
15519  |                                .Cells(StartLine +||15496  |                                .Cells(StartLine +
15520  |                            End If                ||15497  |                            End If                
15521  |                            .Cells(StartLine + Add||15498  |                            .Cells(StartLine + Add
15522  |                            '年率　累積値セット   ||15499  |                            '年率　累積値セット   
15523  |                            TotalRate = TotalRate ||15500  |                            TotalRate = TotalRate 
15524  |                            '後半の文言           ||15501  |                            '後半の文言           
15525  |                            Select Case gbuMGetUPD||15502  |                            Select Case gbuMGetUPD
15526  |                                Case cAud         ||15503  |                                Case cAud         
15527  |                                    .Cells(StartLi||15504  |                                    .Cells(StartLi
15528  |                                        sAud & sWo||15505  |                                        sAud & sWo
15529  |                                        Format(gty||15506  |                                        Format(gty
15530  |                                Case cCad         ||15507  |                                Case cCad         
15531  |                                    .Cells(StartLi||15508  |                                    .Cells(StartLi
15532  |                                        sCad & sWo||15509  |                                        sCad & sWo
15533  |                                        Format(gty||15510  |                                        Format(gty
15534  |                                Case cChf         ||15511  |                                Case cChf         
15535  |                                    .Cells(StartLi||15512  |                                    .Cells(StartLi
15536  |                                        sChf & sWo||15513  |                                        sChf & sWo
15537  |                                        Format(gty||15514  |                                        Format(gty
15538  |                                Case cEur         ||15515  |                                Case cEur         
15539  |                                    .Cells(StartLi||15516  |                                    .Cells(StartLi
15540  |                                        sEur & sWo||15517  |                                        sEur & sWo
15541  |                                        Format(gty||15518  |                                        Format(gty
15542  |                                Case cGbp         ||15519  |                                Case cGbp         
15543  |                                    .Cells(StartLi||15520  |                                    .Cells(StartLi
15544  |                                        sGbp & sWo||15521  |                                        sGbp & sWo
15545  |                                        Format(gty||15522  |                                        Format(gty
15546  |                                Case cHkd         ||15523  |                                Case cHkd         
15547  |                                    .Cells(StartLi||15524  |                                    .Cells(StartLi
15548  |                                        sHkd & sWo||15525  |                                        sHkd & sWo
15549  |                                        Format(gty||15526  |                                        Format(gty
15550  |                                Case cJpy         ||15527  |                                Case cJpy         
15551  |                                    .Cells(StartLi||15528  |                                    .Cells(StartLi
15552  |                                        sYen & sWo||15529  |                                        sYen & sWo
15553  |                                        Format(gty||15530  |                                        Format(gty
15554  |                                Case cMyr         ||15531  |                                Case cMyr         
15555  |                                    .Cells(StartLi||15532  |                                    .Cells(StartLi
15556  |                                        sMyr & sWo||15533  |                                        sMyr & sWo
15557  |                                        Format(gty||15534  |                                        Format(gty
15558  |                                Case cNzd         ||15535  |                                Case cNzd         
15559  |                                    .Cells(StartLi||15536  |                                    .Cells(StartLi
15560  |                                        sNzd & sWo||15537  |                                        sNzd & sWo
15561  |                                        Format(gty||15538  |                                        Format(gty
15562  |                                Case cSek         ||15539  |                                Case cSek         
15563  |                                    .Cells(StartLi||15540  |                                    .Cells(StartLi
15564  |                                        sSek & sWo||15541  |                                        sSek & sWo
15565  |                                        Format(gty||15542  |                                        Format(gty
15566  |                                Case cSgd         ||15543  |                                Case cSgd         
15567  |                                    .Cells(StartLi||15544  |                                    .Cells(StartLi
15568  |                                        sSgd & sWo||15545  |                                        sSgd & sWo
15569  |                                        Format(gty||15546  |                                        Format(gty
15570  |                                Case cUsd         ||15547  |                                Case cUsd         
15571  |                                    .Cells(StartLi||15548  |                                    .Cells(StartLi
15572  |                                        sUsd & sWo||15549  |                                        sUsd & sWo
15573  |                                        Format(gty||15550  |                                        Format(gty
15574  |                                Case cNok         ||15551  |                                Case cNok         
15575  |                                    .Cells(StartLi||15552  |                                    .Cells(StartLi
15576  |                                        sNok & sWo||15553  |                                        sNok & sWo
15577  |                                        Format(gty||15554  |                                        Format(gty
15578  |                            End Select            ||15555  |                            End Select            
15579  |                            '年率文言の行数をカウ ||15556  |                            '年率文言の行数をカウ 
15580  |                            RateCnt = RateCnt + 1 ||15557  |                            RateCnt = RateCnt + 1 
15581  |                        End If                    ||15558  |                        End If                    
15582  |                    Next J                        ||15559  |                    Next J                        
15583  |                    '年率文言の行数にスペース行を ||15560  |                    '年率文言の行数にスペース行を 
15584  |                    RateCnt = RateCnt + DivideLine||15561  |                    RateCnt = RateCnt + DivideLine
15585  |                                                  ||15562  |                                                  
15586  |                    '次料率の行数を取得する       ||15563  |                    '次料率の行数を取得する       
15587  |                    '配列の要素の最大値までを取得 ||15564  |                    '配列の要素の最大値までを取得 
15588  |                    If i < UBound(gtypOtherComRec)||15565  |                    If i < UBound(gtypOtherComRec)
15589  |                        For Idx_i = i + 1 To i + 1||15566  |                        For Idx_i = i + 1 To i + 1
15590  |                            For Idx_j = LBound(gty||15567  |                            For Idx_j = LBound(gty
15591  |                                '料率の数を積算   ||15568  |                                '料率の数を積算   
15592  |                                AddRateCnt = AddRa||15569  |                                AddRateCnt = AddRa
15593  |                            Next Idx_j            ||15570  |                            Next Idx_j            
15594  |                            AddRateCnt = AddLine  ||15571  |                            AddRateCnt = AddLine  
15595  |                        Next Idx_i                ||15572  |                        Next Idx_i                
15596  |                    End If                        ||15573  |                    End If                        
15597  |                                                  ||15574  |                                                  
15598  |                    '行数を計算する               ||15575  |                    '行数を計算する               
15599  |                    GenPage = RateCnt + AddRateCnt||15576  |                    GenPage = RateCnt + AddRateCnt
15600  |                                                  ||15577  |                                                  
15601  |                    AddRateCnt = 0                ||15578  |                    AddRateCnt = 0                
15602  |                                                  ||15579  |                                                  
15603  |                    '行数が溢れたら改ページ       ||15580  |                    '行数が溢れたら改ページ       
15604  |                    If conSheetLastLine < GenPage ||15581  |                    If conSheetLastLine < GenPage 
15605  |                        'ループの開始ポジション変 ||15582  |                        'ループの開始ポジション変 
15606  |                        SetPoint = Add_i          ||15583  |                        SetPoint = Add_i          
15607  |                        Exit For                  ||15584  |                        Exit For                  
15608  |                    End If                        ||15585  |                    End If                        
15609  |                    '次の開始行をセット           ||15586  |                    '次の開始行をセット           
15610  |                    RateCnt = RateCnt + 1         ||15587  |                    RateCnt = RateCnt + 1         
15611  |                    StartLine = RateCnt           ||15588  |                    StartLine = RateCnt           
15612  |                Next i                            ||15589  |                Next i                            
15613  |            End If                                ||15590  |            End If                                
15614  |                                                  ||15591  |                                                  
15615  |        End With                                  ||15592  |        End With                                  
15616  |        'A4印刷用に上2行を削除して、プレビュー範囲||15593  |        'A4印刷用に上2行を削除して、プレビュー範囲
15617  |        xlSheet.Rows("1:2").Delete Shift:=xlUp    ||15594  |        xlSheet.Rows("1:2").Delete Shift:=xlUp    
15618  |    Next PgIndx                                   ||15595  |    Next PgIndx                                   
15619  |End Sub                                           ||15596  |End Sub                                           
15620  |                                                  ||15597  |                                                  
15621  |'=================================================||15598  |'=================================================
15622  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelOut_ChangeRate      ||15599  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelOut_ChangeRate      
15623  |'機能            :   確認書のExcel出力(料率変更有 ||15600  |'機能            :   確認書のExcel出力(料率変更有 
15624  |'                                                 ||15601  |'                                                 
15625  |'日付               担当　              修正内容  ||15602  |'日付               担当　              修正内容  
15626  |'-------------------------------------------------||15603  |'-------------------------------------------------
15627  |'2006/08/02         K.Furuya <SRA>     期中料率変 ||15604  |'2006/08/02         K.Furuya <SRA>     期中料率変 
15628  |'                                      fnblExcelOu||15605  |'                                      fnblExcelOu
15629  |'2008/02/20         K.Furuya <SRA>     時価総額基 ||15606  |'2008/02/20         K.Furuya <SRA>     時価総額基 
15630  |'2008/03/26         K.Furuya<SRA>      ファンド決 ||15607  |'2008/03/26         K.Furuya<SRA>      ファンド決 
15631  |'2014/02/19         M.Takada   <SRA>   【管理会計 ||15608  |'2014/02/19         M.Takada   <SRA>   【管理会計 
15632  |'=================================================||15609  |'=================================================
15633  |Private Function fnblExcelOut_ChangeRate( _       ||15610  |Private Function fnblExcelOut_ChangeRate( _       
15634  |    ByVal lRecIdx As Long _                       ||15611  |    ByVal lRecIdx As Long _                       
15635  |) As Boolean                                      ||15612  |) As Boolean                                      
15636  |                                                  ||15613  |                                                  
15637  |                                                  ||15614  |                                                  
15638  |    Dim dStart      As Date     '計算期間　開始日 ||15615  |    Dim dStart      As Date     '計算期間　開始日 
15639  |    Dim dEnd        As Date     '計算期間　終了日 ||15616  |    Dim dEnd        As Date     '計算期間　終了日 
15640  |    Dim sSql        As String                     ||15617  |    Dim sSql        As String                     
15641  |    Dim sCurrencyCode As String '通貨コード(SQL文 ||15618  |    Dim sCurrencyCode As String '通貨コード(SQL文 
15642  |    Dim AccCode     As String   '口座コード(SQL文 ||15619  |    Dim AccCode     As String   '口座コード(SQL文 
15643  |    Dim sDate       As Date     '支払予定日       ||15620  |    Dim sDate       As Date     '支払予定日       
15644  |    Dim sName       As String   '担当者名         ||15621  |    Dim sName       As String   '担当者名         
15645  |    Dim i           As Integer  'カウンター       ||15622  |    Dim i           As Integer  'カウンター       
15646  |    Dim ColNum      As Integer  '部署名コンボボッ ||15623  |    Dim ColNum      As Integer  '部署名コンボボッ 
15647  |    Dim ColWord     As String   '部署名コンボボッ ||15624  |    Dim ColWord     As String   '部署名コンボボッ 
15648  |    Dim iSyouhizei  As Long     '消費税           ||15625  |    Dim iSyouhizei  As Long     '消費税           
15649  |    Dim iRowCnt     As Long     '月末純資産データ ||15626  |    Dim iRowCnt     As Long     '月末純資産データ 
15650  |    Dim TotalNav    As Currency '累積NAV          ||15627  |    Dim TotalNav    As Currency '累積NAV          
15651  |    Dim TotalRate   As Currency '累積閾値         ||15628  |    Dim TotalRate   As Currency '累積閾値         
15652  |    Dim cRate       As Currency '料率             ||15629  |    Dim cRate       As Currency '料率             
15653  |    Dim WorkRate    As Currency '一つ前の累積閾値 ||15630  |    Dim WorkRate    As Currency '一つ前の累積閾値 
15654  |    Dim TotalCom    As Currency '累積投資顧問料   ||15631  |    Dim TotalCom    As Currency '累積投資顧問料   
15655  |    Dim lTaxNum     As Currency '消費税値         ||15632  |    Dim lTaxNum     As Currency '消費税値         
15656  |    Dim lMonthlyPayCom As Currency  '月別支払額   ||15633  |    Dim lMonthlyPayCom As Currency  '月別支払額   
15657  |    Dim lCalcNav    As Currency '計算対象NAV      ||15634  |    Dim lCalcNav    As Currency '計算対象NAV      
15658  |    Dim iCalcNum    As Integer  '計算期間日数     ||15635  |    Dim iCalcNum    As Integer  '計算期間日数     
15659  |    'Excel の Application 変数とエラーをトラップす||15636  |    'Excel の Application 変数とエラーをトラップす
15660  |    Dim iTries      As Integer                    ||15637  |    Dim iTries      As Integer                    
15661  |    Dim strErrCall      As String 'エラー呼出元   ||15638  |    Dim strErrCall      As String 'エラー呼出元   
15662  |    Const conMeModule   As String = "fnblExcelOut_||15639  |    Const conMeModule   As String = "fnblExcelOut_
15663  |    'Excel の Worksheet 削除用カウンタ変数        ||15640  |    'Excel の Worksheet 削除用カウンタ変数        
15664  |    Dim Ws_Cnt      As Integer                    ||15641  |    Dim Ws_Cnt      As Integer                    
15665  |    Dim Ws_Del_Cnt  As Integer                    ||15642  |    Dim Ws_Del_Cnt  As Integer                    
15666  |    Dim Ws_Del_Cnt2 As Integer                    ||15643  |    Dim Ws_Del_Cnt2 As Integer                    
15667  |    Dim ContNo      As String   '契約番号(SQL文作 ||15644  |    Dim ContNo      As String   '契約番号(SQL文作 
15668  |    Dim NavGetCnt   As Long                       ||15645  |    Dim NavGetCnt   As Long                       
15669  |    Dim sGetAccCode As String                     ||15646  |    Dim sGetAccCode As String                     
15670  |    Dim Mnav_Flg    As String                     ||15647  |    Dim Mnav_Flg    As String                     
15671  |    Dim sStart As String            '計算対象　開 ||15648  |    Dim sStart As String            '計算対象　開 
15672  |    Dim sEnd As String              '計算対象　終 ||15649  |    Dim sEnd As String              '計算対象　終 
15673  |    Dim dstrBasedate As String      '基準日用ワー ||15650  |    Dim dstrBasedate As String      '基準日用ワー 
15674  |    Dim dstrCaldate() As String     'カレンダー日 ||15651  |    Dim dstrCaldate() As String     'カレンダー日 
15675  |    Dim ddblDailynav() As Double    '日次NAV用格納||15652  |    Dim ddblDailynav() As Double    '日次NAV用格納
15676  |    Dim dlngCnt As Long             '計算対象期間 ||15653  |    Dim dlngCnt As Long             '計算対象期間 
15677  |    Dim dstrCaldate2 As String      'カレンダー日 ||15654  |    Dim dstrCaldate2 As String      'カレンダー日 
15678  |    Dim dstrBasedate2 As String     '基準日(/編集)||15655  |    Dim dstrBasedate2 As String     '基準日(/編集)
15679  |    Dim dlngDiffdate As Long        'カレンダー日 ||15656  |    Dim dlngDiffdate As Long        'カレンダー日 
15680  |    Dim dintFor As Integer          'For文用変数  ||15657  |    Dim dintFor As Integer          'For文用変数  
15681  |    Dim ddblTtalnav As Double       '日次NAV累積用||15658  |    Dim ddblTtalnav As Double       '日次NAV累積用
15682  |    Dim dstrAvgNav As String                      ||15659  |    Dim dstrAvgNav As String                      
15683  |    Dim ddblNearNav As Double                     ||15660  |    Dim ddblNearNav As Double                     
15684  |    Dim dstrAccCd() As String                     ||15661  |    Dim dstrAccCd() As String                     
15685  |    Dim dstrBsCCd() As String                     ||15662  |    Dim dstrBsCCd() As String                     
15686  |    Dim intRtn      As Integer                    ||15663  |    Dim intRtn      As Integer                    
15687  |    Dim dstrDate         As String                ||15664  |    Dim dstrDate         As String                
15688  |    Dim dstrCurrencyCode As String                ||15665  |    Dim dstrCurrencyCode As String                
15689  |    Dim ddblExchangeRate As Double                ||15666  |    Dim ddblExchangeRate As Double                
15690  |    Dim dintPage    As Integer                    ||15667  |    Dim dintPage    As Integer                    
15691  |    Dim dintPageIni As Integer                    ||15668  |    Dim dintPageIni As Integer                    
15692  |    Dim dintAmari   As Integer                    ||15669  |    Dim dintAmari   As Integer                    
15693  |    Dim dCalDate    As Date                       ||15670  |    Dim dCalDate    As Date                       
15694  |    Dim J           As Integer                    ||15671  |    Dim J           As Integer                    
15695  |    Dim K           As Integer                    ||15672  |    Dim K           As Integer                    
15696  |    Dim L           As Integer                    ||15673  |    Dim L           As Integer                    
15697  |    Dim AvgNav      As Currency                   ||15674  |    Dim AvgNav      As Currency                   
15698  |    Dim dintFor2    As Integer                    ||15675  |    Dim dintFor2    As Integer                    
15699  |    Dim dlngMeisyoSu As Integer                   ||15676  |    Dim dlngMeisyoSu As Integer                   
15700  |    Dim dlngCntsv As Long                         ||15677  |    Dim dlngCntsv As Long                         
15701  |                                                  ||15678  |                                                  
15702  |    '2006/04/12 START K.Furuya 実払管理テーブル更 ||15679  |    '2006/04/12 START K.Furuya 実払管理テーブル更 
15703  |    Dim WkContractNo        As String             ||15680  |    Dim WkContractNo        As String             
15704  |    Dim WkCurCode           As String             ||15681  |    Dim WkCurCode           As String             
15705  |    Dim WkSettlementDate    As String             ||15682  |    Dim WkSettlementDate    As String             
15706  |    Dim WkFixComC           As String             ||15683  |    Dim WkFixComC           As String             
15707  |    Dim WkFixComJ           As String             ||15684  |    Dim WkFixComJ           As String             
15708  |    Dim WkRealComC          As String             ||15685  |    Dim WkRealComC          As String             
15709  |    Dim WkRealComJ          As String             ||15686  |    Dim WkRealComJ          As String             
15710  |    '2006/04/12 END   K.Furuya 実払管理テーブル更 ||15687  |    '2006/04/12 END   K.Furuya 実払管理テーブル更 
15711  |    Dim RuleNoCnt                   As Integer  ' ||15688  |    Dim RuleNoCnt                   As Integer  ' 
15712  |    Dim KityuFlg                    As Boolean  ' ||15689  |    Dim KityuFlg                    As Boolean  ' 
15713  |    Dim ddblNearBabyMotherRate      As Double   ' ||15690  |    Dim ddblNearBabyMotherRate      As Double   ' 
15714  |    Dim MonthlyCnt                  As Long       ||15691  |    Dim MonthlyCnt                  As Long       
15715  |    Dim dblNavTotal                 As Double   ' ||15692  |    Dim dblNavTotal                 As Double   ' 
15716  |    Dim intRange                    As Integer  ' ||15693  |    Dim intRange                    As Integer  ' 
15717  |    Dim strRange                    As String   ' ||15694  |    Dim strRange                    As String   ' 
15718  |    Dim EndFlg                      As Boolean  ' ||15695  |    Dim EndFlg                      As Boolean  ' 
15719  |    Dim SetPoint                    As Integer    ||15696  |    Dim SetPoint                    As Integer    
15720  |    Dim AddPoint                    As Integer    ||15697  |    Dim AddPoint                    As Integer    
15721  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||15698  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
15722  |    Dim WkStart                     As String   ' ||15699  |    Dim WkStart                     As String   ' 
15723  |    Dim StartFlg                    As String   ' ||15700  |    Dim StartFlg                    As String   ' 
15724  |                                                  ||15701  |                                                  
15725  |    '戻り値初期化                                 ||15702  |    '戻り値初期化                                 
15726  |    fnblExcelOut_ChangeRate = False               ||15703  |    fnblExcelOut_ChangeRate = False               
15727  |    i = 0                                         ||15704  |    i = 0                                         
15728  |                                                  ||15705  |                                                  
15729  |On Error Resume Next                              ||15706  |On Error Resume Next                              
15730  |                                                  ||15707  |                                                  
15731  |    'Excelフォーマットを調整                      ||15708  |    'Excelフォーマットを調整                      
15732  |    xlSheet.Cells.ColumnWidth = 1                 ||15709  |    xlSheet.Cells.ColumnWidth = 1                 
15733  |    xlSheet.Cells.Font.Size = 11                  ||15710  |    xlSheet.Cells.Font.Size = 11                  
15734  |                                                  ||15711  |                                                  
15735  |    'シート名を設定(確認書**)                     ||15712  |    'シート名を設定(確認書**)                     
15736  |    '契約毎のシート番号を付番する                 ||15713  |    '契約毎のシート番号を付番する                 
15737  |    'xlBook.Sheets(gProcessCnt).Name = sWord33 & (||15714  |    'xlBook.Sheets(gProcessCnt).Name = sWord33 & (
15738  |    xlBook.Sheets(gProcessCnt).Name = sWord33 & gT||15715  |    xlBook.Sheets(gProcessCnt).Name = sWord33 & gT
15739  |                                                  ||15716  |                                                  
15740  |    'シートの余白を設定                           ||15717  |    'シートの余白を設定                           
15741  |    xlSheet.PageSetup.TopMargin = Application.Inch||15718  |    xlSheet.PageSetup.TopMargin = Application.Inch
15742  |    xlSheet.PageSetup.BottomMargin = Application.I||15719  |    xlSheet.PageSetup.BottomMargin = Application.I
15743  |    xlSheet.PageSetup.LeftMargin = Application.Inc||15720  |    xlSheet.PageSetup.LeftMargin = Application.Inc
15744  |    xlSheet.PageSetup.RightMargin = Application.In||15721  |    xlSheet.PageSetup.RightMargin = Application.In
15745  |                                                  ||15722  |                                                  
15746  |    '総計の出力処理カウンターアップ               ||15723  |    '総計の出力処理カウンターアップ               
15747  |    gTotalProcessCnt = gTotalProcessCnt + 1       ||15724  |    gTotalProcessCnt = gTotalProcessCnt + 1       
15748  |                                                  ||15725  |                                                  
15749  |    DoEvents                                      ||15726  |    DoEvents                                      
15750  |    With xlSheet                                  ||15727  |    With xlSheet                                  
15751  |        '題目                                     ||15728  |        '題目                                     
15752  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||15729  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
15753  |            Case Mid(mstrContractFlag(1), 1, 1)   ||15730  |            Case Mid(mstrContractFlag(1), 1, 1)   
15754  |                .Cells(5, 1).Value = sWord0a      ||15731  |                .Cells(5, 1).Value = sWord0a      
15755  |            Case Mid(mstrContractFlag(2), 1, 1)   ||15732  |            Case Mid(mstrContractFlag(2), 1, 1)   
15756  |                .Cells(5, 1).Value = sWord0b      ||15733  |                .Cells(5, 1).Value = sWord0b      
15757  |            Case Mid(mstrContractFlag(3), 1, 1)   ||15734  |            Case Mid(mstrContractFlag(3), 1, 1)   
15758  |                .Cells(5, 1).Value = sWord0c      ||15735  |                .Cells(5, 1).Value = sWord0c      
15759  |            Case Else                             ||15736  |            Case Else                             
15760  |                MsgBox "契約区分が不正です。", vbC||15737  |                MsgBox "契約区分が不正です。", vbC
15761  |        End Select                                ||15738  |        End Select                                
15762  |        'フォントサイズ                           ||15739  |        'フォントサイズ                           
15763  |        .Cells(5, 1).Font.Size = 14               ||15740  |        .Cells(5, 1).Font.Size = 14               
15764  |        'フォント位置                             ||15741  |        'フォント位置                             
15765  |        .Range("A5:BG5").HorizontalAlignment = xlC||15742  |        .Range("A5:BG5").HorizontalAlignment = xlC
15766  |        '出力日付文字                             ||15743  |        '出力日付文字                             
15767  |        If RTrim(txtSysOutDate.Text) = "" Then    ||15744  |        If RTrim(txtSysOutDate.Text) = "" Then    
15768  |            .Cells(3, 50).Value = sWord34         ||15745  |            .Cells(3, 50).Value = sWord34         
15769  |            .Cells(3, 50).HorizontalAlignment = xl||15746  |            .Cells(3, 50).HorizontalAlignment = xl
15770  |        Else                                      ||15747  |        Else                                      
15771  |            .Cells(3, 43).Value = CStr(Format(txtS||15748  |            .Cells(3, 43).Value = CStr(Format(txtS
15772  |        End If                                    ||15749  |        End If                                    
15773  |        '財務部　担当者                           ||15750  |        '財務部　担当者                           
15774  |        sName = RTrim(txtInputName.Text)          ||15751  |        sName = RTrim(txtInputName.Text)          
15775  |        '財務部                                   ||15752  |        '財務部                                   
15776  |        .Cells(7, 37).Value = sWord1              ||15753  |        .Cells(7, 37).Value = sWord1              
15777  |        .Cells(8, 39).Value = sWord2 & sName      ||15754  |        .Cells(8, 39).Value = sWord2 & sName      
15778  |        '下記のとおり･･･ ,文言                    ||15755  |        '下記のとおり･･･ ,文言                    
15779  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||15756  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
15780  |            Case Mid(mstrContractFlag(1), 1, 1)   ||15757  |            Case Mid(mstrContractFlag(1), 1, 1)   
15781  |                .Cells(10, 2).Value = sWord3a     ||15758  |                .Cells(10, 2).Value = sWord3a     
15782  |            Case Mid(mstrContractFlag(2), 1, 1)   ||15759  |            Case Mid(mstrContractFlag(2), 1, 1)   
15783  |                .Cells(10, 2).Value = sWord3b     ||15760  |                .Cells(10, 2).Value = sWord3b     
15784  |            Case Mid(mstrContractFlag(3), 1, 1)   ||15761  |            Case Mid(mstrContractFlag(3), 1, 1)   
15785  |                .Cells(10, 2).Value = sWord3c     ||15762  |                .Cells(10, 2).Value = sWord3c     
15786  |            Case Else                             ||15763  |            Case Else                             
15787  |        End Select                                ||15764  |        End Select                                
15788  |        'ファンド名: ,文言                        ||15765  |        'ファンド名: ,文言                        
15789  |        .Cells(12, 2).Value = sWord4              ||15766  |        .Cells(12, 2).Value = sWord4              
15790  |        .Cells(12, 11).Value = sWord19            ||15767  |        .Cells(12, 11).Value = sWord19            
15791  |        .Cells(12, 13).Value = gbuMGetUPDRec.N(lRe||15768  |        .Cells(12, 13).Value = gbuMGetUPDRec.N(lRe
15792  |        'ファンドコード: ,文言                    ||15769  |        'ファンドコード: ,文言                    
15793  |        .Cells(13, 2).Value = sWord4_2            ||15770  |        .Cells(13, 2).Value = sWord4_2            
15794  |        .Cells(13, 11).Value = sWord19            ||15771  |        .Cells(13, 11).Value = sWord19            
15795  |        .Cells(13, 13).NumberFormatLocal = "@"    ||15772  |        .Cells(13, 13).NumberFormatLocal = "@"    
15796  |        '契約番号                                 ||15773  |        '契約番号                                 
15797  |        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_con||15774  |        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_con
15798  |                                                  ||15775  |                                                  
15799  |        'RAFI対応 START                           ||15776  |        'RAFI対応 START                           
15800  |        'NAV取得SQL                               ||15777  |        'NAV取得SQL                               
15801  |        '外部委託顧問料ルールの資産種類によって取 ||15778  |        '外部委託顧問料ルールの資産種類によって取 
15802  |        '純資産                                   ||15779  |        '純資産                                   
15803  |        If msAssetFlg = "0" Then                  ||15780  |        If msAssetFlg = "0" Then                  
15804  |            sSql = gstrEditSQLcfr_NavGetForSelectL||15781  |            sSql = gstrEditSQLcfr_NavGetForSelectL
15805  |        'マザー組入資産                           ||15782  |        'マザー組入資産                           
15806  |        Else                                      ||15783  |        Else                                      
15807  |            sSql = gstrEditSQLcfr_MotherAccGetForS||15784  |            sSql = gstrEditSQLcfr_MotherAccGetForS
15808  |        End If                                    ||15785  |        End If                                    
15809  |                                                  ||15786  |                                                  
15810  |        'ﾀﾞｲﾅｾｯﾄの作成                            ||15787  |        'ﾀﾞｲﾅｾｯﾄの作成                            
15811  |        If gintDyCreate(sSql) = False Then        ||15788  |        If gintDyCreate(sSql) = False Then        
15812  |            Exit Function                         ||15789  |            Exit Function                         
15813  |        End If                                    ||15790  |        End If                                    
15814  |                                                  ||15791  |                                                  
15815  |        '2006/04/12 START K.Furuya 実払管理テーブ ||15792  |        '2006/04/12 START K.Furuya 実払管理テーブ 
15816  |        '契約番号を取得                           ||15793  |        '契約番号を取得                           
15817  |        WkContractNo = ""                         ||15794  |        WkContractNo = ""                         
15818  |        WkContractNo = ContNo                     ||15795  |        WkContractNo = ContNo                     
15819  |        '2006/04/12 END   K.Furuya 実払管理テーブ ||15796  |        '2006/04/12 END   K.Furuya 実払管理テーブ 
15820  |                                                  ||15797  |                                                  
15821  |        Do Until gblnDyEOF()                      ||15798  |        Do Until gblnDyEOF()                      
15822  |            '動的配列更新                         ||15799  |            '動的配列更新                         
15823  |            ReDim Preserve gtypcfr_navget_tbl(0 To||15800  |            ReDim Preserve gtypcfr_navget_tbl(0 To
15824  |            ReDim Preserve dstrAccCd(0 To NavGetCn||15801  |            ReDim Preserve dstrAccCd(0 To NavGetCn
15825  |            'NAV取得抽出                          ||15802  |            'NAV取得抽出                          
15826  |            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT_||15803  |            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT_
15827  |            If NavGetCnt > 0 Then                 ||15804  |            If NavGetCnt > 0 Then                 
15828  |                sGetAccCode = sGetAccCode & " , " ||15805  |                sGetAccCode = sGetAccCode & " , " 
15829  |            Else                                  ||15806  |            Else                                  
15830  |                sGetAccCode = sGetAccCode & gtypcf||15807  |                sGetAccCode = sGetAccCode & gtypcf
15831  |            End If                                ||15808  |            End If                                
15832  |            '口座コードの格納(１契約複数口座の場合||15809  |            '口座コードの格納(１契約複数口座の場合
15833  |            dstrAccCd(NavGetCnt) = gtypcfr_navget_||15810  |            dstrAccCd(NavGetCnt) = gtypcfr_navget_
15834  |            NavGetCnt = NavGetCnt + 1             ||15811  |            NavGetCnt = NavGetCnt + 1             
15835  |            'マザー組入資産の場合ベビーファンドコ ||15812  |            'マザー組入資産の場合ベビーファンドコ 
15836  |            If msAssetFlg = "1" Then              ||15813  |            If msAssetFlg = "1" Then              
15837  |                msBabyAccountCode = ""            ||15814  |                msBabyAccountCode = ""            
15838  |                msBabyAccountCode = Trim(gvlnDyDat||15815  |                msBabyAccountCode = Trim(gvlnDyDat
15839  |            End If                                ||15816  |            End If                                
15840  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     ||15817  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     
15841  |            Call gDyNext                          ||15818  |            Call gDyNext                          
15842  |        Loop                                      ||15819  |        Loop                                      
15843  |        'RAFI対応 END                             ||15820  |        'RAFI対応 END                             
15844  |                                                  ||15821  |                                                  
15845  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         ||15822  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         
15846  |        Call gblnDyClose                          ||15823  |        Call gblnDyClose                          
15847  |                                                  ||15824  |                                                  
15848  |        '１契約複数口座の場合に口座のベース通貨に ||15825  |        '１契約複数口座の場合に口座のベース通貨に 
15849  |        ReDim dstrBsCCd(0 To NavGetCnt - 1)       ||15826  |        ReDim dstrBsCCd(0 To NavGetCnt - 1)       
15850  |        If NavGetCnt - 1 > 0 Then                 ||15827  |        If NavGetCnt - 1 > 0 Then                 
15851  |            For dintFor = 0 To NavGetCnt - 1      ||15828  |            For dintFor = 0 To NavGetCnt - 1      
15852  |                sSql = ""                         ||15829  |                sSql = ""                         
15853  |                sSql = sSql & "SELECT ACCOUNT_CODE||15830  |                sSql = sSql & "SELECT ACCOUNT_CODE
15854  |                sSql = sSql & "WHERE ACCOUNT_CODE ||15831  |                sSql = sSql & "WHERE ACCOUNT_CODE 
15855  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||15832  |                'ﾀﾞｲﾅｾｯﾄの作成                    
15856  |                If gintDyCreate(sSql) = False Then||15833  |                If gintDyCreate(sSql) = False Then
15857  |                    Exit Function                 ||15834  |                    Exit Function                 
15858  |                Else                              ||15835  |                Else                              
15859  |                    dstrBsCCd(dintFor) = gvlnDyDat||15836  |                    dstrBsCCd(dintFor) = gvlnDyDat
15860  |                End If                            ||15837  |                End If                            
15861  |                If dintFor > 0 Then               ||15838  |                If dintFor > 0 Then               
15862  |                    If dstrBsCCd(dintFor) <> dstrB||15839  |                    If dstrBsCCd(dintFor) <> dstrB
15863  |                        intRtn = MsgBox("ファンド ||15840  |                        intRtn = MsgBox("ファンド 
15864  |                        Exit Function             ||15841  |                        Exit Function             
15865  |                    End If                        ||15842  |                    End If                        
15866  |                End If                            ||15843  |                End If                            
15867  |            Next dintFor                          ||15844  |            Next dintFor                          
15868  |                                                  ||15845  |                                                  
15869  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||15846  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
15870  |            Call gblnDyClose                      ||15847  |            Call gblnDyClose                      
15871  |                                                  ||15848  |                                                  
15872  |        End If                                    ||15849  |        End If                                    
15873  |                                                  ||15850  |                                                  
15874  |        '口座コードをセルに配置                   ||15851  |        '口座コードをセルに配置                   
15875  |        'RAFI対応 START                           ||15852  |        'RAFI対応 START                           
15876  |        '純資産の場合                             ||15853  |        '純資産の場合                             
15877  |        If msAssetFlg = "0" Then                  ||15854  |        If msAssetFlg = "0" Then                  
15878  |            .Cells(13, 13).Value = sGetAccCode    ||15855  |            .Cells(13, 13).Value = sGetAccCode    
15879  |        'マザー組入資産の場合                     ||15856  |        'マザー組入資産の場合                     
15880  |        Else                                      ||15857  |        Else                                      
15881  |            .Cells(13, 13).Value = msBabyAccountCo||15858  |            .Cells(13, 13).Value = msBabyAccountCo
15882  |        End If                                    ||15859  |        End If                                    
15883  |        'RAFI対応 END                             ||15860  |        'RAFI対応 END                             
15884  |        '計算期間: ,文言                          ||15861  |        '計算期間: ,文言                          
15885  |        .Cells(15, 2).Value = sWord5              ||15862  |        .Cells(15, 2).Value = sWord5              
15886  |        .Cells(15, 11).Value = sWord19            ||15863  |        .Cells(15, 11).Value = sWord19            
15887  |        '前回締日・直近締日セット                 ||15864  |        '前回締日・直近締日セット                 
15888  |        dStart = CDate(gstrDateFormat(mstrSettleme||15865  |        dStart = CDate(gstrDateFormat(mstrSettleme
15889  |        dEnd = CDate(gstrDateFormat(mstrNearSettle||15866  |        dEnd = CDate(gstrDateFormat(mstrNearSettle
15890  |        dstrDate = Replace(CStr(dEnd), "/", "")   ||15867  |        dstrDate = Replace(CStr(dEnd), "/", "")   
15891  |                                                  ||15868  |                                                  
15892  |        '2006/04/12 START K.Furuya 実払管理テーブ ||15869  |        '2006/04/12 START K.Furuya 実払管理テーブ 
15893  |        '締日を取得                               ||15870  |        '締日を取得                               
15894  |        WkSettlementDate = ""                     ||15871  |        WkSettlementDate = ""                     
15895  |        WkSettlementDate = dstrDate               ||15872  |        WkSettlementDate = dstrDate               
15896  |        '2006/04/12 END   K.Furuya 実払管理テーブ ||15873  |        '2006/04/12 END   K.Furuya 実払管理テーブ 
15897  |                                                  ||15874  |                                                  
15898  |        '前回締日から直近締日の(日数 +1)を取得    ||15875  |        '前回締日から直近締日の(日数 +1)を取得    
15899  |        iCalcNum = DateDiff("d", dStart, dEnd) + 1||15876  |        iCalcNum = DateDiff("d", dStart, dEnd) + 1
15900  |                                                  ||15877  |                                                  
15901  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||15878  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
15902  |        WkStart = Replace(CStr(dStart), "/", "")  ||15879  |        WkStart = Replace(CStr(dStart), "/", "")  
15903  |                                                  ||15880  |                                                  
15904  |        '期中料率変更対象契約                     ||15881  |        '期中料率変更対象契約                     
15905  |        '外部委託顧問料率を定義体配列にセット     ||15882  |        '外部委託顧問料率を定義体配列にセット     
15906  |        If fnSetOtherComRate(gbuMGetUPDRec.N(lRecI||15883  |        If fnSetOtherComRate(gbuMGetUPDRec.N(lRecI
15907  |                             msAssetFlg, msBabyAcc||15884  |                             msAssetFlg, msBabyAcc
15908  |                             gbuMGetUPDRec.N(lRecI||15885  |                             gbuMGetUPDRec.N(lRecI
15909  |                             conDBasset_type_codeA||15886  |                             conDBasset_type_codeA
15910  |                             WkStart, _           ||15887  |                             WkStart, _           
15911  |                             "1") = False Then    ||15888  |                             "1") = False Then    
15912  |            Exit Function                         ||15889  |            Exit Function                         
15913  |        End If                                    ||15890  |        End If                                    
15914  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||15891  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
15915  |                                                  ||15892  |                                                  
15916  |        '純資産総額: ,文言                        ||15893  |        '純資産総額: ,文言                        
15917  |        .Cells(17, 2).Value = sWord50             ||15894  |        .Cells(17, 2).Value = sWord50             
15918  |        .Cells(17, 11).Value = sWord19            ||15895  |        .Cells(17, 11).Value = sWord19            
15919  |                                                  ||15896  |                                                  
15920  |        '月末純資産: ,文言                        ||15897  |        '月末純資産: ,文言                        
15921  |        .Cells(19, 2).Value = sWord6              ||15898  |        .Cells(19, 2).Value = sWord6              
15922  |        .Cells(19, 11).Value = sWord19            ||15899  |        .Cells(19, 11).Value = sWord19            
15923  |                                                  ||15900  |                                                  
15924  |        '純資産 ,表中の文言                       ||15901  |        '純資産 ,表中の文言                       
15925  |        .Cells(19, 26).Value = sWord8             ||15902  |        .Cells(19, 26).Value = sWord8             
15926  |        .Range("Z19:AN19").HorizontalAlignment = x||15903  |        .Range("Z19:AN19").HorizontalAlignment = x
15927  |'2005/03/09 Start @@@@@ 合計行を出力しないならここ||15904  |'2005/03/09 Start @@@@@ 合計行を出力しないならここ
15928  |'        '合計(純資産) ,表中の文言                ||15905  |'        '合計(純資産) ,表中の文言                
15929  |'        .Cells(33, 14).Value = sWord9            ||15906  |'        .Cells(33, 14).Value = sWord9            
15930  |'        .Range("N33:Y33").HorizontalAlignment = x||15907  |'        .Range("N33:Y33").HorizontalAlignment = x
15931  |'2005/03/09 End @@@@@ 合計行を出力しないならここを||15908  |'2005/03/09 End @@@@@ 合計行を出力しないならここを
15932  |'2006/08/11 START K.Furuya 期中料率変更対象契約対 ||15909  |'2006/08/11 START K.Furuya 期中料率変更対象契約対 
15933  |        '総合計(純資産) ,表中の文言               ||15910  |        '総合計(純資産) ,表中の文言               
15934  |        .Cells(40, 14).Value = sWord58            ||15911  |        .Cells(40, 14).Value = sWord58            
15935  |        .Range("N40:Y40").HorizontalAlignment = xl||15912  |        .Range("N40:Y40").HorizontalAlignment = xl
15936  |'2006/08/11 END   K.Furuya 期中料率変更対象契約対 ||15913  |'2006/08/11 END   K.Furuya 期中料率変更対象契約対 
15937  |        '日付 ,表中の文言                         ||15914  |        '日付 ,表中の文言                         
15938  |        .Cells(19, 14).Value = sWord7             ||15915  |        .Cells(19, 14).Value = sWord7             
15939  |        .Range("N19:Y19").HorizontalAlignment = xl||15916  |        .Range("N19:Y19").HorizontalAlignment = xl
15940  |                                                  ||15917  |                                                  
15941  |        iRowCnt = 0                               ||15918  |        iRowCnt = 0                               
15942  |        TotalNav = 0                              ||15919  |        TotalNav = 0                              
15943  |        Mnav_Flg = 0                              ||15920  |        Mnav_Flg = 0                              
15944  |                                                  ||15921  |                                                  
15945  |'契約区分を判断する                               ||15922  |'契約区分を判断する                               
15946  |'        '契約区分「1」or「2」or (「3」and 取得NAV||15923  |'        '契約区分「1」or「2」or (「3」and 取得NAV
15947  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||15924  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
15948  |            Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c||15925  |            Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c
15949  |            Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_||15926  |            Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_
15950  |            And gbuMGetUPDRec.N(lRecIdx).MGET_nav_||15927  |            And gbuMGetUPDRec.N(lRecIdx).MGET_nav_
15951  |'取得NAV区分[1]                                   ||15928  |'取得NAV区分[1]                                   
15952  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g||15929  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g
15953  |                '月次NAVを取得する                ||15930  |                '月次NAVを取得する                
15954  |                Call sbMonthlyNAV_GetChangeRate(lR||15931  |                Call sbMonthlyNAV_GetChangeRate(lR
15955  |                'カウンターを初期化               ||15932  |                'カウンターを初期化               
15956  |                K = 0                             ||15933  |                K = 0                             
15957  |                                                  ||15934  |                                                  
15958  |                '月次NAV表を作成する              ||15935  |                '月次NAV表を作成する              
15959  |                For i = LBound(gtypOtherComRec) To||15936  |                For i = LBound(gtypOtherComRec) To
15960  |                    For J = LBound(gtypOtherComRec||15937  |                    For J = LBound(gtypOtherComRec
15961  |                        '日付                     ||15938  |                        '日付                     
15962  |                        .Cells(20 + K, 15).Value =||15939  |                        .Cells(20 + K, 15).Value =
15963  |                        '純資産                   ||15940  |                        '純資産                   
15964  |                        .Cells(20 + K, 39).NumberF||15941  |                        .Cells(20 + K, 39).NumberF
15965  |                        If gtypOtherComRec(i).APPL||15942  |                        If gtypOtherComRec(i).APPL
15966  |                            .Cells(20 + K, 39).Val||15943  |                            .Cells(20 + K, 39).Val
15967  |                                CStr(Format(gtypOt||15944  |                                CStr(Format(gtypOt
15968  |                        Else                      ||15945  |                        Else                      
15969  |                            .Cells(20 + K, 39).Val||15946  |                            .Cells(20 + K, 39).Val
15970  |                                CStr(Format(gtypOt||15947  |                                CStr(Format(gtypOt
15971  |                        End If                    ||15948  |                        End If                    
15972  |                        .Cells(20 + K, 39).Horizon||15949  |                        .Cells(20 + K, 39).Horizon
15973  |                                                  ||15950  |                                                  
15974  |                        K = K + 1                 ||15951  |                        K = K + 1                 
15975  |                    Next J                        ||15952  |                    Next J                        
15976  |                    '純資産総額を算出する         ||15953  |                    '純資産総額を算出する         
15977  |                    TotalNav = TotalNav + gtypOthe||15954  |                    TotalNav = TotalNav + gtypOthe
15978  |                    '合計(純資産) ,表中の文言     ||15955  |                    '合計(純資産) ,表中の文言     
15979  |'                    .Cells(20 + k, 14).Value = sW||15956  |'                    .Cells(20 + k, 14).Value = sW
15980  |                    .Cells(20 + K, 15).Value = sWo||15957  |                    .Cells(20 + K, 15).Value = sWo
15981  |                    '合計(金額)                   ||15958  |                    '合計(金額)                   
15982  |                    .Cells(20 + K, 39).NumberForma||15959  |                    .Cells(20 + K, 39).NumberForma
15983  |                    If gtypOtherComRec(i).APPLY_BA||15960  |                    If gtypOtherComRec(i).APPLY_BA
15984  |                        .Cells(20 + K, 39).Value =||15961  |                        .Cells(20 + K, 39).Value =
15985  |                            CStr(Format(gtypOtherC||15962  |                            CStr(Format(gtypOtherC
15986  |                    Else                          ||15963  |                    Else                          
15987  |                        .Cells(20 + K, 39).Value =||15964  |                        .Cells(20 + K, 39).Value =
15988  |                            CStr(Format(gtypOtherC||15965  |                            CStr(Format(gtypOtherC
15989  |                    End If                        ||15966  |                    End If                        
15990  |                    .Cells(20 + K, 39).HorizontalA||15967  |                    .Cells(20 + K, 39).HorizontalA
15991  |                    K = K + 1                     ||15968  |                    K = K + 1                     
15992  |                    '平均NAV ,表中の文言          ||15969  |                    '平均NAV ,表中の文言          
15993  |'                    .Cells(20 + k, 14).Value = sW||15970  |'                    .Cells(20 + k, 14).Value = sW
15994  |                    .Cells(20 + K, 15).Value = sWo||15971  |                    .Cells(20 + K, 15).Value = sWo
15995  |                    '平均NAV(金額)                ||15972  |                    '平均NAV(金額)                
15996  |                    .Cells(20 + K, 39).NumberForma||15973  |                    .Cells(20 + K, 39).NumberForma
15997  |                    If gtypOtherComRec(i).APPLY_BA||15974  |                    If gtypOtherComRec(i).APPLY_BA
15998  |                        .Cells(20 + K, 39).Value =||15975  |                        .Cells(20 + K, 39).Value =
15999  |                            CStr(Format(gtypOtherC||15976  |                            CStr(Format(gtypOtherC
16000  |                    Else                          ||15977  |                    Else                          
16001  |                        .Cells(20 + K, 39).Value =||15978  |                        .Cells(20 + K, 39).Value =
16002  |                            CStr(Format(gtypOtherC||15979  |                            CStr(Format(gtypOtherC
16003  |                    End If                        ||15980  |                    End If                        
16004  |                    .Cells(20 + K, 39).HorizontalA||15981  |                    .Cells(20 + K, 39).HorizontalA
16005  |                                                  ||15982  |                                                  
16006  |                    K = K + 1                     ||15983  |                    K = K + 1                     
16007  |                Next i                            ||15984  |                Next i                            
16008  |                '総合計(月末純資産)               ||15985  |                '総合計(月末純資産)               
16009  |                '合計行を出力しないならここをコメ ||15986  |                '合計行を出力しないならここをコメ 
16010  |                .Cells(40, 39).NumberFormatLocal =||15987  |                .Cells(40, 39).NumberFormatLocal =
16011  |                .Cells(17, 23).NumberFormatLocal =||15988  |                .Cells(17, 23).NumberFormatLocal =
16012  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||15989  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
16013  |                    '合計行を出力しないならここを ||15990  |                    '合計行を出力しないならここを 
16014  |                    .Cells(40, 39).Value = CStr(Fo||15991  |                    .Cells(40, 39).Value = CStr(Fo
16015  |                    .Cells(17, 23).Value = CStr(Fo||15992  |                    .Cells(17, 23).Value = CStr(Fo
16016  |                Else                              ||15993  |                Else                              
16017  |                    '合計行を出力しないならここを ||15994  |                    '合計行を出力しないならここを 
16018  |                    .Cells(40, 39).Value = CStr(Fo||15995  |                    .Cells(40, 39).Value = CStr(Fo
16019  |                    .Cells(17, 23).Value = CStr(Fo||15996  |                    .Cells(17, 23).Value = CStr(Fo
16020  |                End If                            ||15997  |                End If                            
16021  |                '合計行を出力しないならここをコメ ||15998  |                '合計行を出力しないならここをコメ 
16022  |                .Cells(40, 39).HorizontalAlignment||15999  |                .Cells(40, 39).HorizontalAlignment
16023  |                .Cells(17, 23).HorizontalAlignment||16000  |                .Cells(17, 23).HorizontalAlignment
16024  |                                                  ||16001  |                                                  
16025  |                '平均純資産総額                   ||16002  |                '平均純資産総額                   
16026  |                .Cells(42, 2).Value = sWord51     ||16003  |                .Cells(42, 2).Value = sWord51     
16027  |                .Cells(42, 11).Value = sWord19    ||16004  |                .Cells(42, 11).Value = sWord19    
16028  |                '平均純資産総額は別紙に記載       ||16005  |                '平均純資産総額は別紙に記載       
16029  |                '.Cells(39, 13).Value = sWord54   ||16006  |                '.Cells(39, 13).Value = sWord54   
16030  |                .Cells(42, 13).Value = sWord54    ||16007  |                .Cells(42, 13).Value = sWord54    
16031  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||16008  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
16032  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_n||16009  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_n
16033  |            '=====================================||16010  |            '=====================================
16034  |            '==                                   ||16011  |            '==                                   
16035  |            '==  '4':日次時価総額平均(休日込)の計 ||16012  |            '==  '4':日次時価総額平均(休日込)の計 
16036  |            '==                                   ||16013  |            '==                                   
16037  |            '=====================================||16014  |            '=====================================
16038  |                ddblTtalnav = 0                   ||16015  |                ddblTtalnav = 0                   
16039  |                For dintFor = 0 To NavGetCnt - 1  ||16016  |                For dintFor = 0 To NavGetCnt - 1  
16040  |                                                  ||16017  |                                                  
16041  |                    '日次時価総額平均取得         ||16018  |                    '日次時価総額平均取得         
16042  |                    sStart = gstrDateFormat2(CStr(||16019  |                    sStart = gstrDateFormat2(CStr(
16043  |                    sEnd = gstrDateFormat2(CStr(dE||16020  |                    sEnd = gstrDateFormat2(CStr(dE
16044  |                                                  ||16021  |                                                  
16045  |'2008/03/03 START '計算開始日と外部委託顧問料計算 ||16022  |'2008/03/03 START '計算開始日と外部委託顧問料計算 
16046  |                    '等しい場合                   ||16023  |                    '等しい場合                   
16047  |                    If sStart = gbuMGetUPDRec.N(lR||16024  |                    If sStart = gbuMGetUPDRec.N(lR
16048  |                        StartFlg = "1"            ||16025  |                        StartFlg = "1"            
16049  |                    Else                          ||16026  |                    Else                          
16050  |                        StartFlg = "0"            ||16027  |                        StartFlg = "0"            
16051  |                    End If                        ||16028  |                    End If                        
16052  |'2008/03/03 END   '計算開始日と外部委託顧問料計算 ||16029  |'2008/03/03 END   '計算開始日と外部委託顧問料計算 
16053  |                                                  ||16030  |                                                  
16054  |                                                  ||16031  |                                                  
16055  |                    '計算開始日と外部委託顧問料計 ||16032  |                    '計算開始日と外部委託顧問料計 
16056  |                    If sStart = gbuMGetUPDRec.N(lR||16033  |                    If sStart = gbuMGetUPDRec.N(lR
16057  |                        '== SQL1 ==               ||16034  |                        '== SQL1 ==               
16058  |                        sSql = ""                 ||16035  |                        sSql = ""                 
16059  |                        sSql = sSql & "SELECT EIGY||16036  |                        sSql = sSql & "SELECT EIGY
16060  |                                                  ||16037  |                                                  
16061  |                        'ﾀﾞｲﾅｾｯﾄの作成            ||16038  |                        'ﾀﾞｲﾅｾｯﾄの作成            
16062  |                        If gintDyCreate(sSql) = Fa||16039  |                        If gintDyCreate(sSql) = Fa
16063  |                            Exit Function         ||16040  |                            Exit Function         
16064  |                        Else                      ||16041  |                        Else                      
16065  |                            '計算開始日が休日の場 ||16042  |                            '計算開始日が休日の場 
16066  |                            If gvlnDyDataS("EIGYO_||16043  |                            If gvlnDyDataS("EIGYO_
16067  |                                '翌営業日の時価総 ||16044  |                                '翌営業日の時価総 
16068  |                                '== SQL2 ==       ||16045  |                                '== SQL2 ==       
16069  |                                sSql = ""         ||16046  |                                sSql = ""         
16070  |                                sSql = sSql & "SEL||16047  |                                sSql = sSql & "SEL
16071  |                                sSql = sSql & "FRO||16048  |                                sSql = sSql & "FRO
16072  |                                sSql = sSql & "(SE||16049  |                                sSql = sSql & "(SE
16073  |                                sSql = sSql & "WHE||16050  |                                sSql = sSql & "WHE
16074  |                                                  ||16051  |                                                  
16075  |                                'ﾀﾞｲﾅｾｯﾄの作成    ||16052  |                                'ﾀﾞｲﾅｾｯﾄの作成    
16076  |                                If gintDyCreate(sS||16053  |                                If gintDyCreate(sS
16077  |                                    Exit Function ||16054  |                                    Exit Function 
16078  |                                Else              ||16055  |                                Else              
16079  |                                    ddblNearNav = ||16056  |                                    ddblNearNav = 
16080  |'2008/03/06 START 時価総額基準の外部委託顧問料対応||16057  |'2008/03/06 START 時価総額基準の外部委託顧問料対応
16081  |'                                    '翌営業日の計||16058  |'                                    '翌営業日の計
16082  |'                                    '== SQL3 ==  ||16059  |'                                    '== SQL3 ==  
16083  |'                                    sSql = ""    ||16060  |'                                    sSql = ""    
16084  |'                                    sSql = sSql &||16061  |'                                    sSql = sSql &
16085  |'                                    sSql = sSql &||16062  |'                                    sSql = sSql &
16086  |'                                    sSql = sSql &||16063  |'                                    sSql = sSql &
16087  |'                                    sSql = sSql &||16064  |'                                    sSql = sSql &
16088  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||16065  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
16089  |'                                    If gintDyCrea||16066  |'                                    If gintDyCrea
16090  |'                                        Exit Func||16067  |'                                        Exit Func
16091  |'                                    Else         ||16068  |'                                    Else         
16092  |'                                        '計算開始||16069  |'                                        '計算開始
16093  |'                                        sStart = ||16070  |'                                        sStart = 
16094  |'                                        dStart = ||16071  |'                                        dStart = 
16095  |'                                        .Cells(15||16072  |'                                        .Cells(15
16096  |'                                            CStr(||16073  |'                                            CStr(
16097  |'                                        iCalcNum ||16074  |'                                        iCalcNum 
16098  |'                                    End If       ||16075  |'                                    End If       
16099  |'2008/03/06 END   時価総額基準の外部委託顧問料対応||16076  |'2008/03/06 END   時価総額基準の外部委託顧問料対応
16100  |                                                  ||16077  |                                                  
16101  |                                    'SQL文の作成( ||16078  |                                    'SQL文の作成( 
16102  |                                    '計算期間の開 ||16079  |                                    '計算期間の開 
16103  |                                    sSql = gstrEdi||16080  |                                    sSql = gstrEdi
16104  |                                        ContNo, sS||16081  |                                        ContNo, sS
16105  |                                                  ||16082  |                                                  
16106  |                                     'ﾀﾞｲﾅｾｯﾄの作 ||16083  |                                     'ﾀﾞｲﾅｾｯﾄの作 
16107  |                                    If gintDyCreat||16084  |                                    If gintDyCreat
16108  |                                        Exit Funct||16085  |                                        Exit Funct
16109  |                                    End If        ||16086  |                                    End If        
16110  |                                    '配列初期化   ||16087  |                                    '配列初期化   
16111  |                                    ReDim gbuOther||16088  |                                    ReDim gbuOther
16112  |                                    MonthlyCnt = 0||16089  |                                    MonthlyCnt = 0
16113  |                                    'EOF判定処理  ||16090  |                                    'EOF判定処理  
16114  |                                    Do Until gblnD||16091  |                                    Do Until gblnD
16115  |                                        '対象デー ||16092  |                                        '対象デー 
16116  |                                        Call sbOth||16093  |                                        Call sbOth
16117  |                                        MonthlyCnt||16094  |                                        MonthlyCnt
16118  |                                        'ﾀﾞｲﾅｾｯﾄ次||16095  |                                        'ﾀﾞｲﾅｾｯﾄ次
16119  |                                        Call gDyNe||16096  |                                        Call gDyNe
16120  |                                    Loop          ||16097  |                                    Loop          
16121  |                                                  ||16098  |                                                  
16122  |                                    '期中料率変更 ||16099  |                                    '期中料率変更 
16123  |                                    Erase gtypOthe||16100  |                                    Erase gtypOthe
16124  |                                                  ||16101  |                                                  
16125  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||16102  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
16126  |                                    '期中料率変更 ||16103  |                                    '期中料率変更 
16127  |                                    '外部委託顧問 ||16104  |                                    '外部委託顧問 
16128  |                                    If fnSetOtherC||16105  |                                    If fnSetOtherC
16129  |                                                  ||16106  |                                                  
16130  |                                                  ||16107  |                                                  
16131  |                                                  ||16108  |                                                  
16132  |                                                  ||16109  |                                                  
16133  |                                                  ||16110  |                                                  
16134  |                                        Exit Funct||16111  |                                        Exit Funct
16135  |                                    End If        ||16112  |                                    End If        
16136  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||16113  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
16137  |                                                  ||16114  |                                                  
16138  |                                End If            ||16115  |                                End If            
16139  |                                'RAFI対応 START   ||16116  |                                'RAFI対応 START   
16140  |                                '翌営業日のマザー ||16117  |                                '翌営業日のマザー 
16141  |                                If msAssetFlg = "1||16118  |                                If msAssetFlg = "1
16142  |                                    '== SQL4 ==   ||16119  |                                    '== SQL4 ==   
16143  |                                    sSql = ""     ||16120  |                                    sSql = ""     
16144  |                                    sSql = sSql & ||16121  |                                    sSql = sSql & 
16145  |                                    sSql = sSql & ||16122  |                                    sSql = sSql & 
16146  |                                    sSql = sSql & ||16123  |                                    sSql = sSql & 
16147  |                                    sSql = sSql & ||16124  |                                    sSql = sSql & 
16148  |                                    sSql = sSql & ||16125  |                                    sSql = sSql & 
16149  |                                    sSql = sSql & ||16126  |                                    sSql = sSql & 
16150  |                                    sSql = sSql & ||16127  |                                    sSql = sSql & 
16151  |                                    sSql = sSql & ||16128  |                                    sSql = sSql & 
16152  |                                    sSql = sSql & ||16129  |                                    sSql = sSql & 
16153  |                                    sSql = sSql & ||16130  |                                    sSql = sSql & 
16154  |                                    sSql = sSql & ||16131  |                                    sSql = sSql & 
16155  |                                    sSql = sSql & ||16132  |                                    sSql = sSql & 
16156  |                                    sSql = sSql & ||16133  |                                    sSql = sSql & 
16157  |                                    sSql = sSql & ||16134  |                                    sSql = sSql & 
16158  |                                    sSql = sSql & ||16135  |                                    sSql = sSql & 
16159  |                                    sSql = sSql & ||16136  |                                    sSql = sSql & 
16160  |                                    sSql = sSql & ||16137  |                                    sSql = sSql & 
16161  |                                    sSql = sSql & ||16138  |                                    sSql = sSql & 
16162  |                                    sSql = sSql & ||16139  |                                    sSql = sSql & 
16163  |                                    sSql = sSql & ||16140  |                                    sSql = sSql & 
16164  |                                    sSql = sSql & ||16141  |                                    sSql = sSql & 
16165  |                                    sSql = sSql & ||16142  |                                    sSql = sSql & 
16166  |                                    sSql = sSql & ||16143  |                                    sSql = sSql & 
16167  |                                    sSql = sSql & ||16144  |                                    sSql = sSql & 
16168  |                                    'ﾀﾞｲﾅｾｯﾄの作成||16145  |                                    'ﾀﾞｲﾅｾｯﾄの作成
16169  |                                                  ||16146  |                                                  
16170  |                                    If gintDyCreat||16147  |                                    If gintDyCreat
16171  |                                        Exit Funct||16148  |                                        Exit Funct
16172  |                                    Else          ||16149  |                                    Else          
16173  |                                        ddblNearBa||16150  |                                        ddblNearBa
16174  |                                    End If        ||16151  |                                    End If        
16175  |                                End If            ||16152  |                                End If            
16176  |                                'RAFI対応 END     ||16153  |                                'RAFI対応 END     
16177  |                            End If                ||16154  |                            End If                
16178  |                        End If                    ||16155  |                        End If                    
16179  |                    End If                        ||16156  |                    End If                        
16180  |                    '計算開始日から計算終了日まで ||16157  |                    '計算開始日から計算終了日まで 
16181  |                    '== SQL5 ==                   ||16158  |                    '== SQL5 ==                   
16182  |                    sSql = ""                     ||16159  |                    sSql = ""                     
16183  |                    sSql = sSql & "SELECT CAL_YYYY||16160  |                    sSql = sSql & "SELECT CAL_YYYY
16184  |                    sSql = sSql & "WHERE CAL_YYYY ||16161  |                    sSql = sSql & "WHERE CAL_YYYY 
16185  |                                                  ||16162  |                                                  
16186  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||16163  |                    'ﾀﾞｲﾅｾｯﾄの作成                
16187  |                    If gintDyCreate(sSql) = False ||16164  |                    If gintDyCreate(sSql) = False 
16188  |                        Exit Function             ||16165  |                        Exit Function             
16189  |                    End If                        ||16166  |                    End If                        
16190  |                                                  ||16167  |                                                  
16191  |                    If dlngCnt = 0 Then           ||16168  |                    If dlngCnt = 0 Then           
16192  |                        ReDim dstrCaldate(gbxOraDy||16169  |                        ReDim dstrCaldate(gbxOraDy
16193  |                        ReDim ddblDailynav(gbxOraD||16170  |                        ReDim ddblDailynav(gbxOraD
16194  |                    End If                        ||16171  |                    End If                        
16195  |                                                  ||16172  |                                                  
16196  |                    'EOF判定処理                  ||16173  |                    'EOF判定処理                  
16197  |                    dlngCnt = 0                   ||16174  |                    dlngCnt = 0                   
16198  |                                                  ||16175  |                                                  
16199  |                    Do Until gblnDyEOF()          ||16176  |                    Do Until gblnDyEOF()          
16200  |                        dlngCnt = dlngCnt + 1     ||16177  |                        dlngCnt = dlngCnt + 1     
16201  |                        '抽出データセット         ||16178  |                        '抽出データセット         
16202  |                        dstrCaldate(dlngCnt) = gvl||16179  |                        dstrCaldate(dlngCnt) = gvl
16203  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||16180  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
16204  |                        Call gDyNext              ||16181  |                        Call gDyNext              
16205  |                    Loop                          ||16182  |                    Loop                          
16206  |                                                  ||16183  |                                                  
16207  |                                                  ||16184  |                                                  
16208  |                    '2005/08/26　START            ||16185  |                    '2005/08/26　START            
16209  |                    '変数sStartに格納されている日 ||16186  |                    '変数sStartに格納されている日 
16210  |                    '変数sStartの直近の営業日の日 ||16187  |                    '変数sStartの直近の営業日の日 
16211  |                    '（変数sStartに格納されている ||16188  |                    '（変数sStartに格納されている 
16212  |                    '　直近日付が存在しない場合は ||16189  |                    '　直近日付が存在しない場合は 
16213  |                                                  ||16190  |                                                  
16214  |                    '計算開始日の日次時価総額基準 ||16191  |                    '計算開始日の日次時価総額基準 
16215  |                    '== SQL6 ==                   ||16192  |                    '== SQL6 ==                   
16216  |                    sSql = ""                     ||16193  |                    sSql = ""                     
16217  |                    sSql = sSql & "SELECT MAX(BASE||16194  |                    sSql = sSql & "SELECT MAX(BASE
16218  |                    sSql = sSql & "FROM   CFR_DAIL||16195  |                    sSql = sSql & "FROM   CFR_DAIL
16219  |                    sSql = sSql & "WHERE  BASE_DAT||16196  |                    sSql = sSql & "WHERE  BASE_DAT
16220  |                    sSql = sSql & "AND    ACCOUNT_||16197  |                    sSql = sSql & "AND    ACCOUNT_
16221  |                                                  ||16198  |                                                  
16222  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||16199  |                    'ﾀﾞｲﾅｾｯﾄの作成                
16223  |                    If gintDyCreate(sSql) = False ||16200  |                    If gintDyCreate(sSql) = False 
16224  |                        Exit Function             ||16201  |                        Exit Function             
16225  |                    End If                        ||16202  |                    End If                        
16226  |                                                  ||16203  |                                                  
16227  |                    Do Until gblnDyEOF()          ||16204  |                    Do Until gblnDyEOF()          
16228  |                       '抽出データセット          ||16205  |                       '抽出データセット          
16229  |                        sStart = gvlnDyDataS("BASE||16206  |                        sStart = gvlnDyDataS("BASE
16230  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||16207  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
16231  |                        Call gDyNext              ||16208  |                        Call gDyNext              
16232  |                    Loop                          ||16209  |                    Loop                          
16233  |                                                  ||16210  |                                                  
16234  |                    'SQL文の作成(外部委託顧問料率 ||16211  |                    'SQL文の作成(外部委託顧問料率 
16235  |                    '計算期間の開始日と終了日に含 ||16212  |                    '計算期間の開始日と終了日に含 
16236  |                    sSql = gstrEditSQLcfr_OtherCom||16213  |                    sSql = gstrEditSQLcfr_OtherCom
16237  |                        ContNo, sStart, mstrNearSe||16214  |                        ContNo, sStart, mstrNearSe
16238  |                                                  ||16215  |                                                  
16239  |                     'ﾀﾞｲﾅｾｯﾄの作成               ||16216  |                     'ﾀﾞｲﾅｾｯﾄの作成               
16240  |                    If gintDyCreate(sSql) = False ||16217  |                    If gintDyCreate(sSql) = False 
16241  |                        Exit Function             ||16218  |                        Exit Function             
16242  |                    End If                        ||16219  |                    End If                        
16243  |                    '配列初期化                   ||16220  |                    '配列初期化                   
16244  |                    ReDim gbuOtherComRateGetUPDRec||16221  |                    ReDim gbuOtherComRateGetUPDRec
16245  |                    MonthlyCnt = 0                ||16222  |                    MonthlyCnt = 0                
16246  |                    'EOF判定処理                  ||16223  |                    'EOF判定処理                  
16247  |                    Do Until gblnDyEOF()          ||16224  |                    Do Until gblnDyEOF()          
16248  |                        '対象データ抽出           ||16225  |                        '対象データ抽出           
16249  |                        Call sbOtherComDataGet(Mon||16226  |                        Call sbOtherComDataGet(Mon
16250  |                        MonthlyCnt = MonthlyCnt + ||16227  |                        MonthlyCnt = MonthlyCnt + 
16251  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||16228  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
16252  |                        Call gDyNext              ||16229  |                        Call gDyNext              
16253  |                    Loop                          ||16230  |                    Loop                          
16254  |                                                  ||16231  |                                                  
16255  |                    '期中料率変更用配列のクリア   ||16232  |                    '期中料率変更用配列のクリア   
16256  |                    Erase gtypOtherComRec         ||16233  |                    Erase gtypOtherComRec         
16257  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||16234  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
16258  |                    '期中料率変更対象契約         ||16235  |                    '期中料率変更対象契約         
16259  |                    '外部委託顧問料率を定義体配列 ||16236  |                    '外部委託顧問料率を定義体配列 
16260  |                    If fnSetOtherComRate(gbuMGetUP||16237  |                    If fnSetOtherComRate(gbuMGetUP
16261  |                                         msAssetFl||16238  |                                         msAssetFl
16262  |                                         gbuMGetUP||16239  |                                         gbuMGetUP
16263  |                                         conDBasse||16240  |                                         conDBasse
16264  |                                         sStart, _||16241  |                                         sStart, _
16265  |                                         StartFlg)||16242  |                                         StartFlg)
16266  |                        Exit Function             ||16243  |                        Exit Function             
16267  |                    End If                        ||16244  |                    End If                        
16268  | '2008/03/03 END   時価総額基準の外部委託顧問料対 ||16245  | '2008/03/03 END   時価総額基準の外部委託顧問料対 
16269  |                                                  ||16246  |                                                  
16270  |                    'RAFI対応 START               ||16247  |                    'RAFI対応 START               
16271  |                    '純資産の場合                 ||16248  |                    '純資産の場合                 
16272  |                    If msAssetFlg = "0" Then      ||16249  |                    If msAssetFlg = "0" Then      
16273  |                        '計算開始日から計算終了日 ||16250  |                        '計算開始日から計算終了日 
16274  |                        '== SQL 7 ==              ||16251  |                        '== SQL 7 ==              
16275  |                        sSql = ""                 ||16252  |                        sSql = ""                 
16276  |                        sSql = sSql & "SELECT ACCO||16253  |                        sSql = sSql & "SELECT ACCO
16277  |                        sSql = sSql & "WHERE CFR_D||16254  |                        sSql = sSql & "WHERE CFR_D
16278  |                        sSql = sSql & "AND   (CFR_||16255  |                        sSql = sSql & "AND   (CFR_
16279  |                        sSql = sSql & "ORDER BY CF||16256  |                        sSql = sSql & "ORDER BY CF
16280  |                    'マザー組入資産の場合         ||16257  |                    'マザー組入資産の場合         
16281  |                    Else                          ||16258  |                    Else                          
16282  |                        '計算開始日から計算終了日 ||16259  |                        '計算開始日から計算終了日 
16283  |                        '== SQL8 ==               ||16260  |                        '== SQL8 ==               
16284  |                        sSql = ""                 ||16261  |                        sSql = ""                 
16285  |                        sSql = sSql & "SELECT"    ||16262  |                        sSql = sSql & "SELECT"    
16286  |                        sSql = sSql & "    a.ACCOU||16263  |                        sSql = sSql & "    a.ACCOU
16287  |                        sSql = sSql & "    a.BASE_||16264  |                        sSql = sSql & "    a.BASE_
16288  |                        sSql = sSql & "    a.MARKE||16265  |                        sSql = sSql & "    a.MARKE
16289  |                        sSql = sSql & "    b.BABY_||16266  |                        sSql = sSql & "    b.BABY_
16290  |                        sSql = sSql & "    b.BABY_||16267  |                        sSql = sSql & "    b.BABY_
16291  |                        sSql = sSql & " FROM"     ||16268  |                        sSql = sSql & " FROM"     
16292  |                        sSql = sSql & "    CFR_DAI||16269  |                        sSql = sSql & "    CFR_DAI
16293  |                        sSql = sSql & " WHERE"    ||16270  |                        sSql = sSql & " WHERE"    
16294  |                        sSql = sSql & "    b.BABY_||16271  |                        sSql = sSql & "    b.BABY_
16295  |                        sSql = sSql & "    b.MOTHE||16272  |                        sSql = sSql & "    b.MOTHE
16296  |                        sSql = sSql & "    b.BASE_||16273  |                        sSql = sSql & "    b.BASE_
16297  |                        sSql = sSql & "    a.ACCOU||16274  |                        sSql = sSql & "    a.ACCOU
16298  |                        sSql = sSql & "    (a.BASE||16275  |                        sSql = sSql & "    (a.BASE
16299  |                        sSql = sSql & "    a.BASE_||16276  |                        sSql = sSql & "    a.BASE_
16300  |                        sSql = sSql & " ORDER BY" ||16277  |                        sSql = sSql & " ORDER BY" 
16301  |                        sSql = sSql & "    a.BASE_||16278  |                        sSql = sSql & "    a.BASE_
16302  |                    End If                        ||16279  |                    End If                        
16303  |                    'RAFI対応 END                 ||16280  |                    'RAFI対応 END                 
16304  |                                                  ||16281  |                                                  
16305  |                    If gintDyCreate(sSql) = False ||16282  |                    If gintDyCreate(sSql) = False 
16306  |                        Exit Function             ||16283  |                        Exit Function             
16307  |                    End If                        ||16284  |                    End If                        
16308  |                                                  ||16285  |                                                  
16309  |                    dlngCntsv = dlngCnt           ||16286  |                    dlngCntsv = dlngCnt           
16310  |                    dlngCnt = 0                   ||16287  |                    dlngCnt = 0                   
16311  |                                                  ||16288  |                                                  
16312  |                    Do Until gblnDyEOF()          ||16289  |                    Do Until gblnDyEOF()          
16313  |                        dlngCnt = dlngCnt + 1     ||16290  |                        dlngCnt = dlngCnt + 1     
16314  |                        '抽出データセット         ||16291  |                        '抽出データセット         
16315  |                        dstrBasedate = gvlnDyDataS||16292  |                        dstrBasedate = gvlnDyDataS
16316  |                        If Mid(dstrCaldate(dlngCnt||16293  |                        If Mid(dstrCaldate(dlngCnt
16317  |                            'RAFI対応 START       ||16294  |                            'RAFI対応 START       
16318  |                            '純資産の場合         ||16295  |                            '純資産の場合         
16319  |                            If msAssetFlg = "0" Th||16296  |                            If msAssetFlg = "0" Th
16320  |                                ddblDailynav(dlngC||16297  |                                ddblDailynav(dlngC
16321  |                            'マザー組入資産の場合 ||16298  |                            'マザー組入資産の場合 
16322  |                            Else                  ||16299  |                            Else                  
16323  |                                ddblDailynav(dlngC||16300  |                                ddblDailynav(dlngC
16324  |                            End If                ||16301  |                            End If                
16325  |                            'RAFI対応 END         ||16302  |                            'RAFI対応 END         
16326  |                        Else                      ||16303  |                        Else                      
16327  |                            '計算開始日が外部委託 ||16304  |                            '計算開始日が外部委託 
16328  |                            If ddblNearNav <> 0 An||16305  |                            If ddblNearNav <> 0 An
16329  |                                dstrCaldate2 = Mid||16306  |                                dstrCaldate2 = Mid
16330  |                                dstrBasedate2 = Mi||16307  |                                dstrBasedate2 = Mi
16331  |                                dlngDiffdate = Dat||16308  |                                dlngDiffdate = Dat
16332  |                                                  ||16309  |                                                  
16333  |                                For dintFor2 = 1 T||16310  |                                For dintFor2 = 1 T
16334  |                                    'RAFI対応 STAR||16311  |                                    'RAFI対応 STAR
16335  |                                    '純資産の場合 ||16312  |                                    '純資産の場合 
16336  |                                    If msAssetFlg ||16313  |                                    If msAssetFlg 
16337  |                                        ddblDailyn||16314  |                                        ddblDailyn
16338  |                                    'マザー組入資 ||16315  |                                    'マザー組入資 
16339  |                                    Else          ||16316  |                                    Else          
16340  |                                        ddblDailyn||16317  |                                        ddblDailyn
16341  |                                    End If        ||16318  |                                    End If        
16342  |                                    'RAFI対応 END ||16319  |                                    'RAFI対応 END 
16343  |                                    dlngCnt = dlng||16320  |                                    dlngCnt = dlng
16344  |                                Next dintFor2     ||16321  |                                Next dintFor2     
16345  |                                'RAFI対応 START   ||16322  |                                'RAFI対応 START   
16346  |                                '純資産の場合     ||16323  |                                '純資産の場合     
16347  |                                If msAssetFlg = "0||16324  |                                If msAssetFlg = "0
16348  |                                    ddblDailynav(d||16325  |                                    ddblDailynav(d
16349  |                                'マザー組入資産の ||16326  |                                'マザー組入資産の 
16350  |                                Else              ||16327  |                                Else              
16351  |                                    ddblDailynav(d||16328  |                                    ddblDailynav(d
16352  |                                End If            ||16329  |                                End If            
16353  |                                'RAFI対応 END     ||16330  |                                'RAFI対応 END     
16354  |                            Else                  ||16331  |                            Else                  
16355  |                                '日次時価総額にデ ||16332  |                                '日次時価総額にデ 
16356  |                                dstrCaldate2 = Mid||16333  |                                dstrCaldate2 = Mid
16357  |                                dstrBasedate2 = Mi||16334  |                                dstrBasedate2 = Mi
16358  |                                dlngDiffdate = Dat||16335  |                                dlngDiffdate = Dat
16359  |                                                  ||16336  |                                                  
16360  |                                For dintFor2 = 1 T||16337  |                                For dintFor2 = 1 T
16361  |                                    If ddblDailyna||16338  |                                    If ddblDailyna
16362  |                                        ddblDailyn||16339  |                                        ddblDailyn
16363  |                                    Else          ||16340  |                                    Else          
16364  |                                        '日次時価 ||16341  |                                        '日次時価 
16365  |                                        intRtn = M||16342  |                                        intRtn = M
16366  |                                        vbLf & "対||16343  |                                        vbLf & "対
16367  |                                        vbLf & "基||16344  |                                        vbLf & "基
16368  |                                            vbCrit||16345  |                                            vbCrit
16369  |                                        Exit Funct||16346  |                                        Exit Funct
16370  |                                    End If        ||16347  |                                    End If        
16371  |                                    dlngCnt = dlng||16348  |                                    dlngCnt = dlng
16372  |                                Next dintFor2     ||16349  |                                Next dintFor2     
16373  |                                'RAFI対応 START   ||16350  |                                'RAFI対応 START   
16374  |                                '純資産の場合     ||16351  |                                '純資産の場合     
16375  |                                If msAssetFlg = "0||16352  |                                If msAssetFlg = "0
16376  |                                    ddblDailynav(d||16353  |                                    ddblDailynav(d
16377  |                                'マザー組入資産の ||16354  |                                'マザー組入資産の 
16378  |                                Else              ||16355  |                                Else              
16379  |                                    ddblDailynav(d||16356  |                                    ddblDailynav(d
16380  |                                End If            ||16357  |                                End If            
16381  |                                'RAFI対応 END     ||16358  |                                'RAFI対応 END     
16382  |                            End If                ||16359  |                            End If                
16383  |                                                  ||16360  |                                                  
16384  |                        End If                    ||16361  |                        End If                    
16385  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||16362  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
16386  |                        Call gDyNext              ||16363  |                        Call gDyNext              
16387  |                    Loop                          ||16364  |                    Loop                          
16388  |                                                  ||16365  |                                                  
16389  |                                                  ||16366  |                                                  
16390  |                Next dintFor                      ||16367  |                Next dintFor                      
16391  |                                                  ||16368  |                                                  
16392  |                If dlngCntsv <> dlngCnt Then      ||16369  |                If dlngCntsv <> dlngCnt Then      
16393  |                    For dintFor2 = dlngCnt + 1 To ||16370  |                    For dintFor2 = dlngCnt + 1 To 
16394  |                        ddblDailynav(dintFor2) = d||16371  |                        ddblDailynav(dintFor2) = d
16395  |                    Next dintFor2                 ||16372  |                    Next dintFor2                 
16396  |                    dlngCnt = dlngCntsv           ||16373  |                    dlngCnt = dlngCntsv           
16397  |                End If                            ||16374  |                End If                            
16398  |                                                  ||16375  |                                                  
16399  |                ddblTtalnav = 0                   ||16376  |                ddblTtalnav = 0                   
16400  |                                                  ||16377  |                                                  
16401  |                For dintFor2 = 1 To dlngCnt       ||16378  |                For dintFor2 = 1 To dlngCnt       
16402  |                    ddblTtalnav = ddblTtalnav + dd||16379  |                    ddblTtalnav = ddblTtalnav + dd
16403  |                Next dintFor2                     ||16380  |                Next dintFor2                     
16404  |                                                  ||16381  |                                                  
16405  |                'カレンダーを元に日次時価総額を配 ||16382  |                'カレンダーを元に日次時価総額を配 
16406  |                K = 0                             ||16383  |                K = 0                             
16407  |                For i = 1 To dlngCnt              ||16384  |                For i = 1 To dlngCnt              
16408  |                    '計算開始日の日次時価総額は無 ||16385  |                    '計算開始日の日次時価総額は無 
16409  |                    If i = 1 Then                 ||16386  |                    If i = 1 Then                 
16410  |                        gtypOtherComRec(K).APPLY_T||16387  |                        gtypOtherComRec(K).APPLY_T
16411  |                    Else                          ||16388  |                    Else                          
16412  |                        '適用終了日に成るまで累積 ||16389  |                        '適用終了日に成るまで累積 
16413  |                        If Mid(dstrCaldate(i), 1, ||16390  |                        If Mid(dstrCaldate(i), 1, 
16414  |                            gtypOtherComRec(K).APP||16391  |                            gtypOtherComRec(K).APP
16415  |                        'カレンダー日付が適用終了 ||16392  |                        'カレンダー日付が適用終了 
16416  |                        Else                      ||16393  |                        Else                      
16417  |                            '料率変更毎に平均時価 ||16394  |                            '料率変更毎に平均時価 
16418  |                            gtypOtherComRec(K).APP||16395  |                            gtypOtherComRec(K).APP
16419  |                            '次の料率へシフトする ||16396  |                            '次の料率へシフトする 
16420  |                            K = K + 1             ||16397  |                            K = K + 1             
16421  |                            gtypOtherComRec(K).APP||16398  |                            gtypOtherComRec(K).APP
16422  |                        End If                    ||16399  |                        End If                    
16423  |                    End If                        ||16400  |                    End If                        
16424  |                    '最後のレコードの場合時価総額 ||16401  |                    '最後のレコードの場合時価総額 
16425  |                    If i = dlngCnt Then           ||16402  |                    If i = dlngCnt Then           
16426  |                        '料率変更毎に平均時価総額 ||16403  |                        '料率変更毎に平均時価総額 
16427  |                        gtypOtherComRec(K).APPLY_N||16404  |                        gtypOtherComRec(K).APPLY_N
16428  |                    End If                        ||16405  |                    End If                        
16429  |                Next i                            ||16406  |                Next i                            
16430  |                                                  ||16407  |                                                  
16431  |                iRowCnt = dlngCnt                 ||16408  |                iRowCnt = dlngCnt                 
16432  |                TotalNav = ddblTtalnav            ||16409  |                TotalNav = ddblTtalnav            
16433  |                dblValueIn = TotalNav             ||16410  |                dblValueIn = TotalNav             
16434  |                Call sbGetRoundValue2(dblValueIn) ||16411  |                Call sbGetRoundValue2(dblValueIn) 
16435  |                TotalNav = dblValueOut            ||16412  |                TotalNav = dblValueOut            
16436  |                                                  ||16413  |                                                  
16437  |                '合計(月末純資産)                 ||16414  |                '合計(月末純資産)                 
16438  |                .Cells(17, 23).NumberFormatLocal =||16415  |                .Cells(17, 23).NumberFormatLocal =
16439  |                .Cells(17, 23).Value = CStr(Format||16416  |                .Cells(17, 23).Value = CStr(Format
16440  |                .Cells(17, 23).HorizontalAlignment||16417  |                .Cells(17, 23).HorizontalAlignment
16441  |'2006/08/16 START 期中料率変更契約/RAFI対応のため ||16418  |'2006/08/16 START 期中料率変更契約/RAFI対応のため 
16442  |'                '平均純資産総額                  ||16419  |'                '平均純資産総額                  
16443  |'                .Cells(36, 2).Value = sWord51    ||16420  |'                .Cells(36, 2).Value = sWord51    
16444  |'                .Cells(36, 11).Value = sWord19   ||16421  |'                .Cells(36, 11).Value = sWord19   
16445  |'2006/08/16 END   期中料率変更契約/RAFI対応のため ||16422  |'2006/08/16 END   期中料率変更契約/RAFI対応のため 
16446  |                                                  ||16423  |                                                  
16447  |                '平均純資産総額                   ||16424  |                '平均純資産総額                   
16448  |                .Cells(42, 2).Value = sWord51     ||16425  |                .Cells(42, 2).Value = sWord51     
16449  |                .Cells(42, 11).Value = sWord19    ||16426  |                .Cells(42, 11).Value = sWord19    
16450  |                '平均純資産総額は別紙に記載       ||16427  |                '平均純資産総額は別紙に記載       
16451  |                '.Cells(39, 13).Value = sWord54   ||16428  |                '.Cells(39, 13).Value = sWord54   
16452  |                .Cells(42, 13).Value = sWord54    ||16429  |                .Cells(42, 13).Value = sWord54    
16453  |                                                  ||16430  |                                                  
16454  |'2006/08/16 START 期中料率変更契約/RAFI対応のため ||16431  |'2006/08/16 START 期中料率変更契約/RAFI対応のため 
16455  |'                '計算期間の純資産総額の合計(月末 ||16432  |'                '計算期間の純資産総額の合計(月末 
16456  |'                .Cells(36, 23).NumberFormatLocal ||16433  |'                .Cells(36, 23).NumberFormatLocal 
16457  |'                    If gbuMGetUPDRec.N(lRecIdx).M||16434  |'                    If gbuMGetUPDRec.N(lRecIdx).M
16458  |'                        .Cells(36, 23).Value = CS||16435  |'                        .Cells(36, 23).Value = CS
16459  |'                    Else                         ||16436  |'                    Else                         
16460  |'                        .Cells(36, 23).Value = CS||16437  |'                        .Cells(36, 23).Value = CS
16461  |'                    End If                       ||16438  |'                    End If                       
16462  |'                .Cells(36, 23).HorizontalAlignmen||16439  |'                .Cells(36, 23).HorizontalAlignmen
16463  |'                '計算期間の純資産総額の合計÷計算||16440  |'                '計算期間の純資産総額の合計÷計算
16464  |'                .Cells(36, 35).NumberFormatLocal ||16441  |'                .Cells(36, 35).NumberFormatLocal 
16465  |'                dblValueIn = TotalNav / iRowCnt  ||16442  |'                dblValueIn = TotalNav / iRowCnt  
16466  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||16443  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
16467  |'                    Call sbGetRoundValue2(dblValu||16444  |'                    Call sbGetRoundValue2(dblValu
16468  |'                Else                             ||16445  |'                Else                             
16469  |'                    Call sbGetRoundValue(dblValue||16446  |'                    Call sbGetRoundValue(dblValue
16470  |'                End If                           ||16447  |'                End If                           
16471  |'                    If gbuMGetUPDRec.N(lRecIdx).M||16448  |'                    If gbuMGetUPDRec.N(lRecIdx).M
16472  |'                        .Cells(36, 35).Value = CS||16449  |'                        .Cells(36, 35).Value = CS
16473  |'                    Else                         ||16450  |'                    Else                         
16474  |'                        .Cells(36, 35).Value = CS||16451  |'                        .Cells(36, 35).Value = CS
16475  |'                    End If                       ||16452  |'                    End If                       
16476  |'                '÷??＝ ,文言                    ||16453  |'                '÷??＝ ,文言                    
16477  |'                .Cells(36, 26).Value = sWord18 & ||16454  |'                .Cells(36, 26).Value = sWord18 & 
16478  |'2006/08/16 END   期中料率変更契約/RAFI対応のため ||16455  |'2006/08/16 END   期中料率変更契約/RAFI対応のため 
16479  |                                                  ||16456  |                                                  
16480  |                '計算期間の純資産総額の合計÷計算 ||16457  |                '計算期間の純資産総額の合計÷計算 
16481  |                dblValueIn = TotalNav / iRowCnt   ||16458  |                dblValueIn = TotalNav / iRowCnt   
16482  |                Call sbGetRoundValue(dblValueIn)  ||16459  |                Call sbGetRoundValue(dblValueIn)  
16483  |                AvgNav = dblValueOut              ||16460  |                AvgNav = dblValueOut              
16484  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||16461  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
16485  |                                                  ||16462  |                                                  
16486  |            Else                                  ||16463  |            Else                                  
16487  |'取得NAV区分[1]以外(取得NAV区分='2')              ||16464  |'取得NAV区分[1]以外(取得NAV区分='2')              
16488  |                                                  ||16465  |                                                  
16489  |                ddblTtalnav = 0                   ||16466  |                ddblTtalnav = 0                   
16490  |                For dintFor = 0 To NavGetCnt - 1  ||16467  |                For dintFor = 0 To NavGetCnt - 1  
16491  |                                                  ||16468  |                                                  
16492  |                    '日次NAV平均取得              ||16469  |                    '日次NAV平均取得              
16493  |                    sStart = gstrDateFormat2(CStr(||16470  |                    sStart = gstrDateFormat2(CStr(
16494  |                    sEnd = gstrDateFormat2(CStr(dE||16471  |                    sEnd = gstrDateFormat2(CStr(dE
16495  |                                                  ||16472  |                                                  
16496  |'2008/03/03 START '計算開始日と外部委託顧問料計算 ||16473  |'2008/03/03 START '計算開始日と外部委託顧問料計算 
16497  |                    '等しい場合                   ||16474  |                    '等しい場合                   
16498  |                    If sStart = gbuMGetUPDRec.N(lR||16475  |                    If sStart = gbuMGetUPDRec.N(lR
16499  |                        StartFlg = "1"            ||16476  |                        StartFlg = "1"            
16500  |                    Else                          ||16477  |                    Else                          
16501  |                        StartFlg = "0"            ||16478  |                        StartFlg = "0"            
16502  |                    End If                        ||16479  |                    End If                        
16503  |'2008/03/03 END   '計算開始日と外部委託顧問料計算 ||16480  |'2008/03/03 END   '計算開始日と外部委託顧問料計算 
16504  |                                                  ||16481  |                                                  
16505  |                    '計算開始日と外部委託顧問料計 ||16482  |                    '計算開始日と外部委託顧問料計 
16506  |                    If sStart = gbuMGetUPDRec.N(lR||16483  |                    If sStart = gbuMGetUPDRec.N(lR
16507  |                        '== SQL1 ==               ||16484  |                        '== SQL1 ==               
16508  |                        sSql = ""                 ||16485  |                        sSql = ""                 
16509  |                        sSql = sSql & "SELECT EIGY||16486  |                        sSql = sSql & "SELECT EIGY
16510  |                                                  ||16487  |                                                  
16511  |                        'ﾀﾞｲﾅｾｯﾄの作成            ||16488  |                        'ﾀﾞｲﾅｾｯﾄの作成            
16512  |                        If gintDyCreate(sSql) = Fa||16489  |                        If gintDyCreate(sSql) = Fa
16513  |                            Exit Function         ||16490  |                            Exit Function         
16514  |                        Else                      ||16491  |                        Else                      
16515  |                            '計算開始日が休日の場 ||16492  |                            '計算開始日が休日の場 
16516  |                            If gvlnDyDataS("EIGYO_||16493  |                            If gvlnDyDataS("EIGYO_
16517  |                                '翌営業日のNAVを取||16494  |                                '翌営業日のNAVを取
16518  |                                '== SQL2 ==       ||16495  |                                '== SQL2 ==       
16519  |                                sSql = ""         ||16496  |                                sSql = ""         
16520  |                                sSql = sSql & "SEL||16497  |                                sSql = sSql & "SEL
16521  |                                sSql = sSql & "FRO||16498  |                                sSql = sSql & "FRO
16522  |                                sSql = sSql & "(SE||16499  |                                sSql = sSql & "(SE
16523  |                                sSql = sSql & "WHE||16500  |                                sSql = sSql & "WHE
16524  |                                                  ||16501  |                                                  
16525  |                                'ﾀﾞｲﾅｾｯﾄの作成    ||16502  |                                'ﾀﾞｲﾅｾｯﾄの作成    
16526  |                                If gintDyCreate(sS||16503  |                                If gintDyCreate(sS
16527  |                                    Exit Function ||16504  |                                    Exit Function 
16528  |                                Else              ||16505  |                                Else              
16529  |                                    ddblNearNav = ||16506  |                                    ddblNearNav = 
16530  |'2008/03/06 START 時価総額基準の外部委託顧問料対応||16507  |'2008/03/06 START 時価総額基準の外部委託顧問料対応
16531  |'                                    '翌営業日の計||16508  |'                                    '翌営業日の計
16532  |'                                    '== SQL3 ==  ||16509  |'                                    '== SQL3 ==  
16533  |'                                    sSql = ""    ||16510  |'                                    sSql = ""    
16534  |'                                    sSql = sSql &||16511  |'                                    sSql = sSql &
16535  |'                                    sSql = sSql &||16512  |'                                    sSql = sSql &
16536  |'                                    sSql = sSql &||16513  |'                                    sSql = sSql &
16537  |'                                    sSql = sSql &||16514  |'                                    sSql = sSql &
16538  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||16515  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
16539  |'                                    If gintDyCrea||16516  |'                                    If gintDyCrea
16540  |'                                        Exit Func||16517  |'                                        Exit Func
16541  |'                                    Else         ||16518  |'                                    Else         
16542  |'                                        '計算開始||16519  |'                                        '計算開始
16543  |'                                        sStart = ||16520  |'                                        sStart = 
16544  |'                                        dStart = ||16521  |'                                        dStart = 
16545  |'                                        .Cells(15||16522  |'                                        .Cells(15
16546  |'                                            CStr(||16523  |'                                            CStr(
16547  |'                                        iCalcNum ||16524  |'                                        iCalcNum 
16548  |'                                    End If       ||16525  |'                                    End If       
16549  |'2008/03/06 END   時価総額基準の外部委託顧問料対応||16526  |'2008/03/06 END   時価総額基準の外部委託顧問料対応
16550  |                                                  ||16527  |                                                  
16551  |                                    'SQL文の作成( ||16528  |                                    'SQL文の作成( 
16552  |                                    '計算期間の開 ||16529  |                                    '計算期間の開 
16553  |                                    sSql = gstrEdi||16530  |                                    sSql = gstrEdi
16554  |                                        ContNo, sS||16531  |                                        ContNo, sS
16555  |                                                  ||16532  |                                                  
16556  |                                     'ﾀﾞｲﾅｾｯﾄの作 ||16533  |                                     'ﾀﾞｲﾅｾｯﾄの作 
16557  |                                    If gintDyCreat||16534  |                                    If gintDyCreat
16558  |                                        Exit Funct||16535  |                                        Exit Funct
16559  |                                    End If        ||16536  |                                    End If        
16560  |                                    '配列初期化   ||16537  |                                    '配列初期化   
16561  |                                    ReDim gbuOther||16538  |                                    ReDim gbuOther
16562  |                                    MonthlyCnt = 0||16539  |                                    MonthlyCnt = 0
16563  |                                    'EOF判定処理  ||16540  |                                    'EOF判定処理  
16564  |                                    Do Until gblnD||16541  |                                    Do Until gblnD
16565  |                                        '対象デー ||16542  |                                        '対象デー 
16566  |                                        Call sbOth||16543  |                                        Call sbOth
16567  |                                        MonthlyCnt||16544  |                                        MonthlyCnt
16568  |                                        'ﾀﾞｲﾅｾｯﾄ次||16545  |                                        'ﾀﾞｲﾅｾｯﾄ次
16569  |                                        Call gDyNe||16546  |                                        Call gDyNe
16570  |                                    Loop          ||16547  |                                    Loop          
16571  |                                                  ||16548  |                                                  
16572  |                                    '期中料率変更 ||16549  |                                    '期中料率変更 
16573  |                                    Erase gtypOthe||16550  |                                    Erase gtypOthe
16574  |                                                  ||16551  |                                                  
16575  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||16552  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
16576  |                                    '期中料率変更 ||16553  |                                    '期中料率変更 
16577  |                                    '外部委託顧問 ||16554  |                                    '外部委託顧問 
16578  |                                    If fnSetOtherC||16555  |                                    If fnSetOtherC
16579  |                                                  ||16556  |                                                  
16580  |                                                  ||16557  |                                                  
16581  |                                                  ||16558  |                                                  
16582  |                                                  ||16559  |                                                  
16583  |                                                  ||16560  |                                                  
16584  |                                        Exit Funct||16561  |                                        Exit Funct
16585  |                                    End If        ||16562  |                                    End If        
16586  |'2008/03/03 END 時価総額基準の外部委託顧問料対応( ||16563  |'2008/03/03 END 時価総額基準の外部委託顧問料対応( 
16587  |                                                  ||16564  |                                                  
16588  |                                End If            ||16565  |                                End If            
16589  |                                'RAFI対応 START   ||16566  |                                'RAFI対応 START   
16590  |                                '翌営業日のマザー ||16567  |                                '翌営業日のマザー 
16591  |                                If msAssetFlg = "1||16568  |                                If msAssetFlg = "1
16592  |                                    '== SQL4 ==   ||16569  |                                    '== SQL4 ==   
16593  |                                    sSql = ""     ||16570  |                                    sSql = ""     
16594  |                                    sSql = sSql & ||16571  |                                    sSql = sSql & 
16595  |                                    sSql = sSql & ||16572  |                                    sSql = sSql & 
16596  |                                    sSql = sSql & ||16573  |                                    sSql = sSql & 
16597  |                                    sSql = sSql & ||16574  |                                    sSql = sSql & 
16598  |                                    sSql = sSql & ||16575  |                                    sSql = sSql & 
16599  |                                    sSql = sSql & ||16576  |                                    sSql = sSql & 
16600  |                                    sSql = sSql & ||16577  |                                    sSql = sSql & 
16601  |                                    sSql = sSql & ||16578  |                                    sSql = sSql & 
16602  |                                    sSql = sSql & ||16579  |                                    sSql = sSql & 
16603  |                                    sSql = sSql & ||16580  |                                    sSql = sSql & 
16604  |                                    sSql = sSql & ||16581  |                                    sSql = sSql & 
16605  |                                    sSql = sSql & ||16582  |                                    sSql = sSql & 
16606  |                                    sSql = sSql & ||16583  |                                    sSql = sSql & 
16607  |                                    sSql = sSql & ||16584  |                                    sSql = sSql & 
16608  |                                    sSql = sSql & ||16585  |                                    sSql = sSql & 
16609  |                                    sSql = sSql & ||16586  |                                    sSql = sSql & 
16610  |                                    sSql = sSql & ||16587  |                                    sSql = sSql & 
16611  |                                    sSql = sSql & ||16588  |                                    sSql = sSql & 
16612  |                                    sSql = sSql & ||16589  |                                    sSql = sSql & 
16613  |                                    sSql = sSql & ||16590  |                                    sSql = sSql & 
16614  |                                    sSql = sSql & ||16591  |                                    sSql = sSql & 
16615  |                                    sSql = sSql & ||16592  |                                    sSql = sSql & 
16616  |                                    sSql = sSql & ||16593  |                                    sSql = sSql & 
16617  |                                    sSql = sSql & ||16594  |                                    sSql = sSql & 
16618  |                                    'ﾀﾞｲﾅｾｯﾄの作成||16595  |                                    'ﾀﾞｲﾅｾｯﾄの作成
16619  |                                                  ||16596  |                                                  
16620  |                                    If gintDyCreat||16597  |                                    If gintDyCreat
16621  |                                        Exit Funct||16598  |                                        Exit Funct
16622  |                                    Else          ||16599  |                                    Else          
16623  |                                        ddblNearBa||16600  |                                        ddblNearBa
16624  |                                    End If        ||16601  |                                    End If        
16625  |                                End If            ||16602  |                                End If            
16626  |                                'RAFI対応 END     ||16603  |                                'RAFI対応 END     
16627  |                            End If                ||16604  |                            End If                
16628  |                        End If                    ||16605  |                        End If                    
16629  |                    End If                        ||16606  |                    End If                        
16630  |                    '計算開始日から計算終了日まで ||16607  |                    '計算開始日から計算終了日まで 
16631  |                    '== SQL5 ==                   ||16608  |                    '== SQL5 ==                   
16632  |                    sSql = ""                     ||16609  |                    sSql = ""                     
16633  |                    sSql = sSql & "SELECT CAL_YYYY||16610  |                    sSql = sSql & "SELECT CAL_YYYY
16634  |                    sSql = sSql & "WHERE CAL_YYYY ||16611  |                    sSql = sSql & "WHERE CAL_YYYY 
16635  |                                                  ||16612  |                                                  
16636  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||16613  |                    'ﾀﾞｲﾅｾｯﾄの作成                
16637  |                    If gintDyCreate(sSql) = False ||16614  |                    If gintDyCreate(sSql) = False 
16638  |                        Exit Function             ||16615  |                        Exit Function             
16639  |                    End If                        ||16616  |                    End If                        
16640  |                                                  ||16617  |                                                  
16641  |                    If dlngCnt = 0 Then           ||16618  |                    If dlngCnt = 0 Then           
16642  |                        ReDim dstrCaldate(gbxOraDy||16619  |                        ReDim dstrCaldate(gbxOraDy
16643  |                        ReDim ddblDailynav(gbxOraD||16620  |                        ReDim ddblDailynav(gbxOraD
16644  |                    End If                        ||16621  |                    End If                        
16645  |                                                  ||16622  |                                                  
16646  |                    'EOF判定処理                  ||16623  |                    'EOF判定処理                  
16647  |                    dlngCnt = 0                   ||16624  |                    dlngCnt = 0                   
16648  |                                                  ||16625  |                                                  
16649  |                    Do Until gblnDyEOF()          ||16626  |                    Do Until gblnDyEOF()          
16650  |                        dlngCnt = dlngCnt + 1     ||16627  |                        dlngCnt = dlngCnt + 1     
16651  |                        '抽出データセット         ||16628  |                        '抽出データセット         
16652  |                        dstrCaldate(dlngCnt) = gvl||16629  |                        dstrCaldate(dlngCnt) = gvl
16653  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||16630  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
16654  |                        Call gDyNext              ||16631  |                        Call gDyNext              
16655  |                    Loop                          ||16632  |                    Loop                          
16656  |                                                  ||16633  |                                                  
16657  |                                                  ||16634  |                                                  
16658  |                    '2005/08/26　START            ||16635  |                    '2005/08/26　START            
16659  |                    '変数sStartに格納されている日 ||16636  |                    '変数sStartに格納されている日 
16660  |                    '変数sStartの直近の営業日の日 ||16637  |                    '変数sStartの直近の営業日の日 
16661  |                    '（変数sStartに格納されている ||16638  |                    '（変数sStartに格納されている 
16662  |                    '　直近日付が存在しない場合は ||16639  |                    '　直近日付が存在しない場合は 
16663  |                                                  ||16640  |                                                  
16664  |                    '計算開始日の日次NAV基準日を取||16641  |                    '計算開始日の日次NAV基準日を取
16665  |                    '== SQL6 ==                   ||16642  |                    '== SQL6 ==                   
16666  |                    sSql = ""                     ||16643  |                    sSql = ""                     
16667  |                    sSql = sSql & "SELECT MAX(BASE||16644  |                    sSql = sSql & "SELECT MAX(BASE
16668  |                    sSql = sSql & "FROM   CFR_DAIL||16645  |                    sSql = sSql & "FROM   CFR_DAIL
16669  |                    sSql = sSql & "WHERE  BASE_DAT||16646  |                    sSql = sSql & "WHERE  BASE_DAT
16670  |                    sSql = sSql & "AND    ACCOUNT_||16647  |                    sSql = sSql & "AND    ACCOUNT_
16671  |                                                  ||16648  |                                                  
16672  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||16649  |                    'ﾀﾞｲﾅｾｯﾄの作成                
16673  |                    If gintDyCreate(sSql) = False ||16650  |                    If gintDyCreate(sSql) = False 
16674  |                        Exit Function             ||16651  |                        Exit Function             
16675  |                    End If                        ||16652  |                    End If                        
16676  |                                                  ||16653  |                                                  
16677  |                    Do Until gblnDyEOF()          ||16654  |                    Do Until gblnDyEOF()          
16678  |                       '抽出データセット          ||16655  |                       '抽出データセット          
16679  |                        sStart = gvlnDyDataS("BASE||16656  |                        sStart = gvlnDyDataS("BASE
16680  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||16657  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
16681  |                        Call gDyNext              ||16658  |                        Call gDyNext              
16682  |                    Loop                          ||16659  |                    Loop                          
16683  |                                                  ||16660  |                                                  
16684  |                    'SQL文の作成(外部委託顧問料率 ||16661  |                    'SQL文の作成(外部委託顧問料率 
16685  |                    '計算期間の開始日と終了日に含 ||16662  |                    '計算期間の開始日と終了日に含 
16686  |                    sSql = gstrEditSQLcfr_OtherCom||16663  |                    sSql = gstrEditSQLcfr_OtherCom
16687  |                        ContNo, sStart, mstrNearSe||16664  |                        ContNo, sStart, mstrNearSe
16688  |                                                  ||16665  |                                                  
16689  |                     'ﾀﾞｲﾅｾｯﾄの作成               ||16666  |                     'ﾀﾞｲﾅｾｯﾄの作成               
16690  |                    If gintDyCreate(sSql) = False ||16667  |                    If gintDyCreate(sSql) = False 
16691  |                        Exit Function             ||16668  |                        Exit Function             
16692  |                    End If                        ||16669  |                    End If                        
16693  |                    '配列初期化                   ||16670  |                    '配列初期化                   
16694  |                    ReDim gbuOtherComRateGetUPDRec||16671  |                    ReDim gbuOtherComRateGetUPDRec
16695  |                    MonthlyCnt = 0                ||16672  |                    MonthlyCnt = 0                
16696  |                    'EOF判定処理                  ||16673  |                    'EOF判定処理                  
16697  |                    Do Until gblnDyEOF()          ||16674  |                    Do Until gblnDyEOF()          
16698  |                        '対象データ抽出           ||16675  |                        '対象データ抽出           
16699  |                        Call sbOtherComDataGet(Mon||16676  |                        Call sbOtherComDataGet(Mon
16700  |                        MonthlyCnt = MonthlyCnt + ||16677  |                        MonthlyCnt = MonthlyCnt + 
16701  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||16678  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
16702  |                        Call gDyNext              ||16679  |                        Call gDyNext              
16703  |                    Loop                          ||16680  |                    Loop                          
16704  |                                                  ||16681  |                                                  
16705  |                    '期中料率変更用配列のクリア   ||16682  |                    '期中料率変更用配列のクリア   
16706  |                    Erase gtypOtherComRec         ||16683  |                    Erase gtypOtherComRec         
16707  |                                                  ||16684  |                                                  
16708  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||16685  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
16709  |                    '期中料率変更対象契約         ||16686  |                    '期中料率変更対象契約         
16710  |                    '外部委託顧問料率を定義体配列 ||16687  |                    '外部委託顧問料率を定義体配列 
16711  |                    If fnSetOtherComRate(gbuMGetUP||16688  |                    If fnSetOtherComRate(gbuMGetUP
16712  |                                         msAssetFl||16689  |                                         msAssetFl
16713  |                                         gbuMGetUP||16690  |                                         gbuMGetUP
16714  |                                         conDBasse||16691  |                                         conDBasse
16715  |                                         sStart, _||16692  |                                         sStart, _
16716  |                                         StartFlg)||16693  |                                         StartFlg)
16717  |                        Exit Function             ||16694  |                        Exit Function             
16718  |                    End If                        ||16695  |                    End If                        
16719  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||16696  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
16720  |                                                  ||16697  |                                                  
16721  |                    'RAFI対応 START               ||16698  |                    'RAFI対応 START               
16722  |                    '純資産の場合                 ||16699  |                    '純資産の場合                 
16723  |                    If msAssetFlg = "0" Then      ||16700  |                    If msAssetFlg = "0" Then      
16724  |                        '計算開始日から計算終了日 ||16701  |                        '計算開始日から計算終了日 
16725  |                        '== SQL 7 ==              ||16702  |                        '== SQL 7 ==              
16726  |                        sSql = ""                 ||16703  |                        sSql = ""                 
16727  |                        sSql = sSql & "SELECT ACCO||16704  |                        sSql = sSql & "SELECT ACCO
16728  |                        sSql = sSql & "WHERE (((CF||16705  |                        sSql = sSql & "WHERE (((CF
16729  |                        sSql = sSql & "AND ((CFR_D||16706  |                        sSql = sSql & "AND ((CFR_D
16730  |                        sSql = sSql & "AND ((CFR_D||16707  |                        sSql = sSql & "AND ((CFR_D
16731  |                        sSql = sSql & "ORDER BY CF||16708  |                        sSql = sSql & "ORDER BY CF
16732  |                    'マザー組入資産の場合         ||16709  |                    'マザー組入資産の場合         
16733  |                    Else                          ||16710  |                    Else                          
16734  |                        '計算開始日から計算終了日 ||16711  |                        '計算開始日から計算終了日 
16735  |                        '== SQL8 ==               ||16712  |                        '== SQL8 ==               
16736  |                        sSql = ""                 ||16713  |                        sSql = ""                 
16737  |                        sSql = sSql & "SELECT"    ||16714  |                        sSql = sSql & "SELECT"    
16738  |                        sSql = sSql & "    a.ACCOU||16715  |                        sSql = sSql & "    a.ACCOU
16739  |                        sSql = sSql & "    a.BASE_||16716  |                        sSql = sSql & "    a.BASE_
16740  |                        sSql = sSql & "    a.NET_A||16717  |                        sSql = sSql & "    a.NET_A
16741  |                        sSql = sSql & "    b.BABY_||16718  |                        sSql = sSql & "    b.BABY_
16742  |                        sSql = sSql & "    b.BABY_||16719  |                        sSql = sSql & "    b.BABY_
16743  |                        sSql = sSql & " FROM"     ||16720  |                        sSql = sSql & " FROM"     
16744  |                        sSql = sSql & "    CFR_DAI||16721  |                        sSql = sSql & "    CFR_DAI
16745  |                        sSql = sSql & " WHERE"    ||16722  |                        sSql = sSql & " WHERE"    
16746  |                        sSql = sSql & "    b.BABY_||16723  |                        sSql = sSql & "    b.BABY_
16747  |                        sSql = sSql & "    b.MOTHE||16724  |                        sSql = sSql & "    b.MOTHE
16748  |                        sSql = sSql & "    b.BASE_||16725  |                        sSql = sSql & "    b.BASE_
16749  |                        sSql = sSql & "    a.ACCOU||16726  |                        sSql = sSql & "    a.ACCOU
16750  |                        sSql = sSql & "    (a.BASE||16727  |                        sSql = sSql & "    (a.BASE
16751  |                        sSql = sSql & "    a.BASE_||16728  |                        sSql = sSql & "    a.BASE_
16752  |                        sSql = sSql & "    a.CURRE||16729  |                        sSql = sSql & "    a.CURRE
16753  |                        sSql = sSql & "    a.ASSET||16730  |                        sSql = sSql & "    a.ASSET
16754  |                        sSql = sSql & " ORDER BY" ||16731  |                        sSql = sSql & " ORDER BY" 
16755  |                        sSql = sSql & "    a.BASE_||16732  |                        sSql = sSql & "    a.BASE_
16756  |                    End If                        ||16733  |                    End If                        
16757  |                    'RAFI対応 END                 ||16734  |                    'RAFI対応 END                 
16758  |                                                  ||16735  |                                                  
16759  |                    If gintDyCreate(sSql) = False ||16736  |                    If gintDyCreate(sSql) = False 
16760  |                        Exit Function             ||16737  |                        Exit Function             
16761  |                    End If                        ||16738  |                    End If                        
16762  |                                                  ||16739  |                                                  
16763  |                    dlngCntsv = dlngCnt           ||16740  |                    dlngCntsv = dlngCnt           
16764  |                    dlngCnt = 0                   ||16741  |                    dlngCnt = 0                   
16765  |                                                  ||16742  |                                                  
16766  |                    Do Until gblnDyEOF()          ||16743  |                    Do Until gblnDyEOF()          
16767  |                        dlngCnt = dlngCnt + 1     ||16744  |                        dlngCnt = dlngCnt + 1     
16768  |                        '抽出データセット         ||16745  |                        '抽出データセット         
16769  |                        dstrBasedate = gvlnDyDataS||16746  |                        dstrBasedate = gvlnDyDataS
16770  |                        If Mid(dstrCaldate(dlngCnt||16747  |                        If Mid(dstrCaldate(dlngCnt
16771  |                            'RAFI対応 START       ||16748  |                            'RAFI対応 START       
16772  |                            '純資産の場合         ||16749  |                            '純資産の場合         
16773  |                            If msAssetFlg = "0" Th||16750  |                            If msAssetFlg = "0" Th
16774  |                                ddblDailynav(dlngC||16751  |                                ddblDailynav(dlngC
16775  |                            'マザー組入資産の場合 ||16752  |                            'マザー組入資産の場合 
16776  |                            Else                  ||16753  |                            Else                  
16777  |                                ddblDailynav(dlngC||16754  |                                ddblDailynav(dlngC
16778  |                            End If                ||16755  |                            End If                
16779  |                            'RAFI対応 END         ||16756  |                            'RAFI対応 END         
16780  |                        Else                      ||16757  |                        Else                      
16781  |                            '計算開始日が外部委託 ||16758  |                            '計算開始日が外部委託 
16782  |                            If ddblNearNav <> 0 An||16759  |                            If ddblNearNav <> 0 An
16783  |                                dstrCaldate2 = Mid||16760  |                                dstrCaldate2 = Mid
16784  |                                dstrBasedate2 = Mi||16761  |                                dstrBasedate2 = Mi
16785  |                                dlngDiffdate = Dat||16762  |                                dlngDiffdate = Dat
16786  |                                                  ||16763  |                                                  
16787  |                                For dintFor2 = 1 T||16764  |                                For dintFor2 = 1 T
16788  |                                    'RAFI対応 STAR||16765  |                                    'RAFI対応 STAR
16789  |                                    '純資産の場合 ||16766  |                                    '純資産の場合 
16790  |                                    If msAssetFlg ||16767  |                                    If msAssetFlg 
16791  |                                        ddblDailyn||16768  |                                        ddblDailyn
16792  |                                    'マザー組入資 ||16769  |                                    'マザー組入資 
16793  |                                    Else          ||16770  |                                    Else          
16794  |                                        ddblDailyn||16771  |                                        ddblDailyn
16795  |                                    End If        ||16772  |                                    End If        
16796  |                                    'RAFI対応 END ||16773  |                                    'RAFI対応 END 
16797  |                                    dlngCnt = dlng||16774  |                                    dlngCnt = dlng
16798  |                                Next dintFor2     ||16775  |                                Next dintFor2     
16799  |                                'RAFI対応 START   ||16776  |                                'RAFI対応 START   
16800  |                                '純資産の場合     ||16777  |                                '純資産の場合     
16801  |                                If msAssetFlg = "0||16778  |                                If msAssetFlg = "0
16802  |                                    ddblDailynav(d||16779  |                                    ddblDailynav(d
16803  |                                'マザー組入資産の ||16780  |                                'マザー組入資産の 
16804  |                                Else              ||16781  |                                Else              
16805  |                                    ddblDailynav(d||16782  |                                    ddblDailynav(d
16806  |                                End If            ||16783  |                                End If            
16807  |                                'RAFI対応 END     ||16784  |                                'RAFI対応 END     
16808  |                            Else                  ||16785  |                            Else                  
16809  |                                '日次NAVにデータが||16786  |                                '日次NAVにデータが
16810  |                                dstrCaldate2 = Mid||16787  |                                dstrCaldate2 = Mid
16811  |                                dstrBasedate2 = Mi||16788  |                                dstrBasedate2 = Mi
16812  |                                dlngDiffdate = Dat||16789  |                                dlngDiffdate = Dat
16813  |                                                  ||16790  |                                                  
16814  |                                For dintFor2 = 1 T||16791  |                                For dintFor2 = 1 T
16815  |                                    If ddblDailyna||16792  |                                    If ddblDailyna
16816  |                                        ddblDailyn||16793  |                                        ddblDailyn
16817  |                                    Else          ||16794  |                                    Else          
16818  |                                        '日次NAVに||16795  |                                        '日次NAVに
16819  |                                        intRtn = M||16796  |                                        intRtn = M
16820  |                                        vbLf & "対||16797  |                                        vbLf & "対
16821  |                                        vbLf & "基||16798  |                                        vbLf & "基
16822  |                                            vbCrit||16799  |                                            vbCrit
16823  |                                        Exit Funct||16800  |                                        Exit Funct
16824  |                                    End If        ||16801  |                                    End If        
16825  |                                    dlngCnt = dlng||16802  |                                    dlngCnt = dlng
16826  |                                Next dintFor2     ||16803  |                                Next dintFor2     
16827  |                                'RAFI対応 START   ||16804  |                                'RAFI対応 START   
16828  |                                '純資産の場合     ||16805  |                                '純資産の場合     
16829  |                                If msAssetFlg = "0||16806  |                                If msAssetFlg = "0
16830  |                                    ddblDailynav(d||16807  |                                    ddblDailynav(d
16831  |                                'マザー組入資産の ||16808  |                                'マザー組入資産の 
16832  |                                Else              ||16809  |                                Else              
16833  |                                    ddblDailynav(d||16810  |                                    ddblDailynav(d
16834  |                                End If            ||16811  |                                End If            
16835  |                                'RAFI対応 END     ||16812  |                                'RAFI対応 END     
16836  |                            End If                ||16813  |                            End If                
16837  |                                                  ||16814  |                                                  
16838  |                        End If                    ||16815  |                        End If                    
16839  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||16816  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
16840  |                        Call gDyNext              ||16817  |                        Call gDyNext              
16841  |                    Loop                          ||16818  |                    Loop                          
16842  |                                                  ||16819  |                                                  
16843  |                                                  ||16820  |                                                  
16844  |                Next dintFor                      ||16821  |                Next dintFor                      
16845  |                                                  ||16822  |                                                  
16846  |                If dlngCntsv <> dlngCnt Then      ||16823  |                If dlngCntsv <> dlngCnt Then      
16847  |                    For dintFor2 = dlngCnt + 1 To ||16824  |                    For dintFor2 = dlngCnt + 1 To 
16848  |                        ddblDailynav(dintFor2) = d||16825  |                        ddblDailynav(dintFor2) = d
16849  |                    Next dintFor2                 ||16826  |                    Next dintFor2                 
16850  |                    dlngCnt = dlngCntsv           ||16827  |                    dlngCnt = dlngCntsv           
16851  |                End If                            ||16828  |                End If                            
16852  |                                                  ||16829  |                                                  
16853  |                ddblTtalnav = 0                   ||16830  |                ddblTtalnav = 0                   
16854  |                                                  ||16831  |                                                  
16855  |                For dintFor2 = 1 To dlngCnt       ||16832  |                For dintFor2 = 1 To dlngCnt       
16856  |                    ddblTtalnav = ddblTtalnav + dd||16833  |                    ddblTtalnav = ddblTtalnav + dd
16857  |                Next dintFor2                     ||16834  |                Next dintFor2                     
16858  |                                                  ||16835  |                                                  
16859  |                'カレンダーを元に日次NAVを配列より||16836  |                'カレンダーを元に日次NAVを配列より
16860  |                K = 0                             ||16837  |                K = 0                             
16861  |                For i = 1 To dlngCnt              ||16838  |                For i = 1 To dlngCnt              
16862  |                    '計算開始日の日次NAVは無条件に||16839  |                    '計算開始日の日次NAVは無条件に
16863  |                    If i = 1 Then                 ||16840  |                    If i = 1 Then                 
16864  |                        gtypOtherComRec(K).APPLY_T||16841  |                        gtypOtherComRec(K).APPLY_T
16865  |                    Else                          ||16842  |                    Else                          
16866  |                        '適用終了日に成るまで累積 ||16843  |                        '適用終了日に成るまで累積 
16867  |                        If Mid(dstrCaldate(i), 1, ||16844  |                        If Mid(dstrCaldate(i), 1, 
16868  |                            gtypOtherComRec(K).APP||16845  |                            gtypOtherComRec(K).APP
16869  |                        'カレンダー日付が適用終了 ||16846  |                        'カレンダー日付が適用終了 
16870  |                        Else                      ||16847  |                        Else                      
16871  |                            '料率変更毎に平均NAVを||16848  |                            '料率変更毎に平均NAVを
16872  |                            gtypOtherComRec(K).APP||16849  |                            gtypOtherComRec(K).APP
16873  |                            '次の料率へシフトする ||16850  |                            '次の料率へシフトする 
16874  |                            K = K + 1             ||16851  |                            K = K + 1             
16875  |                            gtypOtherComRec(K).APP||16852  |                            gtypOtherComRec(K).APP
16876  |                        End If                    ||16853  |                        End If                    
16877  |                    End If                        ||16854  |                    End If                        
16878  |                    '最後のレコードの場合NAV平均を||16855  |                    '最後のレコードの場合NAV平均を
16879  |                    If i = dlngCnt Then           ||16856  |                    If i = dlngCnt Then           
16880  |                        '料率変更毎に平均NAVを算出||16857  |                        '料率変更毎に平均NAVを算出
16881  |                        gtypOtherComRec(K).APPLY_N||16858  |                        gtypOtherComRec(K).APPLY_N
16882  |                    End If                        ||16859  |                    End If                        
16883  |                Next i                            ||16860  |                Next i                            
16884  |                                                  ||16861  |                                                  
16885  |                iRowCnt = dlngCnt                 ||16862  |                iRowCnt = dlngCnt                 
16886  |                TotalNav = ddblTtalnav            ||16863  |                TotalNav = ddblTtalnav            
16887  |                dblValueIn = TotalNav             ||16864  |                dblValueIn = TotalNav             
16888  |                Call sbGetRoundValue2(dblValueIn) ||16865  |                Call sbGetRoundValue2(dblValueIn) 
16889  |                TotalNav = dblValueOut            ||16866  |                TotalNav = dblValueOut            
16890  |                                                  ||16867  |                                                  
16891  |                '合計(月末純資産)                 ||16868  |                '合計(月末純資産)                 
16892  |                .Cells(17, 23).NumberFormatLocal =||16869  |                .Cells(17, 23).NumberFormatLocal =
16893  |                    If gbuMGetUPDRec.N(lRecIdx).MG||16870  |                    If gbuMGetUPDRec.N(lRecIdx).MG
16894  |                        .Cells(17, 23).Value = CSt||16871  |                        .Cells(17, 23).Value = CSt
16895  |                    Else                          ||16872  |                    Else                          
16896  |                        .Cells(17, 23).Value = CSt||16873  |                        .Cells(17, 23).Value = CSt
16897  |                    End If                        ||16874  |                    End If                        
16898  |                .Cells(17, 23).HorizontalAlignment||16875  |                .Cells(17, 23).HorizontalAlignment
16899  |'2006/08/16 START 期中料率変更契約/RAFI対応のため ||16876  |'2006/08/16 START 期中料率変更契約/RAFI対応のため 
16900  |'                '平均純資産総額                  ||16877  |'                '平均純資産総額                  
16901  |'                .Cells(36, 2).Value = sWord51    ||16878  |'                .Cells(36, 2).Value = sWord51    
16902  |'                .Cells(36, 11).Value = sWord19   ||16879  |'                .Cells(36, 11).Value = sWord19   
16903  |'2006/08/16 END   期中料率変更契約/RAFI対応のため ||16880  |'2006/08/16 END   期中料率変更契約/RAFI対応のため 
16904  |                                                  ||16881  |                                                  
16905  |                '平均純資産総額                   ||16882  |                '平均純資産総額                   
16906  |                .Cells(42, 2).Value = sWord51     ||16883  |                .Cells(42, 2).Value = sWord51     
16907  |                .Cells(42, 11).Value = sWord19    ||16884  |                .Cells(42, 11).Value = sWord19    
16908  |                '平均純資産総額は別紙に記載       ||16885  |                '平均純資産総額は別紙に記載       
16909  |                '.Cells(39, 13).Value = sWord54   ||16886  |                '.Cells(39, 13).Value = sWord54   
16910  |                .Cells(42, 13).Value = sWord54    ||16887  |                .Cells(42, 13).Value = sWord54    
16911  |                                                  ||16888  |                                                  
16912  |'2006/08/16 START 期中料率変更契約/RAFI対応のため ||16889  |'2006/08/16 START 期中料率変更契約/RAFI対応のため 
16913  |'                '計算期間の純資産総額の合計(月末 ||16890  |'                '計算期間の純資産総額の合計(月末 
16914  |'                .Cells(36, 23).NumberFormatLocal ||16891  |'                .Cells(36, 23).NumberFormatLocal 
16915  |'                    If gbuMGetUPDRec.N(lRecIdx).M||16892  |'                    If gbuMGetUPDRec.N(lRecIdx).M
16916  |'                        .Cells(36, 23).Value = CS||16893  |'                        .Cells(36, 23).Value = CS
16917  |'                    Else                         ||16894  |'                    Else                         
16918  |'                        .Cells(36, 23).Value = CS||16895  |'                        .Cells(36, 23).Value = CS
16919  |'                    End If                       ||16896  |'                    End If                       
16920  |'                .Cells(36, 23).HorizontalAlignmen||16897  |'                .Cells(36, 23).HorizontalAlignmen
16921  |'                '計算期間の純資産総額の合計÷計算||16898  |'                '計算期間の純資産総額の合計÷計算
16922  |'                .Cells(36, 35).NumberFormatLocal ||16899  |'                .Cells(36, 35).NumberFormatLocal 
16923  |'                dblValueIn = TotalNav / iRowCnt  ||16900  |'                dblValueIn = TotalNav / iRowCnt  
16924  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||16901  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
16925  |'                    Call sbGetRoundValue2(dblValu||16902  |'                    Call sbGetRoundValue2(dblValu
16926  |'                Else                             ||16903  |'                Else                             
16927  |'                    Call sbGetRoundValue(dblValue||16904  |'                    Call sbGetRoundValue(dblValue
16928  |'                End If                           ||16905  |'                End If                           
16929  |'                    If gbuMGetUPDRec.N(lRecIdx).M||16906  |'                    If gbuMGetUPDRec.N(lRecIdx).M
16930  |'                        .Cells(36, 35).Value = CS||16907  |'                        .Cells(36, 35).Value = CS
16931  |'                    Else                         ||16908  |'                    Else                         
16932  |'                        .Cells(36, 35).Value = CS||16909  |'                        .Cells(36, 35).Value = CS
16933  |'                    End If                       ||16910  |'                    End If                       
16934  |'                '÷??＝ ,文言                    ||16911  |'                '÷??＝ ,文言                    
16935  |'                .Cells(36, 26).Value = sWord18 & ||16912  |'                .Cells(36, 26).Value = sWord18 & 
16936  |'2006/08/16 END   期中料率変更契約/RAFI対応のため ||16913  |'2006/08/16 END   期中料率変更契約/RAFI対応のため 
16937  |                                                  ||16914  |                                                  
16938  |                '計算期間の純資産総額の合計÷計算 ||16915  |                '計算期間の純資産総額の合計÷計算 
16939  |                dblValueIn = TotalNav / iRowCnt   ||16916  |                dblValueIn = TotalNav / iRowCnt   
16940  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||16917  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
16941  |                    Call sbGetRoundValue2(dblValue||16918  |                    Call sbGetRoundValue2(dblValue
16942  |                Else                              ||16919  |                Else                              
16943  |                    Call sbGetRoundValue(dblValueI||16920  |                    Call sbGetRoundValue(dblValueI
16944  |                End If                            ||16921  |                End If                            
16945  |                AvgNav = dblValueOut              ||16922  |                AvgNav = dblValueOut              
16946  |            End If                                ||16923  |            End If                                
16947  |'契約区分：名称使用許諾料計算　かつ　日次NAV(休日 ||16924  |'契約区分：名称使用許諾料計算　かつ　日次NAV(休日 
16948  |        Else                                      ||16925  |        Else                                      
16949  |                                                  ||16926  |                                                  
16950  |On Error GoTo OnErrorProc                         ||16927  |On Error GoTo OnErrorProc                         
16951  |                                                  ||16928  |                                                  
16952  |            '契約区分「3」の場合                  ||16929  |            '契約区分「3」の場合                  
16953  |            ddblTtalnav = 0                       ||16930  |            ddblTtalnav = 0                       
16954  |            For dintFor = 0 To NavGetCnt - 1      ||16931  |            For dintFor = 0 To NavGetCnt - 1      
16955  |                                                  ||16932  |                                                  
16956  |                '日次NAV平均取得                  ||16933  |                '日次NAV平均取得                  
16957  |                sStart = gstrDateFormat2(CStr(dSta||16934  |                sStart = gstrDateFormat2(CStr(dSta
16958  |                sEnd = gstrDateFormat2(CStr(dEnd),||16935  |                sEnd = gstrDateFormat2(CStr(dEnd),
16959  |                                                  ||16936  |                                                  
16960  |                'RAFI対応 START                   ||16937  |                'RAFI対応 START                   
16961  |                '純資産の場合                     ||16938  |                '純資産の場合                     
16962  |                If msAssetFlg = "0" Then          ||16939  |                If msAssetFlg = "0" Then          
16963  |                    '計算開始日から計算終了日まで ||16940  |                    '計算開始日から計算終了日まで 
16964  |                    sSql = ""                     ||16941  |                    sSql = ""                     
16965  |                    sSql = sSql & "SELECT ACCOUNT_||16942  |                    sSql = sSql & "SELECT ACCOUNT_
16966  |                    sSql = sSql & "WHERE (((CFR_DA||16943  |                    sSql = sSql & "WHERE (((CFR_DA
16967  |                    sSql = sSql & "AND ((CFR_DAILY||16944  |                    sSql = sSql & "AND ((CFR_DAILY
16968  |                    sSql = sSql & "AND ((CFR_DAILY||16945  |                    sSql = sSql & "AND ((CFR_DAILY
16969  |                    sSql = sSql & "ORDER BY CFR_DA||16946  |                    sSql = sSql & "ORDER BY CFR_DA
16970  |                'マザー組入資産の場合             ||16947  |                'マザー組入資産の場合             
16971  |                Else                              ||16948  |                Else                              
16972  |                    '計算開始日から計算終了日まで ||16949  |                    '計算開始日から計算終了日まで 
16973  |                    sSql = ""                     ||16950  |                    sSql = ""                     
16974  |                    sSql = sSql & "SELECT"        ||16951  |                    sSql = sSql & "SELECT"        
16975  |                    sSql = sSql & "    a.ACCOUNT_C||16952  |                    sSql = sSql & "    a.ACCOUNT_C
16976  |                    sSql = sSql & "    a.BASE_DATE||16953  |                    sSql = sSql & "    a.BASE_DATE
16977  |                    sSql = sSql & "    a.NET_ASSET||16954  |                    sSql = sSql & "    a.NET_ASSET
16978  |                    sSql = sSql & "    b.BABY_MOTH||16955  |                    sSql = sSql & "    b.BABY_MOTH
16979  |                    sSql = sSql & "    b.BABY_MOTH||16956  |                    sSql = sSql & "    b.BABY_MOTH
16980  |                    sSql = sSql & " FROM"         ||16957  |                    sSql = sSql & " FROM"         
16981  |                    sSql = sSql & "    CFR_DAILY_N||16958  |                    sSql = sSql & "    CFR_DAILY_N
16982  |                    sSql = sSql & " WHERE"        ||16959  |                    sSql = sSql & " WHERE"        
16983  |                    sSql = sSql & "    b.BABY_ACCO||16960  |                    sSql = sSql & "    b.BABY_ACCO
16984  |                    sSql = sSql & "    b.MOTHER_AC||16961  |                    sSql = sSql & "    b.MOTHER_AC
16985  |                    sSql = sSql & "    b.BASE_DATE||16962  |                    sSql = sSql & "    b.BASE_DATE
16986  |                    sSql = sSql & "    a.ACCOUNT_C||16963  |                    sSql = sSql & "    a.ACCOUNT_C
16987  |                    sSql = sSql & "    (a.BASE_DAT||16964  |                    sSql = sSql & "    (a.BASE_DAT
16988  |                    sSql = sSql & "    a.BASE_DATE||16965  |                    sSql = sSql & "    a.BASE_DATE
16989  |                    sSql = sSql & "    a.CURRENCY_||16966  |                    sSql = sSql & "    a.CURRENCY_
16990  |                    sSql = sSql & "    a.ASSET_TYP||16967  |                    sSql = sSql & "    a.ASSET_TYP
16991  |                    sSql = sSql & " ORDER BY"     ||16968  |                    sSql = sSql & " ORDER BY"     
16992  |                    sSql = sSql & "    a.BASE_DATE||16969  |                    sSql = sSql & "    a.BASE_DATE
16993  |                End If                            ||16970  |                End If                            
16994  |                'RAFI対応 END                     ||16971  |                'RAFI対応 END                     
16995  |                                                  ||16972  |                                                  
16996  |                If gintDyCreate(sSql) = False Then||16973  |                If gintDyCreate(sSql) = False Then
16997  |                    Exit Function                 ||16974  |                    Exit Function                 
16998  |                End If                            ||16975  |                End If                            
16999  |                                                  ||16976  |                                                  
17000  |                If dlngCnt = 0 Then               ||16977  |                If dlngCnt = 0 Then               
17001  |                    ReDim dstrCaldate(gbxOraDynase||16978  |                    ReDim dstrCaldate(gbxOraDynase
17002  |                    ReDim ddblDailynav(gbxOraDynas||16979  |                    ReDim ddblDailynav(gbxOraDynas
17003  |                End If                            ||16980  |                End If                            
17004  |                                                  ||16981  |                                                  
17005  |                dlngCnt = 0                       ||16982  |                dlngCnt = 0                       
17006  |                                                  ||16983  |                                                  
17007  |                Do Until gblnDyEOF()              ||16984  |                Do Until gblnDyEOF()              
17008  |                    dlngCnt = dlngCnt + 1         ||16985  |                    dlngCnt = dlngCnt + 1         
17009  |                    'RAFI対応 START               ||16986  |                    'RAFI対応 START               
17010  |                    '純資産の場合                 ||16987  |                    '純資産の場合                 
17011  |                    If msAssetFlg = "0" Then      ||16988  |                    If msAssetFlg = "0" Then      
17012  |                        '抽出データセット         ||16989  |                        '抽出データセット         
17013  |                        dstrCaldate(dlngCnt) = gvl||16990  |                        dstrCaldate(dlngCnt) = gvl
17014  |                        ddblDailynav(dlngCnt) = dd||16991  |                        ddblDailynav(dlngCnt) = dd
17015  |                    'マザー組入資産の場合         ||16992  |                    'マザー組入資産の場合         
17016  |                    Else                          ||16993  |                    Else                          
17017  |                        dstrCaldate(dlngCnt) = gvl||16994  |                        dstrCaldate(dlngCnt) = gvl
17018  |                        ddblDailynav(dlngCnt) = dd||16995  |                        ddblDailynav(dlngCnt) = dd
17019  |                    End If                        ||16996  |                    End If                        
17020  |                    'RAFI対応 END                 ||16997  |                    'RAFI対応 END                 
17021  |                                                  ||16998  |                                                  
17022  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             ||16999  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             
17023  |                    Call gDyNext                  ||17000  |                    Call gDyNext                  
17024  |                Loop                              ||17001  |                Loop                              
17025  |                                                  ||17002  |                                                  
17026  |            Next dintFor                          ||17003  |            Next dintFor                          
17027  |                                                  ||17004  |                                                  
17028  |            ddblTtalnav = 0                       ||17005  |            ddblTtalnav = 0                       
17029  |                                                  ||17006  |                                                  
17030  |            For dintFor2 = 1 To dlngCnt           ||17007  |            For dintFor2 = 1 To dlngCnt           
17031  |                ddblTtalnav = ddblTtalnav + ddblDa||17008  |                ddblTtalnav = ddblTtalnav + ddblDa
17032  |            Next dintFor2                         ||17009  |            Next dintFor2                         
17033  |                                                  ||17010  |                                                  
17034  |            'SQL文の作成(外部委託顧問料率取得)    ||17011  |            'SQL文の作成(外部委託顧問料率取得)    
17035  |            '計算期間の開始日と終了日に含まれる適 ||17012  |            '計算期間の開始日と終了日に含まれる適 
17036  |            sSql = gstrEditSQLcfr_OtherComRateForS||17013  |            sSql = gstrEditSQLcfr_OtherComRateForS
17037  |                ContNo, sStart, sEnd)             ||17014  |                ContNo, sStart, sEnd)             
17038  |                                                  ||17015  |                                                  
17039  |             'ﾀﾞｲﾅｾｯﾄの作成                       ||17016  |             'ﾀﾞｲﾅｾｯﾄの作成                       
17040  |            If gintDyCreate(sSql) = False Then    ||17017  |            If gintDyCreate(sSql) = False Then    
17041  |                Exit Function                     ||17018  |                Exit Function                     
17042  |            End If                                ||17019  |            End If                                
17043  |            '配列初期化                           ||17020  |            '配列初期化                           
17044  |            ReDim gbuOtherComRateGetUPDRec.N(0)   ||17021  |            ReDim gbuOtherComRateGetUPDRec.N(0)   
17045  |            MonthlyCnt = 0                        ||17022  |            MonthlyCnt = 0                        
17046  |            'EOF判定処理                          ||17023  |            'EOF判定処理                          
17047  |            Do Until gblnDyEOF()                  ||17024  |            Do Until gblnDyEOF()                  
17048  |                '対象データ抽出                   ||17025  |                '対象データ抽出                   
17049  |                Call sbOtherComDataGet(MonthlyCnt)||17026  |                Call sbOtherComDataGet(MonthlyCnt)
17050  |                MonthlyCnt = MonthlyCnt + 1       ||17027  |                MonthlyCnt = MonthlyCnt + 1       
17051  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 ||17028  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 
17052  |                Call gDyNext                      ||17029  |                Call gDyNext                      
17053  |            Loop                                  ||17030  |            Loop                                  
17054  |                                                  ||17031  |                                                  
17055  |            '期中料率変更用配列のクリア           ||17032  |            '期中料率変更用配列のクリア           
17056  |            Erase gtypOtherComRec                 ||17033  |            Erase gtypOtherComRec                 
17057  |                                                  ||17034  |                                                  
17058  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||17035  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
17059  |            '期中料率変更対象契約                 ||17036  |            '期中料率変更対象契約                 
17060  |            '外部委託顧問料率を定義体配列にセット ||17037  |            '外部委託顧問料率を定義体配列にセット 
17061  |            If fnSetOtherComRate(gbuMGetUPDRec.N(l||17038  |            If fnSetOtherComRate(gbuMGetUPDRec.N(l
17062  |                                 msAssetFlg, msBab||17039  |                                 msAssetFlg, msBab
17063  |                                 gbuMGetUPDRec.N(l||17040  |                                 gbuMGetUPDRec.N(l
17064  |                                 conDBasset_type_c||17041  |                                 conDBasset_type_c
17065  |                                 " ", _           ||17042  |                                 " ", _           
17066  |                                 "0") = False Then||17043  |                                 "0") = False Then
17067  |                Exit Function                     ||17044  |                Exit Function                     
17068  |            End If                                ||17045  |            End If                                
17069  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||17046  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
17070  |                                                  ||17047  |                                                  
17071  |            'カレンダーを元に日次NAVを配列より取得||17048  |            'カレンダーを元に日次NAVを配列より取得
17072  |            K = 0                                 ||17049  |            K = 0                                 
17073  |            For i = 1 To dlngCnt                  ||17050  |            For i = 1 To dlngCnt                  
17074  |                '計算開始日の日次NAVは無条件に累積||17051  |                '計算開始日の日次NAVは無条件に累積
17075  |                If i = 1 Then                     ||17052  |                If i = 1 Then                     
17076  |                    gtypOtherComRec(K).APPLY_TOTAL||17053  |                    gtypOtherComRec(K).APPLY_TOTAL
17077  |                Else                              ||17054  |                Else                              
17078  |                    '適用終了日に成るまで累積する ||17055  |                    '適用終了日に成るまで累積する 
17079  |                    If Mid(dstrCaldate(i), 1, 8) <||17056  |                    If Mid(dstrCaldate(i), 1, 8) <
17080  |                        gtypOtherComRec(K).APPLY_T||17057  |                        gtypOtherComRec(K).APPLY_T
17081  |                    'カレンダー日付が適用終了日を ||17058  |                    'カレンダー日付が適用終了日を 
17082  |                    Else                          ||17059  |                    Else                          
17083  |                        '料率変更毎に平均NAVを算出||17060  |                        '料率変更毎に平均NAVを算出
17084  |                        gtypOtherComRec(K).APPLY_N||17061  |                        gtypOtherComRec(K).APPLY_N
17085  |                        '次の料率へシフトする     ||17062  |                        '次の料率へシフトする     
17086  |                        K = K + 1                 ||17063  |                        K = K + 1                 
17087  |                        gtypOtherComRec(K).APPLY_T||17064  |                        gtypOtherComRec(K).APPLY_T
17088  |                    End If                        ||17065  |                    End If                        
17089  |                End If                            ||17066  |                End If                            
17090  |                '最後のレコードの場合NAV平均を求め||17067  |                '最後のレコードの場合NAV平均を求め
17091  |                If i = dlngCnt Then               ||17068  |                If i = dlngCnt Then               
17092  |                    '料率変更毎に平均NAVを算出し格||17069  |                    '料率変更毎に平均NAVを算出し格
17093  |                    gtypOtherComRec(K).APPLY_NAV_A||17070  |                    gtypOtherComRec(K).APPLY_NAV_A
17094  |                End If                            ||17071  |                End If                            
17095  |            Next i                                ||17072  |            Next i                                
17096  |                                                  ||17073  |                                                  
17097  |                                                  ||17074  |                                                  
17098  |            iRowCnt = dlngCnt                     ||17075  |            iRowCnt = dlngCnt                     
17099  |            dlngMeisyoSu = dlngCnt                ||17076  |            dlngMeisyoSu = dlngCnt                
17100  |            TotalNav = ddblTtalnav                ||17077  |            TotalNav = ddblTtalnav                
17101  |            dblValueIn = TotalNav                 ||17078  |            dblValueIn = TotalNav                 
17102  |            Call sbGetRoundValue2(dblValueIn)     ||17079  |            Call sbGetRoundValue2(dblValueIn)     
17103  |            TotalNav = dblValueOut                ||17080  |            TotalNav = dblValueOut                
17104  |                                                  ||17081  |                                                  
17105  |            '計算期間の純資産総額の合計÷計算期間 ||17082  |            '計算期間の純資産総額の合計÷計算期間 
17106  |            dblValueIn = TotalNav / iRowCnt       ||17083  |            dblValueIn = TotalNav / iRowCnt       
17107  |            iCalcNum = iRowCnt                    ||17084  |            iCalcNum = iRowCnt                    
17108  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||17085  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
17109  |                  Call sbGetRoundValue2(dblValueIn||17086  |                  Call sbGetRoundValue2(dblValueIn
17110  |            Else                                  ||17087  |            Else                                  
17111  |                  Call sbGetRoundValue(dblValueIn)||17088  |                  Call sbGetRoundValue(dblValueIn)
17112  |            End If                                ||17089  |            End If                                
17113  |            dstrAvgNav = dblValueOut              ||17090  |            dstrAvgNav = dblValueOut              
17114  |            AvgNav = dstrAvgNav                   ||17091  |            AvgNav = dstrAvgNav                   
17115  |                                                  ||17092  |                                                  
17116  |                                                  ||17093  |                                                  
17117  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||17094  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
17118  |            Call gblnDyClose                      ||17095  |            Call gblnDyClose                      
17119  |                                                  ||17096  |                                                  
17120  |            '合計(月末純資産)                     ||17097  |            '合計(月末純資産)                     
17121  |            .Cells(17, 23).NumberFormatLocal = "@"||17098  |            .Cells(17, 23).NumberFormatLocal = "@"
17122  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||17099  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
17123  |                .Cells(17, 23).Value = CStr(Format||17100  |                .Cells(17, 23).Value = CStr(Format
17124  |            Else                                  ||17101  |            Else                                  
17125  |                .Cells(17, 23).Value = CStr(Format||17102  |                .Cells(17, 23).Value = CStr(Format
17126  |            End If                                ||17103  |            End If                                
17127  |            .Cells(17, 23).HorizontalAlignment = x||17104  |            .Cells(17, 23).HorizontalAlignment = x
17128  |'2006/08/16 START 期中料率変更契約/RAFI対応のため ||17105  |'2006/08/16 START 期中料率変更契約/RAFI対応のため 
17129  |'            '平均純資産総額                      ||17106  |'            '平均純資産総額                      
17130  |'            .Cells(36, 2).Value = sWord51        ||17107  |'            .Cells(36, 2).Value = sWord51        
17131  |'            .Cells(36, 11).Value = sWord19       ||17108  |'            .Cells(36, 11).Value = sWord19       
17132  |'            '計算期間の純資産総額の合計(月末純資 ||17109  |'            '計算期間の純資産総額の合計(月末純資 
17133  |'            .Cells(36, 23).NumberFormatLocal = "@||17110  |'            .Cells(36, 23).NumberFormatLocal = "@
17134  |'              If gbuMGetUPDRec.N(lRecIdx).MGET_ba||17111  |'              If gbuMGetUPDRec.N(lRecIdx).MGET_ba
17135  |'                  .Cells(36, 23).Value = CStr(For||17112  |'                  .Cells(36, 23).Value = CStr(For
17136  |'              Else                               ||17113  |'              Else                               
17137  |'                  .Cells(36, 23).Value = CStr(For||17114  |'                  .Cells(36, 23).Value = CStr(For
17138  |'              End If                             ||17115  |'              End If                             
17139  |'            .Cells(36, 23).HorizontalAlignment = ||17116  |'            .Cells(36, 23).HorizontalAlignment = 
17140  |'            '÷??＝                              ||17117  |'            '÷??＝                              
17141  |'            .Cells(36, 26).Value = sWord18 & "   ||17118  |'            .Cells(36, 26).Value = sWord18 & "   
17142  |'            '計算期間の純資産総額の合計÷計算期間||17119  |'            '計算期間の純資産総額の合計÷計算期間
17143  |'            .Cells(36, 35).NumberFormatLocal = "@||17120  |'            .Cells(36, 35).NumberFormatLocal = "@
17144  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base||17121  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base
17145  |'                .Cells(36, 35).Value = CStr(Forma||17122  |'                .Cells(36, 35).Value = CStr(Forma
17146  |'            Else                                 ||17123  |'            Else                                 
17147  |'                .Cells(36, 35).Value = CStr(Forma||17124  |'                .Cells(36, 35).Value = CStr(Forma
17148  |'            End If                               ||17125  |'            End If                               
17149  |'2006/08/16 END   期中料率変更契約/RAFI対応のため ||17126  |'2006/08/16 END   期中料率変更契約/RAFI対応のため 
17150  |            '平均純資産総額                       ||17127  |            '平均純資産総額                       
17151  |            .Cells(42, 2).Value = sWord51         ||17128  |            .Cells(42, 2).Value = sWord51         
17152  |            .Cells(42, 11).Value = sWord19        ||17129  |            .Cells(42, 11).Value = sWord19        
17153  |            '平均純資産総額は別紙に記載           ||17130  |            '平均純資産総額は別紙に記載           
17154  |            '.Cells(39, 13).Value = sWord54       ||17131  |            '.Cells(39, 13).Value = sWord54       
17155  |            .Cells(42, 13).Value = sWord54        ||17132  |            .Cells(42, 13).Value = sWord54        
17156  |                                                  ||17133  |                                                  
17157  |                                                  ||17134  |                                                  
17158  |            ddblExchangeRate = 0                  ||17135  |            ddblExchangeRate = 0                  
17159  |            '投資顧問料計算用計算対象NAVに日次平均||17136  |            '投資顧問料計算用計算対象NAVに日次平均
17160  |            If dstrAvgNav = "" Then               ||17137  |            If dstrAvgNav = "" Then               
17161  |                lCalcNav = 0                      ||17138  |                lCalcNav = 0                      
17162  |            Else                                  ||17139  |            Else                                  
17163  |                dblValueIn = CDbl(dstrAvgNav)     ||17140  |                dblValueIn = CDbl(dstrAvgNav)     
17164  |                '@@@@@ NAV通貨から閾値通貨に換算 @||17141  |                '@@@@@ NAV通貨から閾値通貨に換算 @
17165  |                Select Case gbuMGetUPDRec.N(lRecId||17142  |                Select Case gbuMGetUPDRec.N(lRecId
17166  |                  Case "1"    '固定料率           ||17143  |                  Case "1"    '固定料率           
17167  |                    If gbuMGetUPDRec.N(lRecIdx).MG||17144  |                    If gbuMGetUPDRec.N(lRecIdx).MG
17168  |                        'NAV通貨→JPYの為替レート ||17145  |                        'NAV通貨→JPYの為替レート 
17169  |                        dstrCurrencyCode = gbuMGet||17146  |                        dstrCurrencyCode = gbuMGet
17170  |                        ddblExchangeRate = fnstrEx||17147  |                        ddblExchangeRate = fnstrEx
17171  |                        If ddblExchangeRate = 0 Th||17148  |                        If ddblExchangeRate = 0 Th
17172  |                          intRtn = MsgBox("ＴＴＭ ||17149  |                          intRtn = MsgBox("ＴＴＭ 
17173  |                          vbLf & "対象通貨コード  ||17150  |                          vbLf & "対象通貨コード  
17174  |                          vbLf & "基準日 ： [ " & ||17151  |                          vbLf & "基準日 ： [ " & 
17175  |                              vbCritical, "ＴＴＭ ||17152  |                              vbCritical, "ＴＴＭ 
17176  |                          Exit Function           ||17153  |                          Exit Function           
17177  |                        End If                    ||17154  |                        End If                    
17178  |                        'NAV通貨→JPYへレート換算 ||17155  |                        'NAV通貨→JPYへレート換算 
17179  |                        dblValueIn = dblValueIn * ||17156  |                        dblValueIn = dblValueIn * 
17180  |                    End If                        ||17157  |                    End If                        
17181  |                  Case "2"    '段階料率           ||17158  |                  Case "2"    '段階料率           
17182  |                    If gbuMGetUPDRec.N(lRecIdx).MG||17159  |                    If gbuMGetUPDRec.N(lRecIdx).MG
17183  |                        If gbuMGetUPDRec.N(lRecIdx||17160  |                        If gbuMGetUPDRec.N(lRecIdx
17184  |                        Else                      ||17161  |                        Else                      
17185  |                            '閾値通貨→JPYの為替レ||17162  |                            '閾値通貨→JPYの為替レ
17186  |                            dstrCurrencyCode = gbu||17163  |                            dstrCurrencyCode = gbu
17187  |                            ddblExchangeRate = fns||17164  |                            ddblExchangeRate = fns
17188  |                            If ddblExchangeRate = ||17165  |                            If ddblExchangeRate = 
17189  |                              intRtn = MsgBox("Ｔ ||17166  |                              intRtn = MsgBox("Ｔ 
17190  |                              vbLf & "対象通貨コー||17167  |                              vbLf & "対象通貨コー
17191  |                              vbLf & "基準日 ： [ ||17168  |                              vbLf & "基準日 ： [ 
17192  |                                  vbCritical, "Ｔ ||17169  |                                  vbCritical, "Ｔ 
17193  |                              Exit Function       ||17170  |                              Exit Function       
17194  |                            End If                ||17171  |                            End If                
17195  |                            'JPY→閾値通貨へレート||17172  |                            'JPY→閾値通貨へレート
17196  |                            dblValueIn = dblValueI||17173  |                            dblValueIn = dblValueI
17197  |                        End If                    ||17174  |                        End If                    
17198  |                    Else                          ||17175  |                    Else                          
17199  |                        'NAV通貨→JPYの為替レート ||17176  |                        'NAV通貨→JPYの為替レート 
17200  |                        dstrCurrencyCode = gbuMGet||17177  |                        dstrCurrencyCode = gbuMGet
17201  |                        ddblExchangeRate = fnstrEx||17178  |                        ddblExchangeRate = fnstrEx
17202  |                        If ddblExchangeRate = 0 Th||17179  |                        If ddblExchangeRate = 0 Th
17203  |                          intRtn = MsgBox("ＴＴＭ ||17180  |                          intRtn = MsgBox("ＴＴＭ 
17204  |                          vbLf & "対象通貨コード  ||17181  |                          vbLf & "対象通貨コード  
17205  |                          vbLf & "基準日 ： [ " & ||17182  |                          vbLf & "基準日 ： [ " & 
17206  |                              vbCritical, "ＴＴＭ ||17183  |                              vbCritical, "ＴＴＭ 
17207  |                          Exit Function           ||17184  |                          Exit Function           
17208  |                        End If                    ||17185  |                        End If                    
17209  |                        'NAV通貨→JPYへレート換算 ||17186  |                        'NAV通貨→JPYへレート換算 
17210  |                        dblValueIn = dblValueIn * ||17187  |                        dblValueIn = dblValueIn * 
17211  |                        If gbuMGetUPDRec.N(lRecIdx||17188  |                        If gbuMGetUPDRec.N(lRecIdx
17212  |                        Else                      ||17189  |                        Else                      
17213  |                            '閾値通貨→JPYの為替レ||17190  |                            '閾値通貨→JPYの為替レ
17214  |                            dstrCurrencyCode = gbu||17191  |                            dstrCurrencyCode = gbu
17215  |                            ddblExchangeRate = fns||17192  |                            ddblExchangeRate = fns
17216  |                            If ddblExchangeRate = ||17193  |                            If ddblExchangeRate = 
17217  |                              intRtn = MsgBox("Ｔ ||17194  |                              intRtn = MsgBox("Ｔ 
17218  |                              vbLf & "対象通貨コー||17195  |                              vbLf & "対象通貨コー
17219  |                              vbLf & "基準日 ： [ ||17196  |                              vbLf & "基準日 ： [ 
17220  |                                  vbCritical, "Ｔ ||17197  |                                  vbCritical, "Ｔ 
17221  |                              Exit Function       ||17198  |                              Exit Function       
17222  |                            End If                ||17199  |                            End If                
17223  |                            'JPY→閾値通貨へ逆レー||17200  |                            'JPY→閾値通貨へ逆レー
17224  |                            dblValueIn = dblValueI||17201  |                            dblValueIn = dblValueI
17225  |                        End If                    ||17202  |                        End If                    
17226  |                    End If                        ||17203  |                    End If                        
17227  |                End Select                        ||17204  |                End Select                        
17228  |                '@@@@@ NAV通貨から閾値通貨に換算 @||17205  |                '@@@@@ NAV通貨から閾値通貨に換算 @
17229  |                Call sbGetRoundValue2(dblValueIn) ||17206  |                Call sbGetRoundValue2(dblValueIn) 
17230  |                '閾値レート換算後平均NAV(計算対象N||17207  |                '閾値レート換算後平均NAV(計算対象N
17231  |                lCalcNav = CStr(Format(dblValueOut||17208  |                lCalcNav = CStr(Format(dblValueOut
17232  |            End If                                ||17209  |            End If                                
17233  |                                                  ||17210  |                                                  
17234  |On Error Resume Next                              ||17211  |On Error Resume Next                              
17235  |        End If                                    ||17212  |        End If                                    
17236  |                                                  ||17213  |                                                  
17237  |        '投資顧問料                               ||17214  |        '投資顧問料                               
17238  |        Dim dRitsu As Double    '外部委託顧問料率 ||17215  |        Dim dRitsu As Double    '外部委託顧問料率 
17239  |        dRitsu = 0                                ||17216  |        dRitsu = 0                                
17240  |        TotalRate = 0                             ||17217  |        TotalRate = 0                             
17241  |        ddblExchangeRate = 0                      ||17218  |        ddblExchangeRate = 0                      
17242  |        '計算対象NAVを変数にセット                ||17219  |        '計算対象NAVを変数にセット                
17243  |        lCalcNav = 0                              ||17220  |        lCalcNav = 0                              
17244  |        dblValueIn = TotalNav / iRowCnt           ||17221  |        dblValueIn = TotalNav / iRowCnt           
17245  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    ||17222  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    
17246  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||17223  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
17247  |          Case "1"    '固定料率(固定料率の場合は、||17224  |          Case "1"    '固定料率(固定料率の場合は、
17248  |              'NAV通貨と外部委託顧問料通貨が相違  ||17225  |              'NAV通貨と外部委託顧問料通貨が相違  
17249  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||17226  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
17250  |                'NAV通貨→JPYの為替レートを取得   ||17227  |                'NAV通貨→JPYの為替レートを取得   
17251  |                dstrCurrencyCode = gbuMGetUPDRec.N||17228  |                dstrCurrencyCode = gbuMGetUPDRec.N
17252  |                ddblExchangeRate = fnstrExchangeRa||17229  |                ddblExchangeRate = fnstrExchangeRa
17253  |                If ddblExchangeRate = 0 Then      ||17230  |                If ddblExchangeRate = 0 Then      
17254  |                  intRtn = MsgBox("ＴＴＭが取得で ||17231  |                  intRtn = MsgBox("ＴＴＭが取得で 
17255  |                  vbLf & "対象通貨コード ： [ " & ||17232  |                  vbLf & "対象通貨コード ： [ " & 
17256  |                  vbLf & "基準日 ： [ " & Mid(dstr||17233  |                  vbLf & "基準日 ： [ " & Mid(dstr
17257  |                      vbCritical, "ＴＴＭ取得エラ ||17234  |                      vbCritical, "ＴＴＭ取得エラ 
17258  |                  Exit Function                   ||17235  |                  Exit Function                   
17259  |                End If                            ||17236  |                End If                            
17260  |'                'NAV通貨→JPYへレート換算        ||17237  |'                'NAV通貨→JPYへレート換算        
17261  |'                dblValueIn = dblValueIn * ddblExc||17238  |'                dblValueIn = dblValueIn * ddblExc
17262  |                For i = LBound(gtypOtherComRec) To||17239  |                For i = LBound(gtypOtherComRec) To
17263  |                    'NAV通貨→JPYへレート換算     ||17240  |                    'NAV通貨→JPYへレート換算     
17264  |                    gtypOtherComRec(i).APPLY_NAV_A||17241  |                    gtypOtherComRec(i).APPLY_NAV_A
17265  |                Next i                            ||17242  |                Next i                            
17266  |            End If                                ||17243  |            End If                                
17267  |                                                  ||17244  |                                                  
17268  |          Case "2"    '段階料率                   ||17245  |          Case "2"    '段階料率                   
17269  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||17246  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
17270  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||17247  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
17271  |                Else                              ||17248  |                Else                              
17272  |                    '閾値通貨→JPYの為替レートを取||17249  |                    '閾値通貨→JPYの為替レートを取
17273  |                    dstrCurrencyCode = gbuMGetUPDR||17250  |                    dstrCurrencyCode = gbuMGetUPDR
17274  |                    ddblExchangeRate = fnstrExchan||17251  |                    ddblExchangeRate = fnstrExchan
17275  |                    If ddblExchangeRate = 0 Then  ||17252  |                    If ddblExchangeRate = 0 Then  
17276  |                      intRtn = MsgBox("ＴＴＭが取 ||17253  |                      intRtn = MsgBox("ＴＴＭが取 
17277  |                      vbLf & "対象通貨コード ： [ ||17254  |                      vbLf & "対象通貨コード ： [ 
17278  |                      vbLf & "基準日 ： [ " & Mid(||17255  |                      vbLf & "基準日 ： [ " & Mid(
17279  |                          vbCritical, "ＴＴＭ取得 ||17256  |                          vbCritical, "ＴＴＭ取得 
17280  |                      Exit Function               ||17257  |                      Exit Function               
17281  |                    End If                        ||17258  |                    End If                        
17282  |'                    'JPY→閾値通貨へレート換算   ||17259  |'                    'JPY→閾値通貨へレート換算   
17283  |'                    dblValueIn = dblValueIn * ddb||17260  |'                    dblValueIn = dblValueIn * ddb
17284  |                    For i = LBound(gtypOtherComRec||17261  |                    For i = LBound(gtypOtherComRec
17285  |                        'NAV通貨→JPYへレート換算 ||17262  |                        'NAV通貨→JPYへレート換算 
17286  |                        gtypOtherComRec(i).APPLY_N||17263  |                        gtypOtherComRec(i).APPLY_N
17287  |                    Next i                        ||17264  |                    Next i                        
17288  |                End If                            ||17265  |                End If                            
17289  |            Else                                  ||17266  |            Else                                  
17290  |                'NAV通貨→JPYの為替レートを取得   ||17267  |                'NAV通貨→JPYの為替レートを取得   
17291  |                dstrCurrencyCode = gbuMGetUPDRec.N||17268  |                dstrCurrencyCode = gbuMGetUPDRec.N
17292  |                ddblExchangeRate = fnstrExchangeRa||17269  |                ddblExchangeRate = fnstrExchangeRa
17293  |                If ddblExchangeRate = 0 Then      ||17270  |                If ddblExchangeRate = 0 Then      
17294  |                  intRtn = MsgBox("ＴＴＭが取得で ||17271  |                  intRtn = MsgBox("ＴＴＭが取得で 
17295  |                  vbLf & "対象通貨コード ： [ " & ||17272  |                  vbLf & "対象通貨コード ： [ " & 
17296  |                  vbLf & "基準日 ： [ " & Mid(dstr||17273  |                  vbLf & "基準日 ： [ " & Mid(dstr
17297  |                      vbCritical, "ＴＴＭ取得エラ ||17274  |                      vbCritical, "ＴＴＭ取得エラ 
17298  |                  Exit Function                   ||17275  |                  Exit Function                   
17299  |                End If                            ||17276  |                End If                            
17300  |'                'NAV通貨→JPYへレート換算        ||17277  |'                'NAV通貨→JPYへレート換算        
17301  |'                dblValueIn = dblValueIn * ddblExc||17278  |'                dblValueIn = dblValueIn * ddblExc
17302  |                For i = LBound(gtypOtherComRec) To||17279  |                For i = LBound(gtypOtherComRec) To
17303  |                    'NAV通貨→JPYへレート換算     ||17280  |                    'NAV通貨→JPYへレート換算     
17304  |                    gtypOtherComRec(i).APPLY_NAV_A||17281  |                    gtypOtherComRec(i).APPLY_NAV_A
17305  |                Next i                            ||17282  |                Next i                            
17306  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||17283  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
17307  |                Else                              ||17284  |                Else                              
17308  |                    '閾値通貨→JPYの為替レートを取||17285  |                    '閾値通貨→JPYの為替レートを取
17309  |                    dstrCurrencyCode = gbuMGetUPDR||17286  |                    dstrCurrencyCode = gbuMGetUPDR
17310  |                    ddblExchangeRate = fnstrExchan||17287  |                    ddblExchangeRate = fnstrExchan
17311  |                    If ddblExchangeRate = 0 Then  ||17288  |                    If ddblExchangeRate = 0 Then  
17312  |                      intRtn = MsgBox("ＴＴＭが取 ||17289  |                      intRtn = MsgBox("ＴＴＭが取 
17313  |                      vbLf & "対象通貨コード ： [ ||17290  |                      vbLf & "対象通貨コード ： [ 
17314  |                      vbLf & "基準日 ： [ " & Mid(||17291  |                      vbLf & "基準日 ： [ " & Mid(
17315  |                          vbCritical, "ＴＴＭ取得 ||17292  |                          vbCritical, "ＴＴＭ取得 
17316  |                      Exit Function               ||17293  |                      Exit Function               
17317  |                    End If                        ||17294  |                    End If                        
17318  |'                    'JPY→閾値通貨へ逆レート換算 ||17295  |'                    'JPY→閾値通貨へ逆レート換算 
17319  |'                    dblValueIn = dblValueIn / ddb||17296  |'                    dblValueIn = dblValueIn / ddb
17320  |                    For i = LBound(gtypOtherComRec||17297  |                    For i = LBound(gtypOtherComRec
17321  |                        'NAV通貨→JPYへレート換算 ||17298  |                        'NAV通貨→JPYへレート換算 
17322  |                        gtypOtherComRec(i).APPLY_N||17299  |                        gtypOtherComRec(i).APPLY_N
17323  |                    Next i                        ||17300  |                    Next i                        
17324  |                End If                            ||17301  |                End If                            
17325  |            End If                                ||17302  |            End If                                
17326  |        End Select                                ||17303  |        End Select                                
17327  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    ||17304  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    
17328  |'        Call sbGetRoundValue2(dblValueIn)        ||17305  |'        Call sbGetRoundValue2(dblValueIn)        
17329  |'        lCalcNav = CStr(Format(dblValueOut, "#,##||17306  |'        lCalcNav = CStr(Format(dblValueOut, "#,##
17330  |        For i = LBound(gtypOtherComRec) To UBound(||17307  |        For i = LBound(gtypOtherComRec) To UBound(
17331  |            Call sbGetRoundValue2(gtypOtherComRec(||17308  |            Call sbGetRoundValue2(gtypOtherComRec(
17332  |            gtypOtherComRec(i).APPLY_NAV_AVG = CSt||17309  |            gtypOtherComRec(i).APPLY_NAV_AVG = CSt
17333  |        Next i                                    ||17310  |        Next i                                    
17334  |                                                  ||17311  |                                                  
17335  |        '固定料率                                 ||17312  |        '固定料率                                 
17336  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat||17313  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat
17337  |'期中料率変更契約対応 START                       ||17314  |'期中料率変更契約対応 START                       
17338  |'            '単一料率の場合                      ||17315  |'            '単一料率の場合                      
17339  |'            If KityuFlg = False Then             ||17316  |'            If KityuFlg = False Then             
17340  |'                '計算対称NAV × 外部委託顧問料率 ||17317  |'                '計算対称NAV × 外部委託顧問料率 
17341  |'                dRitsu = CDbl(gbuOtherComRateGetU||17318  |'                dRitsu = CDbl(gbuOtherComRateGetU
17342  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||17319  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
17343  |'                Or gbuMGetUPDRec.N(lRecIdx).MGET_||17320  |'                Or gbuMGetUPDRec.N(lRecIdx).MGET_
17344  |'                    '一年間の日数：365日またはカ ||17321  |'                    '一年間の日数：365日またはカ 
17345  |'                    dblValueIn = lCalcNav * dRits||17322  |'                    dblValueIn = lCalcNav * dRits
17346  |'                Else                             ||17323  |'                Else                             
17347  |'                    '一年間の日数：360日         ||17324  |'                    '一年間の日数：360日         
17348  |'                    dblValueIn = lCalcNav * dRits||17325  |'                    dblValueIn = lCalcNav * dRits
17349  |'                End If                           ||17326  |'                End If                           
17350  |            '期中料率変更契約の場合               ||17327  |            '期中料率変更契約の場合               
17351  |            dblValueIn = 0                        ||17328  |            dblValueIn = 0                        
17352  |            '一年間の日数：365日またはカレンダー  ||17329  |            '一年間の日数：365日またはカレンダー  
17353  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_||17330  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_
17354  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_||17331  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_
17355  |                '計算対称NAV × 期中外部委託顧問料||17332  |                '計算対称NAV × 期中外部委託顧問料
17356  |                For i = LBound(gtypOtherComRec) To||17333  |                For i = LBound(gtypOtherComRec) To
17357  |                    For J = LBound(gtypOtherComRec||17334  |                    For J = LBound(gtypOtherComRec
17358  |                        gtypOtherComRec(i).APPLY_P||17335  |                        gtypOtherComRec(i).APPLY_P
17359  |                        gtypOtherComRec(i).APPLY_N||17336  |                        gtypOtherComRec(i).APPLY_N
17360  |                        gtypOtherComRec(i).APPLY_O||17337  |                        gtypOtherComRec(i).APPLY_O
17361  |                        gtypOtherComRec(i).APPLY_C||17338  |                        gtypOtherComRec(i).APPLY_C
17362  |                    Next J                        ||17339  |                    Next J                        
17363  |                Next i                            ||17340  |                Next i                            
17364  |            '一年間の日数：360日                  ||17341  |            '一年間の日数：360日                  
17365  |            Else                                  ||17342  |            Else                                  
17366  |                '計算対称NAV × 期中外部委託顧問料||17343  |                '計算対称NAV × 期中外部委託顧問料
17367  |                For i = LBound(gtypOtherComRec) To||17344  |                For i = LBound(gtypOtherComRec) To
17368  |                    For J = LBound(gtypOtherComRec||17345  |                    For J = LBound(gtypOtherComRec
17369  |                        gtypOtherComRec(i).APPLY_P||17346  |                        gtypOtherComRec(i).APPLY_P
17370  |                        gtypOtherComRec(i).APPLY_N||17347  |                        gtypOtherComRec(i).APPLY_N
17371  |                        gtypOtherComRec(i).APPLY_O||17348  |                        gtypOtherComRec(i).APPLY_O
17372  |                        gtypOtherComRec(i).APPLY_C||17349  |                        gtypOtherComRec(i).APPLY_C
17373  |                    Next J                        ||17350  |                    Next J                        
17374  |                Next i                            ||17351  |                Next i                            
17375  |            End If                                ||17352  |            End If                                
17376  |            '料率別顧問料を集計する               ||17353  |            '料率別顧問料を集計する               
17377  |            For i = LBound(gtypOtherComRec) To UBo||17354  |            For i = LBound(gtypOtherComRec) To UBo
17378  |                dblValueIn = dblValueIn + gtypOthe||17355  |                dblValueIn = dblValueIn + gtypOthe
17379  |            Next i                                ||17356  |            Next i                                
17380  |                                                  ||17357  |                                                  
17381  |'期中料率変更契約対応 END                         ||17358  |'期中料率変更契約対応 END                         
17382  |                                                  ||17359  |                                                  
17383  |        '段階料率                                 ||17360  |        '段階料率                                 
17384  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other||17361  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other
17385  |'期中料率変更契約対応 START                       ||17362  |'期中料率変更契約対応 START                       
17386  |'            '単一料率の場合                      ||17363  |'            '単一料率の場合                      
17387  |'            '料率分ループ処理                    ||17364  |'            '料率分ループ処理                    
17388  |'            For i = LBound(gbuOtherComRateGetUPDR||17365  |'            For i = LBound(gbuOtherComRateGetUPDR
17389  |'                TotalRate = TotalRate + CCur(gbuO||17366  |'                TotalRate = TotalRate + CCur(gbuO
17390  |'                cRate = CCur(gbuOtherComRateGetUP||17367  |'                cRate = CCur(gbuOtherComRateGetUP
17391  |'                dRitsu = CDbl(gbuOtherComRateGetU||17368  |'                dRitsu = CDbl(gbuOtherComRateGetU
17392  |'                If i = UBound(gbuOtherComRateGetU||17369  |'                If i = UBound(gbuOtherComRateGetU
17393  |'                    '(前回閾値)：累積閾値 = WORK ||17370  |'                    '(前回閾値)：累積閾値 = WORK 
17394  |'                    TotalRate = WorkRate         ||17371  |'                    TotalRate = WorkRate         
17395  |'                ElseIf TotalRate <= lCalcNav Then||17372  |'                ElseIf TotalRate <= lCalcNav Then
17396  |'                    '累積投資顧問料 = 累積投資顧 ||17373  |'                    '累積投資顧問料 = 累積投資顧 
17397  |'                    dblValueIn = cRate * dRitsu /||17374  |'                    dblValueIn = cRate * dRitsu /
17398  |'                    Call sbGetRoundValue2(dblValu||17375  |'                    Call sbGetRoundValue2(dblValu
17399  |'                    TotalCom = TotalCom + dblValu||17376  |'                    TotalCom = TotalCom + dblValu
17400  |'                Else                             ||17377  |'                Else                             
17401  |'                    '(前回閾値)：累積閾値 = WORK ||17378  |'                    '(前回閾値)：累積閾値 = WORK 
17402  |'                    TotalRate = WorkRate         ||17379  |'                    TotalRate = WorkRate         
17403  |'                    Exit For                     ||17380  |'                    Exit For                     
17404  |'                End If                           ||17381  |'                End If                           
17405  |'                '累積閾値をWORKに格納(一つ前の閾 ||17382  |'                '累積閾値をWORKに格納(一つ前の閾 
17406  |'                WorkRate = TotalRate             ||17383  |'                WorkRate = TotalRate             
17407  |'            Next i                               ||17384  |'            Next i                               
17408  |'            '累積投資顧問料 = 累積投資顧問料 + ( ||17385  |'            '累積投資顧問料 = 累積投資顧問料 + ( 
17409  |'            dblValueIn = (lCalcNav - TotalRate) *||17386  |'            dblValueIn = (lCalcNav - TotalRate) *
17410  |'            TotalCom = TotalCom + dblValueIn     ||17387  |'            TotalCom = TotalCom + dblValueIn     
17411  |'            '投資顧問料 = 累積投資顧問料 × 計算 ||17388  |'            '投資顧問料 = 累積投資顧問料 × 計算 
17412  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days||17389  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days
17413  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days||17390  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days
17414  |'                '一年間の日数：365日またはカレン ||17391  |'                '一年間の日数：365日またはカレン 
17415  |'                dblValueIn = TotalCom * iCalcNum ||17392  |'                dblValueIn = TotalCom * iCalcNum 
17416  |'            Else                                 ||17393  |'            Else                                 
17417  |'                '一年間の日数：360日             ||17394  |'                '一年間の日数：360日             
17418  |'                dblValueIn = TotalCom * iCalcNum ||17395  |'                dblValueIn = TotalCom * iCalcNum 
17419  |'            End If                               ||17396  |'            End If                               
17420  |        '期中料率変更契約の場合                   ||17397  |        '期中料率変更契約の場合                   
17421  |            For i = LBound(gtypOtherComRec) To UBo||17398  |            For i = LBound(gtypOtherComRec) To UBo
17422  |                TotalRate = 0                     ||17399  |                TotalRate = 0                     
17423  |                TotalCom = 0                      ||17400  |                TotalCom = 0                      
17424  |'2008/03/03 START NAVが閾値を超えない場合、累積投 ||17401  |'2008/03/03 START NAVが閾値を超えない場合、累積投 
17425  |                WorkRate = 0                      ||17402  |                WorkRate = 0                      
17426  |'2008/03/03 END   NAVが閾値を超えない場合、累積投 ||17403  |'2008/03/03 END   NAVが閾値を超えない場合、累積投 
17427  |                For J = LBound(gtypOtherComRec(i).||17404  |                For J = LBound(gtypOtherComRec(i).
17428  |                    TotalRate = TotalRate + CCur(g||17405  |                    TotalRate = TotalRate + CCur(g
17429  |                    cRate = CCur(gtypOtherComRec(i||17406  |                    cRate = CCur(gtypOtherComRec(i
17430  |                    dRitsu = CDbl(gtypOtherComRec(||17407  |                    dRitsu = CDbl(gtypOtherComRec(
17431  |                    If J = UBound(gtypOtherComRec(||17408  |                    If J = UBound(gtypOtherComRec(
17432  |                        '(前回閾値)：累積閾値 = WO||17409  |                        '(前回閾値)：累積閾値 = WO
17433  |                        TotalRate = WorkRate      ||17410  |                        TotalRate = WorkRate      
17434  |                    ElseIf TotalRate <= gtypOtherC||17411  |                    ElseIf TotalRate <= gtypOtherC
17435  |                        '累積投資顧問料 = 累積投資||17412  |                        '累積投資顧問料 = 累積投資
17436  |                        dblValueIn = cRate * dRits||17413  |                        dblValueIn = cRate * dRits
17437  |                        Call sbGetRoundValue2(dblV||17414  |                        Call sbGetRoundValue2(dblV
17438  |                        TotalCom = TotalCom + dblV||17415  |                        TotalCom = TotalCom + dblV
17439  |                    Else                          ||17416  |                    Else                          
17440  |                        '(前回閾値)：累積閾値 = WO||17417  |                        '(前回閾値)：累積閾値 = WO
17441  |                        TotalRate = WorkRate      ||17418  |                        TotalRate = WorkRate      
17442  |                        Exit For                  ||17419  |                        Exit For                  
17443  |                    End If                        ||17420  |                    End If                        
17444  |                    '累積閾値をWORKに格納(一つ前の||17421  |                    '累積閾値をWORKに格納(一つ前の
17445  |                    WorkRate = TotalRate          ||17422  |                    WorkRate = TotalRate          
17446  |                Next J                            ||17423  |                Next J                            
17447  |                '累積投資顧問料 = 累積投資顧問料 +||17424  |                '累積投資顧問料 = 累積投資顧問料 +
17448  |                dblValueIn = (gtypOtherComRec(i).A||17425  |                dblValueIn = (gtypOtherComRec(i).A
17449  |                TotalCom = TotalCom + dblValueIn  ||17426  |                TotalCom = TotalCom + dblValueIn  
17450  |                '投資顧問料 = 累積投資顧問料 × 計||17427  |                '投資顧問料 = 累積投資顧問料 × 計
17451  |                If gbuMGetUPDRec.N(lRecIdx).MGET_d||17428  |                If gbuMGetUPDRec.N(lRecIdx).MGET_d
17452  |                Or gbuMGetUPDRec.N(lRecIdx).MGET_d||17429  |                Or gbuMGetUPDRec.N(lRecIdx).MGET_d
17453  |                    '一年間の日数：365日またはカレ||17430  |                    '一年間の日数：365日またはカレ
17454  |                    gtypOtherComRec(i).APPLY_PAY_C||17431  |                    gtypOtherComRec(i).APPLY_PAY_C
17455  |                Else                              ||17432  |                Else                              
17456  |                    '一年間の日数：360日          ||17433  |                    '一年間の日数：360日          
17457  |                    gtypOtherComRec(i).APPLY_PAY_C||17434  |                    gtypOtherComRec(i).APPLY_PAY_C
17458  |                End If                            ||17435  |                End If                            
17459  |            Next i                                ||17436  |            Next i                                
17460  |            '外部委託顧問料変数を初期化           ||17437  |            '外部委託顧問料変数を初期化           
17461  |            dblValueIn = 0                        ||17438  |            dblValueIn = 0                        
17462  |            'トータル顧問料をセット               ||17439  |            'トータル顧問料をセット               
17463  |            For i = LBound(gtypOtherComRec) To UBo||17440  |            For i = LBound(gtypOtherComRec) To UBo
17464  |                dblValueIn = dblValueIn + gtypOthe||17441  |                dblValueIn = dblValueIn + gtypOthe
17465  |            Next i                                ||17442  |            Next i                                
17466  |'期中料率変更契約対応 END                         ||17443  |'期中料率変更契約対応 END                         
17467  |        End If                                    ||17444  |        End If                                    
17468  |        ddblExchangeRate = 0                      ||17445  |        ddblExchangeRate = 0                      
17469  |        '@@@@@ 外部委託顧問料に換算 @@@@@         ||17446  |        '@@@@@ 外部委託顧問料に換算 @@@@@         
17470  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||17447  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
17471  |          Case "1"    '固定料率                   ||17448  |          Case "1"    '固定料率                   
17472  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o||17449  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o
17473  |                Else                              ||17450  |                Else                              
17474  |                  '外部委託顧問料通貨→JPYの為替レ||17451  |                  '外部委託顧問料通貨→JPYの為替レ
17475  |                  dstrCurrencyCode = gbuMGetUPDRec||17452  |                  dstrCurrencyCode = gbuMGetUPDRec
17476  |                  ddblExchangeRate = fnstrExchange||17453  |                  ddblExchangeRate = fnstrExchange
17477  |                  If ddblExchangeRate = 0 Then    ||17454  |                  If ddblExchangeRate = 0 Then    
17478  |                    intRtn = MsgBox("ＴＴＭが取得 ||17455  |                    intRtn = MsgBox("ＴＴＭが取得 
17479  |                    vbLf & "対象通貨コード ： [ " ||17456  |                    vbLf & "対象通貨コード ： [ " 
17480  |                    vbLf & "基準日 ： [ " & Mid(ds||17457  |                    vbLf & "基準日 ： [ " & Mid(ds
17481  |                        vbCritical, "ＴＴＭ取得エ ||17458  |                        vbCritical, "ＴＴＭ取得エ 
17482  |                    Exit Function                 ||17459  |                    Exit Function                 
17483  |                  End If                          ||17460  |                  End If                          
17484  |                  'JPY→閾値通貨へ逆レート換算    ||17461  |                  'JPY→閾値通貨へ逆レート換算    
17485  |                  dblValueIn = dblValueIn / ddblEx||17462  |                  dblValueIn = dblValueIn / ddblEx
17486  |                End If                            ||17463  |                End If                            
17487  |          Case "2"    '段階料率                   ||17464  |          Case "2"    '段階料率                   
17488  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||17465  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
17489  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||17466  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
17490  |                Else                              ||17467  |                Else                              
17491  |                    '閾値通貨→JPYの為替レートを取||17468  |                    '閾値通貨→JPYの為替レートを取
17492  |                    dstrCurrencyCode = gbuMGetUPDR||17469  |                    dstrCurrencyCode = gbuMGetUPDR
17493  |                    ddblExchangeRate = fnstrExchan||17470  |                    ddblExchangeRate = fnstrExchan
17494  |                    'JPY→閾値通貨へ逆レート換算  ||17471  |                    'JPY→閾値通貨へ逆レート換算  
17495  |                    dblValueIn = dblValueIn / ddbl||17472  |                    dblValueIn = dblValueIn / ddbl
17496  |                End If                            ||17473  |                End If                            
17497  |            Else                                  ||17474  |            Else                                  
17498  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||17475  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
17499  |                    '外部委託顧問料通貨→JPYの為替||17476  |                    '外部委託顧問料通貨→JPYの為替
17500  |                    dstrCurrencyCode = gbuMGetUPDR||17477  |                    dstrCurrencyCode = gbuMGetUPDR
17501  |                    ddblExchangeRate = fnstrExchan||17478  |                    ddblExchangeRate = fnstrExchan
17502  |                    'JPY→閾値通貨へレート換算    ||17479  |                    'JPY→閾値通貨へレート換算    
17503  |                    dblValueIn = dblValueIn / ddbl||17480  |                    dblValueIn = dblValueIn / ddbl
17504  |                Else                              ||17481  |                Else                              
17505  |                    '閾値通貨→JPYの為替レートを取||17482  |                    '閾値通貨→JPYの為替レートを取
17506  |                    dstrCurrencyCode = gbuMGetUPDR||17483  |                    dstrCurrencyCode = gbuMGetUPDR
17507  |                    ddblExchangeRate = fnstrExchan||17484  |                    ddblExchangeRate = fnstrExchan
17508  |                    'JPY→閾値通貨へ逆レート換算  ||17485  |                    'JPY→閾値通貨へ逆レート換算  
17509  |                    dblValueIn = dblValueIn * ddbl||17486  |                    dblValueIn = dblValueIn * ddbl
17510  |                    '外部委託顧問料通貨→JPYの為替||17487  |                    '外部委託顧問料通貨→JPYの為替
17511  |                    dstrCurrencyCode = gbuMGetUPDR||17488  |                    dstrCurrencyCode = gbuMGetUPDR
17512  |                    ddblExchangeRate = fnstrExchan||17489  |                    ddblExchangeRate = fnstrExchan
17513  |                    'JPY→閾値通貨へ逆レート換算  ||17490  |                    'JPY→閾値通貨へ逆レート換算  
17514  |                    dblValueIn = dblValueIn / ddbl||17491  |                    dblValueIn = dblValueIn / ddbl
17515  |                End If                            ||17492  |                End If                            
17516  |            End If                                ||17493  |            End If                                
17517  |        End Select                                ||17494  |        End Select                                
17518  |        '@@@@@ 外部委託顧問料に換算 @@@@@         ||17495  |        '@@@@@ 外部委託顧問料に換算 @@@@@         
17519  |        Call sbGetRoundValue2(dblValueIn)         ||17496  |        Call sbGetRoundValue2(dblValueIn)         
17520  |        mstrMonthlyPayCom = dblValueOut           ||17497  |        mstrMonthlyPayCom = dblValueOut           
17521  |'期中料率変更契約対応 START                       ||17498  |'期中料率変更契約対応 START                       
17522  |        ': ,文言                                  ||17499  |        ': ,文言                                  
17523  |        '.Cells(39, 11).Value = sWord19           ||17500  |        '.Cells(39, 11).Value = sWord19           
17524  |        .Cells(44, 11).Value = sWord19            ||17501  |        .Cells(44, 11).Value = sWord19            
17525  |        '年率 ,文言                               ||17502  |        '年率 ,文言                               
17526  |        '.Cells(39, 2).Value = sWord10            ||17503  |        '.Cells(39, 2).Value = sWord10            
17527  |        .Cells(44, 2).Value = sWord10             ||17504  |        .Cells(44, 2).Value = sWord10             
17528  |        TotalRate = 0                             ||17505  |        TotalRate = 0                             
17529  |        '年率は別紙に記載                         ||17506  |        '年率は別紙に記載                         
17530  |        '.Cells(39, 13).Value = sWord54           ||17507  |        '.Cells(39, 13).Value = sWord54           
17531  |        .Cells(44, 13).Value = sWord54            ||17508  |        .Cells(44, 13).Value = sWord54            
17532  |'期中料率変更契約対応 END                         ||17509  |'期中料率変更契約対応 END                         
17533  |                                                  ||17510  |                                                  
17534  |        '投資顧問料                               ||17511  |        '投資顧問料                               
17535  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||17512  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
17536  |            Case Mid(mstrContractFlag(1), 1, 1)   ||17513  |            Case Mid(mstrContractFlag(1), 1, 1)   
17537  |                .Cells(46, 2).Value = sWord11a    ||17514  |                .Cells(46, 2).Value = sWord11a    
17538  |            Case Mid(mstrContractFlag(2), 1, 1)   ||17515  |            Case Mid(mstrContractFlag(2), 1, 1)   
17539  |                .Cells(46, 2).Value = sWord11b    ||17516  |                .Cells(46, 2).Value = sWord11b    
17540  |            Case Mid(mstrContractFlag(3), 1, 1)   ||17517  |            Case Mid(mstrContractFlag(3), 1, 1)   
17541  |                .Cells(46, 2).Value = sWord11c    ||17518  |                .Cells(46, 2).Value = sWord11c    
17542  |            Case Else                             ||17519  |            Case Else                             
17543  |                MsgBox "契約区分が不正です。", vbC||17520  |                MsgBox "契約区分が不正です。", vbC
17544  |        End Select                                ||17521  |        End Select                                
17545  |        .Cells(46, 11).Value = sWord19            ||17522  |        .Cells(46, 11).Value = sWord19            
17546  |        '外部委託顧問料                           ||17523  |        '外部委託顧問料                           
17547  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||17524  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
17548  |            .Cells(46, 31).NumberFormatLocal = "@"||17525  |            .Cells(46, 31).NumberFormatLocal = "@"
17549  |        Else                                      ||17526  |        Else                                      
17550  |            .Cells(46, 29).NumberFormatLocal = "@"||17527  |            .Cells(46, 29).NumberFormatLocal = "@"
17551  |        End If                                    ||17528  |        End If                                    
17552  |        '契約区分が名称使用許諾料の場合上限・下限 ||17529  |        '契約区分が名称使用許諾料の場合上限・下限 
17553  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||17530  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
17554  |            '下限金額より換算した金額が小さい場合 ||17531  |            '下限金額より換算した金額が小さい場合 
17555  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_f||17532  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_f
17556  |                If mstrMonthlyPayCom < CDbl(gbuMGe||17533  |                If mstrMonthlyPayCom < CDbl(gbuMGe
17557  |                    mstrMonthlyPayCom = CDbl(gbuMG||17534  |                    mstrMonthlyPayCom = CDbl(gbuMG
17558  |                End If                            ||17535  |                End If                            
17559  |            End If                                ||17536  |            End If                                
17560  |            '上限金額より換算した金額が大きい場合 ||17537  |            '上限金額より換算した金額が大きい場合 
17561  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_c||17538  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_c
17562  |                If mstrMonthlyPayCom > CDbl(gbuMGe||17539  |                If mstrMonthlyPayCom > CDbl(gbuMGe
17563  |                    mstrMonthlyPayCom = CDbl(gbuMG||17540  |                    mstrMonthlyPayCom = CDbl(gbuMG
17564  |                End If                            ||17541  |                End If                            
17565  |            End If                                ||17542  |            End If                                
17566  |            dblValueIn = CDbl(mstrMonthlyPayCom)  ||17543  |            dblValueIn = CDbl(mstrMonthlyPayCom)  
17567  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||17544  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
17568  |                Call sbGetRoundValue2(dblValueIn) ||17545  |                Call sbGetRoundValue2(dblValueIn) 
17569  |            Else                                  ||17546  |            Else                                  
17570  |                Call sbGetRoundValue(dblValueIn)  ||17547  |                Call sbGetRoundValue(dblValueIn)  
17571  |            End If                                ||17548  |            End If                                
17572  |            mstrMonthlyPayCom = dblValueOut       ||17549  |            mstrMonthlyPayCom = dblValueOut       
17573  |        End If                                    ||17550  |        End If                                    
17574  |        '外部委託顧問料通貨                       ||17551  |        '外部委託顧問料通貨                       
17575  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||17552  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
17576  |            Case cAud                             ||17553  |            Case cAud                             
17577  |                .Cells(46, 31).Value = CStr(Format||17554  |                .Cells(46, 31).Value = CStr(Format
17578  |                .Cells(46, 32).Value = sAud       ||17555  |                .Cells(46, 32).Value = sAud       
17579  |            Case cCad                             ||17556  |            Case cCad                             
17580  |                .Cells(46, 31).Value = CStr(Format||17557  |                .Cells(46, 31).Value = CStr(Format
17581  |                .Cells(46, 32).Value = sCad       ||17558  |                .Cells(46, 32).Value = sCad       
17582  |            Case cChf                             ||17559  |            Case cChf                             
17583  |                .Cells(46, 31).Value = CStr(Format||17560  |                .Cells(46, 31).Value = CStr(Format
17584  |                .Cells(46, 32).Value = sChf       ||17561  |                .Cells(46, 32).Value = sChf       
17585  |            Case cEur                             ||17562  |            Case cEur                             
17586  |                .Cells(46, 31).Value = CStr(Format||17563  |                .Cells(46, 31).Value = CStr(Format
17587  |                .Cells(46, 32).Value = sEur       ||17564  |                .Cells(46, 32).Value = sEur       
17588  |            Case cGbp                             ||17565  |            Case cGbp                             
17589  |                .Cells(46, 31).Value = CStr(Format||17566  |                .Cells(46, 31).Value = CStr(Format
17590  |                .Cells(46, 32).Value = sGbp       ||17567  |                .Cells(46, 32).Value = sGbp       
17591  |            Case cHkd                             ||17568  |            Case cHkd                             
17592  |                .Cells(46, 31).Value = CStr(Format||17569  |                .Cells(46, 31).Value = CStr(Format
17593  |                .Cells(46, 32).Value = sHkd       ||17570  |                .Cells(46, 32).Value = sHkd       
17594  |            Case cJpy                             ||17571  |            Case cJpy                             
17595  |                .Cells(46, 29).Value = CStr(Format||17572  |                .Cells(46, 29).Value = CStr(Format
17596  |                .Cells(46, 32).Value = sYen       ||17573  |                .Cells(46, 32).Value = sYen       
17597  |            Case cMyr                             ||17574  |            Case cMyr                             
17598  |                .Cells(46, 31).Value = CStr(Format||17575  |                .Cells(46, 31).Value = CStr(Format
17599  |                .Cells(46, 32).Value = sMyr       ||17576  |                .Cells(46, 32).Value = sMyr       
17600  |            Case cNzd                             ||17577  |            Case cNzd                             
17601  |                .Cells(46, 31).Value = CStr(Format||17578  |                .Cells(46, 31).Value = CStr(Format
17602  |                .Cells(46, 32).Value = sNzd       ||17579  |                .Cells(46, 32).Value = sNzd       
17603  |            Case cSek                             ||17580  |            Case cSek                             
17604  |                .Cells(46, 31).Value = CStr(Format||17581  |                .Cells(46, 31).Value = CStr(Format
17605  |                .Cells(46, 32).Value = sSek       ||17582  |                .Cells(46, 32).Value = sSek       
17606  |            Case cSgd                             ||17583  |            Case cSgd                             
17607  |                .Cells(46, 31).Value = CStr(Format||17584  |                .Cells(46, 31).Value = CStr(Format
17608  |                .Cells(46, 32).Value = sSgd       ||17585  |                .Cells(46, 32).Value = sSgd       
17609  |            Case cUsd                             ||17586  |            Case cUsd                             
17610  |                .Cells(46, 31).Value = CStr(Format||17587  |                .Cells(46, 31).Value = CStr(Format
17611  |                .Cells(46, 32).Value = sUsd       ||17588  |                .Cells(46, 32).Value = sUsd       
17612  |            Case cNok                             ||17589  |            Case cNok                             
17613  |                .Cells(46, 31).Value = CStr(Format||17590  |                .Cells(46, 31).Value = CStr(Format
17614  |                .Cells(46, 32).Value = sNok       ||17591  |                .Cells(46, 32).Value = sNok       
17615  |        End Select                                ||17592  |        End Select                                
17616  |                                                  ||17593  |                                                  
17617  |        '顧問料                                   ||17594  |        '顧問料                                   
17618  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||17595  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
17619  |            .Cells(46, 31).HorizontalAlignment = x||17596  |            .Cells(46, 31).HorizontalAlignment = x
17620  |        Else                                      ||17597  |        Else                                      
17621  |            .Cells(46, 29).HorizontalAlignment = x||17598  |            .Cells(46, 29).HorizontalAlignment = x
17622  |        End If                                    ||17599  |        End If                                    
17623  |                                                  ||17600  |                                                  
17624  |        '契約区分が名称使用許諾料の場合上限・下限 ||17601  |        '契約区分が名称使用許諾料の場合上限・下限 
17625  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||17602  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
17626  |            '上限金額                             ||17603  |            '上限金額                             
17627  |            .Cells(46, 39).Value = sWordCap       ||17604  |            .Cells(46, 39).Value = sWordCap       
17628  |            .Cells(46, 57).NumberFormatLocal = "@"||17605  |            .Cells(46, 57).NumberFormatLocal = "@"
17629  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||17606  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
17630  |                .Cells(46, 57).Value = Format(gbuM||17607  |                .Cells(46, 57).Value = Format(gbuM
17631  |            Else                                  ||17608  |            Else                                  
17632  |                .Cells(46, 57).Value = Format(gbuM||17609  |                .Cells(46, 57).Value = Format(gbuM
17633  |            End If                                ||17610  |            End If                                
17634  |            .Cells(46, 57).HorizontalAlignment = x||17611  |            .Cells(46, 57).HorizontalAlignment = x
17635  |            '下限金額                             ||17612  |            '下限金額                             
17636  |            .Cells(47, 39).Value = sWordFloor     ||17613  |            .Cells(47, 39).Value = sWordFloor     
17637  |            .Cells(47, 57).NumberFormatLocal = "@"||17614  |            .Cells(47, 57).NumberFormatLocal = "@"
17638  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||17615  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
17639  |                .Cells(47, 57).Value = Format(gbuM||17616  |                .Cells(47, 57).Value = Format(gbuM
17640  |            Else                                  ||17617  |            Else                                  
17641  |                .Cells(47, 57).Value = Format(gbuM||17618  |                .Cells(47, 57).Value = Format(gbuM
17642  |            End If                                ||17619  |            End If                                
17643  |            .Cells(47, 57).HorizontalAlignment = x||17620  |            .Cells(47, 57).HorizontalAlignment = x
17644  |        End If                                    ||17621  |        End If                                    
17645  |                                                  ||17622  |                                                  
17646  |        ddblExchangeRate = 0                      ||17623  |        ddblExchangeRate = 0                      
17647  |        '@@@@@ 支払に換算 @@@@@                   ||17624  |        '@@@@@ 支払に換算 @@@@@                   
17648  |        dblValueIn = mstrMonthlyPayCom            ||17625  |        dblValueIn = mstrMonthlyPayCom            
17649  |                                                  ||17626  |                                                  
17650  |        '2006/04/12 START K.Furuya 実払管理テーブ ||17627  |        '2006/04/12 START K.Furuya 実払管理テーブ 
17651  |        '通貨円以外の場合確定顧問料通貨を取得     ||17628  |        '通貨円以外の場合確定顧問料通貨を取得     
17652  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||17629  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
17653  |            WkFixComC = ""                        ||17630  |            WkFixComC = ""                        
17654  |            WkRealComC = ""                       ||17631  |            WkRealComC = ""                       
17655  |            WkFixComC = mstrMonthlyPayCom         ||17632  |            WkFixComC = mstrMonthlyPayCom         
17656  |            WkRealComC = mstrMonthlyPayCom        ||17633  |            WkRealComC = mstrMonthlyPayCom        
17657  |        End If                                    ||17634  |        End If                                    
17658  |        '通貨を取得                               ||17635  |        '通貨を取得                               
17659  |        WkCurCode = ""                            ||17636  |        WkCurCode = ""                            
17660  |        WkCurCode = Trim(gbuMGetUPDRec.N(lRecIdx).||17637  |        WkCurCode = Trim(gbuMGetUPDRec.N(lRecIdx).
17661  |        '2006/04/12 END   K.Furuya 実払管理テーブ ||17638  |        '2006/04/12 END   K.Furuya 実払管理テーブ 
17662  |                                                  ||17639  |                                                  
17663  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||17640  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
17664  |          Case "1"    '固定料率                   ||17641  |          Case "1"    '固定料率                   
17665  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o||17642  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o
17666  |                Else                              ||17643  |                Else                              
17667  |                  '外部委託顧問料通貨→JPYの為替レ||17644  |                  '外部委託顧問料通貨→JPYの為替レ
17668  |                  dstrCurrencyCode = gbuMGetUPDRec||17645  |                  dstrCurrencyCode = gbuMGetUPDRec
17669  |                  ddblExchangeRate = fnstrExchange||17646  |                  ddblExchangeRate = fnstrExchange
17670  |                  If ddblExchangeRate = 0 Then    ||17647  |                  If ddblExchangeRate = 0 Then    
17671  |                    intRtn = MsgBox("ＴＴＭが取得 ||17648  |                    intRtn = MsgBox("ＴＴＭが取得 
17672  |                    vbLf & "対象通貨コード ： [ " ||17649  |                    vbLf & "対象通貨コード ： [ " 
17673  |                    vbLf & "基準日 ： [ " & Mid(ds||17650  |                    vbLf & "基準日 ： [ " & Mid(ds
17674  |                        vbCritical, "ＴＴＭ取得エ ||17651  |                        vbCritical, "ＴＴＭ取得エ 
17675  |                    Exit Function                 ||17652  |                    Exit Function                 
17676  |                  End If                          ||17653  |                  End If                          
17677  |                  'JPY→支払通貨へレート換算      ||17654  |                  'JPY→支払通貨へレート換算      
17678  |                  dblValueIn = dblValueIn * ddblEx||17655  |                  dblValueIn = dblValueIn * ddblEx
17679  |                End If                            ||17656  |                End If                            
17680  |          Case "2"    '段階料率                   ||17657  |          Case "2"    '段階料率                   
17681  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||17658  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
17682  |            Else                                  ||17659  |            Else                                  
17683  |                '外部委託顧問料通貨→JPYの為替レー||17660  |                '外部委託顧問料通貨→JPYの為替レー
17684  |                dstrCurrencyCode = gbuMGetUPDRec.N||17661  |                dstrCurrencyCode = gbuMGetUPDRec.N
17685  |                ddblExchangeRate = fnstrExchangeRa||17662  |                ddblExchangeRate = fnstrExchangeRa
17686  |                If ddblExchangeRate = 0 Then      ||17663  |                If ddblExchangeRate = 0 Then      
17687  |                  intRtn = MsgBox("ＴＴＭが取得で ||17664  |                  intRtn = MsgBox("ＴＴＭが取得で 
17688  |                  vbLf & "対象通貨コード ： [ " & ||17665  |                  vbLf & "対象通貨コード ： [ " & 
17689  |                  vbLf & "基準日 ： [ " & Mid(dstr||17666  |                  vbLf & "基準日 ： [ " & Mid(dstr
17690  |                      vbCritical, "ＴＴＭ取得エラ ||17667  |                      vbCritical, "ＴＴＭ取得エラ 
17691  |                  Exit Function                   ||17668  |                  Exit Function                   
17692  |                End If                            ||17669  |                End If                            
17693  |                '外部委託顧問料通貨→JPYへレート換||17670  |                '外部委託顧問料通貨→JPYへレート換
17694  |                dblValueIn = dblValueIn * ddblExch||17671  |                dblValueIn = dblValueIn * ddblExch
17695  |            End If                                ||17672  |            End If                                
17696  |        End Select                                ||17673  |        End Select                                
17697  |        '@@@@@ 支払に換算 @@@@@                   ||17674  |        '@@@@@ 支払に換算 @@@@@                   
17698  |        Call sbGetRoundValue(dblValueIn)          ||17675  |        Call sbGetRoundValue(dblValueIn)          
17699  |        mstrMonthlyPayCom = dblValueOut           ||17676  |        mstrMonthlyPayCom = dblValueOut           
17700  |                                                  ||17677  |                                                  
17701  |        '2006/04/12 START K.Furuya 実払管理テーブ ||17678  |        '2006/04/12 START K.Furuya 実払管理テーブ 
17702  |        '確定額と実払額を取得                     ||17679  |        '確定額と実払額を取得                     
17703  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||17680  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
17704  |            WkFixComC = ""                        ||17681  |            WkFixComC = ""                        
17705  |            WkFixComJ = ""                        ||17682  |            WkFixComJ = ""                        
17706  |            WkRealComC = ""                       ||17683  |            WkRealComC = ""                       
17707  |            WkRealComJ = ""                       ||17684  |            WkRealComJ = ""                       
17708  |            WkFixComC = mstrMonthlyPayCom         ||17685  |            WkFixComC = mstrMonthlyPayCom         
17709  |            WkFixComJ = mstrMonthlyPayCom         ||17686  |            WkFixComJ = mstrMonthlyPayCom         
17710  |            WkRealComC = mstrMonthlyPayCom        ||17687  |            WkRealComC = mstrMonthlyPayCom        
17711  |            WkRealComJ = mstrMonthlyPayCom        ||17688  |            WkRealComJ = mstrMonthlyPayCom        
17712  |        Else                                      ||17689  |        Else                                      
17713  |            WkFixComJ = ""                        ||17690  |            WkFixComJ = ""                        
17714  |            WkRealComJ = ""                       ||17691  |            WkRealComJ = ""                       
17715  |            WkFixComJ = mstrMonthlyPayCom         ||17692  |            WkFixComJ = mstrMonthlyPayCom         
17716  |            WkRealComJ = mstrMonthlyPayCom        ||17693  |            WkRealComJ = mstrMonthlyPayCom        
17717  |        End If                                    ||17694  |        End If                                    
17718  |        '2006/04/12 END   K.Furuya 実払管理テーブ ||17695  |        '2006/04/12 END   K.Furuya 実払管理テーブ 
17719  |                                                  ||17696  |                                                  
17720  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||17697  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
17721  |            'TTMレート                            ||17698  |            'TTMレート                            
17722  |            .Cells(47, 19).Value = sWord43        ||17699  |            .Cells(47, 19).Value = sWord43        
17723  |            .Cells(47, 33).NumberFormatLocal = "@"||17700  |            .Cells(47, 33).NumberFormatLocal = "@"
17724  |            .Cells(47, 33).Value = Format(ddblExch||17701  |            .Cells(47, 33).Value = Format(ddblExch
17725  |            .Cells(47, 33).HorizontalAlignment = x||17702  |            .Cells(47, 33).HorizontalAlignment = x
17726  |            .Cells(47, 34).Value = sWord44        ||17703  |            .Cells(47, 34).Value = sWord44        
17727  |        End If                                    ||17704  |        End If                                    
17728  |        '支払額                                   ||17705  |        '支払額                                   
17729  |        .Cells(48, 2).Value = sWord46             ||17706  |        .Cells(48, 2).Value = sWord46             
17730  |        .Cells(48, 11).Value = sWord19            ||17707  |        .Cells(48, 11).Value = sWord19            
17731  |        '税抜金額(月別支払顧問料の累計)           ||17708  |        '税抜金額(月別支払顧問料の累計)           
17732  |        .Cells(48, 29).NumberFormatLocal = "@"    ||17709  |        .Cells(48, 29).NumberFormatLocal = "@"    
17733  |        .Cells(48, 29).Value = CStr(Format(mstrMon||17710  |        .Cells(48, 29).Value = CStr(Format(mstrMon
17734  |        .Cells(48, 29).HorizontalAlignment = xlRig||17711  |        .Cells(48, 29).HorizontalAlignment = xlRig
17735  |        .Cells(48, 32).Value = sYen               ||17712  |        .Cells(48, 32).Value = sYen               
17736 L|        MsgBox gbuMGetUPDRec.N(lRecIdx).MGET_tax_c||       |                                                  
17737  |                                                  ||17713  |                                                  
17738  |        '消費税計算有無：「有り」の場合のみ、消費 ||17714  |        '消費税計算有無：「有り」の場合のみ、消費 
17739  |        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc_||17715  |        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc_
17740  |'2014/02/19 START M.Takada 【管理会計】消費税率変 ||17716  |'2014/02/19 START M.Takada 【管理会計】消費税率変 
17741  |            '(消費税XX%)                          ||17717  |            '(消費税XX%)                          
17742  |            'iSyouhizei = ddblconsumption_tax     ||17718  |            'iSyouhizei = ddblconsumption_tax     
17743  |            '.Cells(49, 32).Value = sWord22 & iSyo||17719  |            '.Cells(49, 32).Value = sWord22 & iSyo
17744  |            'dblValueIn = mstrMonthlyPayCom * iSyo||17720  |            'dblValueIn = mstrMonthlyPayCom * iSyo
17745  |            'Call sbGetRoundValueTax(dblValueIn)  ||17721  |            'Call sbGetRoundValueTax(dblValueIn)  
17746  |            'lTaxNum = dblValueOut                ||17722  |            'lTaxNum = dblValueOut                
17747  |            '.Cells(49, 29).NumberFormatLocal = "@||17723  |            '.Cells(49, 29).NumberFormatLocal = "@
17748  |            '.Cells(49, 29).Value = CStr(Format((l||17724  |            '.Cells(49, 29).Value = CStr(Format((l
17749  |            '.Cells(49, 29).HorizontalAlignment = ||17725  |            '.Cells(49, 29).HorizontalAlignment = 
17750  |            '合計(消費税＋月別支払顧問料の累計)   ||17726  |            '合計(消費税＋月別支払顧問料の累計)   
17751  |            '.Cells(50, 13).Value = sWord24       ||17727  |            '.Cells(50, 13).Value = sWord24       
17752  |            'dblValueIn = lTaxNum + CCur(mstrMonth||17728  |            'dblValueIn = lTaxNum + CCur(mstrMonth
17753  |            'Call sbGetRoundValue(dblValueIn)     ||17729  |            'Call sbGetRoundValue(dblValueIn)     
17754  |            'lMonthlyPayCom = dblValueOut         ||17730  |            'lMonthlyPayCom = dblValueOut         
17755  |            '.Cells(50, 29).NumberFormatLocal = "@||17731  |            '.Cells(50, 29).NumberFormatLocal = "@
17756  |            '.Cells(50, 29).Value = CStr(Format(lM||17732  |            '.Cells(50, 29).Value = CStr(Format(lM
17757  |            '.Cells(50, 29).HorizontalAlignment = ||17733  |            '.Cells(50, 29).HorizontalAlignment = 
17758  |            '円                                   ||17734  |            '円                                   
17759  |            '.Cells(50, 32).Value = sYen          ||17735  |            '.Cells(50, 32).Value = sYen          
17760  |            '下線                                 ||17736  |            '下線                                 
17761  |            'With xlSheet.Range("M49:AL49").Border||17737  |            'With xlSheet.Range("M49:AL49").Border
17762  |            '    .LineStyle = xlContinuous        ||17738  |            '    .LineStyle = xlContinuous        
17763  |            '    .Weight = xlThin                 ||17739  |            '    .Weight = xlThin                 
17764  |            'End With                             ||17740  |            'End With                             
       |                                                  ||17741 R|                                                  
17765  |            Call Tax_calc(dStart, dEnd)     '消費 ||17742  |            Call Tax_calc(dStart, dEnd)     '消費 
17766  |            If Tax_Flg = True Then                ||17743  |            If Tax_Flg = True Then                
17767  |                '計算期間中に消費税率が変更となる ||17744  |                '計算期間中に消費税率が変更となる 
17768  |                .Cells(49, 32).Value = sWord71    ||17745  |                .Cells(49, 32).Value = sWord71    
17769 L|                .Cells(49, 32).Font.Size = 10     ||       |                                                  
17770  |                .Cells(49, 29).NumberFormatLocal =||17746  |                .Cells(49, 29).NumberFormatLocal =
17771  |                '算出した税額を該当セルに設定する ||17747  |                '算出した税額を該当セルに設定する 
17772 L|                .Cells(49, 29).Value = CStr(Format||17748 R|                .Cells(49, 29).Value = CStr(Format
17773  |                .Cells(49, 29).HorizontalAlignment||17749  |                .Cells(49, 29).HorizontalAlignment
17774  |                '下線                             ||17750  |                '下線                             
17775 L|                With xlSheet.Range("M49:AH49").Bor||17751 R|                .Range("M49:AH49").Borders (xlEdge
17776 L|                            .LineStyle = xlContinu||17752 R|                .LineStyle = xlContinuous         
17777 L|                            .Weight = xlThin      ||17753 R|                .Weight = xlThin                  
17778 L|                End With                          ||       |                                                  
17779  |                                                  ||17754  |                                                  
17780  |                '注釈文言を出力する               ||17755  |                '注釈文言を出力する               
17781  |                .Cells(48, 36).Value = sWord64    ||17756  |                .Cells(48, 36).Value = sWord64    
17782  |                .Cells(48, 36).FontSize = 10      ||17757  |                .Cells(48, 36).FontSize = 10      
17783  |                .Cells(49, 36).Value = sWord65    ||17758  |                .Cells(49, 36).Value = sWord65    
17784  |                .Cells(49, 36).FontSize = 10      ||17759  |                .Cells(49, 36).FontSize = 10      
17785  |                                                  ||17760  |                                                  
17786  |            Else                                  ||17761  |            Else                                  
17787  |                '計算期間中に消費税率が変更となら ||17762  |                '計算期間中に消費税率が変更となら 
17788  |                '.Cells(49, 32).Value = sWord22 & ||17763  |                '.Cells(49, 32).Value = sWord22 & 
17789 L|                '.Cells(49, 32).Value = sWord22 & ||17764 R|                .Cells(49, 32).Value = sWord22 & s
17790  |                'dblValueIn = mstrMonthlyPayCom * ||17765  |                'dblValueIn = mstrMonthlyPayCom * 
17791 L|                .Cells(49, 32).Value = sWord22 & s||17766 R|                .Cells(49, 29).NumberFormatLocal =
17792 L|                '.Cells(49, 29).NumberFormatLocal ||       |                                                  
17793  |                '算出した税額を該当セルに設定する ||17767  |                '算出した税額を該当セルに設定する 
17794 L|                '.Cells(49, 29).Value = CStr(Forma||17768 R|                .Cells(49, 29).Value = CStr(Format
17795 L|                '.Cells(49, 29).HorizontalAlignmen||17769 R|                .Cells(49, 29).HorizontalAlignment
17796  |                '下線                             ||17770  |                '下線                             
17797 L|                'With xlSheet.Range("M49:AL49").Bo||17771 R|                .Range("M49:AL49").Borders (xlEdge
17798 L|                '            .LineStyle = xlContin||17772 R|                .LineStyle = xlContinuous         
17799 L|                '            .Weight = xlThin     ||17773 R|                .Weight = xlThin                  
17800 L|                'End With                         ||       |                                                  
17801  |            End If                                ||17774  |            End If                                
17802  |            '合計(消費税＋月別支払顧問料の累計)   ||17775  |            '合計(消費税＋月別支払顧問料の累計)   
17803  |            .Cells(50, 13).Value = sWord24        ||17776  |            .Cells(50, 13).Value = sWord24        
17804  |            .Cells(50, 29).NumberFormatLocal = "@"||17777  |            .Cells(50, 29).NumberFormatLocal = "@"
17805 L|            '.Cells(50, 29).Value = CStr(Format(Su||17778 R|            .Cells(50, 29).Value = CStr(Format((.C
17806 L|            .Cells(50, 29).Value = CStr(Format(CCu||       |                                                  
17807  |            .Cells(50, 29).HorizontalAlignment = x||17779  |            .Cells(50, 29).HorizontalAlignment = x
17808  |            '円                                   ||17780  |            '円                                   
17809  |            .Cells(50, 32).Value = sYen           ||17781  |            .Cells(50, 32).Value = sYen           
17810  |                                                  ||17782  |                                                  
17811  |            '下線                                 ||17783  |            '下線                                 
17812  |            'With xlSheet.Range("M49:AL49").Border||17784  |            'With xlSheet.Range("M49:AL49").Border
17813  |            '    .LineStyle = xlContinuous        ||17785  |            '    .LineStyle = xlContinuous        
17814  |            '    .Weight = xlThin                 ||17786  |            '    .Weight = xlThin                 
17815  |            'End With                             ||17787  |            'End With                             
17816  |                                                  ||17788  |                                                  
17817  |'2014/02/19 End M.Takada 【管理会計】消費税率変更 ||17789  |'2014/02/19 End M.Takada 【管理会計】消費税率変更 
17818  |        Else                                      ||17790  |        Else                                      
17819  |        End If                                    ||17791  |        End If                                    
17820  |        '支払先                                   ||17792  |        '支払先                                   
17821  |        .Cells(52, 2).Value = sWord12             ||17793  |        .Cells(52, 2).Value = sWord12             
17822  |        .Cells(52, 11).Value = sWord19            ||17794  |        .Cells(52, 11).Value = sWord19            
17823  |        .Cells(52, 13).Value = gbuMGetUPDRec.N(lRe||17795  |        .Cells(52, 13).Value = gbuMGetUPDRec.N(lRe
17824  |        '支払予定日                               ||17796  |        '支払予定日                               
17825  |        .Cells(54, 2).Value = sWord13             ||17797  |        .Cells(54, 2).Value = sWord13             
17826  |        .Cells(54, 11).Value = sWord19            ||17798  |        .Cells(54, 11).Value = sWord19            
17827  |        '支払予定日                               ||17799  |        '支払予定日                               
17828  |        sDate = Trim(mstrPaymentDate)             ||17800  |        sDate = Trim(mstrPaymentDate)             
17829  |        .Cells(54, 13).Value = _                  ||17801  |        .Cells(54, 13).Value = _                  
17830  |            Format(sDate, "YYYY") & WordYear & _  ||17802  |            Format(sDate, "YYYY") & WordYear & _  
17831  |            Format(sDate, "M") & WordMonth & _    ||17803  |            Format(sDate, "M") & WordMonth & _    
17832  |            Format(sDate, "D") & WordDay          ||17804  |            Format(sDate, "D") & WordDay          
17833  |        '部署名                                   ||17805  |        '部署名                                   
17834  |        'コンボ左の数字取得                       ||17806  |        'コンボ左の数字取得                       
17835  |        ColNum = Trim(gstrComboCodeGet(cboBumonFla||17807  |        ColNum = Trim(gstrComboCodeGet(cboBumonFla
17836  |        'コンボ「：」以下の文字列                 ||17808  |        'コンボ「：」以下の文字列                 
17837  |        ColWord = Trim(gstrComboDataGet(cboBumonFl||17809  |        ColWord = Trim(gstrComboDataGet(cboBumonFl
17838  |        .Cells(56, 2).Value = ColWord             ||17810  |        .Cells(56, 2).Value = ColWord             
17839  |        .Range("B56:S56").HorizontalAlignment = xl||17811  |        .Range("B56:S56").HorizontalAlignment = xl
17840  |        '担当者印                                 ||17812  |        '担当者印                                 
17841  |        .Cells(57, 2).Value = sWord15             ||17813  |        .Cells(57, 2).Value = sWord15             
17842  |        .Range("B57:J57").HorizontalAlignment = xl||17814  |        .Range("B57:J57").HorizontalAlignment = xl
17843  |        '検印                                     ||17815  |        '検印                                     
17844  |        .Cells(57, 11).Value = sWord16            ||17816  |        .Cells(57, 11).Value = sWord16            
17845  |        .Range("K57:S57").HorizontalAlignment = xl||17817  |        .Range("K57:S57").HorizontalAlignment = xl
17846  |        '財務部                                   ||17818  |        '財務部                                   
17847  |        .Cells(56, 24).Value = sWord35            ||17819  |        .Cells(56, 24).Value = sWord35            
17848  |        .Range("X56:AO56").HorizontalAlignment = x||17820  |        .Range("X56:AO56").HorizontalAlignment = x
17849  |        '精査印                                   ||17821  |        '精査印                                   
17850  |        .Cells(57, 24).Value = sWord17            ||17822  |        .Cells(57, 24).Value = sWord17            
17851  |        .Range("X57:AF57").HorizontalAlignment = x||17823  |        .Range("X57:AF57").HorizontalAlignment = x
17852  |        '検印                                     ||17824  |        '検印                                     
17853  |        .Cells(57, 33).Value = sWord16            ||17825  |        .Cells(57, 33).Value = sWord16            
17854  |        .Range("AG57:AO57").HorizontalAlignment = ||17826  |        .Range("AG57:AO57").HorizontalAlignment = 
17855  |                                                  ||17827  |                                                  
17856  |    End With                                      ||17828  |    End With                                      
17857  |                                                  ||17829  |                                                  
17858  |    '月末純資産(外枠)                             ||17830  |    '月末純資産(外枠)                             
17859  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge||17831  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge
17860  |'        .LineStyle = xlContinuous                ||17832  |'        .LineStyle = xlContinuous                
17861  |'        .Weight = xlThin                         ||17833  |'        .Weight = xlThin                         
17862  |'    End With                                     ||17834  |'    End With                                     
17863  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge||17835  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge
17864  |'        .LineStyle = xlContinuous                ||17836  |'        .LineStyle = xlContinuous                
17865  |'        .Weight = xlThin                         ||17837  |'        .Weight = xlThin                         
17866  |'    End With                                     ||17838  |'    End With                                     
17867  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge||17839  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge
17868  |'        .LineStyle = xlContinuous                ||17840  |'        .LineStyle = xlContinuous                
17869  |'        .Weight = xlThin                         ||17841  |'        .Weight = xlThin                         
17870  |'    End With                                     ||17842  |'    End With                                     
17871  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge||17843  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge
17872  |'        .LineStyle = xlContinuous                ||17844  |'        .LineStyle = xlContinuous                
17873  |'        .Weight = xlThin                         ||17845  |'        .Weight = xlThin                         
17874  |'    End With                                     ||17846  |'    End With                                     
17875  |'    With xlSheet.Range("N19:AN33").Borders(xlInsi||17847  |'    With xlSheet.Range("N19:AN33").Borders(xlInsi
17876  |'        .LineStyle = xlContinuous                ||17848  |'        .LineStyle = xlContinuous                
17877  |'        .Weight = xlThin                         ||17849  |'        .Weight = xlThin                         
17878  |'    End With                                     ||17850  |'    End With                                     
17879  |    With xlSheet.Range("N19:AN40").Borders(xlEdgeL||17851  |    With xlSheet.Range("N19:AN40").Borders(xlEdgeL
17880  |        .LineStyle = xlContinuous                 ||17852  |        .LineStyle = xlContinuous                 
17881  |        .Weight = xlThin                          ||17853  |        .Weight = xlThin                          
17882  |    End With                                      ||17854  |    End With                                      
17883  |    With xlSheet.Range("N19:AN40").Borders(xlEdgeT||17855  |    With xlSheet.Range("N19:AN40").Borders(xlEdgeT
17884  |        .LineStyle = xlContinuous                 ||17856  |        .LineStyle = xlContinuous                 
17885  |        .Weight = xlThin                          ||17857  |        .Weight = xlThin                          
17886  |    End With                                      ||17858  |    End With                                      
17887  |    With xlSheet.Range("N19:AN40").Borders(xlEdgeB||17859  |    With xlSheet.Range("N19:AN40").Borders(xlEdgeB
17888  |        .LineStyle = xlContinuous                 ||17860  |        .LineStyle = xlContinuous                 
17889  |        .Weight = xlThin                          ||17861  |        .Weight = xlThin                          
17890  |    End With                                      ||17862  |    End With                                      
17891  |    With xlSheet.Range("N19:AN40").Borders(xlEdgeR||17863  |    With xlSheet.Range("N19:AN40").Borders(xlEdgeR
17892  |        .LineStyle = xlContinuous                 ||17864  |        .LineStyle = xlContinuous                 
17893  |        .Weight = xlThin                          ||17865  |        .Weight = xlThin                          
17894  |    End With                                      ||17866  |    End With                                      
17895  |    With xlSheet.Range("N19:AN40").Borders(xlInsid||17867  |    With xlSheet.Range("N19:AN40").Borders(xlInsid
17896  |        .LineStyle = xlContinuous                 ||17868  |        .LineStyle = xlContinuous                 
17897  |        .Weight = xlThin                          ||17869  |        .Weight = xlThin                          
17898  |    End With                                      ||17870  |    End With                                      
17899  |    '月末純資産(真中縦線)                         ||17871  |    '月末純資産(真中縦線)                         
17900  |'    With xlSheet.Range("Y19:Y33").Borders(xlEdgeR||17872  |'    With xlSheet.Range("Y19:Y33").Borders(xlEdgeR
17901  |'        .LineStyle = xlContinuous                ||17873  |'        .LineStyle = xlContinuous                
17902  |'        .Weight = xlThin                         ||17874  |'        .Weight = xlThin                         
17903  |'    End With                                     ||17875  |'    End With                                     
17904  |    With xlSheet.Range("Y19:Y40").Borders(xlEdgeRi||17876  |    With xlSheet.Range("Y19:Y40").Borders(xlEdgeRi
17905  |        .LineStyle = xlContinuous                 ||17877  |        .LineStyle = xlContinuous                 
17906  |        .Weight = xlThin                          ||17878  |        .Weight = xlThin                          
17907  |    End With                                      ||17879  |    End With                                      
17908  |    '月末純資産(左側捺印欄　外枠)                 ||17880  |    '月末純資産(左側捺印欄　外枠)                 
17909  |    With xlSheet.Range("B56:S63").Borders(xlEdgeLe||17881  |    With xlSheet.Range("B56:S63").Borders(xlEdgeLe
17910  |        .LineStyle = xlContinuous                 ||17882  |        .LineStyle = xlContinuous                 
17911  |        .Weight = xlThin                          ||17883  |        .Weight = xlThin                          
17912  |    End With                                      ||17884  |    End With                                      
17913  |    With xlSheet.Range("B56:S63").Borders(xlEdgeTo||17885  |    With xlSheet.Range("B56:S63").Borders(xlEdgeTo
17914  |        .LineStyle = xlContinuous                 ||17886  |        .LineStyle = xlContinuous                 
17915  |        .Weight = xlThin                          ||17887  |        .Weight = xlThin                          
17916  |    End With                                      ||17888  |    End With                                      
17917  |    With xlSheet.Range("B56:S63").Borders(xlEdgeBo||17889  |    With xlSheet.Range("B56:S63").Borders(xlEdgeBo
17918  |        .LineStyle = xlContinuous                 ||17890  |        .LineStyle = xlContinuous                 
17919  |        .Weight = xlThin                          ||17891  |        .Weight = xlThin                          
17920  |    End With                                      ||17892  |    End With                                      
17921  |    With xlSheet.Range("B56:S63").Borders(xlEdgeRi||17893  |    With xlSheet.Range("B56:S63").Borders(xlEdgeRi
17922  |        .LineStyle = xlContinuous                 ||17894  |        .LineStyle = xlContinuous                 
17923  |        .Weight = xlThin                          ||17895  |        .Weight = xlThin                          
17924  |    End With                                      ||17896  |    End With                                      
17925  |    '月末純資産(左側捺印欄　上枠)                 ||17897  |    '月末純資産(左側捺印欄　上枠)                 
17926  |    With xlSheet.Range("B56:S57").Borders(xlEdgeBo||17898  |    With xlSheet.Range("B56:S57").Borders(xlEdgeBo
17927  |        .LineStyle = xlContinuous                 ||17899  |        .LineStyle = xlContinuous                 
17928  |        .Weight = xlThin                          ||17900  |        .Weight = xlThin                          
17929  |    End With                                      ||17901  |    End With                                      
17930  |    With xlSheet.Range("B56:S57").Borders(xlInside||17902  |    With xlSheet.Range("B56:S57").Borders(xlInside
17931  |        .LineStyle = xlContinuous                 ||17903  |        .LineStyle = xlContinuous                 
17932  |        .Weight = xlThin                          ||17904  |        .Weight = xlThin                          
17933  |    End With                                      ||17905  |    End With                                      
17934  |    '月末純資産(左側捺印欄　縦線)                 ||17906  |    '月末純資産(左側捺印欄　縦線)                 
17935  |    With xlSheet.Range("J57:J63").Borders(xlEdgeRi||17907  |    With xlSheet.Range("J57:J63").Borders(xlEdgeRi
17936  |        .LineStyle = xlContinuous                 ||17908  |        .LineStyle = xlContinuous                 
17937  |        .Weight = xlThin                          ||17909  |        .Weight = xlThin                          
17938  |    End With                                      ||17910  |    End With                                      
17939  |    '月末純資産(右側捺印欄　外枠)                 ||17911  |    '月末純資産(右側捺印欄　外枠)                 
17940  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeL||17912  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeL
17941  |        .LineStyle = xlContinuous                 ||17913  |        .LineStyle = xlContinuous                 
17942  |        .Weight = xlThin                          ||17914  |        .Weight = xlThin                          
17943  |    End With                                      ||17915  |    End With                                      
17944  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeT||17916  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeT
17945  |        .LineStyle = xlContinuous                 ||17917  |        .LineStyle = xlContinuous                 
17946  |        .Weight = xlThin                          ||17918  |        .Weight = xlThin                          
17947  |    End With                                      ||17919  |    End With                                      
17948  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeB||17920  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeB
17949  |        .LineStyle = xlContinuous                 ||17921  |        .LineStyle = xlContinuous                 
17950  |        .Weight = xlThin                          ||17922  |        .Weight = xlThin                          
17951  |    End With                                      ||17923  |    End With                                      
17952  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeR||17924  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeR
17953  |        .LineStyle = xlContinuous                 ||17925  |        .LineStyle = xlContinuous                 
17954  |        .Weight = xlThin                          ||17926  |        .Weight = xlThin                          
17955  |    End With                                      ||17927  |    End With                                      
17956  |    '月末純資産(右側捺印欄　上枠)                 ||17928  |    '月末純資産(右側捺印欄　上枠)                 
17957  |    With xlSheet.Range("X56:AO57").Borders(xlEdgeT||17929  |    With xlSheet.Range("X56:AO57").Borders(xlEdgeT
17958  |        .LineStyle = xlContinuous                 ||17930  |        .LineStyle = xlContinuous                 
17959  |        .Weight = xlThin                          ||17931  |        .Weight = xlThin                          
17960  |    End With                                      ||17932  |    End With                                      
17961  |    With xlSheet.Range("X56:AO57").Borders(xlEdgeB||17933  |    With xlSheet.Range("X56:AO57").Borders(xlEdgeB
17962  |        .LineStyle = xlContinuous                 ||17934  |        .LineStyle = xlContinuous                 
17963  |        .Weight = xlThin                          ||17935  |        .Weight = xlThin                          
17964  |    End With                                      ||17936  |    End With                                      
17965  |    With xlSheet.Range("X56:AO57").Borders(xlInsid||17937  |    With xlSheet.Range("X56:AO57").Borders(xlInsid
17966  |        .LineStyle = xlContinuous                 ||17938  |        .LineStyle = xlContinuous                 
17967  |        .Weight = xlThin                          ||17939  |        .Weight = xlThin                          
17968  |    End With                                      ||17940  |    End With                                      
17969  |    '月末純資産(右側捺印欄　縦線)                 ||17941  |    '月末純資産(右側捺印欄　縦線)                 
17970  |    With xlSheet.Range("AF57:AF63").Borders(xlEdge||17942  |    With xlSheet.Range("AF57:AF63").Borders(xlEdge
17971  |        .LineStyle = xlContinuous                 ||17943  |        .LineStyle = xlContinuous                 
17972  |        .Weight = xlThin                          ||17944  |        .Weight = xlThin                          
17973  |    End With                                      ||17945  |    End With                                      
17974  |                                                  ||17946  |                                                  
17975  |                                                  ||17947  |                                                  
17976  |    '月末純資産　下線                             ||17948  |    '月末純資産　下線                             
17977  |    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract_||17949  |    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract_
17978  |    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||17950  |    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
17979  |        xlSheet.Cells(15, 13).Value = _           ||17951  |        xlSheet.Cells(15, 13).Value = _           
17980  |            CStr(Format(dStart, "YYYY年M月D日")) &||17952  |            CStr(Format(dStart, "YYYY年M月D日")) &
17981  |    Else                                          ||17953  |    Else                                          
17982  |        xlSheet.Cells(15, 13).Value = _           ||17954  |        xlSheet.Cells(15, 13).Value = _           
17983  |            CStr(Format(dStart, "YYYY年M月D日")) &||17955  |            CStr(Format(dStart, "YYYY年M月D日")) &
17984  |    End If                                        ||17956  |    End If                                        
17985  |    'A4印刷用に上2行を削除して、プレビュー範囲内に||17957  |    'A4印刷用に上2行を削除して、プレビュー範囲内に
17986  |    xlSheet.Rows("1:2").Delete Shift:=xlUp        ||17958  |    xlSheet.Rows("1:2").Delete Shift:=xlUp        
17987  |                                                  ||17959  |                                                  
17988  |'期中料率変更契約対応 START                       ||17960  |'期中料率変更契約対応 START                       
17989  |    '料率変更履歴票作成                           ||17961  |    '料率変更履歴票作成                           
17990  |    'RAFI対応 START                               ||17962  |    'RAFI対応 START                               
17991  |    '純資産の場合                                 ||17963  |    '純資産の場合                                 
17992  |    If msAssetFlg = "0" Then                      ||17964  |    If msAssetFlg = "0" Then                      
17993  |        Call sbExcelChgRateSheetOut( _            ||17965  |        Call sbExcelChgRateSheetOut( _            
17994  |                sGetAccCode, TotalRate, lRecIdx, d||17966  |                sGetAccCode, TotalRate, lRecIdx, d
17995  |    'マザー組入資産の場合                         ||17967  |    'マザー組入資産の場合                         
17996  |    Else                                          ||17968  |    Else                                          
17997  |        Call sbExcelChgRateSheetOut( _            ||17969  |        Call sbExcelChgRateSheetOut( _            
17998  |                msBabyAccountCode, TotalRate, lRec||17970  |                msBabyAccountCode, TotalRate, lRec
17999  |    End If                                        ||17971  |    End If                                        
18000  |    'RAFI対応 END                                 ||17972  |    'RAFI対応 END                                 
18001  |'期中料率変更契約対応 END                         ||17973  |'期中料率変更契約対応 END                         
18002  |                                                  ||17974  |                                                  
18003  |'=================================================||17975  |'=================================================
18004  |'== 　　　　日次NAV/日時時価総額の別表作成エリア  ||17976  |'== 　　　　日次NAV/日時時価総額の別表作成エリア  
18005  |'=================================================||17977  |'=================================================
18006  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||17978  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
18007  |'    'NAV取得区分：日次NAV平均(休日有)または日次NA||17979  |'    'NAV取得区分：日次NAV平均(休日有)または日次NA
18008  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||17980  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
18009  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||17981  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
18010  |    'NAV取得区分：日次NAV平均(休日有)、日次NAV平均||17982  |    'NAV取得区分：日次NAV平均(休日有)、日次NAV平均
18011  |    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag ||17983  |    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag 
18012  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||17984  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
18013  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||17985  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
18014  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||17986  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
18015  |                                                  ||17987  |                                                  
18016  |        gTotalDnavCnt = 0                         ||17988  |        gTotalDnavCnt = 0                         
18017  |        J = 0                                     ||17989  |        J = 0                                     
18018  |        K = 0                                     ||17990  |        K = 0                                     
18019  |        'ループ終了フラグ初期化                   ||17991  |        'ループ終了フラグ初期化                   
18020  |        EndFlg = False                            ||17992  |        EndFlg = False                            
18021  |        SetPoint = 0                              ||17993  |        SetPoint = 0                              
18022  |        AddPoint = 0                              ||17994  |        AddPoint = 0                              
18023  |                                                  ||17995  |                                                  
18024  |        '＋２は合計行と平均行                     ||17996  |        '＋２は合計行と平均行                     
18025  |'        dintPage = (dlngCnt + 2) \ 108           ||17997  |'        dintPage = (dlngCnt + 2) \ 108           
18026  |'        dintAmari = (dlngCnt + 2) Mod 108        ||17998  |'        dintAmari = (dlngCnt + 2) Mod 108        
18027  |        '余白 + (料率数 × 2) + (料率数 - 1)      ||17999  |        '余白 + (料率数 × 2) + (料率数 - 1)      
18028  |        dintPage = (dlngCnt + 2 + 2 + ((UBound(gty||18000  |        dintPage = (dlngCnt + 2 + 2 + ((UBound(gty
18029  |        dintAmari = (dlngCnt + 2 + 2 + ((UBound(gt||18001  |        dintAmari = (dlngCnt + 2 + 2 + ((UBound(gt
18030  |                                                  ||18002  |                                                  
18031  |        If dintAmari <> 0 Then                    ||18003  |        If dintAmari <> 0 Then                    
18032  |            dintPage = dintPage + 1               ||18004  |            dintPage = dintPage + 1               
18033  |        End If                                    ||18005  |        End If                                    
18034  |                                                  ||18006  |                                                  
18035  |        For L = 1 To dintPage                     ||18007  |        For L = 1 To dintPage                     
18036  |                                                  ||18008  |                                                  
18037  |            xlBook.Worksheets.Add after:=xlBook.Sh||18009  |            xlBook.Worksheets.Add after:=xlBook.Sh
18038  |            gProcessCnt = gProcessCnt + 1         ||18010  |            gProcessCnt = gProcessCnt + 1         
18039  |            Set xlSheet = xlBook.Sheets(gProcessCn||18011  |            Set xlSheet = xlBook.Sheets(gProcessCn
18040  |                                                  ||18012  |                                                  
18041  |            'Excelフォーマットを調整              ||18013  |            'Excelフォーマットを調整              
18042  |            xlSheet.Cells.ColumnWidth = 1         ||18014  |            xlSheet.Cells.ColumnWidth = 1         
18043  |            xlSheet.Cells.Font.Size = 11          ||18015  |            xlSheet.Cells.Font.Size = 11          
18044  |            'シート名を設定(日次NAV一覧**)        ||18016  |            'シート名を設定(日次NAV一覧**)        
18045  |                                                  ||18017  |                                                  
18046  |            'RAFI対応 START                       ||18018  |            'RAFI対応 START                       
18047  |            '純資産の場合                         ||18019  |            '純資産の場合                         
18048  |            If msAssetFlg = "0" Then              ||18020  |            If msAssetFlg = "0" Then              
18049  |                If dstrOldAccCode = sGetAccCode Th||18021  |                If dstrOldAccCode = sGetAccCode Th
18050  |                    gTotalDnavCnt = gTotalDnavCnt ||18022  |                    gTotalDnavCnt = gTotalDnavCnt 
18051  |                Else                              ||18023  |                Else                              
18052  |                    gTotalDnavCnt = 1             ||18024  |                    gTotalDnavCnt = 1             
18053  |                    dstrOldAccCode = sGetAccCode  ||18025  |                    dstrOldAccCode = sGetAccCode  
18054  |                End If                            ||18026  |                End If                            
18055  |            'マザー組入資産の場合                 ||18027  |            'マザー組入資産の場合                 
18056  |            Else                                  ||18028  |            Else                                  
18057  |                If dstrOldAccCode = msBabyAccountC||18029  |                If dstrOldAccCode = msBabyAccountC
18058  |                    gTotalDnavCnt = gTotalDnavCnt ||18030  |                    gTotalDnavCnt = gTotalDnavCnt 
18059  |                Else                              ||18031  |                Else                              
18060  |                    gTotalDnavCnt = 1             ||18032  |                    gTotalDnavCnt = 1             
18061  |                    dstrOldAccCode = msBabyAccount||18033  |                    dstrOldAccCode = msBabyAccount
18062  |                End If                            ||18034  |                End If                            
18063  |            End If                                ||18035  |            End If                                
18064  |            'RAFI対応 END                         ||18036  |            'RAFI対応 END                         
18065  |            'gTotalCnt = gTotalCnt + 1            ||18037  |            'gTotalCnt = gTotalCnt + 1            
18066  |            'RAFI対応 START                       ||18038  |            'RAFI対応 START                       
18067  |            '純資産の場合                         ||18039  |            '純資産の場合                         
18068  |            If msAssetFlg = "0" Then              ||18040  |            If msAssetFlg = "0" Then              
18069  |                '複数ページの場合                 ||18041  |                '複数ページの場合                 
18070  |                If dintPage > 1 Then              ||18042  |                If dintPage > 1 Then              
18071  |                    xlBook.Sheets(gProcessCnt).Nam||18043  |                    xlBook.Sheets(gProcessCnt).Nam
18072  |                Else                              ||18044  |                Else                              
18073  |                    xlBook.Sheets(gProcessCnt).Nam||18045  |                    xlBook.Sheets(gProcessCnt).Nam
18074  |                End If                            ||18046  |                End If                            
18075  |            'マザー組入資産の場合                 ||18047  |            'マザー組入資産の場合                 
18076  |            Else                                  ||18048  |            Else                                  
18077  |                '複数ページの場合                 ||18049  |                '複数ページの場合                 
18078  |                If dintPage > 1 Then              ||18050  |                If dintPage > 1 Then              
18079  |                    xlBook.Sheets(gProcessCnt).Nam||18051  |                    xlBook.Sheets(gProcessCnt).Nam
18080  |                Else                              ||18052  |                Else                              
18081  |                    xlBook.Sheets(gProcessCnt).Nam||18053  |                    xlBook.Sheets(gProcessCnt).Nam
18082  |                End If                            ||18054  |                End If                            
18083  |            End If                                ||18055  |            End If                                
18084  |            'RAFI対応 END                         ||18056  |            'RAFI対応 END                         
18085  |            'シートの余白を設定                   ||18057  |            'シートの余白を設定                   
18086  |            xlSheet.PageSetup.TopMargin = Applicat||18058  |            xlSheet.PageSetup.TopMargin = Applicat
18087  |            xlSheet.PageSetup.BottomMargin = Appli||18059  |            xlSheet.PageSetup.BottomMargin = Appli
18088  |            xlSheet.PageSetup.LeftMargin = Applica||18060  |            xlSheet.PageSetup.LeftMargin = Applica
18089  |            xlSheet.PageSetup.RightMargin = Applic||18061  |            xlSheet.PageSetup.RightMargin = Applic
18090  |                                                  ||18062  |                                                  
18091  |            DoEvents                              ||18063  |            DoEvents                              
18092  |                                                  ||18064  |                                                  
18093  |            With xlSheet                          ||18065  |            With xlSheet                          
18094  |                '題目                             ||18066  |                '題目                             
18095  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||18067  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
18096  |                '取得NAV区分が4:日次時価総額平均の||18068  |                '取得NAV区分が4:日次時価総額平均の
18097  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||18069  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
18098  |                    .Cells(5, 1).Value = sWord63  ||18070  |                    .Cells(5, 1).Value = sWord63  
18099  |                Else                              ||18071  |                Else                              
18100  |                    .Cells(5, 1).Value = sWord47  ||18072  |                    .Cells(5, 1).Value = sWord47  
18101  |                End If                            ||18073  |                End If                            
18102  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||18074  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
18103  |                .Cells(5, 1).Font.Size = 14       ||18075  |                .Cells(5, 1).Font.Size = 14       
18104  |                .Range("A5:BG5").HorizontalAlignme||18076  |                .Range("A5:BG5").HorizontalAlignme
18105  |                '出力日付                         ||18077  |                '出力日付                         
18106  |                If RTrim(txtSysOutDate.Text) = "" ||18078  |                If RTrim(txtSysOutDate.Text) = "" 
18107  |                    .Cells(3, 50).Value = sWord34 ||18079  |                    .Cells(3, 50).Value = sWord34 
18108  |                    .Cells(3, 50).HorizontalAlignm||18080  |                    .Cells(3, 50).HorizontalAlignm
18109  |                Else                              ||18081  |                Else                              
18110  |                    .Cells(3, 43).Value = CStr(For||18082  |                    .Cells(3, 43).Value = CStr(For
18111  |                End If                            ||18083  |                End If                            
18112  |                'ファンド名                       ||18084  |                'ファンド名                       
18113  |                .Cells(6, 2).Value = sWord4       ||18085  |                .Cells(6, 2).Value = sWord4       
18114  |                .Cells(6, 11).Value = sWord19     ||18086  |                .Cells(6, 11).Value = sWord19     
18115  |                .Cells(6, 13).Value = gbuMGetUPDRe||18087  |                .Cells(6, 13).Value = gbuMGetUPDRe
18116  |                'ファンドコード                   ||18088  |                'ファンドコード                   
18117  |                .Cells(7, 2).Value = sWord4_2     ||18089  |                .Cells(7, 2).Value = sWord4_2     
18118  |                .Cells(7, 11).Value = sWord19     ||18090  |                .Cells(7, 11).Value = sWord19     
18119  |                .Cells(7, 13).NumberFormatLocal = ||18091  |                .Cells(7, 13).NumberFormatLocal = 
18120  |                'RAFI対応 START                   ||18092  |                'RAFI対応 START                   
18121  |                '純資産の場合                     ||18093  |                '純資産の場合                     
18122  |                If msAssetFlg = "0" Then          ||18094  |                If msAssetFlg = "0" Then          
18123  |                    .Cells(7, 13).Value = sGetAccC||18095  |                    .Cells(7, 13).Value = sGetAccC
18124  |                'マザー組入資産の場合             ||18096  |                'マザー組入資産の場合             
18125  |                Else                              ||18097  |                Else                              
18126  |                    .Cells(7, 13).Value = msBabyAc||18098  |                    .Cells(7, 13).Value = msBabyAc
18127  |                End If                            ||18099  |                End If                            
18128  |                'RAFI対応 END                     ||18100  |                'RAFI対応 END                     
18129  |                                                  ||18101  |                                                  
18130  |                '計算期間                         ||18102  |                '計算期間                         
18131  |                .Cells(8, 2).Value = sWord5       ||18103  |                .Cells(8, 2).Value = sWord5       
18132  |                .Cells(8, 11).Value = sWord19     ||18104  |                .Cells(8, 11).Value = sWord19     
18133  |                If Mid(gbuMGetUPDRec.N(lRecIdx).MG||18105  |                If Mid(gbuMGetUPDRec.N(lRecIdx).MG
18134  |                And gbuMGetUPDRec.N(lRecIdx).MGET_||18106  |                And gbuMGetUPDRec.N(lRecIdx).MGET_
18135  |                    .Cells(8, 13).Value = _       ||18107  |                    .Cells(8, 13).Value = _       
18136  |                        CStr(Format(dStart, "YYYY ||18108  |                        CStr(Format(dStart, "YYYY 
18137  |                Else                              ||18109  |                Else                              
18138  |                    .Cells(8, 13).Value = _       ||18110  |                    .Cells(8, 13).Value = _       
18139  |                        CStr(Format(dStart, "YYYY ||18111  |                        CStr(Format(dStart, "YYYY 
18140  |                End If                            ||18112  |                End If                            
18141  |                '日付                             ||18113  |                '日付                             
18142  |                .Cells(10, 3).Value = sWord7      ||18114  |                .Cells(10, 3).Value = sWord7      
18143  |                .Range("C10:N10").HorizontalAlignm||18115  |                .Range("C10:N10").HorizontalAlignm
18144  |                '純資産                           ||18116  |                '純資産                           
18145  |                .Cells(10, 15).Value = sWord8     ||18117  |                .Cells(10, 15).Value = sWord8     
18146  |                .Range("O10:AC10").HorizontalAlign||18118  |                .Range("O10:AC10").HorizontalAlign
18147  |                '日付                             ||18119  |                '日付                             
18148  |                .Cells(10, 31).Value = sWord7     ||18120  |                .Cells(10, 31).Value = sWord7     
18149  |                .Range("AE10:AP10").HorizontalAlig||18121  |                .Range("AE10:AP10").HorizontalAlig
18150  |                '純資産                           ||18122  |                '純資産                           
18151  |                .Cells(10, 43).Value = sWord8     ||18123  |                .Cells(10, 43).Value = sWord8     
18152  |                .Range("AQ10:BE10").HorizontalAlig||18124  |                .Range("AQ10:BE10").HorizontalAlig
18153  |                '日付＆NAV                        ||18125  |                '日付＆NAV                        
18154  |                Select Case L                     ||18126  |                Select Case L                     
18155  |                    Case 1                        ||18127  |                    Case 1                        
18156  |                        dintPageIni = 1           ||18128  |                        dintPageIni = 1           
18157  |                    Case Else                     ||18129  |                    Case Else                     
18158  |                        dintPageIni = dintPageIni ||18130  |                        dintPageIni = dintPageIni 
18159  |                End Select                        ||18131  |                End Select                        
18160  |                For dintFor = dintPageIni To dlngC||18132  |                For dintFor = dintPageIni To dlngC
18161  |                    If J < 54 Then                ||18133  |                    If J < 54 Then                
18162  |                        If dintFor = dlngCnt + 1 T||18134  |                        If dintFor = dlngCnt + 1 T
18163  |                            '合計                 ||18135  |                            '合計                 
18164  |                            .Cells(11 + J, 3).Valu||18136  |                            .Cells(11 + J, 3).Valu
18165  |                            'NAV                  ||18137  |                            'NAV                  
18166  |                            .Cells(11 + J, 28).Num||18138  |                            .Cells(11 + J, 28).Num
18167  |                            If gbuMGetUPDRec.N(lRe||18139  |                            If gbuMGetUPDRec.N(lRe
18168  |                                .Cells(11 + J, 28)||18140  |                                .Cells(11 + J, 28)
18169  |                            Else                  ||18141  |                            Else                  
18170  |                                .Cells(11 + J, 28)||18142  |                                .Cells(11 + J, 28)
18171  |                            End If                ||18143  |                            End If                
18172  |                            .Cells(11 + J, 28).Hor||18144  |                            .Cells(11 + J, 28).Hor
18173  |                        End If                    ||18145  |                        End If                    
18174  |                        If dintFor = dlngCnt + 2 T||18146  |                        If dintFor = dlngCnt + 2 T
18175  |                            '平均                 ||18147  |                            '平均                 
18176  |                            .Cells(11 + J, 3).Valu||18148  |                            .Cells(11 + J, 3).Valu
18177  |                            'NAV                  ||18149  |                            'NAV                  
18178  |                            .Cells(11 + J, 28).Num||18150  |                            .Cells(11 + J, 28).Num
18179  |                            If gbuMGetUPDRec.N(lRe||18151  |                            If gbuMGetUPDRec.N(lRe
18180  |                                .Cells(11 + J, 28)||18152  |                                .Cells(11 + J, 28)
18181  |                            Else                  ||18153  |                            Else                  
18182  |                                .Cells(11 + J, 28)||18154  |                                .Cells(11 + J, 28)
18183  |                            End If                ||18155  |                            End If                
18184  |                            .Cells(11 + J, 28).Hor||18156  |                            .Cells(11 + J, 28).Hor
18185  |                        End If                    ||18157  |                        End If                    
18186  |                        If dintFor < dlngCnt + 1 T||18158  |                        If dintFor < dlngCnt + 1 T
18187  |                            '日付                 ||18159  |                            '日付                 
18188  |                            dCalDate = CDate(gstrD||18160  |                            dCalDate = CDate(gstrD
18189  |                            .Cells(11 + J, 4).Valu||18161  |                            .Cells(11 + J, 4).Valu
18190  |                                CStr(Format(dCalDa||18162  |                                CStr(Format(dCalDa
18191  |                            'NAV                  ||18163  |                            'NAV                  
18192  |                            .Cells(11 + J, 28).Num||18164  |                            .Cells(11 + J, 28).Num
18193  |                            If gbuMGetUPDRec.N(lRe||18165  |                            If gbuMGetUPDRec.N(lRe
18194  |                                .Cells(11 + J, 28)||18166  |                                .Cells(11 + J, 28)
18195  |                            Else                  ||18167  |                            Else                  
18196  |                                .Cells(11 + J, 28)||18168  |                                .Cells(11 + J, 28)
18197  |                            End If                ||18169  |                            End If                
18198  |                            .Cells(11 + J, 28).Hor||18170  |                            .Cells(11 + J, 28).Hor
18199  |                        End If                    ||18171  |                        End If                    
18200  |                    Else                          ||18172  |                    Else                          
18201  |                        If dintFor = dlngCnt + 1 T||18173  |                        If dintFor = dlngCnt + 1 T
18202  |                            '合計                 ||18174  |                            '合計                 
18203  |                            .Cells(11 + K, 31).Val||18175  |                            .Cells(11 + K, 31).Val
18204  |                            'NAV                  ||18176  |                            'NAV                  
18205  |                            .Cells(11 + K, 56).Num||18177  |                            .Cells(11 + K, 56).Num
18206  |                            If gbuMGetUPDRec.N(lRe||18178  |                            If gbuMGetUPDRec.N(lRe
18207  |                                .Cells(11 + K, 56)||18179  |                                .Cells(11 + K, 56)
18208  |                            Else                  ||18180  |                            Else                  
18209  |                                .Cells(11 + K, 56)||18181  |                                .Cells(11 + K, 56)
18210  |                            End If                ||18182  |                            End If                
18211  |                            .Cells(11 + K, 56).Hor||18183  |                            .Cells(11 + K, 56).Hor
18212  |                        End If                    ||18184  |                        End If                    
18213  |                        If dintFor = dlngCnt + 2 T||18185  |                        If dintFor = dlngCnt + 2 T
18214  |                            '平均                 ||18186  |                            '平均                 
18215  |                            .Cells(11 + K, 31).Val||18187  |                            .Cells(11 + K, 31).Val
18216  |                            'NAV                  ||18188  |                            'NAV                  
18217  |                            .Cells(11 + K, 56).Num||18189  |                            .Cells(11 + K, 56).Num
18218  |                            If gbuMGetUPDRec.N(lRe||18190  |                            If gbuMGetUPDRec.N(lRe
18219  |                                .Cells(11 + K, 56)||18191  |                                .Cells(11 + K, 56)
18220  |                            Else                  ||18192  |                            Else                  
18221  |                                .Cells(11 + K, 56)||18193  |                                .Cells(11 + K, 56)
18222  |                            End If                ||18194  |                            End If                
18223  |                            .Cells(11 + K, 56).Hor||18195  |                            .Cells(11 + K, 56).Hor
18224  |                        End If                    ||18196  |                        End If                    
18225  |                        If dintFor < dlngCnt + 1 T||18197  |                        If dintFor < dlngCnt + 1 T
18226  |                            '日付                 ||18198  |                            '日付                 
18227  |                            dCalDate = CDate(gstrD||18199  |                            dCalDate = CDate(gstrD
18228  |                            .Cells(11 + K, 32).Val||18200  |                            .Cells(11 + K, 32).Val
18229  |                                CStr(Format(dCalDa||18201  |                                CStr(Format(dCalDa
18230  |                            'NAV                  ||18202  |                            'NAV                  
18231  |                            .Cells(11 + K, 56).Num||18203  |                            .Cells(11 + K, 56).Num
18232  |                            If gbuMGetUPDRec.N(lRe||18204  |                            If gbuMGetUPDRec.N(lRe
18233  |                                .Cells(11 + K, 56)||18205  |                                .Cells(11 + K, 56)
18234  |                            Else                  ||18206  |                            Else                  
18235  |                                .Cells(11 + K, 56)||18207  |                                .Cells(11 + K, 56)
18236  |                            End If                ||18208  |                            End If                
18237  |                            .Cells(11 + K, 56).Hor||18209  |                            .Cells(11 + K, 56).Hor
18238  |                        End If                    ||18210  |                        End If                    
18239  |                        K = K + 1                 ||18211  |                        K = K + 1                 
18240  |                        If K > 53 Then            ||18212  |                        If K > 53 Then            
18241  |                            J = 0                 ||18213  |                            J = 0                 
18242  |                            K = 0                 ||18214  |                            K = 0                 
18243  |                            Exit For              ||18215  |                            Exit For              
18244  |                        End If                    ||18216  |                        End If                    
18245  |                    End If                        ||18217  |                    End If                        
18246  |                    J = J + 1                     ||18218  |                    J = J + 1                     
18247  |                    'ループ終了したらフラグをON   ||18219  |                    'ループ終了したらフラグをON   
18248  |                    If dintFor = (dlngCnt + 2) The||18220  |                    If dintFor = (dlngCnt + 2) The
18249  |                        EndFlg = True             ||18221  |                        EndFlg = True             
18250  |                        '平均の終了行の次行を取得 ||18222  |                        '平均の終了行の次行を取得 
18251  |                        If K = 0 Then             ||18223  |                        If K = 0 Then             
18252  |                            intRange = J + 11     ||18224  |                            intRange = J + 11     
18253  |                            strRange = "J"        ||18225  |                            strRange = "J"        
18254  |                        ElseIf K <> 0 Then        ||18226  |                        ElseIf K <> 0 Then        
18255  |                            intRange = K + 11     ||18227  |                            intRange = K + 11     
18256  |                            strRange = "K"        ||18228  |                            strRange = "K"        
18257  |                        Else                      ||18229  |                        Else                      
18258  |                            intRange = 11         ||18230  |                            intRange = 11         
18259  |                            strRange = "J"        ||18231  |                            strRange = "J"        
18260  |                        End If                    ||18232  |                        End If                    
18261  |                        J = 0                     ||18233  |                        J = 0                     
18262  |                        K = 0                     ||18234  |                        K = 0                     
18263  |                    End If                        ||18235  |                    End If                        
18264  |                Next dintFor                      ||18236  |                Next dintFor                      
18265  |                                                  ||18237  |                                                  
18266  |                '左側日付                         ||18238  |                '左側日付                         
18267  |                With xlSheet.Range("C10:N64").Bord||18239  |                With xlSheet.Range("C10:N64").Bord
18268  |                    .LineStyle = xlContinuous     ||18240  |                    .LineStyle = xlContinuous     
18269  |                    .Weight = xlThin              ||18241  |                    .Weight = xlThin              
18270  |                End With                          ||18242  |                End With                          
18271  |                With xlSheet.Range("C10:N64").Bord||18243  |                With xlSheet.Range("C10:N64").Bord
18272  |                    .LineStyle = xlContinuous     ||18244  |                    .LineStyle = xlContinuous     
18273  |                    .Weight = xlThin              ||18245  |                    .Weight = xlThin              
18274  |                End With                          ||18246  |                End With                          
18275  |                With xlSheet.Range("C10:N64").Bord||18247  |                With xlSheet.Range("C10:N64").Bord
18276  |                    .LineStyle = xlContinuous     ||18248  |                    .LineStyle = xlContinuous     
18277  |                    .Weight = xlThin              ||18249  |                    .Weight = xlThin              
18278  |                End With                          ||18250  |                End With                          
18279  |                With xlSheet.Range("C10:N64").Bord||18251  |                With xlSheet.Range("C10:N64").Bord
18280  |                    .LineStyle = xlContinuous     ||18252  |                    .LineStyle = xlContinuous     
18281  |                    .Weight = xlThin              ||18253  |                    .Weight = xlThin              
18282  |                End With                          ||18254  |                End With                          
18283  |                With xlSheet.Range("C10:N64").Bord||18255  |                With xlSheet.Range("C10:N64").Bord
18284  |                    .LineStyle = xlContinuous     ||18256  |                    .LineStyle = xlContinuous     
18285  |                    .Weight = xlThin              ||18257  |                    .Weight = xlThin              
18286  |                End With                          ||18258  |                End With                          
18287  |                                                  ||18259  |                                                  
18288  |                '左側純資産                       ||18260  |                '左側純資産                       
18289  |                With xlSheet.Range("O10:AC64").Bor||18261  |                With xlSheet.Range("O10:AC64").Bor
18290  |                    .LineStyle = xlContinuous     ||18262  |                    .LineStyle = xlContinuous     
18291  |                    .Weight = xlThin              ||18263  |                    .Weight = xlThin              
18292  |                End With                          ||18264  |                End With                          
18293  |                With xlSheet.Range("O10:AC64").Bor||18265  |                With xlSheet.Range("O10:AC64").Bor
18294  |                    .LineStyle = xlContinuous     ||18266  |                    .LineStyle = xlContinuous     
18295  |                    .Weight = xlThin              ||18267  |                    .Weight = xlThin              
18296  |                End With                          ||18268  |                End With                          
18297  |                With xlSheet.Range("O10:AC64").Bor||18269  |                With xlSheet.Range("O10:AC64").Bor
18298  |                    .LineStyle = xlContinuous     ||18270  |                    .LineStyle = xlContinuous     
18299  |                    .Weight = xlThin              ||18271  |                    .Weight = xlThin              
18300  |                End With                          ||18272  |                End With                          
18301  |                With xlSheet.Range("O10:AC64").Bor||18273  |                With xlSheet.Range("O10:AC64").Bor
18302  |                    .LineStyle = xlContinuous     ||18274  |                    .LineStyle = xlContinuous     
18303  |                    .Weight = xlThin              ||18275  |                    .Weight = xlThin              
18304  |                End With                          ||18276  |                End With                          
18305  |                With xlSheet.Range("O10:AC64").Bor||18277  |                With xlSheet.Range("O10:AC64").Bor
18306  |                    .LineStyle = xlContinuous     ||18278  |                    .LineStyle = xlContinuous     
18307  |                    .Weight = xlThin              ||18279  |                    .Weight = xlThin              
18308  |                End With                          ||18280  |                End With                          
18309  |                                                  ||18281  |                                                  
18310  |                '右側日付                         ||18282  |                '右側日付                         
18311  |                With xlSheet.Range("AE10:AP64").Bo||18283  |                With xlSheet.Range("AE10:AP64").Bo
18312  |                    .LineStyle = xlContinuous     ||18284  |                    .LineStyle = xlContinuous     
18313  |                    .Weight = xlThin              ||18285  |                    .Weight = xlThin              
18314  |                End With                          ||18286  |                End With                          
18315  |                With xlSheet.Range("AE10:AP64").Bo||18287  |                With xlSheet.Range("AE10:AP64").Bo
18316  |                    .LineStyle = xlContinuous     ||18288  |                    .LineStyle = xlContinuous     
18317  |                    .Weight = xlThin              ||18289  |                    .Weight = xlThin              
18318  |                End With                          ||18290  |                End With                          
18319  |                With xlSheet.Range("AE10:AP64").Bo||18291  |                With xlSheet.Range("AE10:AP64").Bo
18320  |                    .LineStyle = xlContinuous     ||18292  |                    .LineStyle = xlContinuous     
18321  |                    .Weight = xlThin              ||18293  |                    .Weight = xlThin              
18322  |                End With                          ||18294  |                End With                          
18323  |                With xlSheet.Range("AE10:AP64").Bo||18295  |                With xlSheet.Range("AE10:AP64").Bo
18324  |                    .LineStyle = xlContinuous     ||18296  |                    .LineStyle = xlContinuous     
18325  |                    .Weight = xlThin              ||18297  |                    .Weight = xlThin              
18326  |                End With                          ||18298  |                End With                          
18327  |                With xlSheet.Range("AE10:AP64").Bo||18299  |                With xlSheet.Range("AE10:AP64").Bo
18328  |                    .LineStyle = xlContinuous     ||18300  |                    .LineStyle = xlContinuous     
18329  |                    .Weight = xlThin              ||18301  |                    .Weight = xlThin              
18330  |                End With                          ||18302  |                End With                          
18331  |                                                  ||18303  |                                                  
18332  |                '右側純資産                       ||18304  |                '右側純資産                       
18333  |                With xlSheet.Range("AQ10:BE64").Bo||18305  |                With xlSheet.Range("AQ10:BE64").Bo
18334  |                    .LineStyle = xlContinuous     ||18306  |                    .LineStyle = xlContinuous     
18335  |                    .Weight = xlThin              ||18307  |                    .Weight = xlThin              
18336  |                End With                          ||18308  |                End With                          
18337  |                With xlSheet.Range("AQ10:BE64").Bo||18309  |                With xlSheet.Range("AQ10:BE64").Bo
18338  |                    .LineStyle = xlContinuous     ||18310  |                    .LineStyle = xlContinuous     
18339  |                    .Weight = xlThin              ||18311  |                    .Weight = xlThin              
18340  |                End With                          ||18312  |                End With                          
18341  |                With xlSheet.Range("AQ10:BE64").Bo||18313  |                With xlSheet.Range("AQ10:BE64").Bo
18342  |                    .LineStyle = xlContinuous     ||18314  |                    .LineStyle = xlContinuous     
18343  |                    .Weight = xlThin              ||18315  |                    .Weight = xlThin              
18344  |                End With                          ||18316  |                End With                          
18345  |                With xlSheet.Range("AQ10:BE64").Bo||18317  |                With xlSheet.Range("AQ10:BE64").Bo
18346  |                    .LineStyle = xlContinuous     ||18318  |                    .LineStyle = xlContinuous     
18347  |                    .Weight = xlThin              ||18319  |                    .Weight = xlThin              
18348  |                End With                          ||18320  |                End With                          
18349  |                With xlSheet.Range("AQ10:BE64").Bo||18321  |                With xlSheet.Range("AQ10:BE64").Bo
18350  |                    .LineStyle = xlContinuous     ||18322  |                    .LineStyle = xlContinuous     
18351  |                    .Weight = xlThin              ||18323  |                    .Weight = xlThin              
18352  |                End With                          ||18324  |                End With                          
18353  |                                                  ||18325  |                                                  
18354  |            End With                              ||18326  |            End With                              
18355  |                                                  ||18327  |                                                  
18356  |                                                  ||18328  |                                                  
18357  |                                                  ||18329  |                                                  
18358  |            '日次NAV平均の出力が終了したら料率別平||18330  |            '日次NAV平均の出力が終了したら料率別平
18359  |            If EndFlg = True Then                 ||18331  |            If EndFlg = True Then                 
18360  |                With xlSheet                      ||18332  |                With xlSheet                      
18361  |                    For dintFor = SetPoint + AddPo||18333  |                    For dintFor = SetPoint + AddPo
18362  |                        If dintFor = 0 Then       ||18334  |                        If dintFor = 0 Then       
18363  |                            If strRange = "J" Then||18335  |                            If strRange = "J" Then
18364  |                                If intRange = 11 T||18336  |                                If intRange = 11 T
18365  |                                    '余白無し     ||18337  |                                    '余白無し     
18366  |                                    '日付         ||18338  |                                    '日付         
18367  |                                    .Cells(intRang||18339  |                                    .Cells(intRang
18368  |                                        sWord60 & ||18340  |                                        sWord60 & 
18369  |                                    J = J + 1     ||18341  |                                    J = J + 1     
18370  |                                    .Cells(intRang||18342  |                                    .Cells(intRang
18371  |                                    dblValueIn = g||18343  |                                    dblValueIn = g
18372  |                                    .Cells(intRang||18344  |                                    .Cells(intRang
18373  |                                    '平均純資産   ||18345  |                                    '平均純資産   
18374  |                                    dblValueIn = g||18346  |                                    dblValueIn = g
18375  |                                    If gtypOtherCo||18347  |                                    If gtypOtherCo
18376  |                                          Call sbG||18348  |                                          Call sbG
18377  |                                    Else          ||18349  |                                    Else          
18378  |                                          Call sbG||18350  |                                          Call sbG
18379  |                                    End If        ||18351  |                                    End If        
18380  |                                    If gtypOtherCo||18352  |                                    If gtypOtherCo
18381  |                                        .Cells(int||18353  |                                        .Cells(int
18382  |                                    Else          ||18354  |                                    Else          
18383  |                                        .Cells(int||18355  |                                        .Cells(int
18384  |                                    End If        ||18356  |                                    End If        
18385  |                                    'If gtypOtherC||18357  |                                    'If gtypOtherC
18386  |                                    '    .Cells(in||18358  |                                    '    .Cells(in
18387  |                                    'Else         ||18359  |                                    'Else         
18388  |                                    '    .Cells(in||18360  |                                    '    .Cells(in
18389  |                                    'End If       ||18361  |                                    'End If       
18390  |                                    .Cells(intRang||18362  |                                    .Cells(intRang
18391  |                                    strRange = "J"||18363  |                                    strRange = "J"
18392  |                                    intRange = int||18364  |                                    intRange = int
18393  |                                ElseIf intRange <>||18365  |                                ElseIf intRange <>
18394  |                                    '余白有り     ||18366  |                                    '余白有り     
18395  |                                    J = J + 2     ||18367  |                                    J = J + 2     
18396  |                                    '日付         ||18368  |                                    '日付         
18397  |                                    .Cells(intRang||18369  |                                    .Cells(intRang
18398  |                                        sWord60 & ||18370  |                                        sWord60 & 
18399  |                                    J = J + 1     ||18371  |                                    J = J + 1     
18400  |                                    .Cells(intRang||18372  |                                    .Cells(intRang
18401  |                                    .Cells(intRang||18373  |                                    .Cells(intRang
18402  |                                    '平均純資産   ||18374  |                                    '平均純資産   
18403  |                                    dblValueIn = g||18375  |                                    dblValueIn = g
18404  |                                    If gtypOtherCo||18376  |                                    If gtypOtherCo
18405  |                                          Call sbG||18377  |                                          Call sbG
18406  |                                    Else          ||18378  |                                    Else          
18407  |                                          Call sbG||18379  |                                          Call sbG
18408  |                                    End If        ||18380  |                                    End If        
18409  |                                    If gtypOtherCo||18381  |                                    If gtypOtherCo
18410  |                                        .Cells(int||18382  |                                        .Cells(int
18411  |                                    Else          ||18383  |                                    Else          
18412  |                                        .Cells(int||18384  |                                        .Cells(int
18413  |                                    End If        ||18385  |                                    End If        
18414  |                                    'If gtypOtherC||18386  |                                    'If gtypOtherC
18415  |                                    '    .Cells(in||18387  |                                    '    .Cells(in
18416  |                                    'Else         ||18388  |                                    'Else         
18417  |                                    '    .Cells(in||18389  |                                    '    .Cells(in
18418  |                                    'End If       ||18390  |                                    'End If       
18419  |                                    .Cells(intRang||18391  |                                    .Cells(intRang
18420  |                                    strRange = "J"||18392  |                                    strRange = "J"
18421  |                                    intRange = int||18393  |                                    intRange = int
18422  |                                Else              ||18394  |                                Else              
18423  |                                    '余白無し     ||18395  |                                    '余白無し     
18424  |                                    '日付         ||18396  |                                    '日付         
18425  |                                    .Cells(11 + K,||18397  |                                    .Cells(11 + K,
18426  |                                        sWord60 & ||18398  |                                        sWord60 & 
18427  |                                    K = K + 1     ||18399  |                                    K = K + 1     
18428  |                                    .Cells(11 + K,||18400  |                                    .Cells(11 + K,
18429  |                                    .Cells(11 + K,||18401  |                                    .Cells(11 + K,
18430  |                                    '平均純資産   ||18402  |                                    '平均純資産   
18431  |                                    dblValueIn = g||18403  |                                    dblValueIn = g
18432  |                                    If gtypOtherCo||18404  |                                    If gtypOtherCo
18433  |                                          Call sbG||18405  |                                          Call sbG
18434  |                                    Else          ||18406  |                                    Else          
18435  |                                          Call sbG||18407  |                                          Call sbG
18436  |                                    End If        ||18408  |                                    End If        
18437  |                                    If gtypOtherCo||18409  |                                    If gtypOtherCo
18438  |                                        .Cells(11 ||18410  |                                        .Cells(11 
18439  |                                    Else          ||18411  |                                    Else          
18440  |                                        .Cells(11 ||18412  |                                        .Cells(11 
18441  |                                    End If        ||18413  |                                    End If        
18442  |                                    'If gtypOtherC||18414  |                                    'If gtypOtherC
18443  |                                    '    .Cells(11||18415  |                                    '    .Cells(11
18444  |                                    'Else         ||18416  |                                    'Else         
18445  |                                    '    .Cells(11||18417  |                                    '    .Cells(11
18446  |                                    'End If       ||18418  |                                    'End If       
18447  |                                    .Cells(11 + K,||18419  |                                    .Cells(11 + K,
18448  |                                    strRange = "K"||18420  |                                    strRange = "K"
18449  |                                    intRange = 11 ||18421  |                                    intRange = 11 
18450  |                                End If            ||18422  |                                End If            
18451  |                                J = 0             ||18423  |                                J = 0             
18452  |                                K = 0             ||18424  |                                K = 0             
18453  |                            'K                    ||18425  |                            'K                    
18454  |                            Else                  ||18426  |                            Else                  
18455  |                                If intRange = 11 T||18427  |                                If intRange = 11 T
18456  |                                    '余白無し     ||18428  |                                    '余白無し     
18457  |                                    '日付         ||18429  |                                    '日付         
18458  |                                    .Cells(intRang||18430  |                                    .Cells(intRang
18459  |                                        sWord60 & ||18431  |                                        sWord60 & 
18460  |                                    K = K + 1     ||18432  |                                    K = K + 1     
18461  |                                    .Cells(intRang||18433  |                                    .Cells(intRang
18462  |                                    .Cells(intRang||18434  |                                    .Cells(intRang
18463  |                                    '平均純資産   ||18435  |                                    '平均純資産   
18464  |                                    dblValueIn = g||18436  |                                    dblValueIn = g
18465  |                                    If gtypOtherCo||18437  |                                    If gtypOtherCo
18466  |                                          Call sbG||18438  |                                          Call sbG
18467  |                                    Else          ||18439  |                                    Else          
18468  |                                          Call sbG||18440  |                                          Call sbG
18469  |                                    End If        ||18441  |                                    End If        
18470  |                                    If gtypOtherCo||18442  |                                    If gtypOtherCo
18471  |                                        .Cells(int||18443  |                                        .Cells(int
18472  |                                    Else          ||18444  |                                    Else          
18473  |                                        .Cells(int||18445  |                                        .Cells(int
18474  |                                    End If        ||18446  |                                    End If        
18475  |                                    'If gtypOtherC||18447  |                                    'If gtypOtherC
18476  |                                    '    .Cells(in||18448  |                                    '    .Cells(in
18477  |                                    'Else         ||18449  |                                    'Else         
18478  |                                    '    .Cells(in||18450  |                                    '    .Cells(in
18479  |                                    'End If       ||18451  |                                    'End If       
18480  |                                    .Cells(intRang||18452  |                                    .Cells(intRang
18481  |                                    strRange = "K"||18453  |                                    strRange = "K"
18482  |                                    intRange = int||18454  |                                    intRange = int
18483  |                                ElseIf intRange <>||18455  |                                ElseIf intRange <>
18484  |                                    '余白有り     ||18456  |                                    '余白有り     
18485  |                                    K = K + 2     ||18457  |                                    K = K + 2     
18486  |                                    '日付         ||18458  |                                    '日付         
18487  |                                    .Cells(intRang||18459  |                                    .Cells(intRang
18488  |                                        sWord60 & ||18460  |                                        sWord60 & 
18489  |                                    K = K + 1     ||18461  |                                    K = K + 1     
18490  |                                    .Cells(intRang||18462  |                                    .Cells(intRang
18491  |                                    .Cells(intRang||18463  |                                    .Cells(intRang
18492  |                                    '平均純資産   ||18464  |                                    '平均純資産   
18493  |                                    dblValueIn = g||18465  |                                    dblValueIn = g
18494  |                                    If gtypOtherCo||18466  |                                    If gtypOtherCo
18495  |                                          Call sbG||18467  |                                          Call sbG
18496  |                                    Else          ||18468  |                                    Else          
18497  |                                          Call sbG||18469  |                                          Call sbG
18498  |                                    End If        ||18470  |                                    End If        
18499  |                                    If gtypOtherCo||18471  |                                    If gtypOtherCo
18500  |                                        .Cells(int||18472  |                                        .Cells(int
18501  |                                    Else          ||18473  |                                    Else          
18502  |                                        .Cells(int||18474  |                                        .Cells(int
18503  |                                    End If        ||18475  |                                    End If        
18504  |                                    'If gtypOtherC||18476  |                                    'If gtypOtherC
18505  |                                    '    .Cells(in||18477  |                                    '    .Cells(in
18506  |                                    'Else         ||18478  |                                    'Else         
18507  |                                    '    .Cells(in||18479  |                                    '    .Cells(in
18508  |                                    'End If       ||18480  |                                    'End If       
18509  |                                    .Cells(intRang||18481  |                                    .Cells(intRang
18510  |                                    strRange = "K"||18482  |                                    strRange = "K"
18511  |                                    intRange = int||18483  |                                    intRange = int
18512  |                                Else              ||18484  |                                Else              
18513  |                                    J = 0         ||18485  |                                    J = 0         
18514  |                                    K = 0         ||18486  |                                    K = 0         
18515  |                                    strRange = "J"||18487  |                                    strRange = "J"
18516  |                                    intRange = 11 ||18488  |                                    intRange = 11 
18517  |                                                  ||18489  |                                                  
18518  |                                    AddPoint = din||18490  |                                    AddPoint = din
18519  |                                    Exit For      ||18491  |                                    Exit For      
18520  |                                End If            ||18492  |                                End If            
18521  |                                J = 0             ||18493  |                                J = 0             
18522  |                                K = 0             ||18494  |                                K = 0             
18523  |                            End If                ||18495  |                            End If                
18524  |                        'ループ二回目以降         ||18496  |                        'ループ二回目以降         
18525  |                        Else                      ||18497  |                        Else                      
18526  |                            If strRange = "J" Then||18498  |                            If strRange = "J" Then
18527  |                                If intRange = 11 T||18499  |                                If intRange = 11 T
18528  |                                    '余白無し     ||18500  |                                    '余白無し     
18529  |                                    '日付         ||18501  |                                    '日付         
18530  |                                    .Cells(intRang||18502  |                                    .Cells(intRang
18531  |                                        sWord60 & ||18503  |                                        sWord60 & 
18532  |                                    J = J + 1     ||18504  |                                    J = J + 1     
18533  |                                    .Cells(intRang||18505  |                                    .Cells(intRang
18534  |                                    .Cells(intRang||18506  |                                    .Cells(intRang
18535  |                                    '平均純資産   ||18507  |                                    '平均純資産   
18536  |                                    dblValueIn = g||18508  |                                    dblValueIn = g
18537  |                                    If gtypOtherCo||18509  |                                    If gtypOtherCo
18538  |                                          Call sbG||18510  |                                          Call sbG
18539  |                                    Else          ||18511  |                                    Else          
18540  |                                          Call sbG||18512  |                                          Call sbG
18541  |                                    End If        ||18513  |                                    End If        
18542  |                                    If gtypOtherCo||18514  |                                    If gtypOtherCo
18543  |                                        .Cells(int||18515  |                                        .Cells(int
18544  |                                    Else          ||18516  |                                    Else          
18545  |                                        .Cells(int||18517  |                                        .Cells(int
18546  |                                    End If        ||18518  |                                    End If        
18547  |                                    'If gtypOtherC||18519  |                                    'If gtypOtherC
18548  |                                    '    .Cells(in||18520  |                                    '    .Cells(in
18549  |                                    'Else         ||18521  |                                    'Else         
18550  |                                    '    .Cells(in||18522  |                                    '    .Cells(in
18551  |                                    'End If       ||18523  |                                    'End If       
18552  |                                    .Cells(intRang||18524  |                                    .Cells(intRang
18553  |                                    strRange = "J"||18525  |                                    strRange = "J"
18554  |                                    intRange = int||18526  |                                    intRange = int
18555  |                                ElseIf intRange <>||18527  |                                ElseIf intRange <>
18556  |                                    '余白有り     ||18528  |                                    '余白有り     
18557  |                                    J = J + 1     ||18529  |                                    J = J + 1     
18558  |                                    '日付         ||18530  |                                    '日付         
18559  |                                    .Cells(intRang||18531  |                                    .Cells(intRang
18560  |                                        sWord60 & ||18532  |                                        sWord60 & 
18561  |                                    J = J + 1     ||18533  |                                    J = J + 1     
18562  |                                    .Cells(intRang||18534  |                                    .Cells(intRang
18563  |                                    .Cells(intRang||18535  |                                    .Cells(intRang
18564  |                                    '平均純資産   ||18536  |                                    '平均純資産   
18565  |                                    dblValueIn = g||18537  |                                    dblValueIn = g
18566  |                                    If gtypOtherCo||18538  |                                    If gtypOtherCo
18567  |                                          Call sbG||18539  |                                          Call sbG
18568  |                                    Else          ||18540  |                                    Else          
18569  |                                          Call sbG||18541  |                                          Call sbG
18570  |                                    End If        ||18542  |                                    End If        
18571  |                                    If gtypOtherCo||18543  |                                    If gtypOtherCo
18572  |                                        .Cells(int||18544  |                                        .Cells(int
18573  |                                    Else          ||18545  |                                    Else          
18574  |                                        .Cells(int||18546  |                                        .Cells(int
18575  |                                    End If        ||18547  |                                    End If        
18576  |                                    'If gtypOtherC||18548  |                                    'If gtypOtherC
18577  |                                    '    .Cells(in||18549  |                                    '    .Cells(in
18578  |                                    'Else         ||18550  |                                    'Else         
18579  |                                    '    .Cells(in||18551  |                                    '    .Cells(in
18580  |                                    'End If       ||18552  |                                    'End If       
18581  |                                    .Cells(intRang||18553  |                                    .Cells(intRang
18582  |                                    strRange = "J"||18554  |                                    strRange = "J"
18583  |                                    intRange = int||18555  |                                    intRange = int
18584  |                                Else              ||18556  |                                Else              
18585  |                                    '余白無し     ||18557  |                                    '余白無し     
18586  |                                    '日付         ||18558  |                                    '日付         
18587  |                                    .Cells(11 + K,||18559  |                                    .Cells(11 + K,
18588  |                                        sWord60 & ||18560  |                                        sWord60 & 
18589  |                                    K = K + 1     ||18561  |                                    K = K + 1     
18590  |                                    .Cells(11 + K,||18562  |                                    .Cells(11 + K,
18591  |                                    .Cells(11 + K,||18563  |                                    .Cells(11 + K,
18592  |                                    '平均純資産   ||18564  |                                    '平均純資産   
18593  |                                    dblValueIn = g||18565  |                                    dblValueIn = g
18594  |                                    If gtypOtherCo||18566  |                                    If gtypOtherCo
18595  |                                          Call sbG||18567  |                                          Call sbG
18596  |                                    Else          ||18568  |                                    Else          
18597  |                                          Call sbG||18569  |                                          Call sbG
18598  |                                    End If        ||18570  |                                    End If        
18599  |                                    If gtypOtherCo||18571  |                                    If gtypOtherCo
18600  |                                        .Cells(11 ||18572  |                                        .Cells(11 
18601  |                                    Else          ||18573  |                                    Else          
18602  |                                        .Cells(11 ||18574  |                                        .Cells(11 
18603  |                                    End If        ||18575  |                                    End If        
18604  |                                    'If gtypOtherC||18576  |                                    'If gtypOtherC
18605  |                                    '    .Cells(11||18577  |                                    '    .Cells(11
18606  |                                    'Else         ||18578  |                                    'Else         
18607  |                                    '    .Cells(11||18579  |                                    '    .Cells(11
18608  |                                    'End If       ||18580  |                                    'End If       
18609  |                                    .Cells(11 + K,||18581  |                                    .Cells(11 + K,
18610  |                                    strRange = "K"||18582  |                                    strRange = "K"
18611  |                                    intRange = 11 ||18583  |                                    intRange = 11 
18612  |                                End If            ||18584  |                                End If            
18613  |                                J = 0             ||18585  |                                J = 0             
18614  |                                K = 0             ||18586  |                                K = 0             
18615  |                            Else                  ||18587  |                            Else                  
18616  |                                If intRange = 11 T||18588  |                                If intRange = 11 T
18617  |                                    '余白無し     ||18589  |                                    '余白無し     
18618  |                                    '日付         ||18590  |                                    '日付         
18619  |                                    .Cells(11 + K,||18591  |                                    .Cells(11 + K,
18620  |                                        sWord60 & ||18592  |                                        sWord60 & 
18621  |                                    K = K + 1     ||18593  |                                    K = K + 1     
18622  |                                    .Cells(11 + K,||18594  |                                    .Cells(11 + K,
18623  |                                    .Cells(11 + K,||18595  |                                    .Cells(11 + K,
18624  |                                    '平均純資産   ||18596  |                                    '平均純資産   
18625  |                                    dblValueIn = g||18597  |                                    dblValueIn = g
18626  |                                    If gtypOtherCo||18598  |                                    If gtypOtherCo
18627  |                                          Call sbG||18599  |                                          Call sbG
18628  |                                    Else          ||18600  |                                    Else          
18629  |                                          Call sbG||18601  |                                          Call sbG
18630  |                                    End If        ||18602  |                                    End If        
18631  |                                    If gtypOtherCo||18603  |                                    If gtypOtherCo
18632  |                                        .Cells(11 ||18604  |                                        .Cells(11 
18633  |                                    Else          ||18605  |                                    Else          
18634  |                                        .Cells(11 ||18606  |                                        .Cells(11 
18635  |                                    End If        ||18607  |                                    End If        
18636  |                                    'If gtypOtherC||18608  |                                    'If gtypOtherC
18637  |                                    '    .Cells(11||18609  |                                    '    .Cells(11
18638  |                                    'Else         ||18610  |                                    'Else         
18639  |                                    '    .Cells(11||18611  |                                    '    .Cells(11
18640  |                                    'End If       ||18612  |                                    'End If       
18641  |                                    .Cells(11 + K,||18613  |                                    .Cells(11 + K,
18642  |                                    strRange = "K"||18614  |                                    strRange = "K"
18643  |                                    intRange = 11 ||18615  |                                    intRange = 11 
18644  |                                ElseIf intRange <>||18616  |                                ElseIf intRange <>
18645  |                                    '余白有り     ||18617  |                                    '余白有り     
18646  |                                    K = K + 1     ||18618  |                                    K = K + 1     
18647  |                                    '日付         ||18619  |                                    '日付         
18648  |                                    .Cells(intRang||18620  |                                    .Cells(intRang
18649  |                                        sWord60 & ||18621  |                                        sWord60 & 
18650  |                                    K = K + 1     ||18622  |                                    K = K + 1     
18651  |                                    .Cells(intRang||18623  |                                    .Cells(intRang
18652  |                                    .Cells(intRang||18624  |                                    .Cells(intRang
18653  |                                    '平均純資産   ||18625  |                                    '平均純資産   
18654  |                                    dblValueIn = g||18626  |                                    dblValueIn = g
18655  |                                    If gtypOtherCo||18627  |                                    If gtypOtherCo
18656  |                                          Call sbG||18628  |                                          Call sbG
18657  |                                    Else          ||18629  |                                    Else          
18658  |                                          Call sbG||18630  |                                          Call sbG
18659  |                                    End If        ||18631  |                                    End If        
18660  |                                    If gtypOtherCo||18632  |                                    If gtypOtherCo
18661  |                                        .Cells(int||18633  |                                        .Cells(int
18662  |                                    Else          ||18634  |                                    Else          
18663  |                                        .Cells(int||18635  |                                        .Cells(int
18664  |                                    End If        ||18636  |                                    End If        
18665  |                                    'If gtypOtherC||18637  |                                    'If gtypOtherC
18666  |                                    '    .Cells(in||18638  |                                    '    .Cells(in
18667  |                                    'Else         ||18639  |                                    'Else         
18668  |                                    '    .Cells(in||18640  |                                    '    .Cells(in
18669  |                                    'End If       ||18641  |                                    'End If       
18670  |                                    .Cells(intRang||18642  |                                    .Cells(intRang
18671  |                                    strRange = "K"||18643  |                                    strRange = "K"
18672  |                                    intRange = int||18644  |                                    intRange = int
18673  |                                Else              ||18645  |                                Else              
18674  |                                    J = 0         ||18646  |                                    J = 0         
18675  |                                    K = 0         ||18647  |                                    K = 0         
18676  |                                    strRange = "J"||18648  |                                    strRange = "J"
18677  |                                    intRange = 11 ||18649  |                                    intRange = 11 
18678  |                                    AddPoint = din||18650  |                                    AddPoint = din
18679  |                                    Exit For      ||18651  |                                    Exit For      
18680  |                                End If            ||18652  |                                End If            
18681  |                                J = 0             ||18653  |                                J = 0             
18682  |                                K = 0             ||18654  |                                K = 0             
18683  |                            End If                ||18655  |                            End If                
18684  |                        End If                    ||18656  |                        End If                    
18685  |                    Next dintFor                  ||18657  |                    Next dintFor                  
18686  |                End With                          ||18658  |                End With                          
18687  |            End If                                ||18659  |            End If                                
18688  |            'A4印刷用に上2行を削除して、プレビュー||18660  |            'A4印刷用に上2行を削除して、プレビュー
18689  |            xlSheet.Rows("1:2").Delete Shift:=xlUp||18661  |            xlSheet.Rows("1:2").Delete Shift:=xlUp
18690  |        Next L                                    ||18662  |        Next L                                    
18691  |    End If                                        ||18663  |    End If                                        
18692  |                                                  ||18664  |                                                  
18693  |                                                  ||18665  |                                                  
18694  |                                                  ||18666  |                                                  
18695  |                                                  ||18667  |                                                  
18696  |'2006/04/12 START K.Furuya 実払管理テーブル更新対 ||18668  |'2006/04/12 START K.Furuya 実払管理テーブル更新対 
18697  |    '実払管理テーブル更新処理実行                 ||18669  |    '実払管理テーブル更新処理実行                 
18698  |'2008/03/26 START ファンド決算期間での外部委託顧問||18670  |'2008/03/26 START ファンド決算期間での外部委託顧問
18699  |    'ファンド決算期間計算の場合実払いテーブル更新 ||18671  |    'ファンド決算期間計算の場合実払いテーブル更新 
18700  |    If gbuMGetUPDRec.N(lRecIdx).MGET_other_real_fl||18672  |    If gbuMGetUPDRec.N(lRecIdx).MGET_other_real_fl
18701  |        If fncOtherRealComUpdateInsert(WkContractN||18673  |        If fncOtherRealComUpdateInsert(WkContractN
18702  |                WkFixComC, WkFixComJ, WkRealComC, ||18674  |                WkFixComC, WkFixComJ, WkRealComC, 
18703  |            intRtn = MsgBox("契約番号：" & WkContr||18675  |            intRtn = MsgBox("契約番号：" & WkContr
18704  |                        "の確定額の更新に失敗しま ||18676  |                        "の確定額の更新に失敗しま 
18705  |        End If                                    ||18677  |        End If                                    
18706  |    End If                                        ||18678  |    End If                                        
18707  |'2008/03/26 END   ファンド決算期間での外部委託顧問||18679  |'2008/03/26 END   ファンド決算期間での外部委託顧問
18708  |'2006/04/12 END   K.Furuya 実払管理テーブル更新対 ||18680  |'2006/04/12 END   K.Furuya 実払管理テーブル更新対 
18709  |                                                  ||18681  |                                                  
18710  |'2014/02/19 START M.Takada 【管理会計】消費税率変 ||18682  |'2014/02/19 START M.Takada 【管理会計】消費税率変 
18711 L|  '消費税率変更がある場合、｢消費税額内訳書｣を出力 ||18683 R|  '消費税対応                                     
18712 L|  '消費税額の分割算出用フラグで出力判定を実施(Fals||       |                                                  
18713  |    If Tax_Flg = True Then                        ||18684  |    If Tax_Flg = True Then                        
18714  |                                                  ||18685  |                                                  
18715  |        '計算期間が消費税変更適用日を跨ぐ場合、消 ||18686  |        '計算期間が消費税変更適用日を跨ぐ場合、消 
18716  |        xlBook.Worksheets.Add after:=xlBook.Sheets||18687  |        xlBook.Worksheets.Add after:=xlBook.Sheets
18717 L|        gProcessCnt = gProcessCnt + 1             ||18688 R|        'Excelフォーマットを調整                  
18718 L|        Set xlSheet = xlBook.Sheets(gProcessCnt)  ||18689 R|        ActiveSheet.Cells.ColumnWidth = 1         
18719 L|                                                  ||18690 R|        ActiveSheet.Cells.Font.Size = 11          
18720 L|        'シート名を設定(内訳書**)                 ||18691 R|                                                  
18721 L|        '契約毎のシート番号を付番する             ||18692 R|    With xlSheet                                  
18722 L|        xlBook.Sheets(gProcessCnt).Name = sWord72 ||18693 R|        '作成日                                   
       |                                                  ||18694 R|        If RTrim(txtSysOutDate.Text) = "" Then    
       |                                                  ||18695 R|            .Cells(3, 50).Value = sWord34         
       |                                                  ||18696 R|            .Cells(3, 50).HorizontalAlignment = xl
       |                                                  ||18697 R|        Else                                      
       |                                                  ||18698 R|            .Cells(3, 43).Value = CStr(Format(txtS
       |                                                  ||18699 R|        End If                                    
       |                                                  ||18700 R|        'タイトル                                 
       |                                                  ||18701 R|        .Cells(5, 1).Value = sWord0d              
       |                                                  ||18702 R|        .Range("A5:BG5").HorizontalAlignment = xlC
       |                                                  ||18703 R|        '財務部　担当者                           
       |                                                  ||18704 R|        sName = RTrim(txtInputName.Text)          
       |                                                  ||18705 R|        '財務部                                   
       |                                                  ||18706 R|        .Cells(7, 37).Value = sWord1              
       |                                                  ||18707 R|        .Cells(8, 39).Value = sWord2 & sName      
       |                                                  ||18708 R|                                                  
       |                                                  ||18709 R|        '下記のとおり･･･ ,文言                    
       |                                                  ||18710 R|        .Cells(10, 2).Value = sWordComment        
       |                                                  ||18711 R|                                                  
       |                                                  ||18712 R|        'ファンド名: ,文言                        
       |                                                  ||18713 R|        .Cells(12, 2).Value = sWord4              
       |                                                  ||18714 R|        .Cells(12, 11).Value = sWord19            
       |                                                  ||18715 R|        .Cells(12, 13).Value = gbuMGetUPDRec.N(lRe
       |                                                  ||18716 R|                                                  
       |                                                  ||18717 R|        'ファンドコード: ,文言                    
       |                                                  ||18718 R|        .Cells(13, 2).Value = sWord4_2            
       |                                                  ||18719 R|        .Cells(13, 11).Value = sWord19            
       |                                                  ||18720 R|        If msAssetFlg = "0" Then                  
       |                                                  ||18721 R|            .Cells(13, 13).Value = sGetAccCode    
       |                                                  ||18722 R|        'マザー組入資産の場合                     
       |                                                  ||18723 R|        Else                                      
       |                                                  ||18724 R|            .Cells(13, 13).Value = msBabyAccountCo
       |                                                  ||18725 R|        End If                                    
       |                                                  ||18726 R|                                                  
       |                                                  ||18727 R|        '計算期間: ,文言                          
       |                                                  ||18728 R|        .Cells(15, 2).Value = sWord5              
       |                                                  ||18729 R|        .Cells(15, 11).Value = sWord19            
       |                                                  ||18730 R|        .Cells(15, 13).Value = _                  
       |                                                  ||18731 R|        CStr(Format(dStart, "YYYY年M月D日")) & sWo
       |                                                  ||18732 R|                                                  
       |                                                  ||18733 R|        '投資顧問料                               
       |                                                  ||18734 R|        .Cells(17, 2).Value = sWord11a            
       |                                                  ||18735 R|        .Cells(17, 11).Value = sWord19            
       |                                                  ||18736 R|        .Cells(17, 29).NumberFormatLocal = "@"    
       |                                                  ||18737 R|        .Cells(17, 29).Value = CStr(Format(mstrMon
       |                                                  ||18738 R|        .Cells(17, 29).HorizontalAlignment = xlRig
       |                                                  ||18739 R|        .Cells(17, 32).Value = sYen               
       |                                                  ||18740 R|                                                  
       |                                                  ||18741 R|                                                  
       |                                                  ||18742 R|        '(適用前)消費税率                         
       |                                                  ||18743 R|        .Cells(21, 2).Value = sWord66             
       |                                                  ||18744 R|        .Cells(21, 11).Value = sWord19            
       |                                                  ||18745 R|        .Cells(21, 13).Value = strTaxRate(2) & sWo
       |                                                  ||18746 R|                                                  
       |                                                  ||18747 R|        '(適用前)税率適用期間                     
       |                                                  ||18748 R|        .Cells(22, 2).Value = sWord67             
       |                                                  ||18749 R|        .Cells(22, 11).Value = sWord19            
       |                                                  ||18750 R|        .Cells(22, 13).Value = _                  
       |                                                  ||18751 R|        CStr(Format(dStart, "YYYY年M月D日")) & sWo
       |                                                  ||18752 R|                                                  
       |                                                  ||18753 R|        '(適用前)支払額                           
       |                                                  ||18754 R|        .Cells(23, 2).Value = sWord68             
       |                                                  ||18755 R|        .Cells(23, 11).Value = sWord19            
       |                                                  ||18756 R|        .Cells(23, 29).NumberFormatLocal = "@"    
       |                                                  ||18757 R|        .Cells(23, 29).Value = CStr(Format(strPayN
       |                                                  ||18758 R|        .Cells(23, 29).HorizontalAlignment = xlRig
       |                                                  ||18759 R|        .Cells(23, 32).Value = sYen               
       |                                                  ||18760 R|                                                  
       |                                                  ||18761 R|        '(適用前)消費税額                         
       |                                                  ||18762 R|        .Cells(24, 2).Value = sWord69             
       |                                                  ||18763 R|        .Cells(24, 11).Value = sWord19            
       |                                                  ||18764 R|        .Cells(24, 29).NumberFormatLocal = "@"    
       |                                                  ||18765 R|        .Cells(24, 29).Value = CStr(Format(strTaxN
       |                                                  ||18766 R|        .Cells(24, 29).HorizontalAlignment = xlRig
       |                                                  ||18767 R|        .Cells(24, 32).Value = sYen               
       |                                                  ||18768 R|                                                  
       |                                                  ||18769 R|                                                  
       |                                                  ||18770 R|        '(適用後)消費税率                         
       |                                                  ||18771 R|        .Cells(28, 2).Value = sWord66             
       |                                                  ||18772 R|        .Cells(28, 11).Value = sWord19            
       |                                                  ||18773 R|        .Cells(28, 13).Value = strTaxRate(1) & sWo
       |                                                  ||18774 R|                                                  
       |                                                  ||18775 R|        '(適用後)税率適用期間                     
       |                                                  ||18776 R|        .Cells(29, 2).Value = sWord67             
       |                                                  ||18777 R|        .Cells(29, 11).Value = sWord19            
       |                                                  ||18778 R|        .Cells(29, 13).Value = _                  
       |                                                  ||18779 R|        CStr(Format(strUse_Date, "YYYY年M月D日")) 
       |                                                  ||18780 R|                                                  
       |                                                  ||18781 R|        '(適用後)支払額                           
       |                                                  ||18782 R|        .Cells(30, 2).Value = sWord68             
       |                                                  ||18783 R|        .Cells(30, 11).Value = sWord19            
       |                                                  ||18784 R|        .Cells(30, 29).NumberFormatLocal = "@"    
       |                                                  ||18785 R|        .Cells(30, 29).Value = CStr(Format(strPayN
       |                                                  ||18786 R|        .Cells(30, 29).HorizontalAlignment = xlRig
       |                                                  ||18787 R|        .Cells(30, 32).Value = sYen               
       |                                                  ||18788 R|                                                  
       |                                                  ||18789 R|        '(適用後)消費税額                         
       |                                                  ||18790 R|        .Cells(31, 2).Value = sWord69             
       |                                                  ||18791 R|        .Cells(31, 11).Value = sWord19            
       |                                                  ||18792 R|        .Cells(31, 29).NumberFormatLocal = "@"    
       |                                                  ||18793 R|        .Cells(31, 29).Value = CStr(Format(strTaxN
       |                                                  ||18794 R|        .Cells(31, 29).HorizontalAlignment = xlRig
       |                                                  ||18795 R|        .Cells(31, 32).Value = sYen               
18736 M|                                                  ||18796 R|                                                  
18723  |                                                  ||18797  |                                                  
18724 L|        'Excelフォーマットを調整                  ||       |                                                  
18725 L|        xlSheet.Cells.ColumnWidth = 1             ||       |                                                  
18726 L|        xlSheet.Cells.Font.Size = 11              ||       |                                                  
18727 L|        xlSheet.PageSetup.TopMargin = Application.||       |                                                  
18728 L|        xlSheet.PageSetup.BottomMargin = Applicati||       |                                                  
18729 L|        xlSheet.PageSetup.LeftMargin = Application||       |                                                  
18730 L|        xlSheet.PageSetup.RightMargin = Applicatio||       |                                                  
18731 L|                                                  ||       |                                                  
18732 L|'        '総計の出力処理カウンターアップ          ||       |                                                  
18733 L|'        gTotalProcessCnt = gTotalProcessCnt + 1  ||       |                                                  
18734 L|                                                  ||       |                                                  
18735 L|'        DoEvents                                 ||       |                                                  
18736 L|                                                  ||18796 M|                                                  
18737 L|        With xlSheet                              ||18798 R|        '合計                                     
18738 L|            '作成日                               ||18799 R|        .Cells(35, 2).Value = sWord70             
18739 L|            If RTrim(txtSysOutDate.Text) = "" Then||18800 R|                                                  
18740 L|                .Cells(3, 50).Value = sWord34     ||18801 R|        '支払額                                   
18741 L|                .Cells(3, 50).HorizontalAlignment ||18802 R|        .Cells(36, 2).Value = sWord68             
18742 L|            Else                                  ||18803 R|        .Cells(36, 11).Value = sWord19            
18743 L|                .Cells(3, 43).Value = CStr(Format(||18804 R|        .Cells(36, 29).NumberFormatLocal = "@"    
18744 L|            End If                                ||18805 R|        .Cells(36, 29).Value = CStr(Format(.Cells(
18745 L|            'タイトル                             ||18806 R|        .Cells(36, 29).HorizontalAlignment = xlRig
18746 L|            .Cells(5, 1).Value = sWordTitle       ||18807 R|        .Cells(36, 32).Value = sYen               
18747 L|            .Range("A5:BG5").HorizontalAlignment =||18808 R|                                                  
18748 L|            '財務部　担当者                       ||18809 R|        '消費税額                                 
18749 L|            sName = RTrim(txtInputName.Text)      ||18810 R|        .Cells(37, 2).Value = sWord69             
18750 L|            '財務部                               ||18811 R|        .Cells(37, 11).Value = sWord19            
18751 L|            .Cells(7, 37).Value = sWord1          ||18812 R|        .Cells(37, 29).NumberFormatLocal = "@"    
18752 L|            .Cells(8, 39).Value = sWord2 & sName  ||18813 R|        .Cells(37, 29).Value = CStr(Format(.Cells(
18753 L|                                                  ||18814 R|        .Cells(37, 29).HorizontalAlignment = xlRig
18754 L|            '下記のとおり･･･ ,文言                ||18815 R|        .Cells(37, 32).Value = sYen               
18755 L|            .Cells(10, 2).Value = sWordComment    ||18816 R|                                                  
18756 L|                                                  ||18817 R|        '合計額                                   
18757 L|            'ファンド名: ,文言                    ||18818 R|        .Cells(37, 13).Value = sWord24            
18758 L|            .Cells(12, 2).Value = sWord4          ||18819 R|        .Cells(37, 29).NumberFormatLocal = "@"    
18759 L|            .Cells(12, 11).Value = sWord19        ||18820 R|        .Cells(37, 29).Value = CStr(Format(.Cells(
18760 L|            .Cells(12, 13).Value = gbuMGetUPDRec.N||18821 R|        .Cells(37, 29).HorizontalAlignment = xlRig
18761 L|                                                  ||18822 R|        .Cells(37, 32).Value = sYen               
18762 L|            'ファンドコード: ,文言                ||18823 R|                                                  
18763 L|            .Cells(13, 2).Value = sWord4_2        ||18824 R|                                                  
18764 L|            .Cells(13, 11).Value = sWord19        ||       |                                                  
18765 L|            .Cells(13, 13).NumberFormatLocal = "@"||       |                                                  
18766 L|            If msAssetFlg = "0" Then              ||       |                                                  
18767 L|                .Cells(13, 13).Value = sGetAccCode||       |                                                  
18768 L|            'マザー組入資産の場合                 ||       |                                                  
18769 L|            Else                                  ||       |                                                  
18770 L|                .Cells(13, 13).Value = msBabyAccou||       |                                                  
18771 L|            End If                                ||       |                                                  
18772 L|                                                  ||       |                                                  
18773 L|            '計算期間: ,文言                      ||       |                                                  
18774 L|            .Cells(15, 2).Value = sWord5          ||       |                                                  
18775 L|            .Cells(15, 11).Value = sWord19        ||       |                                                  
18776 L|            .Cells(15, 13).Value = _              ||       |                                                  
18777 L|            CStr(Format(dStart, "YYYY年M月D日")) &||       |                                                  
18778 L|                                                  ||       |                                                  
18779 L|            '投資顧問料                           ||       |                                                  
18780 L|            .Cells(17, 2).Value = sWord11a        ||       |                                                  
18781 L|            .Cells(17, 11).Value = sWord19        ||       |                                                  
18782 L|            .Cells(17, 29).NumberFormatLocal = "@"||       |                                                  
18783 L|            .Cells(17, 29).Value = CStr(Format(mst||       |                                                  
18784 L|            .Cells(17, 29).HorizontalAlignment = x||       |                                                  
18785 L|            .Cells(17, 32).Value = sYen           ||       |                                                  
18786 L|                                                  ||       |                                                  
18787 L|                                                  ||       |                                                  
18788 L|            '(適用前)消費税率                     ||       |                                                  
18789 L|            .Cells(21, 2).Value = sWord66         ||       |                                                  
18790 L|            .Cells(21, 11).Value = sWord19        ||       |                                                  
18791 L|            .Cells(21, 13).Value = strTaxRate(2) &||       |                                                  
18792 L|                                                  ||       |                                                  
18793 L|            '(適用前)税率適用期間                 ||       |                                                  
18794 L|            .Cells(22, 2).Value = sWord67         ||       |                                                  
18795 L|            .Cells(22, 11).Value = sWord19        ||       |                                                  
18796 L|            .Cells(22, 13).Value = _              ||       |                                                  
18797 L|            CStr(Format(dStart, "YYYY年M月D日")) &||       |                                                  
18798 L|                                                  ||       |                                                  
18799 L|            '(適用前)支払額                       ||       |                                                  
18800 L|            .Cells(23, 2).Value = sWord68         ||       |                                                  
18801 L|            .Cells(23, 11).Value = sWord19        ||       |                                                  
18802 L|            .Cells(23, 29).NumberFormatLocal = "@"||       |                                                  
18803 L|            .Cells(23, 29).Value = CStr(Format(str||       |                                                  
18804 L|            .Cells(23, 29).HorizontalAlignment = x||       |                                                  
18805 L|            .Cells(23, 32).Value = sYen           ||       |                                                  
18806 L|                                                  ||       |                                                  
18807 L|            '(適用前)消費税額                     ||       |                                                  
18808 L|            .Cells(24, 2).Value = sWord69         ||       |                                                  
18809 L|            .Cells(24, 11).Value = sWord19        ||       |                                                  
18810 L|            .Cells(24, 29).NumberFormatLocal = "@"||       |                                                  
18811 L|            .Cells(24, 29).Value = CStr(Format(str||       |                                                  
18812 L|            .Cells(24, 29).HorizontalAlignment = x||       |                                                  
18813 L|            .Cells(24, 32).Value = sYen           ||       |                                                  
18814 L|                                                  ||       |                                                  
18815 L|                                                  ||       |                                                  
18816 L|            '(適用後)消費税率                     ||       |                                                  
18817 L|            .Cells(28, 2).Value = sWord66         ||       |                                                  
18818 L|            .Cells(28, 11).Value = sWord19        ||       |                                                  
18819 L|            .Cells(28, 13).Value = strTaxRate(1) &||       |                                                  
18820 L|                                                  ||       |                                                  
18821 L|            '(適用後)税率適用期間                 ||       |                                                  
18822 L|            .Cells(29, 2).Value = sWord67         ||       |                                                  
18823 L|            .Cells(29, 11).Value = sWord19        ||       |                                                  
18824 L|            .Cells(29, 13).Value = _              ||       |                                                  
18825 L|            CStr(Format(strUse_Date, "YYYY年M月D日||       |                                                  
18826 L|                                                  ||       |                                                  
18827 L|            '(適用後)支払額                       ||       |                                                  
18828 L|            .Cells(30, 2).Value = sWord68         ||       |                                                  
18829 L|            .Cells(30, 11).Value = sWord19        ||       |                                                  
18830 L|            .Cells(30, 29).NumberFormatLocal = "@"||       |                                                  
18831 L|            .Cells(30, 29).Value = CStr(Format(str||       |                                                  
18832 L|            .Cells(30, 29).HorizontalAlignment = x||       |                                                  
18833 L|            .Cells(30, 32).Value = sYen           ||       |                                                  
18834 L|                                                  ||       |                                                  
18835 L|            '(適用後)消費税額                     ||       |                                                  
18836 L|            .Cells(31, 2).Value = sWord69         ||       |                                                  
18837 L|            .Cells(31, 11).Value = sWord19        ||       |                                                  
18838 L|            .Cells(31, 29).NumberFormatLocal = "@"||       |                                                  
18839 L|            .Cells(31, 29).Value = CStr(Format(str||       |                                                  
18840 L|            .Cells(31, 29).HorizontalAlignment = x||       |                                                  
18841 L|            .Cells(31, 32).Value = sYen           ||       |                                                  
18842 L|                                                  ||       |                                                  
18843 L|                                                  ||       |                                                  
18844 L|            '合計                                 ||       |                                                  
18845 L|            .Cells(35, 2).Value = sWord70         ||       |                                                  
18846 L|                                                  ||       |                                                  
18847 L|            '支払額                               ||       |                                                  
18848 L|            .Cells(36, 2).Value = sWord68         ||       |                                                  
18849 L|            .Cells(36, 11).Value = sWord19        ||       |                                                  
18850 L|            .Cells(36, 29).NumberFormatLocal = "@"||       |                                                  
18851 L|            .Cells(36, 29).Value = CStr(Format(CCu||       |                                                  
18852 L|            .Cells(36, 29).HorizontalAlignment = x||       |                                                  
18853 L|            .Cells(36, 32).Value = sYen           ||       |                                                  
18854 L|                                                  ||       |                                                  
18855 L|            '消費税額                             ||       |                                                  
18856 L|            .Cells(37, 2).Value = sWord69         ||       |                                                  
18857 L|            .Cells(37, 11).Value = sWord19        ||       |                                                  
18858 L|            .Cells(37, 29).NumberFormatLocal = "@"||       |                                                  
18859 L|            .Cells(37, 29).Value = CStr(Format(CCu||       |                                                  
18860 L|            .Cells(37, 29).HorizontalAlignment = x||       |                                                  
18861 L|            .Cells(37, 32).Value = sYen           ||       |                                                  
18862 L|                                                  ||       |                                                  
18863 L|            '合計額                               ||       |                                                  
18864 L|            .Cells(37, 13).Value = sWord24        ||       |                                                  
18865 L|            .Cells(37, 29).NumberFormatLocal = "@"||       |                                                  
18866 L|            .Cells(37, 29).Value = CStr(Format(CCu||       |                                                  
18867 L|            .Cells(37, 29).HorizontalAlignment = x||       |                                                  
18868 L|            .Cells(37, 32).Value = sYen           ||       |                                                  
18869 L|        End With                                  ||       |                                                  
18870  |    Else                                          ||18825  |    Else                                          
18871  |        '跨がない場合｢消費税額内訳書｣は出力しない ||18826  |        '跨がない場合｢消費税額内訳書｣は出力しない 
18872  |    End If                                        ||18827  |    End If                                        
18873  |'2014/02/19 END   M.Takada 【管理会計】消費税率変 ||18828  |'2014/02/19 END   M.Takada 【管理会計】消費税率変 
18874  |    '正常戻り値セット                             ||18829  |    '正常戻り値セット                             
18875  |    fnblExcelOut_ChangeRate = True                ||18830  |    fnblExcelOut_ChangeRate = True                
18876  |                                                  ||18831  |                                                  
18877  |                                                  ||18832  |                                                  
18878  |    GoTo EndProc                                  ||18833  |    GoTo EndProc                                  
18879  |                                                  ||18834  |                                                  
18880  |ErrorTrap:                                        ||18835  |ErrorTrap:                                        
18881  |    ' Excel を起動できない場合に発生するエラーをト||18836  |    ' Excel を起動できない場合に発生するエラーをト
18882  |    Select Case Err.Number                        ||18837  |    Select Case Err.Number                        
18883  |        Case 440               ' オートメーション ||18838  |        Case 440               ' オートメーション 
18884  |            iTries = iTries + 1                   ||18839  |            iTries = iTries + 1                   
18885  |            ' Excel の再起動を 5 回まで行います。 ||18840  |            ' Excel の再起動を 5 回まで行います。 
18886  |            If iTries < 5 Then                    ||18841  |            If iTries < 5 Then                    
18887  |               Set xlApp = New Excel.Application  ||18842  |               Set xlApp = New Excel.Application  
18888  |               Resume                             ||18843  |               Resume                             
18889  |            Else                                  ||18844  |            Else                                  
18890  |               Err.Raise Number:=vbObjectError + 2||18845  |               Err.Raise Number:=vbObjectError + 2
18891  |               Description:="Microsoft Excel を起 ||18846  |               Description:="Microsoft Excel を起 
18892  |            End If                                ||18847  |            End If                                
18893  |        Case Else                                 ||18848  |        Case Else                                 
18894  |    End Select                                    ||18849  |    End Select                                    
18895  |                                                  ||18850  |                                                  
18896  |    'Workbookを閉じる                             ||18851  |    'Workbookを閉じる                             
18897  |    xlBook.Close                                  ||18852  |    xlBook.Close                                  
18898  |                                                  ||18853  |                                                  
18899  |    'Excel終了                                    ||18854  |    'Excel終了                                    
18900  |    xlApp.Quit                                    ||18855  |    xlApp.Quit                                    
18901  |                                                  ||18856  |                                                  
18902  |    'オブジェクトの解放                           ||18857  |    'オブジェクトの解放                           
18903  |    Set xlApp = Nothing                           ||18858  |    Set xlApp = Nothing                           
18904  |    Set xlBook = Nothing                          ||18859  |    Set xlBook = Nothing                          
18905  |    Set xlSheet = Nothing                         ||18860  |    Set xlSheet = Nothing                         
18906  |                                                  ||18861  |                                                  
18907  |OnErrorProc:                                      ||18862  |OnErrorProc:                                      
18908  |    Call subError("システムエラー", Str(Err.Number||18863  |    Call subError("システムエラー", Str(Err.Number
18909  |        Error, strErrCall, conTitle)              ||18864  |        Error, strErrCall, conTitle)              
18910  |    'マウスポインター元に戻す                     ||18865  |    'マウスポインター元に戻す                     
18911  |    Screen.MousePointer = vbDefault               ||18866  |    Screen.MousePointer = vbDefault               
18912  |    GoTo EndProc                                  ||18867  |    GoTo EndProc                                  
18913  |                                                  ||18868  |                                                  
18914  |EndProc:                                          ||18869  |EndProc:                                          
18915  |                                                  ||18870  |                                                  
18916  |                                                  ||18871  |                                                  
18917  |                                                  ||18872  |                                                  
18918  |End Function                                      ||18873  |End Function                                      
18919  |                                                  ||18874  |                                                  
18920  |'=================================================||18875  |'=================================================
18921  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMonthlyNAV_GetNotChgRate   ||18876  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMonthlyNAV_GetNotChgRate   
18922  |'機能            :   月次NAV取得(料率変更無し)    ||18877  |'機能            :   月次NAV取得(料率変更無し)    
18923  |'                                                 ||18878  |'                                                 
18924  |'                                                 ||18879  |'                                                 
18925  |'日付               担当　              修正内容  ||18880  |'日付               担当　              修正内容  
18926  |'-------------------------------------------------||18881  |'-------------------------------------------------
18927  |'2006/08/02         K.Furuya<SRA>      新規作成 期||18882  |'2006/08/02         K.Furuya<SRA>      新規作成 期
18928  |'=================================================||18883  |'=================================================
18929  |Private Sub sbMonthlyNAV_GetNotChgRate(ByVal Idx A||18884  |Private Sub sbMonthlyNAV_GetNotChgRate(ByVal Idx A
18930  |    Dim sZenkai             As String   '前回締日 ||18885  |    Dim sZenkai             As String   '前回締日 
18931  |    Dim sNearMonth          As String   '直近締日 ||18886  |    Dim sNearMonth          As String   '直近締日 
18932  |    Dim ddblNav             As Double             ||18887  |    Dim ddblNav             As Double             
18933  |    Dim ddblCnt             As Double             ||18888  |    Dim ddblCnt             As Double             
18934  |    Dim ddblNavTotal        As Double             ||18889  |    Dim ddblNavTotal        As Double             
18935  |    Dim ddblBabyMotherRate  As Double   'ベビー/マ||18890  |    Dim ddblBabyMotherRate  As Double   'ベビー/マ
18936  |    Dim dstrMonthOld        As String             ||18891  |    Dim dstrMonthOld        As String             
18937  |    Dim dstrMonthNew        As String             ||18892  |    Dim dstrMonthNew        As String             
18938  |    Dim sSql                As String             ||18893  |    Dim sSql                As String             
18939  |    Dim MonthlyCnt          As Integer            ||18894  |    Dim MonthlyCnt          As Integer            
18940  |    Dim i                   As Integer            ||18895  |    Dim i                   As Integer            
18941  |                                                  ||18896  |                                                  
18942  |    sNearMonth = ""                               ||18897  |    sNearMonth = ""                               
18943  |    sZenkai = ""                                  ||18898  |    sZenkai = ""                                  
18944  |    MonthlyCnt = 0                                ||18899  |    MonthlyCnt = 0                                
18945  |                                                  ||18900  |                                                  
18946  |                                                  ||18901  |                                                  
18947  |    '月次NAVを取得(資産種別により分岐)            ||18902  |    '月次NAVを取得(資産種別により分岐)            
18948  |    Select Case msAssetFlg                        ||18903  |    Select Case msAssetFlg                        
18949  |        '純資産                                   ||18904  |        '純資産                                   
18950  |        Case "0"                                  ||18905  |        Case "0"                                  
18951  |            'SQL文の作成(日次NAV取得)             ||18906  |            'SQL文の作成(日次NAV取得)             
18952  |            msContNo = gbuMGetUPDRec.N(Idx).MGET_c||18907  |            msContNo = gbuMGetUPDRec.N(Idx).MGET_c
18953  |            '日次NAVは当年度のNAVを取得する       ||18908  |            '日次NAVは当年度のNAVを取得する       
18954  |            sSql = gstrEditSQLcfr_DailyNavForSelec||18909  |            sSql = gstrEditSQLcfr_DailyNavForSelec
18955  |                msContNo, mstrNearSettleDate)     ||18910  |                msContNo, mstrNearSettleDate)     
18956  |                                                  ||18911  |                                                  
18957  |            'ﾀﾞｲﾅｾｯﾄの作成                        ||18912  |            'ﾀﾞｲﾅｾｯﾄの作成                        
18958  |            If gintDyCreate(sSql) = False Then    ||18913  |            If gintDyCreate(sSql) = False Then    
18959  |                Exit Sub                          ||18914  |                Exit Sub                          
18960  |            End If                                ||18915  |            End If                                
18961  |                                                  ||18916  |                                                  
18962  |            mstrDailyNav = 0                      ||18917  |            mstrDailyNav = 0                      
18963  |            ddblNav = 0                           ||18918  |            ddblNav = 0                           
18964  |            ddblCnt = 0                           ||18919  |            ddblCnt = 0                           
18965  |            'EOF判定処理                          ||18920  |            'EOF判定処理                          
18966  |            Do Until gblnDyEOF()                  ||18921  |            Do Until gblnDyEOF()                  
18967  |                ddblNav = gvlnDyDataN("NET_ASSET_V||18922  |                ddblNav = gvlnDyDataN("NET_ASSET_V
18968  |                ddblCnt = gvlnDyDataN("NAV_CNT")  ||18923  |                ddblCnt = gvlnDyDataN("NAV_CNT")  
18969  |                If ddblCnt > 0 Then               ||18924  |                If ddblCnt > 0 Then               
18970  |                    mstrDailyNav = mstrDailyNav + ||18925  |                    mstrDailyNav = mstrDailyNav + 
18971  |                Else                              ||18926  |                Else                              
18972  |                    mstrDailyNav = mstrDailyNav + ||18927  |                    mstrDailyNav = mstrDailyNav + 
18973  |                End If                            ||18928  |                End If                            
18974  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 ||18929  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 
18975  |                Call gDyNext                      ||18930  |                Call gDyNext                      
18976  |            Loop                                  ||18931  |            Loop                                  
18977  |                                                  ||18932  |                                                  
18978  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||18933  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
18979  |            Call gblnDyClose                      ||18934  |            Call gblnDyClose                      
18980  |                                                  ||18935  |                                                  
18981  |            'SQL文の作成(月次NAV取得)             ||18936  |            'SQL文の作成(月次NAV取得)             
18982  |            '配列初期化                           ||18937  |            '配列初期化                           
18983  |            ReDim gtypcfr_mnav_tbl(0)             ||18938  |            ReDim gtypcfr_mnav_tbl(0)             
18984  |                                                  ||18939  |                                                  
18985  |            sZenkai = Mid(mstrSettlementDate, 1, 6||18940  |            sZenkai = Mid(mstrSettlementDate, 1, 6
18986  |                                                  ||18941  |                                                  
18987  |            '直近締日の月の前月をセット           ||18942  |            '直近締日の月の前月をセット           
18988  |            sNearMonth = DateAdd("m", -1, gstrDate||18943  |            sNearMonth = DateAdd("m", -1, gstrDate
18989  |            sNearMonth = Mid(gstrDateFormat2(sNear||18944  |            sNearMonth = Mid(gstrDateFormat2(sNear
18990  |                                                  ||18945  |                                                  
18991  |            sSql = gstrEditSQLcfr_MonthlyNavForSel||18946  |            sSql = gstrEditSQLcfr_MonthlyNavForSel
18992  |                msContNo, sNearMonth, sZenkai)    ||18947  |                msContNo, sNearMonth, sZenkai)    
18993  |                                                  ||18948  |                                                  
18994  |            'ﾀﾞｲﾅｾｯﾄの作成                        ||18949  |            'ﾀﾞｲﾅｾｯﾄの作成                        
18995  |            If gintDyCreate(sSql) = False Then    ||18950  |            If gintDyCreate(sSql) = False Then    
18996  |                Exit Sub                          ||18951  |                Exit Sub                          
18997  |            End If                                ||18952  |            End If                                
18998  |                                                  ||18953  |                                                  
18999  |            dstrMonthOld = ""                     ||18954  |            dstrMonthOld = ""                     
19000  |            dstrMonthNew = ""                     ||18955  |            dstrMonthNew = ""                     
19001  |            ddblNav = 0                           ||18956  |            ddblNav = 0                           
19002  |            ddblCnt = 0                           ||18957  |            ddblCnt = 0                           
19003  |            ddblNavTotal = 0                      ||18958  |            ddblNavTotal = 0                      
19004  |            i = 0                                 ||18959  |            i = 0                                 
19005  |                                                  ||18960  |                                                  
19006  |            Do Until gblnDyEOF()                  ||18961  |            Do Until gblnDyEOF()                  
19007  |                '対象月次NAV抽出                  ||18962  |                '対象月次NAV抽出                  
19008  |                dstrMonthNew = gvlnDyDataS("base_m||18963  |                dstrMonthNew = gvlnDyDataS("base_m
19009  |                If dstrMonthNew <> dstrMonthOld Th||18964  |                If dstrMonthNew <> dstrMonthOld Th
19010  |                    If i = 0 Then                 ||18965  |                    If i = 0 Then                 
19011  |                        '動的配列更新             ||18966  |                        '動的配列更新             
19012  |                        ReDim Preserve gtypcfr_mna||18967  |                        ReDim Preserve gtypcfr_mna
19013  |                        i = 1                     ||18968  |                        i = 1                     
19014  |                    Else                          ||18969  |                    Else                          
19015  |                        MonthlyCnt = MonthlyCnt + ||18970  |                        MonthlyCnt = MonthlyCnt + 
19016  |                        ReDim Preserve gtypcfr_mna||18971  |                        ReDim Preserve gtypcfr_mna
19017  |                        ddblNav = 0               ||18972  |                        ddblNav = 0               
19018  |                        ddblCnt = 0               ||18973  |                        ddblCnt = 0               
19019  |                        ddblNavTotal = 0          ||18974  |                        ddblNavTotal = 0          
19020  |                    End If                        ||18975  |                    End If                        
19021  |                End If                            ||18976  |                End If                            
19022  |                ddblNav = gvlnDyDataN("NET_ASSET_V||18977  |                ddblNav = gvlnDyDataN("NET_ASSET_V
19023  |                ddblCnt = gvlnDyDataN("NAV_CNT")  ||18978  |                ddblCnt = gvlnDyDataN("NAV_CNT")  
19024  |                If ddblCnt > 0 Then               ||18979  |                If ddblCnt > 0 Then               
19025  |                    ddblNavTotal = ddblNavTotal + ||18980  |                    ddblNavTotal = ddblNavTotal + 
19026  |                Else                              ||18981  |                Else                              
19027  |                    ddblNavTotal = ddblNavTotal + ||18982  |                    ddblNavTotal = ddblNavTotal + 
19028  |                End If                            ||18983  |                End If                            
19029  |                gtypcfr_mnav_tbl(MonthlyCnt).BASE_||18984  |                gtypcfr_mnav_tbl(MonthlyCnt).BASE_
19030  |                gtypcfr_mnav_tbl(MonthlyCnt).net_a||18985  |                gtypcfr_mnav_tbl(MonthlyCnt).net_a
19031  |                dstrMonthOld = dstrMonthNew       ||18986  |                dstrMonthOld = dstrMonthNew       
19032  |                                                  ||18987  |                                                  
19033  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 ||18988  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 
19034  |                Call gDyNext                      ||18989  |                Call gDyNext                      
19035  |            Loop                                  ||18990  |            Loop                                  
19036  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||18991  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
19037  |            Call gblnDyClose                      ||18992  |            Call gblnDyClose                      
19038  |        'マザー組入資産                           ||18993  |        'マザー組入資産                           
19039  |        Case "1"                                  ||18994  |        Case "1"                                  
19040  |            'SQL文の作成(日次NAV取得)             ||18995  |            'SQL文の作成(日次NAV取得)             
19041  |            msContNo = gbuMGetUPDRec.N(Idx).MGET_c||18996  |            msContNo = gbuMGetUPDRec.N(Idx).MGET_c
19042  |            '日次NAVとベビーマザー比率は当年度のNA||18997  |            '日次NAVとベビーマザー比率は当年度のNA
19043  |            sSql = gstrEditSQLcfr_DailyNavBabyMoth||18998  |            sSql = gstrEditSQLcfr_DailyNavBabyMoth
19044  |                msContNo, mstrNearSettleDate)     ||18999  |                msContNo, mstrNearSettleDate)     
19045  |                                                  ||19000  |                                                  
19046  |            'ﾀﾞｲﾅｾｯﾄの作成                        ||19001  |            'ﾀﾞｲﾅｾｯﾄの作成                        
19047  |            If gintDyCreate(sSql) = False Then    ||19002  |            If gintDyCreate(sSql) = False Then    
19048  |                Exit Sub                          ||19003  |                Exit Sub                          
19049  |            End If                                ||19004  |            End If                                
19050  |                                                  ||19005  |                                                  
19051  |            mstrDailyNav = 0                      ||19006  |            mstrDailyNav = 0                      
19052  |            ddblNav = 0                           ||19007  |            ddblNav = 0                           
19053  |            ddblCnt = 0                           ||19008  |            ddblCnt = 0                           
19054  |            ddblBabyMotherRate = 0                ||19009  |            ddblBabyMotherRate = 0                
19055  |                                                  ||19010  |                                                  
19056  |            'EOF判定処理                          ||19011  |            'EOF判定処理                          
19057  |            Do Until gblnDyEOF()                  ||19012  |            Do Until gblnDyEOF()                  
19058  |                ddblNav = gvlnDyDataN("NET_ASSET_V||19013  |                ddblNav = gvlnDyDataN("NET_ASSET_V
19059  |                ddblBabyMotherRate = gvlnDyDataN("||19014  |                ddblBabyMotherRate = gvlnDyDataN("
19060  |                ddblCnt = gvlnDyDataN("NAV_CNT")  ||19015  |                ddblCnt = gvlnDyDataN("NAV_CNT")  
19061  |                If ddblCnt > 0 Then               ||19016  |                If ddblCnt > 0 Then               
19062  |                    '(日次NAV × マザー組入比率)  ||19017  |                    '(日次NAV × マザー組入比率)  
19063  |                    mstrDailyNav = mstrDailyNav + ||19018  |                    mstrDailyNav = mstrDailyNav + 
19064  |                Else                              ||19019  |                Else                              
19065  |                    mstrDailyNav = mstrDailyNav + ||19020  |                    mstrDailyNav = mstrDailyNav + 
19066  |                End If                            ||19021  |                End If                            
19067  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 ||19022  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 
19068  |                Call gDyNext                      ||19023  |                Call gDyNext                      
19069  |            Loop                                  ||19024  |            Loop                                  
19070  |                                                  ||19025  |                                                  
19071  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||19026  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
19072  |            Call gblnDyClose                      ||19027  |            Call gblnDyClose                      
19073  |                                                  ||19028  |                                                  
19074  |            'SQL文の作成(月次NAV取得)             ||19029  |            'SQL文の作成(月次NAV取得)             
19075  |            '配列初期化                           ||19030  |            '配列初期化                           
19076  |            ReDim gtypcfr_mnav_tbl(0)             ||19031  |            ReDim gtypcfr_mnav_tbl(0)             
19077  |                                                  ||19032  |                                                  
19078  |            sZenkai = Mid(mstrSettlementDate, 1, 6||19033  |            sZenkai = Mid(mstrSettlementDate, 1, 6
19079  |                                                  ||19034  |                                                  
19080  |            '直近締日の月の前月をセット           ||19035  |            '直近締日の月の前月をセット           
19081  |            sNearMonth = DateAdd("m", -1, gstrDate||19036  |            sNearMonth = DateAdd("m", -1, gstrDate
19082  |            sNearMonth = Mid(gstrDateFormat2(sNear||19037  |            sNearMonth = Mid(gstrDateFormat2(sNear
19083  |                                                  ||19038  |                                                  
19084  |            'ベビーマザー比率は対象NAVの月末日付を||19039  |            'ベビーマザー比率は対象NAVの月末日付を
19085  |            sSql = gstrEditSQLcfr_MonthlyNavBabyMo||19040  |            sSql = gstrEditSQLcfr_MonthlyNavBabyMo
19086  |                msAccCode, msMotherAccCode, msCont||19041  |                msAccCode, msMotherAccCode, msCont
19087  |                                                  ||19042  |                                                  
19088  |            'ﾀﾞｲﾅｾｯﾄの作成                        ||19043  |            'ﾀﾞｲﾅｾｯﾄの作成                        
19089  |            If gintDyCreate(sSql) = False Then    ||19044  |            If gintDyCreate(sSql) = False Then    
19090  |                Exit Sub                          ||19045  |                Exit Sub                          
19091  |            End If                                ||19046  |            End If                                
19092  |                                                  ||19047  |                                                  
19093  |            dstrMonthOld = ""                     ||19048  |            dstrMonthOld = ""                     
19094  |            dstrMonthNew = ""                     ||19049  |            dstrMonthNew = ""                     
19095  |            ddblNav = 0                           ||19050  |            ddblNav = 0                           
19096  |            ddblCnt = 0                           ||19051  |            ddblCnt = 0                           
19097  |            ddblBabyMotherRate = 0                ||19052  |            ddblBabyMotherRate = 0                
19098  |            ddblNavTotal = 0                      ||19053  |            ddblNavTotal = 0                      
19099  |            i = 0                                 ||19054  |            i = 0                                 
19100  |                                                  ||19055  |                                                  
19101  |            Do Until gblnDyEOF()                  ||19056  |            Do Until gblnDyEOF()                  
19102  |                '対象月次NAV抽出                  ||19057  |                '対象月次NAV抽出                  
19103  |                dstrMonthNew = gvlnDyDataS("base_m||19058  |                dstrMonthNew = gvlnDyDataS("base_m
19104  |                If dstrMonthNew <> dstrMonthOld Th||19059  |                If dstrMonthNew <> dstrMonthOld Th
19105  |                    If i = 0 Then                 ||19060  |                    If i = 0 Then                 
19106  |                        '動的配列更新             ||19061  |                        '動的配列更新             
19107  |                        ReDim Preserve gtypcfr_mna||19062  |                        ReDim Preserve gtypcfr_mna
19108  |                        i = 1                     ||19063  |                        i = 1                     
19109  |                    Else                          ||19064  |                    Else                          
19110  |                        MonthlyCnt = MonthlyCnt + ||19065  |                        MonthlyCnt = MonthlyCnt + 
19111  |                        ReDim Preserve gtypcfr_mna||19066  |                        ReDim Preserve gtypcfr_mna
19112  |                        ddblNav = 0               ||19067  |                        ddblNav = 0               
19113  |                        ddblCnt = 0               ||19068  |                        ddblCnt = 0               
19114  |                        ddblNavTotal = 0          ||19069  |                        ddblNavTotal = 0          
19115  |                    End If                        ||19070  |                    End If                        
19116  |                End If                            ||19071  |                End If                            
19117  |                ddblNav = gvlnDyDataN("NET_ASSET_V||19072  |                ddblNav = gvlnDyDataN("NET_ASSET_V
19118  |                ddblBabyMotherRate = gvlnDyDataN("||19073  |                ddblBabyMotherRate = gvlnDyDataN("
19119  |                ddblCnt = gvlnDyDataN("NAV_CNT")  ||19074  |                ddblCnt = gvlnDyDataN("NAV_CNT")  
19120  |                If ddblCnt > 0 Then               ||19075  |                If ddblCnt > 0 Then               
19121  |                    '(日次NAV × マザー組入比率)  ||19076  |                    '(日次NAV × マザー組入比率)  
19122  |                    ddblNavTotal = ddblNavTotal + ||19077  |                    ddblNavTotal = ddblNavTotal + 
19123  |                Else                              ||19078  |                Else                              
19124  |                    ddblNavTotal = ddblNavTotal + ||19079  |                    ddblNavTotal = ddblNavTotal + 
19125  |                End If                            ||19080  |                End If                            
19126  |                gtypcfr_mnav_tbl(MonthlyCnt).BASE_||19081  |                gtypcfr_mnav_tbl(MonthlyCnt).BASE_
19127  |                gtypcfr_mnav_tbl(MonthlyCnt).net_a||19082  |                gtypcfr_mnav_tbl(MonthlyCnt).net_a
19128  |                dstrMonthOld = dstrMonthNew       ||19083  |                dstrMonthOld = dstrMonthNew       
19129  |                                                  ||19084  |                                                  
19130  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 ||19085  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 
19131  |                Call gDyNext                      ||19086  |                Call gDyNext                      
19132  |            Loop                                  ||19087  |            Loop                                  
19133  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||19088  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
19134  |            Call gblnDyClose                      ||19089  |            Call gblnDyClose                      
19135  |    End Select                                    ||19090  |    End Select                                    
19136  |                                                  ||19091  |                                                  
19137  |End Sub                                           ||19092  |End Sub                                           
19138  |                                                  ||19093  |                                                  
19139  |'=================================================||19094  |'=================================================
19140  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMonthlyNAV_GetChangeRate   ||19095  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMonthlyNAV_GetChangeRate   
19141  |'機能            :   月次NAV取得(料率変更無し)    ||19096  |'機能            :   月次NAV取得(料率変更無し)    
19142  |'                                                 ||19097  |'                                                 
19143  |'                                                 ||19098  |'                                                 
19144  |'日付               担当　              修正内容  ||19099  |'日付               担当　              修正内容  
19145  |'-------------------------------------------------||19100  |'-------------------------------------------------
19146  |'2006/08/02         K.Furuya<SRA>      新規作成 期||19101  |'2006/08/02         K.Furuya<SRA>      新規作成 期
19147  |'=================================================||19102  |'=================================================
19148  |Private Sub sbMonthlyNAV_GetChangeRate(ByVal Idx A||19103  |Private Sub sbMonthlyNAV_GetChangeRate(ByVal Idx A
19149  |    Dim sZenkai             As String   '前回締日 ||19104  |    Dim sZenkai             As String   '前回締日 
19150  |    Dim sNearMonth          As String   '直近締日 ||19105  |    Dim sNearMonth          As String   '直近締日 
19151  |    Dim ddblNav             As Double             ||19106  |    Dim ddblNav             As Double             
19152  |    Dim ddblCnt             As Double             ||19107  |    Dim ddblCnt             As Double             
19153  |    Dim ddblNavTotal        As Double             ||19108  |    Dim ddblNavTotal        As Double             
19154  |    Dim ddblBabyMotherRate  As Double   'ベビー/マ||19109  |    Dim ddblBabyMotherRate  As Double   'ベビー/マ
19155  |    Dim dstrMonthOld        As String             ||19110  |    Dim dstrMonthOld        As String             
19156  |    Dim dstrMonthNew        As String             ||19111  |    Dim dstrMonthNew        As String             
19157  |    Dim sSql                As String             ||19112  |    Dim sSql                As String             
19158  |    Dim MonthlyCnt          As Integer            ||19113  |    Dim MonthlyCnt          As Integer            
19159  |    Dim strRuleNo           As Integer  '比較ルー ||19114  |    Dim strRuleNo           As Integer  '比較ルー 
19160  |    Dim endRuleNo           As Integer  '比較ルー ||19115  |    Dim endRuleNo           As Integer  '比較ルー 
19161  |    Dim i                   As Integer            ||19116  |    Dim i                   As Integer            
19162  |    Dim J                   As Integer            ||19117  |    Dim J                   As Integer            
19163  |    Dim K                   As Integer            ||19118  |    Dim K                   As Integer            
19164  |    Dim ContNo              As String   '契約番号 ||19119  |    Dim ContNo              As String   '契約番号 
19165  |                                                  ||19120  |                                                  
19166  |    sNearMonth = ""                               ||19121  |    sNearMonth = ""                               
19167  |    sZenkai = ""                                  ||19122  |    sZenkai = ""                                  
19168  |    MonthlyCnt = 0                                ||19123  |    MonthlyCnt = 0                                
19169  |                                                  ||19124  |                                                  
19170  |                                                  ||19125  |                                                  
19171  |    '月次NAVを取得(資産種別により分岐)            ||19126  |    '月次NAVを取得(資産種別により分岐)            
19172  |    Select Case msAssetFlg                        ||19127  |    Select Case msAssetFlg                        
19173  |        '純資産                                   ||19128  |        '純資産                                   
19174  |        Case "0"                                  ||19129  |        Case "0"                                  
19175  |            '料率変更毎の計算期間日数、順位、料率 ||19130  |            '料率変更毎の計算期間日数、順位、料率 
19176  |            For i = LBound(gtypOtherComRec) To UBo||19131  |            For i = LBound(gtypOtherComRec) To UBo
19177  |                '契約番号を取得                   ||19132  |                '契約番号を取得                   
19178  |                ContNo = gbuMGetUPDRec.N(Idx).MGET||19133  |                ContNo = gbuMGetUPDRec.N(Idx).MGET
19179  |                '計算開始月をセット               ||19134  |                '計算開始月をセット               
19180  |                sZenkai = Mid(gtypOtherComRec(i).A||19135  |                sZenkai = Mid(gtypOtherComRec(i).A
19181  |                '直近締日の月の前月をセット       ||19136  |                '直近締日の月の前月をセット       
19182  |                sNearMonth = DateAdd("m", -1, gstr||19137  |                sNearMonth = DateAdd("m", -1, gstr
19183  |                sNearMonth = Mid(gstrDateFormat2(s||19138  |                sNearMonth = Mid(gstrDateFormat2(s
19184  |                '計算終了月が開始月より前の場合は ||19139  |                '計算終了月が開始月より前の場合は 
19185  |                If sZenkai > sNearMonth Then      ||19140  |                If sZenkai > sNearMonth Then      
19186  |                    sNearMonth = sZenkai          ||19141  |                    sNearMonth = sZenkai          
19187  |                End If                            ||19142  |                End If                            
19188  |                'SQL文の作成(月次NAV取得)         ||19143  |                'SQL文の作成(月次NAV取得)         
19189  |                sSql = gstrEditSQLcfr_MonthlyNavFo||19144  |                sSql = gstrEditSQLcfr_MonthlyNavFo
19190  |                    ContNo, sNearMonth, sZenkai)  ||19145  |                    ContNo, sNearMonth, sZenkai)  
19191  |                                                  ||19146  |                                                  
19192  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||19147  |                'ﾀﾞｲﾅｾｯﾄの作成                    
19193  |                If gintDyCreate(sSql) = False Then||19148  |                If gintDyCreate(sSql) = False Then
19194  |                    Exit Sub                      ||19149  |                    Exit Sub                      
19195  |                End If                            ||19150  |                End If                            
19196  |                                                  ||19151  |                                                  
19197  |                dstrMonthOld = ""                 ||19152  |                dstrMonthOld = ""                 
19198  |                dstrMonthNew = ""                 ||19153  |                dstrMonthNew = ""                 
19199  |                ddblNav = 0                       ||19154  |                ddblNav = 0                       
19200  |                ddblCnt = 0                       ||19155  |                ddblCnt = 0                       
19201  |                ddblNavTotal = 0                  ||19156  |                ddblNavTotal = 0                  
19202  |                'ループ変数初期化                 ||19157  |                'ループ変数初期化                 
19203  |                J = 0                             ||19158  |                J = 0                             
19204  |                                                  ||19159  |                                                  
19205  |                Do Until gblnDyEOF()              ||19160  |                Do Until gblnDyEOF()              
19206  |                    '対象月次NAV抽出              ||19161  |                    '対象月次NAV抽出              
19207  |                    dstrMonthNew = gvlnDyDataS("ba||19162  |                    dstrMonthNew = gvlnDyDataS("ba
19208  |                    If dstrMonthNew <> dstrMonthOl||19163  |                    If dstrMonthNew <> dstrMonthOl
19209  |                        '動的配列更新             ||19164  |                        '動的配列更新             
19210  |                        ReDim Preserve gtypOtherCo||19165  |                        ReDim Preserve gtypOtherCo
19211  |                        ddblNav = 0               ||19166  |                        ddblNav = 0               
19212  |                        ddblCnt = 0               ||19167  |                        ddblCnt = 0               
19213  |                    End If                        ||19168  |                    End If                        
19214  |                    ddblNav = gvlnDyDataN("NET_ASS||19169  |                    ddblNav = gvlnDyDataN("NET_ASS
19215  |                    ddblCnt = gvlnDyDataN("NAV_CNT||19170  |                    ddblCnt = gvlnDyDataN("NAV_CNT
19216  |                    If ddblCnt > 0 Then           ||19171  |                    If ddblCnt > 0 Then           
19217  |                        ddblNavTotal = ddblNavTota||19172  |                        ddblNavTotal = ddblNavTota
19218  |                        'レコードが存在した場合基 ||19173  |                        'レコードが存在した場合基 
19219  |                        gtypOtherComRec(i).APPLY_G||19174  |                        gtypOtherComRec(i).APPLY_G
19220  |                            WordYear & CInt(Mid(ds||19175  |                            WordYear & CInt(Mid(ds
19221  |                        '基準月英文をセット       ||19176  |                        '基準月英文をセット       
19222  |                        dstrMonthNew = CDate(gstrD||19177  |                        dstrMonthNew = CDate(gstrD
19223  |                        gtypOtherComRec(i).APPLY_G||19178  |                        gtypOtherComRec(i).APPLY_G
19224  |                            CStr(Format(dstrMonthN||19179  |                            CStr(Format(dstrMonthN
19225  |                        'NAVをセット              ||19180  |                        'NAVをセット              
19226  |                        gtypOtherComRec(i).APPLY_G||19181  |                        gtypOtherComRec(i).APPLY_G
19227  |                    Else                          ||19182  |                    Else                          
19228  |                        ddblNavTotal = ddblNavTota||19183  |                        ddblNavTotal = ddblNavTota
19229  |                    End If                        ||19184  |                    End If                        
19230  |                    dstrMonthOld = dstrMonthNew   ||19185  |                    dstrMonthOld = dstrMonthNew   
19231  |                                                  ||19186  |                                                  
19232  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             ||19187  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             
19233  |                    Call gDyNext                  ||19188  |                    Call gDyNext                  
19234  |                    J = J + 1                     ||19189  |                    J = J + 1                     
19235  |                Loop                              ||19190  |                Loop                              
19236  |                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                 ||19191  |                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                 
19237  |                Call gblnDyClose                  ||19192  |                Call gblnDyClose                  
19238  |                                                  ||19193  |                                                  
19239  |                'SQL文の作成(日次NAV取得)         ||19194  |                'SQL文の作成(日次NAV取得)         
19240  |                '日次NAVは当年度のNAVを取得する   ||19195  |                '日次NAVは当年度のNAVを取得する   
19241  |                sNearMonth = gtypOtherComRec(i).AP||19196  |                sNearMonth = gtypOtherComRec(i).AP
19242  |                sSql = gstrEditSQLcfr_DailyNavForS||19197  |                sSql = gstrEditSQLcfr_DailyNavForS
19243  |                    ContNo, sNearMonth)           ||19198  |                    ContNo, sNearMonth)           
19244  |                                                  ||19199  |                                                  
19245  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||19200  |                'ﾀﾞｲﾅｾｯﾄの作成                    
19246  |                If gintDyCreate(sSql) = False Then||19201  |                If gintDyCreate(sSql) = False Then
19247  |                    Exit Sub                      ||19202  |                    Exit Sub                      
19248  |                End If                            ||19203  |                End If                            
19249  |                                                  ||19204  |                                                  
19250  |                ddblNav = 0                       ||19205  |                ddblNav = 0                       
19251  |                ddblCnt = 0                       ||19206  |                ddblCnt = 0                       
19252  |                'EOF判定処理                      ||19207  |                'EOF判定処理                      
19253  |                Do Until gblnDyEOF()              ||19208  |                Do Until gblnDyEOF()              
19254  |                    '動的配列更新                 ||19209  |                    '動的配列更新                 
19255  |                    ReDim Preserve gtypOtherComRec||19210  |                    ReDim Preserve gtypOtherComRec
19256  |                    ddblNav = gvlnDyDataN("NET_ASS||19211  |                    ddblNav = gvlnDyDataN("NET_ASS
19257  |                    ddblCnt = gvlnDyDataN("NAV_CNT||19212  |                    ddblCnt = gvlnDyDataN("NAV_CNT
19258  |                    If ddblCnt > 0 Then           ||19213  |                    If ddblCnt > 0 Then           
19259  |                        ddblNavTotal = ddblNavTota||19214  |                        ddblNavTotal = ddblNavTota
19260  |                        'レコードが存在した場合基 ||19215  |                        'レコードが存在した場合基 
19261  |                        gtypOtherComRec(i).APPLY_G||19216  |                        gtypOtherComRec(i).APPLY_G
19262  |                            CStr(Format(gstrDateFo||19217  |                            CStr(Format(gstrDateFo
19263  |                        '基準月英文をセット       ||19218  |                        '基準月英文をセット       
19264  |                        gtypOtherComRec(i).APPLY_G||19219  |                        gtypOtherComRec(i).APPLY_G
19265  |                            CStr(Format(CDate(gstr||19220  |                            CStr(Format(CDate(gstr
19266  |                        'NAVをセット              ||19221  |                        'NAVをセット              
19267  |                        gtypOtherComRec(i).APPLY_G||19222  |                        gtypOtherComRec(i).APPLY_G
19268  |                    Else                          ||19223  |                    Else                          
19269  |                        ddblNavTotal = ddblNavTota||19224  |                        ddblNavTotal = ddblNavTota
19270  |                    End If                        ||19225  |                    End If                        
19271  |                                                  ||19226  |                                                  
19272  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             ||19227  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             
19273  |                    Call gDyNext                  ||19228  |                    Call gDyNext                  
19274  |                    J = J + 1                     ||19229  |                    J = J + 1                     
19275  |                Loop                              ||19230  |                Loop                              
19276  |                                                  ||19231  |                                                  
19277  |                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                 ||19232  |                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                 
19278  |                Call gblnDyClose                  ||19233  |                Call gblnDyClose                  
19279  |                                                  ||19234  |                                                  
19280  |                '月数とNAV合計とNAV平均をセット   ||19235  |                '月数とNAV合計とNAV平均をセット   
19281  |                gtypOtherComRec(i).APPLY_CALC_MONT||19236  |                gtypOtherComRec(i).APPLY_CALC_MONT
19282  |                gtypOtherComRec(i).APPLY_TOTAL_NAV||19237  |                gtypOtherComRec(i).APPLY_TOTAL_NAV
19283  |                gtypOtherComRec(i).APPLY_NAV_AVG =||19238  |                gtypOtherComRec(i).APPLY_NAV_AVG =
19284  |            Next i                                ||19239  |            Next i                                
19285  |                                                  ||19240  |                                                  
19286  |        'マザー組入資産                           ||19241  |        'マザー組入資産                           
19287  |        Case "1"                                  ||19242  |        Case "1"                                  
19288  |            '料率変更毎の計算期間日数、順位、料率 ||19243  |            '料率変更毎の計算期間日数、順位、料率 
19289  |            For i = LBound(gtypOtherComRec) To UBo||19244  |            For i = LBound(gtypOtherComRec) To UBo
19290  |                '契約番号を取得                   ||19245  |                '契約番号を取得                   
19291  |                ContNo = gbuMGetUPDRec.N(Idx).MGET||19246  |                ContNo = gbuMGetUPDRec.N(Idx).MGET
19292  |                '計算開始月をセット               ||19247  |                '計算開始月をセット               
19293  |                sZenkai = Mid(gtypOtherComRec(i).A||19248  |                sZenkai = Mid(gtypOtherComRec(i).A
19294  |                '直近締日の月の前月をセット       ||19249  |                '直近締日の月の前月をセット       
19295  |                sNearMonth = DateAdd("m", -1, gstr||19250  |                sNearMonth = DateAdd("m", -1, gstr
19296  |                sNearMonth = Mid(gstrDateFormat2(s||19251  |                sNearMonth = Mid(gstrDateFormat2(s
19297  |                '計算終了月が開始月より前の場合は ||19252  |                '計算終了月が開始月より前の場合は 
19298  |                If sZenkai > sNearMonth Then      ||19253  |                If sZenkai > sNearMonth Then      
19299  |                    sNearMonth = sZenkai          ||19254  |                    sNearMonth = sZenkai          
19300  |                End If                            ||19255  |                End If                            
19301  |                                                  ||19256  |                                                  
19302  |                'ベビーマザー比率は対象NAVの月末日||19257  |                'ベビーマザー比率は対象NAVの月末日
19303  |                sSql = gstrEditSQLcfr_MonthlyNavBa||19258  |                sSql = gstrEditSQLcfr_MonthlyNavBa
19304  |                    msAccCode, msMotherAccCode, Co||19259  |                    msAccCode, msMotherAccCode, Co
19305  |                                                  ||19260  |                                                  
19306  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||19261  |                'ﾀﾞｲﾅｾｯﾄの作成                    
19307  |                If gintDyCreate(sSql) = False Then||19262  |                If gintDyCreate(sSql) = False Then
19308  |                    Exit Sub                      ||19263  |                    Exit Sub                      
19309  |                End If                            ||19264  |                End If                            
19310  |                                                  ||19265  |                                                  
19311  |                dstrMonthOld = ""                 ||19266  |                dstrMonthOld = ""                 
19312  |                dstrMonthNew = ""                 ||19267  |                dstrMonthNew = ""                 
19313  |                ddblNav = 0                       ||19268  |                ddblNav = 0                       
19314  |                ddblCnt = 0                       ||19269  |                ddblCnt = 0                       
19315  |                ddblNavTotal = 0                  ||19270  |                ddblNavTotal = 0                  
19316  |                'ループ変数初期化                 ||19271  |                'ループ変数初期化                 
19317  |                J = 0                             ||19272  |                J = 0                             
19318  |                                                  ||19273  |                                                  
19319  |                Do Until gblnDyEOF()              ||19274  |                Do Until gblnDyEOF()              
19320  |                    '対象月次NAV抽出              ||19275  |                    '対象月次NAV抽出              
19321  |                    dstrMonthNew = gvlnDyDataS("ba||19276  |                    dstrMonthNew = gvlnDyDataS("ba
19322  |                    If dstrMonthNew <> dstrMonthOl||19277  |                    If dstrMonthNew <> dstrMonthOl
19323  |                        '動的配列更新             ||19278  |                        '動的配列更新             
19324  |                        ReDim Preserve gtypOtherCo||19279  |                        ReDim Preserve gtypOtherCo
19325  |                        ddblNav = 0               ||19280  |                        ddblNav = 0               
19326  |                        ddblCnt = 0               ||19281  |                        ddblCnt = 0               
19327  |                    End If                        ||19282  |                    End If                        
19328  |                    ddblNav = gvlnDyDataN("NET_ASS||19283  |                    ddblNav = gvlnDyDataN("NET_ASS
19329  |                    ddblBabyMotherRate = gvlnDyDat||19284  |                    ddblBabyMotherRate = gvlnDyDat
19330  |                    ddblCnt = gvlnDyDataN("NAV_CNT||19285  |                    ddblCnt = gvlnDyDataN("NAV_CNT
19331  |                    If ddblCnt > 0 Then           ||19286  |                    If ddblCnt > 0 Then           
19332  |                        'NAV合計 = NAV合計 + (取得||19287  |                        'NAV合計 = NAV合計 + (取得
19333  |                        ddblNavTotal = ddblNavTota||19288  |                        ddblNavTotal = ddblNavTota
19334  |                        'レコードが存在した場合基 ||19289  |                        'レコードが存在した場合基 
19335  |                        gtypOtherComRec(i).APPLY_G||19290  |                        gtypOtherComRec(i).APPLY_G
19336  |                            WordYear & CInt(Mid(ds||19291  |                            WordYear & CInt(Mid(ds
19337  |                        '基準月英文をセット       ||19292  |                        '基準月英文をセット       
19338  |                        dstrMonthNew = CDate(gstrD||19293  |                        dstrMonthNew = CDate(gstrD
19339  |                        gtypOtherComRec(i).APPLY_G||19294  |                        gtypOtherComRec(i).APPLY_G
19340  |                            CStr(Format(dstrMonthN||19295  |                            CStr(Format(dstrMonthN
19341  |                        'NAVをセット              ||19296  |                        'NAVをセット              
19342  |                        gtypOtherComRec(i).APPLY_G||19297  |                        gtypOtherComRec(i).APPLY_G
19343  |                    Else                          ||19298  |                    Else                          
19344  |                        ddblNavTotal = ddblNavTota||19299  |                        ddblNavTotal = ddblNavTota
19345  |                    End If                        ||19300  |                    End If                        
19346  |                    dstrMonthOld = dstrMonthNew   ||19301  |                    dstrMonthOld = dstrMonthNew   
19347  |                                                  ||19302  |                                                  
19348  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             ||19303  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             
19349  |                    Call gDyNext                  ||19304  |                    Call gDyNext                  
19350  |                    J = J + 1                     ||19305  |                    J = J + 1                     
19351  |                Loop                              ||19306  |                Loop                              
19352  |                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                 ||19307  |                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                 
19353  |                Call gblnDyClose                  ||19308  |                Call gblnDyClose                  
19354  |                                                  ||19309  |                                                  
19355  |                                                  ||19310  |                                                  
19356  |                'SQL文の作成(日次NAV取得)         ||19311  |                'SQL文の作成(日次NAV取得)         
19357  |                '日次NAVは当年度のNAVを取得する   ||19312  |                '日次NAVは当年度のNAVを取得する   
19358  |                sNearMonth = gtypOtherComRec(i).AP||19313  |                sNearMonth = gtypOtherComRec(i).AP
19359  |                '日次NAVとベビーマザー比率は当年度||19314  |                '日次NAVとベビーマザー比率は当年度
19360  |                sSql = gstrEditSQLcfr_DailyNavBaby||19315  |                sSql = gstrEditSQLcfr_DailyNavBaby
19361  |                    ContNo, sNearMonth)           ||19316  |                    ContNo, sNearMonth)           
19362  |                                                  ||19317  |                                                  
19363  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||19318  |                'ﾀﾞｲﾅｾｯﾄの作成                    
19364  |                If gintDyCreate(sSql) = False Then||19319  |                If gintDyCreate(sSql) = False Then
19365  |                    Exit Sub                      ||19320  |                    Exit Sub                      
19366  |                End If                            ||19321  |                End If                            
19367  |                                                  ||19322  |                                                  
19368  |                ddblNav = 0                       ||19323  |                ddblNav = 0                       
19369  |                ddblCnt = 0                       ||19324  |                ddblCnt = 0                       
19370  |                'EOF判定処理                      ||19325  |                'EOF判定処理                      
19371  |                Do Until gblnDyEOF()              ||19326  |                Do Until gblnDyEOF()              
19372  |                    '動的配列更新                 ||19327  |                    '動的配列更新                 
19373  |                    ReDim Preserve gtypOtherComRec||19328  |                    ReDim Preserve gtypOtherComRec
19374  |                    ddblNav = gvlnDyDataN("NET_ASS||19329  |                    ddblNav = gvlnDyDataN("NET_ASS
19375  |                    ddblBabyMotherRate = gvlnDyDat||19330  |                    ddblBabyMotherRate = gvlnDyDat
19376  |                    ddblCnt = gvlnDyDataN("NAV_CNT||19331  |                    ddblCnt = gvlnDyDataN("NAV_CNT
19377  |                    If ddblCnt > 0 Then           ||19332  |                    If ddblCnt > 0 Then           
19378  |                        'NAV合計 = NAV合計 + (取得||19333  |                        'NAV合計 = NAV合計 + (取得
19379  |                        ddblNavTotal = ddblNavTota||19334  |                        ddblNavTotal = ddblNavTota
19380  |                        'レコードが存在した場合基 ||19335  |                        'レコードが存在した場合基 
19381  |                        gtypOtherComRec(i).APPLY_G||19336  |                        gtypOtherComRec(i).APPLY_G
19382  |                            CStr(Format(gstrDateFo||19337  |                            CStr(Format(gstrDateFo
19383  |                        '基準月英文をセット       ||19338  |                        '基準月英文をセット       
19384  |                        gtypOtherComRec(i).APPLY_G||19339  |                        gtypOtherComRec(i).APPLY_G
19385  |                            CStr(Format(CDate(gstr||19340  |                            CStr(Format(CDate(gstr
19386  |                        'NAVをセット              ||19341  |                        'NAVをセット              
19387  |                        gtypOtherComRec(i).APPLY_G||19342  |                        gtypOtherComRec(i).APPLY_G
19388  |                    Else                          ||19343  |                    Else                          
19389  |                        ddblNavTotal = ddblNavTota||19344  |                        ddblNavTotal = ddblNavTota
19390  |                    End If                        ||19345  |                    End If                        
19391  |                                                  ||19346  |                                                  
19392  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             ||19347  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             
19393  |                    Call gDyNext                  ||19348  |                    Call gDyNext                  
19394  |                Loop                              ||19349  |                Loop                              
19395  |                                                  ||19350  |                                                  
19396  |                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                 ||19351  |                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                 
19397  |                Call gblnDyClose                  ||19352  |                Call gblnDyClose                  
19398  |                                                  ||19353  |                                                  
19399  |                '月数とNAV合計とNAV平均をセット   ||19354  |                '月数とNAV合計とNAV平均をセット   
19400  |                gtypOtherComRec(i).APPLY_CALC_MONT||19355  |                gtypOtherComRec(i).APPLY_CALC_MONT
19401  |                gtypOtherComRec(i).APPLY_TOTAL_NAV||19356  |                gtypOtherComRec(i).APPLY_TOTAL_NAV
19402  |                gtypOtherComRec(i).APPLY_NAV_AVG =||19357  |                gtypOtherComRec(i).APPLY_NAV_AVG =
19403  |                                                  ||19358  |                                                  
19404  |            Next i                                ||19359  |            Next i                                
19405  |    End Select                                    ||19360  |    End Select                                    
19406  |                                                  ||19361  |                                                  
19407  |End Sub                                           ||19362  |End Sub                                           
19408  |                                                  ||19363  |                                                  
19409  |                                                  ||19364  |                                                  
19410  |                                                  ||19365  |                                                  
19411  |'=================================================||19366  |'=================================================
19412  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelEnglishOut_NotChgRat||19367  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelEnglishOut_NotChgRat
19413  |'機能            :   確認書(英文)のExcel出力(料率 ||19368  |'機能            :   確認書(英文)のExcel出力(料率 
19414  |'                                                 ||19369  |'                                                 
19415  |'日付               担当　              修正内容  ||19370  |'日付               担当　              修正内容  
19416  |'-------------------------------------------------||19371  |'-------------------------------------------------
19417  |'2006/08/18         K.Furuya <SRA>     RAFI対応   ||19372  |'2006/08/18         K.Furuya <SRA>     RAFI対応   
19418  |'                                      fnblExcelEn||19373  |'                                      fnblExcelEn
19419  |'2008/02/20         K.Furuya <SRA>     時価総額基 ||19374  |'2008/02/20         K.Furuya <SRA>     時価総額基 
19420  |'=================================================||19375  |'=================================================
19421  |Private Function fnblExcelEnglishOut_NotChgRate( _||19376  |Private Function fnblExcelEnglishOut_NotChgRate( _
19422  |    ByVal lRecIdx As Long _                       ||19377  |    ByVal lRecIdx As Long _                       
19423  |) As Boolean                                      ||19378  |) As Boolean                                      
19424  |                                                  ||19379  |                                                  
19425  |    Dim dStart      As Date     '計算期間　開始日 ||19380  |    Dim dStart      As Date     '計算期間　開始日 
19426  |    Dim dEnd        As Date     '計算期間　終了日 ||19381  |    Dim dEnd        As Date     '計算期間　終了日 
19427  |    Dim sSql        As String                     ||19382  |    Dim sSql        As String                     
19428  |    Dim sCurrencyCode As String '通貨コード(SQL文 ||19383  |    Dim sCurrencyCode As String '通貨コード(SQL文 
19429  |    Dim AccCode     As String   '口座コード(SQL文 ||19384  |    Dim AccCode     As String   '口座コード(SQL文 
19430  |    Dim sDate       As Date     '支払予定日       ||19385  |    Dim sDate       As Date     '支払予定日       
19431  |    Dim sName       As String   '担当者名         ||19386  |    Dim sName       As String   '担当者名         
19432  |    Dim i           As Integer  'カウンター       ||19387  |    Dim i           As Integer  'カウンター       
19433  |    Dim ColNum      As Integer  '部署名コンボボッ ||19388  |    Dim ColNum      As Integer  '部署名コンボボッ 
19434  |    Dim ColWord     As String   '部署名コンボボッ ||19389  |    Dim ColWord     As String   '部署名コンボボッ 
19435  |    Dim iSyouhizei  As Long     '消費税           ||19390  |    Dim iSyouhizei  As Long     '消費税           
19436  |    Dim iRowCnt     As Long     '月末純資産データ ||19391  |    Dim iRowCnt     As Long     '月末純資産データ 
19437  |    Dim TotalNav    As Currency '累積NAV          ||19392  |    Dim TotalNav    As Currency '累積NAV          
19438  |    Dim TotalRate   As Currency '累積閾値         ||19393  |    Dim TotalRate   As Currency '累積閾値         
19439  |    Dim cRate       As Currency '料率             ||19394  |    Dim cRate       As Currency '料率             
19440  |    Dim WorkRate    As Currency '一つ前の累積閾値 ||19395  |    Dim WorkRate    As Currency '一つ前の累積閾値 
19441  |    Dim TotalCom    As Currency '累積投資顧問料   ||19396  |    Dim TotalCom    As Currency '累積投資顧問料   
19442  |    Dim lTaxNum     As Currency '消費税値         ||19397  |    Dim lTaxNum     As Currency '消費税値         
19443  |    Dim lMonthlyPayCom As Currency  '月別支払額   ||19398  |    Dim lMonthlyPayCom As Currency  '月別支払額   
19444  |    Dim lCalcNav    As Currency '計算対象NAV      ||19399  |    Dim lCalcNav    As Currency '計算対象NAV      
19445  |    Dim iCalcNum    As Integer  '計算期間日数     ||19400  |    Dim iCalcNum    As Integer  '計算期間日数     
19446  |    'Excel の Application 変数とエラーをトラップす||19401  |    'Excel の Application 変数とエラーをトラップす
19447  |    Dim iTries      As Integer                    ||19402  |    Dim iTries      As Integer                    
19448  |    Dim strErrCall      As String 'エラー呼出元   ||19403  |    Dim strErrCall      As String 'エラー呼出元   
19449  |    Const conMeModule   As String = "fnblExcelEngl||19404  |    Const conMeModule   As String = "fnblExcelEngl
19450  |    'Excel の Worksheet 削除用カウンタ変数        ||19405  |    'Excel の Worksheet 削除用カウンタ変数        
19451  |    Dim Ws_Cnt      As Integer                    ||19406  |    Dim Ws_Cnt      As Integer                    
19452  |    Dim Ws_Del_Cnt  As Integer                    ||19407  |    Dim Ws_Del_Cnt  As Integer                    
19453  |    Dim Ws_Del_Cnt2 As Integer                    ||19408  |    Dim Ws_Del_Cnt2 As Integer                    
19454  |    Dim ContNo      As String   '契約番号(SQL文作 ||19409  |    Dim ContNo      As String   '契約番号(SQL文作 
19455  |    Dim NavGetCnt   As Long                       ||19410  |    Dim NavGetCnt   As Long                       
19456  |    Dim sGetAccCode As String                     ||19411  |    Dim sGetAccCode As String                     
19457  |    Dim Mnav_Flg    As String                     ||19412  |    Dim Mnav_Flg    As String                     
19458  |    Dim sStart As String            '計算対象　開 ||19413  |    Dim sStart As String            '計算対象　開 
19459  |    Dim sEnd As String              '計算対象　終 ||19414  |    Dim sEnd As String              '計算対象　終 
19460  |    Dim dstrBasedate As String      '基準日用ワー ||19415  |    Dim dstrBasedate As String      '基準日用ワー 
19461  |    Dim dstrCaldate() As String     'カレンダー日 ||19416  |    Dim dstrCaldate() As String     'カレンダー日 
19462  |    Dim ddblDailynav() As Double    '日次NAV用格納||19417  |    Dim ddblDailynav() As Double    '日次NAV用格納
19463  |    Dim dlngCnt As Long             '計算対象期間 ||19418  |    Dim dlngCnt As Long             '計算対象期間 
19464  |    Dim dstrCaldate2 As String      'カレンダー日 ||19419  |    Dim dstrCaldate2 As String      'カレンダー日 
19465  |    Dim dstrBasedate2 As String     '基準日(/編集)||19420  |    Dim dstrBasedate2 As String     '基準日(/編集)
19466  |    Dim dlngDiffdate As Long        'カレンダー日 ||19421  |    Dim dlngDiffdate As Long        'カレンダー日 
19467  |    Dim dintFor As Integer          'For文用変数  ||19422  |    Dim dintFor As Integer          'For文用変数  
19468  |    Dim ddblTtalnav As Double       '日次NAV累積用||19423  |    Dim ddblTtalnav As Double       '日次NAV累積用
19469  |    Dim dstrAvgNav As String                      ||19424  |    Dim dstrAvgNav As String                      
19470  |    Dim ddblNearNav As Double                     ||19425  |    Dim ddblNearNav As Double                     
19471  |    Dim dstrAccCd() As String                     ||19426  |    Dim dstrAccCd() As String                     
19472  |    Dim dstrBsCCd() As String                     ||19427  |    Dim dstrBsCCd() As String                     
19473  |    Dim intRtn      As Integer                    ||19428  |    Dim intRtn      As Integer                    
19474  |    Dim dstrDate         As String                ||19429  |    Dim dstrDate         As String                
19475  |    Dim dstrCurrencyCode As String                ||19430  |    Dim dstrCurrencyCode As String                
19476  |    Dim ddblExchangeRate As Double                ||19431  |    Dim ddblExchangeRate As Double                
19477  |    Dim dintPage    As Integer                    ||19432  |    Dim dintPage    As Integer                    
19478  |    Dim dintPageIni As Integer                    ||19433  |    Dim dintPageIni As Integer                    
19479  |    Dim dintAmari   As Integer                    ||19434  |    Dim dintAmari   As Integer                    
19480  |    Dim dCalDate    As Date                       ||19435  |    Dim dCalDate    As Date                       
19481  |    Dim J           As Integer                    ||19436  |    Dim J           As Integer                    
19482  |    Dim K           As Integer                    ||19437  |    Dim K           As Integer                    
19483  |    Dim L           As Integer                    ||19438  |    Dim L           As Integer                    
19484  |    Dim AvgNav      As Currency                   ||19439  |    Dim AvgNav      As Currency                   
19485  |    Dim dintFor2    As Integer                    ||19440  |    Dim dintFor2    As Integer                    
19486  |    Dim dlngMeisyoSu As Integer                   ||19441  |    Dim dlngMeisyoSu As Integer                   
19487  |    Dim dlngCntsv As Long                         ||19442  |    Dim dlngCntsv As Long                         
19488  |    '2006/08/18 START K.Furuya RAFI対応           ||19443  |    '2006/08/18 START K.Furuya RAFI対応           
19489  |    Dim ddblNearBabyMotherRate      As Double   ' ||19444  |    Dim ddblNearBabyMotherRate      As Double   ' 
19490  |    Dim MonthlyCnt                  As Long       ||19445  |    Dim MonthlyCnt                  As Long       
19491  |    Dim dblNavTotal                 As Double   ' ||19446  |    Dim dblNavTotal                 As Double   ' 
19492  |    '2006/08/18 END   K.Furuya RAFI対応           ||19447  |    '2006/08/18 END   K.Furuya RAFI対応           
19493  |                                                  ||19448  |                                                  
19494  |    '戻り値初期化                                 ||19449  |    '戻り値初期化                                 
19495  |    fnblExcelEnglishOut_NotChgRate = False        ||19450  |    fnblExcelEnglishOut_NotChgRate = False        
19496  |    i = 0                                         ||19451  |    i = 0                                         
19497  |                                                  ||19452  |                                                  
19498  |On Error Resume Next                              ||19453  |On Error Resume Next                              
19499  |                                                  ||19454  |                                                  
19500  |    Set xlSheet = xlBook.Sheets(gProcessCnt)      ||19455  |    Set xlSheet = xlBook.Sheets(gProcessCnt)      
19501  |                                                  ||19456  |                                                  
19502  |    'Excelフォーマットを調整                      ||19457  |    'Excelフォーマットを調整                      
19503  |    xlSheet.Cells.ColumnWidth = 1                 ||19458  |    xlSheet.Cells.ColumnWidth = 1                 
19504  |    xlSheet.Cells.Font.Size = 11                  ||19459  |    xlSheet.Cells.Font.Size = 11                  
19505  |                                                  ||19460  |                                                  
19506  |    'シート名を設定(確認書**)                     ||19461  |    'シート名を設定(確認書**)                     
19507  |    '契約毎のシート番号を付番する                 ||19462  |    '契約毎のシート番号を付番する                 
19508  |    'xlBook.Sheets(gProcessCnt).Name = sWord33 & (||19463  |    'xlBook.Sheets(gProcessCnt).Name = sWord33 & (
19509  |    xlBook.Sheets(gProcessCnt).Name = sWord33a & g||19464  |    xlBook.Sheets(gProcessCnt).Name = sWord33a & g
19510  |                                                  ||19465  |                                                  
19511  |    'シートの余白を設定                           ||19466  |    'シートの余白を設定                           
19512  |    xlSheet.PageSetup.TopMargin = Application.Inch||19467  |    xlSheet.PageSetup.TopMargin = Application.Inch
19513  |    xlSheet.PageSetup.BottomMargin = Application.I||19468  |    xlSheet.PageSetup.BottomMargin = Application.I
19514  |    xlSheet.PageSetup.LeftMargin = Application.Inc||19469  |    xlSheet.PageSetup.LeftMargin = Application.Inc
19515  |    xlSheet.PageSetup.RightMargin = Application.In||19470  |    xlSheet.PageSetup.RightMargin = Application.In
19516  |                                                  ||19471  |                                                  
19517  |    DoEvents                                      ||19472  |    DoEvents                                      
19518  |    With xlSheet                                  ||19473  |    With xlSheet                                  
19519  |        '題目                                     ||19474  |        '題目                                     
19520  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||19475  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
19521  |            Case Mid(mstrContractFlag(1), 1, 1)   ||19476  |            Case Mid(mstrContractFlag(1), 1, 1)   
19522  |                .Cells(5, 1).Value = sWord0d      ||19477  |                .Cells(5, 1).Value = sWord0d      
19523  |            Case Mid(mstrContractFlag(2), 1, 1)   ||19478  |            Case Mid(mstrContractFlag(2), 1, 1)   
19524  |                .Cells(5, 1).Value = sWord0e      ||19479  |                .Cells(5, 1).Value = sWord0e      
19525  |            Case Mid(mstrContractFlag(3), 1, 1)   ||19480  |            Case Mid(mstrContractFlag(3), 1, 1)   
19526  |                .Cells(5, 1).Value = sWord0f      ||19481  |                .Cells(5, 1).Value = sWord0f      
19527  |            Case Else                             ||19482  |            Case Else                             
19528  |                MsgBox "契約区分が不正です。", vbC||19483  |                MsgBox "契約区分が不正です。", vbC
19529  |        End Select                                ||19484  |        End Select                                
19530  |        .Cells(5, 1).Font.Size = 14               ||19485  |        .Cells(5, 1).Font.Size = 14               
19531  |        .Range("A5:BG5").HorizontalAlignment = xlC||19486  |        .Range("A5:BG5").HorizontalAlignment = xlC
19532  |                                                  ||19487  |                                                  
19533  |        '出力日付                                 ||19488  |        '出力日付                                 
19534  |        If RTrim(txtSysOutDate.Text) = "" Then    ||19489  |        If RTrim(txtSysOutDate.Text) = "" Then    
19535  |            .Cells(3, 50).Value = sWord34a        ||19490  |            .Cells(3, 50).Value = sWord34a        
19536  |            .Cells(3, 50).HorizontalAlignment = xl||19491  |            .Cells(3, 50).HorizontalAlignment = xl
19537  |        Else                                      ||19492  |        Else                                      
19538  |            .Cells(3, 43).NumberFormatLocal = "@" ||19493  |            .Cells(3, 43).NumberFormatLocal = "@" 
19539  |            .Cells(3, 43).Value = CStr(Format(txtS||19494  |            .Cells(3, 43).Value = CStr(Format(txtS
19540  |        End If                                    ||19495  |        End If                                    
19541  |                                                  ||19496  |                                                  
19542  |        '下記のとおり･･･                          ||19497  |        '下記のとおり･･･                          
19543  |        .Cells(7, 2).Value = "Dear Sirs,"         ||19498  |        .Cells(7, 2).Value = "Dear Sirs,"         
19544  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||19499  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
19545  |            Case Mid(mstrContractFlag(1), 1, 1)   ||19500  |            Case Mid(mstrContractFlag(1), 1, 1)   
19546  |                .Cells(8, 2).Value = sWord3d      ||19501  |                .Cells(8, 2).Value = sWord3d      
19547  |            Case Mid(mstrContractFlag(2), 1, 1)   ||19502  |            Case Mid(mstrContractFlag(2), 1, 1)   
19548  |                .Cells(8, 2).Value = sWord3e      ||19503  |                .Cells(8, 2).Value = sWord3e      
19549  |            Case Mid(mstrContractFlag(3), 1, 1)   ||19504  |            Case Mid(mstrContractFlag(3), 1, 1)   
19550  |                .Cells(8, 2).Value = sWord3f      ||19505  |                .Cells(8, 2).Value = sWord3f      
19551  |            Case Else                             ||19506  |            Case Else                             
19552  |        End Select                                ||19507  |        End Select                                
19553  |                                                  ||19508  |                                                  
19554  |        'ファンド名                               ||19509  |        'ファンド名                               
19555  |        .Cells(10, 2).Value = sWord4a             ||19510  |        .Cells(10, 2).Value = sWord4a             
19556  |        '文言の冗長化でピリオド及び、名称を二列右 ||19511  |        '文言の冗長化でピリオド及び、名称を二列右 
19557  |'        .Cells(10, 11).Value = sWord19           ||19512  |'        .Cells(10, 11).Value = sWord19           
19558  |'        .Cells(10, 13).Value = gbuMGetUPDRec.N(lR||19513  |'        .Cells(10, 13).Value = gbuMGetUPDRec.N(lR
19559  |        .Cells(10, 13).Value = sWord19            ||19514  |        .Cells(10, 13).Value = sWord19            
19560  |        .Cells(10, 15).Value = gbuMGetUPDRec.N(lRe||19515  |        .Cells(10, 15).Value = gbuMGetUPDRec.N(lRe
19561  |                                                  ||19516  |                                                  
19562  |        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_con||19517  |        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_con
19563  |                                                  ||19518  |                                                  
19564  |        'RAFI対応 START                           ||19519  |        'RAFI対応 START                           
19565  |        'NAV取得SQL                               ||19520  |        'NAV取得SQL                               
19566  |        '外部委託顧問料ルールの資産種類によって取 ||19521  |        '外部委託顧問料ルールの資産種類によって取 
19567  |        '純資産                                   ||19522  |        '純資産                                   
19568  |        If msAssetFlg = "0" Then                  ||19523  |        If msAssetFlg = "0" Then                  
19569  |            sSql = gstrEditSQLcfr_NavGetForSelectL||19524  |            sSql = gstrEditSQLcfr_NavGetForSelectL
19570  |        'マザー組入資産                           ||19525  |        'マザー組入資産                           
19571  |        Else                                      ||19526  |        Else                                      
19572  |            sSql = gstrEditSQLcfr_MotherAccGetForS||19527  |            sSql = gstrEditSQLcfr_MotherAccGetForS
19573  |        End If                                    ||19528  |        End If                                    
19574  |                                                  ||19529  |                                                  
19575  |        'ﾀﾞｲﾅｾｯﾄの作成                            ||19530  |        'ﾀﾞｲﾅｾｯﾄの作成                            
19576  |        If gintDyCreate(sSql) = False Then        ||19531  |        If gintDyCreate(sSql) = False Then        
19577  |            Exit Function                         ||19532  |            Exit Function                         
19578  |        End If                                    ||19533  |        End If                                    
19579  |        Do Until gblnDyEOF()                      ||19534  |        Do Until gblnDyEOF()                      
19580  |            '動的配列更新                         ||19535  |            '動的配列更新                         
19581  |            ReDim Preserve gtypcfr_navget_tbl(0 To||19536  |            ReDim Preserve gtypcfr_navget_tbl(0 To
19582  |            ReDim Preserve dstrAccCd(0 To NavGetCn||19537  |            ReDim Preserve dstrAccCd(0 To NavGetCn
19583  |                                                  ||19538  |                                                  
19584  |            'NAV取得抽出                          ||19539  |            'NAV取得抽出                          
19585  |            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT_||19540  |            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT_
19586  |            If NavGetCnt > 0 Then                 ||19541  |            If NavGetCnt > 0 Then                 
19587  |                sGetAccCode = sGetAccCode & " , " ||19542  |                sGetAccCode = sGetAccCode & " , " 
19588  |            Else                                  ||19543  |            Else                                  
19589  |                sGetAccCode = sGetAccCode & gtypcf||19544  |                sGetAccCode = sGetAccCode & gtypcf
19590  |            End If                                ||19545  |            End If                                
19591  |                                                  ||19546  |                                                  
19592  |            '口座コードの格納(１契約複数口座の場合||19547  |            '口座コードの格納(１契約複数口座の場合
19593  |            dstrAccCd(NavGetCnt) = gtypcfr_navget_||19548  |            dstrAccCd(NavGetCnt) = gtypcfr_navget_
19594  |            NavGetCnt = NavGetCnt + 1             ||19549  |            NavGetCnt = NavGetCnt + 1             
19595  |            'マザー組入資産の場合ベビーファンドコ ||19550  |            'マザー組入資産の場合ベビーファンドコ 
19596  |            If msAssetFlg = "1" Then              ||19551  |            If msAssetFlg = "1" Then              
19597  |                msBabyAccountCode = ""            ||19552  |                msBabyAccountCode = ""            
19598  |                msBabyAccountCode = Trim(gvlnDyDat||19553  |                msBabyAccountCode = Trim(gvlnDyDat
19599  |            End If                                ||19554  |            End If                                
19600  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     ||19555  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     
19601  |            Call gDyNext                          ||19556  |            Call gDyNext                          
19602  |        Loop                                      ||19557  |        Loop                                      
19603  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         ||19558  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         
19604  |        Call gblnDyClose                          ||19559  |        Call gblnDyClose                          
19605  |                                                  ||19560  |                                                  
19606  |        '１契約複数口座の場合に口座のベース通貨に ||19561  |        '１契約複数口座の場合に口座のベース通貨に 
19607  |        ReDim dstrBsCCd(0 To NavGetCnt - 1)       ||19562  |        ReDim dstrBsCCd(0 To NavGetCnt - 1)       
19608  |        If NavGetCnt - 1 > 0 Then                 ||19563  |        If NavGetCnt - 1 > 0 Then                 
19609  |            For dintFor = 0 To NavGetCnt - 1      ||19564  |            For dintFor = 0 To NavGetCnt - 1      
19610  |                sSql = ""                         ||19565  |                sSql = ""                         
19611  |                sSql = sSql & "SELECT ACCOUNT_CODE||19566  |                sSql = sSql & "SELECT ACCOUNT_CODE
19612  |                sSql = sSql & "WHERE ACCOUNT_CODE ||19567  |                sSql = sSql & "WHERE ACCOUNT_CODE 
19613  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||19568  |                'ﾀﾞｲﾅｾｯﾄの作成                    
19614  |                If gintDyCreate(sSql) = False Then||19569  |                If gintDyCreate(sSql) = False Then
19615  |                    Exit Function                 ||19570  |                    Exit Function                 
19616  |                Else                              ||19571  |                Else                              
19617  |                    dstrBsCCd(dintFor) = gvlnDyDat||19572  |                    dstrBsCCd(dintFor) = gvlnDyDat
19618  |                End If                            ||19573  |                End If                            
19619  |                If dintFor > 0 Then               ||19574  |                If dintFor > 0 Then               
19620  |                    If dstrBsCCd(dintFor) <> dstrB||19575  |                    If dstrBsCCd(dintFor) <> dstrB
19621  |                        intRtn = MsgBox("ファンド ||19576  |                        intRtn = MsgBox("ファンド 
19622  |                        Exit Function             ||19577  |                        Exit Function             
19623  |                    End If                        ||19578  |                    End If                        
19624  |                End If                            ||19579  |                End If                            
19625  |            Next dintFor                          ||19580  |            Next dintFor                          
19626  |                                                  ||19581  |                                                  
19627  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||19582  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
19628  |            Call gblnDyClose                      ||19583  |            Call gblnDyClose                      
19629  |                                                  ||19584  |                                                  
19630  |        End If                                    ||19585  |        End If                                    
19631  |                                                  ||19586  |                                                  
19632  |        'ファンドコード                           ||19587  |        'ファンドコード                           
19633  |        .Cells(11, 2).Value = sWord4_2a           ||19588  |        .Cells(11, 2).Value = sWord4_2a           
19634  |        '文言の冗長化でピリオド及び、名称を二列右 ||19589  |        '文言の冗長化でピリオド及び、名称を二列右 
19635  |'        .Cells(11, 11).Value = sWord19           ||19590  |'        .Cells(11, 11).Value = sWord19           
19636  |'        .Cells(11, 13).NumberFormatLocal = "@"   ||19591  |'        .Cells(11, 13).NumberFormatLocal = "@"   
19637  |        .Cells(11, 13).Value = sWord19            ||19592  |        .Cells(11, 13).Value = sWord19            
19638  |        .Cells(11, 15).NumberFormatLocal = "@"    ||19593  |        .Cells(11, 15).NumberFormatLocal = "@"    
19639  |        'RAFI対応 START                           ||19594  |        'RAFI対応 START                           
19640  |        '純資産の場合                             ||19595  |        '純資産の場合                             
19641  |        If msAssetFlg = "0" Then                  ||19596  |        If msAssetFlg = "0" Then                  
19642  |'            .Cells(11, 13).Value = sGetAccCode   ||19597  |'            .Cells(11, 13).Value = sGetAccCode   
19643  |            .Cells(11, 15).Value = sGetAccCode    ||19598  |            .Cells(11, 15).Value = sGetAccCode    
19644  |        'マザー組入資産の場合                     ||19599  |        'マザー組入資産の場合                     
19645  |        Else                                      ||19600  |        Else                                      
19646  |'            .Cells(11, 13).Value = msBabyAccountC||19601  |'            .Cells(11, 13).Value = msBabyAccountC
19647  |            .Cells(11, 15).Value = msBabyAccountCo||19602  |            .Cells(11, 15).Value = msBabyAccountCo
19648  |        End If                                    ||19603  |        End If                                    
19649  |        'RAFI対応 END                             ||19604  |        'RAFI対応 END                             
19650  |                                                  ||19605  |                                                  
19651  |        '計算期間                                 ||19606  |        '計算期間                                 
19652  |        .Cells(13, 2).Value = sWord5a             ||19607  |        .Cells(13, 2).Value = sWord5a             
19653  |        '文言の冗長化でピリオド及び、名称を二列右 ||19608  |        '文言の冗長化でピリオド及び、名称を二列右 
19654  |'        .Cells(13, 11).Value = sWord19           ||19609  |'        .Cells(13, 11).Value = sWord19           
19655  |        .Cells(13, 13).Value = sWord19            ||19610  |        .Cells(13, 13).Value = sWord19            
19656  |                                                  ||19611  |                                                  
19657  |        '前回締日・直近締日セット                 ||19612  |        '前回締日・直近締日セット                 
19658  |        dStart = CDate(gstrDateFormat(mstrSettleme||19613  |        dStart = CDate(gstrDateFormat(mstrSettleme
19659  |        dEnd = CDate(gstrDateFormat(mstrNearSettle||19614  |        dEnd = CDate(gstrDateFormat(mstrNearSettle
19660  |        dstrDate = Replace(CStr(dEnd), "/", "")   ||19615  |        dstrDate = Replace(CStr(dEnd), "/", "")   
19661  |        iCalcNum = DateDiff("d", dStart, dEnd) + 1||19616  |        iCalcNum = DateDiff("d", dStart, dEnd) + 1
19662  |                                                  ||19617  |                                                  
19663  |        '年率                                     ||19618  |        '年率                                     
19664  |        .Cells(15, 2).Value = sWord10a            ||19619  |        .Cells(15, 2).Value = sWord10a            
19665  |        '文言の冗長化でピリオド及び、名称を二列右 ||19620  |        '文言の冗長化でピリオド及び、名称を二列右 
19666  |'        .Cells(15, 11).Value = sWord19           ||19621  |'        .Cells(15, 11).Value = sWord19           
19667  |        .Cells(15, 13).Value = sWord19            ||19622  |        .Cells(15, 13).Value = sWord19            
19668  |                                                  ||19623  |                                                  
19669  |        '月末純資産                               ||19624  |        '月末純資産                               
19670  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||19625  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
19671  |        '取得NAV区分が4:日次時価総額平均の場合"Mon||19626  |        '取得NAV区分が4:日次時価総額平均の場合"Mon
19672  |        If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||19627  |        If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
19673  |            .Cells(27, 2).Value = sWord63a        ||19628  |            .Cells(27, 2).Value = sWord63a        
19674  |        Else                                      ||19629  |        Else                                      
19675  |            .Cells(27, 2).Value = sWord6a         ||19630  |            .Cells(27, 2).Value = sWord6a         
19676  |        End If                                    ||19631  |        End If                                    
19677  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||19632  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
19678  |        .Cells(27, 21).Value = sWord19            ||19633  |        .Cells(27, 21).Value = sWord19            
19679  |                                                  ||19634  |                                                  
19680  |        '@@@@@ 合計行を出力しないならここをコメン ||19635  |        '@@@@@ 合計行を出力しないならここをコメン 
19681  |        '合計(純資産)                             ||19636  |        '合計(純資産)                             
19682  |        .Cells(40, 25).Value = sWord9a            ||19637  |        .Cells(40, 25).Value = sWord9a            
19683  |        .Range("X40:AI40").HorizontalAlignment = x||19638  |        .Range("X40:AI40").HorizontalAlignment = x
19684  |                                                  ||19639  |                                                  
19685  |'        '契約区分「1」or「2」or (「3」and 取得NAV||19640  |'        '契約区分「1」or「2」or (「3」and 取得NAV
19686  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||19641  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
19687  |            Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c||19642  |            Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c
19688  |            Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_||19643  |            Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_
19689  |                And gbuMGetUPDRec.N(lRecIdx).MGET_||19644  |                And gbuMGetUPDRec.N(lRecIdx).MGET_
19690  |                                                  ||19645  |                                                  
19691  |'取得NAV区分[1]                                   ||19646  |'取得NAV区分[1]                                   
19692  |            '月末NAV取得                          ||19647  |            '月末NAV取得                          
19693  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g||19648  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g
19694  |                '月次NAVを取得する                ||19649  |                '月次NAVを取得する                
19695  |                Call sbMonthlyNAV_GetNotChgRate(lR||19650  |                Call sbMonthlyNAV_GetNotChgRate(lR
19696  |                                                  ||19651  |                                                  
19697  |                '月次NAVを累積                    ||19652  |                '月次NAVを累積                    
19698  |                For i = LBound(gtypcfr_mnav_tbl) T||19653  |                For i = LBound(gtypcfr_mnav_tbl) T
19699  |                    If Len(gtypcfr_mnav_tbl(i).BAS||19654  |                    If Len(gtypcfr_mnav_tbl(i).BAS
19700  |                        '日付                     ||19655  |                        '日付                     
19701  |                         gtypcfr_mnav_tbl(i).BASE_||19656  |                         gtypcfr_mnav_tbl(i).BASE_
19702  |                        .Cells(27 + i, 25).Value =||19657  |                        .Cells(27 + i, 25).Value =
19703  |                        '純資産                   ||19658  |                        '純資産                   
19704  |                        .Cells(27 + i, 49).NumberF||19659  |                        .Cells(27 + i, 49).NumberF
19705  |                                                  ||19660  |                                                  
19706  |                        If gbuMGetUPDRec.N(lRecIdx||19661  |                        If gbuMGetUPDRec.N(lRecIdx
19707  |                            .Cells(27 + i, 49).Val||19662  |                            .Cells(27 + i, 49).Val
19708  |                        Else                      ||19663  |                        Else                      
19709  |                            .Cells(27 + i, 49).Val||19664  |                            .Cells(27 + i, 49).Val
19710  |                        End If                    ||19665  |                        End If                    
19711  |                        .Cells(27 + i, 49).Horizon||19666  |                        .Cells(27 + i, 49).Horizon
19712  |                                                  ||19667  |                                                  
19713  |                        TotalNav = TotalNav + CCur||19668  |                        TotalNav = TotalNav + CCur
19714  |                        iRowCnt = iRowCnt + 1     ||19669  |                        iRowCnt = iRowCnt + 1     
19715  |                    Else                          ||19670  |                    Else                          
19716  |                        Mnav_Flg = 1              ||19671  |                        Mnav_Flg = 1              
19717  |                    End If                        ||19672  |                    End If                        
19718  |                                                  ||19673  |                                                  
19719  |                Next i                            ||19674  |                Next i                            
19720  |                                                  ||19675  |                                                  
19721  |                '保留★★（1を引く意味がわからない||19676  |                '保留★★（1を引く意味がわからない
19722  |                '日次NAVを算出                    ||19677  |                '日次NAVを算出                    
19723  |'                If Mnav_Flg = 1 Then             ||19678  |'                If Mnav_Flg = 1 Then             
19724  |'                    i = i - 1                    ||19679  |'                    i = i - 1                    
19725  |'                End If                           ||19680  |'                End If                           
19726  |                                                  ||19681  |                                                  
19727  |                If mstrDailyNav <> "" Then        ||19682  |                If mstrDailyNav <> "" Then        
19728  |                    '日付                         ||19683  |                    '日付                         
19729  |                    .Cells(27 + i, 25).NumberForma||19684  |                    .Cells(27 + i, 25).NumberForma
19730  |                    .Cells(27 + i, 25).Value = CSt||19685  |                    .Cells(27 + i, 25).Value = CSt
19731  |                    .Cells(27 + i, 25).HorizontalA||19686  |                    .Cells(27 + i, 25).HorizontalA
19732  |                    '純資産                       ||19687  |                    '純資産                       
19733  |                    .Cells(27 + i, 49).NumberForma||19688  |                    .Cells(27 + i, 49).NumberForma
19734  |                                                  ||19689  |                                                  
19735  |                    If gbuMGetUPDRec.N(lRecIdx).MG||19690  |                    If gbuMGetUPDRec.N(lRecIdx).MG
19736  |                        .Cells(27 + i, 49).Value =||19691  |                        .Cells(27 + i, 49).Value =
19737  |                    Else                          ||19692  |                    Else                          
19738  |                        .Cells(27 + i, 49).Value =||19693  |                        .Cells(27 + i, 49).Value =
19739  |                    End If                        ||19694  |                    End If                        
19740  |                                                  ||19695  |                                                  
19741  |                    .Cells(27 + i, 49).HorizontalA||19696  |                    .Cells(27 + i, 49).HorizontalA
19742  |                    TotalNav = TotalNav + CCur(mst||19697  |                    TotalNav = TotalNav + CCur(mst
19743  |                    iRowCnt = iRowCnt + 1         ||19698  |                    iRowCnt = iRowCnt + 1         
19744  |                                                  ||19699  |                                                  
19745  |                End If                            ||19700  |                End If                            
19746  |                                                  ||19701  |                                                  
19747  |                '@@@@@ 合計行を出力しないならここ ||19702  |                '@@@@@ 合計行を出力しないならここ 
19748  |                .Cells(40, 49).NumberFormatLocal =||19703  |                .Cells(40, 49).NumberFormatLocal =
19749  |                .Cells(40, 49).Value = CStr(Format||19704  |                .Cells(40, 49).Value = CStr(Format
19750  |                                                  ||19705  |                                                  
19751  |                 If gbuMGetUPDRec.N(lRecIdx).MGET_||19706  |                 If gbuMGetUPDRec.N(lRecIdx).MGET_
19752  |                    '@@@@@ 合計行を出力しないなら ||19707  |                    '@@@@@ 合計行を出力しないなら 
19753  |                    .Cells(40, 49).Value = CStr(Fo||19708  |                    .Cells(40, 49).Value = CStr(Fo
19754  |                 Else                             ||19709  |                 Else                             
19755  |                    '合計行を出力しないならここを ||19710  |                    '合計行を出力しないならここを 
19756  |                    .Cells(40, 49).Value = CStr(Fo||19711  |                    .Cells(40, 49).Value = CStr(Fo
19757  |                 End If                           ||19712  |                 End If                           
19758  |                 .Cells(40, 49).HorizontalAlignmen||19713  |                 .Cells(40, 49).HorizontalAlignmen
19759  |                                                  ||19714  |                                                  
19760  |                 '平均純資産総額                  ||19715  |                 '平均純資産総額                  
19761  |                 .Cells(43, 2).Value = sWord51a   ||19716  |                 .Cells(43, 2).Value = sWord51a   
19762  |                 .Cells(43, 16).Value = sWord19   ||19717  |                 .Cells(43, 16).Value = sWord19   
19763  |                                                  ||19718  |                                                  
19764  |                 '計算期間の純資産総額の合計(月末 ||19719  |                 '計算期間の純資産総額の合計(月末 
19765  |                 .Cells(43, 28).NumberFormatLocal ||19720  |                 .Cells(43, 28).NumberFormatLocal 
19766  |                                                  ||19721  |                                                  
19767  |                 If gbuMGetUPDRec.N(lRecIdx).MGET_||19722  |                 If gbuMGetUPDRec.N(lRecIdx).MGET_
19768  |                     .Cells(43, 28).Value = CStr(F||19723  |                     .Cells(43, 28).Value = CStr(F
19769  |                 Else                             ||19724  |                 Else                             
19770  |                     .Cells(43, 28).Value = CStr(F||19725  |                     .Cells(43, 28).Value = CStr(F
19771  |                 End If                           ||19726  |                 End If                           
19772  |                                                  ||19727  |                                                  
19773  |                 .Cells(43, 28).HorizontalAlignmen||19728  |                 .Cells(43, 28).HorizontalAlignmen
19774  |                                                  ||19729  |                                                  
19775  |                 '計算期間の純資産総額の合計÷計算||19730  |                 '計算期間の純資産総額の合計÷計算
19776  |                 .Cells(43, 40).NumberFormatLocal ||19731  |                 .Cells(43, 40).NumberFormatLocal 
19777  |                 dblValueIn = TotalNav / iRowCnt  ||19732  |                 dblValueIn = TotalNav / iRowCnt  
19778  |                                                  ||19733  |                                                  
19779  |                 If gbuMGetUPDRec.N(lRecIdx).MGET_||19734  |                 If gbuMGetUPDRec.N(lRecIdx).MGET_
19780  |                     Call sbGetRoundValue2(dblValu||19735  |                     Call sbGetRoundValue2(dblValu
19781  |                 Else                             ||19736  |                 Else                             
19782  |                     Call sbGetRoundValue(dblValue||19737  |                     Call sbGetRoundValue(dblValue
19783  |                 End If                           ||19738  |                 End If                           
19784  |                                                  ||19739  |                                                  
19785  |                '平均NAV(計算対象NAV)             ||19740  |                '平均NAV(計算対象NAV)             
19786  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||19741  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
19787  |                    .Cells(43, 40).Value = CStr(Fo||19742  |                    .Cells(43, 40).Value = CStr(Fo
19788  |                Else                              ||19743  |                Else                              
19789  |                    .Cells(43, 40).Value = CStr(Fo||19744  |                    .Cells(43, 40).Value = CStr(Fo
19790  |                End If                            ||19745  |                End If                            
19791  |                                                  ||19746  |                                                  
19792  |                '÷??＝                           ||19747  |                '÷??＝                           
19793  |                .Cells(43, 31).Value = sWord18 & "||19748  |                .Cells(43, 31).Value = sWord18 & "
19794  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||19749  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
19795  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_n||19750  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_n
19796  |            '=====================================||19751  |            '=====================================
19797  |            '==                                   ||19752  |            '==                                   
19798  |            '==  '4':日次時価総額平均(休日込)の計 ||19753  |            '==  '4':日次時価総額平均(休日込)の計 
19799  |            '==                                   ||19754  |            '==                                   
19800  |            '=====================================||19755  |            '=====================================
19801  |                ddblTtalnav = 0                   ||19756  |                ddblTtalnav = 0                   
19802  |                For dintFor = 0 To NavGetCnt - 1  ||19757  |                For dintFor = 0 To NavGetCnt - 1  
19803  |                                                  ||19758  |                                                  
19804  |                    '日次時価総額平均取得         ||19759  |                    '日次時価総額平均取得         
19805  |                    sStart = gstrDateFormat2(CStr(||19760  |                    sStart = gstrDateFormat2(CStr(
19806  |                    sEnd = gstrDateFormat2(CStr(dE||19761  |                    sEnd = gstrDateFormat2(CStr(dE
19807  |                                                  ||19762  |                                                  
19808  |                    '計算開始日と外部委託顧問料計 ||19763  |                    '計算開始日と外部委託顧問料計 
19809  |                    If sStart = gbuMGetUPDRec.N(lR||19764  |                    If sStart = gbuMGetUPDRec.N(lR
19810  |                        '== SQL1 ==               ||19765  |                        '== SQL1 ==               
19811  |                        sSql = ""                 ||19766  |                        sSql = ""                 
19812  |                        sSql = sSql & "SELECT EIGY||19767  |                        sSql = sSql & "SELECT EIGY
19813  |                                                  ||19768  |                                                  
19814  |                        'ﾀﾞｲﾅｾｯﾄの作成            ||19769  |                        'ﾀﾞｲﾅｾｯﾄの作成            
19815  |                        If gintDyCreate(sSql) = Fa||19770  |                        If gintDyCreate(sSql) = Fa
19816  |                            Exit Function         ||19771  |                            Exit Function         
19817  |                         Else                     ||19772  |                         Else                     
19818  |                            '休日の場合、翌営業日 ||19773  |                            '休日の場合、翌営業日 
19819  |                            If gvlnDyDataS("EIGYO_||19774  |                            If gvlnDyDataS("EIGYO_
19820  |                                '翌営業日の時価総 ||19775  |                                '翌営業日の時価総 
19821  |                                '== SQL2 ==       ||19776  |                                '== SQL2 ==       
19822  |                                sSql = ""         ||19777  |                                sSql = ""         
19823  |                                sSql = sSql & "SEL||19778  |                                sSql = sSql & "SEL
19824  |                                sSql = sSql & "FRO||19779  |                                sSql = sSql & "FRO
19825  |                                sSql = sSql & "(SE||19780  |                                sSql = sSql & "(SE
19826  |                                sSql = sSql & "WHE||19781  |                                sSql = sSql & "WHE
19827  |                                                  ||19782  |                                                  
19828  |                                'ﾀﾞｲﾅｾｯﾄの作成    ||19783  |                                'ﾀﾞｲﾅｾｯﾄの作成    
19829  |                                If gintDyCreate(sS||19784  |                                If gintDyCreate(sS
19830  |                                    Exit Function ||19785  |                                    Exit Function 
19831  |                                Else              ||19786  |                                Else              
19832  |                                    ddblNearNav = ||19787  |                                    ddblNearNav = 
19833  |'2008/03/06 START 時価総額基準の外部委託顧問料対応||19788  |'2008/03/06 START 時価総額基準の外部委託顧問料対応
19834  |'                                    '翌営業日の計||19789  |'                                    '翌営業日の計
19835  |'                                    '== SQL3 ==  ||19790  |'                                    '== SQL3 ==  
19836  |'                                    sSql = ""    ||19791  |'                                    sSql = ""    
19837  |'                                    sSql = sSql &||19792  |'                                    sSql = sSql &
19838  |'                                    sSql = sSql &||19793  |'                                    sSql = sSql &
19839  |'                                    sSql = sSql &||19794  |'                                    sSql = sSql &
19840  |'                                    sSql = sSql &||19795  |'                                    sSql = sSql &
19841  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||19796  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
19842  |'                                    If gintDyCrea||19797  |'                                    If gintDyCrea
19843  |'                                        Exit Func||19798  |'                                        Exit Func
19844  |'                                     Else        ||19799  |'                                     Else        
19845  |'                                        '計算開始||19800  |'                                        '計算開始
19846  |'                                        sStart = ||19801  |'                                        sStart = 
19847  |'                                        dStart = ||19802  |'                                        dStart = 
19848  |'                                        '文言の冗||19803  |'                                        '文言の冗
19849  |''                                        .Cells(1||19804  |''                                        .Cells(1
19850  |''                                            CStr||19805  |''                                            CStr
19851  |'                                        .Cells(16||19806  |'                                        .Cells(16
19852  |'                                            CStr(||19807  |'                                            CStr(
19853  |'                                        iCalcNum ||19808  |'                                        iCalcNum 
19854  |'                                    End If       ||19809  |'                                    End If       
19855  |'2008/03/06 END   時価総額基準の外部委託顧問料対応||19810  |'2008/03/06 END   時価総額基準の外部委託顧問料対応
19856  |                                End If            ||19811  |                                End If            
19857  |                                'RAFI対応 START   ||19812  |                                'RAFI対応 START   
19858  |                                '翌営業日のマザー ||19813  |                                '翌営業日のマザー 
19859  |                                If msAssetFlg = "1||19814  |                                If msAssetFlg = "1
19860  |                                    '== SQL4 ==   ||19815  |                                    '== SQL4 ==   
19861  |                                    sSql = ""     ||19816  |                                    sSql = ""     
19862  |                                    sSql = sSql & ||19817  |                                    sSql = sSql & 
19863  |                                    sSql = sSql & ||19818  |                                    sSql = sSql & 
19864  |                                    sSql = sSql & ||19819  |                                    sSql = sSql & 
19865  |                                    sSql = sSql & ||19820  |                                    sSql = sSql & 
19866  |                                    sSql = sSql & ||19821  |                                    sSql = sSql & 
19867  |                                    sSql = sSql & ||19822  |                                    sSql = sSql & 
19868  |                                    sSql = sSql & ||19823  |                                    sSql = sSql & 
19869  |                                    sSql = sSql & ||19824  |                                    sSql = sSql & 
19870  |                                    sSql = sSql & ||19825  |                                    sSql = sSql & 
19871  |                                    sSql = sSql & ||19826  |                                    sSql = sSql & 
19872  |                                    sSql = sSql & ||19827  |                                    sSql = sSql & 
19873  |                                    sSql = sSql & ||19828  |                                    sSql = sSql & 
19874  |                                    sSql = sSql & ||19829  |                                    sSql = sSql & 
19875  |                                    sSql = sSql & ||19830  |                                    sSql = sSql & 
19876  |                                    sSql = sSql & ||19831  |                                    sSql = sSql & 
19877  |                                    sSql = sSql & ||19832  |                                    sSql = sSql & 
19878  |                                    sSql = sSql & ||19833  |                                    sSql = sSql & 
19879  |                                    sSql = sSql & ||19834  |                                    sSql = sSql & 
19880  |                                    sSql = sSql & ||19835  |                                    sSql = sSql & 
19881  |                                    sSql = sSql & ||19836  |                                    sSql = sSql & 
19882  |                                    sSql = sSql & ||19837  |                                    sSql = sSql & 
19883  |                                    sSql = sSql & ||19838  |                                    sSql = sSql & 
19884  |                                    sSql = sSql & ||19839  |                                    sSql = sSql & 
19885  |                                    sSql = sSql & ||19840  |                                    sSql = sSql & 
19886  |                                    'ﾀﾞｲﾅｾｯﾄの作成||19841  |                                    'ﾀﾞｲﾅｾｯﾄの作成
19887  |                                                  ||19842  |                                                  
19888  |                                    If gintDyCreat||19843  |                                    If gintDyCreat
19889  |                                        Exit Funct||19844  |                                        Exit Funct
19890  |                                    Else          ||19845  |                                    Else          
19891  |                                        ddblNearBa||19846  |                                        ddblNearBa
19892  |                                    End If        ||19847  |                                    End If        
19893  |                                End If            ||19848  |                                End If            
19894  |                                'RAFI対応 END     ||19849  |                                'RAFI対応 END     
19895  |                            End If                ||19850  |                            End If                
19896  |                        End If                    ||19851  |                        End If                    
19897  |                    End If                        ||19852  |                    End If                        
19898  |                    '== SQL5 ==                   ||19853  |                    '== SQL5 ==                   
19899  |                    sSql = ""                     ||19854  |                    sSql = ""                     
19900  |                    sSql = sSql & "SELECT CAL_YYYY||19855  |                    sSql = sSql & "SELECT CAL_YYYY
19901  |                    sSql = sSql & "WHERE CAL_YYYY ||19856  |                    sSql = sSql & "WHERE CAL_YYYY 
19902  |                                                  ||19857  |                                                  
19903  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||19858  |                    'ﾀﾞｲﾅｾｯﾄの作成                
19904  |                    If gintDyCreate(sSql) = False ||19859  |                    If gintDyCreate(sSql) = False 
19905  |                        Exit Function             ||19860  |                        Exit Function             
19906  |                    End If                        ||19861  |                    End If                        
19907  |                                                  ||19862  |                                                  
19908  |                    If dlngCnt = 0 Then           ||19863  |                    If dlngCnt = 0 Then           
19909  |                        ReDim dstrCaldate(gbxOraDy||19864  |                        ReDim dstrCaldate(gbxOraDy
19910  |                        ReDim ddblDailynav(gbxOraD||19865  |                        ReDim ddblDailynav(gbxOraD
19911  |                    End If                        ||19866  |                    End If                        
19912  |                                                  ||19867  |                                                  
19913  |                    'EOF判定処理                  ||19868  |                    'EOF判定処理                  
19914  |                    dlngCnt = 0                   ||19869  |                    dlngCnt = 0                   
19915  |                                                  ||19870  |                                                  
19916  |                    Do Until gblnDyEOF()          ||19871  |                    Do Until gblnDyEOF()          
19917  |                        dlngCnt = dlngCnt + 1     ||19872  |                        dlngCnt = dlngCnt + 1     
19918  |                        '抽出データセット         ||19873  |                        '抽出データセット         
19919  |                        dstrCaldate(dlngCnt) = gvl||19874  |                        dstrCaldate(dlngCnt) = gvl
19920  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||19875  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
19921  |                        Call gDyNext              ||19876  |                        Call gDyNext              
19922  |                    Loop                          ||19877  |                    Loop                          
19923  |                                                  ||19878  |                                                  
19924  |                    '2005/08/26　START            ||19879  |                    '2005/08/26　START            
19925  |                    '変数sStartに格納されている日 ||19880  |                    '変数sStartに格納されている日 
19926  |                    '変数sStartの直近の営業日の日 ||19881  |                    '変数sStartの直近の営業日の日 
19927  |                    '（変数sStartに格納されている ||19882  |                    '（変数sStartに格納されている 
19928  |                    '　直近日付が存在しない場合は ||19883  |                    '　直近日付が存在しない場合は 
19929  |                                                  ||19884  |                                                  
19930  |                    '== SQL6 ==                   ||19885  |                    '== SQL6 ==                   
19931  |                    sSql = ""                     ||19886  |                    sSql = ""                     
19932  |                    sSql = sSql & "SELECT MAX(BASE||19887  |                    sSql = sSql & "SELECT MAX(BASE
19933  |                    sSql = sSql & "FROM   CFR_DAIL||19888  |                    sSql = sSql & "FROM   CFR_DAIL
19934  |                    sSql = sSql & "WHERE  BASE_DAT||19889  |                    sSql = sSql & "WHERE  BASE_DAT
19935  |                    sSql = sSql & "AND    ACCOUNT_||19890  |                    sSql = sSql & "AND    ACCOUNT_
19936  |                                                  ||19891  |                                                  
19937  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||19892  |                    'ﾀﾞｲﾅｾｯﾄの作成                
19938  |                    If gintDyCreate(sSql) = False ||19893  |                    If gintDyCreate(sSql) = False 
19939  |                        Exit Function             ||19894  |                        Exit Function             
19940  |                    End If                        ||19895  |                    End If                        
19941  |                                                  ||19896  |                                                  
19942  |                    Do Until gblnDyEOF()          ||19897  |                    Do Until gblnDyEOF()          
19943  |                       '抽出データセット          ||19898  |                       '抽出データセット          
19944  |                        sStart = gvlnDyDataS("BASE||19899  |                        sStart = gvlnDyDataS("BASE
19945  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||19900  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
19946  |                        Call gDyNext              ||19901  |                        Call gDyNext              
19947  |                    Loop                          ||19902  |                    Loop                          
19948  |                                                  ||19903  |                                                  
19949  |                    '2005/08/26　END              ||19904  |                    '2005/08/26　END              
19950  |                    'RAFI対応 START               ||19905  |                    'RAFI対応 START               
19951  |                    '純資産の場合                 ||19906  |                    '純資産の場合                 
19952  |                    If msAssetFlg = "0" Then      ||19907  |                    If msAssetFlg = "0" Then      
19953  |                        '計算開始日から計算終了日 ||19908  |                        '計算開始日から計算終了日 
19954  |                        '== SQL7 ==               ||19909  |                        '== SQL7 ==               
19955  |                        sSql = ""                 ||19910  |                        sSql = ""                 
19956  |                        sSql = sSql & "SELECT ACCO||19911  |                        sSql = sSql & "SELECT ACCO
19957  |                        sSql = sSql & "WHERE CFR_D||19912  |                        sSql = sSql & "WHERE CFR_D
19958  |                        sSql = sSql & "AND   (CFR_||19913  |                        sSql = sSql & "AND   (CFR_
19959  |                        sSql = sSql & "ORDER BY CF||19914  |                        sSql = sSql & "ORDER BY CF
19960  |                    'マザー組入資産の場合         ||19915  |                    'マザー組入資産の場合         
19961  |                    Else                          ||19916  |                    Else                          
19962  |                        '計算開始日から計算終了日 ||19917  |                        '計算開始日から計算終了日 
19963  |                        '== SQL8 ==               ||19918  |                        '== SQL8 ==               
19964  |                        sSql = ""                 ||19919  |                        sSql = ""                 
19965  |                        sSql = sSql & "SELECT"    ||19920  |                        sSql = sSql & "SELECT"    
19966  |                        sSql = sSql & "    a.ACCOU||19921  |                        sSql = sSql & "    a.ACCOU
19967  |                        sSql = sSql & "    a.BASE_||19922  |                        sSql = sSql & "    a.BASE_
19968  |                        sSql = sSql & "    a.MARKE||19923  |                        sSql = sSql & "    a.MARKE
19969  |                        sSql = sSql & "    b.BABY_||19924  |                        sSql = sSql & "    b.BABY_
19970  |                        sSql = sSql & "    b.BABY_||19925  |                        sSql = sSql & "    b.BABY_
19971  |                        sSql = sSql & " FROM"     ||19926  |                        sSql = sSql & " FROM"     
19972  |                        sSql = sSql & "    CFR_DAI||19927  |                        sSql = sSql & "    CFR_DAI
19973  |                        sSql = sSql & " WHERE"    ||19928  |                        sSql = sSql & " WHERE"    
19974  |                        sSql = sSql & "    b.BABY_||19929  |                        sSql = sSql & "    b.BABY_
19975  |                        sSql = sSql & "    b.MOTHE||19930  |                        sSql = sSql & "    b.MOTHE
19976  |                        sSql = sSql & "    b.BASE_||19931  |                        sSql = sSql & "    b.BASE_
19977  |                        sSql = sSql & "    a.ACCOU||19932  |                        sSql = sSql & "    a.ACCOU
19978  |                        sSql = sSql & "    (a.BASE||19933  |                        sSql = sSql & "    (a.BASE
19979  |                        sSql = sSql & "    a.BASE_||19934  |                        sSql = sSql & "    a.BASE_
19980  |                        sSql = sSql & " ORDER BY" ||19935  |                        sSql = sSql & " ORDER BY" 
19981  |                        sSql = sSql & "    a.BASE_||19936  |                        sSql = sSql & "    a.BASE_
19982  |                    End If                        ||19937  |                    End If                        
19983  |                    'RAFI対応 END                 ||19938  |                    'RAFI対応 END                 
19984  |                                                  ||19939  |                                                  
19985  |                    If gintDyCreate(sSql) = False ||19940  |                    If gintDyCreate(sSql) = False 
19986  |                        Exit Function             ||19941  |                        Exit Function             
19987  |                    End If                        ||19942  |                    End If                        
19988  |                                                  ||19943  |                                                  
19989  |                    dlngCntsv = dlngCnt           ||19944  |                    dlngCntsv = dlngCnt           
19990  |                    dlngCnt = 0                   ||19945  |                    dlngCnt = 0                   
19991  |                                                  ||19946  |                                                  
19992  |                    Do Until gblnDyEOF()          ||19947  |                    Do Until gblnDyEOF()          
19993  |                        dlngCnt = dlngCnt + 1     ||19948  |                        dlngCnt = dlngCnt + 1     
19994  |                        '抽出データセット         ||19949  |                        '抽出データセット         
19995  |                        dstrBasedate = gvlnDyDataS||19950  |                        dstrBasedate = gvlnDyDataS
19996  |                        If Mid(dstrCaldate(dlngCnt||19951  |                        If Mid(dstrCaldate(dlngCnt
19997  |                            'RAFI対応 START       ||19952  |                            'RAFI対応 START       
19998  |                            '純資産の場合         ||19953  |                            '純資産の場合         
19999  |                            If msAssetFlg = "0" Th||19954  |                            If msAssetFlg = "0" Th
20000  |                                ddblDailynav(dlngC||19955  |                                ddblDailynav(dlngC
20001  |                            'マザー組入資産の場合 ||19956  |                            'マザー組入資産の場合 
20002  |                            Else                  ||19957  |                            Else                  
20003  |                                ddblDailynav(dlngC||19958  |                                ddblDailynav(dlngC
20004  |                            End If                ||19959  |                            End If                
20005  |                            'RAFI対応 END         ||19960  |                            'RAFI対応 END         
20006  |                        Else                      ||19961  |                        Else                      
20007  |                            '計算開始日が外部委託 ||19962  |                            '計算開始日が外部委託 
20008  |                            If ddblNearNav <> 0 _ ||19963  |                            If ddblNearNav <> 0 _ 
20009  |                            And dlngCnt = 1 Then  ||19964  |                            And dlngCnt = 1 Then  
20010  |                                dstrCaldate2 = Mid||19965  |                                dstrCaldate2 = Mid
20011  |                                dstrBasedate2 = Mi||19966  |                                dstrBasedate2 = Mi
20012  |                                dlngDiffdate = Dat||19967  |                                dlngDiffdate = Dat
20013  |                                                  ||19968  |                                                  
20014  |                                For dintFor2 = 1 T||19969  |                                For dintFor2 = 1 T
20015  |                                    'RAFI対応 STAR||19970  |                                    'RAFI対応 STAR
20016  |                                    '純資産の場合 ||19971  |                                    '純資産の場合 
20017  |                                    If msAssetFlg ||19972  |                                    If msAssetFlg 
20018  |                                        ddblDailyn||19973  |                                        ddblDailyn
20019  |                                    'マザー組入資 ||19974  |                                    'マザー組入資 
20020  |                                    Else          ||19975  |                                    Else          
20021  |                                        ddblDailyn||19976  |                                        ddblDailyn
20022  |                                    End If        ||19977  |                                    End If        
20023  |                                    'RAFI対応 END ||19978  |                                    'RAFI対応 END 
20024  |                                    dlngCnt = dlng||19979  |                                    dlngCnt = dlng
20025  |                                Next dintFor2     ||19980  |                                Next dintFor2     
20026  |                                '純資産の場合     ||19981  |                                '純資産の場合     
20027  |                                If msAssetFlg = "0||19982  |                                If msAssetFlg = "0
20028  |                                    ddblDailynav(d||19983  |                                    ddblDailynav(d
20029  |                                'マザー組入資産の ||19984  |                                'マザー組入資産の 
20030  |                                Else              ||19985  |                                Else              
20031  |                                    ddblDailynav(d||19986  |                                    ddblDailynav(d
20032  |                                End If            ||19987  |                                End If            
20033  |                                'RAFI対応 END     ||19988  |                                'RAFI対応 END     
20034  |                            Else                  ||19989  |                            Else                  
20035  |                                '日次時価総額にデ ||19990  |                                '日次時価総額にデ 
20036  |                                dstrCaldate2 = Mid||19991  |                                dstrCaldate2 = Mid
20037  |                                dstrBasedate2 = Mi||19992  |                                dstrBasedate2 = Mi
20038  |                                dlngDiffdate = Dat||19993  |                                dlngDiffdate = Dat
20039  |                                                  ||19994  |                                                  
20040  |                                For dintFor2 = 1 T||19995  |                                For dintFor2 = 1 T
20041  |                                    If ddblDailyna||19996  |                                    If ddblDailyna
20042  |                                        ddblDailyn||19997  |                                        ddblDailyn
20043  |                                    Else          ||19998  |                                    Else          
20044  |                                        '日次時価 ||19999  |                                        '日次時価 
20045  |                                        intRtn = M||20000  |                                        intRtn = M
20046  |                                        vbLf & "対||20001  |                                        vbLf & "対
20047  |                                        vbLf & "基||20002  |                                        vbLf & "基
20048  |                                            vbCrit||20003  |                                            vbCrit
20049  |                                        Exit Funct||20004  |                                        Exit Funct
20050  |                                    End If        ||20005  |                                    End If        
20051  |                                    dlngCnt = dlng||20006  |                                    dlngCnt = dlng
20052  |                                Next dintFor2     ||20007  |                                Next dintFor2     
20053  |                                'RAFI対応 START   ||20008  |                                'RAFI対応 START   
20054  |                                '純資産の場合     ||20009  |                                '純資産の場合     
20055  |                                If msAssetFlg = "0||20010  |                                If msAssetFlg = "0
20056  |                                    ddblDailynav(d||20011  |                                    ddblDailynav(d
20057  |                                'マザー組入資産の ||20012  |                                'マザー組入資産の 
20058  |                                Else              ||20013  |                                Else              
20059  |                                    ddblDailynav(d||20014  |                                    ddblDailynav(d
20060  |                                End If            ||20015  |                                End If            
20061  |                                'RAFI対応 END     ||20016  |                                'RAFI対応 END     
20062  |                            End If                ||20017  |                            End If                
20063  |                                                  ||20018  |                                                  
20064  |                        End If                    ||20019  |                        End If                    
20065  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||20020  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
20066  |                        Call gDyNext              ||20021  |                        Call gDyNext              
20067  |                    Loop                          ||20022  |                    Loop                          
20068  |                                                  ||20023  |                                                  
20069  |                Next dintFor                      ||20024  |                Next dintFor                      
20070  |                                                  ||20025  |                                                  
20071  |                If dlngCntsv <> dlngCnt Then      ||20026  |                If dlngCntsv <> dlngCnt Then      
20072  |                    For dintFor2 = dlngCnt + 1 To ||20027  |                    For dintFor2 = dlngCnt + 1 To 
20073  |                        ddblDailynav(dintFor2) = d||20028  |                        ddblDailynav(dintFor2) = d
20074  |                    Next dintFor2                 ||20029  |                    Next dintFor2                 
20075  |                    dlngCnt = dlngCntsv           ||20030  |                    dlngCnt = dlngCntsv           
20076  |                End If                            ||20031  |                End If                            
20077  |                                                  ||20032  |                                                  
20078  |                ddblTtalnav = 0                   ||20033  |                ddblTtalnav = 0                   
20079  |                                                  ||20034  |                                                  
20080  |                For dintFor2 = 1 To dlngCnt       ||20035  |                For dintFor2 = 1 To dlngCnt       
20081  |                    ddblTtalnav = ddblTtalnav + dd||20036  |                    ddblTtalnav = ddblTtalnav + dd
20082  |                Next dintFor2                     ||20037  |                Next dintFor2                     
20083  |                                                  ||20038  |                                                  
20084  |                iRowCnt = dlngCnt                 ||20039  |                iRowCnt = dlngCnt                 
20085  |                TotalNav = ddblTtalnav            ||20040  |                TotalNav = ddblTtalnav            
20086  |                dblValueIn = TotalNav             ||20041  |                dblValueIn = TotalNav             
20087  |                Call sbGetRoundValue2(dblValueIn) ||20042  |                Call sbGetRoundValue2(dblValueIn) 
20088  |                TotalNav = dblValueOut            ||20043  |                TotalNav = dblValueOut            
20089  |                                                  ||20044  |                                                  
20090  |                '平均純資産総額                   ||20045  |                '平均純資産総額                   
20091  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||20046  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
20092  |                '取得NAV区分が4:日次時価総額平均の||20047  |                '取得NAV区分が4:日次時価総額平均の
20093  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||20048  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
20094  |                    .Cells(43, 2).Value = sWord70a||20049  |                    .Cells(43, 2).Value = sWord70a
20095  |                Else                              ||20050  |                Else                              
20096  |                    .Cells(43, 2).Value = sWord51a||20051  |                    .Cells(43, 2).Value = sWord51a
20097  |                End If                            ||20052  |                End If                            
20098  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||20053  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
20099  |                .Cells(43, 16).Value = sWord19    ||20054  |                .Cells(43, 16).Value = sWord19    
20100  |                                                  ||20055  |                                                  
20101  |                '計算期間の純資産総額の合計(月末純||20056  |                '計算期間の純資産総額の合計(月末純
20102  |                .Cells(43, 28).NumberFormatLocal =||20057  |                .Cells(43, 28).NumberFormatLocal =
20103  |                .Cells(43, 28).Value = CStr(Format||20058  |                .Cells(43, 28).Value = CStr(Format
20104  |                .Cells(43, 28).HorizontalAlignment||20059  |                .Cells(43, 28).HorizontalAlignment
20105  |                                                  ||20060  |                                                  
20106  |                '計算期間の純資産総額の合計÷計算 ||20061  |                '計算期間の純資産総額の合計÷計算 
20107  |                .Cells(43, 40).NumberFormatLocal =||20062  |                .Cells(43, 40).NumberFormatLocal =
20108  |                dblValueIn = TotalNav / iRowCnt   ||20063  |                dblValueIn = TotalNav / iRowCnt   
20109  |                Call sbGetRoundValue(dblValueIn)  ||20064  |                Call sbGetRoundValue(dblValueIn)  
20110  |                                                  ||20065  |                                                  
20111  |                .Cells(43, 40).Value = CStr(Format||20066  |                .Cells(43, 40).Value = CStr(Format
20112  |                AvgNav = dblValueOut              ||20067  |                AvgNav = dblValueOut              
20113  |                                                  ||20068  |                                                  
20114  |                '÷??＝                           ||20069  |                '÷??＝                           
20115  |                .Cells(43, 31).Value = sWord18 & "||20070  |                .Cells(43, 31).Value = sWord18 & "
20116  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||20071  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
20117  |                                                  ||20072  |                                                  
20118  |'取得NAV区分[1]以外(取得NAV区分='2')              ||20073  |'取得NAV区分[1]以外(取得NAV区分='2')              
20119  |            Else                                  ||20074  |            Else                                  
20120  |                ddblTtalnav = 0                   ||20075  |                ddblTtalnav = 0                   
20121  |                For dintFor = 0 To NavGetCnt - 1  ||20076  |                For dintFor = 0 To NavGetCnt - 1  
20122  |                                                  ||20077  |                                                  
20123  |                    '日次NAV平均取得              ||20078  |                    '日次NAV平均取得              
20124  |                    sStart = gstrDateFormat2(CStr(||20079  |                    sStart = gstrDateFormat2(CStr(
20125  |                    sEnd = gstrDateFormat2(CStr(dE||20080  |                    sEnd = gstrDateFormat2(CStr(dE
20126  |                                                  ||20081  |                                                  
20127  |                    '計算開始日と外部委託顧問料計 ||20082  |                    '計算開始日と外部委託顧問料計 
20128  |                    If sStart = gbuMGetUPDRec.N(lR||20083  |                    If sStart = gbuMGetUPDRec.N(lR
20129  |                        '== SQL1 ==               ||20084  |                        '== SQL1 ==               
20130  |                        sSql = ""                 ||20085  |                        sSql = ""                 
20131  |                        sSql = sSql & "SELECT EIGY||20086  |                        sSql = sSql & "SELECT EIGY
20132  |                                                  ||20087  |                                                  
20133  |                        'ﾀﾞｲﾅｾｯﾄの作成            ||20088  |                        'ﾀﾞｲﾅｾｯﾄの作成            
20134  |                        If gintDyCreate(sSql) = Fa||20089  |                        If gintDyCreate(sSql) = Fa
20135  |                            Exit Function         ||20090  |                            Exit Function         
20136  |                         Else                     ||20091  |                         Else                     
20137  |                            '休日の場合、翌営業日 ||20092  |                            '休日の場合、翌営業日 
20138  |                            If gvlnDyDataS("EIGYO_||20093  |                            If gvlnDyDataS("EIGYO_
20139  |                                '翌営業日のNAVを取||20094  |                                '翌営業日のNAVを取
20140  |                                '== SQL2 ==       ||20095  |                                '== SQL2 ==       
20141  |                                sSql = ""         ||20096  |                                sSql = ""         
20142  |                                sSql = sSql & "SEL||20097  |                                sSql = sSql & "SEL
20143  |                                sSql = sSql & "FRO||20098  |                                sSql = sSql & "FRO
20144  |                                sSql = sSql & "(SE||20099  |                                sSql = sSql & "(SE
20145  |                                sSql = sSql & "WHE||20100  |                                sSql = sSql & "WHE
20146  |                                                  ||20101  |                                                  
20147  |                                'ﾀﾞｲﾅｾｯﾄの作成    ||20102  |                                'ﾀﾞｲﾅｾｯﾄの作成    
20148  |                                If gintDyCreate(sS||20103  |                                If gintDyCreate(sS
20149  |                                    Exit Function ||20104  |                                    Exit Function 
20150  |                                Else              ||20105  |                                Else              
20151  |                                    ddblNearNav = ||20106  |                                    ddblNearNav = 
20152  |'2008/03/06 START 時価総額基準の外部委託顧問料対応||20107  |'2008/03/06 START 時価総額基準の外部委託顧問料対応
20153  |'                                    '翌営業日の計||20108  |'                                    '翌営業日の計
20154  |'                                    '== SQL3 ==  ||20109  |'                                    '== SQL3 ==  
20155  |'                                    sSql = ""    ||20110  |'                                    sSql = ""    
20156  |'                                    sSql = sSql &||20111  |'                                    sSql = sSql &
20157  |'                                    sSql = sSql &||20112  |'                                    sSql = sSql &
20158  |'                                    sSql = sSql &||20113  |'                                    sSql = sSql &
20159  |'                                    sSql = sSql &||20114  |'                                    sSql = sSql &
20160  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||20115  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
20161  |'                                    If gintDyCrea||20116  |'                                    If gintDyCrea
20162  |'                                        Exit Func||20117  |'                                        Exit Func
20163  |'                                     Else        ||20118  |'                                     Else        
20164  |'                                        '計算開始||20119  |'                                        '計算開始
20165  |'                                        sStart = ||20120  |'                                        sStart = 
20166  |'                                        dStart = ||20121  |'                                        dStart = 
20167  |'                                        '文言の冗||20122  |'                                        '文言の冗
20168  |''                                        .Cells(1||20123  |''                                        .Cells(1
20169  |''                                            CStr||20124  |''                                            CStr
20170  |'                                        .Cells(16||20125  |'                                        .Cells(16
20171  |'                                            CStr(||20126  |'                                            CStr(
20172  |'                                        iCalcNum ||20127  |'                                        iCalcNum 
20173  |'                                    End If       ||20128  |'                                    End If       
20174  |'2008/03/06 END   時価総額基準の外部委託顧問料対応||20129  |'2008/03/06 END   時価総額基準の外部委託顧問料対応
20175  |                                End If            ||20130  |                                End If            
20176  |                                'RAFI対応 START   ||20131  |                                'RAFI対応 START   
20177  |                                '翌営業日のマザー ||20132  |                                '翌営業日のマザー 
20178  |                                If msAssetFlg = "1||20133  |                                If msAssetFlg = "1
20179  |                                    '== SQL4 ==   ||20134  |                                    '== SQL4 ==   
20180  |                                    sSql = ""     ||20135  |                                    sSql = ""     
20181  |                                    sSql = sSql & ||20136  |                                    sSql = sSql & 
20182  |                                    sSql = sSql & ||20137  |                                    sSql = sSql & 
20183  |                                    sSql = sSql & ||20138  |                                    sSql = sSql & 
20184  |                                    sSql = sSql & ||20139  |                                    sSql = sSql & 
20185  |                                    sSql = sSql & ||20140  |                                    sSql = sSql & 
20186  |                                    sSql = sSql & ||20141  |                                    sSql = sSql & 
20187  |                                    sSql = sSql & ||20142  |                                    sSql = sSql & 
20188  |                                    sSql = sSql & ||20143  |                                    sSql = sSql & 
20189  |                                    sSql = sSql & ||20144  |                                    sSql = sSql & 
20190  |                                    sSql = sSql & ||20145  |                                    sSql = sSql & 
20191  |                                    sSql = sSql & ||20146  |                                    sSql = sSql & 
20192  |                                    sSql = sSql & ||20147  |                                    sSql = sSql & 
20193  |                                    sSql = sSql & ||20148  |                                    sSql = sSql & 
20194  |                                    sSql = sSql & ||20149  |                                    sSql = sSql & 
20195  |                                    sSql = sSql & ||20150  |                                    sSql = sSql & 
20196  |                                    sSql = sSql & ||20151  |                                    sSql = sSql & 
20197  |                                    sSql = sSql & ||20152  |                                    sSql = sSql & 
20198  |                                    sSql = sSql & ||20153  |                                    sSql = sSql & 
20199  |                                    sSql = sSql & ||20154  |                                    sSql = sSql & 
20200  |                                    sSql = sSql & ||20155  |                                    sSql = sSql & 
20201  |                                    sSql = sSql & ||20156  |                                    sSql = sSql & 
20202  |                                    sSql = sSql & ||20157  |                                    sSql = sSql & 
20203  |                                    sSql = sSql & ||20158  |                                    sSql = sSql & 
20204  |                                    sSql = sSql & ||20159  |                                    sSql = sSql & 
20205  |                                    'ﾀﾞｲﾅｾｯﾄの作成||20160  |                                    'ﾀﾞｲﾅｾｯﾄの作成
20206  |                                                  ||20161  |                                                  
20207  |                                    If gintDyCreat||20162  |                                    If gintDyCreat
20208  |                                        Exit Funct||20163  |                                        Exit Funct
20209  |                                    Else          ||20164  |                                    Else          
20210  |                                        ddblNearBa||20165  |                                        ddblNearBa
20211  |                                    End If        ||20166  |                                    End If        
20212  |                                End If            ||20167  |                                End If            
20213  |                                'RAFI対応 END     ||20168  |                                'RAFI対応 END     
20214  |                            End If                ||20169  |                            End If                
20215  |                        End If                    ||20170  |                        End If                    
20216  |                    End If                        ||20171  |                    End If                        
20217  |                    '== SQL5 ==                   ||20172  |                    '== SQL5 ==                   
20218  |                    sSql = ""                     ||20173  |                    sSql = ""                     
20219  |                    sSql = sSql & "SELECT CAL_YYYY||20174  |                    sSql = sSql & "SELECT CAL_YYYY
20220  |                    sSql = sSql & "WHERE CAL_YYYY ||20175  |                    sSql = sSql & "WHERE CAL_YYYY 
20221  |                                                  ||20176  |                                                  
20222  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||20177  |                    'ﾀﾞｲﾅｾｯﾄの作成                
20223  |                    If gintDyCreate(sSql) = False ||20178  |                    If gintDyCreate(sSql) = False 
20224  |                        Exit Function             ||20179  |                        Exit Function             
20225  |                    End If                        ||20180  |                    End If                        
20226  |                                                  ||20181  |                                                  
20227  |                    If dlngCnt = 0 Then           ||20182  |                    If dlngCnt = 0 Then           
20228  |                        ReDim dstrCaldate(gbxOraDy||20183  |                        ReDim dstrCaldate(gbxOraDy
20229  |                        ReDim ddblDailynav(gbxOraD||20184  |                        ReDim ddblDailynav(gbxOraD
20230  |                    End If                        ||20185  |                    End If                        
20231  |                                                  ||20186  |                                                  
20232  |                    'EOF判定処理                  ||20187  |                    'EOF判定処理                  
20233  |                    dlngCnt = 0                   ||20188  |                    dlngCnt = 0                   
20234  |                                                  ||20189  |                                                  
20235  |                    Do Until gblnDyEOF()          ||20190  |                    Do Until gblnDyEOF()          
20236  |                        dlngCnt = dlngCnt + 1     ||20191  |                        dlngCnt = dlngCnt + 1     
20237  |                        '抽出データセット         ||20192  |                        '抽出データセット         
20238  |                        dstrCaldate(dlngCnt) = gvl||20193  |                        dstrCaldate(dlngCnt) = gvl
20239  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||20194  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
20240  |                        Call gDyNext              ||20195  |                        Call gDyNext              
20241  |                    Loop                          ||20196  |                    Loop                          
20242  |                                                  ||20197  |                                                  
20243  |                    '2005/08/26　START            ||20198  |                    '2005/08/26　START            
20244  |                    '変数sStartに格納されている日 ||20199  |                    '変数sStartに格納されている日 
20245  |                    '変数sStartの直近の営業日の日 ||20200  |                    '変数sStartの直近の営業日の日 
20246  |                    '（変数sStartに格納されている ||20201  |                    '（変数sStartに格納されている 
20247  |                    '　直近日付が存在しない場合は ||20202  |                    '　直近日付が存在しない場合は 
20248  |                                                  ||20203  |                                                  
20249  |                    '== SQL6 ==                   ||20204  |                    '== SQL6 ==                   
20250  |                    sSql = ""                     ||20205  |                    sSql = ""                     
20251  |                    sSql = sSql & "SELECT MAX(BASE||20206  |                    sSql = sSql & "SELECT MAX(BASE
20252  |                    sSql = sSql & "FROM   CFR_DAIL||20207  |                    sSql = sSql & "FROM   CFR_DAIL
20253  |                    sSql = sSql & "WHERE  BASE_DAT||20208  |                    sSql = sSql & "WHERE  BASE_DAT
20254  |                    sSql = sSql & "AND    ACCOUNT_||20209  |                    sSql = sSql & "AND    ACCOUNT_
20255  |                                                  ||20210  |                                                  
20256  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||20211  |                    'ﾀﾞｲﾅｾｯﾄの作成                
20257  |                    If gintDyCreate(sSql) = False ||20212  |                    If gintDyCreate(sSql) = False 
20258  |                        Exit Function             ||20213  |                        Exit Function             
20259  |                    End If                        ||20214  |                    End If                        
20260  |                                                  ||20215  |                                                  
20261  |                    Do Until gblnDyEOF()          ||20216  |                    Do Until gblnDyEOF()          
20262  |                       '抽出データセット          ||20217  |                       '抽出データセット          
20263  |                        sStart = gvlnDyDataS("BASE||20218  |                        sStart = gvlnDyDataS("BASE
20264  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||20219  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
20265  |                        Call gDyNext              ||20220  |                        Call gDyNext              
20266  |                    Loop                          ||20221  |                    Loop                          
20267  |                                                  ||20222  |                                                  
20268  |                    '2005/08/26　END              ||20223  |                    '2005/08/26　END              
20269  |                    'RAFI対応 START               ||20224  |                    'RAFI対応 START               
20270  |                    '純資産の場合                 ||20225  |                    '純資産の場合                 
20271  |                    If msAssetFlg = "0" Then      ||20226  |                    If msAssetFlg = "0" Then      
20272  |                        '計算開始日から計算終了日 ||20227  |                        '計算開始日から計算終了日 
20273  |                        '== SQL7 ==               ||20228  |                        '== SQL7 ==               
20274  |                        sSql = ""                 ||20229  |                        sSql = ""                 
20275  |                        sSql = sSql & "SELECT ACCO||20230  |                        sSql = sSql & "SELECT ACCO
20276  |                        sSql = sSql & "WHERE (((CF||20231  |                        sSql = sSql & "WHERE (((CF
20277  |                        sSql = sSql & "AND ((CFR_D||20232  |                        sSql = sSql & "AND ((CFR_D
20278  |                        sSql = sSql & "AND ((CFR_D||20233  |                        sSql = sSql & "AND ((CFR_D
20279  |                        sSql = sSql & "ORDER BY CF||20234  |                        sSql = sSql & "ORDER BY CF
20280  |                    'マザー組入資産の場合         ||20235  |                    'マザー組入資産の場合         
20281  |                    Else                          ||20236  |                    Else                          
20282  |                        '計算開始日から計算終了日 ||20237  |                        '計算開始日から計算終了日 
20283  |                        '== SQL8 ==               ||20238  |                        '== SQL8 ==               
20284  |                        sSql = ""                 ||20239  |                        sSql = ""                 
20285  |                        sSql = sSql & "SELECT"    ||20240  |                        sSql = sSql & "SELECT"    
20286  |                        sSql = sSql & "    a.ACCOU||20241  |                        sSql = sSql & "    a.ACCOU
20287  |                        sSql = sSql & "    a.BASE_||20242  |                        sSql = sSql & "    a.BASE_
20288  |                        sSql = sSql & "    a.NET_A||20243  |                        sSql = sSql & "    a.NET_A
20289  |                        sSql = sSql & "    b.BABY_||20244  |                        sSql = sSql & "    b.BABY_
20290  |                        sSql = sSql & "    b.BABY_||20245  |                        sSql = sSql & "    b.BABY_
20291  |                        sSql = sSql & " FROM"     ||20246  |                        sSql = sSql & " FROM"     
20292  |                        sSql = sSql & "    CFR_DAI||20247  |                        sSql = sSql & "    CFR_DAI
20293  |                        sSql = sSql & " WHERE"    ||20248  |                        sSql = sSql & " WHERE"    
20294  |                        sSql = sSql & "    b.BABY_||20249  |                        sSql = sSql & "    b.BABY_
20295  |                        sSql = sSql & "    b.MOTHE||20250  |                        sSql = sSql & "    b.MOTHE
20296  |                        sSql = sSql & "    b.BASE_||20251  |                        sSql = sSql & "    b.BASE_
20297  |                        sSql = sSql & "    a.ACCOU||20252  |                        sSql = sSql & "    a.ACCOU
20298  |                        sSql = sSql & "    (a.BASE||20253  |                        sSql = sSql & "    (a.BASE
20299  |                        sSql = sSql & "    a.BASE_||20254  |                        sSql = sSql & "    a.BASE_
20300  |                        sSql = sSql & "    a.CURRE||20255  |                        sSql = sSql & "    a.CURRE
20301  |                        sSql = sSql & "    a.ASSET||20256  |                        sSql = sSql & "    a.ASSET
20302  |                        sSql = sSql & " ORDER BY" ||20257  |                        sSql = sSql & " ORDER BY" 
20303  |                        sSql = sSql & "    a.BASE_||20258  |                        sSql = sSql & "    a.BASE_
20304  |                    End If                        ||20259  |                    End If                        
20305  |                    'RAFI対応 END                 ||20260  |                    'RAFI対応 END                 
20306  |                                                  ||20261  |                                                  
20307  |                    If gintDyCreate(sSql) = False ||20262  |                    If gintDyCreate(sSql) = False 
20308  |                        Exit Function             ||20263  |                        Exit Function             
20309  |                    End If                        ||20264  |                    End If                        
20310  |                                                  ||20265  |                                                  
20311  |                    dlngCntsv = dlngCnt           ||20266  |                    dlngCntsv = dlngCnt           
20312  |                    dlngCnt = 0                   ||20267  |                    dlngCnt = 0                   
20313  |                                                  ||20268  |                                                  
20314  |                    Do Until gblnDyEOF()          ||20269  |                    Do Until gblnDyEOF()          
20315  |                        dlngCnt = dlngCnt + 1     ||20270  |                        dlngCnt = dlngCnt + 1     
20316  |                        '抽出データセット         ||20271  |                        '抽出データセット         
20317  |                        dstrBasedate = gvlnDyDataS||20272  |                        dstrBasedate = gvlnDyDataS
20318  |                        If Mid(dstrCaldate(dlngCnt||20273  |                        If Mid(dstrCaldate(dlngCnt
20319  |                            'RAFI対応 START       ||20274  |                            'RAFI対応 START       
20320  |                            '純資産の場合         ||20275  |                            '純資産の場合         
20321  |                            If msAssetFlg = "0" Th||20276  |                            If msAssetFlg = "0" Th
20322  |                                ddblDailynav(dlngC||20277  |                                ddblDailynav(dlngC
20323  |                            'マザー組入資産の場合 ||20278  |                            'マザー組入資産の場合 
20324  |                            Else                  ||20279  |                            Else                  
20325  |                                ddblDailynav(dlngC||20280  |                                ddblDailynav(dlngC
20326  |                            End If                ||20281  |                            End If                
20327  |                            'RAFI対応 END         ||20282  |                            'RAFI対応 END         
20328  |                        Else                      ||20283  |                        Else                      
20329  |                            '計算開始日が外部委託 ||20284  |                            '計算開始日が外部委託 
20330  |                            If ddblNearNav <> 0 _ ||20285  |                            If ddblNearNav <> 0 _ 
20331  |                            And dlngCnt = 1 Then  ||20286  |                            And dlngCnt = 1 Then  
20332  |                                dstrCaldate2 = Mid||20287  |                                dstrCaldate2 = Mid
20333  |                                dstrBasedate2 = Mi||20288  |                                dstrBasedate2 = Mi
20334  |                                dlngDiffdate = Dat||20289  |                                dlngDiffdate = Dat
20335  |                                                  ||20290  |                                                  
20336  |                                For dintFor2 = 1 T||20291  |                                For dintFor2 = 1 T
20337  |                                    'RAFI対応 STAR||20292  |                                    'RAFI対応 STAR
20338  |                                    '純資産の場合 ||20293  |                                    '純資産の場合 
20339  |                                    If msAssetFlg ||20294  |                                    If msAssetFlg 
20340  |                                        ddblDailyn||20295  |                                        ddblDailyn
20341  |                                    'マザー組入資 ||20296  |                                    'マザー組入資 
20342  |                                    Else          ||20297  |                                    Else          
20343  |                                        ddblDailyn||20298  |                                        ddblDailyn
20344  |                                    End If        ||20299  |                                    End If        
20345  |                                    'RAFI対応 END ||20300  |                                    'RAFI対応 END 
20346  |                                    dlngCnt = dlng||20301  |                                    dlngCnt = dlng
20347  |                                Next dintFor2     ||20302  |                                Next dintFor2     
20348  |                                '純資産の場合     ||20303  |                                '純資産の場合     
20349  |                                If msAssetFlg = "0||20304  |                                If msAssetFlg = "0
20350  |                                    ddblDailynav(d||20305  |                                    ddblDailynav(d
20351  |                                'マザー組入資産の ||20306  |                                'マザー組入資産の 
20352  |                                Else              ||20307  |                                Else              
20353  |                                    ddblDailynav(d||20308  |                                    ddblDailynav(d
20354  |                                End If            ||20309  |                                End If            
20355  |                                'RAFI対応 END     ||20310  |                                'RAFI対応 END     
20356  |                            Else                  ||20311  |                            Else                  
20357  |                                '日次NAVにデータが||20312  |                                '日次NAVにデータが
20358  |                                dstrCaldate2 = Mid||20313  |                                dstrCaldate2 = Mid
20359  |                                dstrBasedate2 = Mi||20314  |                                dstrBasedate2 = Mi
20360  |                                dlngDiffdate = Dat||20315  |                                dlngDiffdate = Dat
20361  |                                                  ||20316  |                                                  
20362  |                                For dintFor2 = 1 T||20317  |                                For dintFor2 = 1 T
20363  |                                    If ddblDailyna||20318  |                                    If ddblDailyna
20364  |                                        ddblDailyn||20319  |                                        ddblDailyn
20365  |                                    Else          ||20320  |                                    Else          
20366  |                                        '日次NAVに||20321  |                                        '日次NAVに
20367  |                                        intRtn = M||20322  |                                        intRtn = M
20368  |                                        vbLf & "対||20323  |                                        vbLf & "対
20369  |                                        vbLf & "基||20324  |                                        vbLf & "基
20370  |                                            vbCrit||20325  |                                            vbCrit
20371  |                                        Exit Funct||20326  |                                        Exit Funct
20372  |                                    End If        ||20327  |                                    End If        
20373  |                                    dlngCnt = dlng||20328  |                                    dlngCnt = dlng
20374  |                                Next dintFor2     ||20329  |                                Next dintFor2     
20375  |                                'RAFI対応 START   ||20330  |                                'RAFI対応 START   
20376  |                                '純資産の場合     ||20331  |                                '純資産の場合     
20377  |                                If msAssetFlg = "0||20332  |                                If msAssetFlg = "0
20378  |                                    ddblDailynav(d||20333  |                                    ddblDailynav(d
20379  |                                'マザー組入資産の ||20334  |                                'マザー組入資産の 
20380  |                                Else              ||20335  |                                Else              
20381  |                                    ddblDailynav(d||20336  |                                    ddblDailynav(d
20382  |                                End If            ||20337  |                                End If            
20383  |                                'RAFI対応 END     ||20338  |                                'RAFI対応 END     
20384  |                            End If                ||20339  |                            End If                
20385  |                                                  ||20340  |                                                  
20386  |                        End If                    ||20341  |                        End If                    
20387  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||20342  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
20388  |                        Call gDyNext              ||20343  |                        Call gDyNext              
20389  |                    Loop                          ||20344  |                    Loop                          
20390  |                                                  ||20345  |                                                  
20391  |                Next dintFor                      ||20346  |                Next dintFor                      
20392  |                                                  ||20347  |                                                  
20393  |                If dlngCntsv <> dlngCnt Then      ||20348  |                If dlngCntsv <> dlngCnt Then      
20394  |                    For dintFor2 = dlngCnt + 1 To ||20349  |                    For dintFor2 = dlngCnt + 1 To 
20395  |                        ddblDailynav(dintFor2) = d||20350  |                        ddblDailynav(dintFor2) = d
20396  |                    Next dintFor2                 ||20351  |                    Next dintFor2                 
20397  |                    dlngCnt = dlngCntsv           ||20352  |                    dlngCnt = dlngCntsv           
20398  |                End If                            ||20353  |                End If                            
20399  |                                                  ||20354  |                                                  
20400  |                ddblTtalnav = 0                   ||20355  |                ddblTtalnav = 0                   
20401  |                                                  ||20356  |                                                  
20402  |                For dintFor2 = 1 To dlngCnt       ||20357  |                For dintFor2 = 1 To dlngCnt       
20403  |                    ddblTtalnav = ddblTtalnav + dd||20358  |                    ddblTtalnav = ddblTtalnav + dd
20404  |                Next dintFor2                     ||20359  |                Next dintFor2                     
20405  |                                                  ||20360  |                                                  
20406  |                iRowCnt = dlngCnt                 ||20361  |                iRowCnt = dlngCnt                 
20407  |                TotalNav = ddblTtalnav            ||20362  |                TotalNav = ddblTtalnav            
20408  |                dblValueIn = TotalNav             ||20363  |                dblValueIn = TotalNav             
20409  |                Call sbGetRoundValue2(dblValueIn) ||20364  |                Call sbGetRoundValue2(dblValueIn) 
20410  |                TotalNav = dblValueOut            ||20365  |                TotalNav = dblValueOut            
20411  |                                                  ||20366  |                                                  
20412  |                '平均純資産総額                   ||20367  |                '平均純資産総額                   
20413  |                .Cells(43, 2).Value = sWord51a    ||20368  |                .Cells(43, 2).Value = sWord51a    
20414  |                .Cells(43, 16).Value = sWord19    ||20369  |                .Cells(43, 16).Value = sWord19    
20415  |                                                  ||20370  |                                                  
20416  |                '計算期間の純資産総額の合計(月末純||20371  |                '計算期間の純資産総額の合計(月末純
20417  |                .Cells(43, 28).NumberFormatLocal =||20372  |                .Cells(43, 28).NumberFormatLocal =
20418  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||20373  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
20419  |                    .Cells(43, 28).Value = CStr(Fo||20374  |                    .Cells(43, 28).Value = CStr(Fo
20420  |                Else                              ||20375  |                Else                              
20421  |                    .Cells(43, 28).Value = CStr(Fo||20376  |                    .Cells(43, 28).Value = CStr(Fo
20422  |                End If                            ||20377  |                End If                            
20423  |                .Cells(43, 28).HorizontalAlignment||20378  |                .Cells(43, 28).HorizontalAlignment
20424  |                                                  ||20379  |                                                  
20425  |                '計算期間の純資産総額の合計÷計算 ||20380  |                '計算期間の純資産総額の合計÷計算 
20426  |                .Cells(43, 40).NumberFormatLocal =||20381  |                .Cells(43, 40).NumberFormatLocal =
20427  |                dblValueIn = TotalNav / iRowCnt   ||20382  |                dblValueIn = TotalNav / iRowCnt   
20428  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||20383  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
20429  |                    Call sbGetRoundValue2(dblValue||20384  |                    Call sbGetRoundValue2(dblValue
20430  |                Else                              ||20385  |                Else                              
20431  |                    Call sbGetRoundValue(dblValueI||20386  |                    Call sbGetRoundValue(dblValueI
20432  |                End If                            ||20387  |                End If                            
20433  |                                                  ||20388  |                                                  
20434  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||20389  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
20435  |                    .Cells(43, 40).Value = CStr(Fo||20390  |                    .Cells(43, 40).Value = CStr(Fo
20436  |                Else                              ||20391  |                Else                              
20437  |                    .Cells(43, 40).Value = CStr(Fo||20392  |                    .Cells(43, 40).Value = CStr(Fo
20438  |                End If                            ||20393  |                End If                            
20439  |                AvgNav = dblValueOut              ||20394  |                AvgNav = dblValueOut              
20440  |                                                  ||20395  |                                                  
20441  |                '÷??＝                           ||20396  |                '÷??＝                           
20442  |                .Cells(43, 31).Value = sWord18 & "||20397  |                .Cells(43, 31).Value = sWord18 & "
20443  |            End If                                ||20398  |            End If                                
20444  |'契約区分：名称使用許諾料計算　かつ　日次NAV(休日 ||20399  |'契約区分：名称使用許諾料計算　かつ　日次NAV(休日 
20445  |        Else                                      ||20400  |        Else                                      
20446  |On Error GoTo OnErrorProc                         ||20401  |On Error GoTo OnErrorProc                         
20447  |                                                  ||20402  |                                                  
20448  |            '契約区分「3」の場合                  ||20403  |            '契約区分「3」の場合                  
20449  |            ddblTtalnav = 0                       ||20404  |            ddblTtalnav = 0                       
20450  |            For dintFor = 0 To NavGetCnt - 1      ||20405  |            For dintFor = 0 To NavGetCnt - 1      
20451  |                                                  ||20406  |                                                  
20452  |                '日次NAV平均取得                  ||20407  |                '日次NAV平均取得                  
20453  |                sStart = gstrDateFormat2(CStr(dSta||20408  |                sStart = gstrDateFormat2(CStr(dSta
20454  |                sEnd = gstrDateFormat2(CStr(dEnd),||20409  |                sEnd = gstrDateFormat2(CStr(dEnd),
20455  |                                                  ||20410  |                                                  
20456  |                'RAFI対応 START                   ||20411  |                'RAFI対応 START                   
20457  |                '純資産の場合                     ||20412  |                '純資産の場合                     
20458  |                If msAssetFlg = "0" Then          ||20413  |                If msAssetFlg = "0" Then          
20459  |                    '計算開始日から計算終了日まで ||20414  |                    '計算開始日から計算終了日まで 
20460  |                    sSql = ""                     ||20415  |                    sSql = ""                     
20461  |                    sSql = sSql & "SELECT ACCOUNT_||20416  |                    sSql = sSql & "SELECT ACCOUNT_
20462  |                    sSql = sSql & "WHERE (((CFR_DA||20417  |                    sSql = sSql & "WHERE (((CFR_DA
20463  |                    sSql = sSql & "AND ((CFR_DAILY||20418  |                    sSql = sSql & "AND ((CFR_DAILY
20464  |                    sSql = sSql & "AND ((CFR_DAILY||20419  |                    sSql = sSql & "AND ((CFR_DAILY
20465  |                    sSql = sSql & "ORDER BY CFR_DA||20420  |                    sSql = sSql & "ORDER BY CFR_DA
20466  |                'マザー組入資産の場合             ||20421  |                'マザー組入資産の場合             
20467  |                Else                              ||20422  |                Else                              
20468  |                    '計算開始日から計算終了日まで ||20423  |                    '計算開始日から計算終了日まで 
20469  |                    sSql = ""                     ||20424  |                    sSql = ""                     
20470  |                    sSql = sSql & "SELECT"        ||20425  |                    sSql = sSql & "SELECT"        
20471  |                    sSql = sSql & "    a.ACCOUNT_C||20426  |                    sSql = sSql & "    a.ACCOUNT_C
20472  |                    sSql = sSql & "    a.BASE_DATE||20427  |                    sSql = sSql & "    a.BASE_DATE
20473  |                    sSql = sSql & "    a.NET_ASSET||20428  |                    sSql = sSql & "    a.NET_ASSET
20474  |                    sSql = sSql & "    b.BABY_MOTH||20429  |                    sSql = sSql & "    b.BABY_MOTH
20475  |                    sSql = sSql & "    b.BABY_MOTH||20430  |                    sSql = sSql & "    b.BABY_MOTH
20476  |                    sSql = sSql & " FROM"         ||20431  |                    sSql = sSql & " FROM"         
20477  |                    sSql = sSql & "    CFR_DAILY_N||20432  |                    sSql = sSql & "    CFR_DAILY_N
20478  |                    sSql = sSql & " WHERE"        ||20433  |                    sSql = sSql & " WHERE"        
20479  |                    sSql = sSql & "    b.BABY_ACCO||20434  |                    sSql = sSql & "    b.BABY_ACCO
20480  |                    sSql = sSql & "    b.MOTHER_AC||20435  |                    sSql = sSql & "    b.MOTHER_AC
20481  |                    sSql = sSql & "    b.BASE_DATE||20436  |                    sSql = sSql & "    b.BASE_DATE
20482  |                    sSql = sSql & "    a.ACCOUNT_C||20437  |                    sSql = sSql & "    a.ACCOUNT_C
20483  |                    sSql = sSql & "    (a.BASE_DAT||20438  |                    sSql = sSql & "    (a.BASE_DAT
20484  |                    sSql = sSql & "    a.BASE_DATE||20439  |                    sSql = sSql & "    a.BASE_DATE
20485  |                    sSql = sSql & "    a.CURRENCY_||20440  |                    sSql = sSql & "    a.CURRENCY_
20486  |                    sSql = sSql & "    a.ASSET_TYP||20441  |                    sSql = sSql & "    a.ASSET_TYP
20487  |                    sSql = sSql & " ORDER BY"     ||20442  |                    sSql = sSql & " ORDER BY"     
20488  |                    sSql = sSql & "    a.BASE_DATE||20443  |                    sSql = sSql & "    a.BASE_DATE
20489  |                End If                            ||20444  |                End If                            
20490  |                'RAFI対応 END                     ||20445  |                'RAFI対応 END                     
20491  |                                                  ||20446  |                                                  
20492  |                If gintDyCreate(sSql) = False Then||20447  |                If gintDyCreate(sSql) = False Then
20493  |                    Exit Function                 ||20448  |                    Exit Function                 
20494  |                End If                            ||20449  |                End If                            
20495  |                                                  ||20450  |                                                  
20496  |                If dlngCnt = 0 Then               ||20451  |                If dlngCnt = 0 Then               
20497  |                    ReDim dstrCaldate(gbxOraDynase||20452  |                    ReDim dstrCaldate(gbxOraDynase
20498  |                    ReDim ddblDailynav(gbxOraDynas||20453  |                    ReDim ddblDailynav(gbxOraDynas
20499  |                End If                            ||20454  |                End If                            
20500  |                                                  ||20455  |                                                  
20501  |                dlngCnt = 0                       ||20456  |                dlngCnt = 0                       
20502  |                                                  ||20457  |                                                  
20503  |                Do Until gblnDyEOF()              ||20458  |                Do Until gblnDyEOF()              
20504  |                    dlngCnt = dlngCnt + 1         ||20459  |                    dlngCnt = dlngCnt + 1         
20505  |                    'RAFI対応 START               ||20460  |                    'RAFI対応 START               
20506  |                    '純資産の場合                 ||20461  |                    '純資産の場合                 
20507  |                    If msAssetFlg = "0" Then      ||20462  |                    If msAssetFlg = "0" Then      
20508  |                        '抽出データセット         ||20463  |                        '抽出データセット         
20509  |                        dstrCaldate(dlngCnt) = gvl||20464  |                        dstrCaldate(dlngCnt) = gvl
20510  |                        ddblDailynav(dlngCnt) = dd||20465  |                        ddblDailynav(dlngCnt) = dd
20511  |                    'マザー組入資産の場合         ||20466  |                    'マザー組入資産の場合         
20512  |                    Else                          ||20467  |                    Else                          
20513  |                        dstrCaldate(dlngCnt) = gvl||20468  |                        dstrCaldate(dlngCnt) = gvl
20514  |                        ddblDailynav(dlngCnt) = dd||20469  |                        ddblDailynav(dlngCnt) = dd
20515  |                    End If                        ||20470  |                    End If                        
20516  |                    'RAFI対応 END                 ||20471  |                    'RAFI対応 END                 
20517  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             ||20472  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             
20518  |                    Call gDyNext                  ||20473  |                    Call gDyNext                  
20519  |                Loop                              ||20474  |                Loop                              
20520  |                                                  ||20475  |                                                  
20521  |            Next dintFor                          ||20476  |            Next dintFor                          
20522  |                                                  ||20477  |                                                  
20523  |            ddblTtalnav = 0                       ||20478  |            ddblTtalnav = 0                       
20524  |                                                  ||20479  |                                                  
20525  |            For dintFor2 = 1 To dlngCnt           ||20480  |            For dintFor2 = 1 To dlngCnt           
20526  |                ddblTtalnav = ddblTtalnav + ddblDa||20481  |                ddblTtalnav = ddblTtalnav + ddblDa
20527  |            Next dintFor2                         ||20482  |            Next dintFor2                         
20528  |                                                  ||20483  |                                                  
20529  |            iRowCnt = dlngCnt                     ||20484  |            iRowCnt = dlngCnt                     
20530  |            dlngMeisyoSu = dlngCnt                ||20485  |            dlngMeisyoSu = dlngCnt                
20531  |                                                  ||20486  |                                                  
20532  |            TotalNav = ddblTtalnav                ||20487  |            TotalNav = ddblTtalnav                
20533  |            dblValueIn = TotalNav                 ||20488  |            dblValueIn = TotalNav                 
20534  |            Call sbGetRoundValue2(dblValueIn)     ||20489  |            Call sbGetRoundValue2(dblValueIn)     
20535  |            TotalNav = dblValueOut                ||20490  |            TotalNav = dblValueOut                
20536  |                                                  ||20491  |                                                  
20537  |            '計算期間の純資産総額の合計÷計算期間 ||20492  |            '計算期間の純資産総額の合計÷計算期間 
20538  |            dblValueIn = TotalNav / iRowCnt       ||20493  |            dblValueIn = TotalNav / iRowCnt       
20539  |            iCalcNum = iRowCnt                    ||20494  |            iCalcNum = iRowCnt                    
20540  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||20495  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
20541  |                  Call sbGetRoundValue2(dblValueIn||20496  |                  Call sbGetRoundValue2(dblValueIn
20542  |            Else                                  ||20497  |            Else                                  
20543  |                  Call sbGetRoundValue(dblValueIn)||20498  |                  Call sbGetRoundValue(dblValueIn)
20544  |            End If                                ||20499  |            End If                                
20545  |            dstrAvgNav = dblValueOut              ||20500  |            dstrAvgNav = dblValueOut              
20546  |            AvgNav = dstrAvgNav                   ||20501  |            AvgNav = dstrAvgNav                   
20547  |                                                  ||20502  |                                                  
20548  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||20503  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
20549  |            Call gblnDyClose                      ||20504  |            Call gblnDyClose                      
20550  |                                                  ||20505  |                                                  
20551  |            '平均純資産総額                       ||20506  |            '平均純資産総額                       
20552  |            .Cells(43, 2).Value = sWord51a        ||20507  |            .Cells(43, 2).Value = sWord51a        
20553  |            .Cells(43, 16).Value = sWord19        ||20508  |            .Cells(43, 16).Value = sWord19        
20554  |            '計算期間の純資産総額の合計(月末純資産||20509  |            '計算期間の純資産総額の合計(月末純資産
20555  |            .Cells(43, 28).NumberFormatLocal = "@"||20510  |            .Cells(43, 28).NumberFormatLocal = "@"
20556  |              If gbuMGetUPDRec.N(lRecIdx).MGET_bas||20511  |              If gbuMGetUPDRec.N(lRecIdx).MGET_bas
20557  |                  .Cells(43, 28).Value = CStr(Form||20512  |                  .Cells(43, 28).Value = CStr(Form
20558  |              Else                                ||20513  |              Else                                
20559  |                  .Cells(43, 28).Value = CStr(Form||20514  |                  .Cells(43, 28).Value = CStr(Form
20560  |              End If                              ||20515  |              End If                              
20561  |            .Cells(43, 28).HorizontalAlignment = x||20516  |            .Cells(43, 28).HorizontalAlignment = x
20562  |            '÷??＝                               ||20517  |            '÷??＝                               
20563  |            .Cells(43, 31).Value = sWord18 & "   "||20518  |            .Cells(43, 31).Value = sWord18 & "   "
20564  |            '計算期間の純資産総額の合計÷計算期間 ||20519  |            '計算期間の純資産総額の合計÷計算期間 
20565  |            .Cells(43, 40).NumberFormatLocal = "@"||20520  |            .Cells(43, 40).NumberFormatLocal = "@"
20566  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||20521  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
20567  |                .Cells(43, 40).Value = CStr(Format||20522  |                .Cells(43, 40).Value = CStr(Format
20568  |            Else                                  ||20523  |            Else                                  
20569  |                .Cells(43, 40).Value = CStr(Format||20524  |                .Cells(43, 40).Value = CStr(Format
20570  |            End If                                ||20525  |            End If                                
20571  |                                                  ||20526  |                                                  
20572  |            ddblExchangeRate = 0                  ||20527  |            ddblExchangeRate = 0                  
20573  |                                                  ||20528  |                                                  
20574  |            '投資顧問料計算用計算対象NAVに日次平均||20529  |            '投資顧問料計算用計算対象NAVに日次平均
20575  |            If dstrAvgNav = "" Then               ||20530  |            If dstrAvgNav = "" Then               
20576  |                lCalcNav = 0                      ||20531  |                lCalcNav = 0                      
20577  |            Else                                  ||20532  |            Else                                  
20578  |                                                  ||20533  |                                                  
20579  |                dblValueIn = CDbl(dstrAvgNav)     ||20534  |                dblValueIn = CDbl(dstrAvgNav)     
20580  |                                                  ||20535  |                                                  
20581  |                '@@@@@ NAV通貨から閾値通貨に換算 @||20536  |                '@@@@@ NAV通貨から閾値通貨に換算 @
20582  |                Select Case gbuMGetUPDRec.N(lRecId||20537  |                Select Case gbuMGetUPDRec.N(lRecId
20583  |                  Case "1"    '固定料率           ||20538  |                  Case "1"    '固定料率           
20584  |                    If gbuMGetUPDRec.N(lRecIdx).MG||20539  |                    If gbuMGetUPDRec.N(lRecIdx).MG
20585  |                        'NAV通貨→JPYの為替レート ||20540  |                        'NAV通貨→JPYの為替レート 
20586  |                        dstrCurrencyCode = gbuMGet||20541  |                        dstrCurrencyCode = gbuMGet
20587  |                        ddblExchangeRate = fnstrEx||20542  |                        ddblExchangeRate = fnstrEx
20588  |                        If ddblExchangeRate = 0 Th||20543  |                        If ddblExchangeRate = 0 Th
20589  |                          intRtn = MsgBox("ＴＴＭ ||20544  |                          intRtn = MsgBox("ＴＴＭ 
20590  |                          vbLf & "対象通貨コード  ||20545  |                          vbLf & "対象通貨コード  
20591  |                          vbLf & "基準日 ： [ " & ||20546  |                          vbLf & "基準日 ： [ " & 
20592  |                              vbCritical, "ＴＴＭ ||20547  |                              vbCritical, "ＴＴＭ 
20593  |                          Exit Function           ||20548  |                          Exit Function           
20594  |                        End If                    ||20549  |                        End If                    
20595  |                        'NAV通貨→JPYへレート換算 ||20550  |                        'NAV通貨→JPYへレート換算 
20596  |                        dblValueIn = dblValueIn * ||20551  |                        dblValueIn = dblValueIn * 
20597  |                    End If                        ||20552  |                    End If                        
20598  |                                                  ||20553  |                                                  
20599  |                  Case "2"    '段階料率           ||20554  |                  Case "2"    '段階料率           
20600  |                                                  ||20555  |                                                  
20601  |                    If gbuMGetUPDRec.N(lRecIdx).MG||20556  |                    If gbuMGetUPDRec.N(lRecIdx).MG
20602  |                        If gbuMGetUPDRec.N(lRecIdx||20557  |                        If gbuMGetUPDRec.N(lRecIdx
20603  |                        Else                      ||20558  |                        Else                      
20604  |                            '閾値通貨→JPYの為替レ||20559  |                            '閾値通貨→JPYの為替レ
20605  |                            dstrCurrencyCode = gbu||20560  |                            dstrCurrencyCode = gbu
20606  |                            ddblExchangeRate = fns||20561  |                            ddblExchangeRate = fns
20607  |                            If ddblExchangeRate = ||20562  |                            If ddblExchangeRate = 
20608  |                              intRtn = MsgBox("Ｔ ||20563  |                              intRtn = MsgBox("Ｔ 
20609  |                              vbLf & "対象通貨コー||20564  |                              vbLf & "対象通貨コー
20610  |                              vbLf & "基準日 ： [ ||20565  |                              vbLf & "基準日 ： [ 
20611  |                                  vbCritical, "Ｔ ||20566  |                                  vbCritical, "Ｔ 
20612  |                              Exit Function       ||20567  |                              Exit Function       
20613  |                            End If                ||20568  |                            End If                
20614  |                            'JPY→閾値通貨へレート||20569  |                            'JPY→閾値通貨へレート
20615  |                            dblValueIn = dblValueI||20570  |                            dblValueIn = dblValueI
20616  |                        End If                    ||20571  |                        End If                    
20617  |                    Else                          ||20572  |                    Else                          
20618  |                        'NAV通貨→JPYの為替レート ||20573  |                        'NAV通貨→JPYの為替レート 
20619  |                        dstrCurrencyCode = gbuMGet||20574  |                        dstrCurrencyCode = gbuMGet
20620  |                        ddblExchangeRate = fnstrEx||20575  |                        ddblExchangeRate = fnstrEx
20621  |                        If ddblExchangeRate = 0 Th||20576  |                        If ddblExchangeRate = 0 Th
20622  |                          intRtn = MsgBox("ＴＴＭ ||20577  |                          intRtn = MsgBox("ＴＴＭ 
20623  |                          vbLf & "対象通貨コード  ||20578  |                          vbLf & "対象通貨コード  
20624  |                          vbLf & "基準日 ： [ " & ||20579  |                          vbLf & "基準日 ： [ " & 
20625  |                              vbCritical, "ＴＴＭ ||20580  |                              vbCritical, "ＴＴＭ 
20626  |                          Exit Function           ||20581  |                          Exit Function           
20627  |                        End If                    ||20582  |                        End If                    
20628  |                        'NAV通貨→JPYへレート換算 ||20583  |                        'NAV通貨→JPYへレート換算 
20629  |                        dblValueIn = dblValueIn * ||20584  |                        dblValueIn = dblValueIn * 
20630  |                        If gbuMGetUPDRec.N(lRecIdx||20585  |                        If gbuMGetUPDRec.N(lRecIdx
20631  |                        Else                      ||20586  |                        Else                      
20632  |                            '閾値通貨→JPYの為替レ||20587  |                            '閾値通貨→JPYの為替レ
20633  |                            dstrCurrencyCode = gbu||20588  |                            dstrCurrencyCode = gbu
20634  |                            ddblExchangeRate = fns||20589  |                            ddblExchangeRate = fns
20635  |                            If ddblExchangeRate = ||20590  |                            If ddblExchangeRate = 
20636  |                              intRtn = MsgBox("Ｔ ||20591  |                              intRtn = MsgBox("Ｔ 
20637  |                              vbLf & "対象通貨コー||20592  |                              vbLf & "対象通貨コー
20638  |                              vbLf & "基準日 ： [ ||20593  |                              vbLf & "基準日 ： [ 
20639  |                                  vbCritical, "Ｔ ||20594  |                                  vbCritical, "Ｔ 
20640  |                              Exit Function       ||20595  |                              Exit Function       
20641  |                            End If                ||20596  |                            End If                
20642  |                            'JPY→閾値通貨へ逆レー||20597  |                            'JPY→閾値通貨へ逆レー
20643  |                            dblValueIn = dblValueI||20598  |                            dblValueIn = dblValueI
20644  |                        End If                    ||20599  |                        End If                    
20645  |                    End If                        ||20600  |                    End If                        
20646  |                                                  ||20601  |                                                  
20647  |                End Select                        ||20602  |                End Select                        
20648  |                '@@@@@ NAV通貨から閾値通貨に換算 @||20603  |                '@@@@@ NAV通貨から閾値通貨に換算 @
20649  |                Call sbGetRoundValue2(dblValueIn) ||20604  |                Call sbGetRoundValue2(dblValueIn) 
20650  |                                                  ||20605  |                                                  
20651  |'閾値レート換算後平均NAV(計算対象NAV)             ||20606  |'閾値レート換算後平均NAV(計算対象NAV)             
20652  |                lCalcNav = CStr(Format(dblValueOut||20607  |                lCalcNav = CStr(Format(dblValueOut
20653  |            End If                                ||20608  |            End If                                
20654  |                                                  ||20609  |                                                  
20655  |On Error Resume Next                              ||20610  |On Error Resume Next                              
20656  |        End If                                    ||20611  |        End If                                    
20657  |                                                  ||20612  |                                                  
20658  |        '投資顧問料                               ||20613  |        '投資顧問料                               
20659  |        Dim dRitsu As Double    '外部委託顧問料率 ||20614  |        Dim dRitsu As Double    '外部委託顧問料率 
20660  |        dRitsu = 0                                ||20615  |        dRitsu = 0                                
20661  |        TotalRate = 0                             ||20616  |        TotalRate = 0                             
20662  |        ddblExchangeRate = 0                      ||20617  |        ddblExchangeRate = 0                      
20663  |        '計算対象NAVを変数にセット                ||20618  |        '計算対象NAVを変数にセット                
20664  |            lCalcNav = 0                          ||20619  |            lCalcNav = 0                          
20665  |            dblValueIn = TotalNav / iRowCnt       ||20620  |            dblValueIn = TotalNav / iRowCnt       
20666  |                                                  ||20621  |                                                  
20667  |            '@@@@@ NAV通貨から閾値通貨に換算 @@@@@||20622  |            '@@@@@ NAV通貨から閾値通貨に換算 @@@@@
20668  |            Select Case gbuMGetUPDRec.N(lRecIdx).M||20623  |            Select Case gbuMGetUPDRec.N(lRecIdx).M
20669  |              Case "1"    '固定料率(固定料率の場合||20624  |              Case "1"    '固定料率(固定料率の場合
20670  |                                                  ||20625  |                                                  
20671  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||20626  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
20672  |                    'NAV通貨→JPYの為替レートを取 ||20627  |                    'NAV通貨→JPYの為替レートを取 
20673  |                    dstrCurrencyCode = gbuMGetUPDR||20628  |                    dstrCurrencyCode = gbuMGetUPDR
20674  |                    ddblExchangeRate = fnstrExchan||20629  |                    ddblExchangeRate = fnstrExchan
20675  |                    If ddblExchangeRate = 0 Then  ||20630  |                    If ddblExchangeRate = 0 Then  
20676  |                      intRtn = MsgBox("ＴＴＭが取 ||20631  |                      intRtn = MsgBox("ＴＴＭが取 
20677  |                      vbLf & "対象通貨コード ： [ ||20632  |                      vbLf & "対象通貨コード ： [ 
20678  |                      vbLf & "基準日 ： [ " & Mid(||20633  |                      vbLf & "基準日 ： [ " & Mid(
20679  |                          vbCritical, "ＴＴＭ取得 ||20634  |                          vbCritical, "ＴＴＭ取得 
20680  |                      Exit Function               ||20635  |                      Exit Function               
20681  |                    End If                        ||20636  |                    End If                        
20682  |                    'NAV通貨→JPYへレート換算     ||20637  |                    'NAV通貨→JPYへレート換算     
20683  |                    dblValueIn = dblValueIn * ddbl||20638  |                    dblValueIn = dblValueIn * ddbl
20684  |                End If                            ||20639  |                End If                            
20685  |                                                  ||20640  |                                                  
20686  |              Case "2"    '段階料率               ||20641  |              Case "2"    '段階料率               
20687  |                                                  ||20642  |                                                  
20688  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||20643  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
20689  |                    If gbuMGetUPDRec.N(lRecIdx).MG||20644  |                    If gbuMGetUPDRec.N(lRecIdx).MG
20690  |                    Else                          ||20645  |                    Else                          
20691  |                        '閾値通貨→JPYの為替レート||20646  |                        '閾値通貨→JPYの為替レート
20692  |                        dstrCurrencyCode = gbuMGet||20647  |                        dstrCurrencyCode = gbuMGet
20693  |                        ddblExchangeRate = fnstrEx||20648  |                        ddblExchangeRate = fnstrEx
20694  |                        If ddblExchangeRate = 0 Th||20649  |                        If ddblExchangeRate = 0 Th
20695  |                          intRtn = MsgBox("ＴＴＭ ||20650  |                          intRtn = MsgBox("ＴＴＭ 
20696  |                          vbLf & "対象通貨コード  ||20651  |                          vbLf & "対象通貨コード  
20697  |                          vbLf & "基準日 ： [ " & ||20652  |                          vbLf & "基準日 ： [ " & 
20698  |                              vbCritical, "ＴＴＭ ||20653  |                              vbCritical, "ＴＴＭ 
20699  |                          Exit Function           ||20654  |                          Exit Function           
20700  |                        End If                    ||20655  |                        End If                    
20701  |                        'JPY→閾値通貨へレート換算||20656  |                        'JPY→閾値通貨へレート換算
20702  |                        dblValueIn = dblValueIn * ||20657  |                        dblValueIn = dblValueIn * 
20703  |                    End If                        ||20658  |                    End If                        
20704  |                Else                              ||20659  |                Else                              
20705  |                    'NAV通貨→JPYの為替レートを取 ||20660  |                    'NAV通貨→JPYの為替レートを取 
20706  |                    dstrCurrencyCode = gbuMGetUPDR||20661  |                    dstrCurrencyCode = gbuMGetUPDR
20707  |                    ddblExchangeRate = fnstrExchan||20662  |                    ddblExchangeRate = fnstrExchan
20708  |                    If ddblExchangeRate = 0 Then  ||20663  |                    If ddblExchangeRate = 0 Then  
20709  |                      intRtn = MsgBox("ＴＴＭが取 ||20664  |                      intRtn = MsgBox("ＴＴＭが取 
20710  |                      vbLf & "対象通貨コード ： [ ||20665  |                      vbLf & "対象通貨コード ： [ 
20711  |                      vbLf & "基準日 ： [ " & Mid(||20666  |                      vbLf & "基準日 ： [ " & Mid(
20712  |                          vbCritical, "ＴＴＭ取得 ||20667  |                          vbCritical, "ＴＴＭ取得 
20713  |                      Exit Function               ||20668  |                      Exit Function               
20714  |                    End If                        ||20669  |                    End If                        
20715  |                    'NAV通貨→JPYへレート換算     ||20670  |                    'NAV通貨→JPYへレート換算     
20716  |                    dblValueIn = dblValueIn * ddbl||20671  |                    dblValueIn = dblValueIn * ddbl
20717  |                    If gbuMGetUPDRec.N(lRecIdx).MG||20672  |                    If gbuMGetUPDRec.N(lRecIdx).MG
20718  |                    Else                          ||20673  |                    Else                          
20719  |                        '閾値通貨→JPYの為替レート||20674  |                        '閾値通貨→JPYの為替レート
20720  |                        dstrCurrencyCode = gbuMGet||20675  |                        dstrCurrencyCode = gbuMGet
20721  |                        ddblExchangeRate = fnstrEx||20676  |                        ddblExchangeRate = fnstrEx
20722  |                        If ddblExchangeRate = 0 Th||20677  |                        If ddblExchangeRate = 0 Th
20723  |                          intRtn = MsgBox("ＴＴＭ ||20678  |                          intRtn = MsgBox("ＴＴＭ 
20724  |                          vbLf & "対象通貨コード  ||20679  |                          vbLf & "対象通貨コード  
20725  |                          vbLf & "基準日 ： [ " & ||20680  |                          vbLf & "基準日 ： [ " & 
20726  |                              vbCritical, "ＴＴＭ ||20681  |                              vbCritical, "ＴＴＭ 
20727  |                          Exit Function           ||20682  |                          Exit Function           
20728  |                        End If                    ||20683  |                        End If                    
20729  |                        'JPY→閾値通貨へ逆レート換||20684  |                        'JPY→閾値通貨へ逆レート換
20730  |                        dblValueIn = dblValueIn / ||20685  |                        dblValueIn = dblValueIn / 
20731  |                    End If                        ||20686  |                    End If                        
20732  |                End If                            ||20687  |                End If                            
20733  |            End Select                            ||20688  |            End Select                            
20734  |            '@@@@@ NAV通貨から閾値通貨に換算 @@@@@||20689  |            '@@@@@ NAV通貨から閾値通貨に換算 @@@@@
20735  |            Call sbGetRoundValue2(dblValueIn)     ||20690  |            Call sbGetRoundValue2(dblValueIn)     
20736  |            lCalcNav = CStr(Format(dblValueOut, "#||20691  |            lCalcNav = CStr(Format(dblValueOut, "#
20737  |                                                  ||20692  |                                                  
20738  |        '固定料率                                 ||20693  |        '固定料率                                 
20739  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat||20694  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat
20740  |            '計算対称NAV × 外部委託顧問料率 ÷ 10||20695  |            '計算対称NAV × 外部委託顧問料率 ÷ 10
20741  |            dRitsu = CDbl(gbuOtherComRateGetUPDRec||20696  |            dRitsu = CDbl(gbuOtherComRateGetUPDRec
20742  |                                                  ||20697  |                                                  
20743  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_||20698  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_
20744  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_||20699  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_
20745  |                '一年間の日数：365日またはカレンダ||20700  |                '一年間の日数：365日またはカレンダ
20746  |                dblValueIn = lCalcNav * dRitsu / 1||20701  |                dblValueIn = lCalcNav * dRitsu / 1
20747  |            Else                                  ||20702  |            Else                                  
20748  |                '一年間の日数：360日              ||20703  |                '一年間の日数：360日              
20749  |                dblValueIn = lCalcNav * dRitsu / 1||20704  |                dblValueIn = lCalcNav * dRitsu / 1
20750  |            End If                                ||20705  |            End If                                
20751  |                                                  ||20706  |                                                  
20752  |        '段階料率                                 ||20707  |        '段階料率                                 
20753  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other||20708  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other
20754  |            '料率分ループ処理                     ||20709  |            '料率分ループ処理                     
20755  |            For i = LBound(gbuOtherComRateGetUPDRe||20710  |            For i = LBound(gbuOtherComRateGetUPDRe
20756  |                TotalRate = TotalRate + CCur(gbuOt||20711  |                TotalRate = TotalRate + CCur(gbuOt
20757  |                cRate = CCur(gbuOtherComRateGetUPD||20712  |                cRate = CCur(gbuOtherComRateGetUPD
20758  |                dRitsu = CDbl(gbuOtherComRateGetUP||20713  |                dRitsu = CDbl(gbuOtherComRateGetUP
20759  |                If i = UBound(gbuOtherComRateGetUP||20714  |                If i = UBound(gbuOtherComRateGetUP
20760  |                    '(前回閾値)：累積閾値 = WORK閾||20715  |                    '(前回閾値)：累積閾値 = WORK閾
20761  |                    TotalRate = WorkRate          ||20716  |                    TotalRate = WorkRate          
20762  |                ElseIf TotalRate <= lCalcNav Then ||20717  |                ElseIf TotalRate <= lCalcNav Then 
20763  |                    '累積投資顧問料 = 累積投資顧問||20718  |                    '累積投資顧問料 = 累積投資顧問
20764  |                    dblValueIn = cRate * dRitsu / ||20719  |                    dblValueIn = cRate * dRitsu / 
20765  |                    Call sbGetRoundValue2(dblValue||20720  |                    Call sbGetRoundValue2(dblValue
20766  |                    TotalCom = TotalCom + dblValue||20721  |                    TotalCom = TotalCom + dblValue
20767  |                Else                              ||20722  |                Else                              
20768  |                    '(前回閾値)：累積閾値 = WORK閾||20723  |                    '(前回閾値)：累積閾値 = WORK閾
20769  |                    TotalRate = WorkRate          ||20724  |                    TotalRate = WorkRate          
20770  |                    Exit For                      ||20725  |                    Exit For                      
20771  |                End If                            ||20726  |                End If                            
20772  |                '累積閾値をWORKに格納(一つ前の閾値||20727  |                '累積閾値をWORKに格納(一つ前の閾値
20773  |                WorkRate = TotalRate              ||20728  |                WorkRate = TotalRate              
20774  |            Next i                                ||20729  |            Next i                                
20775  |            '累積投資顧問料 = 累積投資顧問料 + (計||20730  |            '累積投資顧問料 = 累積投資顧問料 + (計
20776  |            dblValueIn = (lCalcNav - TotalRate) * ||20731  |            dblValueIn = (lCalcNav - TotalRate) * 
20777  |            TotalCom = TotalCom + dblValueIn      ||20732  |            TotalCom = TotalCom + dblValueIn      
20778  |                                                  ||20733  |                                                  
20779  |            '投資顧問料 = 累積投資顧問料 × 計算期||20734  |            '投資顧問料 = 累積投資顧問料 × 計算期
20780  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_||20735  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_
20781  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_||20736  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_
20782  |                '一年間の日数：365日またはカレンダ||20737  |                '一年間の日数：365日またはカレンダ
20783  |                dblValueIn = TotalCom * iCalcNum /||20738  |                dblValueIn = TotalCom * iCalcNum /
20784  |            Else                                  ||20739  |            Else                                  
20785  |                '一年間の日数：360日              ||20740  |                '一年間の日数：360日              
20786  |                dblValueIn = TotalCom * iCalcNum /||20741  |                dblValueIn = TotalCom * iCalcNum /
20787  |            End If                                ||20742  |            End If                                
20788  |        End If                                    ||20743  |        End If                                    
20789  |                                                  ||20744  |                                                  
20790  |        ddblExchangeRate = 0                      ||20745  |        ddblExchangeRate = 0                      
20791  |                                                  ||20746  |                                                  
20792  |        '@@@@@ 外部委託顧問料に換算 @@@@@         ||20747  |        '@@@@@ 外部委託顧問料に換算 @@@@@         
20793  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||20748  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
20794  |          Case "1"    '固定料率                   ||20749  |          Case "1"    '固定料率                   
20795  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o||20750  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o
20796  |                Else                              ||20751  |                Else                              
20797  |                  '外部委託顧問料通貨→JPYの為替レ||20752  |                  '外部委託顧問料通貨→JPYの為替レ
20798  |                  dstrCurrencyCode = gbuMGetUPDRec||20753  |                  dstrCurrencyCode = gbuMGetUPDRec
20799  |                  ddblExchangeRate = fnstrExchange||20754  |                  ddblExchangeRate = fnstrExchange
20800  |                  If ddblExchangeRate = 0 Then    ||20755  |                  If ddblExchangeRate = 0 Then    
20801  |                    intRtn = MsgBox("ＴＴＭが取得 ||20756  |                    intRtn = MsgBox("ＴＴＭが取得 
20802  |                    vbLf & "対象通貨コード ： [ " ||20757  |                    vbLf & "対象通貨コード ： [ " 
20803  |                    vbLf & "基準日 ： [ " & Mid(ds||20758  |                    vbLf & "基準日 ： [ " & Mid(ds
20804  |                        vbCritical, "ＴＴＭ取得エ ||20759  |                        vbCritical, "ＴＴＭ取得エ 
20805  |                    Exit Function                 ||20760  |                    Exit Function                 
20806  |                  End If                          ||20761  |                  End If                          
20807  |                  'JPY→閾値通貨へ逆レート換算    ||20762  |                  'JPY→閾値通貨へ逆レート換算    
20808  |                  dblValueIn = dblValueIn / ddblEx||20763  |                  dblValueIn = dblValueIn / ddblEx
20809  |                End If                            ||20764  |                End If                            
20810  |                                                  ||20765  |                                                  
20811  |          Case "2"    '段階料率                   ||20766  |          Case "2"    '段階料率                   
20812  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||20767  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
20813  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||20768  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
20814  |                Else                              ||20769  |                Else                              
20815  |                    '閾値通貨→JPYの為替レートを取||20770  |                    '閾値通貨→JPYの為替レートを取
20816  |                    dstrCurrencyCode = gbuMGetUPDR||20771  |                    dstrCurrencyCode = gbuMGetUPDR
20817  |                    ddblExchangeRate = fnstrExchan||20772  |                    ddblExchangeRate = fnstrExchan
20818  |                    'JPY→閾値通貨へ逆レート換算  ||20773  |                    'JPY→閾値通貨へ逆レート換算  
20819  |                    dblValueIn = dblValueIn / ddbl||20774  |                    dblValueIn = dblValueIn / ddbl
20820  |                End If                            ||20775  |                End If                            
20821  |            Else                                  ||20776  |            Else                                  
20822  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||20777  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
20823  |                    '外部委託顧問料通貨→JPYの為替||20778  |                    '外部委託顧問料通貨→JPYの為替
20824  |                    dstrCurrencyCode = gbuMGetUPDR||20779  |                    dstrCurrencyCode = gbuMGetUPDR
20825  |                    ddblExchangeRate = fnstrExchan||20780  |                    ddblExchangeRate = fnstrExchan
20826  |                    'JPY→閾値通貨へレート換算    ||20781  |                    'JPY→閾値通貨へレート換算    
20827  |                    dblValueIn = dblValueIn / ddbl||20782  |                    dblValueIn = dblValueIn / ddbl
20828  |                Else                              ||20783  |                Else                              
20829  |                    '閾値通貨→JPYの為替レートを取||20784  |                    '閾値通貨→JPYの為替レートを取
20830  |                    dstrCurrencyCode = gbuMGetUPDR||20785  |                    dstrCurrencyCode = gbuMGetUPDR
20831  |                    ddblExchangeRate = fnstrExchan||20786  |                    ddblExchangeRate = fnstrExchan
20832  |                    'JPY→閾値通貨へ逆レート換算  ||20787  |                    'JPY→閾値通貨へ逆レート換算  
20833  |                    dblValueIn = dblValueIn * ddbl||20788  |                    dblValueIn = dblValueIn * ddbl
20834  |                    '外部委託顧問料通貨→JPYの為替||20789  |                    '外部委託顧問料通貨→JPYの為替
20835  |                    dstrCurrencyCode = gbuMGetUPDR||20790  |                    dstrCurrencyCode = gbuMGetUPDR
20836  |                    ddblExchangeRate = fnstrExchan||20791  |                    ddblExchangeRate = fnstrExchan
20837  |                    'JPY→閾値通貨へ逆レート換算  ||20792  |                    'JPY→閾値通貨へ逆レート換算  
20838  |                    dblValueIn = dblValueIn / ddbl||20793  |                    dblValueIn = dblValueIn / ddbl
20839  |                End If                            ||20794  |                End If                            
20840  |            End If                                ||20795  |            End If                                
20841  |                                                  ||20796  |                                                  
20842  |        End Select                                ||20797  |        End Select                                
20843  |        '@@@@@ 外部委託顧問料に換算 @@@@@         ||20798  |        '@@@@@ 外部委託顧問料に換算 @@@@@         
20844  |        Call sbGetRoundValue2(dblValueIn)         ||20799  |        Call sbGetRoundValue2(dblValueIn)         
20845  |        mstrMonthlyPayCom = dblValueOut           ||20800  |        mstrMonthlyPayCom = dblValueOut           
20846  |                                                  ||20801  |                                                  
20847  |        TotalRate = 0                             ||20802  |        TotalRate = 0                             
20848  |        '固定料率                                 ||20803  |        '固定料率                                 
20849  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat||20804  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat
20850  |            '年率1行固定                          ||20805  |            '年率1行固定                          
20851  |            '文言の冗長化でピリオド及び、名称を二 ||20806  |            '文言の冗長化でピリオド及び、名称を二 
20852  |'            .Cells(15, 13).Value = _             ||20807  |'            .Cells(15, 13).Value = _             
20853  |'                Format(gbuOtherComRateGetUPDRec.N||20808  |'                Format(gbuOtherComRateGetUPDRec.N
20854  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||20809  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
20855  |            '取得NAV区分が4:日次時価総額平均の場合||20810  |            '取得NAV区分が4:日次時価総額平均の場合
20856  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g||20811  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g
20857  |            .Cells(15, 15).Value = _              ||20812  |            .Cells(15, 15).Value = _              
20858  |                Format(gbuOtherComRateGetUPDRec.N(||20813  |                Format(gbuOtherComRateGetUPDRec.N(
20859  |            Else                                  ||20814  |            Else                                  
20860  |            .Cells(15, 15).Value = _              ||20815  |            .Cells(15, 15).Value = _              
20861  |                Format(gbuOtherComRateGetUPDRec.N(||20816  |                Format(gbuOtherComRateGetUPDRec.N(
20862  |            End If                                ||20817  |            End If                                
20863  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||20818  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
20864  |        '段階料率                                 ||20819  |        '段階料率                                 
20865  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other||20820  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other
20866  |            '料率順位のデータ数により処理を分岐   ||20821  |            '料率順位のデータ数により処理を分岐   
20867  |            iRowCnt = 0                           ||20822  |            iRowCnt = 0                           
20868  |                                                  ||20823  |                                                  
20869  |                For i = LBound(gbuOtherComRateGetU||20824  |                For i = LBound(gbuOtherComRateGetU
20870  |                    If i = 0 Then                 ||20825  |                    If i = 0 Then                 
20871  |                        '年率1行目                ||20826  |                        '年率1行目                
20872  |                                                  ||20827  |                                                  
20873  |                        Select Case gbuMGetUPDRec.||20828  |                        Select Case gbuMGetUPDRec.
20874  |                            '文言の冗長化でピリオ ||20829  |                            '文言の冗長化でピリオ 
20875  |                            Case cAud             ||20830  |                            Case cAud             
20876  |                                .Cells(15, 15).Val||20831  |                                .Cells(15, 15).Val
20877  |                                    sWord26a & CSt||20832  |                                    sWord26a & CSt
20878  |                                    sAuda & sWord2||20833  |                                    sAuda & sWord2
20879  |                            Case cCad             ||20834  |                            Case cCad             
20880  |                                .Cells(15, 15).Val||20835  |                                .Cells(15, 15).Val
20881  |                                    sWord26a & CSt||20836  |                                    sWord26a & CSt
20882  |                                    sCada & sWord2||20837  |                                    sCada & sWord2
20883  |                            Case cChf             ||20838  |                            Case cChf             
20884  |                                .Cells(15, 15).Val||20839  |                                .Cells(15, 15).Val
20885  |                                    sWord26a & CSt||20840  |                                    sWord26a & CSt
20886  |                                    sChfa & sWord2||20841  |                                    sChfa & sWord2
20887  |                            Case cEur             ||20842  |                            Case cEur             
20888  |                                .Cells(15, 15).Val||20843  |                                .Cells(15, 15).Val
20889  |                                    sWord26a & CSt||20844  |                                    sWord26a & CSt
20890  |                                    sEura & sWord2||20845  |                                    sEura & sWord2
20891  |                            Case cGbp             ||20846  |                            Case cGbp             
20892  |                                .Cells(15, 15).Val||20847  |                                .Cells(15, 15).Val
20893  |                                    sWord26a & CSt||20848  |                                    sWord26a & CSt
20894  |                                    sGbpa & sWord2||20849  |                                    sGbpa & sWord2
20895  |                            Case cHkd             ||20850  |                            Case cHkd             
20896  |                                .Cells(15, 15).Val||20851  |                                .Cells(15, 15).Val
20897  |                                    sWord26a & CSt||20852  |                                    sWord26a & CSt
20898  |                                    sHkda & sWord2||20853  |                                    sHkda & sWord2
20899  |                            Case cJpy             ||20854  |                            Case cJpy             
20900  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||20855  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
20901  |                                '取得NAV区分が4:日||20856  |                                '取得NAV区分が4:日
20902  |                                If gbuMGetUPDRec.N||20857  |                                If gbuMGetUPDRec.N
20903  |                                    .Cells(15, 15)||20858  |                                    .Cells(15, 15)
20904  |                                        sWord26a &||20859  |                                        sWord26a &
20905  |                                        sYena & sW||20860  |                                        sYena & sW
20906  |                                Else              ||20861  |                                Else              
20907  |                                    .Cells(15, 15)||20862  |                                    .Cells(15, 15)
20908  |                                        sWord26a &||20863  |                                        sWord26a &
20909  |                                        sYena & sW||20864  |                                        sYena & sW
20910  |                                End If            ||20865  |                                End If            
20911  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||20866  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
20912  |                            Case cMyr             ||20867  |                            Case cMyr             
20913  |                                .Cells(15, 15).Val||20868  |                                .Cells(15, 15).Val
20914  |                                    sWord26a & CSt||20869  |                                    sWord26a & CSt
20915  |                                    sMyra & sWord2||20870  |                                    sMyra & sWord2
20916  |                            Case cNzd             ||20871  |                            Case cNzd             
20917  |                                .Cells(15, 15).Val||20872  |                                .Cells(15, 15).Val
20918  |                                    sWord26a & CSt||20873  |                                    sWord26a & CSt
20919  |                                    sNzda & sWord2||20874  |                                    sNzda & sWord2
20920  |                            Case cSek             ||20875  |                            Case cSek             
20921  |                                .Cells(15, 15).Val||20876  |                                .Cells(15, 15).Val
20922  |                                    sWord26a & CSt||20877  |                                    sWord26a & CSt
20923  |                                    sSeka & sWord2||20878  |                                    sSeka & sWord2
20924  |                            Case cSgd             ||20879  |                            Case cSgd             
20925  |                                .Cells(15, 15).Val||20880  |                                .Cells(15, 15).Val
20926  |                                    sWord26a & CSt||20881  |                                    sWord26a & CSt
20927  |                                    sSgda & sWord2||20882  |                                    sSgda & sWord2
20928  |                            Case cUsd             ||20883  |                            Case cUsd             
20929  |                                .Cells(15, 15).Val||20884  |                                .Cells(15, 15).Val
20930  |                                    sWord26a & CSt||20885  |                                    sWord26a & CSt
20931  |                                    sUsda & sWord2||20886  |                                    sUsda & sWord2
20932  |                            Case cNok             ||20887  |                            Case cNok             
20933  |                                .Cells(15, 15).Val||20888  |                                .Cells(15, 15).Val
20934  |                                    sWord26a & CSt||20889  |                                    sWord26a & CSt
20935  |                                    sNoka & sWord2||20890  |                                    sNoka & sWord2
20936  |                        End Select                ||20891  |                        End Select                
20937  |                                                  ||20892  |                                                  
20938  |                        '年率　累積値セット       ||20893  |                        '年率　累積値セット       
20939  |                        TotalRate = CCur(gbuOtherC||20894  |                        TotalRate = CCur(gbuOtherC
20940  |                    ElseIf i = UBound(gbuOtherComR||20895  |                    ElseIf i = UBound(gbuOtherComR
20941  |                        If UBound(gbuOtherComRateG||20896  |                        If UBound(gbuOtherComRateG
20942  |                            '年率最終行           ||20897  |                            '年率最終行           
20943  |                                                  ||20898  |                                                  
20944  |                            '前半金額部分         ||20899  |                            '前半金額部分         
20945  |                            '文言の冗長化でピリオ ||20900  |                            '文言の冗長化でピリオ 
20946  |                            .Cells(15 + i + UBound||20901  |                            .Cells(15 + i + UBound
20947  |                                                  ||20902  |                                                  
20948  |                            '文言の冗長化でピリオ ||20903  |                            '文言の冗長化でピリオ 
20949  |                            If gbuMGetUPDRec.N(lRe||20904  |                            If gbuMGetUPDRec.N(lRe
20950  |                                .Cells(15 + i + UB||20905  |                                .Cells(15 + i + UB
20951  |                            Else                  ||20906  |                            Else                  
20952  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||20907  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
20953  |                                '取得NAV区分が4:日||20908  |                                '取得NAV区分が4:日
20954  |                                If gbuMGetUPDRec.N||20909  |                                If gbuMGetUPDRec.N
20955  |                                    .Cells(15 + i ||20910  |                                    .Cells(15 + i 
20956  |                                Else              ||20911  |                                Else              
20957  |                                    .Cells(15 + i ||20912  |                                    .Cells(15 + i 
20958  |                                End If            ||20913  |                                End If            
20959  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||20914  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
20960  |                            End If                ||20915  |                            End If                
20961  |                                                  ||20916  |                                                  
20962  |                            '後半の文言           ||20917  |                            '後半の文言           
20963  |                            Select Case gbuMGetUPD||20918  |                            Select Case gbuMGetUPD
20964  |                                '文言の冗長化でピ ||20919  |                                '文言の冗長化でピ 
20965  |                                Case cAud         ||20920  |                                Case cAud         
20966  |                                    .Cells(15 + i ||20921  |                                    .Cells(15 + i 
20967  |                                         sAuda & "||20922  |                                         sAuda & "
20968  |                                Case cCad         ||20923  |                                Case cCad         
20969  |                                    .Cells(15 + i ||20924  |                                    .Cells(15 + i 
20970  |                                         sCada & "||20925  |                                         sCada & "
20971  |                                Case cChf         ||20926  |                                Case cChf         
20972  |                                    .Cells(15 + i ||20927  |                                    .Cells(15 + i 
20973  |                                         sChfa & "||20928  |                                         sChfa & "
20974  |                                Case cEur         ||20929  |                                Case cEur         
20975  |                                    .Cells(15 + i ||20930  |                                    .Cells(15 + i 
20976  |                                         sEura & "||20931  |                                         sEura & "
20977  |                                Case cGbp         ||20932  |                                Case cGbp         
20978  |                                    .Cells(15 + i ||20933  |                                    .Cells(15 + i 
20979  |                                         sGbpa & "||20934  |                                         sGbpa & "
20980  |                                Case cHkd         ||20935  |                                Case cHkd         
20981  |                                    .Cells(15 + i ||20936  |                                    .Cells(15 + i 
20982  |                                         sHkda & "||20937  |                                         sHkda & "
20983  |                                Case cJpy         ||20938  |                                Case cJpy         
20984  |                                    .Cells(15 + i ||20939  |                                    .Cells(15 + i 
20985  |                                         sYena & "||20940  |                                         sYena & "
20986  |                                Case cMyr         ||20941  |                                Case cMyr         
20987  |                                    .Cells(15 + i ||20942  |                                    .Cells(15 + i 
20988  |                                         sMyra & "||20943  |                                         sMyra & "
20989  |                                Case cNzd         ||20944  |                                Case cNzd         
20990  |                                    .Cells(15 + i ||20945  |                                    .Cells(15 + i 
20991  |                                         sNzda & "||20946  |                                         sNzda & "
20992  |                                Case cSek         ||20947  |                                Case cSek         
20993  |                                    .Cells(15 + i ||20948  |                                    .Cells(15 + i 
20994  |                                         sSeka & "||20949  |                                         sSeka & "
20995  |                                Case cSgd         ||20950  |                                Case cSgd         
20996  |                                    .Cells(15 + i ||20951  |                                    .Cells(15 + i 
20997  |                                         sSgda & "||20952  |                                         sSgda & "
20998  |                                Case cUsd         ||20953  |                                Case cUsd         
20999  |                                    .Cells(15 + i ||20954  |                                    .Cells(15 + i 
21000  |                                         sUsda & "||20955  |                                         sUsda & "
21001  |                                Case cNok         ||20956  |                                Case cNok         
21002  |                                    .Cells(15 + i ||20957  |                                    .Cells(15 + i 
21003  |                                         sNoka & "||20958  |                                         sNoka & "
21004  |                            End Select            ||20959  |                            End Select            
21005  |                        Else                      ||20960  |                        Else                      
21006  |                            '年率最終行           ||20961  |                            '年率最終行           
21007  |                            '前半金額部分         ||20962  |                            '前半金額部分         
21008  |                            .Cells(15 + i + UBound||20963  |                            .Cells(15 + i + UBound
21009  |                            '文言の冗長化でピリオ ||20964  |                            '文言の冗長化でピリオ 
21010  |                            If gbuMGetUPDRec.N(lRe||20965  |                            If gbuMGetUPDRec.N(lRe
21011  |                                .Cells(15 + i + UB||20966  |                                .Cells(15 + i + UB
21012  |                            Else                  ||20967  |                            Else                  
21013  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||20968  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
21014  |                                '取得NAV区分が4:日||20969  |                                '取得NAV区分が4:日
21015  |                                If gbuMGetUPDRec.N||20970  |                                If gbuMGetUPDRec.N
21016  |                                    .Cells(15 + i ||20971  |                                    .Cells(15 + i 
21017  |                                Else              ||20972  |                                Else              
21018  |                                    .Cells(15 + i ||20973  |                                    .Cells(15 + i 
21019  |                                End If            ||20974  |                                End If            
21020  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||20975  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
21021  |                            End If                ||20976  |                            End If                
21022  |                                                  ||20977  |                                                  
21023  |                            '後半の文言           ||20978  |                            '後半の文言           
21024  |                            '文言の冗長化でピリオ ||20979  |                            '文言の冗長化でピリオ 
21025  |                            .Cells(15 + i + UBound||20980  |                            .Cells(15 + i + UBound
21026  |                                                  ||20981  |                                                  
21027  |                            Select Case gbuMGetUPD||20982  |                            Select Case gbuMGetUPD
21028  |                                '文言の冗長化でピ ||20983  |                                '文言の冗長化でピ 
21029  |                                Case cAud         ||20984  |                                Case cAud         
21030  |                                    .Cells(15 + i ||20985  |                                    .Cells(15 + i 
21031  |                                         sAuda & "||20986  |                                         sAuda & "
21032  |                                Case cCad         ||20987  |                                Case cCad         
21033  |                                    .Cells(15 + i ||20988  |                                    .Cells(15 + i 
21034  |                                         sCada & "||20989  |                                         sCada & "
21035  |                                Case cChf         ||20990  |                                Case cChf         
21036  |                                    .Cells(15 + i ||20991  |                                    .Cells(15 + i 
21037  |                                         sChfa & "||20992  |                                         sChfa & "
21038  |                                Case cEur         ||20993  |                                Case cEur         
21039  |                                    .Cells(15 + i ||20994  |                                    .Cells(15 + i 
21040  |                                         sEura & "||20995  |                                         sEura & "
21041  |                                Case cGbp         ||20996  |                                Case cGbp         
21042  |                                    .Cells(15 + i ||20997  |                                    .Cells(15 + i 
21043  |                                         sGbpa & "||20998  |                                         sGbpa & "
21044  |                                Case cHkd         ||20999  |                                Case cHkd         
21045  |                                    .Cells(15 + i ||21000  |                                    .Cells(15 + i 
21046  |                                         sHkda & "||21001  |                                         sHkda & "
21047  |                                Case cJpy         ||21002  |                                Case cJpy         
21048  |                                    .Cells(15 + i ||21003  |                                    .Cells(15 + i 
21049  |                                         sYena & "||21004  |                                         sYena & "
21050  |                                Case cMyr         ||21005  |                                Case cMyr         
21051  |                                    .Cells(15 + i ||21006  |                                    .Cells(15 + i 
21052  |                                         sMyra & "||21007  |                                         sMyra & "
21053  |                                Case cNzd         ||21008  |                                Case cNzd         
21054  |                                    .Cells(15 + i ||21009  |                                    .Cells(15 + i 
21055  |                                         sNzda & "||21010  |                                         sNzda & "
21056  |                                Case cSek         ||21011  |                                Case cSek         
21057  |                                    .Cells(15 + i ||21012  |                                    .Cells(15 + i 
21058  |                                         sSeka & "||21013  |                                         sSeka & "
21059  |                                Case cSgd         ||21014  |                                Case cSgd         
21060  |                                    .Cells(15 + i ||21015  |                                    .Cells(15 + i 
21061  |                                         sSgda & "||21016  |                                         sSgda & "
21062  |                                Case cUsd         ||21017  |                                Case cUsd         
21063  |                                    .Cells(15 + i ||21018  |                                    .Cells(15 + i 
21064  |                                         sUsda & "||21019  |                                         sUsda & "
21065  |                                Case cNok         ||21020  |                                Case cNok         
21066  |                                    .Cells(15 + i ||21021  |                                    .Cells(15 + i 
21067  |                                         sNoka & "||21022  |                                         sNoka & "
21068  |                            End Select            ||21023  |                            End Select            
21069  |                        End If                    ||21024  |                        End If                    
21070  |                    Else                          ||21025  |                    Else                          
21071  |                                                  ||21026  |                                                  
21072  |                        '年率2行目以降            ||21027  |                        '年率2行目以降            
21073  |                        '前半金額部分             ||21028  |                        '前半金額部分             
21074  |                        '文言の冗長化でピリオド及 ||21029  |                        '文言の冗長化でピリオド及 
21075  |                        .Cells(15 + i + (i - 1), 1||21030  |                        .Cells(15 + i + (i - 1), 1
21076  |                                                  ||21031  |                                                  
21077  |                        '文言の冗長化でピリオド及 ||21032  |                        '文言の冗長化でピリオド及 
21078  |                        If gbuMGetUPDRec.N(lRecIdx||21033  |                        If gbuMGetUPDRec.N(lRecIdx
21079  |                            .Cells(15 + i + (i - 1||21034  |                            .Cells(15 + i + (i - 1
21080  |                              sWord28a & CStr(Form||21035  |                              sWord28a & CStr(Form
21081  |                        Else                      ||21036  |                        Else                      
21082  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||21037  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
21083  |                            '取得NAV区分が4:日次時||21038  |                            '取得NAV区分が4:日次時
21084  |                            If gbuMGetUPDRec.N(lRe||21039  |                            If gbuMGetUPDRec.N(lRe
21085  |                                .Cells(15 + i + (i||21040  |                                .Cells(15 + i + (i
21086  |                                  sWord66a & CStr(||21041  |                                  sWord66a & CStr(
21087  |                            Else                  ||21042  |                            Else                  
21088  |                                .Cells(15 + i + (i||21043  |                                .Cells(15 + i + (i
21089  |                                  sWord28a & CStr(||21044  |                                  sWord28a & CStr(
21090  |                            End If                ||21045  |                            End If                
21091  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||21046  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
21092  |                        End If                    ||21047  |                        End If                    
21093  |                                                  ||21048  |                                                  
21094  |                        '年率　累積値セット       ||21049  |                        '年率　累積値セット       
21095  |                        TotalRate = TotalRate + CC||21050  |                        TotalRate = TotalRate + CC
21096  |                        '後半の文言               ||21051  |                        '後半の文言               
21097  |                        '文言の冗長化でピリオド及 ||21052  |                        '文言の冗長化でピリオド及 
21098  |                        .Cells(15 + i + i, 15).Num||21053  |                        .Cells(15 + i + i, 15).Num
21099  |                        Select Case gbuMGetUPDRec.||21054  |                        Select Case gbuMGetUPDRec.
21100  |                            '文言の冗長化でピリオ ||21055  |                            '文言の冗長化でピリオ 
21101  |                            Case cAud             ||21056  |                            Case cAud             
21102  |                                .Cells(15 + i + i,||21057  |                                .Cells(15 + i + i,
21103  |                                    sAuda & sWord2||21058  |                                    sAuda & sWord2
21104  |                                    Format(gbuOthe||21059  |                                    Format(gbuOthe
21105  |                            Case cCad             ||21060  |                            Case cCad             
21106  |                                .Cells(15 + i + i,||21061  |                                .Cells(15 + i + i,
21107  |                                    sCada & sWord2||21062  |                                    sCada & sWord2
21108  |                                    Format(gbuOthe||21063  |                                    Format(gbuOthe
21109  |                            Case cChf             ||21064  |                            Case cChf             
21110  |                                .Cells(15 + i + i,||21065  |                                .Cells(15 + i + i,
21111  |                                    sChfa & sWord2||21066  |                                    sChfa & sWord2
21112  |                                    Format(gbuOthe||21067  |                                    Format(gbuOthe
21113  |                            Case cEur             ||21068  |                            Case cEur             
21114  |                                .Cells(15 + i + i,||21069  |                                .Cells(15 + i + i,
21115  |                                    sEura & sWord2||21070  |                                    sEura & sWord2
21116  |                                    Format(gbuOthe||21071  |                                    Format(gbuOthe
21117  |                            Case cGbp             ||21072  |                            Case cGbp             
21118  |                                .Cells(15 + i + i,||21073  |                                .Cells(15 + i + i,
21119  |                                    sGbpa & sWord2||21074  |                                    sGbpa & sWord2
21120  |                                    Format(gbuOthe||21075  |                                    Format(gbuOthe
21121  |                            Case cHkd             ||21076  |                            Case cHkd             
21122  |                                .Cells(15 + i + i,||21077  |                                .Cells(15 + i + i,
21123  |                                    sHkda & sWord2||21078  |                                    sHkda & sWord2
21124  |                                    Format(gbuOthe||21079  |                                    Format(gbuOthe
21125  |                            Case cJpy             ||21080  |                            Case cJpy             
21126  |                                .Cells(15 + i + i,||21081  |                                .Cells(15 + i + i,
21127  |                                    sYena & sWord2||21082  |                                    sYena & sWord2
21128  |                                    Format(gbuOthe||21083  |                                    Format(gbuOthe
21129  |                            Case cMyr             ||21084  |                            Case cMyr             
21130  |                                .Cells(15 + i + i,||21085  |                                .Cells(15 + i + i,
21131  |                                    sMyra & sWord2||21086  |                                    sMyra & sWord2
21132  |                                    Format(gbuOthe||21087  |                                    Format(gbuOthe
21133  |                            Case cNzd             ||21088  |                            Case cNzd             
21134  |                                .Cells(15 + i + i,||21089  |                                .Cells(15 + i + i,
21135  |                                    sNzda & sWord2||21090  |                                    sNzda & sWord2
21136  |                                    Format(gbuOthe||21091  |                                    Format(gbuOthe
21137  |                            Case cSek             ||21092  |                            Case cSek             
21138  |                                .Cells(15 + i + i,||21093  |                                .Cells(15 + i + i,
21139  |                                    sSeka & sWord2||21094  |                                    sSeka & sWord2
21140  |                                    Format(gbuOthe||21095  |                                    Format(gbuOthe
21141  |                            Case cSgd             ||21096  |                            Case cSgd             
21142  |                                .Cells(15 + i + i,||21097  |                                .Cells(15 + i + i,
21143  |                                    sSgda & sWord2||21098  |                                    sSgda & sWord2
21144  |                                    Format(gbuOthe||21099  |                                    Format(gbuOthe
21145  |                            Case cUsd             ||21100  |                            Case cUsd             
21146  |                                .Cells(15 + i + i,||21101  |                                .Cells(15 + i + i,
21147  |                                    sUsda & sWord2||21102  |                                    sUsda & sWord2
21148  |                                    Format(gbuOthe||21103  |                                    Format(gbuOthe
21149  |                            Case cNok             ||21104  |                            Case cNok             
21150  |                                .Cells(15 + i + i,||21105  |                                .Cells(15 + i + i,
21151  |                                    sNoka & sWord2||21106  |                                    sNoka & sWord2
21152  |                                    Format(gbuOthe||21107  |                                    Format(gbuOthe
21153  |                        End Select                ||21108  |                        End Select                
21154  |                    End If                        ||21109  |                    End If                        
21155  |                Next i                            ||21110  |                Next i                            
21156  |            End If                                ||21111  |            End If                                
21157  |                                                  ||21112  |                                                  
21158  |        '投資顧問料                               ||21113  |        '投資顧問料                               
21159  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||21114  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
21160  |            Case Mid(mstrContractFlag(1), 1, 1)   ||21115  |            Case Mid(mstrContractFlag(1), 1, 1)   
21161  |                .Cells(46, 2).Value = sWord11d    ||21116  |                .Cells(46, 2).Value = sWord11d    
21162  |            Case Mid(mstrContractFlag(2), 1, 1)   ||21117  |            Case Mid(mstrContractFlag(2), 1, 1)   
21163  |                .Cells(46, 2).Value = sWord11e    ||21118  |                .Cells(46, 2).Value = sWord11e    
21164  |            Case Mid(mstrContractFlag(3), 1, 1)   ||21119  |            Case Mid(mstrContractFlag(3), 1, 1)   
21165  |                .Cells(46, 2).Value = sWord11f    ||21120  |                .Cells(46, 2).Value = sWord11f    
21166  |            Case Else                             ||21121  |            Case Else                             
21167  |                MsgBox "契約区分が不正です。", vbC||21122  |                MsgBox "契約区分が不正です。", vbC
21168  |        End Select                                ||21123  |        End Select                                
21169  |        '文言の冗長化でピリオド及び、名称を二列右 ||21124  |        '文言の冗長化でピリオド及び、名称を二列右 
21170  |'        .Cells(46, 11).Value = sWord19           ||21125  |'        .Cells(46, 11).Value = sWord19           
21171  |        .Cells(46, 13).Value = sWord19            ||21126  |        .Cells(46, 13).Value = sWord19            
21172  |                                                  ||21127  |                                                  
21173  |        '外部委託顧問料                           ||21128  |        '外部委託顧問料                           
21174  |        '文言の冗長化でピリオド及び、名称を二列右 ||21129  |        '文言の冗長化でピリオド及び、名称を二列右 
21175  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||21130  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
21176  |'            .Cells(46, 31).NumberFormatLocal = "@||21131  |'            .Cells(46, 31).NumberFormatLocal = "@
21177  |'        Else                                     ||21132  |'        Else                                     
21178  |'            .Cells(46, 29).NumberFormatLocal = "@||21133  |'            .Cells(46, 29).NumberFormatLocal = "@
21179  |'        End If                                   ||21134  |'        End If                                   
21180  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||21135  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
21181  |            .Cells(46, 33).NumberFormatLocal = "@"||21136  |            .Cells(46, 33).NumberFormatLocal = "@"
21182  |        Else                                      ||21137  |        Else                                      
21183  |            .Cells(46, 31).NumberFormatLocal = "@"||21138  |            .Cells(46, 31).NumberFormatLocal = "@"
21184  |        End If                                    ||21139  |        End If                                    
21185  |                                                  ||21140  |                                                  
21186  |        '契約区分が名称使用許諾料の場合上限・下限 ||21141  |        '契約区分が名称使用許諾料の場合上限・下限 
21187  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||21142  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
21188  |            '下限金額より換算した金額が小さい場合 ||21143  |            '下限金額より換算した金額が小さい場合 
21189  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_f||21144  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_f
21190  |                If mstrMonthlyPayCom < CDbl(gbuMGe||21145  |                If mstrMonthlyPayCom < CDbl(gbuMGe
21191  |                    mstrMonthlyPayCom = CDbl(gbuMG||21146  |                    mstrMonthlyPayCom = CDbl(gbuMG
21192  |                End If                            ||21147  |                End If                            
21193  |            End If                                ||21148  |            End If                                
21194  |            '上限金額より換算した金額が大きい場合 ||21149  |            '上限金額より換算した金額が大きい場合 
21195  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_c||21150  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_c
21196  |                If mstrMonthlyPayCom > CDbl(gbuMGe||21151  |                If mstrMonthlyPayCom > CDbl(gbuMGe
21197  |                    mstrMonthlyPayCom = CDbl(gbuMG||21152  |                    mstrMonthlyPayCom = CDbl(gbuMG
21198  |                End If                            ||21153  |                End If                            
21199  |            End If                                ||21154  |            End If                                
21200  |                                                  ||21155  |                                                  
21201  |            dblValueIn = CDbl(mstrMonthlyPayCom)  ||21156  |            dblValueIn = CDbl(mstrMonthlyPayCom)  
21202  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||21157  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
21203  |                Call sbGetRoundValue2(dblValueIn) ||21158  |                Call sbGetRoundValue2(dblValueIn) 
21204  |            Else                                  ||21159  |            Else                                  
21205  |                Call sbGetRoundValue(dblValueIn)  ||21160  |                Call sbGetRoundValue(dblValueIn)  
21206  |            End If                                ||21161  |            End If                                
21207  |            mstrMonthlyPayCom = dblValueOut       ||21162  |            mstrMonthlyPayCom = dblValueOut       
21208  |                                                  ||21163  |                                                  
21209  |        End If                                    ||21164  |        End If                                    
21210  |                                                  ||21165  |                                                  
21211  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||21166  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
21212  |            '文言の冗長化でピリオド及び、名称を二 ||21167  |            '文言の冗長化でピリオド及び、名称を二 
21213  |            Case cAud                             ||21168  |            Case cAud                             
21214  |                .Cells(46, 33).Value = CStr(Format||21169  |                .Cells(46, 33).Value = CStr(Format
21215  |                .Cells(46, 34).Value = sAuda      ||21170  |                .Cells(46, 34).Value = sAuda      
21216  |            Case cCad                             ||21171  |            Case cCad                             
21217  |                .Cells(46, 33).Value = CStr(Format||21172  |                .Cells(46, 33).Value = CStr(Format
21218  |                .Cells(46, 34).Value = sCada      ||21173  |                .Cells(46, 34).Value = sCada      
21219  |            Case cChf                             ||21174  |            Case cChf                             
21220  |                .Cells(46, 33).Value = CStr(Format||21175  |                .Cells(46, 33).Value = CStr(Format
21221  |                .Cells(46, 34).Value = sChfa      ||21176  |                .Cells(46, 34).Value = sChfa      
21222  |            Case cEur                             ||21177  |            Case cEur                             
21223  |                .Cells(46, 33).Value = CStr(Format||21178  |                .Cells(46, 33).Value = CStr(Format
21224  |                .Cells(46, 34).Value = sEura      ||21179  |                .Cells(46, 34).Value = sEura      
21225  |            Case cGbp                             ||21180  |            Case cGbp                             
21226  |                .Cells(46, 33).Value = CStr(Format||21181  |                .Cells(46, 33).Value = CStr(Format
21227  |                .Cells(46, 34).Value = sGbpa      ||21182  |                .Cells(46, 34).Value = sGbpa      
21228  |            Case cHkd                             ||21183  |            Case cHkd                             
21229  |                .Cells(46, 33).Value = CStr(Format||21184  |                .Cells(46, 33).Value = CStr(Format
21230  |                .Cells(46, 34).Value = sHkda      ||21185  |                .Cells(46, 34).Value = sHkda      
21231  |            Case cJpy                             ||21186  |            Case cJpy                             
21232  |                .Cells(46, 31).Value = CStr(Format||21187  |                .Cells(46, 31).Value = CStr(Format
21233  |                .Cells(46, 34).Value = sYena      ||21188  |                .Cells(46, 34).Value = sYena      
21234  |            Case cMyr                             ||21189  |            Case cMyr                             
21235  |                .Cells(46, 33).Value = CStr(Format||21190  |                .Cells(46, 33).Value = CStr(Format
21236  |                .Cells(46, 34).Value = sMyra      ||21191  |                .Cells(46, 34).Value = sMyra      
21237  |            Case cNzd                             ||21192  |            Case cNzd                             
21238  |                .Cells(46, 33).Value = CStr(Format||21193  |                .Cells(46, 33).Value = CStr(Format
21239  |                .Cells(46, 34).Value = sNzda      ||21194  |                .Cells(46, 34).Value = sNzda      
21240  |            Case cSek                             ||21195  |            Case cSek                             
21241  |                .Cells(46, 33).Value = CStr(Format||21196  |                .Cells(46, 33).Value = CStr(Format
21242  |                .Cells(46, 34).Value = sSeka      ||21197  |                .Cells(46, 34).Value = sSeka      
21243  |            Case cSgd                             ||21198  |            Case cSgd                             
21244  |                .Cells(46, 33).Value = CStr(Format||21199  |                .Cells(46, 33).Value = CStr(Format
21245  |                .Cells(46, 34).Value = sSgda      ||21200  |                .Cells(46, 34).Value = sSgda      
21246  |            Case cUsd                             ||21201  |            Case cUsd                             
21247  |                .Cells(46, 33).Value = CStr(Format||21202  |                .Cells(46, 33).Value = CStr(Format
21248  |                .Cells(46, 34).Value = sUsda      ||21203  |                .Cells(46, 34).Value = sUsda      
21249  |            Case cNok                             ||21204  |            Case cNok                             
21250  |                .Cells(46, 33).Value = CStr(Format||21205  |                .Cells(46, 33).Value = CStr(Format
21251  |                .Cells(46, 34).Value = sNoka      ||21206  |                .Cells(46, 34).Value = sNoka      
21252  |        End Select                                ||21207  |        End Select                                
21253  |                                                  ||21208  |                                                  
21254  |        '顧問料                                   ||21209  |        '顧問料                                   
21255  |        '文言の冗長化でピリオド及び、名称を二列右 ||21210  |        '文言の冗長化でピリオド及び、名称を二列右 
21256  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||21211  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
21257  |            .Cells(46, 33).HorizontalAlignment = x||21212  |            .Cells(46, 33).HorizontalAlignment = x
21258  |        Else                                      ||21213  |        Else                                      
21259  |            .Cells(46, 31).HorizontalAlignment = x||21214  |            .Cells(46, 31).HorizontalAlignment = x
21260  |        End If                                    ||21215  |        End If                                    
21261  |                                                  ||21216  |                                                  
21262  |        '契約区分が名称使用許諾料の場合上限・下限 ||21217  |        '契約区分が名称使用許諾料の場合上限・下限 
21263  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||21218  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
21264  |            '上限金額                             ||21219  |            '上限金額                             
21265  |            '文言の冗長化でピリオド及び、名称を二 ||21220  |            '文言の冗長化でピリオド及び、名称を二 
21266  |            .Cells(46, 47).Value = sWordCapa      ||21221  |            .Cells(46, 47).Value = sWordCapa      
21267  |            .Cells(46, 59).NumberFormatLocal = "@"||21222  |            .Cells(46, 59).NumberFormatLocal = "@"
21268  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||21223  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
21269  |                .Cells(46, 59).Value = Format(gbuM||21224  |                .Cells(46, 59).Value = Format(gbuM
21270  |            Else                                  ||21225  |            Else                                  
21271  |                .Cells(46, 59).Value = Format(gbuM||21226  |                .Cells(46, 59).Value = Format(gbuM
21272  |            End If                                ||21227  |            End If                                
21273  |                                                  ||21228  |                                                  
21274  |            .Cells(46, 59).HorizontalAlignment = x||21229  |            .Cells(46, 59).HorizontalAlignment = x
21275  |                                                  ||21230  |                                                  
21276  |            '下限金額                             ||21231  |            '下限金額                             
21277  |            .Cells(47, 47).Value = sWordFloora    ||21232  |            .Cells(47, 47).Value = sWordFloora    
21278  |            .Cells(47, 59).NumberFormatLocal = "@"||21233  |            .Cells(47, 59).NumberFormatLocal = "@"
21279  |                                                  ||21234  |                                                  
21280  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||21235  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
21281  |                .Cells(47, 59).Value = Format(gbuM||21236  |                .Cells(47, 59).Value = Format(gbuM
21282  |            Else                                  ||21237  |            Else                                  
21283  |                .Cells(47, 59).Value = Format(gbuM||21238  |                .Cells(47, 59).Value = Format(gbuM
21284  |            End If                                ||21239  |            End If                                
21285  |            .Cells(47, 59).HorizontalAlignment = x||21240  |            .Cells(47, 59).HorizontalAlignment = x
21286  |        End If                                    ||21241  |        End If                                    
21287  |                                                  ||21242  |                                                  
21288  |        ddblExchangeRate = 0                      ||21243  |        ddblExchangeRate = 0                      
21289  |                                                  ||21244  |                                                  
21290  |        dblValueIn = mstrMonthlyPayCom            ||21245  |        dblValueIn = mstrMonthlyPayCom            
21291  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||21246  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
21292  |          Case "1"    '固定料率                   ||21247  |          Case "1"    '固定料率                   
21293  |                                                  ||21248  |                                                  
21294  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o||21249  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o
21295  |                Else                              ||21250  |                Else                              
21296  |                  '外部委託顧問料通貨→JPYの為替レ||21251  |                  '外部委託顧問料通貨→JPYの為替レ
21297  |                  dstrCurrencyCode = gbuMGetUPDRec||21252  |                  dstrCurrencyCode = gbuMGetUPDRec
21298  |                  ddblExchangeRate = fnstrExchange||21253  |                  ddblExchangeRate = fnstrExchange
21299  |                  If ddblExchangeRate = 0 Then    ||21254  |                  If ddblExchangeRate = 0 Then    
21300  |                    intRtn = MsgBox("ＴＴＭが取得 ||21255  |                    intRtn = MsgBox("ＴＴＭが取得 
21301  |                    vbLf & "対象通貨コード ： [ " ||21256  |                    vbLf & "対象通貨コード ： [ " 
21302  |                    vbLf & "基準日 ： [ " & Mid(ds||21257  |                    vbLf & "基準日 ： [ " & Mid(ds
21303  |                        vbCritical, "ＴＴＭ取得エ ||21258  |                        vbCritical, "ＴＴＭ取得エ 
21304  |                    Exit Function                 ||21259  |                    Exit Function                 
21305  |                  End If                          ||21260  |                  End If                          
21306  |                  'JPY→支払通貨へレート換算      ||21261  |                  'JPY→支払通貨へレート換算      
21307  |                  dblValueIn = dblValueIn * ddblEx||21262  |                  dblValueIn = dblValueIn * ddblEx
21308  |                End If                            ||21263  |                End If                            
21309  |                                                  ||21264  |                                                  
21310  |          Case "2"    '段階料率                   ||21265  |          Case "2"    '段階料率                   
21311  |                                                  ||21266  |                                                  
21312  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||21267  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
21313  |            Else                                  ||21268  |            Else                                  
21314  |                '外部委託顧問料通貨→JPYの為替レー||21269  |                '外部委託顧問料通貨→JPYの為替レー
21315  |                dstrCurrencyCode = gbuMGetUPDRec.N||21270  |                dstrCurrencyCode = gbuMGetUPDRec.N
21316  |                ddblExchangeRate = fnstrExchangeRa||21271  |                ddblExchangeRate = fnstrExchangeRa
21317  |                If ddblExchangeRate = 0 Then      ||21272  |                If ddblExchangeRate = 0 Then      
21318  |                  intRtn = MsgBox("ＴＴＭが取得で ||21273  |                  intRtn = MsgBox("ＴＴＭが取得で 
21319  |                  vbLf & "対象通貨コード ： [ " & ||21274  |                  vbLf & "対象通貨コード ： [ " & 
21320  |                  vbLf & "基準日 ： [ " & Mid(dstr||21275  |                  vbLf & "基準日 ： [ " & Mid(dstr
21321  |                      vbCritical, "ＴＴＭ取得エラ ||21276  |                      vbCritical, "ＴＴＭ取得エラ 
21322  |                  Exit Function                   ||21277  |                  Exit Function                   
21323  |                End If                            ||21278  |                End If                            
21324  |                '外部委託顧問料通貨→JPYへレート換||21279  |                '外部委託顧問料通貨→JPYへレート換
21325  |                dblValueIn = dblValueIn * ddblExch||21280  |                dblValueIn = dblValueIn * ddblExch
21326  |            End If                                ||21281  |            End If                                
21327  |                                                  ||21282  |                                                  
21328  |        End Select                                ||21283  |        End Select                                
21329  |        '@@@@@ 支払に換算 @@@@@                   ||21284  |        '@@@@@ 支払に換算 @@@@@                   
21330  |        Call sbGetRoundValue(dblValueIn)          ||21285  |        Call sbGetRoundValue(dblValueIn)          
21331  |        mstrMonthlyPayCom = dblValueOut           ||21286  |        mstrMonthlyPayCom = dblValueOut           
21332  |                                                  ||21287  |                                                  
21333  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||21288  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
21334  |                'TTMレート                        ||21289  |                'TTMレート                        
21335  |                '文言の冗長化でピリオド及び、名称 ||21290  |                '文言の冗長化でピリオド及び、名称 
21336  |                .Cells(47, 21).Value = sWord43    ||21291  |                .Cells(47, 21).Value = sWord43    
21337  |                .Cells(47, 35).NumberFormatLocal =||21292  |                .Cells(47, 35).NumberFormatLocal =
21338  |                .Cells(47, 35).Value = Format(ddbl||21293  |                .Cells(47, 35).Value = Format(ddbl
21339  |                .Cells(47, 35).HorizontalAlignment||21294  |                .Cells(47, 35).HorizontalAlignment
21340  |                .Cells(47, 36).Value = sWord44    ||21295  |                .Cells(47, 36).Value = sWord44    
21341  |            End If                                ||21296  |            End If                                
21342  |                                                  ||21297  |                                                  
21343  |            '支払額                               ||21298  |            '支払額                               
21344  |            .Cells(48, 2).Value = sWord46a        ||21299  |            .Cells(48, 2).Value = sWord46a        
21345  |            '文言の冗長化でピリオド及び、名称を二 ||21300  |            '文言の冗長化でピリオド及び、名称を二 
21346  |            .Cells(48, 13).Value = sWord19        ||21301  |            .Cells(48, 13).Value = sWord19        
21347  |                                                  ||21302  |                                                  
21348  |            '税抜金額(月別支払顧問料の累計)       ||21303  |            '税抜金額(月別支払顧問料の累計)       
21349  |            '文言の冗長化でピリオド及び、名称を二 ||21304  |            '文言の冗長化でピリオド及び、名称を二 
21350  |            .Cells(48, 31).NumberFormatLocal = "@"||21305  |            .Cells(48, 31).NumberFormatLocal = "@"
21351  |            .Cells(48, 31).Value = CStr(Format(mst||21306  |            .Cells(48, 31).Value = CStr(Format(mst
21352  |            .Cells(48, 31).HorizontalAlignment = x||21307  |            .Cells(48, 31).HorizontalAlignment = x
21353  |            .Cells(48, 34).Value = sYena          ||21308  |            .Cells(48, 34).Value = sYena          
21354  |                                                  ||21309  |                                                  
21355  |        '消費税計算有無：「有り」の場合のみ、消費 ||21310  |        '消費税計算有無：「有り」の場合のみ、消費 
21356  |        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc_||21311  |        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc_
21357  |            '(消費税XX%)                          ||21312  |            '(消費税XX%)                          
21358  |            '文言の冗長化でピリオド及び、名称を二 ||21313  |            '文言の冗長化でピリオド及び、名称を二 
21359  |            iSyouhizei = ddblconsumption_tax      ||21314  |            iSyouhizei = ddblconsumption_tax      
21360  |            .Cells(49, 34).Value = sWord22a & iSyo||21315  |            .Cells(49, 34).Value = sWord22a & iSyo
21361  |            dblValueIn = mstrMonthlyPayCom * iSyou||21316  |            dblValueIn = mstrMonthlyPayCom * iSyou
21362  |            Call sbGetRoundValueTax(dblValueIn)   ||21317  |            Call sbGetRoundValueTax(dblValueIn)   
21363  |            lTaxNum = dblValueOut                 ||21318  |            lTaxNum = dblValueOut                 
21364  |            '文言の冗長化でピリオド及び、名称を二 ||21319  |            '文言の冗長化でピリオド及び、名称を二 
21365  |            .Cells(49, 31).NumberFormatLocal = "@"||21320  |            .Cells(49, 31).NumberFormatLocal = "@"
21366  |            .Cells(49, 31).Value = CStr(Format((lT||21321  |            .Cells(49, 31).Value = CStr(Format((lT
21367  |            .Cells(49, 31).HorizontalAlignment = x||21322  |            .Cells(49, 31).HorizontalAlignment = x
21368  |            '合計(消費税＋月別支払顧問料の累計)   ||21323  |            '合計(消費税＋月別支払顧問料の累計)   
21369  |            '文言の冗長化でピリオド及び、名称を二 ||21324  |            '文言の冗長化でピリオド及び、名称を二 
21370  |            .Cells(50, 15).Value = sWord24a       ||21325  |            .Cells(50, 15).Value = sWord24a       
21371  |            dblValueIn = lTaxNum + CCur(mstrMonthl||21326  |            dblValueIn = lTaxNum + CCur(mstrMonthl
21372  |            Call sbGetRoundValue(dblValueIn)      ||21327  |            Call sbGetRoundValue(dblValueIn)      
21373  |            lMonthlyPayCom = dblValueOut          ||21328  |            lMonthlyPayCom = dblValueOut          
21374  |            '文言の冗長化でピリオド及び、名称を二 ||21329  |            '文言の冗長化でピリオド及び、名称を二 
21375  |            .Cells(50, 31).NumberFormatLocal = "@"||21330  |            .Cells(50, 31).NumberFormatLocal = "@"
21376  |            .Cells(50, 31).Value = CStr(Format(lMo||21331  |            .Cells(50, 31).Value = CStr(Format(lMo
21377  |            .Cells(50, 31).HorizontalAlignment = x||21332  |            .Cells(50, 31).HorizontalAlignment = x
21378  |            '円                                   ||21333  |            '円                                   
21379  |            .Cells(50, 34).Value = sYena          ||21334  |            .Cells(50, 34).Value = sYena          
21380  |            '下線                                 ||21335  |            '下線                                 
21381  |            '文言の冗長化でピリオド及び、名称を二 ||21336  |            '文言の冗長化でピリオド及び、名称を二 
21382  |            With xlSheet.Range("O49:AN49").Borders||21337  |            With xlSheet.Range("O49:AN49").Borders
21383  |                .LineStyle = xlContinuous         ||21338  |                .LineStyle = xlContinuous         
21384  |                .Weight = xlThin                  ||21339  |                .Weight = xlThin                  
21385  |            End With                              ||21340  |            End With                              
21386  |        Else                                      ||21341  |        Else                                      
21387  |        End If                                    ||21342  |        End If                                    
21388  |                                                  ||21343  |                                                  
21389  |        '支払予定日                               ||21344  |        '支払予定日                               
21390  |        '文言の冗長化でピリオド及び、名称を二列右 ||21345  |        '文言の冗長化でピリオド及び、名称を二列右 
21391  |        .Cells(52, 2).Value = sWord13a            ||21346  |        .Cells(52, 2).Value = sWord13a            
21392  |        .Cells(52, 13).Value = sWord19            ||21347  |        .Cells(52, 13).Value = sWord19            
21393  |        .Cells(52, 15).NumberFormatLocal = "@"    ||21348  |        .Cells(52, 15).NumberFormatLocal = "@"    
21394  |        .Cells(52, 15).Value = CStr(Format(Trim(ms||21349  |        .Cells(52, 15).Value = CStr(Format(Trim(ms
21395  |                                                  ||21350  |                                                  
21396  |        '支払先                                   ||21351  |        '支払先                                   
21397  |        '文言の冗長化でピリオド及び、名称を二列右 ||21352  |        '文言の冗長化でピリオド及び、名称を二列右 
21398  |        .Cells(54, 2).Value = sWord12a            ||21353  |        .Cells(54, 2).Value = sWord12a            
21399  |        .Cells(54, 13).Value = sWord19            ||21354  |        .Cells(54, 13).Value = sWord19            
21400  |        .Cells(54, 15).Value = gbuMGetUPDRec.N(lRe||21355  |        .Cells(54, 15).Value = gbuMGetUPDRec.N(lRe
21401  |                                                  ||21356  |                                                  
21402  |        '財務部                                   ||21357  |        '財務部                                   
21403  |        .Cells(60, 2).Value = sWord1a             ||21358  |        .Cells(60, 2).Value = sWord1a             
21404  |        .Cells(61, 2).Value = sWord2a             ||21359  |        .Cells(61, 2).Value = sWord2a             
21405  |                                                  ||21360  |                                                  
21406  |    End With                                      ||21361  |    End With                                      
21407  |                                                  ||21362  |                                                  
21408  |    '月末純資産(合計 上のライン)                  ||21363  |    '月末純資産(合計 上のライン)                  
21409  |    With xlSheet.Range("X39:AX40").Borders(xlInsid||21364  |    With xlSheet.Range("X39:AX40").Borders(xlInsid
21410  |        .LineStyle = xlContinuous                 ||21365  |        .LineStyle = xlContinuous                 
21411  |        .Weight = xlThin                          ||21366  |        .Weight = xlThin                          
21412  |    End With                                      ||21367  |    End With                                      
21413  |                                                  ||21368  |                                                  
21414  |    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract_||21369  |    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract_
21415  |    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||21370  |    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
21416  |                                                  ||21371  |                                                  
21417  |        '文言の冗長化でピリオド及び、名称を二列右 ||21372  |        '文言の冗長化でピリオド及び、名称を二列右 
21418  |        xlSheet.Cells(13, 15).Value = _           ||21373  |        xlSheet.Cells(13, 15).Value = _           
21419  |            CStr(Format(dStart, "mmmm d , yyyy")) ||21374  |            CStr(Format(dStart, "mmmm d , yyyy")) 
21420  |    Else                                          ||21375  |    Else                                          
21421  |        '文言の冗長化でピリオド及び、名称を二列右 ||21376  |        '文言の冗長化でピリオド及び、名称を二列右 
21422  |        xlSheet.Cells(13, 15).Value = _           ||21377  |        xlSheet.Cells(13, 15).Value = _           
21423  |            CStr(Format(dStart, "mmmm d , yyyy")) ||21378  |            CStr(Format(dStart, "mmmm d , yyyy")) 
21424  |    End If                                        ||21379  |    End If                                        
21425  |                                                  ||21380  |                                                  
21426  |    'A4印刷用に上2行を削除して、プレビュー範囲内に||21381  |    'A4印刷用に上2行を削除して、プレビュー範囲内に
21427  |    xlSheet.Rows("1:2").Delete Shift:=xlUp        ||21382  |    xlSheet.Rows("1:2").Delete Shift:=xlUp        
21428  |                                                  ||21383  |                                                  
21429  |'=================================================||21384  |'=================================================
21430  |'== 　　　　日次NAV/日時時価総額の別表作成エリア  ||21385  |'== 　　　　日次NAV/日時時価総額の別表作成エリア  
21431  |'=================================================||21386  |'=================================================
21432  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||21387  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
21433  |''NAV取得区分：日次NAV平均(休日有)または日次NAV平 ||21388  |''NAV取得区分：日次NAV平均(休日有)または日次NAV平 
21434  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||21389  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
21435  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||21390  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
21436  |    'NAV取得区分：日次NAV平均(休日有)、日次NAV平均||21391  |    'NAV取得区分：日次NAV平均(休日有)、日次NAV平均
21437  |    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag ||21392  |    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag 
21438  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||21393  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
21439  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||21394  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
21440  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||21395  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
21441  |                                                  ||21396  |                                                  
21442  |        gTotalDnavCnt = 0                         ||21397  |        gTotalDnavCnt = 0                         
21443  |        J = 0                                     ||21398  |        J = 0                                     
21444  |        K = 0                                     ||21399  |        K = 0                                     
21445  |        '＋２は合計行と平均行                     ||21400  |        '＋２は合計行と平均行                     
21446  |        dintPage = (dlngCnt + 2) \ 108            ||21401  |        dintPage = (dlngCnt + 2) \ 108            
21447  |        dintAmari = (dlngCnt + 2) Mod 108         ||21402  |        dintAmari = (dlngCnt + 2) Mod 108         
21448  |        If dintAmari <> 0 Then                    ||21403  |        If dintAmari <> 0 Then                    
21449  |            dintPage = dintPage + 1               ||21404  |            dintPage = dintPage + 1               
21450  |        End If                                    ||21405  |        End If                                    
21451  |                                                  ||21406  |                                                  
21452  |        For L = 1 To dintPage                     ||21407  |        For L = 1 To dintPage                     
21453  |                                                  ||21408  |                                                  
21454  |            xlBook.Worksheets.Add after:=xlBook.Sh||21409  |            xlBook.Worksheets.Add after:=xlBook.Sh
21455  |            gProcessCnt = gProcessCnt + 1         ||21410  |            gProcessCnt = gProcessCnt + 1         
21456  |            Set xlSheet = xlBook.Sheets(gProcessCn||21411  |            Set xlSheet = xlBook.Sheets(gProcessCn
21457  |                                                  ||21412  |                                                  
21458  |            'Excelフォーマットを調整              ||21413  |            'Excelフォーマットを調整              
21459  |            xlSheet.Cells.ColumnWidth = 1         ||21414  |            xlSheet.Cells.ColumnWidth = 1         
21460  |            xlSheet.Cells.Font.Size = 11          ||21415  |            xlSheet.Cells.Font.Size = 11          
21461  |            'シート名を設定(日次NAV一覧**)        ||21416  |            'シート名を設定(日次NAV一覧**)        
21462  |                                                  ||21417  |                                                  
21463  |            'RAFI対応 START                       ||21418  |            'RAFI対応 START                       
21464  |            '純資産の場合                         ||21419  |            '純資産の場合                         
21465  |            If msAssetFlg = "0" Then              ||21420  |            If msAssetFlg = "0" Then              
21466  |                If dstrOldAccCode = sGetAccCode Th||21421  |                If dstrOldAccCode = sGetAccCode Th
21467  |                    gTotalDnavCnt = gTotalDnavCnt ||21422  |                    gTotalDnavCnt = gTotalDnavCnt 
21468  |                Else                              ||21423  |                Else                              
21469  |                    gTotalDnavCnt = 1             ||21424  |                    gTotalDnavCnt = 1             
21470  |                    dstrOldAccCode = sGetAccCode  ||21425  |                    dstrOldAccCode = sGetAccCode  
21471  |                End If                            ||21426  |                End If                            
21472  |            'マザー組入資産の場合                 ||21427  |            'マザー組入資産の場合                 
21473  |            Else                                  ||21428  |            Else                                  
21474  |                If dstrOldAccCode = msBabyAccountC||21429  |                If dstrOldAccCode = msBabyAccountC
21475  |                    gTotalDnavCnt = gTotalDnavCnt ||21430  |                    gTotalDnavCnt = gTotalDnavCnt 
21476  |                Else                              ||21431  |                Else                              
21477  |                    gTotalDnavCnt = 1             ||21432  |                    gTotalDnavCnt = 1             
21478  |                    dstrOldAccCode = msBabyAccount||21433  |                    dstrOldAccCode = msBabyAccount
21479  |                End If                            ||21434  |                End If                            
21480  |            End If                                ||21435  |            End If                                
21481  |            'RAFI対応 END                         ||21436  |            'RAFI対応 END                         
21482  |                                                  ||21437  |                                                  
21483  |            'gTotalCnt = gTotalCnt + 1            ||21438  |            'gTotalCnt = gTotalCnt + 1            
21484  |            'RAFI対応 START                       ||21439  |            'RAFI対応 START                       
21485  |            '純資産の場合                         ||21440  |            '純資産の場合                         
21486  |            If msAssetFlg = "0" Then              ||21441  |            If msAssetFlg = "0" Then              
21487  |                '複数ページの場合                 ||21442  |                '複数ページの場合                 
21488  |                If dintPage > 1 Then              ||21443  |                If dintPage > 1 Then              
21489  |                    xlBook.Sheets(gProcessCnt).Nam||21444  |                    xlBook.Sheets(gProcessCnt).Nam
21490  |                Else                              ||21445  |                Else                              
21491  |                    xlBook.Sheets(gProcessCnt).Nam||21446  |                    xlBook.Sheets(gProcessCnt).Nam
21492  |                End If                            ||21447  |                End If                            
21493  |            'マザー組入資産の場合                 ||21448  |            'マザー組入資産の場合                 
21494  |            Else                                  ||21449  |            Else                                  
21495  |                '複数ページの場合                 ||21450  |                '複数ページの場合                 
21496  |                If dintPage > 1 Then              ||21451  |                If dintPage > 1 Then              
21497  |                    xlBook.Sheets(gProcessCnt).Nam||21452  |                    xlBook.Sheets(gProcessCnt).Nam
21498  |                Else                              ||21453  |                Else                              
21499  |                    xlBook.Sheets(gProcessCnt).Nam||21454  |                    xlBook.Sheets(gProcessCnt).Nam
21500  |                End If                            ||21455  |                End If                            
21501  |            End If                                ||21456  |            End If                                
21502  |            'RAFI対応 END                         ||21457  |            'RAFI対応 END                         
21503  |                                                  ||21458  |                                                  
21504  |                                                  ||21459  |                                                  
21505  |            'シートの余白を設定                   ||21460  |            'シートの余白を設定                   
21506  |            xlSheet.PageSetup.TopMargin = Applicat||21461  |            xlSheet.PageSetup.TopMargin = Applicat
21507  |            xlSheet.PageSetup.BottomMargin = Appli||21462  |            xlSheet.PageSetup.BottomMargin = Appli
21508  |            xlSheet.PageSetup.LeftMargin = Applica||21463  |            xlSheet.PageSetup.LeftMargin = Applica
21509  |            xlSheet.PageSetup.RightMargin = Applic||21464  |            xlSheet.PageSetup.RightMargin = Applic
21510  |                                                  ||21465  |                                                  
21511  |            DoEvents                              ||21466  |            DoEvents                              
21512  |                                                  ||21467  |                                                  
21513  |            With xlSheet                          ||21468  |            With xlSheet                          
21514  |                '題目                             ||21469  |                '題目                             
21515  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||21470  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
21516  |                '取得NAV区分が4:日次時価総額平均の||21471  |                '取得NAV区分が4:日次時価総額平均の
21517  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||21472  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
21518  |                    .Cells(5, 1).Value = sWord68a ||21473  |                    .Cells(5, 1).Value = sWord68a 
21519  |                Else                              ||21474  |                Else                              
21520  |                    .Cells(5, 1).Value = sWord47a ||21475  |                    .Cells(5, 1).Value = sWord47a 
21521  |                End If                            ||21476  |                End If                            
21522  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||21477  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
21523  |                .Cells(5, 1).Font.Size = 14       ||21478  |                .Cells(5, 1).Font.Size = 14       
21524  |                .Range("A5:BG5").HorizontalAlignme||21479  |                .Range("A5:BG5").HorizontalAlignme
21525  |                '出力日付                         ||21480  |                '出力日付                         
21526  |                If RTrim(txtSysOutDate.Text) = "" ||21481  |                If RTrim(txtSysOutDate.Text) = "" 
21527  |                    .Cells(3, 50).NumberFormatLoca||21482  |                    .Cells(3, 50).NumberFormatLoca
21528  |                    .Cells(3, 50).Value = sWord34a||21483  |                    .Cells(3, 50).Value = sWord34a
21529  |                    .Cells(3, 50).HorizontalAlignm||21484  |                    .Cells(3, 50).HorizontalAlignm
21530  |                Else                              ||21485  |                Else                              
21531  |                    .Cells(3, 43).NumberFormatLoca||21486  |                    .Cells(3, 43).NumberFormatLoca
21532  |                    .Cells(3, 43).Value = CStr(For||21487  |                    .Cells(3, 43).Value = CStr(For
21533  |                End If                            ||21488  |                End If                            
21534  |                'ファンド名                       ||21489  |                'ファンド名                       
21535  |                .Cells(6, 2).Value = sWord4a      ||21490  |                .Cells(6, 2).Value = sWord4a      
21536  |                .Cells(6, 11).Value = sWord19     ||21491  |                .Cells(6, 11).Value = sWord19     
21537  |                .Cells(6, 13).Value = gbuMGetUPDRe||21492  |                .Cells(6, 13).Value = gbuMGetUPDRe
21538  |                'ファンドコード                   ||21493  |                'ファンドコード                   
21539  |                .Cells(7, 2).Value = sWord4_2a    ||21494  |                .Cells(7, 2).Value = sWord4_2a    
21540  |                .Cells(7, 11).Value = sWord19     ||21495  |                .Cells(7, 11).Value = sWord19     
21541  |                .Cells(7, 13).NumberFormatLocal = ||21496  |                .Cells(7, 13).NumberFormatLocal = 
21542  |                .Cells(7, 13).Value = sGetAccCode ||21497  |                .Cells(7, 13).Value = sGetAccCode 
21543  |                '計算期間                         ||21498  |                '計算期間                         
21544  |                '文言変更                         ||21499  |                '文言変更                         
21545  |'                .Cells(8, 2).Value = sWord5a     ||21500  |'                .Cells(8, 2).Value = sWord5a     
21546  |                .Cells(8, 2).Value = sWord59a     ||21501  |                .Cells(8, 2).Value = sWord59a     
21547  |                .Cells(8, 11).Value = sWord19     ||21502  |                .Cells(8, 11).Value = sWord19     
21548  |                                                  ||21503  |                                                  
21549  |                If Mid(gbuMGetUPDRec.N(lRecIdx).MG||21504  |                If Mid(gbuMGetUPDRec.N(lRecIdx).MG
21550  |                And gbuMGetUPDRec.N(lRecIdx).MGET_||21505  |                And gbuMGetUPDRec.N(lRecIdx).MGET_
21551  |                    .Cells(8, 13).Value = _       ||21506  |                    .Cells(8, 13).Value = _       
21552  |                        CStr(Format(dStart, "mmmm ||21507  |                        CStr(Format(dStart, "mmmm 
21553  |                Else                              ||21508  |                Else                              
21554  |                    .Cells(8, 13).Value = _       ||21509  |                    .Cells(8, 13).Value = _       
21555  |                        CStr(Format(dStart, "mmmm ||21510  |                        CStr(Format(dStart, "mmmm 
21556  |                End If                            ||21511  |                End If                            
21557  |                                                  ||21512  |                                                  
21558  |                '日付                             ||21513  |                '日付                             
21559  |                .Cells(10, 3).Value = sWord7a     ||21514  |                .Cells(10, 3).Value = sWord7a     
21560  |                .Range("C10:N10").HorizontalAlignm||21515  |                .Range("C10:N10").HorizontalAlignm
21561  |                '純資産                           ||21516  |                '純資産                           
21562  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||21517  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
21563  |                '取得NAV区分が4:日次時価総額平均の||21518  |                '取得NAV区分が4:日次時価総額平均の
21564  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||21519  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
21565  |                    .Cells(10, 15).Value = sWord64||21520  |                    .Cells(10, 15).Value = sWord64
21566  |                Else                              ||21521  |                Else                              
21567  |                    .Cells(10, 15).Value = sWord8a||21522  |                    .Cells(10, 15).Value = sWord8a
21568  |                End If                            ||21523  |                End If                            
21569  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||21524  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
21570  |                .Range("O10:AC10").HorizontalAlign||21525  |                .Range("O10:AC10").HorizontalAlign
21571  |                '日付                             ||21526  |                '日付                             
21572  |                .Cells(10, 31).Value = sWord7a    ||21527  |                .Cells(10, 31).Value = sWord7a    
21573  |                .Range("AE10:AP10").HorizontalAlig||21528  |                .Range("AE10:AP10").HorizontalAlig
21574  |                '純資産                           ||21529  |                '純資産                           
21575  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||21530  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
21576  |                '取得NAV区分が4:日次時価総額平均の||21531  |                '取得NAV区分が4:日次時価総額平均の
21577  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||21532  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
21578  |                    .Cells(10, 43).Value = sWord64||21533  |                    .Cells(10, 43).Value = sWord64
21579  |                Else                              ||21534  |                Else                              
21580  |                    .Cells(10, 43).Value = sWord8a||21535  |                    .Cells(10, 43).Value = sWord8a
21581  |                End If                            ||21536  |                End If                            
21582  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||21537  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
21583  |                .Range("AQ10:BE10").HorizontalAlig||21538  |                .Range("AQ10:BE10").HorizontalAlig
21584  |                '日付＆NAV                        ||21539  |                '日付＆NAV                        
21585  |                Select Case L                     ||21540  |                Select Case L                     
21586  |                    Case 1                        ||21541  |                    Case 1                        
21587  |                        dintPageIni = 1           ||21542  |                        dintPageIni = 1           
21588  |                    Case Else                     ||21543  |                    Case Else                     
21589  |                        dintPageIni = dintPageIni ||21544  |                        dintPageIni = dintPageIni 
21590  |                End Select                        ||21545  |                End Select                        
21591  |                For dintFor = dintPageIni To dlngC||21546  |                For dintFor = dintPageIni To dlngC
21592  |                    If J < 54 Then                ||21547  |                    If J < 54 Then                
21593  |                        If dintFor = dlngCnt + 1 T||21548  |                        If dintFor = dlngCnt + 1 T
21594  |                            '合計                 ||21549  |                            '合計                 
21595  |                            .Cells(11 + J, 3).Valu||21550  |                            .Cells(11 + J, 3).Valu
21596  |                            'NAV                  ||21551  |                            'NAV                  
21597  |                            .Cells(11 + J, 28).Num||21552  |                            .Cells(11 + J, 28).Num
21598  |                            If gbuMGetUPDRec.N(lRe||21553  |                            If gbuMGetUPDRec.N(lRe
21599  |                                .Cells(11 + J, 28)||21554  |                                .Cells(11 + J, 28)
21600  |                            Else                  ||21555  |                            Else                  
21601  |                                .Cells(11 + J, 28)||21556  |                                .Cells(11 + J, 28)
21602  |                            End If                ||21557  |                            End If                
21603  |                            .Cells(11 + J, 28).Hor||21558  |                            .Cells(11 + J, 28).Hor
21604  |                        End If                    ||21559  |                        End If                    
21605  |                                                  ||21560  |                                                  
21606  |                            If dintFor = dlngCnt +||21561  |                            If dintFor = dlngCnt +
21607  |                                '平均             ||21562  |                                '平均             
21608  |                                .Cells(11 + J, 3).||21563  |                                .Cells(11 + J, 3).
21609  |                                'NAV              ||21564  |                                'NAV              
21610  |                                .Cells(11 + J, 28)||21565  |                                .Cells(11 + J, 28)
21611  |                                If gbuMGetUPDRec.N||21566  |                                If gbuMGetUPDRec.N
21612  |                                    .Cells(11 + J,||21567  |                                    .Cells(11 + J,
21613  |                                Else              ||21568  |                                Else              
21614  |                                    .Cells(11 + J,||21569  |                                    .Cells(11 + J,
21615  |                                End If            ||21570  |                                End If            
21616  |                                .Cells(11 + J, 28)||21571  |                                .Cells(11 + J, 28)
21617  |                            End If                ||21572  |                            End If                
21618  |                                                  ||21573  |                                                  
21619  |                        If dintFor < dlngCnt + 1 T||21574  |                        If dintFor < dlngCnt + 1 T
21620  |                            '日付                 ||21575  |                            '日付                 
21621  |                            .Cells(11 + J, 4).Numb||21576  |                            .Cells(11 + J, 4).Numb
21622  |                            .Cells(11 + J, 4).Valu||21577  |                            .Cells(11 + J, 4).Valu
21623  |                                        CDate(gstr||21578  |                                        CDate(gstr
21624  |                            'NAV                  ||21579  |                            'NAV                  
21625  |                            .Cells(11 + J, 28).Num||21580  |                            .Cells(11 + J, 28).Num
21626  |                            If gbuMGetUPDRec.N(lRe||21581  |                            If gbuMGetUPDRec.N(lRe
21627  |                                .Cells(11 + J, 28)||21582  |                                .Cells(11 + J, 28)
21628  |                            Else                  ||21583  |                            Else                  
21629  |                                .Cells(11 + J, 28)||21584  |                                .Cells(11 + J, 28)
21630  |                            End If                ||21585  |                            End If                
21631  |                            .Cells(11 + J, 28).Hor||21586  |                            .Cells(11 + J, 28).Hor
21632  |                        End If                    ||21587  |                        End If                    
21633  |                    Else                          ||21588  |                    Else                          
21634  |                        If dintFor = dlngCnt + 1 T||21589  |                        If dintFor = dlngCnt + 1 T
21635  |                            '合計                 ||21590  |                            '合計                 
21636  |                            .Cells(11 + K, 31).Val||21591  |                            .Cells(11 + K, 31).Val
21637  |                            'NAV                  ||21592  |                            'NAV                  
21638  |                            .Cells(11 + K, 56).Num||21593  |                            .Cells(11 + K, 56).Num
21639  |                            If gbuMGetUPDRec.N(lRe||21594  |                            If gbuMGetUPDRec.N(lRe
21640  |                                .Cells(11 + K, 56)||21595  |                                .Cells(11 + K, 56)
21641  |                            Else                  ||21596  |                            Else                  
21642  |                                .Cells(11 + K, 56)||21597  |                                .Cells(11 + K, 56)
21643  |                            End If                ||21598  |                            End If                
21644  |                            .Cells(11 + K, 56).Hor||21599  |                            .Cells(11 + K, 56).Hor
21645  |                        End If                    ||21600  |                        End If                    
21646  |                                                  ||21601  |                                                  
21647  |                            If dintFor = dlngCnt +||21602  |                            If dintFor = dlngCnt +
21648  |                                '平均             ||21603  |                                '平均             
21649  |                                .Cells(11 + K, 31)||21604  |                                .Cells(11 + K, 31)
21650  |                                'NAV              ||21605  |                                'NAV              
21651  |                                .Cells(11 + K, 56)||21606  |                                .Cells(11 + K, 56)
21652  |                                If gbuMGetUPDRec.N||21607  |                                If gbuMGetUPDRec.N
21653  |                                    .Cells(11 + K,||21608  |                                    .Cells(11 + K,
21654  |                                Else              ||21609  |                                Else              
21655  |                                    .Cells(11 + K,||21610  |                                    .Cells(11 + K,
21656  |                                End If            ||21611  |                                End If            
21657  |                                .Cells(11 + K, 56)||21612  |                                .Cells(11 + K, 56)
21658  |                            End If                ||21613  |                            End If                
21659  |                                                  ||21614  |                                                  
21660  |                        If dintFor < dlngCnt + 1 T||21615  |                        If dintFor < dlngCnt + 1 T
21661  |                            '日付                 ||21616  |                            '日付                 
21662  |                                                  ||21617  |                                                  
21663  |                            .Cells(11 + K, 32).Num||21618  |                            .Cells(11 + K, 32).Num
21664  |                            .Cells(11 + K, 32).Val||21619  |                            .Cells(11 + K, 32).Val
21665  |                                        CDate(gstr||21620  |                                        CDate(gstr
21666  |                            'NAV                  ||21621  |                            'NAV                  
21667  |                            .Cells(11 + K, 56).Num||21622  |                            .Cells(11 + K, 56).Num
21668  |                            If gbuMGetUPDRec.N(lRe||21623  |                            If gbuMGetUPDRec.N(lRe
21669  |                                .Cells(11 + K, 56)||21624  |                                .Cells(11 + K, 56)
21670  |                            Else                  ||21625  |                            Else                  
21671  |                                .Cells(11 + K, 56)||21626  |                                .Cells(11 + K, 56)
21672  |                            End If                ||21627  |                            End If                
21673  |                            .Cells(11 + K, 56).Hor||21628  |                            .Cells(11 + K, 56).Hor
21674  |                        End If                    ||21629  |                        End If                    
21675  |                        K = K + 1                 ||21630  |                        K = K + 1                 
21676  |                        If K > 53 Then            ||21631  |                        If K > 53 Then            
21677  |                            J = 0                 ||21632  |                            J = 0                 
21678  |                            K = 0                 ||21633  |                            K = 0                 
21679  |                            Exit For              ||21634  |                            Exit For              
21680  |                        End If                    ||21635  |                        End If                    
21681  |                    End If                        ||21636  |                    End If                        
21682  |                    J = J + 1                     ||21637  |                    J = J + 1                     
21683  |                Next dintFor                      ||21638  |                Next dintFor                      
21684  |                                                  ||21639  |                                                  
21685  |            End With                              ||21640  |            End With                              
21686  |            'A4印刷用に上2行を削除して、プレビュー||21641  |            'A4印刷用に上2行を削除して、プレビュー
21687  |            xlSheet.Rows("1:2").Delete Shift:=xlUp||21642  |            xlSheet.Rows("1:2").Delete Shift:=xlUp
21688  |        Next L                                    ||21643  |        Next L                                    
21689  |    End If                                        ||21644  |    End If                                        
21690  |                                                  ||21645  |                                                  
21691  |    '正常戻り値セット                             ||21646  |    '正常戻り値セット                             
21692  |    fnblExcelEnglishOut_NotChgRate = True         ||21647  |    fnblExcelEnglishOut_NotChgRate = True         
21693  |    GoTo EndProc                                  ||21648  |    GoTo EndProc                                  
21694  |                                                  ||21649  |                                                  
21695  |ErrorTrap:                                        ||21650  |ErrorTrap:                                        
21696  |    ' Excel を起動できない場合に発生するエラーをト||21651  |    ' Excel を起動できない場合に発生するエラーをト
21697  |    Select Case Err.Number                        ||21652  |    Select Case Err.Number                        
21698  |        Case 440               ' オートメーション ||21653  |        Case 440               ' オートメーション 
21699  |            iTries = iTries + 1                   ||21654  |            iTries = iTries + 1                   
21700  |            ' Excel の再起動を 5 回まで行います。 ||21655  |            ' Excel の再起動を 5 回まで行います。 
21701  |            If iTries < 5 Then                    ||21656  |            If iTries < 5 Then                    
21702  |               Set xlApp = New Excel.Application  ||21657  |               Set xlApp = New Excel.Application  
21703  |               Resume                             ||21658  |               Resume                             
21704  |            Else                                  ||21659  |            Else                                  
21705  |               Err.Raise Number:=vbObjectError + 2||21660  |               Err.Raise Number:=vbObjectError + 2
21706  |               Description:="Microsoft Excel を起 ||21661  |               Description:="Microsoft Excel を起 
21707  |            End If                                ||21662  |            End If                                
21708  |        Case Else                                 ||21663  |        Case Else                                 
21709  |    End Select                                    ||21664  |    End Select                                    
21710  |                                                  ||21665  |                                                  
21711  |    'Workbookを閉じる                             ||21666  |    'Workbookを閉じる                             
21712  |    xlBook.Close                                  ||21667  |    xlBook.Close                                  
21713  |                                                  ||21668  |                                                  
21714  |    'Excel終了                                    ||21669  |    'Excel終了                                    
21715  |    xlApp.Quit                                    ||21670  |    xlApp.Quit                                    
21716  |                                                  ||21671  |                                                  
21717  |    'オブジェクトの解放                           ||21672  |    'オブジェクトの解放                           
21718  |    Set xlApp = Nothing                           ||21673  |    Set xlApp = Nothing                           
21719  |    Set xlBook = Nothing                          ||21674  |    Set xlBook = Nothing                          
21720  |    Set xlSheet = Nothing                         ||21675  |    Set xlSheet = Nothing                         
21721  |                                                  ||21676  |                                                  
21722  |OnErrorProc:                                      ||21677  |OnErrorProc:                                      
21723  |    Call subError("システムエラー", Str(Err.Number||21678  |    Call subError("システムエラー", Str(Err.Number
21724  |        Error, strErrCall, conTitle)              ||21679  |        Error, strErrCall, conTitle)              
21725  |    'マウスポインター元に戻す                     ||21680  |    'マウスポインター元に戻す                     
21726  |    Screen.MousePointer = vbDefault               ||21681  |    Screen.MousePointer = vbDefault               
21727  |    GoTo EndProc                                  ||21682  |    GoTo EndProc                                  
21728  |                                                  ||21683  |                                                  
21729  |EndProc:                                          ||21684  |EndProc:                                          
21730  |                                                  ||21685  |                                                  
21731  |End Function                                      ||21686  |End Function                                      
21732  |                                                  ||21687  |                                                  
21733  |'=================================================||21688  |'=================================================
21734  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelEnglishOut_ChangeRat||21689  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelEnglishOut_ChangeRat
21735  |'機能            :   確認書(英文)のExcel出力(料率 ||21690  |'機能            :   確認書(英文)のExcel出力(料率 
21736  |'                                                 ||21691  |'                                                 
21737  |'日付               担当　              修正内容  ||21692  |'日付               担当　              修正内容  
21738  |'-------------------------------------------------||21693  |'-------------------------------------------------
21739  |'2006/08/18         K.Furuya <SRA>     RAFI対応   ||21694  |'2006/08/18         K.Furuya <SRA>     RAFI対応   
21740  |'                                      fnblExcelEn||21695  |'                                      fnblExcelEn
21741  |'2008/02/20         K.Furuya <SRA>     時価総額基 ||21696  |'2008/02/20         K.Furuya <SRA>     時価総額基 
21742  |'=================================================||21697  |'=================================================
21743  |Private Function fnblExcelEnglishOut_ChangeRate( _||21698  |Private Function fnblExcelEnglishOut_ChangeRate( _
21744  |    ByVal lRecIdx As Long _                       ||21699  |    ByVal lRecIdx As Long _                       
21745  |) As Boolean                                      ||21700  |) As Boolean                                      
21746  |                                                  ||21701  |                                                  
21747  |    Dim dStart      As Date     '計算期間　開始日 ||21702  |    Dim dStart      As Date     '計算期間　開始日 
21748  |    Dim dEnd        As Date     '計算期間　終了日 ||21703  |    Dim dEnd        As Date     '計算期間　終了日 
21749  |    Dim sSql        As String                     ||21704  |    Dim sSql        As String                     
21750  |    Dim sCurrencyCode As String '通貨コード(SQL文 ||21705  |    Dim sCurrencyCode As String '通貨コード(SQL文 
21751  |    Dim AccCode     As String   '口座コード(SQL文 ||21706  |    Dim AccCode     As String   '口座コード(SQL文 
21752  |    Dim sDate       As Date     '支払予定日       ||21707  |    Dim sDate       As Date     '支払予定日       
21753  |    Dim sName       As String   '担当者名         ||21708  |    Dim sName       As String   '担当者名         
21754  |    Dim i           As Integer  'カウンター       ||21709  |    Dim i           As Integer  'カウンター       
21755  |    Dim ColNum      As Integer  '部署名コンボボッ ||21710  |    Dim ColNum      As Integer  '部署名コンボボッ 
21756  |    Dim ColWord     As String   '部署名コンボボッ ||21711  |    Dim ColWord     As String   '部署名コンボボッ 
21757  |    Dim iSyouhizei  As Long     '消費税           ||21712  |    Dim iSyouhizei  As Long     '消費税           
21758  |    Dim iRowCnt     As Long     '月末純資産データ ||21713  |    Dim iRowCnt     As Long     '月末純資産データ 
21759  |    Dim TotalNav    As Currency '累積NAV          ||21714  |    Dim TotalNav    As Currency '累積NAV          
21760  |    Dim TotalRate   As Currency '累積閾値         ||21715  |    Dim TotalRate   As Currency '累積閾値         
21761  |    Dim cRate       As Currency '料率             ||21716  |    Dim cRate       As Currency '料率             
21762  |    Dim WorkRate    As Currency '一つ前の累積閾値 ||21717  |    Dim WorkRate    As Currency '一つ前の累積閾値 
21763  |    Dim TotalCom    As Currency '累積投資顧問料   ||21718  |    Dim TotalCom    As Currency '累積投資顧問料   
21764  |    Dim lTaxNum     As Currency '消費税値         ||21719  |    Dim lTaxNum     As Currency '消費税値         
21765  |    Dim lMonthlyPayCom As Currency  '月別支払額   ||21720  |    Dim lMonthlyPayCom As Currency  '月別支払額   
21766  |    Dim lCalcNav    As Currency '計算対象NAV      ||21721  |    Dim lCalcNav    As Currency '計算対象NAV      
21767  |    Dim iCalcNum    As Integer  '計算期間日数     ||21722  |    Dim iCalcNum    As Integer  '計算期間日数     
21768  |    'Excel の Application 変数とエラーをトラップす||21723  |    'Excel の Application 変数とエラーをトラップす
21769  |    Dim iTries      As Integer                    ||21724  |    Dim iTries      As Integer                    
21770  |    Dim strErrCall      As String 'エラー呼出元   ||21725  |    Dim strErrCall      As String 'エラー呼出元   
21771  |    Const conMeModule   As String = "fnblExcelEngl||21726  |    Const conMeModule   As String = "fnblExcelEngl
21772  |    'Excel の Worksheet 削除用カウンタ変数        ||21727  |    'Excel の Worksheet 削除用カウンタ変数        
21773  |    Dim Ws_Cnt      As Integer                    ||21728  |    Dim Ws_Cnt      As Integer                    
21774  |    Dim Ws_Del_Cnt  As Integer                    ||21729  |    Dim Ws_Del_Cnt  As Integer                    
21775  |    Dim Ws_Del_Cnt2 As Integer                    ||21730  |    Dim Ws_Del_Cnt2 As Integer                    
21776  |    Dim ContNo      As String   '契約番号(SQL文作 ||21731  |    Dim ContNo      As String   '契約番号(SQL文作 
21777  |    Dim NavGetCnt   As Long                       ||21732  |    Dim NavGetCnt   As Long                       
21778  |    Dim sGetAccCode As String                     ||21733  |    Dim sGetAccCode As String                     
21779  |    Dim Mnav_Flg    As String                     ||21734  |    Dim Mnav_Flg    As String                     
21780  |    Dim sStart As String            '計算対象　開 ||21735  |    Dim sStart As String            '計算対象　開 
21781  |    Dim sEnd As String              '計算対象　終 ||21736  |    Dim sEnd As String              '計算対象　終 
21782  |    Dim dstrBasedate As String      '基準日用ワー ||21737  |    Dim dstrBasedate As String      '基準日用ワー 
21783  |    Dim dstrCaldate() As String     'カレンダー日 ||21738  |    Dim dstrCaldate() As String     'カレンダー日 
21784  |    Dim ddblDailynav() As Double    '日次NAV用格納||21739  |    Dim ddblDailynav() As Double    '日次NAV用格納
21785  |    Dim dlngCnt As Long             '計算対象期間 ||21740  |    Dim dlngCnt As Long             '計算対象期間 
21786  |    Dim dstrCaldate2 As String      'カレンダー日 ||21741  |    Dim dstrCaldate2 As String      'カレンダー日 
21787  |    Dim dstrBasedate2 As String     '基準日(/編集)||21742  |    Dim dstrBasedate2 As String     '基準日(/編集)
21788  |    Dim dlngDiffdate As Long        'カレンダー日 ||21743  |    Dim dlngDiffdate As Long        'カレンダー日 
21789  |    Dim dintFor As Integer          'For文用変数  ||21744  |    Dim dintFor As Integer          'For文用変数  
21790  |    Dim ddblTtalnav As Double       '日次NAV累積用||21745  |    Dim ddblTtalnav As Double       '日次NAV累積用
21791  |    Dim dstrAvgNav As String                      ||21746  |    Dim dstrAvgNav As String                      
21792  |    Dim ddblNearNav As Double                     ||21747  |    Dim ddblNearNav As Double                     
21793  |    Dim dstrAccCd() As String                     ||21748  |    Dim dstrAccCd() As String                     
21794  |    Dim dstrBsCCd() As String                     ||21749  |    Dim dstrBsCCd() As String                     
21795  |    Dim intRtn      As Integer                    ||21750  |    Dim intRtn      As Integer                    
21796  |    Dim dstrDate         As String                ||21751  |    Dim dstrDate         As String                
21797  |    Dim dstrCurrencyCode As String                ||21752  |    Dim dstrCurrencyCode As String                
21798  |    Dim ddblExchangeRate As Double                ||21753  |    Dim ddblExchangeRate As Double                
21799  |    Dim dintPage    As Integer                    ||21754  |    Dim dintPage    As Integer                    
21800  |    Dim dintPageIni As Integer                    ||21755  |    Dim dintPageIni As Integer                    
21801  |    Dim dintAmari   As Integer                    ||21756  |    Dim dintAmari   As Integer                    
21802  |    Dim dCalDate    As Date                       ||21757  |    Dim dCalDate    As Date                       
21803  |    Dim J           As Integer                    ||21758  |    Dim J           As Integer                    
21804  |    Dim K           As Integer                    ||21759  |    Dim K           As Integer                    
21805  |    Dim L           As Integer                    ||21760  |    Dim L           As Integer                    
21806  |    Dim AvgNav      As Currency                   ||21761  |    Dim AvgNav      As Currency                   
21807  |    Dim dintFor2    As Integer                    ||21762  |    Dim dintFor2    As Integer                    
21808  |    Dim dlngMeisyoSu As Integer                   ||21763  |    Dim dlngMeisyoSu As Integer                   
21809  |    Dim dlngCntsv As Long                         ||21764  |    Dim dlngCntsv As Long                         
21810  |    '2006/08/18 START K.Furuya 期中料率変更契約対 ||21765  |    '2006/08/18 START K.Furuya 期中料率変更契約対 
21811  |    Dim RuleNoCnt                   As Integer  ' ||21766  |    Dim RuleNoCnt                   As Integer  ' 
21812  |    Dim KityuFlg                    As Boolean  ' ||21767  |    Dim KityuFlg                    As Boolean  ' 
21813  |    Dim ddblNearBabyMotherRate      As Double   ' ||21768  |    Dim ddblNearBabyMotherRate      As Double   ' 
21814  |    Dim MonthlyCnt                  As Long       ||21769  |    Dim MonthlyCnt                  As Long       
21815  |    Dim dblNavTotal                 As Double   ' ||21770  |    Dim dblNavTotal                 As Double   ' 
21816  |    Dim intRange                    As Integer  ' ||21771  |    Dim intRange                    As Integer  ' 
21817  |    Dim strRange                    As String   ' ||21772  |    Dim strRange                    As String   ' 
21818  |    Dim EndFlg                      As Boolean  ' ||21773  |    Dim EndFlg                      As Boolean  ' 
21819  |    Dim SetPoint                    As Integer    ||21774  |    Dim SetPoint                    As Integer    
21820  |    Dim AddPoint                    As Integer    ||21775  |    Dim AddPoint                    As Integer    
21821  |    Dim strWord                     As String   ' ||21776  |    Dim strWord                     As String   ' 
21822  |    '2006/08/18 END   K.Furuya 期中料率変更契約対 ||21777  |    '2006/08/18 END   K.Furuya 期中料率変更契約対 
21823  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||21778  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
21824  |    Dim WkStart                     As String   ' ||21779  |    Dim WkStart                     As String   ' 
21825  |    Dim StartFlg                    As String   ' ||21780  |    Dim StartFlg                    As String   ' 
21826  |                                                  ||21781  |                                                  
21827  |    '戻り値初期化                                 ||21782  |    '戻り値初期化                                 
21828  |    fnblExcelEnglishOut_ChangeRate = False        ||21783  |    fnblExcelEnglishOut_ChangeRate = False        
21829  |    i = 0                                         ||21784  |    i = 0                                         
21830  |                                                  ||21785  |                                                  
21831  |On Error Resume Next                              ||21786  |On Error Resume Next                              
21832  |                                                  ||21787  |                                                  
21833  |    Set xlSheet = xlBook.Sheets(gProcessCnt)      ||21788  |    Set xlSheet = xlBook.Sheets(gProcessCnt)      
21834  |                                                  ||21789  |                                                  
21835  |    'Excelフォーマットを調整                      ||21790  |    'Excelフォーマットを調整                      
21836  |    xlSheet.Cells.ColumnWidth = 1                 ||21791  |    xlSheet.Cells.ColumnWidth = 1                 
21837  |    xlSheet.Cells.Font.Size = 11                  ||21792  |    xlSheet.Cells.Font.Size = 11                  
21838  |                                                  ||21793  |                                                  
21839  |    'シート名を設定(確認書**)                     ||21794  |    'シート名を設定(確認書**)                     
21840  |    '契約毎のシート番号を付番する                 ||21795  |    '契約毎のシート番号を付番する                 
21841  |    'xlBook.Sheets(gProcessCnt).Name = sWord33 & (||21796  |    'xlBook.Sheets(gProcessCnt).Name = sWord33 & (
21842  |    xlBook.Sheets(gProcessCnt).Name = sWord33a & g||21797  |    xlBook.Sheets(gProcessCnt).Name = sWord33a & g
21843  |                                                  ||21798  |                                                  
21844  |    'シートの余白を設定                           ||21799  |    'シートの余白を設定                           
21845  |    xlSheet.PageSetup.TopMargin = Application.Inch||21800  |    xlSheet.PageSetup.TopMargin = Application.Inch
21846  |    xlSheet.PageSetup.BottomMargin = Application.I||21801  |    xlSheet.PageSetup.BottomMargin = Application.I
21847  |    xlSheet.PageSetup.LeftMargin = Application.Inc||21802  |    xlSheet.PageSetup.LeftMargin = Application.Inc
21848  |    xlSheet.PageSetup.RightMargin = Application.In||21803  |    xlSheet.PageSetup.RightMargin = Application.In
21849  |                                                  ||21804  |                                                  
21850  |    DoEvents                                      ||21805  |    DoEvents                                      
21851  |    With xlSheet                                  ||21806  |    With xlSheet                                  
21852  |        '題目                                     ||21807  |        '題目                                     
21853  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||21808  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
21854  |            Case Mid(mstrContractFlag(1), 1, 1)   ||21809  |            Case Mid(mstrContractFlag(1), 1, 1)   
21855  |                .Cells(5, 1).Value = sWord0d      ||21810  |                .Cells(5, 1).Value = sWord0d      
21856  |            Case Mid(mstrContractFlag(2), 1, 1)   ||21811  |            Case Mid(mstrContractFlag(2), 1, 1)   
21857  |                .Cells(5, 1).Value = sWord0e      ||21812  |                .Cells(5, 1).Value = sWord0e      
21858  |            Case Mid(mstrContractFlag(3), 1, 1)   ||21813  |            Case Mid(mstrContractFlag(3), 1, 1)   
21859  |                .Cells(5, 1).Value = sWord0f      ||21814  |                .Cells(5, 1).Value = sWord0f      
21860  |            Case Else                             ||21815  |            Case Else                             
21861  |                MsgBox "契約区分が不正です。", vbC||21816  |                MsgBox "契約区分が不正です。", vbC
21862  |        End Select                                ||21817  |        End Select                                
21863  |        .Cells(5, 1).Font.Size = 14               ||21818  |        .Cells(5, 1).Font.Size = 14               
21864  |        .Range("A5:BG5").HorizontalAlignment = xlC||21819  |        .Range("A5:BG5").HorizontalAlignment = xlC
21865  |                                                  ||21820  |                                                  
21866  |        '出力日付                                 ||21821  |        '出力日付                                 
21867  |        If RTrim(txtSysOutDate.Text) = "" Then    ||21822  |        If RTrim(txtSysOutDate.Text) = "" Then    
21868  |            .Cells(3, 50).Value = sWord34a        ||21823  |            .Cells(3, 50).Value = sWord34a        
21869  |            .Cells(3, 50).HorizontalAlignment = xl||21824  |            .Cells(3, 50).HorizontalAlignment = xl
21870  |        Else                                      ||21825  |        Else                                      
21871  |            .Cells(3, 43).NumberFormatLocal = "@" ||21826  |            .Cells(3, 43).NumberFormatLocal = "@" 
21872  |            .Cells(3, 43).Value = CStr(Format(txtS||21827  |            .Cells(3, 43).Value = CStr(Format(txtS
21873  |        End If                                    ||21828  |        End If                                    
21874  |                                                  ||21829  |                                                  
21875  |        '下記のとおり･･･                          ||21830  |        '下記のとおり･･･                          
21876  |        .Cells(7, 2).Value = "Dear Sirs,"         ||21831  |        .Cells(7, 2).Value = "Dear Sirs,"         
21877  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||21832  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
21878  |            Case Mid(mstrContractFlag(1), 1, 1)   ||21833  |            Case Mid(mstrContractFlag(1), 1, 1)   
21879  |                .Cells(8, 2).Value = sWord3d      ||21834  |                .Cells(8, 2).Value = sWord3d      
21880  |            Case Mid(mstrContractFlag(2), 1, 1)   ||21835  |            Case Mid(mstrContractFlag(2), 1, 1)   
21881  |                .Cells(8, 2).Value = sWord3e      ||21836  |                .Cells(8, 2).Value = sWord3e      
21882  |            Case Mid(mstrContractFlag(3), 1, 1)   ||21837  |            Case Mid(mstrContractFlag(3), 1, 1)   
21883  |                .Cells(8, 2).Value = sWord3f      ||21838  |                .Cells(8, 2).Value = sWord3f      
21884  |            Case Else                             ||21839  |            Case Else                             
21885  |        End Select                                ||21840  |        End Select                                
21886  |                                                  ||21841  |                                                  
21887  |        'ファンド名                               ||21842  |        'ファンド名                               
21888  |        .Cells(10, 2).Value = sWord4a             ||21843  |        .Cells(10, 2).Value = sWord4a             
21889  |        '文言の冗長化でピリオド及び、名称を二列右 ||21844  |        '文言の冗長化でピリオド及び、名称を二列右 
21890  |'        .Cells(10, 11).Value = sWord19           ||21845  |'        .Cells(10, 11).Value = sWord19           
21891  |'        .Cells(10, 13).Value = gbuMGetUPDRec.N(lR||21846  |'        .Cells(10, 13).Value = gbuMGetUPDRec.N(lR
21892  |        .Cells(10, 13).Value = sWord19            ||21847  |        .Cells(10, 13).Value = sWord19            
21893  |        .Cells(10, 15).Value = gbuMGetUPDRec.N(lRe||21848  |        .Cells(10, 15).Value = gbuMGetUPDRec.N(lRe
21894  |                                                  ||21849  |                                                  
21895  |        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_con||21850  |        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_con
21896  |                                                  ||21851  |                                                  
21897  |        'RAFI対応 START                           ||21852  |        'RAFI対応 START                           
21898  |        'NAV取得SQL                               ||21853  |        'NAV取得SQL                               
21899  |        '外部委託顧問料ルールの資産種類によって取 ||21854  |        '外部委託顧問料ルールの資産種類によって取 
21900  |        '純資産                                   ||21855  |        '純資産                                   
21901  |        If msAssetFlg = "0" Then                  ||21856  |        If msAssetFlg = "0" Then                  
21902  |            sSql = gstrEditSQLcfr_NavGetForSelectL||21857  |            sSql = gstrEditSQLcfr_NavGetForSelectL
21903  |        'マザー組入資産                           ||21858  |        'マザー組入資産                           
21904  |        Else                                      ||21859  |        Else                                      
21905  |            sSql = gstrEditSQLcfr_MotherAccGetForS||21860  |            sSql = gstrEditSQLcfr_MotherAccGetForS
21906  |        End If                                    ||21861  |        End If                                    
21907  |                                                  ||21862  |                                                  
21908  |        'ﾀﾞｲﾅｾｯﾄの作成                            ||21863  |        'ﾀﾞｲﾅｾｯﾄの作成                            
21909  |        If gintDyCreate(sSql) = False Then        ||21864  |        If gintDyCreate(sSql) = False Then        
21910  |            Exit Function                         ||21865  |            Exit Function                         
21911  |        End If                                    ||21866  |        End If                                    
21912  |        Do Until gblnDyEOF()                      ||21867  |        Do Until gblnDyEOF()                      
21913  |            '動的配列更新                         ||21868  |            '動的配列更新                         
21914  |            ReDim Preserve gtypcfr_navget_tbl(0 To||21869  |            ReDim Preserve gtypcfr_navget_tbl(0 To
21915  |            ReDim Preserve dstrAccCd(0 To NavGetCn||21870  |            ReDim Preserve dstrAccCd(0 To NavGetCn
21916  |                                                  ||21871  |                                                  
21917  |            'NAV取得抽出                          ||21872  |            'NAV取得抽出                          
21918  |            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT_||21873  |            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT_
21919  |            If NavGetCnt > 0 Then                 ||21874  |            If NavGetCnt > 0 Then                 
21920  |                sGetAccCode = sGetAccCode & " , " ||21875  |                sGetAccCode = sGetAccCode & " , " 
21921  |            Else                                  ||21876  |            Else                                  
21922  |                sGetAccCode = sGetAccCode & gtypcf||21877  |                sGetAccCode = sGetAccCode & gtypcf
21923  |            End If                                ||21878  |            End If                                
21924  |                                                  ||21879  |                                                  
21925  |            '口座コードの格納(１契約複数口座の場合||21880  |            '口座コードの格納(１契約複数口座の場合
21926  |            dstrAccCd(NavGetCnt) = gtypcfr_navget_||21881  |            dstrAccCd(NavGetCnt) = gtypcfr_navget_
21927  |            NavGetCnt = NavGetCnt + 1             ||21882  |            NavGetCnt = NavGetCnt + 1             
21928  |            'マザー組入資産の場合ベビーファンドコ ||21883  |            'マザー組入資産の場合ベビーファンドコ 
21929  |            If msAssetFlg = "1" Then              ||21884  |            If msAssetFlg = "1" Then              
21930  |                msBabyAccountCode = ""            ||21885  |                msBabyAccountCode = ""            
21931  |                msBabyAccountCode = Trim(gvlnDyDat||21886  |                msBabyAccountCode = Trim(gvlnDyDat
21932  |            End If                                ||21887  |            End If                                
21933  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     ||21888  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     
21934  |            Call gDyNext                          ||21889  |            Call gDyNext                          
21935  |        Loop                                      ||21890  |        Loop                                      
21936  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         ||21891  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         
21937  |        Call gblnDyClose                          ||21892  |        Call gblnDyClose                          
21938  |                                                  ||21893  |                                                  
21939  |        '１契約複数口座の場合に口座のベース通貨に ||21894  |        '１契約複数口座の場合に口座のベース通貨に 
21940  |        ReDim dstrBsCCd(0 To NavGetCnt - 1)       ||21895  |        ReDim dstrBsCCd(0 To NavGetCnt - 1)       
21941  |        If NavGetCnt - 1 > 0 Then                 ||21896  |        If NavGetCnt - 1 > 0 Then                 
21942  |            For dintFor = 0 To NavGetCnt - 1      ||21897  |            For dintFor = 0 To NavGetCnt - 1      
21943  |                sSql = ""                         ||21898  |                sSql = ""                         
21944  |                sSql = sSql & "SELECT ACCOUNT_CODE||21899  |                sSql = sSql & "SELECT ACCOUNT_CODE
21945  |                sSql = sSql & "WHERE ACCOUNT_CODE ||21900  |                sSql = sSql & "WHERE ACCOUNT_CODE 
21946  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||21901  |                'ﾀﾞｲﾅｾｯﾄの作成                    
21947  |                If gintDyCreate(sSql) = False Then||21902  |                If gintDyCreate(sSql) = False Then
21948  |                    Exit Function                 ||21903  |                    Exit Function                 
21949  |                Else                              ||21904  |                Else                              
21950  |                    dstrBsCCd(dintFor) = gvlnDyDat||21905  |                    dstrBsCCd(dintFor) = gvlnDyDat
21951  |                End If                            ||21906  |                End If                            
21952  |                If dintFor > 0 Then               ||21907  |                If dintFor > 0 Then               
21953  |                    If dstrBsCCd(dintFor) <> dstrB||21908  |                    If dstrBsCCd(dintFor) <> dstrB
21954  |                        intRtn = MsgBox("ファンド ||21909  |                        intRtn = MsgBox("ファンド 
21955  |                        Exit Function             ||21910  |                        Exit Function             
21956  |                    End If                        ||21911  |                    End If                        
21957  |                End If                            ||21912  |                End If                            
21958  |            Next dintFor                          ||21913  |            Next dintFor                          
21959  |                                                  ||21914  |                                                  
21960  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||21915  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
21961  |            Call gblnDyClose                      ||21916  |            Call gblnDyClose                      
21962  |                                                  ||21917  |                                                  
21963  |        End If                                    ||21918  |        End If                                    
21964  |                                                  ||21919  |                                                  
21965  |        'ファンドコード                           ||21920  |        'ファンドコード                           
21966  |        .Cells(11, 2).Value = sWord4_2a           ||21921  |        .Cells(11, 2).Value = sWord4_2a           
21967  |        '文言の冗長化でピリオド及び、名称を二列右 ||21922  |        '文言の冗長化でピリオド及び、名称を二列右 
21968  |'        .Cells(11, 11).Value = sWord19           ||21923  |'        .Cells(11, 11).Value = sWord19           
21969  |'        .Cells(11, 13).NumberFormatLocal = "@"   ||21924  |'        .Cells(11, 13).NumberFormatLocal = "@"   
21970  |        .Cells(11, 13).Value = sWord19            ||21925  |        .Cells(11, 13).Value = sWord19            
21971  |        .Cells(11, 15).NumberFormatLocal = "@"    ||21926  |        .Cells(11, 15).NumberFormatLocal = "@"    
21972  |        'RAFI対応 START                           ||21927  |        'RAFI対応 START                           
21973  |        '純資産の場合                             ||21928  |        '純資産の場合                             
21974  |        If msAssetFlg = "0" Then                  ||21929  |        If msAssetFlg = "0" Then                  
21975  |'            .Cells(11, 13).Value = sGetAccCode   ||21930  |'            .Cells(11, 13).Value = sGetAccCode   
21976  |            .Cells(11, 15).Value = sGetAccCode    ||21931  |            .Cells(11, 15).Value = sGetAccCode    
21977  |        'マザー組入資産の場合                     ||21932  |        'マザー組入資産の場合                     
21978  |        Else                                      ||21933  |        Else                                      
21979  |'            .Cells(11, 13).Value = msBabyAccountC||21934  |'            .Cells(11, 13).Value = msBabyAccountC
21980  |            .Cells(11, 15).Value = msBabyAccountCo||21935  |            .Cells(11, 15).Value = msBabyAccountCo
21981  |        End If                                    ||21936  |        End If                                    
21982  |        'RAFI対応 END                             ||21937  |        'RAFI対応 END                             
21983  |                                                  ||21938  |                                                  
21984  |        '計算期間                                 ||21939  |        '計算期間                                 
21985  |        .Cells(13, 2).Value = sWord5a             ||21940  |        .Cells(13, 2).Value = sWord5a             
21986  |        '文言の冗長化でピリオド及び、名称を二列右 ||21941  |        '文言の冗長化でピリオド及び、名称を二列右 
21987  |'        .Cells(13, 11).Value = sWord19           ||21942  |'        .Cells(13, 11).Value = sWord19           
21988  |        .Cells(13, 13).Value = sWord19            ||21943  |        .Cells(13, 13).Value = sWord19            
21989  |                                                  ||21944  |                                                  
21990  |        '前回締日・直近締日セット                 ||21945  |        '前回締日・直近締日セット                 
21991  |        dStart = CDate(gstrDateFormat(mstrSettleme||21946  |        dStart = CDate(gstrDateFormat(mstrSettleme
21992  |        dEnd = CDate(gstrDateFormat(mstrNearSettle||21947  |        dEnd = CDate(gstrDateFormat(mstrNearSettle
21993  |        dstrDate = Replace(CStr(dEnd), "/", "")   ||21948  |        dstrDate = Replace(CStr(dEnd), "/", "")   
21994  |        iCalcNum = DateDiff("d", dStart, dEnd) + 1||21949  |        iCalcNum = DateDiff("d", dStart, dEnd) + 1
21995  |                                                  ||21950  |                                                  
21996  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||21951  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
21997  |        WkStart = Replace(CStr(dStart), "/", "")  ||21952  |        WkStart = Replace(CStr(dStart), "/", "")  
21998  |        '期中料率変更対象契約                     ||21953  |        '期中料率変更対象契約                     
21999  |        '外部委託顧問料率を定義体配列にセット     ||21954  |        '外部委託顧問料率を定義体配列にセット     
22000  |        If fnSetOtherComRate(gbuMGetUPDRec.N(lRecI||21955  |        If fnSetOtherComRate(gbuMGetUPDRec.N(lRecI
22001  |                             msAssetFlg, msBabyAcc||21956  |                             msAssetFlg, msBabyAcc
22002  |                             gbuMGetUPDRec.N(lRecI||21957  |                             gbuMGetUPDRec.N(lRecI
22003  |                             conDBasset_type_codeA||21958  |                             conDBasset_type_codeA
22004  |                             WkStart, _           ||21959  |                             WkStart, _           
22005  |                             "1") = False Then    ||21960  |                             "1") = False Then    
22006  |            Exit Function                         ||21961  |            Exit Function                         
22007  |        End If                                    ||21962  |        End If                                    
22008  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||21963  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
22009  |                                                  ||21964  |                                                  
22010  |        '年率                                     ||21965  |        '年率                                     
22011  |        .Cells(15, 2).Value = sWord10a            ||21966  |        .Cells(15, 2).Value = sWord10a            
22012  |        '文言の冗長化でピリオド及び、名称を二列右 ||21967  |        '文言の冗長化でピリオド及び、名称を二列右 
22013  |'        .Cells(15, 11).Value = sWord19           ||21968  |'        .Cells(15, 11).Value = sWord19           
22014  |        .Cells(15, 13).Value = sWord19            ||21969  |        .Cells(15, 13).Value = sWord19            
22015  |                                                  ||21970  |                                                  
22016  |        '月末純資産                               ||21971  |        '月末純資産                               
22017  |        '開始位置を変更                           ||21972  |        '開始位置を変更                           
22018  |'        .Cells(27, 2).Value = sWord6a            ||21973  |'        .Cells(27, 2).Value = sWord6a            
22019  |'        .Cells(27, 21).Value = sWord19           ||21974  |'        .Cells(27, 21).Value = sWord19           
22020  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||21975  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
22021  |        '取得NAV区分が4:日次時価総額平均の場合"Mon||21976  |        '取得NAV区分が4:日次時価総額平均の場合"Mon
22022  |        If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||21977  |        If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
22023  |            .Cells(20, 2).Value = sWord63a        ||21978  |            .Cells(20, 2).Value = sWord63a        
22024  |        Else                                      ||21979  |        Else                                      
22025  |            .Cells(20, 2).Value = sWord6a         ||21980  |            .Cells(20, 2).Value = sWord6a         
22026  |        End If                                    ||21981  |        End If                                    
22027  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||21982  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
22028  |        .Cells(20, 21).Value = sWord19            ||21983  |        .Cells(20, 21).Value = sWord19            
22029  |                                                  ||21984  |                                                  
22030  |        '@@@@@ 合計行を出力しないならここをコメン ||21985  |        '@@@@@ 合計行を出力しないならここをコメン 
22031  |        '合計(純資産)                             ||21986  |        '合計(純資産)                             
22032  |        .Cells(40, 25).Value = sWord9a            ||21987  |        .Cells(40, 25).Value = sWord9a            
22033  |        .Range("X40:AI40").HorizontalAlignment = x||21988  |        .Range("X40:AI40").HorizontalAlignment = x
22034  |                                                  ||21989  |                                                  
22035  |'        '契約区分「1」or「2」                    ||21990  |'        '契約区分「1」or「2」                    
22036  |'        '契約区分「1」or「2」or (「3」and 取得NAV||21991  |'        '契約区分「1」or「2」or (「3」and 取得NAV
22037  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||21992  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
22038  |        Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||21993  |        Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
22039  |        Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||21994  |        Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
22040  |                                                  ||21995  |                                                  
22041  |'取得NAV区分[1]                                   ||21996  |'取得NAV区分[1]                                   
22042  |            '月末NAV取得                          ||21997  |            '月末NAV取得                          
22043  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g||21998  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g
22044  |                '月次NAVを取得する                ||21999  |                '月次NAVを取得する                
22045  |                Call sbMonthlyNAV_GetChangeRate(lR||22000  |                Call sbMonthlyNAV_GetChangeRate(lR
22046  |                                                  ||22001  |                                                  
22047  |                'カウンターを初期化               ||22002  |                'カウンターを初期化               
22048  |                K = 0                             ||22003  |                K = 0                             
22049  |                '月次NAV表を作成する              ||22004  |                '月次NAV表を作成する              
22050  |                For i = LBound(gtypOtherComRec) To||22005  |                For i = LBound(gtypOtherComRec) To
22051  |                    For J = LBound(gtypOtherComRec||22006  |                    For J = LBound(gtypOtherComRec
22052  |                        '日付                     ||22007  |                        '日付                     
22053  |                        .Cells(20 + K, 25).NumberF||22008  |                        .Cells(20 + K, 25).NumberF
22054  |                        .Cells(20 + K, 25).Value =||22009  |                        .Cells(20 + K, 25).Value =
22055  |                        .Cells(20 + K, 25).Horizon||22010  |                        .Cells(20 + K, 25).Horizon
22056  |                        '純資産                   ||22011  |                        '純資産                   
22057  |                        .Cells(20 + K, 49).NumberF||22012  |                        .Cells(20 + K, 49).NumberF
22058  |                        If gtypOtherComRec(i).APPL||22013  |                        If gtypOtherComRec(i).APPL
22059  |                            .Cells(20 + K, 49).Val||22014  |                            .Cells(20 + K, 49).Val
22060  |                                CStr(Format(gtypOt||22015  |                                CStr(Format(gtypOt
22061  |                        Else                      ||22016  |                        Else                      
22062  |                            .Cells(20 + K, 49).Val||22017  |                            .Cells(20 + K, 49).Val
22063  |                                CStr(Format(gtypOt||22018  |                                CStr(Format(gtypOt
22064  |                        End If                    ||22019  |                        End If                    
22065  |                        .Cells(20 + K, 49).Horizon||22020  |                        .Cells(20 + K, 49).Horizon
22066  |                                                  ||22021  |                                                  
22067  |                        K = K + 1                 ||22022  |                        K = K + 1                 
22068  |                    Next J                        ||22023  |                    Next J                        
22069  |                    '純資産総額を算出する         ||22024  |                    '純資産総額を算出する         
22070  |                    TotalNav = TotalNav + gtypOthe||22025  |                    TotalNav = TotalNav + gtypOthe
22071  |                    '合計(純資産) ,表中の文言     ||22026  |                    '合計(純資産) ,表中の文言     
22072  |                    .Cells(20 + K, 25).Value = sWo||22027  |                    .Cells(20 + K, 25).Value = sWo
22073  |                    '合計(金額)                   ||22028  |                    '合計(金額)                   
22074  |                    .Cells(20 + K, 49).NumberForma||22029  |                    .Cells(20 + K, 49).NumberForma
22075  |                    If gtypOtherComRec(i).APPLY_BA||22030  |                    If gtypOtherComRec(i).APPLY_BA
22076  |                        .Cells(20 + K, 49).Value =||22031  |                        .Cells(20 + K, 49).Value =
22077  |                            CStr(Format(gtypOtherC||22032  |                            CStr(Format(gtypOtherC
22078  |                    Else                          ||22033  |                    Else                          
22079  |                        .Cells(20 + K, 49).Value =||22034  |                        .Cells(20 + K, 49).Value =
22080  |                            CStr(Format(gtypOtherC||22035  |                            CStr(Format(gtypOtherC
22081  |                    End If                        ||22036  |                    End If                        
22082  |                    .Cells(20 + K, 49).HorizontalA||22037  |                    .Cells(20 + K, 49).HorizontalA
22083  |                    K = K + 1                     ||22038  |                    K = K + 1                     
22084  |                    '平均NAV ,表中の文言          ||22039  |                    '平均NAV ,表中の文言          
22085  |                    .Cells(20 + K, 25).Value = sWo||22040  |                    .Cells(20 + K, 25).Value = sWo
22086  |                    '平均NAV(金額)                ||22041  |                    '平均NAV(金額)                
22087  |                    .Cells(20 + K, 49).NumberForma||22042  |                    .Cells(20 + K, 49).NumberForma
22088  |                    If gtypOtherComRec(i).APPLY_BA||22043  |                    If gtypOtherComRec(i).APPLY_BA
22089  |                        .Cells(20 + K, 49).Value =||22044  |                        .Cells(20 + K, 49).Value =
22090  |                            CStr(Format(gtypOtherC||22045  |                            CStr(Format(gtypOtherC
22091  |                    Else                          ||22046  |                    Else                          
22092  |                        .Cells(20 + K, 49).Value =||22047  |                        .Cells(20 + K, 49).Value =
22093  |                            CStr(Format(gtypOtherC||22048  |                            CStr(Format(gtypOtherC
22094  |                    End If                        ||22049  |                    End If                        
22095  |                    .Cells(20 + K, 49).HorizontalA||22050  |                    .Cells(20 + K, 49).HorizontalA
22096  |                                                  ||22051  |                                                  
22097  |                    K = K + 1                     ||22052  |                    K = K + 1                     
22098  |                Next i                            ||22053  |                Next i                            
22099  |                                                  ||22054  |                                                  
22100  |                 '@@@@@ 合計行を出力しないならここ||22055  |                 '@@@@@ 合計行を出力しないならここ
22101  |                .Cells(40, 49).NumberFormatLocal =||22056  |                .Cells(40, 49).NumberFormatLocal =
22102  |                .Cells(40, 49).Value = CStr(Format||22057  |                .Cells(40, 49).Value = CStr(Format
22103  |                                                  ||22058  |                                                  
22104  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||22059  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
22105  |                   '@@@@@ 合計行を出力しないならこ||22060  |                   '@@@@@ 合計行を出力しないならこ
22106  |                   .Cells(40, 49).Value = CStr(For||22061  |                   .Cells(40, 49).Value = CStr(For
22107  |                Else                              ||22062  |                Else                              
22108  |                   '合計行を出力しないならここをコ||22063  |                   '合計行を出力しないならここをコ
22109  |                   .Cells(40, 49).Value = CStr(For||22064  |                   .Cells(40, 49).Value = CStr(For
22110  |                End If                            ||22065  |                End If                            
22111  |                .Cells(40, 49).HorizontalAlignment||22066  |                .Cells(40, 49).HorizontalAlignment
22112  |                                                  ||22067  |                                                  
22113  |                '平均純資産総額                   ||22068  |                '平均純資産総額                   
22114  |                .Cells(43, 2).Value = sWord51a    ||22069  |                .Cells(43, 2).Value = sWord51a    
22115  |                .Cells(43, 16).Value = sWord19    ||22070  |                .Cells(43, 16).Value = sWord19    
22116  |                '平均純資産総額は別紙に記載       ||22071  |                '平均純資産総額は別紙に記載       
22117  |                strWord = ""                      ||22072  |                strWord = ""                      
22118  |                strWord = strWord & sWord53a & """||22073  |                strWord = strWord & sWord53a & """
22119  |                Select Case Mid(gbuMGetUPDRec.N(lR||22074  |                Select Case Mid(gbuMGetUPDRec.N(lR
22120  |                    Case Mid(mstrContractFlag(1), ||22075  |                    Case Mid(mstrContractFlag(1), 
22121  |                        strWord = strWord & sWord5||22076  |                        strWord = strWord & sWord5
22122  |                    Case Mid(mstrContractFlag(2), ||22077  |                    Case Mid(mstrContractFlag(2), 
22123  |                        strWord = strWord & sWord5||22078  |                        strWord = strWord & sWord5
22124  |                    Case Mid(mstrContractFlag(3), ||22079  |                    Case Mid(mstrContractFlag(3), 
22125  |                        strWord = strWord & sWord5||22080  |                        strWord = strWord & sWord5
22126  |                    Case Else                     ||22081  |                    Case Else                     
22127  |                End Select                        ||22082  |                End Select                        
22128  |                .Cells(43, 19).Value = strWord    ||22083  |                .Cells(43, 19).Value = strWord    
22129  |                                                  ||22084  |                                                  
22130  |'                 '計算期間の純資産総額の合計(月末||22085  |'                 '計算期間の純資産総額の合計(月末
22131  |'                 .Cells(43, 28).NumberFormatLocal||22086  |'                 .Cells(43, 28).NumberFormatLocal
22132  |'                                                 ||22087  |'                                                 
22133  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET||22088  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET
22134  |'                     .Cells(43, 28).Value = CStr(||22089  |'                     .Cells(43, 28).Value = CStr(
22135  |'                 Else                            ||22090  |'                 Else                            
22136  |'                     .Cells(43, 28).Value = CStr(||22091  |'                     .Cells(43, 28).Value = CStr(
22137  |'                 End If                          ||22092  |'                 End If                          
22138  |'                                                 ||22093  |'                                                 
22139  |'                 .Cells(43, 28).HorizontalAlignme||22094  |'                 .Cells(43, 28).HorizontalAlignme
22140  |'                                                 ||22095  |'                                                 
22141  |'                 '計算期間の純資産総額の合計÷計 ||22096  |'                 '計算期間の純資産総額の合計÷計 
22142  |'                 .Cells(43, 40).NumberFormatLocal||22097  |'                 .Cells(43, 40).NumberFormatLocal
22143  |'                 dblValueIn = TotalNav / iRowCnt ||22098  |'                 dblValueIn = TotalNav / iRowCnt 
22144  |'                                                 ||22099  |'                                                 
22145  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET||22100  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET
22146  |'                     Call sbGetRoundValue2(dblVal||22101  |'                     Call sbGetRoundValue2(dblVal
22147  |'                 Else                            ||22102  |'                 Else                            
22148  |'                     Call sbGetRoundValue(dblValu||22103  |'                     Call sbGetRoundValue(dblValu
22149  |'                 End If                          ||22104  |'                 End If                          
22150  |'                                                 ||22105  |'                                                 
22151  |'                '平均NAV(計算対象NAV)            ||22106  |'                '平均NAV(計算対象NAV)            
22152  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||22107  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
22153  |'                    .Cells(43, 40).Value = CStr(F||22108  |'                    .Cells(43, 40).Value = CStr(F
22154  |'                Else                             ||22109  |'                Else                             
22155  |'                    .Cells(43, 40).Value = CStr(F||22110  |'                    .Cells(43, 40).Value = CStr(F
22156  |'                End If                           ||22111  |'                End If                           
22157  |'                                                 ||22112  |'                                                 
22158  |'                '÷??＝                          ||22113  |'                '÷??＝                          
22159  |'                          .Cells(43, 31).Value = ||22114  |'                          .Cells(43, 31).Value = 
22160  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||22115  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
22161  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_n||22116  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_n
22162  |            '=====================================||22117  |            '=====================================
22163  |            '==                                   ||22118  |            '==                                   
22164  |            '==  '4':日次時価総額平均(休日込)の計 ||22119  |            '==  '4':日次時価総額平均(休日込)の計 
22165  |            '==                                   ||22120  |            '==                                   
22166  |            '=====================================||22121  |            '=====================================
22167  |                ddblTtalnav = 0                   ||22122  |                ddblTtalnav = 0                   
22168  |                For dintFor = 0 To NavGetCnt - 1  ||22123  |                For dintFor = 0 To NavGetCnt - 1  
22169  |                                                  ||22124  |                                                  
22170  |                    '日次時価総額平均取得         ||22125  |                    '日次時価総額平均取得         
22171  |                    sStart = gstrDateFormat2(CStr(||22126  |                    sStart = gstrDateFormat2(CStr(
22172  |                    sEnd = gstrDateFormat2(CStr(dE||22127  |                    sEnd = gstrDateFormat2(CStr(dE
22173  |                                                  ||22128  |                                                  
22174  |'2008/03/03 START '計算開始日と外部委託顧問料計算 ||22129  |'2008/03/03 START '計算開始日と外部委託顧問料計算 
22175  |                    '等しい場合                   ||22130  |                    '等しい場合                   
22176  |                    If sStart = gbuMGetUPDRec.N(lR||22131  |                    If sStart = gbuMGetUPDRec.N(lR
22177  |                        StartFlg = "1"            ||22132  |                        StartFlg = "1"            
22178  |                    Else                          ||22133  |                    Else                          
22179  |                        StartFlg = "0"            ||22134  |                        StartFlg = "0"            
22180  |                    End If                        ||22135  |                    End If                        
22181  |'2008/03/03 END   '計算開始日と外部委託顧問料計算 ||22136  |'2008/03/03 END   '計算開始日と外部委託顧問料計算 
22182  |                                                  ||22137  |                                                  
22183  |                    '計算開始日と外部委託顧問料計 ||22138  |                    '計算開始日と外部委託顧問料計 
22184  |                    If sStart = gbuMGetUPDRec.N(lR||22139  |                    If sStart = gbuMGetUPDRec.N(lR
22185  |                        '== SQL1 ==               ||22140  |                        '== SQL1 ==               
22186  |                        sSql = ""                 ||22141  |                        sSql = ""                 
22187  |                        sSql = sSql & "SELECT EIGY||22142  |                        sSql = sSql & "SELECT EIGY
22188  |                                                  ||22143  |                                                  
22189  |                        'ﾀﾞｲﾅｾｯﾄの作成            ||22144  |                        'ﾀﾞｲﾅｾｯﾄの作成            
22190  |                        If gintDyCreate(sSql) = Fa||22145  |                        If gintDyCreate(sSql) = Fa
22191  |                            Exit Function         ||22146  |                            Exit Function         
22192  |                        Else                      ||22147  |                        Else                      
22193  |                            '休日の場合、翌営業日 ||22148  |                            '休日の場合、翌営業日 
22194  |                            If gvlnDyDataS("EIGYO_||22149  |                            If gvlnDyDataS("EIGYO_
22195  |                                '翌営業日の時価総 ||22150  |                                '翌営業日の時価総 
22196  |                                '== SQL2 ==       ||22151  |                                '== SQL2 ==       
22197  |                                sSql = ""         ||22152  |                                sSql = ""         
22198  |                                sSql = sSql & "SEL||22153  |                                sSql = sSql & "SEL
22199  |                                sSql = sSql & "FRO||22154  |                                sSql = sSql & "FRO
22200  |                                sSql = sSql & "(SE||22155  |                                sSql = sSql & "(SE
22201  |                                sSql = sSql & "WHE||22156  |                                sSql = sSql & "WHE
22202  |                                                  ||22157  |                                                  
22203  |                                'ﾀﾞｲﾅｾｯﾄの作成    ||22158  |                                'ﾀﾞｲﾅｾｯﾄの作成    
22204  |                                If gintDyCreate(sS||22159  |                                If gintDyCreate(sS
22205  |                                    Exit Function ||22160  |                                    Exit Function 
22206  |                                Else              ||22161  |                                Else              
22207  |                                    ddblNearNav = ||22162  |                                    ddblNearNav = 
22208  |'2008/03/06 START 時価総額基準の外部委託顧問料対応||22163  |'2008/03/06 START 時価総額基準の外部委託顧問料対応
22209  |'                                    '翌営業日の計||22164  |'                                    '翌営業日の計
22210  |'                                    '== SQL3 ==  ||22165  |'                                    '== SQL3 ==  
22211  |'                                    sSql = ""    ||22166  |'                                    sSql = ""    
22212  |'                                    sSql = sSql &||22167  |'                                    sSql = sSql &
22213  |'                                    sSql = sSql &||22168  |'                                    sSql = sSql &
22214  |'                                    sSql = sSql &||22169  |'                                    sSql = sSql &
22215  |'                                    sSql = sSql &||22170  |'                                    sSql = sSql &
22216  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||22171  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
22217  |'                                    If gintDyCrea||22172  |'                                    If gintDyCrea
22218  |'                                        Exit Func||22173  |'                                        Exit Func
22219  |'                                     Else        ||22174  |'                                     Else        
22220  |'                                        '計算開始||22175  |'                                        '計算開始
22221  |'                                        sStart = ||22176  |'                                        sStart = 
22222  |'                                        dStart = ||22177  |'                                        dStart = 
22223  |'                                        '文言の冗||22178  |'                                        '文言の冗
22224  |''                                        .Cells(1||22179  |''                                        .Cells(1
22225  |''                                            CStr||22180  |''                                            CStr
22226  |'                                        .Cells(16||22181  |'                                        .Cells(16
22227  |'                                            CStr(||22182  |'                                            CStr(
22228  |'                                        iCalcNum ||22183  |'                                        iCalcNum 
22229  |'                                    End If       ||22184  |'                                    End If       
22230  |'2008/03/06 END   時価総額基準の外部委託顧問料対応||22185  |'2008/03/06 END   時価総額基準の外部委託顧問料対応
22231  |                                                  ||22186  |                                                  
22232  |                                    'SQL文の作成( ||22187  |                                    'SQL文の作成( 
22233  |                                    '計算期間の開 ||22188  |                                    '計算期間の開 
22234  |                                    sSql = gstrEdi||22189  |                                    sSql = gstrEdi
22235  |                                        ContNo, sS||22190  |                                        ContNo, sS
22236  |                                                  ||22191  |                                                  
22237  |                                     'ﾀﾞｲﾅｾｯﾄの作 ||22192  |                                     'ﾀﾞｲﾅｾｯﾄの作 
22238  |                                    If gintDyCreat||22193  |                                    If gintDyCreat
22239  |                                        Exit Funct||22194  |                                        Exit Funct
22240  |                                    End If        ||22195  |                                    End If        
22241  |                                    '配列初期化   ||22196  |                                    '配列初期化   
22242  |                                    ReDim gbuOther||22197  |                                    ReDim gbuOther
22243  |                                    MonthlyCnt = 0||22198  |                                    MonthlyCnt = 0
22244  |                                    'EOF判定処理  ||22199  |                                    'EOF判定処理  
22245  |                                    Do Until gblnD||22200  |                                    Do Until gblnD
22246  |                                        '対象デー ||22201  |                                        '対象デー 
22247  |                                        Call sbOth||22202  |                                        Call sbOth
22248  |                                        MonthlyCnt||22203  |                                        MonthlyCnt
22249  |                                        'ﾀﾞｲﾅｾｯﾄ次||22204  |                                        'ﾀﾞｲﾅｾｯﾄ次
22250  |                                        Call gDyNe||22205  |                                        Call gDyNe
22251  |                                    Loop          ||22206  |                                    Loop          
22252  |                                                  ||22207  |                                                  
22253  |                                    '期中料率変更 ||22208  |                                    '期中料率変更 
22254  |                                    Erase gtypOthe||22209  |                                    Erase gtypOthe
22255  |                                                  ||22210  |                                                  
22256  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||22211  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
22257  |                                    '期中料率変更 ||22212  |                                    '期中料率変更 
22258  |                                    '外部委託顧問 ||22213  |                                    '外部委託顧問 
22259  |                                    If fnSetOtherC||22214  |                                    If fnSetOtherC
22260  |                                                  ||22215  |                                                  
22261  |                                                  ||22216  |                                                  
22262  |                                                  ||22217  |                                                  
22263  |                                                  ||22218  |                                                  
22264  |                                                  ||22219  |                                                  
22265  |                                        Exit Funct||22220  |                                        Exit Funct
22266  |                                    End If        ||22221  |                                    End If        
22267  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||22222  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
22268  |                                                  ||22223  |                                                  
22269  |                                End If            ||22224  |                                End If            
22270  |                                'RAFI対応 START   ||22225  |                                'RAFI対応 START   
22271  |                                '翌営業日のマザー ||22226  |                                '翌営業日のマザー 
22272  |                                If msAssetFlg = "1||22227  |                                If msAssetFlg = "1
22273  |                                    '== SQL4 ==   ||22228  |                                    '== SQL4 ==   
22274  |                                    sSql = ""     ||22229  |                                    sSql = ""     
22275  |                                    sSql = sSql & ||22230  |                                    sSql = sSql & 
22276  |                                    sSql = sSql & ||22231  |                                    sSql = sSql & 
22277  |                                    sSql = sSql & ||22232  |                                    sSql = sSql & 
22278  |                                    sSql = sSql & ||22233  |                                    sSql = sSql & 
22279  |                                    sSql = sSql & ||22234  |                                    sSql = sSql & 
22280  |                                    sSql = sSql & ||22235  |                                    sSql = sSql & 
22281  |                                    sSql = sSql & ||22236  |                                    sSql = sSql & 
22282  |                                    sSql = sSql & ||22237  |                                    sSql = sSql & 
22283  |                                    sSql = sSql & ||22238  |                                    sSql = sSql & 
22284  |                                    sSql = sSql & ||22239  |                                    sSql = sSql & 
22285  |                                    sSql = sSql & ||22240  |                                    sSql = sSql & 
22286  |                                    sSql = sSql & ||22241  |                                    sSql = sSql & 
22287  |                                    sSql = sSql & ||22242  |                                    sSql = sSql & 
22288  |                                    sSql = sSql & ||22243  |                                    sSql = sSql & 
22289  |                                    sSql = sSql & ||22244  |                                    sSql = sSql & 
22290  |                                    sSql = sSql & ||22245  |                                    sSql = sSql & 
22291  |                                    sSql = sSql & ||22246  |                                    sSql = sSql & 
22292  |                                    sSql = sSql & ||22247  |                                    sSql = sSql & 
22293  |                                    sSql = sSql & ||22248  |                                    sSql = sSql & 
22294  |                                    sSql = sSql & ||22249  |                                    sSql = sSql & 
22295  |                                    sSql = sSql & ||22250  |                                    sSql = sSql & 
22296  |                                    sSql = sSql & ||22251  |                                    sSql = sSql & 
22297  |                                    sSql = sSql & ||22252  |                                    sSql = sSql & 
22298  |                                    sSql = sSql & ||22253  |                                    sSql = sSql & 
22299  |                                    'ﾀﾞｲﾅｾｯﾄの作成||22254  |                                    'ﾀﾞｲﾅｾｯﾄの作成
22300  |                                                  ||22255  |                                                  
22301  |                                    If gintDyCreat||22256  |                                    If gintDyCreat
22302  |                                        Exit Funct||22257  |                                        Exit Funct
22303  |                                    Else          ||22258  |                                    Else          
22304  |                                        ddblNearBa||22259  |                                        ddblNearBa
22305  |                                    End If        ||22260  |                                    End If        
22306  |                                End If            ||22261  |                                End If            
22307  |                                'RAFI対応 END     ||22262  |                                'RAFI対応 END     
22308  |                            End If                ||22263  |                            End If                
22309  |                        End If                    ||22264  |                        End If                    
22310  |                    End If                        ||22265  |                    End If                        
22311  |                    '== SQL5 ==                   ||22266  |                    '== SQL5 ==                   
22312  |                    sSql = ""                     ||22267  |                    sSql = ""                     
22313  |                    sSql = sSql & "SELECT CAL_YYYY||22268  |                    sSql = sSql & "SELECT CAL_YYYY
22314  |                    sSql = sSql & "WHERE CAL_YYYY ||22269  |                    sSql = sSql & "WHERE CAL_YYYY 
22315  |                                                  ||22270  |                                                  
22316  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||22271  |                    'ﾀﾞｲﾅｾｯﾄの作成                
22317  |                    If gintDyCreate(sSql) = False ||22272  |                    If gintDyCreate(sSql) = False 
22318  |                        Exit Function             ||22273  |                        Exit Function             
22319  |                    End If                        ||22274  |                    End If                        
22320  |                                                  ||22275  |                                                  
22321  |                    If dlngCnt = 0 Then           ||22276  |                    If dlngCnt = 0 Then           
22322  |                        ReDim dstrCaldate(gbxOraDy||22277  |                        ReDim dstrCaldate(gbxOraDy
22323  |                        ReDim ddblDailynav(gbxOraD||22278  |                        ReDim ddblDailynav(gbxOraD
22324  |                    End If                        ||22279  |                    End If                        
22325  |                                                  ||22280  |                                                  
22326  |                    'EOF判定処理                  ||22281  |                    'EOF判定処理                  
22327  |                    dlngCnt = 0                   ||22282  |                    dlngCnt = 0                   
22328  |                                                  ||22283  |                                                  
22329  |                    Do Until gblnDyEOF()          ||22284  |                    Do Until gblnDyEOF()          
22330  |                        dlngCnt = dlngCnt + 1     ||22285  |                        dlngCnt = dlngCnt + 1     
22331  |                        '抽出データセット         ||22286  |                        '抽出データセット         
22332  |                        dstrCaldate(dlngCnt) = gvl||22287  |                        dstrCaldate(dlngCnt) = gvl
22333  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||22288  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
22334  |                        Call gDyNext              ||22289  |                        Call gDyNext              
22335  |                    Loop                          ||22290  |                    Loop                          
22336  |                                                  ||22291  |                                                  
22337  |                    '2005/08/26　START            ||22292  |                    '2005/08/26　START            
22338  |                    '変数sStartに格納されている日 ||22293  |                    '変数sStartに格納されている日 
22339  |                    '変数sStartの直近の営業日の日 ||22294  |                    '変数sStartの直近の営業日の日 
22340  |                    '（変数sStartに格納されている ||22295  |                    '（変数sStartに格納されている 
22341  |                    '　直近日付が存在しない場合は ||22296  |                    '　直近日付が存在しない場合は 
22342  |                                                  ||22297  |                                                  
22343  |                    '== SQL6 ==                   ||22298  |                    '== SQL6 ==                   
22344  |                    sSql = ""                     ||22299  |                    sSql = ""                     
22345  |                    sSql = sSql & "SELECT MAX(BASE||22300  |                    sSql = sSql & "SELECT MAX(BASE
22346  |                    sSql = sSql & "FROM   CFR_DAIL||22301  |                    sSql = sSql & "FROM   CFR_DAIL
22347  |                    sSql = sSql & "WHERE  BASE_DAT||22302  |                    sSql = sSql & "WHERE  BASE_DAT
22348  |                    sSql = sSql & "AND    ACCOUNT_||22303  |                    sSql = sSql & "AND    ACCOUNT_
22349  |                                                  ||22304  |                                                  
22350  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||22305  |                    'ﾀﾞｲﾅｾｯﾄの作成                
22351  |                    If gintDyCreate(sSql) = False ||22306  |                    If gintDyCreate(sSql) = False 
22352  |                        Exit Function             ||22307  |                        Exit Function             
22353  |                    End If                        ||22308  |                    End If                        
22354  |                                                  ||22309  |                                                  
22355  |                    Do Until gblnDyEOF()          ||22310  |                    Do Until gblnDyEOF()          
22356  |                       '抽出データセット          ||22311  |                       '抽出データセット          
22357  |                        sStart = gvlnDyDataS("BASE||22312  |                        sStart = gvlnDyDataS("BASE
22358  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||22313  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
22359  |                        Call gDyNext              ||22314  |                        Call gDyNext              
22360  |                    Loop                          ||22315  |                    Loop                          
22361  |                                                  ||22316  |                                                  
22362  |                    'SQL文の作成(外部委託顧問料率 ||22317  |                    'SQL文の作成(外部委託顧問料率 
22363  |                    '計算期間の開始日と終了日に含 ||22318  |                    '計算期間の開始日と終了日に含 
22364  |                    sSql = gstrEditSQLcfr_OtherCom||22319  |                    sSql = gstrEditSQLcfr_OtherCom
22365  |                        ContNo, sStart, mstrNearSe||22320  |                        ContNo, sStart, mstrNearSe
22366  |                                                  ||22321  |                                                  
22367  |                     'ﾀﾞｲﾅｾｯﾄの作成               ||22322  |                     'ﾀﾞｲﾅｾｯﾄの作成               
22368  |                    If gintDyCreate(sSql) = False ||22323  |                    If gintDyCreate(sSql) = False 
22369  |                        Exit Function             ||22324  |                        Exit Function             
22370  |                    End If                        ||22325  |                    End If                        
22371  |                    '配列初期化                   ||22326  |                    '配列初期化                   
22372  |                    ReDim gbuOtherComRateGetUPDRec||22327  |                    ReDim gbuOtherComRateGetUPDRec
22373  |                    MonthlyCnt = 0                ||22328  |                    MonthlyCnt = 0                
22374  |                    'EOF判定処理                  ||22329  |                    'EOF判定処理                  
22375  |                    Do Until gblnDyEOF()          ||22330  |                    Do Until gblnDyEOF()          
22376  |                        '対象データ抽出           ||22331  |                        '対象データ抽出           
22377  |                        Call sbOtherComDataGet(Mon||22332  |                        Call sbOtherComDataGet(Mon
22378  |                        MonthlyCnt = MonthlyCnt + ||22333  |                        MonthlyCnt = MonthlyCnt + 
22379  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||22334  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
22380  |                        Call gDyNext              ||22335  |                        Call gDyNext              
22381  |                    Loop                          ||22336  |                    Loop                          
22382  |                                                  ||22337  |                                                  
22383  |                    '期中料率変更用配列のクリア   ||22338  |                    '期中料率変更用配列のクリア   
22384  |                    Erase gtypOtherComRec         ||22339  |                    Erase gtypOtherComRec         
22385  |                                                  ||22340  |                                                  
22386  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||22341  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
22387  |                    '期中料率変更対象契約         ||22342  |                    '期中料率変更対象契約         
22388  |                    '外部委託顧問料率を定義体配列 ||22343  |                    '外部委託顧問料率を定義体配列 
22389  |                    If fnSetOtherComRate(gbuMGetUP||22344  |                    If fnSetOtherComRate(gbuMGetUP
22390  |                                         msAssetFl||22345  |                                         msAssetFl
22391  |                                         gbuMGetUP||22346  |                                         gbuMGetUP
22392  |                                         conDBasse||22347  |                                         conDBasse
22393  |                                         sStart, _||22348  |                                         sStart, _
22394  |                                         StartFlg)||22349  |                                         StartFlg)
22395  |                        Exit Function             ||22350  |                        Exit Function             
22396  |                    End If                        ||22351  |                    End If                        
22397  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||22352  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
22398  |                                                  ||22353  |                                                  
22399  |                    'RAFI対応 START               ||22354  |                    'RAFI対応 START               
22400  |                    '純資産の場合                 ||22355  |                    '純資産の場合                 
22401  |                    If msAssetFlg = "0" Then      ||22356  |                    If msAssetFlg = "0" Then      
22402  |                        '計算開始日から計算終了日 ||22357  |                        '計算開始日から計算終了日 
22403  |                        '== SQL7 ==               ||22358  |                        '== SQL7 ==               
22404  |                        sSql = ""                 ||22359  |                        sSql = ""                 
22405  |                        sSql = sSql & "SELECT ACCO||22360  |                        sSql = sSql & "SELECT ACCO
22406  |                        sSql = sSql & "WHERE CFR_D||22361  |                        sSql = sSql & "WHERE CFR_D
22407  |                        sSql = sSql & "AND   (CFR_||22362  |                        sSql = sSql & "AND   (CFR_
22408  |                        sSql = sSql & "ORDER BY CF||22363  |                        sSql = sSql & "ORDER BY CF
22409  |                    'マザー組入資産の場合         ||22364  |                    'マザー組入資産の場合         
22410  |                    Else                          ||22365  |                    Else                          
22411  |                        '計算開始日から計算終了日 ||22366  |                        '計算開始日から計算終了日 
22412  |                        '== SQL8 ==               ||22367  |                        '== SQL8 ==               
22413  |                        sSql = ""                 ||22368  |                        sSql = ""                 
22414  |                        sSql = sSql & "SELECT"    ||22369  |                        sSql = sSql & "SELECT"    
22415  |                        sSql = sSql & "    a.ACCOU||22370  |                        sSql = sSql & "    a.ACCOU
22416  |                        sSql = sSql & "    a.BASE_||22371  |                        sSql = sSql & "    a.BASE_
22417  |                        sSql = sSql & "    a.MARKE||22372  |                        sSql = sSql & "    a.MARKE
22418  |                        sSql = sSql & "    b.BABY_||22373  |                        sSql = sSql & "    b.BABY_
22419  |                        sSql = sSql & "    b.BABY_||22374  |                        sSql = sSql & "    b.BABY_
22420  |                        sSql = sSql & " FROM"     ||22375  |                        sSql = sSql & " FROM"     
22421  |                        sSql = sSql & "    CFR_DAI||22376  |                        sSql = sSql & "    CFR_DAI
22422  |                        sSql = sSql & " WHERE"    ||22377  |                        sSql = sSql & " WHERE"    
22423  |                        sSql = sSql & "    b.BABY_||22378  |                        sSql = sSql & "    b.BABY_
22424  |                        sSql = sSql & "    b.MOTHE||22379  |                        sSql = sSql & "    b.MOTHE
22425  |                        sSql = sSql & "    b.BASE_||22380  |                        sSql = sSql & "    b.BASE_
22426  |                        sSql = sSql & "    a.ACCOU||22381  |                        sSql = sSql & "    a.ACCOU
22427  |                        sSql = sSql & "    (a.BASE||22382  |                        sSql = sSql & "    (a.BASE
22428  |                        sSql = sSql & "    a.BASE_||22383  |                        sSql = sSql & "    a.BASE_
22429  |                        sSql = sSql & " ORDER BY" ||22384  |                        sSql = sSql & " ORDER BY" 
22430  |                        sSql = sSql & "    a.BASE_||22385  |                        sSql = sSql & "    a.BASE_
22431  |                    End If                        ||22386  |                    End If                        
22432  |                    'RAFI対応 END                 ||22387  |                    'RAFI対応 END                 
22433  |                                                  ||22388  |                                                  
22434  |                    If gintDyCreate(sSql) = False ||22389  |                    If gintDyCreate(sSql) = False 
22435  |                        Exit Function             ||22390  |                        Exit Function             
22436  |                    End If                        ||22391  |                    End If                        
22437  |                                                  ||22392  |                                                  
22438  |                    dlngCntsv = dlngCnt           ||22393  |                    dlngCntsv = dlngCnt           
22439  |                    dlngCnt = 0                   ||22394  |                    dlngCnt = 0                   
22440  |                                                  ||22395  |                                                  
22441  |                    Do Until gblnDyEOF()          ||22396  |                    Do Until gblnDyEOF()          
22442  |                        dlngCnt = dlngCnt + 1     ||22397  |                        dlngCnt = dlngCnt + 1     
22443  |                        '抽出データセット         ||22398  |                        '抽出データセット         
22444  |                        dstrBasedate = gvlnDyDataS||22399  |                        dstrBasedate = gvlnDyDataS
22445  |                        If Mid(dstrCaldate(dlngCnt||22400  |                        If Mid(dstrCaldate(dlngCnt
22446  |                            'RAFI対応 START       ||22401  |                            'RAFI対応 START       
22447  |                            '純資産の場合         ||22402  |                            '純資産の場合         
22448  |                            If msAssetFlg = "0" Th||22403  |                            If msAssetFlg = "0" Th
22449  |                                ddblDailynav(dlngC||22404  |                                ddblDailynav(dlngC
22450  |                            'マザー組入資産の場合 ||22405  |                            'マザー組入資産の場合 
22451  |                            Else                  ||22406  |                            Else                  
22452  |                                ddblDailynav(dlngC||22407  |                                ddblDailynav(dlngC
22453  |                            End If                ||22408  |                            End If                
22454  |                            'RAFI対応 END         ||22409  |                            'RAFI対応 END         
22455  |                        Else                      ||22410  |                        Else                      
22456  |                            '計算開始日が外部委託 ||22411  |                            '計算開始日が外部委託 
22457  |                            If ddblNearNav <> 0 _ ||22412  |                            If ddblNearNav <> 0 _ 
22458  |                            And dlngCnt = 1 Then  ||22413  |                            And dlngCnt = 1 Then  
22459  |                                dstrCaldate2 = Mid||22414  |                                dstrCaldate2 = Mid
22460  |                                dstrBasedate2 = Mi||22415  |                                dstrBasedate2 = Mi
22461  |                                dlngDiffdate = Dat||22416  |                                dlngDiffdate = Dat
22462  |                                                  ||22417  |                                                  
22463  |                                For dintFor2 = 1 T||22418  |                                For dintFor2 = 1 T
22464  |                                    'RAFI対応 STAR||22419  |                                    'RAFI対応 STAR
22465  |                                    '純資産の場合 ||22420  |                                    '純資産の場合 
22466  |                                    If msAssetFlg ||22421  |                                    If msAssetFlg 
22467  |                                        ddblDailyn||22422  |                                        ddblDailyn
22468  |                                    'マザー組入資 ||22423  |                                    'マザー組入資 
22469  |                                    Else          ||22424  |                                    Else          
22470  |                                        ddblDailyn||22425  |                                        ddblDailyn
22471  |                                    End If        ||22426  |                                    End If        
22472  |                                    'RAFI対応 END ||22427  |                                    'RAFI対応 END 
22473  |                                    dlngCnt = dlng||22428  |                                    dlngCnt = dlng
22474  |                                Next dintFor2     ||22429  |                                Next dintFor2     
22475  |                                '純資産の場合     ||22430  |                                '純資産の場合     
22476  |                                If msAssetFlg = "0||22431  |                                If msAssetFlg = "0
22477  |                                    ddblDailynav(d||22432  |                                    ddblDailynav(d
22478  |                                'マザー組入資産の ||22433  |                                'マザー組入資産の 
22479  |                                Else              ||22434  |                                Else              
22480  |                                    ddblDailynav(d||22435  |                                    ddblDailynav(d
22481  |                                End If            ||22436  |                                End If            
22482  |                                'RAFI対応 END     ||22437  |                                'RAFI対応 END     
22483  |                            Else                  ||22438  |                            Else                  
22484  |                                '日次時価総額にデ ||22439  |                                '日次時価総額にデ 
22485  |                                dstrCaldate2 = Mid||22440  |                                dstrCaldate2 = Mid
22486  |                                dstrBasedate2 = Mi||22441  |                                dstrBasedate2 = Mi
22487  |                                dlngDiffdate = Dat||22442  |                                dlngDiffdate = Dat
22488  |                                                  ||22443  |                                                  
22489  |                                For dintFor2 = 1 T||22444  |                                For dintFor2 = 1 T
22490  |                                    If ddblDailyna||22445  |                                    If ddblDailyna
22491  |                                        ddblDailyn||22446  |                                        ddblDailyn
22492  |                                    Else          ||22447  |                                    Else          
22493  |                                        '日次NAVに||22448  |                                        '日次NAVに
22494  |                                        intRtn = M||22449  |                                        intRtn = M
22495  |                                        vbLf & "対||22450  |                                        vbLf & "対
22496  |                                        vbLf & "基||22451  |                                        vbLf & "基
22497  |                                            vbCrit||22452  |                                            vbCrit
22498  |                                        Exit Funct||22453  |                                        Exit Funct
22499  |                                    End If        ||22454  |                                    End If        
22500  |                                    dlngCnt = dlng||22455  |                                    dlngCnt = dlng
22501  |                                Next dintFor2     ||22456  |                                Next dintFor2     
22502  |                                'RAFI対応 START   ||22457  |                                'RAFI対応 START   
22503  |                                '純資産の場合     ||22458  |                                '純資産の場合     
22504  |                                If msAssetFlg = "0||22459  |                                If msAssetFlg = "0
22505  |                                    ddblDailynav(d||22460  |                                    ddblDailynav(d
22506  |                                'マザー組入資産の ||22461  |                                'マザー組入資産の 
22507  |                                Else              ||22462  |                                Else              
22508  |                                    ddblDailynav(d||22463  |                                    ddblDailynav(d
22509  |                                End If            ||22464  |                                End If            
22510  |                                'RAFI対応 END     ||22465  |                                'RAFI対応 END     
22511  |                            End If                ||22466  |                            End If                
22512  |                                                  ||22467  |                                                  
22513  |                        End If                    ||22468  |                        End If                    
22514  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||22469  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
22515  |                        Call gDyNext              ||22470  |                        Call gDyNext              
22516  |                    Loop                          ||22471  |                    Loop                          
22517  |                                                  ||22472  |                                                  
22518  |                Next dintFor                      ||22473  |                Next dintFor                      
22519  |                                                  ||22474  |                                                  
22520  |                If dlngCntsv <> dlngCnt Then      ||22475  |                If dlngCntsv <> dlngCnt Then      
22521  |                    For dintFor2 = dlngCnt + 1 To ||22476  |                    For dintFor2 = dlngCnt + 1 To 
22522  |                        ddblDailynav(dintFor2) = d||22477  |                        ddblDailynav(dintFor2) = d
22523  |                    Next dintFor2                 ||22478  |                    Next dintFor2                 
22524  |                    dlngCnt = dlngCntsv           ||22479  |                    dlngCnt = dlngCntsv           
22525  |                End If                            ||22480  |                End If                            
22526  |                                                  ||22481  |                                                  
22527  |                ddblTtalnav = 0                   ||22482  |                ddblTtalnav = 0                   
22528  |                                                  ||22483  |                                                  
22529  |                For dintFor2 = 1 To dlngCnt       ||22484  |                For dintFor2 = 1 To dlngCnt       
22530  |                    ddblTtalnav = ddblTtalnav + dd||22485  |                    ddblTtalnav = ddblTtalnav + dd
22531  |                Next dintFor2                     ||22486  |                Next dintFor2                     
22532  |                                                  ||22487  |                                                  
22533  |                'カレンダーを元に日次時価総額を配 ||22488  |                'カレンダーを元に日次時価総額を配 
22534  |                K = 0                             ||22489  |                K = 0                             
22535  |                For i = 1 To dlngCnt              ||22490  |                For i = 1 To dlngCnt              
22536  |                    '計算開始日の日次時価総額は無 ||22491  |                    '計算開始日の日次時価総額は無 
22537  |                    If i = 1 Then                 ||22492  |                    If i = 1 Then                 
22538  |                        gtypOtherComRec(K).APPLY_T||22493  |                        gtypOtherComRec(K).APPLY_T
22539  |                    Else                          ||22494  |                    Else                          
22540  |                        '適用終了日に成るまで累積 ||22495  |                        '適用終了日に成るまで累積 
22541  |                        If Mid(dstrCaldate(i), 1, ||22496  |                        If Mid(dstrCaldate(i), 1, 
22542  |                            gtypOtherComRec(K).APP||22497  |                            gtypOtherComRec(K).APP
22543  |                        'カレンダー日付が適用終了 ||22498  |                        'カレンダー日付が適用終了 
22544  |                        Else                      ||22499  |                        Else                      
22545  |                            '料率変更毎に平均NAVを||22500  |                            '料率変更毎に平均NAVを
22546  |                            gtypOtherComRec(K).APP||22501  |                            gtypOtherComRec(K).APP
22547  |                            '次の料率へシフトする ||22502  |                            '次の料率へシフトする 
22548  |                            K = K + 1             ||22503  |                            K = K + 1             
22549  |                            gtypOtherComRec(K).APP||22504  |                            gtypOtherComRec(K).APP
22550  |                        End If                    ||22505  |                        End If                    
22551  |                    End If                        ||22506  |                    End If                        
22552  |                    '最後のレコードの場合NAV平均を||22507  |                    '最後のレコードの場合NAV平均を
22553  |                    If i = dlngCnt Then           ||22508  |                    If i = dlngCnt Then           
22554  |                        '料率変更毎に平均NAVを算出||22509  |                        '料率変更毎に平均NAVを算出
22555  |                        gtypOtherComRec(K).APPLY_N||22510  |                        gtypOtherComRec(K).APPLY_N
22556  |                    End If                        ||22511  |                    End If                        
22557  |                Next i                            ||22512  |                Next i                            
22558  |                                                  ||22513  |                                                  
22559  |                iRowCnt = dlngCnt                 ||22514  |                iRowCnt = dlngCnt                 
22560  |                TotalNav = ddblTtalnav            ||22515  |                TotalNav = ddblTtalnav            
22561  |                dblValueIn = TotalNav             ||22516  |                dblValueIn = TotalNav             
22562  |                Call sbGetRoundValue2(dblValueIn) ||22517  |                Call sbGetRoundValue2(dblValueIn) 
22563  |                TotalNav = dblValueOut            ||22518  |                TotalNav = dblValueOut            
22564  |                                                  ||22519  |                                                  
22565  |                '平均純資産総額                   ||22520  |                '平均純資産総額                   
22566  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||22521  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
22567  |                '取得NAV区分が4:日次時価総額平均の||22522  |                '取得NAV区分が4:日次時価総額平均の
22568  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||22523  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
22569  |                    .Cells(43, 2).Value = sWord70a||22524  |                    .Cells(43, 2).Value = sWord70a
22570  |                Else                              ||22525  |                Else                              
22571  |                    .Cells(43, 2).Value = sWord51a||22526  |                    .Cells(43, 2).Value = sWord51a
22572  |                End If                            ||22527  |                End If                            
22573  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||22528  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
22574  |                .Cells(43, 16).Value = sWord19    ||22529  |                .Cells(43, 16).Value = sWord19    
22575  |                '平均純資産総額は別紙に記載       ||22530  |                '平均純資産総額は別紙に記載       
22576  |                strWord = ""                      ||22531  |                strWord = ""                      
22577  |                strWord = strWord & sWord53a & """||22532  |                strWord = strWord & sWord53a & """
22578  |                Select Case Mid(gbuMGetUPDRec.N(lR||22533  |                Select Case Mid(gbuMGetUPDRec.N(lR
22579  |                    Case Mid(mstrContractFlag(1), ||22534  |                    Case Mid(mstrContractFlag(1), 
22580  |                        strWord = strWord & sWord5||22535  |                        strWord = strWord & sWord5
22581  |                    Case Mid(mstrContractFlag(2), ||22536  |                    Case Mid(mstrContractFlag(2), 
22582  |                        strWord = strWord & sWord5||22537  |                        strWord = strWord & sWord5
22583  |                    Case Mid(mstrContractFlag(3), ||22538  |                    Case Mid(mstrContractFlag(3), 
22584  |                        strWord = strWord & sWord5||22539  |                        strWord = strWord & sWord5
22585  |                    Case Else                     ||22540  |                    Case Else                     
22586  |                End Select                        ||22541  |                End Select                        
22587  |                .Cells(43, 19).Value = strWord    ||22542  |                .Cells(43, 19).Value = strWord    
22588  |                                                  ||22543  |                                                  
22589  |'                '計算期間の純資産総額の合計(月末 ||22544  |'                '計算期間の純資産総額の合計(月末 
22590  |'                .Cells(43, 28).NumberFormatLocal ||22545  |'                .Cells(43, 28).NumberFormatLocal 
22591  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||22546  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
22592  |'                    .Cells(43, 28).Value = CStr(F||22547  |'                    .Cells(43, 28).Value = CStr(F
22593  |'                Else                             ||22548  |'                Else                             
22594  |'                    .Cells(43, 28).Value = CStr(F||22549  |'                    .Cells(43, 28).Value = CStr(F
22595  |'                End If                           ||22550  |'                End If                           
22596  |'                .Cells(43, 28).HorizontalAlignmen||22551  |'                .Cells(43, 28).HorizontalAlignmen
22597  |'                                                 ||22552  |'                                                 
22598  |'                '計算期間の純資産総額の合計÷計算||22553  |'                '計算期間の純資産総額の合計÷計算
22599  |'                .Cells(43, 40).NumberFormatLocal ||22554  |'                .Cells(43, 40).NumberFormatLocal 
22600  |                dblValueIn = TotalNav / iRowCnt   ||22555  |                dblValueIn = TotalNav / iRowCnt   
22601  |                Call sbGetRoundValue(dblValueIn)  ||22556  |                Call sbGetRoundValue(dblValueIn)  
22602  |                                                  ||22557  |                                                  
22603  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||22558  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
22604  |'                    .Cells(43, 40).Value = CStr(F||22559  |'                    .Cells(43, 40).Value = CStr(F
22605  |'                Else                             ||22560  |'                Else                             
22606  |'                    .Cells(43, 40).Value = CStr(F||22561  |'                    .Cells(43, 40).Value = CStr(F
22607  |'                End If                           ||22562  |'                End If                           
22608  |                AvgNav = dblValueOut              ||22563  |                AvgNav = dblValueOut              
22609  |                                                  ||22564  |                                                  
22610  |                '÷??＝                           ||22565  |                '÷??＝                           
22611  |'                .Cells(43, 31).Value = sWord18 & ||22566  |'                .Cells(43, 31).Value = sWord18 & 
22612  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||22567  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
22613  |                                                  ||22568  |                                                  
22614  |'取得NAV区分[1]以外(取得NAV区分='2')              ||22569  |'取得NAV区分[1]以外(取得NAV区分='2')              
22615  |            Else                                  ||22570  |            Else                                  
22616  |                ddblTtalnav = 0                   ||22571  |                ddblTtalnav = 0                   
22617  |                For dintFor = 0 To NavGetCnt - 1  ||22572  |                For dintFor = 0 To NavGetCnt - 1  
22618  |                                                  ||22573  |                                                  
22619  |                    '日次NAV平均取得              ||22574  |                    '日次NAV平均取得              
22620  |                    sStart = gstrDateFormat2(CStr(||22575  |                    sStart = gstrDateFormat2(CStr(
22621  |                    sEnd = gstrDateFormat2(CStr(dE||22576  |                    sEnd = gstrDateFormat2(CStr(dE
22622  |                                                  ||22577  |                                                  
22623  |                    '計算開始日と外部委託顧問料計 ||22578  |                    '計算開始日と外部委託顧問料計 
22624  |                    If sStart = gbuMGetUPDRec.N(lR||22579  |                    If sStart = gbuMGetUPDRec.N(lR
22625  |                        '== SQL1 ==               ||22580  |                        '== SQL1 ==               
22626  |                        sSql = ""                 ||22581  |                        sSql = ""                 
22627  |                        sSql = sSql & "SELECT EIGY||22582  |                        sSql = sSql & "SELECT EIGY
22628  |                                                  ||22583  |                                                  
22629  |                        'ﾀﾞｲﾅｾｯﾄの作成            ||22584  |                        'ﾀﾞｲﾅｾｯﾄの作成            
22630  |                        If gintDyCreate(sSql) = Fa||22585  |                        If gintDyCreate(sSql) = Fa
22631  |                            Exit Function         ||22586  |                            Exit Function         
22632  |                         Else                     ||22587  |                         Else                     
22633  |                            '休日の場合、翌営業日 ||22588  |                            '休日の場合、翌営業日 
22634  |                            If gvlnDyDataS("EIGYO_||22589  |                            If gvlnDyDataS("EIGYO_
22635  |                                '翌営業日のNAVを取||22590  |                                '翌営業日のNAVを取
22636  |                                '== SQL2 ==       ||22591  |                                '== SQL2 ==       
22637  |                                sSql = ""         ||22592  |                                sSql = ""         
22638  |                                sSql = sSql & "SEL||22593  |                                sSql = sSql & "SEL
22639  |                                sSql = sSql & "FRO||22594  |                                sSql = sSql & "FRO
22640  |                                sSql = sSql & "(SE||22595  |                                sSql = sSql & "(SE
22641  |                                sSql = sSql & "WHE||22596  |                                sSql = sSql & "WHE
22642  |                                                  ||22597  |                                                  
22643  |                                'ﾀﾞｲﾅｾｯﾄの作成    ||22598  |                                'ﾀﾞｲﾅｾｯﾄの作成    
22644  |                                If gintDyCreate(sS||22599  |                                If gintDyCreate(sS
22645  |                                    Exit Function ||22600  |                                    Exit Function 
22646  |                                Else              ||22601  |                                Else              
22647  |                                    ddblNearNav = ||22602  |                                    ddblNearNav = 
22648  |'2008/03/06 START 時価総額基準の外部委託顧問料対応||22603  |'2008/03/06 START 時価総額基準の外部委託顧問料対応
22649  |'                                    '翌営業日の計||22604  |'                                    '翌営業日の計
22650  |'                                    '== SQL3 ==  ||22605  |'                                    '== SQL3 ==  
22651  |'                                    sSql = ""    ||22606  |'                                    sSql = ""    
22652  |'                                    sSql = sSql &||22607  |'                                    sSql = sSql &
22653  |'                                    sSql = sSql &||22608  |'                                    sSql = sSql &
22654  |'                                    sSql = sSql &||22609  |'                                    sSql = sSql &
22655  |'                                    sSql = sSql &||22610  |'                                    sSql = sSql &
22656  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||22611  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
22657  |'                                    If gintDyCrea||22612  |'                                    If gintDyCrea
22658  |'                                        Exit Func||22613  |'                                        Exit Func
22659  |'                                     Else        ||22614  |'                                     Else        
22660  |'                                        '計算開始||22615  |'                                        '計算開始
22661  |'                                        sStart = ||22616  |'                                        sStart = 
22662  |'                                        dStart = ||22617  |'                                        dStart = 
22663  |'                                        '文言の冗||22618  |'                                        '文言の冗
22664  |''                                        .Cells(1||22619  |''                                        .Cells(1
22665  |''                                            CStr||22620  |''                                            CStr
22666  |'                                        .Cells(16||22621  |'                                        .Cells(16
22667  |'                                            CStr(||22622  |'                                            CStr(
22668  |'                                        iCalcNum ||22623  |'                                        iCalcNum 
22669  |'                                    End If       ||22624  |'                                    End If       
22670  |'2008/03/06 END   時価総額基準の外部委託顧問料対応||22625  |'2008/03/06 END   時価総額基準の外部委託顧問料対応
22671  |                                                  ||22626  |                                                  
22672  |                                    'SQL文の作成( ||22627  |                                    'SQL文の作成( 
22673  |                                    '計算期間の開 ||22628  |                                    '計算期間の開 
22674  |                                    sSql = gstrEdi||22629  |                                    sSql = gstrEdi
22675  |                                        ContNo, sS||22630  |                                        ContNo, sS
22676  |                                                  ||22631  |                                                  
22677  |                                     'ﾀﾞｲﾅｾｯﾄの作 ||22632  |                                     'ﾀﾞｲﾅｾｯﾄの作 
22678  |                                    If gintDyCreat||22633  |                                    If gintDyCreat
22679  |                                        Exit Funct||22634  |                                        Exit Funct
22680  |                                    End If        ||22635  |                                    End If        
22681  |                                    '配列初期化   ||22636  |                                    '配列初期化   
22682  |                                    ReDim gbuOther||22637  |                                    ReDim gbuOther
22683  |                                    MonthlyCnt = 0||22638  |                                    MonthlyCnt = 0
22684  |                                    'EOF判定処理  ||22639  |                                    'EOF判定処理  
22685  |                                    Do Until gblnD||22640  |                                    Do Until gblnD
22686  |                                        '対象デー ||22641  |                                        '対象デー 
22687  |                                        Call sbOth||22642  |                                        Call sbOth
22688  |                                        MonthlyCnt||22643  |                                        MonthlyCnt
22689  |                                        'ﾀﾞｲﾅｾｯﾄ次||22644  |                                        'ﾀﾞｲﾅｾｯﾄ次
22690  |                                        Call gDyNe||22645  |                                        Call gDyNe
22691  |                                    Loop          ||22646  |                                    Loop          
22692  |                                                  ||22647  |                                                  
22693  |                                    '期中料率変更 ||22648  |                                    '期中料率変更 
22694  |                                    Erase gtypOthe||22649  |                                    Erase gtypOthe
22695  |                                                  ||22650  |                                                  
22696  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||22651  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
22697  |                                    '期中料率変更 ||22652  |                                    '期中料率変更 
22698  |                                    '外部委託顧問 ||22653  |                                    '外部委託顧問 
22699  |                                    If fnSetOtherC||22654  |                                    If fnSetOtherC
22700  |                                                  ||22655  |                                                  
22701  |                                                  ||22656  |                                                  
22702  |                                                  ||22657  |                                                  
22703  |                                                  ||22658  |                                                  
22704  |                                                  ||22659  |                                                  
22705  |                                        Exit Funct||22660  |                                        Exit Funct
22706  |                                    End If        ||22661  |                                    End If        
22707  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||22662  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
22708  |                                                  ||22663  |                                                  
22709  |                                End If            ||22664  |                                End If            
22710  |                                'RAFI対応 START   ||22665  |                                'RAFI対応 START   
22711  |                                '翌営業日のマザー ||22666  |                                '翌営業日のマザー 
22712  |                                If msAssetFlg = "1||22667  |                                If msAssetFlg = "1
22713  |                                    '== SQL4 ==   ||22668  |                                    '== SQL4 ==   
22714  |                                    sSql = ""     ||22669  |                                    sSql = ""     
22715  |                                    sSql = sSql & ||22670  |                                    sSql = sSql & 
22716  |                                    sSql = sSql & ||22671  |                                    sSql = sSql & 
22717  |                                    sSql = sSql & ||22672  |                                    sSql = sSql & 
22718  |                                    sSql = sSql & ||22673  |                                    sSql = sSql & 
22719  |                                    sSql = sSql & ||22674  |                                    sSql = sSql & 
22720  |                                    sSql = sSql & ||22675  |                                    sSql = sSql & 
22721  |                                    sSql = sSql & ||22676  |                                    sSql = sSql & 
22722  |                                    sSql = sSql & ||22677  |                                    sSql = sSql & 
22723  |                                    sSql = sSql & ||22678  |                                    sSql = sSql & 
22724  |                                    sSql = sSql & ||22679  |                                    sSql = sSql & 
22725  |                                    sSql = sSql & ||22680  |                                    sSql = sSql & 
22726  |                                    sSql = sSql & ||22681  |                                    sSql = sSql & 
22727  |                                    sSql = sSql & ||22682  |                                    sSql = sSql & 
22728  |                                    sSql = sSql & ||22683  |                                    sSql = sSql & 
22729  |                                    sSql = sSql & ||22684  |                                    sSql = sSql & 
22730  |                                    sSql = sSql & ||22685  |                                    sSql = sSql & 
22731  |                                    sSql = sSql & ||22686  |                                    sSql = sSql & 
22732  |                                    sSql = sSql & ||22687  |                                    sSql = sSql & 
22733  |                                    sSql = sSql & ||22688  |                                    sSql = sSql & 
22734  |                                    sSql = sSql & ||22689  |                                    sSql = sSql & 
22735  |                                    sSql = sSql & ||22690  |                                    sSql = sSql & 
22736  |                                    sSql = sSql & ||22691  |                                    sSql = sSql & 
22737  |                                    sSql = sSql & ||22692  |                                    sSql = sSql & 
22738  |                                    sSql = sSql & ||22693  |                                    sSql = sSql & 
22739  |                                    'ﾀﾞｲﾅｾｯﾄの作成||22694  |                                    'ﾀﾞｲﾅｾｯﾄの作成
22740  |                                                  ||22695  |                                                  
22741  |                                    If gintDyCreat||22696  |                                    If gintDyCreat
22742  |                                        Exit Funct||22697  |                                        Exit Funct
22743  |                                    Else          ||22698  |                                    Else          
22744  |                                        ddblNearBa||22699  |                                        ddblNearBa
22745  |                                    End If        ||22700  |                                    End If        
22746  |                                End If            ||22701  |                                End If            
22747  |                                'RAFI対応 END     ||22702  |                                'RAFI対応 END     
22748  |                            End If                ||22703  |                            End If                
22749  |                        End If                    ||22704  |                        End If                    
22750  |                    End If                        ||22705  |                    End If                        
22751  |                    '== SQL5 ==                   ||22706  |                    '== SQL5 ==                   
22752  |                    sSql = ""                     ||22707  |                    sSql = ""                     
22753  |                    sSql = sSql & "SELECT CAL_YYYY||22708  |                    sSql = sSql & "SELECT CAL_YYYY
22754  |                    sSql = sSql & "WHERE CAL_YYYY ||22709  |                    sSql = sSql & "WHERE CAL_YYYY 
22755  |                                                  ||22710  |                                                  
22756  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||22711  |                    'ﾀﾞｲﾅｾｯﾄの作成                
22757  |                    If gintDyCreate(sSql) = False ||22712  |                    If gintDyCreate(sSql) = False 
22758  |                        Exit Function             ||22713  |                        Exit Function             
22759  |                    End If                        ||22714  |                    End If                        
22760  |                                                  ||22715  |                                                  
22761  |                    If dlngCnt = 0 Then           ||22716  |                    If dlngCnt = 0 Then           
22762  |                        ReDim dstrCaldate(gbxOraDy||22717  |                        ReDim dstrCaldate(gbxOraDy
22763  |                        ReDim ddblDailynav(gbxOraD||22718  |                        ReDim ddblDailynav(gbxOraD
22764  |                    End If                        ||22719  |                    End If                        
22765  |                                                  ||22720  |                                                  
22766  |                    'EOF判定処理                  ||22721  |                    'EOF判定処理                  
22767  |                    dlngCnt = 0                   ||22722  |                    dlngCnt = 0                   
22768  |                                                  ||22723  |                                                  
22769  |                    Do Until gblnDyEOF()          ||22724  |                    Do Until gblnDyEOF()          
22770  |                        dlngCnt = dlngCnt + 1     ||22725  |                        dlngCnt = dlngCnt + 1     
22771  |                        '抽出データセット         ||22726  |                        '抽出データセット         
22772  |                        dstrCaldate(dlngCnt) = gvl||22727  |                        dstrCaldate(dlngCnt) = gvl
22773  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||22728  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
22774  |                        Call gDyNext              ||22729  |                        Call gDyNext              
22775  |                    Loop                          ||22730  |                    Loop                          
22776  |                                                  ||22731  |                                                  
22777  |                    '2005/08/26　START            ||22732  |                    '2005/08/26　START            
22778  |                    '変数sStartに格納されている日 ||22733  |                    '変数sStartに格納されている日 
22779  |                    '変数sStartの直近の営業日の日 ||22734  |                    '変数sStartの直近の営業日の日 
22780  |                    '（変数sStartに格納されている ||22735  |                    '（変数sStartに格納されている 
22781  |                    '　直近日付が存在しない場合は ||22736  |                    '　直近日付が存在しない場合は 
22782  |                                                  ||22737  |                                                  
22783  |                    '== SQL6 ==                   ||22738  |                    '== SQL6 ==                   
22784  |                    sSql = ""                     ||22739  |                    sSql = ""                     
22785  |                    sSql = sSql & "SELECT MAX(BASE||22740  |                    sSql = sSql & "SELECT MAX(BASE
22786  |                    sSql = sSql & "FROM   CFR_DAIL||22741  |                    sSql = sSql & "FROM   CFR_DAIL
22787  |                    sSql = sSql & "WHERE  BASE_DAT||22742  |                    sSql = sSql & "WHERE  BASE_DAT
22788  |                    sSql = sSql & "AND    ACCOUNT_||22743  |                    sSql = sSql & "AND    ACCOUNT_
22789  |                                                  ||22744  |                                                  
22790  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||22745  |                    'ﾀﾞｲﾅｾｯﾄの作成                
22791  |                    If gintDyCreate(sSql) = False ||22746  |                    If gintDyCreate(sSql) = False 
22792  |                        Exit Function             ||22747  |                        Exit Function             
22793  |                    End If                        ||22748  |                    End If                        
22794  |                                                  ||22749  |                                                  
22795  |                    Do Until gblnDyEOF()          ||22750  |                    Do Until gblnDyEOF()          
22796  |                       '抽出データセット          ||22751  |                       '抽出データセット          
22797  |                        sStart = gvlnDyDataS("BASE||22752  |                        sStart = gvlnDyDataS("BASE
22798  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||22753  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
22799  |                        Call gDyNext              ||22754  |                        Call gDyNext              
22800  |                    Loop                          ||22755  |                    Loop                          
22801  |                                                  ||22756  |                                                  
22802  |                    'SQL文の作成(外部委託顧問料率 ||22757  |                    'SQL文の作成(外部委託顧問料率 
22803  |                    '計算期間の開始日と終了日に含 ||22758  |                    '計算期間の開始日と終了日に含 
22804  |                    sSql = gstrEditSQLcfr_OtherCom||22759  |                    sSql = gstrEditSQLcfr_OtherCom
22805  |                        ContNo, sStart, mstrNearSe||22760  |                        ContNo, sStart, mstrNearSe
22806  |                                                  ||22761  |                                                  
22807  |                     'ﾀﾞｲﾅｾｯﾄの作成               ||22762  |                     'ﾀﾞｲﾅｾｯﾄの作成               
22808  |                    If gintDyCreate(sSql) = False ||22763  |                    If gintDyCreate(sSql) = False 
22809  |                        Exit Function             ||22764  |                        Exit Function             
22810  |                    End If                        ||22765  |                    End If                        
22811  |                    '配列初期化                   ||22766  |                    '配列初期化                   
22812  |                    ReDim gbuOtherComRateGetUPDRec||22767  |                    ReDim gbuOtherComRateGetUPDRec
22813  |                    MonthlyCnt = 0                ||22768  |                    MonthlyCnt = 0                
22814  |                    'EOF判定処理                  ||22769  |                    'EOF判定処理                  
22815  |                    Do Until gblnDyEOF()          ||22770  |                    Do Until gblnDyEOF()          
22816  |                        '対象データ抽出           ||22771  |                        '対象データ抽出           
22817  |                        Call sbOtherComDataGet(Mon||22772  |                        Call sbOtherComDataGet(Mon
22818  |                        MonthlyCnt = MonthlyCnt + ||22773  |                        MonthlyCnt = MonthlyCnt + 
22819  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||22774  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
22820  |                        Call gDyNext              ||22775  |                        Call gDyNext              
22821  |                    Loop                          ||22776  |                    Loop                          
22822  |                                                  ||22777  |                                                  
22823  |                    '期中料率変更用配列のクリア   ||22778  |                    '期中料率変更用配列のクリア   
22824  |                    Erase gtypOtherComRec         ||22779  |                    Erase gtypOtherComRec         
22825  |                                                  ||22780  |                                                  
22826  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||22781  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
22827  |                    '期中料率変更対象契約         ||22782  |                    '期中料率変更対象契約         
22828  |                    '外部委託顧問料率を定義体配列 ||22783  |                    '外部委託顧問料率を定義体配列 
22829  |                    If fnSetOtherComRate(gbuMGetUP||22784  |                    If fnSetOtherComRate(gbuMGetUP
22830  |                                         msAssetFl||22785  |                                         msAssetFl
22831  |                                         gbuMGetUP||22786  |                                         gbuMGetUP
22832  |                                         conDBasse||22787  |                                         conDBasse
22833  |                                         sStart, _||22788  |                                         sStart, _
22834  |                                         StartFlg)||22789  |                                         StartFlg)
22835  |                        Exit Function             ||22790  |                        Exit Function             
22836  |                    End If                        ||22791  |                    End If                        
22837  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||22792  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
22838  |                                                  ||22793  |                                                  
22839  |                    'RAFI対応 START               ||22794  |                    'RAFI対応 START               
22840  |                    '純資産の場合                 ||22795  |                    '純資産の場合                 
22841  |                    If msAssetFlg = "0" Then      ||22796  |                    If msAssetFlg = "0" Then      
22842  |                        '計算開始日から計算終了日 ||22797  |                        '計算開始日から計算終了日 
22843  |                        '== SQL7 ==               ||22798  |                        '== SQL7 ==               
22844  |                        sSql = ""                 ||22799  |                        sSql = ""                 
22845  |                        sSql = sSql & "SELECT ACCO||22800  |                        sSql = sSql & "SELECT ACCO
22846  |                        sSql = sSql & "WHERE (((CF||22801  |                        sSql = sSql & "WHERE (((CF
22847  |                        sSql = sSql & "AND ((CFR_D||22802  |                        sSql = sSql & "AND ((CFR_D
22848  |                        sSql = sSql & "AND ((CFR_D||22803  |                        sSql = sSql & "AND ((CFR_D
22849  |                        sSql = sSql & "ORDER BY CF||22804  |                        sSql = sSql & "ORDER BY CF
22850  |                    'マザー組入資産の場合         ||22805  |                    'マザー組入資産の場合         
22851  |                    Else                          ||22806  |                    Else                          
22852  |                        '計算開始日から計算終了日 ||22807  |                        '計算開始日から計算終了日 
22853  |                        '== SQL8 ==               ||22808  |                        '== SQL8 ==               
22854  |                        sSql = ""                 ||22809  |                        sSql = ""                 
22855  |                        sSql = sSql & "SELECT"    ||22810  |                        sSql = sSql & "SELECT"    
22856  |                        sSql = sSql & "    a.ACCOU||22811  |                        sSql = sSql & "    a.ACCOU
22857  |                        sSql = sSql & "    a.BASE_||22812  |                        sSql = sSql & "    a.BASE_
22858  |                        sSql = sSql & "    a.NET_A||22813  |                        sSql = sSql & "    a.NET_A
22859  |                        sSql = sSql & "    b.BABY_||22814  |                        sSql = sSql & "    b.BABY_
22860  |                        sSql = sSql & "    b.BABY_||22815  |                        sSql = sSql & "    b.BABY_
22861  |                        sSql = sSql & " FROM"     ||22816  |                        sSql = sSql & " FROM"     
22862  |                        sSql = sSql & "    CFR_DAI||22817  |                        sSql = sSql & "    CFR_DAI
22863  |                        sSql = sSql & " WHERE"    ||22818  |                        sSql = sSql & " WHERE"    
22864  |                        sSql = sSql & "    b.BABY_||22819  |                        sSql = sSql & "    b.BABY_
22865  |                        sSql = sSql & "    b.MOTHE||22820  |                        sSql = sSql & "    b.MOTHE
22866  |                        sSql = sSql & "    b.BASE_||22821  |                        sSql = sSql & "    b.BASE_
22867  |                        sSql = sSql & "    a.ACCOU||22822  |                        sSql = sSql & "    a.ACCOU
22868  |                        sSql = sSql & "    (a.BASE||22823  |                        sSql = sSql & "    (a.BASE
22869  |                        sSql = sSql & "    a.BASE_||22824  |                        sSql = sSql & "    a.BASE_
22870  |                        sSql = sSql & "    a.CURRE||22825  |                        sSql = sSql & "    a.CURRE
22871  |                        sSql = sSql & "    a.ASSET||22826  |                        sSql = sSql & "    a.ASSET
22872  |                        sSql = sSql & " ORDER BY" ||22827  |                        sSql = sSql & " ORDER BY" 
22873  |                        sSql = sSql & "    a.BASE_||22828  |                        sSql = sSql & "    a.BASE_
22874  |                    End If                        ||22829  |                    End If                        
22875  |                    'RAFI対応 END                 ||22830  |                    'RAFI対応 END                 
22876  |                                                  ||22831  |                                                  
22877  |                    If gintDyCreate(sSql) = False ||22832  |                    If gintDyCreate(sSql) = False 
22878  |                        Exit Function             ||22833  |                        Exit Function             
22879  |                    End If                        ||22834  |                    End If                        
22880  |                                                  ||22835  |                                                  
22881  |                    dlngCntsv = dlngCnt           ||22836  |                    dlngCntsv = dlngCnt           
22882  |                    dlngCnt = 0                   ||22837  |                    dlngCnt = 0                   
22883  |                                                  ||22838  |                                                  
22884  |                    Do Until gblnDyEOF()          ||22839  |                    Do Until gblnDyEOF()          
22885  |                        dlngCnt = dlngCnt + 1     ||22840  |                        dlngCnt = dlngCnt + 1     
22886  |                        '抽出データセット         ||22841  |                        '抽出データセット         
22887  |                        dstrBasedate = gvlnDyDataS||22842  |                        dstrBasedate = gvlnDyDataS
22888  |                        If Mid(dstrCaldate(dlngCnt||22843  |                        If Mid(dstrCaldate(dlngCnt
22889  |                            'RAFI対応 START       ||22844  |                            'RAFI対応 START       
22890  |                            '純資産の場合         ||22845  |                            '純資産の場合         
22891  |                            If msAssetFlg = "0" Th||22846  |                            If msAssetFlg = "0" Th
22892  |                                ddblDailynav(dlngC||22847  |                                ddblDailynav(dlngC
22893  |                            'マザー組入資産の場合 ||22848  |                            'マザー組入資産の場合 
22894  |                            Else                  ||22849  |                            Else                  
22895  |                                ddblDailynav(dlngC||22850  |                                ddblDailynav(dlngC
22896  |                            End If                ||22851  |                            End If                
22897  |                            'RAFI対応 END         ||22852  |                            'RAFI対応 END         
22898  |                        Else                      ||22853  |                        Else                      
22899  |                            '計算開始日が外部委託 ||22854  |                            '計算開始日が外部委託 
22900  |                            If ddblNearNav <> 0 _ ||22855  |                            If ddblNearNav <> 0 _ 
22901  |                            And dlngCnt = 1 Then  ||22856  |                            And dlngCnt = 1 Then  
22902  |                                dstrCaldate2 = Mid||22857  |                                dstrCaldate2 = Mid
22903  |                                dstrBasedate2 = Mi||22858  |                                dstrBasedate2 = Mi
22904  |                                dlngDiffdate = Dat||22859  |                                dlngDiffdate = Dat
22905  |                                                  ||22860  |                                                  
22906  |                                For dintFor2 = 1 T||22861  |                                For dintFor2 = 1 T
22907  |                                    'RAFI対応 STAR||22862  |                                    'RAFI対応 STAR
22908  |                                    '純資産の場合 ||22863  |                                    '純資産の場合 
22909  |                                    If msAssetFlg ||22864  |                                    If msAssetFlg 
22910  |                                        ddblDailyn||22865  |                                        ddblDailyn
22911  |                                    'マザー組入資 ||22866  |                                    'マザー組入資 
22912  |                                    Else          ||22867  |                                    Else          
22913  |                                        ddblDailyn||22868  |                                        ddblDailyn
22914  |                                    End If        ||22869  |                                    End If        
22915  |                                    'RAFI対応 END ||22870  |                                    'RAFI対応 END 
22916  |                                    dlngCnt = dlng||22871  |                                    dlngCnt = dlng
22917  |                                Next dintFor2     ||22872  |                                Next dintFor2     
22918  |                                '純資産の場合     ||22873  |                                '純資産の場合     
22919  |                                If msAssetFlg = "0||22874  |                                If msAssetFlg = "0
22920  |                                    ddblDailynav(d||22875  |                                    ddblDailynav(d
22921  |                                'マザー組入資産の ||22876  |                                'マザー組入資産の 
22922  |                                Else              ||22877  |                                Else              
22923  |                                    ddblDailynav(d||22878  |                                    ddblDailynav(d
22924  |                                End If            ||22879  |                                End If            
22925  |                                'RAFI対応 END     ||22880  |                                'RAFI対応 END     
22926  |                            Else                  ||22881  |                            Else                  
22927  |                                '日次NAVにデータが||22882  |                                '日次NAVにデータが
22928  |                                dstrCaldate2 = Mid||22883  |                                dstrCaldate2 = Mid
22929  |                                dstrBasedate2 = Mi||22884  |                                dstrBasedate2 = Mi
22930  |                                dlngDiffdate = Dat||22885  |                                dlngDiffdate = Dat
22931  |                                                  ||22886  |                                                  
22932  |                                For dintFor2 = 1 T||22887  |                                For dintFor2 = 1 T
22933  |                                    If ddblDailyna||22888  |                                    If ddblDailyna
22934  |                                        ddblDailyn||22889  |                                        ddblDailyn
22935  |                                    Else          ||22890  |                                    Else          
22936  |                                        '日次NAVに||22891  |                                        '日次NAVに
22937  |                                        intRtn = M||22892  |                                        intRtn = M
22938  |                                        vbLf & "対||22893  |                                        vbLf & "対
22939  |                                        vbLf & "基||22894  |                                        vbLf & "基
22940  |                                            vbCrit||22895  |                                            vbCrit
22941  |                                        Exit Funct||22896  |                                        Exit Funct
22942  |                                    End If        ||22897  |                                    End If        
22943  |                                    dlngCnt = dlng||22898  |                                    dlngCnt = dlng
22944  |                                Next dintFor2     ||22899  |                                Next dintFor2     
22945  |                                'RAFI対応 START   ||22900  |                                'RAFI対応 START   
22946  |                                '純資産の場合     ||22901  |                                '純資産の場合     
22947  |                                If msAssetFlg = "0||22902  |                                If msAssetFlg = "0
22948  |                                    ddblDailynav(d||22903  |                                    ddblDailynav(d
22949  |                                'マザー組入資産の ||22904  |                                'マザー組入資産の 
22950  |                                Else              ||22905  |                                Else              
22951  |                                    ddblDailynav(d||22906  |                                    ddblDailynav(d
22952  |                                End If            ||22907  |                                End If            
22953  |                                'RAFI対応 END     ||22908  |                                'RAFI対応 END     
22954  |                            End If                ||22909  |                            End If                
22955  |                                                  ||22910  |                                                  
22956  |                        End If                    ||22911  |                        End If                    
22957  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||22912  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
22958  |                        Call gDyNext              ||22913  |                        Call gDyNext              
22959  |                    Loop                          ||22914  |                    Loop                          
22960  |                                                  ||22915  |                                                  
22961  |                Next dintFor                      ||22916  |                Next dintFor                      
22962  |                                                  ||22917  |                                                  
22963  |                If dlngCntsv <> dlngCnt Then      ||22918  |                If dlngCntsv <> dlngCnt Then      
22964  |                    For dintFor2 = dlngCnt + 1 To ||22919  |                    For dintFor2 = dlngCnt + 1 To 
22965  |                        ddblDailynav(dintFor2) = d||22920  |                        ddblDailynav(dintFor2) = d
22966  |                    Next dintFor2                 ||22921  |                    Next dintFor2                 
22967  |                    dlngCnt = dlngCntsv           ||22922  |                    dlngCnt = dlngCntsv           
22968  |                End If                            ||22923  |                End If                            
22969  |                                                  ||22924  |                                                  
22970  |                ddblTtalnav = 0                   ||22925  |                ddblTtalnav = 0                   
22971  |                                                  ||22926  |                                                  
22972  |                For dintFor2 = 1 To dlngCnt       ||22927  |                For dintFor2 = 1 To dlngCnt       
22973  |                    ddblTtalnav = ddblTtalnav + dd||22928  |                    ddblTtalnav = ddblTtalnav + dd
22974  |                Next dintFor2                     ||22929  |                Next dintFor2                     
22975  |                                                  ||22930  |                                                  
22976  |                'カレンダーを元に日次NAVを配列より||22931  |                'カレンダーを元に日次NAVを配列より
22977  |                K = 0                             ||22932  |                K = 0                             
22978  |                For i = 1 To dlngCnt              ||22933  |                For i = 1 To dlngCnt              
22979  |                    '計算開始日の日次NAVは無条件に||22934  |                    '計算開始日の日次NAVは無条件に
22980  |                    If i = 1 Then                 ||22935  |                    If i = 1 Then                 
22981  |                        gtypOtherComRec(K).APPLY_T||22936  |                        gtypOtherComRec(K).APPLY_T
22982  |                    Else                          ||22937  |                    Else                          
22983  |                        '適用終了日に成るまで累積 ||22938  |                        '適用終了日に成るまで累積 
22984  |                        If Mid(dstrCaldate(i), 1, ||22939  |                        If Mid(dstrCaldate(i), 1, 
22985  |                            gtypOtherComRec(K).APP||22940  |                            gtypOtherComRec(K).APP
22986  |                        'カレンダー日付が適用終了 ||22941  |                        'カレンダー日付が適用終了 
22987  |                        Else                      ||22942  |                        Else                      
22988  |                            '料率変更毎に平均NAVを||22943  |                            '料率変更毎に平均NAVを
22989  |                            gtypOtherComRec(K).APP||22944  |                            gtypOtherComRec(K).APP
22990  |                            '次の料率へシフトする ||22945  |                            '次の料率へシフトする 
22991  |                            K = K + 1             ||22946  |                            K = K + 1             
22992  |                            gtypOtherComRec(K).APP||22947  |                            gtypOtherComRec(K).APP
22993  |                        End If                    ||22948  |                        End If                    
22994  |                    End If                        ||22949  |                    End If                        
22995  |                    '最後のレコードの場合NAV平均を||22950  |                    '最後のレコードの場合NAV平均を
22996  |                    If i = dlngCnt Then           ||22951  |                    If i = dlngCnt Then           
22997  |                        '料率変更毎に平均NAVを算出||22952  |                        '料率変更毎に平均NAVを算出
22998  |                        gtypOtherComRec(K).APPLY_N||22953  |                        gtypOtherComRec(K).APPLY_N
22999  |                    End If                        ||22954  |                    End If                        
23000  |                Next i                            ||22955  |                Next i                            
23001  |                                                  ||22956  |                                                  
23002  |                iRowCnt = dlngCnt                 ||22957  |                iRowCnt = dlngCnt                 
23003  |                TotalNav = ddblTtalnav            ||22958  |                TotalNav = ddblTtalnav            
23004  |                dblValueIn = TotalNav             ||22959  |                dblValueIn = TotalNav             
23005  |                Call sbGetRoundValue2(dblValueIn) ||22960  |                Call sbGetRoundValue2(dblValueIn) 
23006  |                TotalNav = dblValueOut            ||22961  |                TotalNav = dblValueOut            
23007  |                                                  ||22962  |                                                  
23008  |                '平均純資産総額                   ||22963  |                '平均純資産総額                   
23009  |                .Cells(43, 2).Value = sWord51a    ||22964  |                .Cells(43, 2).Value = sWord51a    
23010  |                .Cells(43, 16).Value = sWord19    ||22965  |                .Cells(43, 16).Value = sWord19    
23011  |                '平均純資産総額は別紙に記載       ||22966  |                '平均純資産総額は別紙に記載       
23012  |                strWord = ""                      ||22967  |                strWord = ""                      
23013  |                strWord = strWord & sWord53a & """||22968  |                strWord = strWord & sWord53a & """
23014  |                Select Case Mid(gbuMGetUPDRec.N(lR||22969  |                Select Case Mid(gbuMGetUPDRec.N(lR
23015  |                    Case Mid(mstrContractFlag(1), ||22970  |                    Case Mid(mstrContractFlag(1), 
23016  |                        strWord = strWord & sWord5||22971  |                        strWord = strWord & sWord5
23017  |                    Case Mid(mstrContractFlag(2), ||22972  |                    Case Mid(mstrContractFlag(2), 
23018  |                        strWord = strWord & sWord5||22973  |                        strWord = strWord & sWord5
23019  |                    Case Mid(mstrContractFlag(3), ||22974  |                    Case Mid(mstrContractFlag(3), 
23020  |                        strWord = strWord & sWord5||22975  |                        strWord = strWord & sWord5
23021  |                    Case Else                     ||22976  |                    Case Else                     
23022  |                End Select                        ||22977  |                End Select                        
23023  |                .Cells(43, 19).Value = strWord    ||22978  |                .Cells(43, 19).Value = strWord    
23024  |                                                  ||22979  |                                                  
23025  |'                '計算期間の純資産総額の合計(月末 ||22980  |'                '計算期間の純資産総額の合計(月末 
23026  |'                .Cells(43, 28).NumberFormatLocal ||22981  |'                .Cells(43, 28).NumberFormatLocal 
23027  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||22982  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
23028  |'                    .Cells(43, 28).Value = CStr(F||22983  |'                    .Cells(43, 28).Value = CStr(F
23029  |'                Else                             ||22984  |'                Else                             
23030  |'                    .Cells(43, 28).Value = CStr(F||22985  |'                    .Cells(43, 28).Value = CStr(F
23031  |'                End If                           ||22986  |'                End If                           
23032  |'                .Cells(43, 28).HorizontalAlignmen||22987  |'                .Cells(43, 28).HorizontalAlignmen
23033  |'                                                 ||22988  |'                                                 
23034  |'                '計算期間の純資産総額の合計÷計算||22989  |'                '計算期間の純資産総額の合計÷計算
23035  |'                .Cells(43, 40).NumberFormatLocal ||22990  |'                .Cells(43, 40).NumberFormatLocal 
23036  |                dblValueIn = TotalNav / iRowCnt   ||22991  |                dblValueIn = TotalNav / iRowCnt   
23037  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||22992  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
23038  |                    Call sbGetRoundValue2(dblValue||22993  |                    Call sbGetRoundValue2(dblValue
23039  |                Else                              ||22994  |                Else                              
23040  |                    Call sbGetRoundValue(dblValueI||22995  |                    Call sbGetRoundValue(dblValueI
23041  |                End If                            ||22996  |                End If                            
23042  |                                                  ||22997  |                                                  
23043  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||22998  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
23044  |'                    .Cells(43, 40).Value = CStr(F||22999  |'                    .Cells(43, 40).Value = CStr(F
23045  |'                Else                             ||23000  |'                Else                             
23046  |'                    .Cells(43, 40).Value = CStr(F||23001  |'                    .Cells(43, 40).Value = CStr(F
23047  |'                End If                           ||23002  |'                End If                           
23048  |                AvgNav = dblValueOut              ||23003  |                AvgNav = dblValueOut              
23049  |                                                  ||23004  |                                                  
23050  |                '÷??＝                           ||23005  |                '÷??＝                           
23051  |'                .Cells(43, 31).Value = sWord18 & ||23006  |'                .Cells(43, 31).Value = sWord18 & 
23052  |            End If                                ||23007  |            End If                                
23053  |'契約区分：名称使用許諾料計算　かつ　日次NAV(休日 ||23008  |'契約区分：名称使用許諾料計算　かつ　日次NAV(休日 
23054  |        Else                                      ||23009  |        Else                                      
23055  |On Error GoTo OnErrorProc                         ||23010  |On Error GoTo OnErrorProc                         
23056  |                                                  ||23011  |                                                  
23057  |            '契約区分「3」の場合                  ||23012  |            '契約区分「3」の場合                  
23058  |            ddblTtalnav = 0                       ||23013  |            ddblTtalnav = 0                       
23059  |            For dintFor = 0 To NavGetCnt - 1      ||23014  |            For dintFor = 0 To NavGetCnt - 1      
23060  |                                                  ||23015  |                                                  
23061  |                '日次NAV平均取得                  ||23016  |                '日次NAV平均取得                  
23062  |                sStart = gstrDateFormat2(CStr(dSta||23017  |                sStart = gstrDateFormat2(CStr(dSta
23063  |                sEnd = gstrDateFormat2(CStr(dEnd),||23018  |                sEnd = gstrDateFormat2(CStr(dEnd),
23064  |                                                  ||23019  |                                                  
23065  |                'RAFI対応 START                   ||23020  |                'RAFI対応 START                   
23066  |                '純資産の場合                     ||23021  |                '純資産の場合                     
23067  |                If msAssetFlg = "0" Then          ||23022  |                If msAssetFlg = "0" Then          
23068  |                    '計算開始日から計算終了日まで ||23023  |                    '計算開始日から計算終了日まで 
23069  |                    sSql = ""                     ||23024  |                    sSql = ""                     
23070  |                    sSql = sSql & "SELECT ACCOUNT_||23025  |                    sSql = sSql & "SELECT ACCOUNT_
23071  |                    sSql = sSql & "WHERE (((CFR_DA||23026  |                    sSql = sSql & "WHERE (((CFR_DA
23072  |                    sSql = sSql & "AND ((CFR_DAILY||23027  |                    sSql = sSql & "AND ((CFR_DAILY
23073  |                    sSql = sSql & "AND ((CFR_DAILY||23028  |                    sSql = sSql & "AND ((CFR_DAILY
23074  |                    sSql = sSql & "ORDER BY CFR_DA||23029  |                    sSql = sSql & "ORDER BY CFR_DA
23075  |                'マザー組入資産の場合             ||23030  |                'マザー組入資産の場合             
23076  |                Else                              ||23031  |                Else                              
23077  |                    '計算開始日から計算終了日まで ||23032  |                    '計算開始日から計算終了日まで 
23078  |                    sSql = ""                     ||23033  |                    sSql = ""                     
23079  |                    sSql = sSql & "SELECT"        ||23034  |                    sSql = sSql & "SELECT"        
23080  |                    sSql = sSql & "    a.ACCOUNT_C||23035  |                    sSql = sSql & "    a.ACCOUNT_C
23081  |                    sSql = sSql & "    a.BASE_DATE||23036  |                    sSql = sSql & "    a.BASE_DATE
23082  |                    sSql = sSql & "    a.NET_ASSET||23037  |                    sSql = sSql & "    a.NET_ASSET
23083  |                    sSql = sSql & "    b.BABY_MOTH||23038  |                    sSql = sSql & "    b.BABY_MOTH
23084  |                    sSql = sSql & "    b.BABY_MOTH||23039  |                    sSql = sSql & "    b.BABY_MOTH
23085  |                    sSql = sSql & " FROM"         ||23040  |                    sSql = sSql & " FROM"         
23086  |                    sSql = sSql & "    CFR_DAILY_N||23041  |                    sSql = sSql & "    CFR_DAILY_N
23087  |                    sSql = sSql & " WHERE"        ||23042  |                    sSql = sSql & " WHERE"        
23088  |                    sSql = sSql & "    b.BABY_ACCO||23043  |                    sSql = sSql & "    b.BABY_ACCO
23089  |                    sSql = sSql & "    b.MOTHER_AC||23044  |                    sSql = sSql & "    b.MOTHER_AC
23090  |                    sSql = sSql & "    b.BASE_DATE||23045  |                    sSql = sSql & "    b.BASE_DATE
23091  |                    sSql = sSql & "    a.ACCOUNT_C||23046  |                    sSql = sSql & "    a.ACCOUNT_C
23092  |                    sSql = sSql & "    (a.BASE_DAT||23047  |                    sSql = sSql & "    (a.BASE_DAT
23093  |                    sSql = sSql & "    a.BASE_DATE||23048  |                    sSql = sSql & "    a.BASE_DATE
23094  |                    sSql = sSql & "    a.CURRENCY_||23049  |                    sSql = sSql & "    a.CURRENCY_
23095  |                    sSql = sSql & "    a.ASSET_TYP||23050  |                    sSql = sSql & "    a.ASSET_TYP
23096  |                    sSql = sSql & " ORDER BY"     ||23051  |                    sSql = sSql & " ORDER BY"     
23097  |                    sSql = sSql & "    a.BASE_DATE||23052  |                    sSql = sSql & "    a.BASE_DATE
23098  |                End If                            ||23053  |                End If                            
23099  |                'RAFI対応 END                     ||23054  |                'RAFI対応 END                     
23100  |                                                  ||23055  |                                                  
23101  |                If gintDyCreate(sSql) = False Then||23056  |                If gintDyCreate(sSql) = False Then
23102  |                    Exit Function                 ||23057  |                    Exit Function                 
23103  |                End If                            ||23058  |                End If                            
23104  |                                                  ||23059  |                                                  
23105  |                If dlngCnt = 0 Then               ||23060  |                If dlngCnt = 0 Then               
23106  |                    ReDim dstrCaldate(gbxOraDynase||23061  |                    ReDim dstrCaldate(gbxOraDynase
23107  |                    ReDim ddblDailynav(gbxOraDynas||23062  |                    ReDim ddblDailynav(gbxOraDynas
23108  |                End If                            ||23063  |                End If                            
23109  |                                                  ||23064  |                                                  
23110  |                dlngCnt = 0                       ||23065  |                dlngCnt = 0                       
23111  |                                                  ||23066  |                                                  
23112  |                Do Until gblnDyEOF()              ||23067  |                Do Until gblnDyEOF()              
23113  |                    dlngCnt = dlngCnt + 1         ||23068  |                    dlngCnt = dlngCnt + 1         
23114  |                    'RAFI対応 START               ||23069  |                    'RAFI対応 START               
23115  |                    '純資産の場合                 ||23070  |                    '純資産の場合                 
23116  |                    If msAssetFlg = "0" Then      ||23071  |                    If msAssetFlg = "0" Then      
23117  |                        '抽出データセット         ||23072  |                        '抽出データセット         
23118  |                        dstrCaldate(dlngCnt) = gvl||23073  |                        dstrCaldate(dlngCnt) = gvl
23119  |                        ddblDailynav(dlngCnt) = dd||23074  |                        ddblDailynav(dlngCnt) = dd
23120  |                    'マザー組入資産の場合         ||23075  |                    'マザー組入資産の場合         
23121  |                    Else                          ||23076  |                    Else                          
23122  |                        dstrCaldate(dlngCnt) = gvl||23077  |                        dstrCaldate(dlngCnt) = gvl
23123  |                        ddblDailynav(dlngCnt) = dd||23078  |                        ddblDailynav(dlngCnt) = dd
23124  |                    End If                        ||23079  |                    End If                        
23125  |                    'RAFI対応 END                 ||23080  |                    'RAFI対応 END                 
23126  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             ||23081  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             
23127  |                    Call gDyNext                  ||23082  |                    Call gDyNext                  
23128  |                Loop                              ||23083  |                Loop                              
23129  |                                                  ||23084  |                                                  
23130  |            Next dintFor                          ||23085  |            Next dintFor                          
23131  |                                                  ||23086  |                                                  
23132  |            ddblTtalnav = 0                       ||23087  |            ddblTtalnav = 0                       
23133  |                                                  ||23088  |                                                  
23134  |            For dintFor2 = 1 To dlngCnt           ||23089  |            For dintFor2 = 1 To dlngCnt           
23135  |                ddblTtalnav = ddblTtalnav + ddblDa||23090  |                ddblTtalnav = ddblTtalnav + ddblDa
23136  |            Next dintFor2                         ||23091  |            Next dintFor2                         
23137  |                                                  ||23092  |                                                  
23138  |            'SQL文の作成(外部委託顧問料率取得)    ||23093  |            'SQL文の作成(外部委託顧問料率取得)    
23139  |            '計算期間の開始日と終了日に含まれる適 ||23094  |            '計算期間の開始日と終了日に含まれる適 
23140  |            sSql = gstrEditSQLcfr_OtherComRateForS||23095  |            sSql = gstrEditSQLcfr_OtherComRateForS
23141  |                ContNo, sStart, sEnd)             ||23096  |                ContNo, sStart, sEnd)             
23142  |                                                  ||23097  |                                                  
23143  |             'ﾀﾞｲﾅｾｯﾄの作成                       ||23098  |             'ﾀﾞｲﾅｾｯﾄの作成                       
23144  |            If gintDyCreate(sSql) = False Then    ||23099  |            If gintDyCreate(sSql) = False Then    
23145  |                Exit Function                     ||23100  |                Exit Function                     
23146  |            End If                                ||23101  |            End If                                
23147  |            '配列初期化                           ||23102  |            '配列初期化                           
23148  |            ReDim gbuOtherComRateGetUPDRec.N(0)   ||23103  |            ReDim gbuOtherComRateGetUPDRec.N(0)   
23149  |            MonthlyCnt = 0                        ||23104  |            MonthlyCnt = 0                        
23150  |            'EOF判定処理                          ||23105  |            'EOF判定処理                          
23151  |            Do Until gblnDyEOF()                  ||23106  |            Do Until gblnDyEOF()                  
23152  |                '対象データ抽出                   ||23107  |                '対象データ抽出                   
23153  |                Call sbOtherComDataGet(MonthlyCnt)||23108  |                Call sbOtherComDataGet(MonthlyCnt)
23154  |                MonthlyCnt = MonthlyCnt + 1       ||23109  |                MonthlyCnt = MonthlyCnt + 1       
23155  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 ||23110  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 
23156  |                Call gDyNext                      ||23111  |                Call gDyNext                      
23157  |            Loop                                  ||23112  |            Loop                                  
23158  |                                                  ||23113  |                                                  
23159  |            '期中料率変更用配列のクリア           ||23114  |            '期中料率変更用配列のクリア           
23160  |            Erase gtypOtherComRec                 ||23115  |            Erase gtypOtherComRec                 
23161  |                                                  ||23116  |                                                  
23162  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||23117  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
23163  |            '期中料率変更対象契約                 ||23118  |            '期中料率変更対象契約                 
23164  |            '外部委託顧問料率を定義体配列にセット ||23119  |            '外部委託顧問料率を定義体配列にセット 
23165  |            If fnSetOtherComRate(gbuMGetUPDRec.N(l||23120  |            If fnSetOtherComRate(gbuMGetUPDRec.N(l
23166  |                                 msAssetFlg, msBab||23121  |                                 msAssetFlg, msBab
23167  |                                 gbuMGetUPDRec.N(l||23122  |                                 gbuMGetUPDRec.N(l
23168  |                                 conDBasset_type_c||23123  |                                 conDBasset_type_c
23169  |                                 " ", _           ||23124  |                                 " ", _           
23170  |                                 "0") = False Then||23125  |                                 "0") = False Then
23171  |                Exit Function                     ||23126  |                Exit Function                     
23172  |            End If                                ||23127  |            End If                                
23173  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||23128  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
23174  |                                                  ||23129  |                                                  
23175  |            'カレンダーを元に日次NAVを配列より取得||23130  |            'カレンダーを元に日次NAVを配列より取得
23176  |            K = 0                                 ||23131  |            K = 0                                 
23177  |            For i = 1 To dlngCnt                  ||23132  |            For i = 1 To dlngCnt                  
23178  |                '計算開始日の日次NAVは無条件に累積||23133  |                '計算開始日の日次NAVは無条件に累積
23179  |                If i = 1 Then                     ||23134  |                If i = 1 Then                     
23180  |                    gtypOtherComRec(K).APPLY_TOTAL||23135  |                    gtypOtherComRec(K).APPLY_TOTAL
23181  |                Else                              ||23136  |                Else                              
23182  |                    '適用終了日に成るまで累積する ||23137  |                    '適用終了日に成るまで累積する 
23183  |                    If Mid(dstrCaldate(i), 1, 8) <||23138  |                    If Mid(dstrCaldate(i), 1, 8) <
23184  |                        gtypOtherComRec(K).APPLY_T||23139  |                        gtypOtherComRec(K).APPLY_T
23185  |                    'カレンダー日付が適用終了日を ||23140  |                    'カレンダー日付が適用終了日を 
23186  |                    Else                          ||23141  |                    Else                          
23187  |                        '料率変更毎に平均NAVを算出||23142  |                        '料率変更毎に平均NAVを算出
23188  |                        gtypOtherComRec(K).APPLY_N||23143  |                        gtypOtherComRec(K).APPLY_N
23189  |                        '次の料率へシフトする     ||23144  |                        '次の料率へシフトする     
23190  |                        K = K + 1                 ||23145  |                        K = K + 1                 
23191  |                        gtypOtherComRec(K).APPLY_T||23146  |                        gtypOtherComRec(K).APPLY_T
23192  |                    End If                        ||23147  |                    End If                        
23193  |                End If                            ||23148  |                End If                            
23194  |                '最後のレコードの場合NAV平均を求め||23149  |                '最後のレコードの場合NAV平均を求め
23195  |                If i = dlngCnt Then               ||23150  |                If i = dlngCnt Then               
23196  |                    '料率変更毎に平均NAVを算出し格||23151  |                    '料率変更毎に平均NAVを算出し格
23197  |                    gtypOtherComRec(K).APPLY_NAV_A||23152  |                    gtypOtherComRec(K).APPLY_NAV_A
23198  |                End If                            ||23153  |                End If                            
23199  |            Next i                                ||23154  |            Next i                                
23200  |                                                  ||23155  |                                                  
23201  |            iRowCnt = dlngCnt                     ||23156  |            iRowCnt = dlngCnt                     
23202  |            dlngMeisyoSu = dlngCnt                ||23157  |            dlngMeisyoSu = dlngCnt                
23203  |                                                  ||23158  |                                                  
23204  |            TotalNav = ddblTtalnav                ||23159  |            TotalNav = ddblTtalnav                
23205  |            dblValueIn = TotalNav                 ||23160  |            dblValueIn = TotalNav                 
23206  |            Call sbGetRoundValue2(dblValueIn)     ||23161  |            Call sbGetRoundValue2(dblValueIn)     
23207  |            TotalNav = dblValueOut                ||23162  |            TotalNav = dblValueOut                
23208  |                                                  ||23163  |                                                  
23209  |            '計算期間の純資産総額の合計÷計算期間 ||23164  |            '計算期間の純資産総額の合計÷計算期間 
23210  |            dblValueIn = TotalNav / iRowCnt       ||23165  |            dblValueIn = TotalNav / iRowCnt       
23211  |            iCalcNum = iRowCnt                    ||23166  |            iCalcNum = iRowCnt                    
23212  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||23167  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
23213  |                  Call sbGetRoundValue2(dblValueIn||23168  |                  Call sbGetRoundValue2(dblValueIn
23214  |            Else                                  ||23169  |            Else                                  
23215  |                  Call sbGetRoundValue(dblValueIn)||23170  |                  Call sbGetRoundValue(dblValueIn)
23216  |            End If                                ||23171  |            End If                                
23217  |            dstrAvgNav = dblValueOut              ||23172  |            dstrAvgNav = dblValueOut              
23218  |            AvgNav = dstrAvgNav                   ||23173  |            AvgNav = dstrAvgNav                   
23219  |                                                  ||23174  |                                                  
23220  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||23175  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
23221  |            Call gblnDyClose                      ||23176  |            Call gblnDyClose                      
23222  |                                                  ||23177  |                                                  
23223  |            '平均純資産総額                       ||23178  |            '平均純資産総額                       
23224  |            .Cells(43, 2).Value = sWord51a        ||23179  |            .Cells(43, 2).Value = sWord51a        
23225  |            .Cells(43, 16).Value = sWord19        ||23180  |            .Cells(43, 16).Value = sWord19        
23226  |                                                  ||23181  |                                                  
23227  |            '平均純資産総額は別紙に記載           ||23182  |            '平均純資産総額は別紙に記載           
23228  |            strWord = ""                          ||23183  |            strWord = ""                          
23229  |            strWord = strWord & sWord53a & """"   ||23184  |            strWord = strWord & sWord53a & """"   
23230  |            Select Case Mid(gbuMGetUPDRec.N(lRecId||23185  |            Select Case Mid(gbuMGetUPDRec.N(lRecId
23231  |                Case Mid(mstrContractFlag(1), 1, 1||23186  |                Case Mid(mstrContractFlag(1), 1, 1
23232  |                    strWord = strWord & sWord54a &||23187  |                    strWord = strWord & sWord54a &
23233  |                Case Mid(mstrContractFlag(2), 1, 1||23188  |                Case Mid(mstrContractFlag(2), 1, 1
23234  |                    strWord = strWord & sWord55a &||23189  |                    strWord = strWord & sWord55a &
23235  |                Case Mid(mstrContractFlag(3), 1, 1||23190  |                Case Mid(mstrContractFlag(3), 1, 1
23236  |                    strWord = strWord & sWord56a &||23191  |                    strWord = strWord & sWord56a &
23237  |                Case Else                         ||23192  |                Case Else                         
23238  |            End Select                            ||23193  |            End Select                            
23239  |            .Cells(43, 19).Value = strWord        ||23194  |            .Cells(43, 19).Value = strWord        
23240  |                                                  ||23195  |                                                  
23241  |'            '計算期間の純資産総額の合計(月末純資 ||23196  |'            '計算期間の純資産総額の合計(月末純資 
23242  |'            .Cells(43, 28).NumberFormatLocal = "@||23197  |'            .Cells(43, 28).NumberFormatLocal = "@
23243  |'              If gbuMGetUPDRec.N(lRecIdx).MGET_ba||23198  |'              If gbuMGetUPDRec.N(lRecIdx).MGET_ba
23244  |'                  .Cells(43, 28).Value = CStr(For||23199  |'                  .Cells(43, 28).Value = CStr(For
23245  |'              Else                               ||23200  |'              Else                               
23246  |'                  .Cells(43, 28).Value = CStr(For||23201  |'                  .Cells(43, 28).Value = CStr(For
23247  |'              End If                             ||23202  |'              End If                             
23248  |'            .Cells(43, 28).HorizontalAlignment = ||23203  |'            .Cells(43, 28).HorizontalAlignment = 
23249  |'            '÷??＝                              ||23204  |'            '÷??＝                              
23250  |'            .Cells(43, 31).Value = sWord18 & "   ||23205  |'            .Cells(43, 31).Value = sWord18 & "   
23251  |'            '計算期間の純資産総額の合計÷計算期間||23206  |'            '計算期間の純資産総額の合計÷計算期間
23252  |'            .Cells(43, 40).NumberFormatLocal = "@||23207  |'            .Cells(43, 40).NumberFormatLocal = "@
23253  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base||23208  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base
23254  |'                .Cells(43, 40).Value = CStr(Forma||23209  |'                .Cells(43, 40).Value = CStr(Forma
23255  |'            Else                                 ||23210  |'            Else                                 
23256  |'                .Cells(43, 40).Value = CStr(Forma||23211  |'                .Cells(43, 40).Value = CStr(Forma
23257  |'            End If                               ||23212  |'            End If                               
23258  |                                                  ||23213  |                                                  
23259  |            ddblExchangeRate = 0                  ||23214  |            ddblExchangeRate = 0                  
23260  |                                                  ||23215  |                                                  
23261  |            '投資顧問料計算用計算対象NAVに日次平均||23216  |            '投資顧問料計算用計算対象NAVに日次平均
23262  |            If dstrAvgNav = "" Then               ||23217  |            If dstrAvgNav = "" Then               
23263  |                lCalcNav = 0                      ||23218  |                lCalcNav = 0                      
23264  |            Else                                  ||23219  |            Else                                  
23265  |                                                  ||23220  |                                                  
23266  |                dblValueIn = CDbl(dstrAvgNav)     ||23221  |                dblValueIn = CDbl(dstrAvgNav)     
23267  |                                                  ||23222  |                                                  
23268  |                '@@@@@ NAV通貨から閾値通貨に換算 @||23223  |                '@@@@@ NAV通貨から閾値通貨に換算 @
23269  |                Select Case gbuMGetUPDRec.N(lRecId||23224  |                Select Case gbuMGetUPDRec.N(lRecId
23270  |                  Case "1"    '固定料率           ||23225  |                  Case "1"    '固定料率           
23271  |                    If gbuMGetUPDRec.N(lRecIdx).MG||23226  |                    If gbuMGetUPDRec.N(lRecIdx).MG
23272  |                        'NAV通貨→JPYの為替レート ||23227  |                        'NAV通貨→JPYの為替レート 
23273  |                        dstrCurrencyCode = gbuMGet||23228  |                        dstrCurrencyCode = gbuMGet
23274  |                        ddblExchangeRate = fnstrEx||23229  |                        ddblExchangeRate = fnstrEx
23275  |                        If ddblExchangeRate = 0 Th||23230  |                        If ddblExchangeRate = 0 Th
23276  |                          intRtn = MsgBox("ＴＴＭ ||23231  |                          intRtn = MsgBox("ＴＴＭ 
23277  |                          vbLf & "対象通貨コード  ||23232  |                          vbLf & "対象通貨コード  
23278  |                          vbLf & "基準日 ： [ " & ||23233  |                          vbLf & "基準日 ： [ " & 
23279  |                              vbCritical, "ＴＴＭ ||23234  |                              vbCritical, "ＴＴＭ 
23280  |                          Exit Function           ||23235  |                          Exit Function           
23281  |                        End If                    ||23236  |                        End If                    
23282  |                        'NAV通貨→JPYへレート換算 ||23237  |                        'NAV通貨→JPYへレート換算 
23283  |                        dblValueIn = dblValueIn * ||23238  |                        dblValueIn = dblValueIn * 
23284  |                    End If                        ||23239  |                    End If                        
23285  |                                                  ||23240  |                                                  
23286  |                  Case "2"    '段階料率           ||23241  |                  Case "2"    '段階料率           
23287  |                                                  ||23242  |                                                  
23288  |                    If gbuMGetUPDRec.N(lRecIdx).MG||23243  |                    If gbuMGetUPDRec.N(lRecIdx).MG
23289  |                        If gbuMGetUPDRec.N(lRecIdx||23244  |                        If gbuMGetUPDRec.N(lRecIdx
23290  |                        Else                      ||23245  |                        Else                      
23291  |                            '閾値通貨→JPYの為替レ||23246  |                            '閾値通貨→JPYの為替レ
23292  |                            dstrCurrencyCode = gbu||23247  |                            dstrCurrencyCode = gbu
23293  |                            ddblExchangeRate = fns||23248  |                            ddblExchangeRate = fns
23294  |                            If ddblExchangeRate = ||23249  |                            If ddblExchangeRate = 
23295  |                              intRtn = MsgBox("Ｔ ||23250  |                              intRtn = MsgBox("Ｔ 
23296  |                              vbLf & "対象通貨コー||23251  |                              vbLf & "対象通貨コー
23297  |                              vbLf & "基準日 ： [ ||23252  |                              vbLf & "基準日 ： [ 
23298  |                                  vbCritical, "Ｔ ||23253  |                                  vbCritical, "Ｔ 
23299  |                              Exit Function       ||23254  |                              Exit Function       
23300  |                            End If                ||23255  |                            End If                
23301  |                            'JPY→閾値通貨へレート||23256  |                            'JPY→閾値通貨へレート
23302  |                            dblValueIn = dblValueI||23257  |                            dblValueIn = dblValueI
23303  |                        End If                    ||23258  |                        End If                    
23304  |                    Else                          ||23259  |                    Else                          
23305  |                        'NAV通貨→JPYの為替レート ||23260  |                        'NAV通貨→JPYの為替レート 
23306  |                        dstrCurrencyCode = gbuMGet||23261  |                        dstrCurrencyCode = gbuMGet
23307  |                        ddblExchangeRate = fnstrEx||23262  |                        ddblExchangeRate = fnstrEx
23308  |                        If ddblExchangeRate = 0 Th||23263  |                        If ddblExchangeRate = 0 Th
23309  |                          intRtn = MsgBox("ＴＴＭ ||23264  |                          intRtn = MsgBox("ＴＴＭ 
23310  |                          vbLf & "対象通貨コード  ||23265  |                          vbLf & "対象通貨コード  
23311  |                          vbLf & "基準日 ： [ " & ||23266  |                          vbLf & "基準日 ： [ " & 
23312  |                              vbCritical, "ＴＴＭ ||23267  |                              vbCritical, "ＴＴＭ 
23313  |                          Exit Function           ||23268  |                          Exit Function           
23314  |                        End If                    ||23269  |                        End If                    
23315  |                        'NAV通貨→JPYへレート換算 ||23270  |                        'NAV通貨→JPYへレート換算 
23316  |                        dblValueIn = dblValueIn * ||23271  |                        dblValueIn = dblValueIn * 
23317  |                        If gbuMGetUPDRec.N(lRecIdx||23272  |                        If gbuMGetUPDRec.N(lRecIdx
23318  |                        Else                      ||23273  |                        Else                      
23319  |                            '閾値通貨→JPYの為替レ||23274  |                            '閾値通貨→JPYの為替レ
23320  |                            dstrCurrencyCode = gbu||23275  |                            dstrCurrencyCode = gbu
23321  |                            ddblExchangeRate = fns||23276  |                            ddblExchangeRate = fns
23322  |                            If ddblExchangeRate = ||23277  |                            If ddblExchangeRate = 
23323  |                              intRtn = MsgBox("Ｔ ||23278  |                              intRtn = MsgBox("Ｔ 
23324  |                              vbLf & "対象通貨コー||23279  |                              vbLf & "対象通貨コー
23325  |                              vbLf & "基準日 ： [ ||23280  |                              vbLf & "基準日 ： [ 
23326  |                                  vbCritical, "Ｔ ||23281  |                                  vbCritical, "Ｔ 
23327  |                              Exit Function       ||23282  |                              Exit Function       
23328  |                            End If                ||23283  |                            End If                
23329  |                            'JPY→閾値通貨へ逆レー||23284  |                            'JPY→閾値通貨へ逆レー
23330  |                            dblValueIn = dblValueI||23285  |                            dblValueIn = dblValueI
23331  |                        End If                    ||23286  |                        End If                    
23332  |                    End If                        ||23287  |                    End If                        
23333  |                                                  ||23288  |                                                  
23334  |                End Select                        ||23289  |                End Select                        
23335  |                '@@@@@ NAV通貨から閾値通貨に換算 @||23290  |                '@@@@@ NAV通貨から閾値通貨に換算 @
23336  |                Call sbGetRoundValue2(dblValueIn) ||23291  |                Call sbGetRoundValue2(dblValueIn) 
23337  |                                                  ||23292  |                                                  
23338  |'閾値レート換算後平均NAV(計算対象NAV)             ||23293  |'閾値レート換算後平均NAV(計算対象NAV)             
23339  |                lCalcNav = CStr(Format(dblValueOut||23294  |                lCalcNav = CStr(Format(dblValueOut
23340  |            End If                                ||23295  |            End If                                
23341  |                                                  ||23296  |                                                  
23342  |On Error Resume Next                              ||23297  |On Error Resume Next                              
23343  |        End If                                    ||23298  |        End If                                    
23344  |                                                  ||23299  |                                                  
23345  |        '投資顧問料                               ||23300  |        '投資顧問料                               
23346  |        Dim dRitsu As Double    '外部委託顧問料率 ||23301  |        Dim dRitsu As Double    '外部委託顧問料率 
23347  |        dRitsu = 0                                ||23302  |        dRitsu = 0                                
23348  |        TotalRate = 0                             ||23303  |        TotalRate = 0                             
23349  |        ddblExchangeRate = 0                      ||23304  |        ddblExchangeRate = 0                      
23350  |        '計算対象NAVを変数にセット                ||23305  |        '計算対象NAVを変数にセット                
23351  |        lCalcNav = 0                              ||23306  |        lCalcNav = 0                              
23352  |        dblValueIn = TotalNav / iRowCnt           ||23307  |        dblValueIn = TotalNav / iRowCnt           
23353  |                                                  ||23308  |                                                  
23354  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    ||23309  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    
23355  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||23310  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
23356  |          Case "1"    '固定料率(固定料率の場合は、||23311  |          Case "1"    '固定料率(固定料率の場合は、
23357  |                                                  ||23312  |                                                  
23358  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||23313  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
23359  |                'NAV通貨→JPYの為替レートを取得   ||23314  |                'NAV通貨→JPYの為替レートを取得   
23360  |                dstrCurrencyCode = gbuMGetUPDRec.N||23315  |                dstrCurrencyCode = gbuMGetUPDRec.N
23361  |                ddblExchangeRate = fnstrExchangeRa||23316  |                ddblExchangeRate = fnstrExchangeRa
23362  |                If ddblExchangeRate = 0 Then      ||23317  |                If ddblExchangeRate = 0 Then      
23363  |                  intRtn = MsgBox("ＴＴＭが取得で ||23318  |                  intRtn = MsgBox("ＴＴＭが取得で 
23364  |                  vbLf & "対象通貨コード ： [ " & ||23319  |                  vbLf & "対象通貨コード ： [ " & 
23365  |                  vbLf & "基準日 ： [ " & Mid(dstr||23320  |                  vbLf & "基準日 ： [ " & Mid(dstr
23366  |                      vbCritical, "ＴＴＭ取得エラ ||23321  |                      vbCritical, "ＴＴＭ取得エラ 
23367  |                  Exit Function                   ||23322  |                  Exit Function                   
23368  |                End If                            ||23323  |                End If                            
23369  |'                'NAV通貨→JPYへレート換算        ||23324  |'                'NAV通貨→JPYへレート換算        
23370  |'                dblValueIn = dblValueIn * ddblExc||23325  |'                dblValueIn = dblValueIn * ddblExc
23371  |                For i = LBound(gtypOtherComRec) To||23326  |                For i = LBound(gtypOtherComRec) To
23372  |                    'NAV通貨→JPYへレート換算     ||23327  |                    'NAV通貨→JPYへレート換算     
23373  |                    gtypOtherComRec(i).APPLY_NAV_A||23328  |                    gtypOtherComRec(i).APPLY_NAV_A
23374  |                Next i                            ||23329  |                Next i                            
23375  |            End If                                ||23330  |            End If                                
23376  |                                                  ||23331  |                                                  
23377  |          Case "2"    '段階料率                   ||23332  |          Case "2"    '段階料率                   
23378  |                                                  ||23333  |                                                  
23379  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||23334  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
23380  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||23335  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
23381  |                Else                              ||23336  |                Else                              
23382  |                    '閾値通貨→JPYの為替レートを取||23337  |                    '閾値通貨→JPYの為替レートを取
23383  |                    dstrCurrencyCode = gbuMGetUPDR||23338  |                    dstrCurrencyCode = gbuMGetUPDR
23384  |                    ddblExchangeRate = fnstrExchan||23339  |                    ddblExchangeRate = fnstrExchan
23385  |                    If ddblExchangeRate = 0 Then  ||23340  |                    If ddblExchangeRate = 0 Then  
23386  |                      intRtn = MsgBox("ＴＴＭが取 ||23341  |                      intRtn = MsgBox("ＴＴＭが取 
23387  |                      vbLf & "対象通貨コード ： [ ||23342  |                      vbLf & "対象通貨コード ： [ 
23388  |                      vbLf & "基準日 ： [ " & Mid(||23343  |                      vbLf & "基準日 ： [ " & Mid(
23389  |                          vbCritical, "ＴＴＭ取得 ||23344  |                          vbCritical, "ＴＴＭ取得 
23390  |                      Exit Function               ||23345  |                      Exit Function               
23391  |                    End If                        ||23346  |                    End If                        
23392  |'                    'JPY→閾値通貨へレート換算   ||23347  |'                    'JPY→閾値通貨へレート換算   
23393  |'                    dblValueIn = dblValueIn * ddb||23348  |'                    dblValueIn = dblValueIn * ddb
23394  |                    For i = LBound(gtypOtherComRec||23349  |                    For i = LBound(gtypOtherComRec
23395  |                        'NAV通貨→JPYへレート換算 ||23350  |                        'NAV通貨→JPYへレート換算 
23396  |                        gtypOtherComRec(i).APPLY_N||23351  |                        gtypOtherComRec(i).APPLY_N
23397  |                    Next i                        ||23352  |                    Next i                        
23398  |                End If                            ||23353  |                End If                            
23399  |            Else                                  ||23354  |            Else                                  
23400  |                'NAV通貨→JPYの為替レートを取得   ||23355  |                'NAV通貨→JPYの為替レートを取得   
23401  |                dstrCurrencyCode = gbuMGetUPDRec.N||23356  |                dstrCurrencyCode = gbuMGetUPDRec.N
23402  |                ddblExchangeRate = fnstrExchangeRa||23357  |                ddblExchangeRate = fnstrExchangeRa
23403  |                If ddblExchangeRate = 0 Then      ||23358  |                If ddblExchangeRate = 0 Then      
23404  |                  intRtn = MsgBox("ＴＴＭが取得で ||23359  |                  intRtn = MsgBox("ＴＴＭが取得で 
23405  |                  vbLf & "対象通貨コード ： [ " & ||23360  |                  vbLf & "対象通貨コード ： [ " & 
23406  |                  vbLf & "基準日 ： [ " & Mid(dstr||23361  |                  vbLf & "基準日 ： [ " & Mid(dstr
23407  |                      vbCritical, "ＴＴＭ取得エラ ||23362  |                      vbCritical, "ＴＴＭ取得エラ 
23408  |                  Exit Function                   ||23363  |                  Exit Function                   
23409  |                End If                            ||23364  |                End If                            
23410  |'                'NAV通貨→JPYへレート換算        ||23365  |'                'NAV通貨→JPYへレート換算        
23411  |'                dblValueIn = dblValueIn * ddblExc||23366  |'                dblValueIn = dblValueIn * ddblExc
23412  |                For i = LBound(gtypOtherComRec) To||23367  |                For i = LBound(gtypOtherComRec) To
23413  |                    'NAV通貨→JPYへレート換算     ||23368  |                    'NAV通貨→JPYへレート換算     
23414  |                    gtypOtherComRec(i).APPLY_NAV_A||23369  |                    gtypOtherComRec(i).APPLY_NAV_A
23415  |                Next i                            ||23370  |                Next i                            
23416  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||23371  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
23417  |                Else                              ||23372  |                Else                              
23418  |                    '閾値通貨→JPYの為替レートを取||23373  |                    '閾値通貨→JPYの為替レートを取
23419  |                    dstrCurrencyCode = gbuMGetUPDR||23374  |                    dstrCurrencyCode = gbuMGetUPDR
23420  |                    ddblExchangeRate = fnstrExchan||23375  |                    ddblExchangeRate = fnstrExchan
23421  |                    If ddblExchangeRate = 0 Then  ||23376  |                    If ddblExchangeRate = 0 Then  
23422  |                      intRtn = MsgBox("ＴＴＭが取 ||23377  |                      intRtn = MsgBox("ＴＴＭが取 
23423  |                      vbLf & "対象通貨コード ： [ ||23378  |                      vbLf & "対象通貨コード ： [ 
23424  |                      vbLf & "基準日 ： [ " & Mid(||23379  |                      vbLf & "基準日 ： [ " & Mid(
23425  |                          vbCritical, "ＴＴＭ取得 ||23380  |                          vbCritical, "ＴＴＭ取得 
23426  |                      Exit Function               ||23381  |                      Exit Function               
23427  |                    End If                        ||23382  |                    End If                        
23428  |'                    'JPY→閾値通貨へ逆レート換算 ||23383  |'                    'JPY→閾値通貨へ逆レート換算 
23429  |'                    dblValueIn = dblValueIn / ddb||23384  |'                    dblValueIn = dblValueIn / ddb
23430  |                    For i = LBound(gtypOtherComRec||23385  |                    For i = LBound(gtypOtherComRec
23431  |                        'NAV通貨→JPYへレート換算 ||23386  |                        'NAV通貨→JPYへレート換算 
23432  |                        gtypOtherComRec(i).APPLY_N||23387  |                        gtypOtherComRec(i).APPLY_N
23433  |                    Next i                        ||23388  |                    Next i                        
23434  |                End If                            ||23389  |                End If                            
23435  |            End If                                ||23390  |            End If                                
23436  |        End Select                                ||23391  |        End Select                                
23437  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    ||23392  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    
23438  |'        Call sbGetRoundValue2(dblValueIn)        ||23393  |'        Call sbGetRoundValue2(dblValueIn)        
23439  |'        lCalcNav = CStr(Format(dblValueOut, "#,##||23394  |'        lCalcNav = CStr(Format(dblValueOut, "#,##
23440  |        For i = LBound(gtypOtherComRec) To UBound(||23395  |        For i = LBound(gtypOtherComRec) To UBound(
23441  |            Call sbGetRoundValue2(gtypOtherComRec(||23396  |            Call sbGetRoundValue2(gtypOtherComRec(
23442  |            gtypOtherComRec(i).APPLY_NAV_AVG = CSt||23397  |            gtypOtherComRec(i).APPLY_NAV_AVG = CSt
23443  |        Next i                                    ||23398  |        Next i                                    
23444  |                                                  ||23399  |                                                  
23445  |        '固定料率                                 ||23400  |        '固定料率                                 
23446  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat||23401  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat
23447  |            dblValueIn = 0                        ||23402  |            dblValueIn = 0                        
23448  |            '一年間の日数：365日またはカレンダー  ||23403  |            '一年間の日数：365日またはカレンダー  
23449  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_||23404  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_
23450  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_||23405  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_
23451  |                '計算対称NAV × 期中外部委託顧問料||23406  |                '計算対称NAV × 期中外部委託顧問料
23452  |                For i = LBound(gtypOtherComRec) To||23407  |                For i = LBound(gtypOtherComRec) To
23453  |                    For J = LBound(gtypOtherComRec||23408  |                    For J = LBound(gtypOtherComRec
23454  |                        gtypOtherComRec(i).APPLY_P||23409  |                        gtypOtherComRec(i).APPLY_P
23455  |                        gtypOtherComRec(i).APPLY_N||23410  |                        gtypOtherComRec(i).APPLY_N
23456  |                        gtypOtherComRec(i).APPLY_O||23411  |                        gtypOtherComRec(i).APPLY_O
23457  |                        gtypOtherComRec(i).APPLY_C||23412  |                        gtypOtherComRec(i).APPLY_C
23458  |                    Next J                        ||23413  |                    Next J                        
23459  |                Next i                            ||23414  |                Next i                            
23460  |            '一年間の日数：360日                  ||23415  |            '一年間の日数：360日                  
23461  |            Else                                  ||23416  |            Else                                  
23462  |                '計算対称NAV × 期中外部委託顧問料||23417  |                '計算対称NAV × 期中外部委託顧問料
23463  |                For i = LBound(gtypOtherComRec) To||23418  |                For i = LBound(gtypOtherComRec) To
23464  |                    For J = LBound(gtypOtherComRec||23419  |                    For J = LBound(gtypOtherComRec
23465  |                        gtypOtherComRec(i).APPLY_P||23420  |                        gtypOtherComRec(i).APPLY_P
23466  |                        gtypOtherComRec(i).APPLY_N||23421  |                        gtypOtherComRec(i).APPLY_N
23467  |                        gtypOtherComRec(i).APPLY_O||23422  |                        gtypOtherComRec(i).APPLY_O
23468  |                        gtypOtherComRec(i).APPLY_C||23423  |                        gtypOtherComRec(i).APPLY_C
23469  |                    Next J                        ||23424  |                    Next J                        
23470  |                Next i                            ||23425  |                Next i                            
23471  |            End If                                ||23426  |            End If                                
23472  |            '料率別顧問料を集計する               ||23427  |            '料率別顧問料を集計する               
23473  |            For i = LBound(gtypOtherComRec) To UBo||23428  |            For i = LBound(gtypOtherComRec) To UBo
23474  |                dblValueIn = dblValueIn + gtypOthe||23429  |                dblValueIn = dblValueIn + gtypOthe
23475  |            Next i                                ||23430  |            Next i                                
23476  |                                                  ||23431  |                                                  
23477  |        '段階料率                                 ||23432  |        '段階料率                                 
23478  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other||23433  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other
23479  |            For i = LBound(gtypOtherComRec) To UBo||23434  |            For i = LBound(gtypOtherComRec) To UBo
23480  |                TotalRate = 0                     ||23435  |                TotalRate = 0                     
23481  |                TotalCom = 0                      ||23436  |                TotalCom = 0                      
23482  |'2008/03/03 START NAVが閾値を超えない場合、累積投 ||23437  |'2008/03/03 START NAVが閾値を超えない場合、累積投 
23483  |                WorkRate = 0                      ||23438  |                WorkRate = 0                      
23484  |'2008/03/03 END   NAVが閾値を超えない場合、累積投 ||23439  |'2008/03/03 END   NAVが閾値を超えない場合、累積投 
23485  |                For J = LBound(gtypOtherComRec(i).||23440  |                For J = LBound(gtypOtherComRec(i).
23486  |                    TotalRate = TotalRate + CCur(g||23441  |                    TotalRate = TotalRate + CCur(g
23487  |                    cRate = CCur(gtypOtherComRec(i||23442  |                    cRate = CCur(gtypOtherComRec(i
23488  |                    dRitsu = CDbl(gtypOtherComRec(||23443  |                    dRitsu = CDbl(gtypOtherComRec(
23489  |                    If J = UBound(gtypOtherComRec(||23444  |                    If J = UBound(gtypOtherComRec(
23490  |                        '(前回閾値)：累積閾値 = WO||23445  |                        '(前回閾値)：累積閾値 = WO
23491  |                        TotalRate = WorkRate      ||23446  |                        TotalRate = WorkRate      
23492  |                    ElseIf TotalRate <= gtypOtherC||23447  |                    ElseIf TotalRate <= gtypOtherC
23493  |                        '累積投資顧問料 = 累積投資||23448  |                        '累積投資顧問料 = 累積投資
23494  |                        dblValueIn = cRate * dRits||23449  |                        dblValueIn = cRate * dRits
23495  |                        Call sbGetRoundValue2(dblV||23450  |                        Call sbGetRoundValue2(dblV
23496  |                        TotalCom = TotalCom + dblV||23451  |                        TotalCom = TotalCom + dblV
23497  |                    Else                          ||23452  |                    Else                          
23498  |                        '(前回閾値)：累積閾値 = WO||23453  |                        '(前回閾値)：累積閾値 = WO
23499  |                        TotalRate = WorkRate      ||23454  |                        TotalRate = WorkRate      
23500  |                        Exit For                  ||23455  |                        Exit For                  
23501  |                    End If                        ||23456  |                    End If                        
23502  |                    '累積閾値をWORKに格納(一つ前の||23457  |                    '累積閾値をWORKに格納(一つ前の
23503  |                    WorkRate = TotalRate          ||23458  |                    WorkRate = TotalRate          
23504  |                Next J                            ||23459  |                Next J                            
23505  |                '累積投資顧問料 = 累積投資顧問料 +||23460  |                '累積投資顧問料 = 累積投資顧問料 +
23506  |                dblValueIn = (gtypOtherComRec(i).A||23461  |                dblValueIn = (gtypOtherComRec(i).A
23507  |                TotalCom = TotalCom + dblValueIn  ||23462  |                TotalCom = TotalCom + dblValueIn  
23508  |                '投資顧問料 = 累積投資顧問料 × 計||23463  |                '投資顧問料 = 累積投資顧問料 × 計
23509  |                If gbuMGetUPDRec.N(lRecIdx).MGET_d||23464  |                If gbuMGetUPDRec.N(lRecIdx).MGET_d
23510  |                Or gbuMGetUPDRec.N(lRecIdx).MGET_d||23465  |                Or gbuMGetUPDRec.N(lRecIdx).MGET_d
23511  |                    '一年間の日数：365日またはカレ||23466  |                    '一年間の日数：365日またはカレ
23512  |                    gtypOtherComRec(i).APPLY_PAY_C||23467  |                    gtypOtherComRec(i).APPLY_PAY_C
23513  |                Else                              ||23468  |                Else                              
23514  |                    '一年間の日数：360日          ||23469  |                    '一年間の日数：360日          
23515  |                    gtypOtherComRec(i).APPLY_PAY_C||23470  |                    gtypOtherComRec(i).APPLY_PAY_C
23516  |                End If                            ||23471  |                End If                            
23517  |            Next i                                ||23472  |            Next i                                
23518  |            '外部委託顧問料変数を初期化           ||23473  |            '外部委託顧問料変数を初期化           
23519  |            dblValueIn = 0                        ||23474  |            dblValueIn = 0                        
23520  |            'トータル顧問料をセット               ||23475  |            'トータル顧問料をセット               
23521  |            For i = LBound(gtypOtherComRec) To UBo||23476  |            For i = LBound(gtypOtherComRec) To UBo
23522  |                dblValueIn = dblValueIn + gtypOthe||23477  |                dblValueIn = dblValueIn + gtypOthe
23523  |            Next i                                ||23478  |            Next i                                
23524  |'期中料率変更契約対応 END                         ||23479  |'期中料率変更契約対応 END                         
23525  |        End If                                    ||23480  |        End If                                    
23526  |                                                  ||23481  |                                                  
23527  |        ddblExchangeRate = 0                      ||23482  |        ddblExchangeRate = 0                      
23528  |                                                  ||23483  |                                                  
23529  |        '@@@@@ 外部委託顧問料に換算 @@@@@         ||23484  |        '@@@@@ 外部委託顧問料に換算 @@@@@         
23530  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||23485  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
23531  |          Case "1"    '固定料率                   ||23486  |          Case "1"    '固定料率                   
23532  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o||23487  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o
23533  |                Else                              ||23488  |                Else                              
23534  |                  '外部委託顧問料通貨→JPYの為替レ||23489  |                  '外部委託顧問料通貨→JPYの為替レ
23535  |                  dstrCurrencyCode = gbuMGetUPDRec||23490  |                  dstrCurrencyCode = gbuMGetUPDRec
23536  |                  ddblExchangeRate = fnstrExchange||23491  |                  ddblExchangeRate = fnstrExchange
23537  |                  If ddblExchangeRate = 0 Then    ||23492  |                  If ddblExchangeRate = 0 Then    
23538  |                    intRtn = MsgBox("ＴＴＭが取得 ||23493  |                    intRtn = MsgBox("ＴＴＭが取得 
23539  |                    vbLf & "対象通貨コード ： [ " ||23494  |                    vbLf & "対象通貨コード ： [ " 
23540  |                    vbLf & "基準日 ： [ " & Mid(ds||23495  |                    vbLf & "基準日 ： [ " & Mid(ds
23541  |                        vbCritical, "ＴＴＭ取得エ ||23496  |                        vbCritical, "ＴＴＭ取得エ 
23542  |                    Exit Function                 ||23497  |                    Exit Function                 
23543  |                  End If                          ||23498  |                  End If                          
23544  |                  'JPY→閾値通貨へ逆レート換算    ||23499  |                  'JPY→閾値通貨へ逆レート換算    
23545  |                  dblValueIn = dblValueIn / ddblEx||23500  |                  dblValueIn = dblValueIn / ddblEx
23546  |                End If                            ||23501  |                End If                            
23547  |                                                  ||23502  |                                                  
23548  |          Case "2"    '段階料率                   ||23503  |          Case "2"    '段階料率                   
23549  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||23504  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
23550  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||23505  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
23551  |                Else                              ||23506  |                Else                              
23552  |                    '閾値通貨→JPYの為替レートを取||23507  |                    '閾値通貨→JPYの為替レートを取
23553  |                    dstrCurrencyCode = gbuMGetUPDR||23508  |                    dstrCurrencyCode = gbuMGetUPDR
23554  |                    ddblExchangeRate = fnstrExchan||23509  |                    ddblExchangeRate = fnstrExchan
23555  |                    'JPY→閾値通貨へ逆レート換算  ||23510  |                    'JPY→閾値通貨へ逆レート換算  
23556  |                    dblValueIn = dblValueIn / ddbl||23511  |                    dblValueIn = dblValueIn / ddbl
23557  |                End If                            ||23512  |                End If                            
23558  |            Else                                  ||23513  |            Else                                  
23559  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||23514  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
23560  |                    '外部委託顧問料通貨→JPYの為替||23515  |                    '外部委託顧問料通貨→JPYの為替
23561  |                    dstrCurrencyCode = gbuMGetUPDR||23516  |                    dstrCurrencyCode = gbuMGetUPDR
23562  |                    ddblExchangeRate = fnstrExchan||23517  |                    ddblExchangeRate = fnstrExchan
23563  |                    'JPY→閾値通貨へレート換算    ||23518  |                    'JPY→閾値通貨へレート換算    
23564  |                    dblValueIn = dblValueIn / ddbl||23519  |                    dblValueIn = dblValueIn / ddbl
23565  |                Else                              ||23520  |                Else                              
23566  |                    '閾値通貨→JPYの為替レートを取||23521  |                    '閾値通貨→JPYの為替レートを取
23567  |                    dstrCurrencyCode = gbuMGetUPDR||23522  |                    dstrCurrencyCode = gbuMGetUPDR
23568  |                    ddblExchangeRate = fnstrExchan||23523  |                    ddblExchangeRate = fnstrExchan
23569  |                    'JPY→閾値通貨へ逆レート換算  ||23524  |                    'JPY→閾値通貨へ逆レート換算  
23570  |                    dblValueIn = dblValueIn * ddbl||23525  |                    dblValueIn = dblValueIn * ddbl
23571  |                    '外部委託顧問料通貨→JPYの為替||23526  |                    '外部委託顧問料通貨→JPYの為替
23572  |                    dstrCurrencyCode = gbuMGetUPDR||23527  |                    dstrCurrencyCode = gbuMGetUPDR
23573  |                    ddblExchangeRate = fnstrExchan||23528  |                    ddblExchangeRate = fnstrExchan
23574  |                    'JPY→閾値通貨へ逆レート換算  ||23529  |                    'JPY→閾値通貨へ逆レート換算  
23575  |                    dblValueIn = dblValueIn / ddbl||23530  |                    dblValueIn = dblValueIn / ddbl
23576  |                End If                            ||23531  |                End If                            
23577  |            End If                                ||23532  |            End If                                
23578  |                                                  ||23533  |                                                  
23579  |        End Select                                ||23534  |        End Select                                
23580  |        '@@@@@ 外部委託顧問料に換算 @@@@@         ||23535  |        '@@@@@ 外部委託顧問料に換算 @@@@@         
23581  |        Call sbGetRoundValue2(dblValueIn)         ||23536  |        Call sbGetRoundValue2(dblValueIn)         
23582  |        mstrMonthlyPayCom = dblValueOut           ||23537  |        mstrMonthlyPayCom = dblValueOut           
23583  |                                                  ||23538  |                                                  
23584  |        TotalRate = 0                             ||23539  |        TotalRate = 0                             
23585  |'期中料率変更契約対応 START                       ||23540  |'期中料率変更契約対応 START                       
23586  |        TotalRate = 0                             ||23541  |        TotalRate = 0                             
23587  |        '年率は別紙に記載                         ||23542  |        '年率は別紙に記載                         
23588  |        strWord = ""                              ||23543  |        strWord = ""                              
23589  |        strWord = strWord & sWord53a & """"       ||23544  |        strWord = strWord & sWord53a & """"       
23590  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||23545  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
23591  |            Case Mid(mstrContractFlag(1), 1, 1)   ||23546  |            Case Mid(mstrContractFlag(1), 1, 1)   
23592  |                strWord = strWord & sWord54a & """||23547  |                strWord = strWord & sWord54a & """
23593  |            Case Mid(mstrContractFlag(2), 1, 1)   ||23548  |            Case Mid(mstrContractFlag(2), 1, 1)   
23594  |                strWord = strWord & sWord55a & """||23549  |                strWord = strWord & sWord55a & """
23595  |            Case Mid(mstrContractFlag(3), 1, 1)   ||23550  |            Case Mid(mstrContractFlag(3), 1, 1)   
23596  |                strWord = strWord & sWord56a & """||23551  |                strWord = strWord & sWord56a & """
23597  |            Case Else                             ||23552  |            Case Else                             
23598  |        End Select                                ||23553  |        End Select                                
23599  |        .Cells(15, 15).Value = strWord            ||23554  |        .Cells(15, 15).Value = strWord            
23600  |'期中料率変更契約対応 END                         ||23555  |'期中料率変更契約対応 END                         
23601  |                                                  ||23556  |                                                  
23602  |        '投資顧問料                               ||23557  |        '投資顧問料                               
23603  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||23558  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
23604  |            Case Mid(mstrContractFlag(1), 1, 1)   ||23559  |            Case Mid(mstrContractFlag(1), 1, 1)   
23605  |                .Cells(46, 2).Value = sWord11d    ||23560  |                .Cells(46, 2).Value = sWord11d    
23606  |            Case Mid(mstrContractFlag(2), 1, 1)   ||23561  |            Case Mid(mstrContractFlag(2), 1, 1)   
23607  |                .Cells(46, 2).Value = sWord11e    ||23562  |                .Cells(46, 2).Value = sWord11e    
23608  |            Case Mid(mstrContractFlag(3), 1, 1)   ||23563  |            Case Mid(mstrContractFlag(3), 1, 1)   
23609  |                .Cells(46, 2).Value = sWord11f    ||23564  |                .Cells(46, 2).Value = sWord11f    
23610  |            Case Else                             ||23565  |            Case Else                             
23611  |                MsgBox "契約区分が不正です。", vbC||23566  |                MsgBox "契約区分が不正です。", vbC
23612  |        End Select                                ||23567  |        End Select                                
23613  |        '文言の冗長化でピリオド及び、名称を二列右 ||23568  |        '文言の冗長化でピリオド及び、名称を二列右 
23614  |'        .Cells(46, 11).Value = sWord19           ||23569  |'        .Cells(46, 11).Value = sWord19           
23615  |        .Cells(46, 13).Value = sWord19            ||23570  |        .Cells(46, 13).Value = sWord19            
23616  |                                                  ||23571  |                                                  
23617  |        '外部委託顧問料                           ||23572  |        '外部委託顧問料                           
23618  |        '文言の冗長化でピリオド及び、名称を二列右 ||23573  |        '文言の冗長化でピリオド及び、名称を二列右 
23619  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||23574  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
23620  |'            .Cells(46, 31).NumberFormatLocal = "@||23575  |'            .Cells(46, 31).NumberFormatLocal = "@
23621  |'        Else                                     ||23576  |'        Else                                     
23622  |'            .Cells(46, 29).NumberFormatLocal = "@||23577  |'            .Cells(46, 29).NumberFormatLocal = "@
23623  |'        End If                                   ||23578  |'        End If                                   
23624  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||23579  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
23625  |            .Cells(46, 33).NumberFormatLocal = "@"||23580  |            .Cells(46, 33).NumberFormatLocal = "@"
23626  |        Else                                      ||23581  |        Else                                      
23627  |            .Cells(46, 31).NumberFormatLocal = "@"||23582  |            .Cells(46, 31).NumberFormatLocal = "@"
23628  |        End If                                    ||23583  |        End If                                    
23629  |                                                  ||23584  |                                                  
23630  |        '契約区分が名称使用許諾料の場合上限・下限 ||23585  |        '契約区分が名称使用許諾料の場合上限・下限 
23631  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||23586  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
23632  |            '下限金額より換算した金額が小さい場合 ||23587  |            '下限金額より換算した金額が小さい場合 
23633  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_f||23588  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_f
23634  |                If mstrMonthlyPayCom < CDbl(gbuMGe||23589  |                If mstrMonthlyPayCom < CDbl(gbuMGe
23635  |                    mstrMonthlyPayCom = CDbl(gbuMG||23590  |                    mstrMonthlyPayCom = CDbl(gbuMG
23636  |                End If                            ||23591  |                End If                            
23637  |            End If                                ||23592  |            End If                                
23638  |            '上限金額より換算した金額が大きい場合 ||23593  |            '上限金額より換算した金額が大きい場合 
23639  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_c||23594  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_c
23640  |                If mstrMonthlyPayCom > CDbl(gbuMGe||23595  |                If mstrMonthlyPayCom > CDbl(gbuMGe
23641  |                    mstrMonthlyPayCom = CDbl(gbuMG||23596  |                    mstrMonthlyPayCom = CDbl(gbuMG
23642  |                End If                            ||23597  |                End If                            
23643  |            End If                                ||23598  |            End If                                
23644  |                                                  ||23599  |                                                  
23645  |            dblValueIn = CDbl(mstrMonthlyPayCom)  ||23600  |            dblValueIn = CDbl(mstrMonthlyPayCom)  
23646  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||23601  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
23647  |                Call sbGetRoundValue2(dblValueIn) ||23602  |                Call sbGetRoundValue2(dblValueIn) 
23648  |            Else                                  ||23603  |            Else                                  
23649  |                Call sbGetRoundValue(dblValueIn)  ||23604  |                Call sbGetRoundValue(dblValueIn)  
23650  |            End If                                ||23605  |            End If                                
23651  |            mstrMonthlyPayCom = dblValueOut       ||23606  |            mstrMonthlyPayCom = dblValueOut       
23652  |                                                  ||23607  |                                                  
23653  |        End If                                    ||23608  |        End If                                    
23654  |                                                  ||23609  |                                                  
23655  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||23610  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
23656  |            '文言の冗長化でピリオド及び、名称を二 ||23611  |            '文言の冗長化でピリオド及び、名称を二 
23657  |'            Case cAud                            ||23612  |'            Case cAud                            
23658  |'                .Cells(46, 31).Value = CStr(Forma||23613  |'                .Cells(46, 31).Value = CStr(Forma
23659  |'                .Cells(46, 32).Value = sAuda     ||23614  |'                .Cells(46, 32).Value = sAuda     
23660  |'            Case cCad                            ||23615  |'            Case cCad                            
23661  |'                .Cells(46, 31).Value = CStr(Forma||23616  |'                .Cells(46, 31).Value = CStr(Forma
23662  |'                .Cells(46, 32).Value = sCada     ||23617  |'                .Cells(46, 32).Value = sCada     
23663  |'            Case cChf                            ||23618  |'            Case cChf                            
23664  |'                .Cells(46, 31).Value = CStr(Forma||23619  |'                .Cells(46, 31).Value = CStr(Forma
23665  |'                .Cells(46, 32).Value = sChfa     ||23620  |'                .Cells(46, 32).Value = sChfa     
23666  |'            Case cEur                            ||23621  |'            Case cEur                            
23667  |'                .Cells(46, 31).Value = CStr(Forma||23622  |'                .Cells(46, 31).Value = CStr(Forma
23668  |'                .Cells(46, 32).Value = sEura     ||23623  |'                .Cells(46, 32).Value = sEura     
23669  |'            Case cGbp                            ||23624  |'            Case cGbp                            
23670  |'                .Cells(46, 31).Value = CStr(Forma||23625  |'                .Cells(46, 31).Value = CStr(Forma
23671  |'                .Cells(46, 32).Value = sGbpa     ||23626  |'                .Cells(46, 32).Value = sGbpa     
23672  |'            Case cHkd                            ||23627  |'            Case cHkd                            
23673  |'                .Cells(46, 31).Value = CStr(Forma||23628  |'                .Cells(46, 31).Value = CStr(Forma
23674  |'                .Cells(46, 32).Value = sHkda     ||23629  |'                .Cells(46, 32).Value = sHkda     
23675  |'            Case cJpy                            ||23630  |'            Case cJpy                            
23676  |'                .Cells(46, 29).Value = CStr(Forma||23631  |'                .Cells(46, 29).Value = CStr(Forma
23677  |'                .Cells(46, 32).Value = sYena     ||23632  |'                .Cells(46, 32).Value = sYena     
23678  |'            Case cMyr                            ||23633  |'            Case cMyr                            
23679  |'                .Cells(46, 31).Value = CStr(Forma||23634  |'                .Cells(46, 31).Value = CStr(Forma
23680  |'                .Cells(46, 32).Value = sMyra     ||23635  |'                .Cells(46, 32).Value = sMyra     
23681  |'            Case cNzd                            ||23636  |'            Case cNzd                            
23682  |'                .Cells(46, 31).Value = CStr(Forma||23637  |'                .Cells(46, 31).Value = CStr(Forma
23683  |'                .Cells(46, 32).Value = sNzda     ||23638  |'                .Cells(46, 32).Value = sNzda     
23684  |'            Case cSek                            ||23639  |'            Case cSek                            
23685  |'                .Cells(46, 31).Value = CStr(Forma||23640  |'                .Cells(46, 31).Value = CStr(Forma
23686  |'                .Cells(46, 32).Value = sSeka     ||23641  |'                .Cells(46, 32).Value = sSeka     
23687  |'            Case cSgd                            ||23642  |'            Case cSgd                            
23688  |'                .Cells(46, 31).Value = CStr(Forma||23643  |'                .Cells(46, 31).Value = CStr(Forma
23689  |'                .Cells(46, 32).Value = sSgda     ||23644  |'                .Cells(46, 32).Value = sSgda     
23690  |'            Case cUsd                            ||23645  |'            Case cUsd                            
23691  |'                .Cells(46, 31).Value = CStr(Forma||23646  |'                .Cells(46, 31).Value = CStr(Forma
23692  |'                .Cells(46, 32).Value = sUsda     ||23647  |'                .Cells(46, 32).Value = sUsda     
23693  |'            Case cNok                            ||23648  |'            Case cNok                            
23694  |'                .Cells(46, 31).Value = CStr(Forma||23649  |'                .Cells(46, 31).Value = CStr(Forma
23695  |'                .Cells(46, 32).Value = sNoka     ||23650  |'                .Cells(46, 32).Value = sNoka     
23696  |            Case cAud                             ||23651  |            Case cAud                             
23697  |                .Cells(46, 33).Value = CStr(Format||23652  |                .Cells(46, 33).Value = CStr(Format
23698  |                .Cells(46, 34).Value = sAuda      ||23653  |                .Cells(46, 34).Value = sAuda      
23699  |            Case cCad                             ||23654  |            Case cCad                             
23700  |                .Cells(46, 33).Value = CStr(Format||23655  |                .Cells(46, 33).Value = CStr(Format
23701  |                .Cells(46, 34).Value = sCada      ||23656  |                .Cells(46, 34).Value = sCada      
23702  |            Case cChf                             ||23657  |            Case cChf                             
23703  |                .Cells(46, 33).Value = CStr(Format||23658  |                .Cells(46, 33).Value = CStr(Format
23704  |                .Cells(46, 34).Value = sChfa      ||23659  |                .Cells(46, 34).Value = sChfa      
23705  |            Case cEur                             ||23660  |            Case cEur                             
23706  |                .Cells(46, 33).Value = CStr(Format||23661  |                .Cells(46, 33).Value = CStr(Format
23707  |                .Cells(46, 34).Value = sEura      ||23662  |                .Cells(46, 34).Value = sEura      
23708  |            Case cGbp                             ||23663  |            Case cGbp                             
23709  |                .Cells(46, 33).Value = CStr(Format||23664  |                .Cells(46, 33).Value = CStr(Format
23710  |                .Cells(46, 34).Value = sGbpa      ||23665  |                .Cells(46, 34).Value = sGbpa      
23711  |            Case cHkd                             ||23666  |            Case cHkd                             
23712  |                .Cells(46, 33).Value = CStr(Format||23667  |                .Cells(46, 33).Value = CStr(Format
23713  |                .Cells(46, 34).Value = sHkda      ||23668  |                .Cells(46, 34).Value = sHkda      
23714  |            Case cJpy                             ||23669  |            Case cJpy                             
23715  |                .Cells(46, 31).Value = CStr(Format||23670  |                .Cells(46, 31).Value = CStr(Format
23716  |                .Cells(46, 34).Value = sYena      ||23671  |                .Cells(46, 34).Value = sYena      
23717  |            Case cMyr                             ||23672  |            Case cMyr                             
23718  |                .Cells(46, 33).Value = CStr(Format||23673  |                .Cells(46, 33).Value = CStr(Format
23719  |                .Cells(46, 34).Value = sMyra      ||23674  |                .Cells(46, 34).Value = sMyra      
23720  |            Case cNzd                             ||23675  |            Case cNzd                             
23721  |                .Cells(46, 33).Value = CStr(Format||23676  |                .Cells(46, 33).Value = CStr(Format
23722  |                .Cells(46, 34).Value = sNzda      ||23677  |                .Cells(46, 34).Value = sNzda      
23723  |            Case cSek                             ||23678  |            Case cSek                             
23724  |                .Cells(46, 33).Value = CStr(Format||23679  |                .Cells(46, 33).Value = CStr(Format
23725  |                .Cells(46, 34).Value = sSeka      ||23680  |                .Cells(46, 34).Value = sSeka      
23726  |            Case cSgd                             ||23681  |            Case cSgd                             
23727  |                .Cells(46, 33).Value = CStr(Format||23682  |                .Cells(46, 33).Value = CStr(Format
23728  |                .Cells(46, 34).Value = sSgda      ||23683  |                .Cells(46, 34).Value = sSgda      
23729  |            Case cUsd                             ||23684  |            Case cUsd                             
23730  |                .Cells(46, 33).Value = CStr(Format||23685  |                .Cells(46, 33).Value = CStr(Format
23731  |                .Cells(46, 34).Value = sUsda      ||23686  |                .Cells(46, 34).Value = sUsda      
23732  |            Case cNok                             ||23687  |            Case cNok                             
23733  |                .Cells(46, 33).Value = CStr(Format||23688  |                .Cells(46, 33).Value = CStr(Format
23734  |                .Cells(46, 34).Value = sNoka      ||23689  |                .Cells(46, 34).Value = sNoka      
23735  |        End Select                                ||23690  |        End Select                                
23736  |                                                  ||23691  |                                                  
23737  |        '顧問料                                   ||23692  |        '顧問料                                   
23738  |        '文言の冗長化でピリオド及び、名称を二列右 ||23693  |        '文言の冗長化でピリオド及び、名称を二列右 
23739  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||23694  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
23740  |'            .Cells(46, 31).HorizontalAlignment = ||23695  |'            .Cells(46, 31).HorizontalAlignment = 
23741  |'        Else                                     ||23696  |'        Else                                     
23742  |'            .Cells(46, 29).HorizontalAlignment = ||23697  |'            .Cells(46, 29).HorizontalAlignment = 
23743  |'        End If                                   ||23698  |'        End If                                   
23744  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||23699  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
23745  |            .Cells(46, 33).HorizontalAlignment = x||23700  |            .Cells(46, 33).HorizontalAlignment = x
23746  |        Else                                      ||23701  |        Else                                      
23747  |            .Cells(46, 31).HorizontalAlignment = x||23702  |            .Cells(46, 31).HorizontalAlignment = x
23748  |        End If                                    ||23703  |        End If                                    
23749  |                                                  ||23704  |                                                  
23750  |        '契約区分が名称使用許諾料の場合上限・下限 ||23705  |        '契約区分が名称使用許諾料の場合上限・下限 
23751  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||23706  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
23752  |            '上限金額                             ||23707  |            '上限金額                             
23753  |            '文言の冗長化でピリオド及び、名称を二 ||23708  |            '文言の冗長化でピリオド及び、名称を二 
23754  |'            .Cells(46, 45).Value = sWordCapa     ||23709  |'            .Cells(46, 45).Value = sWordCapa     
23755  |'            .Cells(46, 57).NumberFormatLocal = "@||23710  |'            .Cells(46, 57).NumberFormatLocal = "@
23756  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou||23711  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou
23757  |'                .Cells(46, 57).Value = Format(gbu||23712  |'                .Cells(46, 57).Value = Format(gbu
23758  |'            Else                                 ||23713  |'            Else                                 
23759  |'                .Cells(46, 57).Value = Format(gbu||23714  |'                .Cells(46, 57).Value = Format(gbu
23760  |'            End If                               ||23715  |'            End If                               
23761  |'                                                 ||23716  |'                                                 
23762  |'            .Cells(46, 57).HorizontalAlignment = ||23717  |'            .Cells(46, 57).HorizontalAlignment = 
23763  |'                                                 ||23718  |'                                                 
23764  |'            '下限金額                            ||23719  |'            '下限金額                            
23765  |'            .Cells(47, 45).Value = sWordFloora   ||23720  |'            .Cells(47, 45).Value = sWordFloora   
23766  |'            .Cells(47, 57).NumberFormatLocal = "@||23721  |'            .Cells(47, 57).NumberFormatLocal = "@
23767  |'                                                 ||23722  |'                                                 
23768  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou||23723  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou
23769  |'                .Cells(47, 57).Value = Format(gbu||23724  |'                .Cells(47, 57).Value = Format(gbu
23770  |'            Else                                 ||23725  |'            Else                                 
23771  |'                .Cells(47, 57).Value = Format(gbu||23726  |'                .Cells(47, 57).Value = Format(gbu
23772  |'            End If                               ||23727  |'            End If                               
23773  |'            .Cells(47, 57).HorizontalAlignment = ||23728  |'            .Cells(47, 57).HorizontalAlignment = 
23774  |            .Cells(46, 47).Value = sWordCapa      ||23729  |            .Cells(46, 47).Value = sWordCapa      
23775  |            .Cells(46, 59).NumberFormatLocal = "@"||23730  |            .Cells(46, 59).NumberFormatLocal = "@"
23776  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||23731  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
23777  |                .Cells(46, 59).Value = Format(gbuM||23732  |                .Cells(46, 59).Value = Format(gbuM
23778  |            Else                                  ||23733  |            Else                                  
23779  |                .Cells(46, 59).Value = Format(gbuM||23734  |                .Cells(46, 59).Value = Format(gbuM
23780  |            End If                                ||23735  |            End If                                
23781  |                                                  ||23736  |                                                  
23782  |            .Cells(46, 59).HorizontalAlignment = x||23737  |            .Cells(46, 59).HorizontalAlignment = x
23783  |                                                  ||23738  |                                                  
23784  |            '下限金額                             ||23739  |            '下限金額                             
23785  |            .Cells(47, 47).Value = sWordFloora    ||23740  |            .Cells(47, 47).Value = sWordFloora    
23786  |            .Cells(47, 59).NumberFormatLocal = "@"||23741  |            .Cells(47, 59).NumberFormatLocal = "@"
23787  |                                                  ||23742  |                                                  
23788  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||23743  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
23789  |                .Cells(47, 59).Value = Format(gbuM||23744  |                .Cells(47, 59).Value = Format(gbuM
23790  |            Else                                  ||23745  |            Else                                  
23791  |                .Cells(47, 59).Value = Format(gbuM||23746  |                .Cells(47, 59).Value = Format(gbuM
23792  |            End If                                ||23747  |            End If                                
23793  |            .Cells(47, 59).HorizontalAlignment = x||23748  |            .Cells(47, 59).HorizontalAlignment = x
23794  |        End If                                    ||23749  |        End If                                    
23795  |                                                  ||23750  |                                                  
23796  |        ddblExchangeRate = 0                      ||23751  |        ddblExchangeRate = 0                      
23797  |                                                  ||23752  |                                                  
23798  |        dblValueIn = mstrMonthlyPayCom            ||23753  |        dblValueIn = mstrMonthlyPayCom            
23799  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||23754  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
23800  |          Case "1"    '固定料率                   ||23755  |          Case "1"    '固定料率                   
23801  |                                                  ||23756  |                                                  
23802  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o||23757  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o
23803  |                Else                              ||23758  |                Else                              
23804  |                  '外部委託顧問料通貨→JPYの為替レ||23759  |                  '外部委託顧問料通貨→JPYの為替レ
23805  |                  dstrCurrencyCode = gbuMGetUPDRec||23760  |                  dstrCurrencyCode = gbuMGetUPDRec
23806  |                  ddblExchangeRate = fnstrExchange||23761  |                  ddblExchangeRate = fnstrExchange
23807  |                  If ddblExchangeRate = 0 Then    ||23762  |                  If ddblExchangeRate = 0 Then    
23808  |                    intRtn = MsgBox("ＴＴＭが取得 ||23763  |                    intRtn = MsgBox("ＴＴＭが取得 
23809  |                    vbLf & "対象通貨コード ： [ " ||23764  |                    vbLf & "対象通貨コード ： [ " 
23810  |                    vbLf & "基準日 ： [ " & Mid(ds||23765  |                    vbLf & "基準日 ： [ " & Mid(ds
23811  |                        vbCritical, "ＴＴＭ取得エ ||23766  |                        vbCritical, "ＴＴＭ取得エ 
23812  |                    Exit Function                 ||23767  |                    Exit Function                 
23813  |                  End If                          ||23768  |                  End If                          
23814  |                  'JPY→支払通貨へレート換算      ||23769  |                  'JPY→支払通貨へレート換算      
23815  |                  dblValueIn = dblValueIn * ddblEx||23770  |                  dblValueIn = dblValueIn * ddblEx
23816  |                End If                            ||23771  |                End If                            
23817  |                                                  ||23772  |                                                  
23818  |          Case "2"    '段階料率                   ||23773  |          Case "2"    '段階料率                   
23819  |                                                  ||23774  |                                                  
23820  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||23775  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
23821  |            Else                                  ||23776  |            Else                                  
23822  |                '外部委託顧問料通貨→JPYの為替レー||23777  |                '外部委託顧問料通貨→JPYの為替レー
23823  |                dstrCurrencyCode = gbuMGetUPDRec.N||23778  |                dstrCurrencyCode = gbuMGetUPDRec.N
23824  |                ddblExchangeRate = fnstrExchangeRa||23779  |                ddblExchangeRate = fnstrExchangeRa
23825  |                If ddblExchangeRate = 0 Then      ||23780  |                If ddblExchangeRate = 0 Then      
23826  |                  intRtn = MsgBox("ＴＴＭが取得で ||23781  |                  intRtn = MsgBox("ＴＴＭが取得で 
23827  |                  vbLf & "対象通貨コード ： [ " & ||23782  |                  vbLf & "対象通貨コード ： [ " & 
23828  |                  vbLf & "基準日 ： [ " & Mid(dstr||23783  |                  vbLf & "基準日 ： [ " & Mid(dstr
23829  |                      vbCritical, "ＴＴＭ取得エラ ||23784  |                      vbCritical, "ＴＴＭ取得エラ 
23830  |                  Exit Function                   ||23785  |                  Exit Function                   
23831  |                End If                            ||23786  |                End If                            
23832  |                '外部委託顧問料通貨→JPYへレート換||23787  |                '外部委託顧問料通貨→JPYへレート換
23833  |                dblValueIn = dblValueIn * ddblExch||23788  |                dblValueIn = dblValueIn * ddblExch
23834  |            End If                                ||23789  |            End If                                
23835  |                                                  ||23790  |                                                  
23836  |        End Select                                ||23791  |        End Select                                
23837  |        '@@@@@ 支払に換算 @@@@@                   ||23792  |        '@@@@@ 支払に換算 @@@@@                   
23838  |        Call sbGetRoundValue(dblValueIn)          ||23793  |        Call sbGetRoundValue(dblValueIn)          
23839  |        mstrMonthlyPayCom = dblValueOut           ||23794  |        mstrMonthlyPayCom = dblValueOut           
23840  |                                                  ||23795  |                                                  
23841  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||23796  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
23842  |            'TTMレート                            ||23797  |            'TTMレート                            
23843  |            '文言の冗長化でピリオド及び、名称を二 ||23798  |            '文言の冗長化でピリオド及び、名称を二 
23844  |'                .Cells(47, 19).Value = sWord43   ||23799  |'                .Cells(47, 19).Value = sWord43   
23845  |'                .Cells(47, 33).NumberFormatLocal ||23800  |'                .Cells(47, 33).NumberFormatLocal 
23846  |'                .Cells(47, 33).Value = Format(ddb||23801  |'                .Cells(47, 33).Value = Format(ddb
23847  |'                .Cells(47, 33).HorizontalAlignmen||23802  |'                .Cells(47, 33).HorizontalAlignmen
23848  |'                .Cells(47, 34).Value = sWord44   ||23803  |'                .Cells(47, 34).Value = sWord44   
23849  |            .Cells(47, 21).Value = sWord43        ||23804  |            .Cells(47, 21).Value = sWord43        
23850  |            .Cells(47, 35).NumberFormatLocal = "@"||23805  |            .Cells(47, 35).NumberFormatLocal = "@"
23851  |            .Cells(47, 35).Value = Format(ddblExch||23806  |            .Cells(47, 35).Value = Format(ddblExch
23852  |            .Cells(47, 35).HorizontalAlignment = x||23807  |            .Cells(47, 35).HorizontalAlignment = x
23853  |            .Cells(47, 36).Value = sWord44        ||23808  |            .Cells(47, 36).Value = sWord44        
23854  |        End If                                    ||23809  |        End If                                    
23855  |                                                  ||23810  |                                                  
23856  |        '支払額                                   ||23811  |        '支払額                                   
23857  |        .Cells(48, 2).Value = sWord46a            ||23812  |        .Cells(48, 2).Value = sWord46a            
23858  |        '文言の冗長化でピリオド及び、名称を二列右 ||23813  |        '文言の冗長化でピリオド及び、名称を二列右 
23859  |'            .Cells(48, 11).Value = sWord19       ||23814  |'            .Cells(48, 11).Value = sWord19       
23860  |        .Cells(48, 13).Value = sWord19            ||23815  |        .Cells(48, 13).Value = sWord19            
23861  |                                                  ||23816  |                                                  
23862  |        '税抜金額(月別支払顧問料の累計)           ||23817  |        '税抜金額(月別支払顧問料の累計)           
23863  |        '文言の冗長化でピリオド及び、名称を二列右 ||23818  |        '文言の冗長化でピリオド及び、名称を二列右 
23864  |'            .Cells(48, 29).NumberFormatLocal = "@||23819  |'            .Cells(48, 29).NumberFormatLocal = "@
23865  |'            .Cells(48, 29).Value = CStr(Format(ms||23820  |'            .Cells(48, 29).Value = CStr(Format(ms
23866  |'            .Cells(48, 29).HorizontalAlignment = ||23821  |'            .Cells(48, 29).HorizontalAlignment = 
23867  |'            .Cells(48, 32).Value = sYena         ||23822  |'            .Cells(48, 32).Value = sYena         
23868  |        .Cells(48, 31).NumberFormatLocal = "@"    ||23823  |        .Cells(48, 31).NumberFormatLocal = "@"    
23869  |        .Cells(48, 31).Value = CStr(Format(mstrMon||23824  |        .Cells(48, 31).Value = CStr(Format(mstrMon
23870  |        .Cells(48, 31).HorizontalAlignment = xlRig||23825  |        .Cells(48, 31).HorizontalAlignment = xlRig
23871  |        .Cells(48, 34).Value = sYena              ||23826  |        .Cells(48, 34).Value = sYena              
23872  |                                                  ||23827  |                                                  
23873  |        '消費税計算有無：「有り」の場合のみ、消費 ||23828  |        '消費税計算有無：「有り」の場合のみ、消費 
23874  |        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc_||23829  |        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc_
23875  |            '(消費税XX%)                          ||23830  |            '(消費税XX%)                          
23876  |            '文言の冗長化でピリオド及び、名称を二 ||23831  |            '文言の冗長化でピリオド及び、名称を二 
23877  |'            iSyouhizei = ddblconsumption_tax     ||23832  |'            iSyouhizei = ddblconsumption_tax     
23878  |'            .Cells(49, 32).Value = sWord22a & iSy||23833  |'            .Cells(49, 32).Value = sWord22a & iSy
23879  |'            dblValueIn = mstrMonthlyPayCom * iSyo||23834  |'            dblValueIn = mstrMonthlyPayCom * iSyo
23880  |            iSyouhizei = ddblconsumption_tax      ||23835  |            iSyouhizei = ddblconsumption_tax      
23881  |            .Cells(49, 34).Value = sWord22a & iSyo||23836  |            .Cells(49, 34).Value = sWord22a & iSyo
23882  |            dblValueIn = mstrMonthlyPayCom * iSyou||23837  |            dblValueIn = mstrMonthlyPayCom * iSyou
23883  |            Call sbGetRoundValueTax(dblValueIn)   ||23838  |            Call sbGetRoundValueTax(dblValueIn)   
23884  |            lTaxNum = dblValueOut                 ||23839  |            lTaxNum = dblValueOut                 
23885  |            '文言の冗長化でピリオド及び、名称を二 ||23840  |            '文言の冗長化でピリオド及び、名称を二 
23886  |'            .Cells(49, 29).NumberFormatLocal = "@||23841  |'            .Cells(49, 29).NumberFormatLocal = "@
23887  |'            .Cells(49, 29).Value = CStr(Format((l||23842  |'            .Cells(49, 29).Value = CStr(Format((l
23888  |'            .Cells(49, 29).HorizontalAlignment = ||23843  |'            .Cells(49, 29).HorizontalAlignment = 
23889  |            .Cells(49, 31).NumberFormatLocal = "@"||23844  |            .Cells(49, 31).NumberFormatLocal = "@"
23890  |            .Cells(49, 31).Value = CStr(Format((lT||23845  |            .Cells(49, 31).Value = CStr(Format((lT
23891  |            .Cells(49, 31).HorizontalAlignment = x||23846  |            .Cells(49, 31).HorizontalAlignment = x
23892  |            '合計(消費税＋月別支払顧問料の累計)   ||23847  |            '合計(消費税＋月別支払顧問料の累計)   
23893  |            '文言の冗長化でピリオド及び、名称を二 ||23848  |            '文言の冗長化でピリオド及び、名称を二 
23894  |'            .Cells(50, 13).Value = sWord24a      ||23849  |'            .Cells(50, 13).Value = sWord24a      
23895  |            .Cells(50, 15).Value = sWord24a       ||23850  |            .Cells(50, 15).Value = sWord24a       
23896  |            dblValueIn = lTaxNum + CCur(mstrMonthl||23851  |            dblValueIn = lTaxNum + CCur(mstrMonthl
23897  |            Call sbGetRoundValue(dblValueIn)      ||23852  |            Call sbGetRoundValue(dblValueIn)      
23898  |            lMonthlyPayCom = dblValueOut          ||23853  |            lMonthlyPayCom = dblValueOut          
23899  |            '文言の冗長化でピリオド及び、名称を二 ||23854  |            '文言の冗長化でピリオド及び、名称を二 
23900  |'            .Cells(50, 29).NumberFormatLocal = "@||23855  |'            .Cells(50, 29).NumberFormatLocal = "@
23901  |'            .Cells(50, 29).Value = CStr(Format(lM||23856  |'            .Cells(50, 29).Value = CStr(Format(lM
23902  |'            .Cells(50, 29).HorizontalAlignment = ||23857  |'            .Cells(50, 29).HorizontalAlignment = 
23903  |'            '円                                  ||23858  |'            '円                                  
23904  |'            .Cells(50, 32).Value = sYena         ||23859  |'            .Cells(50, 32).Value = sYena         
23905  |'            '下線                                ||23860  |'            '下線                                
23906  |            .Cells(50, 31).NumberFormatLocal = "@"||23861  |            .Cells(50, 31).NumberFormatLocal = "@"
23907  |            .Cells(50, 31).Value = CStr(Format(lMo||23862  |            .Cells(50, 31).Value = CStr(Format(lMo
23908  |            .Cells(50, 31).HorizontalAlignment = x||23863  |            .Cells(50, 31).HorizontalAlignment = x
23909  |            '円                                   ||23864  |            '円                                   
23910  |            .Cells(50, 34).Value = sYena          ||23865  |            .Cells(50, 34).Value = sYena          
23911  |            '下線                                 ||23866  |            '下線                                 
23912  |            '文言の冗長化でピリオド及び、名称を二 ||23867  |            '文言の冗長化でピリオド及び、名称を二 
23913  |'            With xlSheet.Range("M49:AL49").Border||23868  |'            With xlSheet.Range("M49:AL49").Border
23914  |'                .LineStyle = xlContinuous        ||23869  |'                .LineStyle = xlContinuous        
23915  |'                .Weight = xlThin                 ||23870  |'                .Weight = xlThin                 
23916  |'            End With                             ||23871  |'            End With                             
23917  |            With xlSheet.Range("O49:AN49").Borders||23872  |            With xlSheet.Range("O49:AN49").Borders
23918  |                .LineStyle = xlContinuous         ||23873  |                .LineStyle = xlContinuous         
23919  |                .Weight = xlThin                  ||23874  |                .Weight = xlThin                  
23920  |            End With                              ||23875  |            End With                              
23921  |        Else                                      ||23876  |        Else                                      
23922  |        End If                                    ||23877  |        End If                                    
23923  |                                                  ||23878  |                                                  
23924  |        '支払予定日                               ||23879  |        '支払予定日                               
23925  |        '文言の冗長化でピリオド及び、名称を二列右 ||23880  |        '文言の冗長化でピリオド及び、名称を二列右 
23926  |        .Cells(52, 2).Value = sWord13a            ||23881  |        .Cells(52, 2).Value = sWord13a            
23927  |'        .Cells(52, 11).Value = sWord19           ||23882  |'        .Cells(52, 11).Value = sWord19           
23928  |'        .Cells(52, 13).NumberFormatLocal = "@"   ||23883  |'        .Cells(52, 13).NumberFormatLocal = "@"   
23929  |'        .Cells(52, 13).Value = CStr(Format(Trim(m||23884  |'        .Cells(52, 13).Value = CStr(Format(Trim(m
23930  |        .Cells(52, 13).Value = sWord19            ||23885  |        .Cells(52, 13).Value = sWord19            
23931  |        .Cells(52, 15).NumberFormatLocal = "@"    ||23886  |        .Cells(52, 15).NumberFormatLocal = "@"    
23932  |        .Cells(52, 15).Value = CStr(Format(Trim(ms||23887  |        .Cells(52, 15).Value = CStr(Format(Trim(ms
23933  |                                                  ||23888  |                                                  
23934  |        '支払先                                   ||23889  |        '支払先                                   
23935  |        '文言の冗長化でピリオド及び、名称を二列右 ||23890  |        '文言の冗長化でピリオド及び、名称を二列右 
23936  |        .Cells(54, 2).Value = sWord12a            ||23891  |        .Cells(54, 2).Value = sWord12a            
23937  |'        .Cells(54, 11).Value = sWord19           ||23892  |'        .Cells(54, 11).Value = sWord19           
23938  |'        .Cells(54, 13).Value = gbuMGetUPDRec.N(lR||23893  |'        .Cells(54, 13).Value = gbuMGetUPDRec.N(lR
23939  |        .Cells(54, 13).Value = sWord19            ||23894  |        .Cells(54, 13).Value = sWord19            
23940  |        .Cells(54, 15).Value = gbuMGetUPDRec.N(lRe||23895  |        .Cells(54, 15).Value = gbuMGetUPDRec.N(lRe
23941  |                                                  ||23896  |                                                  
23942  |        '財務部                                   ||23897  |        '財務部                                   
23943  |        .Cells(60, 2).Value = sWord1a             ||23898  |        .Cells(60, 2).Value = sWord1a             
23944  |        .Cells(61, 2).Value = sWord2a             ||23899  |        .Cells(61, 2).Value = sWord2a             
23945  |                                                  ||23900  |                                                  
23946  |    End With                                      ||23901  |    End With                                      
23947  |                                                  ||23902  |                                                  
23948  |    '月末純資産(合計 上のライン)                  ||23903  |    '月末純資産(合計 上のライン)                  
23949  |    With xlSheet.Range("X39:AX40").Borders(xlInsid||23904  |    With xlSheet.Range("X39:AX40").Borders(xlInsid
23950  |        .LineStyle = xlContinuous                 ||23905  |        .LineStyle = xlContinuous                 
23951  |        .Weight = xlThin                          ||23906  |        .Weight = xlThin                          
23952  |    End With                                      ||23907  |    End With                                      
23953  |                                                  ||23908  |                                                  
23954  |    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract_||23909  |    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract_
23955  |    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||23910  |    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
23956  |                                                  ||23911  |                                                  
23957  |        '文言の冗長化でピリオド及び、名称を二列右 ||23912  |        '文言の冗長化でピリオド及び、名称を二列右 
23958  |'        xlSheet.Cells(13, 13).Value = _          ||23913  |'        xlSheet.Cells(13, 13).Value = _          
23959  |'            CStr(Format(dStart, "mmmm d , yyyy"))||23914  |'            CStr(Format(dStart, "mmmm d , yyyy"))
23960  |        xlSheet.Cells(13, 15).Value = _           ||23915  |        xlSheet.Cells(13, 15).Value = _           
23961  |            CStr(Format(dStart, "mmmm d , yyyy")) ||23916  |            CStr(Format(dStart, "mmmm d , yyyy")) 
23962  |    Else                                          ||23917  |    Else                                          
23963  |        '文言の冗長化でピリオド及び、名称を二列右 ||23918  |        '文言の冗長化でピリオド及び、名称を二列右 
23964  |'        xlSheet.Cells(13, 13).Value = _          ||23919  |'        xlSheet.Cells(13, 13).Value = _          
23965  |'            CStr(Format(dStart, "mmmm d , yyyy"))||23920  |'            CStr(Format(dStart, "mmmm d , yyyy"))
23966  |        xlSheet.Cells(13, 15).Value = _           ||23921  |        xlSheet.Cells(13, 15).Value = _           
23967  |            CStr(Format(dStart, "mmmm d , yyyy")) ||23922  |            CStr(Format(dStart, "mmmm d , yyyy")) 
23968  |    End If                                        ||23923  |    End If                                        
23969  |                                                  ||23924  |                                                  
23970  |    'A4印刷用に上2行を削除して、プレビュー範囲内に||23925  |    'A4印刷用に上2行を削除して、プレビュー範囲内に
23971  |    xlSheet.Rows("1:2").Delete Shift:=xlUp        ||23926  |    xlSheet.Rows("1:2").Delete Shift:=xlUp        
23972  |                                                  ||23927  |                                                  
23973  |'期中料率変更契約対応 START                       ||23928  |'期中料率変更契約対応 START                       
23974  |    '料率変更履歴票作成                           ||23929  |    '料率変更履歴票作成                           
23975  |    'RAFI対応 START                               ||23930  |    'RAFI対応 START                               
23976  |    '純資産の場合                                 ||23931  |    '純資産の場合                                 
23977  |    If msAssetFlg = "0" Then                      ||23932  |    If msAssetFlg = "0" Then                      
23978  |        Call sbExcelChgRateSheetEnglishOut( _     ||23933  |        Call sbExcelChgRateSheetEnglishOut( _     
23979  |                sGetAccCode, TotalRate, lRecIdx, d||23934  |                sGetAccCode, TotalRate, lRecIdx, d
23980  |    'マザー組入資産の場合                         ||23935  |    'マザー組入資産の場合                         
23981  |    Else                                          ||23936  |    Else                                          
23982  |        Call sbExcelChgRateSheetEnglishOut( _     ||23937  |        Call sbExcelChgRateSheetEnglishOut( _     
23983  |                msBabyAccountCode, TotalRate, lRec||23938  |                msBabyAccountCode, TotalRate, lRec
23984  |    End If                                        ||23939  |    End If                                        
23985  |    'RAFI対応 END                                 ||23940  |    'RAFI対応 END                                 
23986  |'期中料率変更契約対応 END                         ||23941  |'期中料率変更契約対応 END                         
23987  |                                                  ||23942  |                                                  
23988  |'=================================================||23943  |'=================================================
23989  |'== 　　　　日次NAV/日時時価総額の別表作成エリア  ||23944  |'== 　　　　日次NAV/日時時価総額の別表作成エリア  
23990  |'=================================================||23945  |'=================================================
23991  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||23946  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
23992  |                                                  ||23947  |                                                  
23993  |''NAV取得区分：日次NAV平均(休日有)または日次NAV平 ||23948  |''NAV取得区分：日次NAV平均(休日有)または日次NAV平 
23994  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||23949  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
23995  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||23950  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
23996  |    'NAV取得区分：日次NAV平均(休日有)、日次NAV平均||23951  |    'NAV取得区分：日次NAV平均(休日有)、日次NAV平均
23997  |    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag ||23952  |    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag 
23998  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||23953  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
23999  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||23954  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
24000  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||23955  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24001  |                                                  ||23956  |                                                  
24002  |        gTotalDnavCnt = 0                         ||23957  |        gTotalDnavCnt = 0                         
24003  |        J = 0                                     ||23958  |        J = 0                                     
24004  |        K = 0                                     ||23959  |        K = 0                                     
24005  |        'ループ終了フラグ初期化                   ||23960  |        'ループ終了フラグ初期化                   
24006  |        EndFlg = False                            ||23961  |        EndFlg = False                            
24007  |        SetPoint = 0                              ||23962  |        SetPoint = 0                              
24008  |        AddPoint = 0                              ||23963  |        AddPoint = 0                              
24009  |                                                  ||23964  |                                                  
24010  |        '＋２は合計行と平均行                     ||23965  |        '＋２は合計行と平均行                     
24011  |'        dintPage = (dlngCnt + 2) \ 108           ||23966  |'        dintPage = (dlngCnt + 2) \ 108           
24012  |'        dintAmari = (dlngCnt + 2) Mod 108        ||23967  |'        dintAmari = (dlngCnt + 2) Mod 108        
24013  |        '余白 + (料率数 × 2) + (料率数 - 1)      ||23968  |        '余白 + (料率数 × 2) + (料率数 - 1)      
24014  |        dintPage = (dlngCnt + 2 + 2 + ((UBound(gty||23969  |        dintPage = (dlngCnt + 2 + 2 + ((UBound(gty
24015  |        dintAmari = (dlngCnt + 2 + 2 + ((UBound(gt||23970  |        dintAmari = (dlngCnt + 2 + 2 + ((UBound(gt
24016  |                                                  ||23971  |                                                  
24017  |        If dintAmari <> 0 Then                    ||23972  |        If dintAmari <> 0 Then                    
24018  |            dintPage = dintPage + 1               ||23973  |            dintPage = dintPage + 1               
24019  |        End If                                    ||23974  |        End If                                    
24020  |                                                  ||23975  |                                                  
24021  |        For L = 1 To dintPage                     ||23976  |        For L = 1 To dintPage                     
24022  |                                                  ||23977  |                                                  
24023  |            xlBook.Worksheets.Add after:=xlBook.Sh||23978  |            xlBook.Worksheets.Add after:=xlBook.Sh
24024  |            gProcessCnt = gProcessCnt + 1         ||23979  |            gProcessCnt = gProcessCnt + 1         
24025  |            Set xlSheet = xlBook.Sheets(gProcessCn||23980  |            Set xlSheet = xlBook.Sheets(gProcessCn
24026  |                                                  ||23981  |                                                  
24027  |            'Excelフォーマットを調整              ||23982  |            'Excelフォーマットを調整              
24028  |            xlSheet.Cells.ColumnWidth = 1         ||23983  |            xlSheet.Cells.ColumnWidth = 1         
24029  |            xlSheet.Cells.Font.Size = 11          ||23984  |            xlSheet.Cells.Font.Size = 11          
24030  |            'シート名を設定(日次NAV一覧**)        ||23985  |            'シート名を設定(日次NAV一覧**)        
24031  |                                                  ||23986  |                                                  
24032  |            'RAFI対応 START                       ||23987  |            'RAFI対応 START                       
24033  |            '純資産の場合                         ||23988  |            '純資産の場合                         
24034  |            If msAssetFlg = "0" Then              ||23989  |            If msAssetFlg = "0" Then              
24035  |                If dstrOldAccCode = sGetAccCode Th||23990  |                If dstrOldAccCode = sGetAccCode Th
24036  |                    gTotalDnavCnt = gTotalDnavCnt ||23991  |                    gTotalDnavCnt = gTotalDnavCnt 
24037  |                Else                              ||23992  |                Else                              
24038  |                    gTotalDnavCnt = 1             ||23993  |                    gTotalDnavCnt = 1             
24039  |                    dstrOldAccCode = sGetAccCode  ||23994  |                    dstrOldAccCode = sGetAccCode  
24040  |                End If                            ||23995  |                End If                            
24041  |            'マザー組入資産の場合                 ||23996  |            'マザー組入資産の場合                 
24042  |            Else                                  ||23997  |            Else                                  
24043  |                If dstrOldAccCode = msBabyAccountC||23998  |                If dstrOldAccCode = msBabyAccountC
24044  |                    gTotalDnavCnt = gTotalDnavCnt ||23999  |                    gTotalDnavCnt = gTotalDnavCnt 
24045  |                Else                              ||24000  |                Else                              
24046  |                    gTotalDnavCnt = 1             ||24001  |                    gTotalDnavCnt = 1             
24047  |                    dstrOldAccCode = msBabyAccount||24002  |                    dstrOldAccCode = msBabyAccount
24048  |                End If                            ||24003  |                End If                            
24049  |            End If                                ||24004  |            End If                                
24050  |            'RAFI対応 END                         ||24005  |            'RAFI対応 END                         
24051  |                                                  ||24006  |                                                  
24052  |            'gTotalCnt = gTotalCnt + 1            ||24007  |            'gTotalCnt = gTotalCnt + 1            
24053  |            'RAFI対応 START                       ||24008  |            'RAFI対応 START                       
24054  |            '純資産の場合                         ||24009  |            '純資産の場合                         
24055  |            If msAssetFlg = "0" Then              ||24010  |            If msAssetFlg = "0" Then              
24056  |                '複数ページの場合                 ||24011  |                '複数ページの場合                 
24057  |                If dintPage > 1 Then              ||24012  |                If dintPage > 1 Then              
24058  |                    xlBook.Sheets(gProcessCnt).Nam||24013  |                    xlBook.Sheets(gProcessCnt).Nam
24059  |                Else                              ||24014  |                Else                              
24060  |                    xlBook.Sheets(gProcessCnt).Nam||24015  |                    xlBook.Sheets(gProcessCnt).Nam
24061  |                End If                            ||24016  |                End If                            
24062  |            'マザー組入資産の場合                 ||24017  |            'マザー組入資産の場合                 
24063  |            Else                                  ||24018  |            Else                                  
24064  |                '複数ページの場合                 ||24019  |                '複数ページの場合                 
24065  |                If dintPage > 1 Then              ||24020  |                If dintPage > 1 Then              
24066  |                    xlBook.Sheets(gProcessCnt).Nam||24021  |                    xlBook.Sheets(gProcessCnt).Nam
24067  |                Else                              ||24022  |                Else                              
24068  |                    xlBook.Sheets(gProcessCnt).Nam||24023  |                    xlBook.Sheets(gProcessCnt).Nam
24069  |                End If                            ||24024  |                End If                            
24070  |            End If                                ||24025  |            End If                                
24071  |            'RAFI対応 END                         ||24026  |            'RAFI対応 END                         
24072  |                                                  ||24027  |                                                  
24073  |            'シートの余白を設定                   ||24028  |            'シートの余白を設定                   
24074  |            xlSheet.PageSetup.TopMargin = Applicat||24029  |            xlSheet.PageSetup.TopMargin = Applicat
24075  |            xlSheet.PageSetup.BottomMargin = Appli||24030  |            xlSheet.PageSetup.BottomMargin = Appli
24076  |            xlSheet.PageSetup.LeftMargin = Applica||24031  |            xlSheet.PageSetup.LeftMargin = Applica
24077  |            xlSheet.PageSetup.RightMargin = Applic||24032  |            xlSheet.PageSetup.RightMargin = Applic
24078  |                                                  ||24033  |                                                  
24079  |            DoEvents                              ||24034  |            DoEvents                              
24080  |                                                  ||24035  |                                                  
24081  |            With xlSheet                          ||24036  |            With xlSheet                          
24082  |                '題目                             ||24037  |                '題目                             
24083  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24038  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24084  |                '取得NAV区分が4:日次時価総額平均の||24039  |                '取得NAV区分が4:日次時価総額平均の
24085  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||24040  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
24086  |                    .Cells(5, 1).Value = sWord68a ||24041  |                    .Cells(5, 1).Value = sWord68a 
24087  |                Else                              ||24042  |                Else                              
24088  |                    .Cells(5, 1).Value = sWord47a ||24043  |                    .Cells(5, 1).Value = sWord47a 
24089  |                End If                            ||24044  |                End If                            
24090  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24045  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24091  |                .Cells(5, 1).Font.Size = 14       ||24046  |                .Cells(5, 1).Font.Size = 14       
24092  |                .Range("A5:BG5").HorizontalAlignme||24047  |                .Range("A5:BG5").HorizontalAlignme
24093  |                '出力日付                         ||24048  |                '出力日付                         
24094  |                If RTrim(txtSysOutDate.Text) = "" ||24049  |                If RTrim(txtSysOutDate.Text) = "" 
24095  |                    .Cells(3, 50).NumberFormatLoca||24050  |                    .Cells(3, 50).NumberFormatLoca
24096  |                    .Cells(3, 50).Value = sWord34a||24051  |                    .Cells(3, 50).Value = sWord34a
24097  |                    .Cells(3, 50).HorizontalAlignm||24052  |                    .Cells(3, 50).HorizontalAlignm
24098  |                Else                              ||24053  |                Else                              
24099  |                    .Cells(3, 43).NumberFormatLoca||24054  |                    .Cells(3, 43).NumberFormatLoca
24100  |                    .Cells(3, 43).Value = CStr(For||24055  |                    .Cells(3, 43).Value = CStr(For
24101  |                End If                            ||24056  |                End If                            
24102  |                'ファンド名                       ||24057  |                'ファンド名                       
24103  |                .Cells(6, 2).Value = sWord4a      ||24058  |                .Cells(6, 2).Value = sWord4a      
24104  |                .Cells(6, 11).Value = sWord19     ||24059  |                .Cells(6, 11).Value = sWord19     
24105  |                .Cells(6, 13).Value = gbuMGetUPDRe||24060  |                .Cells(6, 13).Value = gbuMGetUPDRe
24106  |                'ファンドコード                   ||24061  |                'ファンドコード                   
24107  |                .Cells(7, 2).Value = sWord4_2a    ||24062  |                .Cells(7, 2).Value = sWord4_2a    
24108  |                .Cells(7, 11).Value = sWord19     ||24063  |                .Cells(7, 11).Value = sWord19     
24109  |                .Cells(7, 13).NumberFormatLocal = ||24064  |                .Cells(7, 13).NumberFormatLocal = 
24110  |                'RAFI対応 START                   ||24065  |                'RAFI対応 START                   
24111  |                '純資産の場合                     ||24066  |                '純資産の場合                     
24112  |                If msAssetFlg = "0" Then          ||24067  |                If msAssetFlg = "0" Then          
24113  |                    .Cells(7, 13).Value = sGetAccC||24068  |                    .Cells(7, 13).Value = sGetAccC
24114  |                'マザー組入資産の場合             ||24069  |                'マザー組入資産の場合             
24115  |                Else                              ||24070  |                Else                              
24116  |                    .Cells(7, 13).Value = msBabyAc||24071  |                    .Cells(7, 13).Value = msBabyAc
24117  |                End If                            ||24072  |                End If                            
24118  |                'RAFI対応 END                     ||24073  |                'RAFI対応 END                     
24119  |                '計算期間                         ||24074  |                '計算期間                         
24120  |                '文言変更                         ||24075  |                '文言変更                         
24121  |'                .Cells(8, 2).Value = sWord5a     ||24076  |'                .Cells(8, 2).Value = sWord5a     
24122  |                .Cells(8, 2).Value = sWord59a     ||24077  |                .Cells(8, 2).Value = sWord59a     
24123  |                .Cells(8, 11).Value = sWord19     ||24078  |                .Cells(8, 11).Value = sWord19     
24124  |                                                  ||24079  |                                                  
24125  |                If Mid(gbuMGetUPDRec.N(lRecIdx).MG||24080  |                If Mid(gbuMGetUPDRec.N(lRecIdx).MG
24126  |                And gbuMGetUPDRec.N(lRecIdx).MGET_||24081  |                And gbuMGetUPDRec.N(lRecIdx).MGET_
24127  |                    .Cells(8, 13).Value = _       ||24082  |                    .Cells(8, 13).Value = _       
24128  |                        CStr(Format(dStart, "mmmm ||24083  |                        CStr(Format(dStart, "mmmm 
24129  |                Else                              ||24084  |                Else                              
24130  |                    .Cells(8, 13).Value = _       ||24085  |                    .Cells(8, 13).Value = _       
24131  |                        CStr(Format(dStart, "mmmm ||24086  |                        CStr(Format(dStart, "mmmm 
24132  |                End If                            ||24087  |                End If                            
24133  |                                                  ||24088  |                                                  
24134  |                '日付                             ||24089  |                '日付                             
24135  |                .Cells(10, 3).Value = sWord7a     ||24090  |                .Cells(10, 3).Value = sWord7a     
24136  |                .Range("C10:N10").HorizontalAlignm||24091  |                .Range("C10:N10").HorizontalAlignm
24137  |                '純資産                           ||24092  |                '純資産                           
24138  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24093  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24139  |                '取得NAV区分が4:日次時価総額平均の||24094  |                '取得NAV区分が4:日次時価総額平均の
24140  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||24095  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
24141  |                    .Cells(10, 15).Value = sWord64||24096  |                    .Cells(10, 15).Value = sWord64
24142  |                Else                              ||24097  |                Else                              
24143  |                    .Cells(10, 15).Value = sWord8a||24098  |                    .Cells(10, 15).Value = sWord8a
24144  |                End If                            ||24099  |                End If                            
24145  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24100  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24146  |                .Range("O10:AC10").HorizontalAlign||24101  |                .Range("O10:AC10").HorizontalAlign
24147  |                '日付                             ||24102  |                '日付                             
24148  |                .Cells(10, 31).Value = sWord7a    ||24103  |                .Cells(10, 31).Value = sWord7a    
24149  |                .Range("AE10:AP10").HorizontalAlig||24104  |                .Range("AE10:AP10").HorizontalAlig
24150  |                '純資産                           ||24105  |                '純資産                           
24151  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24106  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24152  |                '取得NAV区分が4:日次時価総額平均の||24107  |                '取得NAV区分が4:日次時価総額平均の
24153  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||24108  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
24154  |                    .Cells(10, 43).Value = sWord64||24109  |                    .Cells(10, 43).Value = sWord64
24155  |                Else                              ||24110  |                Else                              
24156  |                    .Cells(10, 43).Value = sWord8a||24111  |                    .Cells(10, 43).Value = sWord8a
24157  |                End If                            ||24112  |                End If                            
24158  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24113  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24159  |                .Range("AQ10:BE10").HorizontalAlig||24114  |                .Range("AQ10:BE10").HorizontalAlig
24160  |                '日付＆NAV                        ||24115  |                '日付＆NAV                        
24161  |                Select Case L                     ||24116  |                Select Case L                     
24162  |                    Case 1                        ||24117  |                    Case 1                        
24163  |                        dintPageIni = 1           ||24118  |                        dintPageIni = 1           
24164  |                    Case Else                     ||24119  |                    Case Else                     
24165  |                        dintPageIni = dintPageIni ||24120  |                        dintPageIni = dintPageIni 
24166  |                End Select                        ||24121  |                End Select                        
24167  |                For dintFor = dintPageIni To dlngC||24122  |                For dintFor = dintPageIni To dlngC
24168  |                    If J < 54 Then                ||24123  |                    If J < 54 Then                
24169  |                        If dintFor = dlngCnt + 1 T||24124  |                        If dintFor = dlngCnt + 1 T
24170  |                            '合計                 ||24125  |                            '合計                 
24171  |                            .Cells(11 + J, 3).Valu||24126  |                            .Cells(11 + J, 3).Valu
24172  |                            'NAV                  ||24127  |                            'NAV                  
24173  |                            .Cells(11 + J, 28).Num||24128  |                            .Cells(11 + J, 28).Num
24174  |                            If gbuMGetUPDRec.N(lRe||24129  |                            If gbuMGetUPDRec.N(lRe
24175  |                                .Cells(11 + J, 28)||24130  |                                .Cells(11 + J, 28)
24176  |                            Else                  ||24131  |                            Else                  
24177  |                                .Cells(11 + J, 28)||24132  |                                .Cells(11 + J, 28)
24178  |                            End If                ||24133  |                            End If                
24179  |                            .Cells(11 + J, 28).Hor||24134  |                            .Cells(11 + J, 28).Hor
24180  |                        End If                    ||24135  |                        End If                    
24181  |                                                  ||24136  |                                                  
24182  |                            If dintFor = dlngCnt +||24137  |                            If dintFor = dlngCnt +
24183  |                                '平均             ||24138  |                                '平均             
24184  |                                .Cells(11 + J, 3).||24139  |                                .Cells(11 + J, 3).
24185  |                                'NAV              ||24140  |                                'NAV              
24186  |                                .Cells(11 + J, 28)||24141  |                                .Cells(11 + J, 28)
24187  |                                If gbuMGetUPDRec.N||24142  |                                If gbuMGetUPDRec.N
24188  |                                    .Cells(11 + J,||24143  |                                    .Cells(11 + J,
24189  |                                Else              ||24144  |                                Else              
24190  |                                    .Cells(11 + J,||24145  |                                    .Cells(11 + J,
24191  |                                End If            ||24146  |                                End If            
24192  |                                .Cells(11 + J, 28)||24147  |                                .Cells(11 + J, 28)
24193  |                            End If                ||24148  |                            End If                
24194  |                                                  ||24149  |                                                  
24195  |                        If dintFor < dlngCnt + 1 T||24150  |                        If dintFor < dlngCnt + 1 T
24196  |                            '日付                 ||24151  |                            '日付                 
24197  |                            .Cells(11 + J, 4).Numb||24152  |                            .Cells(11 + J, 4).Numb
24198  |                            .Cells(11 + J, 4).Valu||24153  |                            .Cells(11 + J, 4).Valu
24199  |                                        CDate(gstr||24154  |                                        CDate(gstr
24200  |                            'NAV                  ||24155  |                            'NAV                  
24201  |                            .Cells(11 + J, 28).Num||24156  |                            .Cells(11 + J, 28).Num
24202  |                            If gbuMGetUPDRec.N(lRe||24157  |                            If gbuMGetUPDRec.N(lRe
24203  |                                .Cells(11 + J, 28)||24158  |                                .Cells(11 + J, 28)
24204  |                            Else                  ||24159  |                            Else                  
24205  |                                .Cells(11 + J, 28)||24160  |                                .Cells(11 + J, 28)
24206  |                            End If                ||24161  |                            End If                
24207  |                            .Cells(11 + J, 28).Hor||24162  |                            .Cells(11 + J, 28).Hor
24208  |                        End If                    ||24163  |                        End If                    
24209  |                    Else                          ||24164  |                    Else                          
24210  |                        If dintFor = dlngCnt + 1 T||24165  |                        If dintFor = dlngCnt + 1 T
24211  |                            '合計                 ||24166  |                            '合計                 
24212  |                            .Cells(11 + K, 31).Val||24167  |                            .Cells(11 + K, 31).Val
24213  |                            'NAV                  ||24168  |                            'NAV                  
24214  |                            .Cells(11 + K, 56).Num||24169  |                            .Cells(11 + K, 56).Num
24215  |                            If gbuMGetUPDRec.N(lRe||24170  |                            If gbuMGetUPDRec.N(lRe
24216  |                                .Cells(11 + K, 56)||24171  |                                .Cells(11 + K, 56)
24217  |                            Else                  ||24172  |                            Else                  
24218  |                                .Cells(11 + K, 56)||24173  |                                .Cells(11 + K, 56)
24219  |                            End If                ||24174  |                            End If                
24220  |                            .Cells(11 + K, 56).Hor||24175  |                            .Cells(11 + K, 56).Hor
24221  |                        End If                    ||24176  |                        End If                    
24222  |                                                  ||24177  |                                                  
24223  |                            If dintFor = dlngCnt +||24178  |                            If dintFor = dlngCnt +
24224  |                                '平均             ||24179  |                                '平均             
24225  |                                .Cells(11 + K, 31)||24180  |                                .Cells(11 + K, 31)
24226  |                                'NAV              ||24181  |                                'NAV              
24227  |                                .Cells(11 + K, 56)||24182  |                                .Cells(11 + K, 56)
24228  |                                If gbuMGetUPDRec.N||24183  |                                If gbuMGetUPDRec.N
24229  |                                    .Cells(11 + K,||24184  |                                    .Cells(11 + K,
24230  |                                Else              ||24185  |                                Else              
24231  |                                    .Cells(11 + K,||24186  |                                    .Cells(11 + K,
24232  |                                End If            ||24187  |                                End If            
24233  |                                .Cells(11 + K, 56)||24188  |                                .Cells(11 + K, 56)
24234  |                            End If                ||24189  |                            End If                
24235  |                                                  ||24190  |                                                  
24236  |                        If dintFor < dlngCnt + 1 T||24191  |                        If dintFor < dlngCnt + 1 T
24237  |                            '日付                 ||24192  |                            '日付                 
24238  |                                                  ||24193  |                                                  
24239  |                            .Cells(11 + K, 32).Num||24194  |                            .Cells(11 + K, 32).Num
24240  |                            .Cells(11 + K, 32).Val||24195  |                            .Cells(11 + K, 32).Val
24241  |                                        CDate(gstr||24196  |                                        CDate(gstr
24242  |                            'NAV                  ||24197  |                            'NAV                  
24243  |                            .Cells(11 + K, 56).Num||24198  |                            .Cells(11 + K, 56).Num
24244  |                            If gbuMGetUPDRec.N(lRe||24199  |                            If gbuMGetUPDRec.N(lRe
24245  |                                .Cells(11 + K, 56)||24200  |                                .Cells(11 + K, 56)
24246  |                            Else                  ||24201  |                            Else                  
24247  |                                .Cells(11 + K, 56)||24202  |                                .Cells(11 + K, 56)
24248  |                            End If                ||24203  |                            End If                
24249  |                            .Cells(11 + K, 56).Hor||24204  |                            .Cells(11 + K, 56).Hor
24250  |                        End If                    ||24205  |                        End If                    
24251  |                        K = K + 1                 ||24206  |                        K = K + 1                 
24252  |                        If K > 53 Then            ||24207  |                        If K > 53 Then            
24253  |                            J = 0                 ||24208  |                            J = 0                 
24254  |                            K = 0                 ||24209  |                            K = 0                 
24255  |                            Exit For              ||24210  |                            Exit For              
24256  |                        End If                    ||24211  |                        End If                    
24257  |                    End If                        ||24212  |                    End If                        
24258  |                    J = J + 1                     ||24213  |                    J = J + 1                     
24259  |                    'ループ終了したらフラグをON   ||24214  |                    'ループ終了したらフラグをON   
24260  |                    If dintFor = (dlngCnt + 2) The||24215  |                    If dintFor = (dlngCnt + 2) The
24261  |                        EndFlg = True             ||24216  |                        EndFlg = True             
24262  |                        '平均の終了行の次行を取得 ||24217  |                        '平均の終了行の次行を取得 
24263  |                        If K = 0 Then             ||24218  |                        If K = 0 Then             
24264  |                            intRange = J + 11     ||24219  |                            intRange = J + 11     
24265  |                            strRange = "J"        ||24220  |                            strRange = "J"        
24266  |                        ElseIf K <> 0 Then        ||24221  |                        ElseIf K <> 0 Then        
24267  |                            intRange = K + 11     ||24222  |                            intRange = K + 11     
24268  |                            strRange = "K"        ||24223  |                            strRange = "K"        
24269  |                        Else                      ||24224  |                        Else                      
24270  |                            intRange = 11         ||24225  |                            intRange = 11         
24271  |                            strRange = "J"        ||24226  |                            strRange = "J"        
24272  |                        End If                    ||24227  |                        End If                    
24273  |                        J = 0                     ||24228  |                        J = 0                     
24274  |                        K = 0                     ||24229  |                        K = 0                     
24275  |                    End If                        ||24230  |                    End If                        
24276  |                Next dintFor                      ||24231  |                Next dintFor                      
24277  |                                                  ||24232  |                                                  
24278  |            End With                              ||24233  |            End With                              
24279  |            '日次NAV平均の出力が終了したら料率別平||24234  |            '日次NAV平均の出力が終了したら料率別平
24280  |            If EndFlg = True Then                 ||24235  |            If EndFlg = True Then                 
24281  |                With xlSheet                      ||24236  |                With xlSheet                      
24282  |                    For dintFor = SetPoint + AddPo||24237  |                    For dintFor = SetPoint + AddPo
24283  |                        If dintFor = 0 Then       ||24238  |                        If dintFor = 0 Then       
24284  |                            If strRange = "J" Then||24239  |                            If strRange = "J" Then
24285  |                                If intRange = 11 T||24240  |                                If intRange = 11 T
24286  |                                    '余白無し     ||24241  |                                    '余白無し     
24287  |                                    '日付         ||24242  |                                    '日付         
24288  |                                    .Cells(intRang||24243  |                                    .Cells(intRang
24289  |                                    Format(gstrDat||24244  |                                    Format(gstrDat
24290  |                                    sWord60 & Form||24245  |                                    sWord60 & Form
24291  |                                    J = J + 1     ||24246  |                                    J = J + 1     
24292  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24247  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24293  |                                    '取得NAV区分が||24248  |                                    '取得NAV区分が
24294  |                                    If gbuMGetUPDR||24249  |                                    If gbuMGetUPDR
24295  |                                        .Cells(int||24250  |                                        .Cells(int
24296  |                                    Else          ||24251  |                                    Else          
24297  |                                        .Cells(int||24252  |                                        .Cells(int
24298  |                                    End If        ||24253  |                                    End If        
24299  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24254  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24300  |                                    dblValueIn = g||24255  |                                    dblValueIn = g
24301  |                                    .Cells(intRang||24256  |                                    .Cells(intRang
24302  |                                    '平均純資産   ||24257  |                                    '平均純資産   
24303  |                                    dblValueIn = g||24258  |                                    dblValueIn = g
24304  |                                    If gtypOtherCo||24259  |                                    If gtypOtherCo
24305  |                                          Call sbG||24260  |                                          Call sbG
24306  |                                    Else          ||24261  |                                    Else          
24307  |                                          Call sbG||24262  |                                          Call sbG
24308  |                                    End If        ||24263  |                                    End If        
24309  |                                    If gtypOtherCo||24264  |                                    If gtypOtherCo
24310  |                                        .Cells(int||24265  |                                        .Cells(int
24311  |                                    Else          ||24266  |                                    Else          
24312  |                                        .Cells(int||24267  |                                        .Cells(int
24313  |                                    End If        ||24268  |                                    End If        
24314  |                                    'If gtypOtherC||24269  |                                    'If gtypOtherC
24315  |                                    '    .Cells(in||24270  |                                    '    .Cells(in
24316  |                                    'Else         ||24271  |                                    'Else         
24317  |                                    '    .Cells(in||24272  |                                    '    .Cells(in
24318  |                                    'End If       ||24273  |                                    'End If       
24319  |                                    .Cells(intRang||24274  |                                    .Cells(intRang
24320  |                                    strRange = "J"||24275  |                                    strRange = "J"
24321  |                                    intRange = int||24276  |                                    intRange = int
24322  |                                ElseIf intRange <>||24277  |                                ElseIf intRange <>
24323  |                                    '余白有り     ||24278  |                                    '余白有り     
24324  |                                    J = J + 2     ||24279  |                                    J = J + 2     
24325  |                                    '日付         ||24280  |                                    '日付         
24326  |                                    .Cells(intRang||24281  |                                    .Cells(intRang
24327  |                                    Format(gstrDat||24282  |                                    Format(gstrDat
24328  |                                    sWord60 & Form||24283  |                                    sWord60 & Form
24329  |                                    J = J + 1     ||24284  |                                    J = J + 1     
24330  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24285  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24331  |                                    '取得NAV区分が||24286  |                                    '取得NAV区分が
24332  |                                    If gbuMGetUPDR||24287  |                                    If gbuMGetUPDR
24333  |                                        .Cells(int||24288  |                                        .Cells(int
24334  |                                    Else          ||24289  |                                    Else          
24335  |                                        .Cells(int||24290  |                                        .Cells(int
24336  |                                    End If        ||24291  |                                    End If        
24337  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24292  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24338  |                                    .Cells(intRang||24293  |                                    .Cells(intRang
24339  |                                    '平均純資産   ||24294  |                                    '平均純資産   
24340  |                                    dblValueIn = g||24295  |                                    dblValueIn = g
24341  |                                    If gtypOtherCo||24296  |                                    If gtypOtherCo
24342  |                                          Call sbG||24297  |                                          Call sbG
24343  |                                    Else          ||24298  |                                    Else          
24344  |                                          Call sbG||24299  |                                          Call sbG
24345  |                                    End If        ||24300  |                                    End If        
24346  |                                    If gtypOtherCo||24301  |                                    If gtypOtherCo
24347  |                                        .Cells(int||24302  |                                        .Cells(int
24348  |                                    Else          ||24303  |                                    Else          
24349  |                                        .Cells(int||24304  |                                        .Cells(int
24350  |                                    End If        ||24305  |                                    End If        
24351  |                                    'If gtypOtherC||24306  |                                    'If gtypOtherC
24352  |                                    '    .Cells(in||24307  |                                    '    .Cells(in
24353  |                                    'Else         ||24308  |                                    'Else         
24354  |                                    '    .Cells(in||24309  |                                    '    .Cells(in
24355  |                                    'End If       ||24310  |                                    'End If       
24356  |                                    .Cells(intRang||24311  |                                    .Cells(intRang
24357  |                                    strRange = "J"||24312  |                                    strRange = "J"
24358  |                                    intRange = int||24313  |                                    intRange = int
24359  |                                Else              ||24314  |                                Else              
24360  |                                    '余白無し     ||24315  |                                    '余白無し     
24361  |                                    '日付         ||24316  |                                    '日付         
24362  |                                    .Cells(11 + K,||24317  |                                    .Cells(11 + K,
24363  |                                    Format(gstrDat||24318  |                                    Format(gstrDat
24364  |                                    sWord60 & Form||24319  |                                    sWord60 & Form
24365  |                                    K = K + 1     ||24320  |                                    K = K + 1     
24366  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24321  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24367  |                                    '取得NAV区分が||24322  |                                    '取得NAV区分が
24368  |                                    If gbuMGetUPDR||24323  |                                    If gbuMGetUPDR
24369  |                                        .Cells(11 ||24324  |                                        .Cells(11 
24370  |                                    Else          ||24325  |                                    Else          
24371  |                                        .Cells(11 ||24326  |                                        .Cells(11 
24372  |                                    End If        ||24327  |                                    End If        
24373  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24328  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24374  |                                    .Cells(11 + K,||24329  |                                    .Cells(11 + K,
24375  |                                    '平均純資産   ||24330  |                                    '平均純資産   
24376  |                                    dblValueIn = g||24331  |                                    dblValueIn = g
24377  |                                    If gtypOtherCo||24332  |                                    If gtypOtherCo
24378  |                                          Call sbG||24333  |                                          Call sbG
24379  |                                    Else          ||24334  |                                    Else          
24380  |                                          Call sbG||24335  |                                          Call sbG
24381  |                                    End If        ||24336  |                                    End If        
24382  |                                    If gtypOtherCo||24337  |                                    If gtypOtherCo
24383  |                                        .Cells(11 ||24338  |                                        .Cells(11 
24384  |                                    Else          ||24339  |                                    Else          
24385  |                                        .Cells(11 ||24340  |                                        .Cells(11 
24386  |                                    End If        ||24341  |                                    End If        
24387  |                                    'If gtypOtherC||24342  |                                    'If gtypOtherC
24388  |                                    '    .Cells(11||24343  |                                    '    .Cells(11
24389  |                                    'Else         ||24344  |                                    'Else         
24390  |                                    '    .Cells(11||24345  |                                    '    .Cells(11
24391  |                                    'End If       ||24346  |                                    'End If       
24392  |                                    .Cells(11 + K,||24347  |                                    .Cells(11 + K,
24393  |                                    strRange = "K"||24348  |                                    strRange = "K"
24394  |                                    intRange = 11 ||24349  |                                    intRange = 11 
24395  |                                End If            ||24350  |                                End If            
24396  |                                J = 0             ||24351  |                                J = 0             
24397  |                                K = 0             ||24352  |                                K = 0             
24398  |                            'K                    ||24353  |                            'K                    
24399  |                            Else                  ||24354  |                            Else                  
24400  |                                If intRange = 11 T||24355  |                                If intRange = 11 T
24401  |                                    '余白無し     ||24356  |                                    '余白無し     
24402  |                                    '日付         ||24357  |                                    '日付         
24403  |                                    .Cells(intRang||24358  |                                    .Cells(intRang
24404  |                                    Format(gstrDat||24359  |                                    Format(gstrDat
24405  |                                    sWord60 & Form||24360  |                                    sWord60 & Form
24406  |                                    K = K + 1     ||24361  |                                    K = K + 1     
24407  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24362  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24408  |                                    '取得NAV区分が||24363  |                                    '取得NAV区分が
24409  |                                    If gbuMGetUPDR||24364  |                                    If gbuMGetUPDR
24410  |                                        .Cells(int||24365  |                                        .Cells(int
24411  |                                    Else          ||24366  |                                    Else          
24412  |                                        .Cells(int||24367  |                                        .Cells(int
24413  |                                    End If        ||24368  |                                    End If        
24414  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24369  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24415  |                                    .Cells(intRang||24370  |                                    .Cells(intRang
24416  |                                    '平均純資産   ||24371  |                                    '平均純資産   
24417  |                                    dblValueIn = g||24372  |                                    dblValueIn = g
24418  |                                    If gtypOtherCo||24373  |                                    If gtypOtherCo
24419  |                                          Call sbG||24374  |                                          Call sbG
24420  |                                    Else          ||24375  |                                    Else          
24421  |                                          Call sbG||24376  |                                          Call sbG
24422  |                                    End If        ||24377  |                                    End If        
24423  |                                    If gtypOtherCo||24378  |                                    If gtypOtherCo
24424  |                                        .Cells(int||24379  |                                        .Cells(int
24425  |                                    Else          ||24380  |                                    Else          
24426  |                                        .Cells(int||24381  |                                        .Cells(int
24427  |                                    End If        ||24382  |                                    End If        
24428  |                                    'If gtypOtherC||24383  |                                    'If gtypOtherC
24429  |                                    '    .Cells(in||24384  |                                    '    .Cells(in
24430  |                                    'Else         ||24385  |                                    'Else         
24431  |                                    '    .Cells(in||24386  |                                    '    .Cells(in
24432  |                                    'End If       ||24387  |                                    'End If       
24433  |                                    .Cells(intRang||24388  |                                    .Cells(intRang
24434  |                                    strRange = "K"||24389  |                                    strRange = "K"
24435  |                                    intRange = int||24390  |                                    intRange = int
24436  |                                ElseIf intRange <>||24391  |                                ElseIf intRange <>
24437  |                                    '余白有り     ||24392  |                                    '余白有り     
24438  |                                    K = K + 2     ||24393  |                                    K = K + 2     
24439  |                                    '日付         ||24394  |                                    '日付         
24440  |                                    .Cells(intRang||24395  |                                    .Cells(intRang
24441  |                                    Format(gstrDat||24396  |                                    Format(gstrDat
24442  |                                    sWord60 & Form||24397  |                                    sWord60 & Form
24443  |                                    K = K + 1     ||24398  |                                    K = K + 1     
24444  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24399  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24445  |                                    '取得NAV区分が||24400  |                                    '取得NAV区分が
24446  |                                    If gbuMGetUPDR||24401  |                                    If gbuMGetUPDR
24447  |                                        .Cells(int||24402  |                                        .Cells(int
24448  |                                    Else          ||24403  |                                    Else          
24449  |                                        .Cells(int||24404  |                                        .Cells(int
24450  |                                    End If        ||24405  |                                    End If        
24451  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24406  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24452  |                                    .Cells(intRang||24407  |                                    .Cells(intRang
24453  |                                    '平均純資産   ||24408  |                                    '平均純資産   
24454  |                                    dblValueIn = g||24409  |                                    dblValueIn = g
24455  |                                    If gtypOtherCo||24410  |                                    If gtypOtherCo
24456  |                                          Call sbG||24411  |                                          Call sbG
24457  |                                    Else          ||24412  |                                    Else          
24458  |                                          Call sbG||24413  |                                          Call sbG
24459  |                                    End If        ||24414  |                                    End If        
24460  |                                    If gtypOtherCo||24415  |                                    If gtypOtherCo
24461  |                                        .Cells(int||24416  |                                        .Cells(int
24462  |                                    Else          ||24417  |                                    Else          
24463  |                                        .Cells(int||24418  |                                        .Cells(int
24464  |                                    End If        ||24419  |                                    End If        
24465  |                                    'If gtypOtherC||24420  |                                    'If gtypOtherC
24466  |                                    '    .Cells(in||24421  |                                    '    .Cells(in
24467  |                                    'Else         ||24422  |                                    'Else         
24468  |                                    '    .Cells(in||24423  |                                    '    .Cells(in
24469  |                                    'End If       ||24424  |                                    'End If       
24470  |                                    .Cells(intRang||24425  |                                    .Cells(intRang
24471  |                                    strRange = "K"||24426  |                                    strRange = "K"
24472  |                                    intRange = int||24427  |                                    intRange = int
24473  |                                Else              ||24428  |                                Else              
24474  |                                    J = 0         ||24429  |                                    J = 0         
24475  |                                    K = 0         ||24430  |                                    K = 0         
24476  |                                    strRange = "J"||24431  |                                    strRange = "J"
24477  |                                    intRange = 11 ||24432  |                                    intRange = 11 
24478  |                                                  ||24433  |                                                  
24479  |                                    AddPoint = din||24434  |                                    AddPoint = din
24480  |                                    Exit For      ||24435  |                                    Exit For      
24481  |                                End If            ||24436  |                                End If            
24482  |                                J = 0             ||24437  |                                J = 0             
24483  |                                K = 0             ||24438  |                                K = 0             
24484  |                            End If                ||24439  |                            End If                
24485  |                        'ループ二回目以降         ||24440  |                        'ループ二回目以降         
24486  |                        Else                      ||24441  |                        Else                      
24487  |                            If strRange = "J" Then||24442  |                            If strRange = "J" Then
24488  |                                If intRange = 11 T||24443  |                                If intRange = 11 T
24489  |                                    '余白無し     ||24444  |                                    '余白無し     
24490  |                                    '日付         ||24445  |                                    '日付         
24491  |                                    .Cells(intRang||24446  |                                    .Cells(intRang
24492  |                                    Format(gstrDat||24447  |                                    Format(gstrDat
24493  |                                    sWord60 & Form||24448  |                                    sWord60 & Form
24494  |                                    J = J + 1     ||24449  |                                    J = J + 1     
24495  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24450  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24496  |                                    '取得NAV区分が||24451  |                                    '取得NAV区分が
24497  |                                    If gbuMGetUPDR||24452  |                                    If gbuMGetUPDR
24498  |                                        .Cells(int||24453  |                                        .Cells(int
24499  |                                    Else          ||24454  |                                    Else          
24500  |                                        .Cells(int||24455  |                                        .Cells(int
24501  |                                    End If        ||24456  |                                    End If        
24502  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24457  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24503  |                                    .Cells(intRang||24458  |                                    .Cells(intRang
24504  |                                    '平均純資産   ||24459  |                                    '平均純資産   
24505  |                                    dblValueIn = g||24460  |                                    dblValueIn = g
24506  |                                    If gtypOtherCo||24461  |                                    If gtypOtherCo
24507  |                                          Call sbG||24462  |                                          Call sbG
24508  |                                    Else          ||24463  |                                    Else          
24509  |                                          Call sbG||24464  |                                          Call sbG
24510  |                                    End If        ||24465  |                                    End If        
24511  |                                    If gtypOtherCo||24466  |                                    If gtypOtherCo
24512  |                                        .Cells(int||24467  |                                        .Cells(int
24513  |                                    Else          ||24468  |                                    Else          
24514  |                                        .Cells(int||24469  |                                        .Cells(int
24515  |                                    End If        ||24470  |                                    End If        
24516  |                                    'If gtypOtherC||24471  |                                    'If gtypOtherC
24517  |                                    '    .Cells(in||24472  |                                    '    .Cells(in
24518  |                                    'Else         ||24473  |                                    'Else         
24519  |                                    '    .Cells(in||24474  |                                    '    .Cells(in
24520  |                                    'End If       ||24475  |                                    'End If       
24521  |                                    .Cells(intRang||24476  |                                    .Cells(intRang
24522  |                                    strRange = "J"||24477  |                                    strRange = "J"
24523  |                                    intRange = int||24478  |                                    intRange = int
24524  |                                ElseIf intRange <>||24479  |                                ElseIf intRange <>
24525  |                                    '余白有り     ||24480  |                                    '余白有り     
24526  |                                    J = J + 1     ||24481  |                                    J = J + 1     
24527  |                                    '日付         ||24482  |                                    '日付         
24528  |                                    .Cells(intRang||24483  |                                    .Cells(intRang
24529  |                                    Format(gstrDat||24484  |                                    Format(gstrDat
24530  |                                    sWord60 & Form||24485  |                                    sWord60 & Form
24531  |                                    J = J + 1     ||24486  |                                    J = J + 1     
24532  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24487  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24533  |                                    '取得NAV区分が||24488  |                                    '取得NAV区分が
24534  |                                    If gbuMGetUPDR||24489  |                                    If gbuMGetUPDR
24535  |                                        .Cells(int||24490  |                                        .Cells(int
24536  |                                    Else          ||24491  |                                    Else          
24537  |                                        .Cells(int||24492  |                                        .Cells(int
24538  |                                    End If        ||24493  |                                    End If        
24539  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24494  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24540  |                                    .Cells(intRang||24495  |                                    .Cells(intRang
24541  |                                    '平均純資産   ||24496  |                                    '平均純資産   
24542  |                                    dblValueIn = g||24497  |                                    dblValueIn = g
24543  |                                    If gtypOtherCo||24498  |                                    If gtypOtherCo
24544  |                                          Call sbG||24499  |                                          Call sbG
24545  |                                    Else          ||24500  |                                    Else          
24546  |                                          Call sbG||24501  |                                          Call sbG
24547  |                                    End If        ||24502  |                                    End If        
24548  |                                    If gtypOtherCo||24503  |                                    If gtypOtherCo
24549  |                                        .Cells(int||24504  |                                        .Cells(int
24550  |                                    Else          ||24505  |                                    Else          
24551  |                                        .Cells(int||24506  |                                        .Cells(int
24552  |                                    End If        ||24507  |                                    End If        
24553  |                                    'If gtypOtherC||24508  |                                    'If gtypOtherC
24554  |                                    '    .Cells(in||24509  |                                    '    .Cells(in
24555  |                                    'Else         ||24510  |                                    'Else         
24556  |                                    '    .Cells(in||24511  |                                    '    .Cells(in
24557  |                                    'End If       ||24512  |                                    'End If       
24558  |                                    .Cells(intRang||24513  |                                    .Cells(intRang
24559  |                                    strRange = "J"||24514  |                                    strRange = "J"
24560  |                                    intRange = int||24515  |                                    intRange = int
24561  |                                Else              ||24516  |                                Else              
24562  |                                    '余白無し     ||24517  |                                    '余白無し     
24563  |                                    '日付         ||24518  |                                    '日付         
24564  |                                    .Cells(11 + K,||24519  |                                    .Cells(11 + K,
24565  |                                    Format(gstrDat||24520  |                                    Format(gstrDat
24566  |                                    sWord60 & Form||24521  |                                    sWord60 & Form
24567  |                                    K = K + 1     ||24522  |                                    K = K + 1     
24568  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24523  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24569  |                                    '取得NAV区分が||24524  |                                    '取得NAV区分が
24570  |                                    If gbuMGetUPDR||24525  |                                    If gbuMGetUPDR
24571  |                                        .Cells(11 ||24526  |                                        .Cells(11 
24572  |                                    Else          ||24527  |                                    Else          
24573  |                                        .Cells(11 ||24528  |                                        .Cells(11 
24574  |                                    End If        ||24529  |                                    End If        
24575  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24530  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24576  |                                    .Cells(11 + K,||24531  |                                    .Cells(11 + K,
24577  |                                    '平均純資産   ||24532  |                                    '平均純資産   
24578  |                                    dblValueIn = g||24533  |                                    dblValueIn = g
24579  |                                    If gtypOtherCo||24534  |                                    If gtypOtherCo
24580  |                                          Call sbG||24535  |                                          Call sbG
24581  |                                    Else          ||24536  |                                    Else          
24582  |                                          Call sbG||24537  |                                          Call sbG
24583  |                                    End If        ||24538  |                                    End If        
24584  |                                    If gtypOtherCo||24539  |                                    If gtypOtherCo
24585  |                                        .Cells(11 ||24540  |                                        .Cells(11 
24586  |                                    Else          ||24541  |                                    Else          
24587  |                                        .Cells(11 ||24542  |                                        .Cells(11 
24588  |                                    End If        ||24543  |                                    End If        
24589  |                                    'If gtypOtherC||24544  |                                    'If gtypOtherC
24590  |                                    '    .Cells(11||24545  |                                    '    .Cells(11
24591  |                                    'Else         ||24546  |                                    'Else         
24592  |                                    '    .Cells(11||24547  |                                    '    .Cells(11
24593  |                                    'End If       ||24548  |                                    'End If       
24594  |                                    .Cells(11 + K,||24549  |                                    .Cells(11 + K,
24595  |                                    strRange = "K"||24550  |                                    strRange = "K"
24596  |                                    intRange = 11 ||24551  |                                    intRange = 11 
24597  |                                End If            ||24552  |                                End If            
24598  |                                J = 0             ||24553  |                                J = 0             
24599  |                                K = 0             ||24554  |                                K = 0             
24600  |                            Else                  ||24555  |                            Else                  
24601  |                                If intRange = 11 T||24556  |                                If intRange = 11 T
24602  |                                    '余白無し     ||24557  |                                    '余白無し     
24603  |                                    '日付         ||24558  |                                    '日付         
24604  |                                    .Cells(11 + K,||24559  |                                    .Cells(11 + K,
24605  |                                    Format(gstrDat||24560  |                                    Format(gstrDat
24606  |                                    sWord60 & Form||24561  |                                    sWord60 & Form
24607  |                                    K = K + 1     ||24562  |                                    K = K + 1     
24608  | '2008/02/20 START 時価総額基準の外部委託顧問料対 ||24563  | '2008/02/20 START 時価総額基準の外部委託顧問料対 
24609  |                                    '取得NAV区分が||24564  |                                    '取得NAV区分が
24610  |                                    If gbuMGetUPDR||24565  |                                    If gbuMGetUPDR
24611  |                                       .Cells(11 +||24566  |                                       .Cells(11 +
24612  |                                    Else          ||24567  |                                    Else          
24613  |                                       .Cells(11 +||24568  |                                       .Cells(11 +
24614  |                                    End If        ||24569  |                                    End If        
24615  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24570  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24616  |                                    .Cells(11 + K,||24571  |                                    .Cells(11 + K,
24617  |                                    '平均純資産   ||24572  |                                    '平均純資産   
24618  |                                    dblValueIn = g||24573  |                                    dblValueIn = g
24619  |                                    If gtypOtherCo||24574  |                                    If gtypOtherCo
24620  |                                          Call sbG||24575  |                                          Call sbG
24621  |                                    Else          ||24576  |                                    Else          
24622  |                                          Call sbG||24577  |                                          Call sbG
24623  |                                    End If        ||24578  |                                    End If        
24624  |                                    If gtypOtherCo||24579  |                                    If gtypOtherCo
24625  |                                        .Cells(11 ||24580  |                                        .Cells(11 
24626  |                                    Else          ||24581  |                                    Else          
24627  |                                        .Cells(11 ||24582  |                                        .Cells(11 
24628  |                                    End If        ||24583  |                                    End If        
24629  |                                    'If gtypOtherC||24584  |                                    'If gtypOtherC
24630  |                                    '    .Cells(11||24585  |                                    '    .Cells(11
24631  |                                    'Else         ||24586  |                                    'Else         
24632  |                                    '    .Cells(11||24587  |                                    '    .Cells(11
24633  |                                    'End If       ||24588  |                                    'End If       
24634  |                                    .Cells(11 + K,||24589  |                                    .Cells(11 + K,
24635  |                                    strRange = "K"||24590  |                                    strRange = "K"
24636  |                                    intRange = 11 ||24591  |                                    intRange = 11 
24637  |                                ElseIf intRange <>||24592  |                                ElseIf intRange <>
24638  |                                    '余白有り     ||24593  |                                    '余白有り     
24639  |                                    K = K + 1     ||24594  |                                    K = K + 1     
24640  |                                    '日付         ||24595  |                                    '日付         
24641  |                                    .Cells(intRang||24596  |                                    .Cells(intRang
24642  |                                    Format(gstrDat||24597  |                                    Format(gstrDat
24643  |                                    sWord60 & Form||24598  |                                    sWord60 & Form
24644  |                                    K = K + 1     ||24599  |                                    K = K + 1     
24645  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24600  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24646  |                                    '取得NAV区分が||24601  |                                    '取得NAV区分が
24647  |                                    If gbuMGetUPDR||24602  |                                    If gbuMGetUPDR
24648  |                                        .Cells(int||24603  |                                        .Cells(int
24649  |                                    Else          ||24604  |                                    Else          
24650  |                                        .Cells(int||24605  |                                        .Cells(int
24651  |                                    End If        ||24606  |                                    End If        
24652  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24607  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24653  |                                    .Cells(intRang||24608  |                                    .Cells(intRang
24654  |                                    '平均純資産   ||24609  |                                    '平均純資産   
24655  |                                    dblValueIn = g||24610  |                                    dblValueIn = g
24656  |                                    If gtypOtherCo||24611  |                                    If gtypOtherCo
24657  |                                          Call sbG||24612  |                                          Call sbG
24658  |                                    Else          ||24613  |                                    Else          
24659  |                                          Call sbG||24614  |                                          Call sbG
24660  |                                    End If        ||24615  |                                    End If        
24661  |                                    If gtypOtherCo||24616  |                                    If gtypOtherCo
24662  |                                        .Cells(int||24617  |                                        .Cells(int
24663  |                                    Else          ||24618  |                                    Else          
24664  |                                        .Cells(int||24619  |                                        .Cells(int
24665  |                                    End If        ||24620  |                                    End If        
24666  |                                    'If gtypOtherC||24621  |                                    'If gtypOtherC
24667  |                                    '    .Cells(in||24622  |                                    '    .Cells(in
24668  |                                    'Else         ||24623  |                                    'Else         
24669  |                                    '    .Cells(in||24624  |                                    '    .Cells(in
24670  |                                    'End If       ||24625  |                                    'End If       
24671  |                                    .Cells(intRang||24626  |                                    .Cells(intRang
24672  |                                    strRange = "K"||24627  |                                    strRange = "K"
24673  |                                    intRange = int||24628  |                                    intRange = int
24674  |                                Else              ||24629  |                                Else              
24675  |                                    J = 0         ||24630  |                                    J = 0         
24676  |                                    K = 0         ||24631  |                                    K = 0         
24677  |                                    strRange = "J"||24632  |                                    strRange = "J"
24678  |                                    intRange = 11 ||24633  |                                    intRange = 11 
24679  |                                    AddPoint = din||24634  |                                    AddPoint = din
24680  |                                    Exit For      ||24635  |                                    Exit For      
24681  |                                End If            ||24636  |                                End If            
24682  |                                J = 0             ||24637  |                                J = 0             
24683  |                                K = 0             ||24638  |                                K = 0             
24684  |                            End If                ||24639  |                            End If                
24685  |                        End If                    ||24640  |                        End If                    
24686  |                    Next dintFor                  ||24641  |                    Next dintFor                  
24687  |                End With                          ||24642  |                End With                          
24688  |            End If                                ||24643  |            End If                                
24689  |                                                  ||24644  |                                                  
24690  |            'A4印刷用に上2行を削除して、プレビュー||24645  |            'A4印刷用に上2行を削除して、プレビュー
24691  |            xlSheet.Rows("1:2").Delete Shift:=xlUp||24646  |            xlSheet.Rows("1:2").Delete Shift:=xlUp
24692  |        Next L                                    ||24647  |        Next L                                    
24693  |    End If                                        ||24648  |    End If                                        
24694  |                                                  ||24649  |                                                  
24695  |    '正常戻り値セット                             ||24650  |    '正常戻り値セット                             
24696  |    fnblExcelEnglishOut_ChangeRate = True         ||24651  |    fnblExcelEnglishOut_ChangeRate = True         
24697  |    GoTo EndProc                                  ||24652  |    GoTo EndProc                                  
24698  |                                                  ||24653  |                                                  
24699  |ErrorTrap:                                        ||24654  |ErrorTrap:                                        
24700  |    ' Excel を起動できない場合に発生するエラーをト||24655  |    ' Excel を起動できない場合に発生するエラーをト
24701  |    Select Case Err.Number                        ||24656  |    Select Case Err.Number                        
24702  |        Case 440               ' オートメーション ||24657  |        Case 440               ' オートメーション 
24703  |            iTries = iTries + 1                   ||24658  |            iTries = iTries + 1                   
24704  |            ' Excel の再起動を 5 回まで行います。 ||24659  |            ' Excel の再起動を 5 回まで行います。 
24705  |            If iTries < 5 Then                    ||24660  |            If iTries < 5 Then                    
24706  |               Set xlApp = New Excel.Application  ||24661  |               Set xlApp = New Excel.Application  
24707  |               Resume                             ||24662  |               Resume                             
24708  |            Else                                  ||24663  |            Else                                  
24709  |               Err.Raise Number:=vbObjectError + 2||24664  |               Err.Raise Number:=vbObjectError + 2
24710  |               Description:="Microsoft Excel を起 ||24665  |               Description:="Microsoft Excel を起 
24711  |            End If                                ||24666  |            End If                                
24712  |        Case Else                                 ||24667  |        Case Else                                 
24713  |    End Select                                    ||24668  |    End Select                                    
24714  |                                                  ||24669  |                                                  
24715  |    'Workbookを閉じる                             ||24670  |    'Workbookを閉じる                             
24716  |    xlBook.Close                                  ||24671  |    xlBook.Close                                  
24717  |                                                  ||24672  |                                                  
24718  |    'Excel終了                                    ||24673  |    'Excel終了                                    
24719  |    xlApp.Quit                                    ||24674  |    xlApp.Quit                                    
24720  |                                                  ||24675  |                                                  
24721  |    'オブジェクトの解放                           ||24676  |    'オブジェクトの解放                           
24722  |    Set xlApp = Nothing                           ||24677  |    Set xlApp = Nothing                           
24723  |    Set xlBook = Nothing                          ||24678  |    Set xlBook = Nothing                          
24724  |    Set xlSheet = Nothing                         ||24679  |    Set xlSheet = Nothing                         
24725  |                                                  ||24680  |                                                  
24726  |OnErrorProc:                                      ||24681  |OnErrorProc:                                      
24727  |    Call subError("システムエラー", Str(Err.Number||24682  |    Call subError("システムエラー", Str(Err.Number
24728  |        Error, strErrCall, conTitle)              ||24683  |        Error, strErrCall, conTitle)              
24729  |    'マウスポインター元に戻す                     ||24684  |    'マウスポインター元に戻す                     
24730  |    Screen.MousePointer = vbDefault               ||24685  |    Screen.MousePointer = vbDefault               
24731  |    GoTo EndProc                                  ||24686  |    GoTo EndProc                                  
24732  |                                                  ||24687  |                                                  
24733  |EndProc:                                          ||24688  |EndProc:                                          
24734  |                                                  ||24689  |                                                  
24735  |End Function                                      ||24690  |End Function                                      
24736  |                                                  ||24691  |                                                  
24737  |'=================================================||24692  |'=================================================
24738  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbExcelChgRateSheetEnglishOut||24693  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbExcelChgRateSheetEnglishOut
24739  |'機能            :   確認書の料率変更履歴出力(英語||24694  |'機能            :   確認書の料率変更履歴出力(英語
24740  |'                                                 ||24695  |'                                                 
24741  |'日付               担当　              修正内容  ||24696  |'日付               担当　              修正内容  
24742  |'-------------------------------------------------||24697  |'-------------------------------------------------
24743  |'2006/08/22         K.Furuya <SRA>     新規作成(期||24698  |'2006/08/22         K.Furuya <SRA>     新規作成(期
24744  |'=================================================||24699  |'=================================================
24745  |Private Sub sbExcelChgRateSheetEnglishOut( _      ||24700  |Private Sub sbExcelChgRateSheetEnglishOut( _      
24746  |    ByVal sGetAccCode As String, _                ||24701  |    ByVal sGetAccCode As String, _                
24747  |    ByVal TotalRate As Currency, _                ||24702  |    ByVal TotalRate As Currency, _                
24748  |    ByVal lRecIdx As Long, _                      ||24703  |    ByVal lRecIdx As Long, _                      
24749  |    ByVal StartDate As Date, _                    ||24704  |    ByVal StartDate As Date, _                    
24750  |    ByVal EndDate As Date, _                      ||24705  |    ByVal EndDate As Date, _                      
24751  |    ByVal dlngMeisyoSu As Integer, _              ||24706  |    ByVal dlngMeisyoSu As Integer, _              
24752  |    ByVal NavGetFlg As String _                   ||24707  |    ByVal NavGetFlg As String _                   
24753  |    )                                             ||24708  |    )                                             
24754  |    Dim i       As Integer                        ||24709  |    Dim i       As Integer                        
24755  |    Dim J       As Integer                        ||24710  |    Dim J       As Integer                        
24756  |    Dim Idx_i   As Integer                        ||24711  |    Dim Idx_i   As Integer                        
24757  |    Dim Idx_j   As Integer                        ||24712  |    Dim Idx_j   As Integer                        
24758  |    Dim Add_i   As Integer                        ||24713  |    Dim Add_i   As Integer                        
24759  |    Dim PgIndx  As Integer                        ||24714  |    Dim PgIndx  As Integer                        
24760  |    Dim RateCnt As Integer                        ||24715  |    Dim RateCnt As Integer                        
24761  |    Dim AddRateCnt As Integer                     ||24716  |    Dim AddRateCnt As Integer                     
24762  |    Dim iPage   As Integer                        ||24717  |    Dim iPage   As Integer                        
24763  |    Dim GenPage As Integer                        ||24718  |    Dim GenPage As Integer                        
24764  |    Dim iAmari  As Integer                        ||24719  |    Dim iAmari  As Integer                        
24765  |    Dim SetPoint As Integer                       ||24720  |    Dim SetPoint As Integer                       
24766  |    Dim StartLine As Integer                      ||24721  |    Dim StartLine As Integer                      
24767  |    Dim J_Cnt As Integer                          ||24722  |    Dim J_Cnt As Integer                          
24768  |    Dim J_AddCnt As Integer                       ||24723  |    Dim J_AddCnt As Integer                       
24769  |    Const StartPoint As Integer = 12              ||24724  |    Const StartPoint As Integer = 12              
24770  |    Const FixedLine As Integer = 6                ||24725  |    Const FixedLine As Integer = 6                
24771  |    Const DivideLine As Integer = 4               ||24726  |    Const DivideLine As Integer = 4               
24772  |    Const KikanLine As Integer = 1                ||24727  |    Const KikanLine As Integer = 1                
24773  |    Const AddLine As Integer = 2                  ||24728  |    Const AddLine As Integer = 2                  
24774  |                                                  ||24729  |                                                  
24775  |    RateCnt = 0                                   ||24730  |    RateCnt = 0                                   
24776  |                                                  ||24731  |                                                  
24777  |    '固定料率                                     ||24732  |    '固定料率                                     
24778  |    If gbuMGetUPDRec.N(lRecIdx).MGET_other_rate_ru||24733  |    If gbuMGetUPDRec.N(lRecIdx).MGET_other_rate_ru
24779  |        For i = LBound(gtypOtherComRec) To UBound(||24734  |        For i = LBound(gtypOtherComRec) To UBound(
24780  |            For J = LBound(gtypOtherComRec(i).APPL||24735  |            For J = LBound(gtypOtherComRec(i).APPL
24781  |                '料率の数を積算                   ||24736  |                '料率の数を積算                   
24782  |                RateCnt = RateCnt + 1             ||24737  |                RateCnt = RateCnt + 1             
24783  |            Next J                                ||24738  |            Next J                                
24784  |            If i = UBound(gtypOtherComRec) Then   ||24739  |            If i = UBound(gtypOtherComRec) Then   
24785  |                RateCnt = RateCnt + AddLine       ||24740  |                RateCnt = RateCnt + AddLine       
24786  |            Else                                  ||24741  |            Else                                  
24787  |                RateCnt = RateCnt + AddLine + Fixe||24742  |                RateCnt = RateCnt + AddLine + Fixe
24788  |            End If                                ||24743  |            End If                                
24789  |        Next i                                    ||24744  |        Next i                                    
24790  |    '段階料率                                     ||24745  |    '段階料率                                     
24791  |    ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other_rat||24746  |    ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other_rat
24792  |        For i = LBound(gtypOtherComRec) To UBound(||24747  |        For i = LBound(gtypOtherComRec) To UBound(
24793  |            '料率カウント変数を初期化             ||24748  |            '料率カウント変数を初期化             
24794  |            J_Cnt = 0                             ||24749  |            J_Cnt = 0                             
24795  |            For J = LBound(gtypOtherComRec(i).APPL||24750  |            For J = LBound(gtypOtherComRec(i).APPL
24796  |                '料率の数を積算                   ||24751  |                '料率の数を積算                   
24797  |                J_Cnt = J_Cnt + 1                 ||24752  |                J_Cnt = J_Cnt + 1                 
24798  |            Next J                                ||24753  |            Next J                                
24799  |            If i = UBound(gtypOtherComRec) Then   ||24754  |            If i = UBound(gtypOtherComRec) Then   
24800  |                RateCnt = RateCnt + AddLine + (((J||24755  |                RateCnt = RateCnt + AddLine + (((J
24801  |            Else                                  ||24756  |            Else                                  
24802  |                RateCnt = RateCnt + AddLine + (((J||24757  |                RateCnt = RateCnt + AddLine + (((J
24803  |            End If                                ||24758  |            End If                                
24804  |        Next i                                    ||24759  |        Next i                                    
24805  |    End If                                        ||24760  |    End If                                        
24806  |                                                  ||24761  |                                                  
24807  |    '頁数を計算する                               ||24762  |    '頁数を計算する                               
24808  |    iPage = RateCnt \ 51 '51は有効行数            ||24763  |    iPage = RateCnt \ 51 '51は有効行数            
24809  |    '頁が割切れるか計算する                       ||24764  |    '頁が割切れるか計算する                       
24810  |    iAmari = RateCnt Mod 51                       ||24765  |    iAmari = RateCnt Mod 51                       
24811  |    '頁が割切れない場合は一頁増やす               ||24766  |    '頁が割切れない場合は一頁増やす               
24812  |    If iAmari <> 0 Then                           ||24767  |    If iAmari <> 0 Then                           
24813  |        iPage = iPage + 1                         ||24768  |        iPage = iPage + 1                         
24814  |    End If                                        ||24769  |    End If                                        
24815  |                                                  ||24770  |                                                  
24816  |    'ループの開始ポジション変数を初期化           ||24771  |    'ループの開始ポジション変数を初期化           
24817  |    SetPoint = 0                                  ||24772  |    SetPoint = 0                                  
24818  |    'ループ変数のインクリメント変数を初期化       ||24773  |    'ループ変数のインクリメント変数を初期化       
24819  |    Add_i = 0                                     ||24774  |    Add_i = 0                                     
24820  |    'シート番号を初期化                           ||24775  |    'シート番号を初期化                           
24821  |    gTotalDnavCnt = 0                             ||24776  |    gTotalDnavCnt = 0                             
24822  |                                                  ||24777  |                                                  
24823  |    For PgIndx = 1 To iPage                       ||24778  |    For PgIndx = 1 To iPage                       
24824  |        'ルール単位の料率文言の行数取得変数の初期 ||24779  |        'ルール単位の料率文言の行数取得変数の初期 
24825  |        RateCnt = StartPoint                      ||24780  |        RateCnt = StartPoint                      
24826  |        AddRateCnt = 0                            ||24781  |        AddRateCnt = 0                            
24827  |                                                  ||24782  |                                                  
24828  |        'スタート行をセット                       ||24783  |        'スタート行をセット                       
24829  |        StartLine = StartPoint                    ||24784  |        StartLine = StartPoint                    
24830  |                                                  ||24785  |                                                  
24831  |        xlBook.Worksheets.Add after:=xlBook.Sheets||24786  |        xlBook.Worksheets.Add after:=xlBook.Sheets
24832  |        gProcessCnt = gProcessCnt + 1             ||24787  |        gProcessCnt = gProcessCnt + 1             
24833  |        Set xlSheet = xlBook.Sheets(gProcessCnt)  ||24788  |        Set xlSheet = xlBook.Sheets(gProcessCnt)  
24834  |                                                  ||24789  |                                                  
24835  |        'Excelフォーマットを調整                  ||24790  |        'Excelフォーマットを調整                  
24836  |        xlSheet.Cells.ColumnWidth = 1             ||24791  |        xlSheet.Cells.ColumnWidth = 1             
24837  |        xlSheet.Cells.Font.Size = 11              ||24792  |        xlSheet.Cells.Font.Size = 11              
24838  |        'シート名を設定(日次NAV一覧**)            ||24793  |        'シート名を設定(日次NAV一覧**)            
24839  |                                                  ||24794  |                                                  
24840  |        If dstrOldAccCode = sGetAccCode Then      ||24795  |        If dstrOldAccCode = sGetAccCode Then      
24841  |            gTotalDnavCnt = gTotalDnavCnt + 1     ||24796  |            gTotalDnavCnt = gTotalDnavCnt + 1     
24842  |        Else                                      ||24797  |        Else                                      
24843  |            gTotalDnavCnt = 1                     ||24798  |            gTotalDnavCnt = 1                     
24844  |            dstrOldAccCode = sGetAccCode          ||24799  |            dstrOldAccCode = sGetAccCode          
24845  |        End If                                    ||24800  |        End If                                    
24846  |        'gTotalCnt = gTotalCnt + 1                ||24801  |        'gTotalCnt = gTotalCnt + 1                
24847  |        'xlBook.Sheets(gProcessCnt).Name = sWord60||24802  |        'xlBook.Sheets(gProcessCnt).Name = sWord60
24848  |        '複数ページの場合                         ||24803  |        '複数ページの場合                         
24849  |        If iPage > 1 Then                         ||24804  |        If iPage > 1 Then                         
24850  |            xlBook.Sheets(gProcessCnt).Name = sWor||24805  |            xlBook.Sheets(gProcessCnt).Name = sWor
24851  |        Else                                      ||24806  |        Else                                      
24852  |            xlBook.Sheets(gProcessCnt).Name = sWor||24807  |            xlBook.Sheets(gProcessCnt).Name = sWor
24853  |        End If                                    ||24808  |        End If                                    
24854  |                                                  ||24809  |                                                  
24855  |        'シートの余白を設定                       ||24810  |        'シートの余白を設定                       
24856  |        xlSheet.PageSetup.TopMargin = Application.||24811  |        xlSheet.PageSetup.TopMargin = Application.
24857  |        xlSheet.PageSetup.BottomMargin = Applicati||24812  |        xlSheet.PageSetup.BottomMargin = Applicati
24858  |        xlSheet.PageSetup.LeftMargin = Application||24813  |        xlSheet.PageSetup.LeftMargin = Application
24859  |        xlSheet.PageSetup.RightMargin = Applicatio||24814  |        xlSheet.PageSetup.RightMargin = Applicatio
24860  |                                                  ||24815  |                                                  
24861  |        DoEvents                                  ||24816  |        DoEvents                                  
24862  |                                                  ||24817  |                                                  
24863  |                                                  ||24818  |                                                  
24864  |        With xlSheet                              ||24819  |        With xlSheet                              
24865  |            '題目                                 ||24820  |            '題目                                 
24866  |            Select Case Mid(gbuMGetUPDRec.N(lRecId||24821  |            Select Case Mid(gbuMGetUPDRec.N(lRecId
24867  |                Case Mid(mstrContractFlag(1), 1, 1||24822  |                Case Mid(mstrContractFlag(1), 1, 1
24868  |                    .Cells(5, 1).Value = sWord54a ||24823  |                    .Cells(5, 1).Value = sWord54a 
24869  |                Case Mid(mstrContractFlag(2), 1, 1||24824  |                Case Mid(mstrContractFlag(2), 1, 1
24870  |                    .Cells(5, 1).Value = sWord55a ||24825  |                    .Cells(5, 1).Value = sWord55a 
24871  |                Case Mid(mstrContractFlag(3), 1, 1||24826  |                Case Mid(mstrContractFlag(3), 1, 1
24872  |                    .Cells(5, 1).Value = sWord56a ||24827  |                    .Cells(5, 1).Value = sWord56a 
24873  |                Case Else                         ||24828  |                Case Else                         
24874  |            End Select                            ||24829  |            End Select                            
24875  |            .Cells(5, 1).Font.Size = 14           ||24830  |            .Cells(5, 1).Font.Size = 14           
24876  |            .Range("A5:BG5").HorizontalAlignment =||24831  |            .Range("A5:BG5").HorizontalAlignment =
24877  |            '出力日付                             ||24832  |            '出力日付                             
24878  |            If RTrim(txtSysOutDate.Text) = "" Then||24833  |            If RTrim(txtSysOutDate.Text) = "" Then
24879  |                .Cells(3, 50).Value = sWord34a    ||24834  |                .Cells(3, 50).Value = sWord34a    
24880  |                .Cells(3, 50).HorizontalAlignment ||24835  |                .Cells(3, 50).HorizontalAlignment 
24881  |            Else                                  ||24836  |            Else                                  
24882  |                .Cells(3, 43).NumberFormatLocal = ||24837  |                .Cells(3, 43).NumberFormatLocal = 
24883  |                .Cells(3, 43).Value = CStr(Format(||24838  |                .Cells(3, 43).Value = CStr(Format(
24884  |            End If                                ||24839  |            End If                                
24885  |            'ファンド名                           ||24840  |            'ファンド名                           
24886  |            .Cells(7, 2).Value = sWord4a          ||24841  |            .Cells(7, 2).Value = sWord4a          
24887  |            .Cells(7, 13).Value = sWord19         ||24842  |            .Cells(7, 13).Value = sWord19         
24888  |            .Cells(7, 15).NumberFormatLocal = "@" ||24843  |            .Cells(7, 15).NumberFormatLocal = "@" 
24889  |            .Cells(7, 15).Value = gbuMGetUPDRec.N(||24844  |            .Cells(7, 15).Value = gbuMGetUPDRec.N(
24890  |            'ファンドコード                       ||24845  |            'ファンドコード                       
24891  |            .Cells(8, 2).Value = sWord4_2a        ||24846  |            .Cells(8, 2).Value = sWord4_2a        
24892  |            .Cells(8, 13).Value = sWord19         ||24847  |            .Cells(8, 13).Value = sWord19         
24893  |            .Cells(8, 15).NumberFormatLocal = "@" ||24848  |            .Cells(8, 15).NumberFormatLocal = "@" 
24894  |            .Cells(8, 15).Value = sGetAccCode     ||24849  |            .Cells(8, 15).Value = sGetAccCode     
24895  |                                                  ||24850  |                                                  
24896  |            '計算期間                             ||24851  |            '計算期間                             
24897  |            .Cells(10, 2).Value = sWord5a         ||24852  |            .Cells(10, 2).Value = sWord5a         
24898  |            .Cells(10, 13).Value = sWord19        ||24853  |            .Cells(10, 13).Value = sWord19        
24899  |            '名称許諾料計算で日次(休日無し)       ||24854  |            '名称許諾料計算で日次(休日無し)       
24900  |            If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c||24855  |            If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c
24901  |            And gbuMGetUPDRec.N(lRecIdx).MGET_nav_||24856  |            And gbuMGetUPDRec.N(lRecIdx).MGET_nav_
24902  |                .Cells(10, 15).Value = _          ||24857  |                .Cells(10, 15).Value = _          
24903  |                    CStr(Format(StartDate, "mmmm d||24858  |                    CStr(Format(StartDate, "mmmm d
24904  |            Else                                  ||24859  |            Else                                  
24905  |                .Cells(10, 15).Value = _          ||24860  |                .Cells(10, 15).Value = _          
24906  |                    CStr(Format(StartDate, "mmmm d||24861  |                    CStr(Format(StartDate, "mmmm d
24907  |            End If                                ||24862  |            End If                                
24908  |            '固定料率                             ||24863  |            '固定料率                             
24909  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||24864  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
24910  |                '年率1行固定                      ||24865  |                '年率1行固定                      
24911  |                For i = SetPoint To UBound(gtypOth||24866  |                For i = SetPoint To UBound(gtypOth
24912  |                                                  ||24867  |                                                  
24913  |                    'ループ変数のインクリメント変 ||24868  |                    'ループ変数のインクリメント変 
24914  |                    Add_i = Add_i + 1             ||24869  |                    Add_i = Add_i + 1             
24915  |                                                  ||24870  |                                                  
24916  |                    For J = LBound(gtypOtherComRec||24871  |                    For J = LBound(gtypOtherComRec
24917  |                    '適用期間                     ||24872  |                    '適用期間                     
24918  |                        .Cells(StartLine, 2).Value||24873  |                        .Cells(StartLine, 2).Value
24919  |                        .Cells(StartLine, 13).Valu||24874  |                        .Cells(StartLine, 13).Valu
24920  |                        '名称許諾料計算で日次(休日||24875  |                        '名称許諾料計算で日次(休日
24921  |                        If Mid(gbuMGetUPDRec.N(lRe||24876  |                        If Mid(gbuMGetUPDRec.N(lRe
24922  |                        And gbuMGetUPDRec.N(lRecId||24877  |                        And gbuMGetUPDRec.N(lRecId
24923  |                            .Cells(StartLine, 15).||24878  |                            .Cells(StartLine, 15).
24924  |                                CStr(Format(gstrDa||24879  |                                CStr(Format(gstrDa
24925  |                                sWord20 & CStr(For||24880  |                                sWord20 & CStr(For
24926  |                                sWord59 & sWord43 ||24881  |                                sWord59 & sWord43 
24927  |                        Else                      ||24882  |                        Else                      
24928  |                            .Cells(StartLine, 15).||24883  |                            .Cells(StartLine, 15).
24929  |                                CStr(Format(gstrDa||24884  |                                CStr(Format(gstrDa
24930  |                                sWord20 & CStr(For||24885  |                                sWord20 & CStr(For
24931  |                                sWord59 & sWord43 ||24886  |                                sWord59 & sWord43 
24932  |                        End If                    ||24887  |                        End If                    
24933  |                    '平均純資産総額               ||24888  |                    '平均純資産総額               
24934  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24889  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24935  |                        '取得NAV区分が4:日次時価総||24890  |                        '取得NAV区分が4:日次時価総
24936  |                        If gbuMGetUPDRec.N(lRecIdx||24891  |                        If gbuMGetUPDRec.N(lRecIdx
24937  |                            .Cells(StartLine + Kik||24892  |                            .Cells(StartLine + Kik
24938  |                        Else                      ||24893  |                        Else                      
24939  |                            .Cells(StartLine + Kik||24894  |                            .Cells(StartLine + Kik
24940  |                        End If                    ||24895  |                        End If                    
24941  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24896  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24942  |                        .Cells(StartLine + KikanLi||24897  |                        .Cells(StartLine + KikanLi
24943  |                        '計算期間の純資産総額の合 ||24898  |                        '計算期間の純資産総額の合 
24944  |                        .Cells(StartLine + KikanLi||24899  |                        .Cells(StartLine + KikanLi
24945  |                        If gtypOtherComRec(i).APPL||24900  |                        If gtypOtherComRec(i).APPL
24946  |                            .Cells(StartLine + Kik||24901  |                            .Cells(StartLine + Kik
24947  |                        Else                      ||24902  |                        Else                      
24948  |                            .Cells(StartLine + Kik||24903  |                            .Cells(StartLine + Kik
24949  |                        End If                    ||24904  |                        End If                    
24950  |                        .Cells(StartLine + KikanLi||24905  |                        .Cells(StartLine + KikanLi
24951  |                        '計算期間の純資産総額の合 ||24906  |                        '計算期間の純資産総額の合 
24952  |                        .Cells(StartLine + KikanLi||24907  |                        .Cells(StartLine + KikanLi
24953  |                        'NAV区分が '1' の場合（月 ||24908  |                        'NAV区分が '1' の場合（月 
24954  |                        If NavGetFlg = "1" Then   ||24909  |                        If NavGetFlg = "1" Then   
24955  |                            dblValueIn = gtypOther||24910  |                            dblValueIn = gtypOther
24956  |                        '日次の場合               ||24911  |                        '日次の場合               
24957  |                        Else                      ||24912  |                        Else                      
24958  |                            dblValueIn = gtypOther||24913  |                            dblValueIn = gtypOther
24959  |                        End If                    ||24914  |                        End If                    
24960  |                        If gtypOtherComRec(i).APPL||24915  |                        If gtypOtherComRec(i).APPL
24961  |                              Call sbGetRoundValue||24916  |                              Call sbGetRoundValue
24962  |                        Else                      ||24917  |                        Else                      
24963  |                              Call sbGetRoundValue||24918  |                              Call sbGetRoundValue
24964  |                        End If                    ||24919  |                        End If                    
24965  |                        '平均NAV(計算対象NAV)     ||24920  |                        '平均NAV(計算対象NAV)     
24966  |                        If gtypOtherComRec(i).APPL||24921  |                        If gtypOtherComRec(i).APPL
24967  |                            .Cells(StartLine + Kik||24922  |                            .Cells(StartLine + Kik
24968  |                        Else                      ||24923  |                        Else                      
24969  |                            .Cells(StartLine + Kik||24924  |                            .Cells(StartLine + Kik
24970  |                        End If                    ||24925  |                        End If                    
24971  |                        '÷??＝ ,文言             ||24926  |                        '÷??＝ ,文言             
24972  |                        'NAV区分が '1' の場合（月 ||24927  |                        'NAV区分が '1' の場合（月 
24973  |                        If NavGetFlg = "1" Then   ||24928  |                        If NavGetFlg = "1" Then   
24974  |                            .Cells(StartLine + Kik||24929  |                            .Cells(StartLine + Kik
24975  |                        '日次の場合               ||24930  |                        '日次の場合               
24976  |                        Else                      ||24931  |                        Else                      
24977  |                            .Cells(StartLine + Kik||24932  |                            .Cells(StartLine + Kik
24978  |                        End If                    ||24933  |                        End If                    
24979  |                    '年率                         ||24934  |                    '年率                         
24980  |                        .Cells(StartLine + AddLine||24935  |                        .Cells(StartLine + AddLine
24981  |                        .Cells(StartLine + AddLine||24936  |                        .Cells(StartLine + AddLine
24982  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24937  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24983  |                        '取得NAV区分が4:日次時価総||24938  |                        '取得NAV区分が4:日次時価総
24984  |                        If gbuMGetUPDRec.N(lRecIdx||24939  |                        If gbuMGetUPDRec.N(lRecIdx
24985  |                            .Cells(StartLine + Add||24940  |                            .Cells(StartLine + Add
24986  |                                Format(gtypOtherCo||24941  |                                Format(gtypOtherCo
24987  |                        Else                      ||24942  |                        Else                      
24988  |                            .Cells(StartLine + Add||24943  |                            .Cells(StartLine + Add
24989  |                                Format(gtypOtherCo||24944  |                                Format(gtypOtherCo
24990  |                        End If                    ||24945  |                        End If                    
24991  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24946  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24992  |                        '年率文言の行数をカウント ||24947  |                        '年率文言の行数をカウント 
24993  |                        RateCnt = RateCnt + 2     ||24948  |                        RateCnt = RateCnt + 2     
24994  |                    Next J                        ||24949  |                    Next J                        
24995  |                    '年率文言の行数にスペース行を ||24950  |                    '年率文言の行数にスペース行を 
24996  |                    RateCnt = RateCnt + FixedLine ||24951  |                    RateCnt = RateCnt + FixedLine 
24997  |                                                  ||24952  |                                                  
24998  |                    '次料率の行数を取得する       ||24953  |                    '次料率の行数を取得する       
24999  |                    '配列の要素の最大値までを取得 ||24954  |                    '配列の要素の最大値までを取得 
25000  |                    If i < UBound(gtypOtherComRec)||24955  |                    If i < UBound(gtypOtherComRec)
25001  |                        For Idx_i = i + 1 To i + 1||24956  |                        For Idx_i = i + 1 To i + 1
25002  |                            For Idx_j = LBound(gty||24957  |                            For Idx_j = LBound(gty
25003  |                                '料率の数を積算   ||24958  |                                '料率の数を積算   
25004  |                                AddRateCnt = AddRa||24959  |                                AddRateCnt = AddRa
25005  |                            Next Idx_j            ||24960  |                            Next Idx_j            
25006  |                            AddRateCnt = AddRateCn||24961  |                            AddRateCnt = AddRateCn
25007  |                        Next Idx_i                ||24962  |                        Next Idx_i                
25008  |                    End If                        ||24963  |                    End If                        
25009  |                                                  ||24964  |                                                  
25010  |                    '行数を計算する               ||24965  |                    '行数を計算する               
25011  |                    GenPage = RateCnt + AddRateCnt||24966  |                    GenPage = RateCnt + AddRateCnt
25012  |                                                  ||24967  |                                                  
25013  |                    AddRateCnt = 0                ||24968  |                    AddRateCnt = 0                
25014  |                                                  ||24969  |                                                  
25015  |                    '行数が溢れたら改ページ       ||24970  |                    '行数が溢れたら改ページ       
25016  |                    If conSheetLastLine < GenPage ||24971  |                    If conSheetLastLine < GenPage 
25017  |                        'ループの開始ポジション変 ||24972  |                        'ループの開始ポジション変 
25018  |                        SetPoint = Add_i          ||24973  |                        SetPoint = Add_i          
25019  |                        Exit For                  ||24974  |                        Exit For                  
25020  |                    End If                        ||24975  |                    End If                        
25021  |                    '次の開始行をセット           ||24976  |                    '次の開始行をセット           
25022  |                    RateCnt = RateCnt + 1         ||24977  |                    RateCnt = RateCnt + 1         
25023  |                    StartLine = RateCnt           ||24978  |                    StartLine = RateCnt           
25024  |                Next i                            ||24979  |                Next i                            
25025  |            '段階料率                             ||24980  |            '段階料率                             
25026  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_o||24981  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_o
25027  |                For i = SetPoint To UBound(gtypOth||24982  |                For i = SetPoint To UBound(gtypOth
25028  |                    'ループ変数のインクリメント変 ||24983  |                    'ループ変数のインクリメント変 
25029  |                    Add_i = Add_i + 1             ||24984  |                    Add_i = Add_i + 1             
25030  |                    TotalRate = 0                 ||24985  |                    TotalRate = 0                 
25031  |                    J_AddCnt = 0                  ||24986  |                    J_AddCnt = 0                  
25032  |                    For J = LBound(gtypOtherComRec||24987  |                    For J = LBound(gtypOtherComRec
25033  |                        If J = 0 Then             ||24988  |                        If J = 0 Then             
25034  |                        '開始行                   ||24989  |                        '開始行                   
25035  |                        '適用期間                 ||24990  |                        '適用期間                 
25036  |                            .Cells(StartLine + J, ||24991  |                            .Cells(StartLine + J, 
25037  |                            .Cells(StartLine + J, ||24992  |                            .Cells(StartLine + J, 
25038  |                            '名称許諾料計算で日次(||24993  |                            '名称許諾料計算で日次(
25039  |                            If Mid(gbuMGetUPDRec.N||24994  |                            If Mid(gbuMGetUPDRec.N
25040  |                            And gbuMGetUPDRec.N(lR||24995  |                            And gbuMGetUPDRec.N(lR
25041  |                                .Cells(StartLine +||24996  |                                .Cells(StartLine +
25042  |                                    CStr(Format(gs||24997  |                                    CStr(Format(gs
25043  |                                    sWord20 & CStr||24998  |                                    sWord20 & CStr
25044  |                                    sWord59 & sWor||24999  |                                    sWord59 & sWor
25045  |                            Else                  ||25000  |                            Else                  
25046  |                                .Cells(StartLine +||25001  |                                .Cells(StartLine +
25047  |                                    CStr(Format(gs||25002  |                                    CStr(Format(gs
25048  |                                    sWord20 & CStr||25003  |                                    sWord20 & CStr
25049  |                                    sWord59 & sWor||25004  |                                    sWord59 & sWor
25050  |                            End If                ||25005  |                            End If                
25051  |                        '平均純資産総額           ||25006  |                        '平均純資産総額           
25052  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||25007  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
25053  |                            '取得NAV区分が4:日次時||25008  |                            '取得NAV区分が4:日次時
25054  |                            If gbuMGetUPDRec.N(lRe||25009  |                            If gbuMGetUPDRec.N(lRe
25055  |                                .Cells(StartLine +||25010  |                                .Cells(StartLine +
25056  |                            Else                  ||25011  |                            Else                  
25057  |                                .Cells(StartLine +||25012  |                                .Cells(StartLine +
25058  |                            End If                ||25013  |                            End If                
25059  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||25014  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
25060  |                            .Cells(StartLine + Kik||25015  |                            .Cells(StartLine + Kik
25061  |                            '計算期間の純資産総額 ||25016  |                            '計算期間の純資産総額 
25062  |                            .Cells(StartLine + Kik||25017  |                            .Cells(StartLine + Kik
25063  |                            If gtypOtherComRec(i).||25018  |                            If gtypOtherComRec(i).
25064  |                                .Cells(StartLine +||25019  |                                .Cells(StartLine +
25065  |                            Else                  ||25020  |                            Else                  
25066  |                                .Cells(StartLine +||25021  |                                .Cells(StartLine +
25067  |                            End If                ||25022  |                            End If                
25068  |                            .Cells(StartLine + Kik||25023  |                            .Cells(StartLine + Kik
25069  |                            '計算期間の純資産総額 ||25024  |                            '計算期間の純資産総額 
25070  |                            .Cells(StartLine + Kik||25025  |                            .Cells(StartLine + Kik
25071  |                            'NAV区分が '1' の場合 ||25026  |                            'NAV区分が '1' の場合 
25072  |                            If NavGetFlg = "1" The||25027  |                            If NavGetFlg = "1" The
25073  |                                dblValueIn = gtypO||25028  |                                dblValueIn = gtypO
25074  |                            '日次の場合           ||25029  |                            '日次の場合           
25075  |                            Else                  ||25030  |                            Else                  
25076  |                                dblValueIn = gtypO||25031  |                                dblValueIn = gtypO
25077  |                            End If                ||25032  |                            End If                
25078  |                            If gtypOtherComRec(i).||25033  |                            If gtypOtherComRec(i).
25079  |                                  Call sbGetRoundV||25034  |                                  Call sbGetRoundV
25080  |                            Else                  ||25035  |                            Else                  
25081  |                                  Call sbGetRoundV||25036  |                                  Call sbGetRoundV
25082  |                            End If                ||25037  |                            End If                
25083  |                            '平均NAV(計算対象NAV) ||25038  |                            '平均NAV(計算対象NAV) 
25084  |                            If gtypOtherComRec(i).||25039  |                            If gtypOtherComRec(i).
25085  |                                .Cells(StartLine +||25040  |                                .Cells(StartLine +
25086  |                            Else                  ||25041  |                            Else                  
25087  |                                .Cells(StartLine +||25042  |                                .Cells(StartLine +
25088  |                            End If                ||25043  |                            End If                
25089  |                            '÷??＝ ,文言         ||25044  |                            '÷??＝ ,文言         
25090  |                            'NAV区分が '1' の場合 ||25045  |                            'NAV区分が '1' の場合 
25091  |                            If NavGetFlg = "1" The||25046  |                            If NavGetFlg = "1" The
25092  |                                .Cells(StartLine +||25047  |                                .Cells(StartLine +
25093  |                            '日次の場合           ||25048  |                            '日次の場合           
25094  |                            Else                  ||25049  |                            Else                  
25095  |                                .Cells(StartLine +||25050  |                                .Cells(StartLine +
25096  |                            End If                ||25051  |                            End If                
25097  |                        '年率                     ||25052  |                        '年率                     
25098  |                            .Cells(StartLine + Add||25053  |                            .Cells(StartLine + Add
25099  |                            .Cells(StartLine + Add||25054  |                            .Cells(StartLine + Add
25100  |                            Select Case gbuMGetUPD||25055  |                            Select Case gbuMGetUPD
25101  |                                Case cAud         ||25056  |                                Case cAud         
25102  |                                    .Cells(StartLi||25057  |                                    .Cells(StartLi
25103  |                                        sWord26a &||25058  |                                        sWord26a &
25104  |                                        sAuda & sW||25059  |                                        sAuda & sW
25105  |                                Case cCad         ||25060  |                                Case cCad         
25106  |                                    .Cells(StartLi||25061  |                                    .Cells(StartLi
25107  |                                        sWord26a &||25062  |                                        sWord26a &
25108  |                                        sCada & sW||25063  |                                        sCada & sW
25109  |                                Case cChf         ||25064  |                                Case cChf         
25110  |                                    .Cells(StartLi||25065  |                                    .Cells(StartLi
25111  |                                        sWord26a &||25066  |                                        sWord26a &
25112  |                                        sChfa & sW||25067  |                                        sChfa & sW
25113  |                                Case cEur         ||25068  |                                Case cEur         
25114  |                                    .Cells(StartLi||25069  |                                    .Cells(StartLi
25115  |                                        sWord26a &||25070  |                                        sWord26a &
25116  |                                        sEura & sW||25071  |                                        sEura & sW
25117  |                                Case cGbp         ||25072  |                                Case cGbp         
25118  |                                    .Cells(StartLi||25073  |                                    .Cells(StartLi
25119  |                                        sWord26a &||25074  |                                        sWord26a &
25120  |                                        sGbpa & sW||25075  |                                        sGbpa & sW
25121  |                                Case cHkd         ||25076  |                                Case cHkd         
25122  |                                    .Cells(StartLi||25077  |                                    .Cells(StartLi
25123  |                                        sWord26a &||25078  |                                        sWord26a &
25124  |                                        sHkda & sW||25079  |                                        sHkda & sW
25125  |                                Case cJpy         ||25080  |                                Case cJpy         
25126  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||25081  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
25127  |                                '取得NAV区分が4:日||25082  |                                '取得NAV区分が4:日
25128  |                                If gbuMGetUPDRec.N||25083  |                                If gbuMGetUPDRec.N
25129  |                                    .Cells(StartLi||25084  |                                    .Cells(StartLi
25130  |                                        sWord26a &||25085  |                                        sWord26a &
25131  |                                        sYena & sW||25086  |                                        sYena & sW
25132  |                                Else              ||25087  |                                Else              
25133  |                                    .Cells(StartLi||25088  |                                    .Cells(StartLi
25134  |                                        sWord26a &||25089  |                                        sWord26a &
25135  |                                        sYena & sW||25090  |                                        sYena & sW
25136  |                                End If            ||25091  |                                End If            
25137  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||25092  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
25138  |                                Case cMyr         ||25093  |                                Case cMyr         
25139  |                                    .Cells(StartLi||25094  |                                    .Cells(StartLi
25140  |                                        sWord26a &||25095  |                                        sWord26a &
25141  |                                        sMyra & sW||25096  |                                        sMyra & sW
25142  |                                Case cNzd         ||25097  |                                Case cNzd         
25143  |                                    .Cells(StartLi||25098  |                                    .Cells(StartLi
25144  |                                        sWord26a &||25099  |                                        sWord26a &
25145  |                                        sNzda & sW||25100  |                                        sNzda & sW
25146  |                                Case cSek         ||25101  |                                Case cSek         
25147  |                                    .Cells(StartLi||25102  |                                    .Cells(StartLi
25148  |                                        sWord26a &||25103  |                                        sWord26a &
25149  |                                        sSeka & sW||25104  |                                        sSeka & sW
25150  |                                Case cSgd         ||25105  |                                Case cSgd         
25151  |                                    .Cells(StartLi||25106  |                                    .Cells(StartLi
25152  |                                        sWord26a &||25107  |                                        sWord26a &
25153  |                                        sSgda & sW||25108  |                                        sSgda & sW
25154  |                                Case cUsd         ||25109  |                                Case cUsd         
25155  |                                    .Cells(StartLi||25110  |                                    .Cells(StartLi
25156  |                                        sWord26a &||25111  |                                        sWord26a &
25157  |                                        sUsda & sW||25112  |                                        sUsda & sW
25158  |                                Case cNok         ||25113  |                                Case cNok         
25159  |                                    .Cells(StartLi||25114  |                                    .Cells(StartLi
25160  |                                        sWord26a &||25115  |                                        sWord26a &
25161  |                                        sNoka & sW||25116  |                                        sNoka & sW
25162  |                            End Select            ||25117  |                            End Select            
25163  |                            '年率　累積値セット   ||25118  |                            '年率　累積値セット   
25164  |                            TotalRate = CCur(gtypO||25119  |                            TotalRate = CCur(gtypO
25165  |                                                  ||25120  |                                                  
25166  |                        ElseIf J = UBound(gtypOthe||25121  |                        ElseIf J = UBound(gtypOthe
25167  |                            If UBound(gtypOtherCom||25122  |                            If UBound(gtypOtherCom
25168  |                                '年率最終行       ||25123  |                                '年率最終行       
25169  |                                '前半金額部分     ||25124  |                                '前半金額部分     
25170  |                                .Cells(StartLine +||25125  |                                .Cells(StartLine +
25171  |                                If gbuMGetUPDRec.N||25126  |                                If gbuMGetUPDRec.N
25172  |                                    .Cells(StartLi||25127  |                                    .Cells(StartLi
25173  |                                Else              ||25128  |                                Else              
25174  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||25129  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
25175  |                                    '取得NAV区分が||25130  |                                    '取得NAV区分が
25176  |                                    If gbuMGetUPDR||25131  |                                    If gbuMGetUPDR
25177  |                                        .Cells(Sta||25132  |                                        .Cells(Sta
25178  |                                    Else          ||25133  |                                    Else          
25179  |                                        .Cells(Sta||25134  |                                        .Cells(Sta
25180  |                                    End If        ||25135  |                                    End If        
25181  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||25136  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
25182  |                                End If            ||25137  |                                End If            
25183  |                                '後半の文言       ||25138  |                                '後半の文言       
25184  |                                .Cells(StartLine +||25139  |                                .Cells(StartLine +
25185  |                                Select Case gbuMGe||25140  |                                Select Case gbuMGe
25186  |                                    Case cAud     ||25141  |                                    Case cAud     
25187  |                                        .Cells(Sta||25142  |                                        .Cells(Sta
25188  |                                            sAuda ||25143  |                                            sAuda 
25189  |                                    Case cCad     ||25144  |                                    Case cCad     
25190  |                                        .Cells(Sta||25145  |                                        .Cells(Sta
25191  |                                            sCada ||25146  |                                            sCada 
25192  |                                    Case cChf     ||25147  |                                    Case cChf     
25193  |                                        .Cells(Sta||25148  |                                        .Cells(Sta
25194  |                                            sChfa ||25149  |                                            sChfa 
25195  |                                    Case cEur     ||25150  |                                    Case cEur     
25196  |                                        .Cells(Sta||25151  |                                        .Cells(Sta
25197  |                                            sEura ||25152  |                                            sEura 
25198  |                                    Case cGbp     ||25153  |                                    Case cGbp     
25199  |                                        .Cells(Sta||25154  |                                        .Cells(Sta
25200  |                                            sGbpa ||25155  |                                            sGbpa 
25201  |                                    Case cHkd     ||25156  |                                    Case cHkd     
25202  |                                        .Cells(Sta||25157  |                                        .Cells(Sta
25203  |                                            sHkda ||25158  |                                            sHkda 
25204  |                                    Case cJpy     ||25159  |                                    Case cJpy     
25205  |                                        .Cells(Sta||25160  |                                        .Cells(Sta
25206  |                                            sYena ||25161  |                                            sYena 
25207  |                                    Case cMyr     ||25162  |                                    Case cMyr     
25208  |                                        .Cells(Sta||25163  |                                        .Cells(Sta
25209  |                                            sMyra ||25164  |                                            sMyra 
25210  |                                    Case cNzd     ||25165  |                                    Case cNzd     
25211  |                                        .Cells(Sta||25166  |                                        .Cells(Sta
25212  |                                            sNzda ||25167  |                                            sNzda 
25213  |                                    Case cSek     ||25168  |                                    Case cSek     
25214  |                                        .Cells(Sta||25169  |                                        .Cells(Sta
25215  |                                            sSeka ||25170  |                                            sSeka 
25216  |                                    Case cSgd     ||25171  |                                    Case cSgd     
25217  |                                        .Cells(Sta||25172  |                                        .Cells(Sta
25218  |                                            sSgda ||25173  |                                            sSgda 
25219  |                                    Case cUsd     ||25174  |                                    Case cUsd     
25220  |                                        .Cells(Sta||25175  |                                        .Cells(Sta
25221  |                                            sUsda ||25176  |                                            sUsda 
25222  |                                    Case cNok     ||25177  |                                    Case cNok     
25223  |                                        .Cells(Sta||25178  |                                        .Cells(Sta
25224  |                                            sNoka ||25179  |                                            sNoka 
25225  |                                End Select        ||25180  |                                End Select        
25226  |                            Else                  ||25181  |                            Else                  
25227  |                                '年率最終行       ||25182  |                                '年率最終行       
25228  |                                '前半金額部分     ||25183  |                                '前半金額部分     
25229  |                                .Cells(StartLine +||25184  |                                .Cells(StartLine +
25230  |                                If gbuMGetUPDRec.N||25185  |                                If gbuMGetUPDRec.N
25231  |                                    .Cells(StartLi||25186  |                                    .Cells(StartLi
25232  |                                Else              ||25187  |                                Else              
25233  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||25188  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
25234  |                                    '取得NAV区分が||25189  |                                    '取得NAV区分が
25235  |                                    If gbuMGetUPDR||25190  |                                    If gbuMGetUPDR
25236  |                                        .Cells(Sta||25191  |                                        .Cells(Sta
25237  |                                    Else          ||25192  |                                    Else          
25238  |                                        .Cells(Sta||25193  |                                        .Cells(Sta
25239  |                                    End If        ||25194  |                                    End If        
25240  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||25195  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
25241  |                                End If            ||25196  |                                End If            
25242  |                                '後半の文言       ||25197  |                                '後半の文言       
25243  |                                .Cells(StartLine +||25198  |                                .Cells(StartLine +
25244  |                                Select Case gbuMGe||25199  |                                Select Case gbuMGe
25245  |                                    Case cAud     ||25200  |                                    Case cAud     
25246  |                                        .Cells(Sta||25201  |                                        .Cells(Sta
25247  |                                            sAuda ||25202  |                                            sAuda 
25248  |                                    Case cCad     ||25203  |                                    Case cCad     
25249  |                                        .Cells(Sta||25204  |                                        .Cells(Sta
25250  |                                            sCada ||25205  |                                            sCada 
25251  |                                    Case cChf     ||25206  |                                    Case cChf     
25252  |                                        .Cells(Sta||25207  |                                        .Cells(Sta
25253  |                                            sChfa ||25208  |                                            sChfa 
25254  |                                    Case cEur     ||25209  |                                    Case cEur     
25255  |                                        .Cells(Sta||25210  |                                        .Cells(Sta
25256  |                                            sEura ||25211  |                                            sEura 
25257  |                                    Case cGbp     ||25212  |                                    Case cGbp     
25258  |                                        .Cells(Sta||25213  |                                        .Cells(Sta
25259  |                                            sGbpa ||25214  |                                            sGbpa 
25260  |                                    Case cHkd     ||25215  |                                    Case cHkd     
25261  |                                        .Cells(Sta||25216  |                                        .Cells(Sta
25262  |                                            sHkda ||25217  |                                            sHkda 
25263  |                                    Case cJpy     ||25218  |                                    Case cJpy     
25264  |                                        .Cells(Sta||25219  |                                        .Cells(Sta
25265  |                                            sYena ||25220  |                                            sYena 
25266  |                                    Case cMyr     ||25221  |                                    Case cMyr     
25267  |                                        .Cells(Sta||25222  |                                        .Cells(Sta
25268  |                                            sMyra ||25223  |                                            sMyra 
25269  |                                    Case cNzd     ||25224  |                                    Case cNzd     
25270  |                                        .Cells(Sta||25225  |                                        .Cells(Sta
25271  |                                            sNzda ||25226  |                                            sNzda 
25272  |                                    Case cSek     ||25227  |                                    Case cSek     
25273  |                                        .Cells(Sta||25228  |                                        .Cells(Sta
25274  |                                            sSeka ||25229  |                                            sSeka 
25275  |                                    Case cSgd     ||25230  |                                    Case cSgd     
25276  |                                        .Cells(Sta||25231  |                                        .Cells(Sta
25277  |                                            sSgda ||25232  |                                            sSgda 
25278  |                                    Case cUsd     ||25233  |                                    Case cUsd     
25279  |                                        .Cells(Sta||25234  |                                        .Cells(Sta
25280  |                                            sUsda ||25235  |                                            sUsda 
25281  |                                    Case cNok     ||25236  |                                    Case cNok     
25282  |                                        .Cells(Sta||25237  |                                        .Cells(Sta
25283  |                                            sNoka ||25238  |                                            sNoka 
25284  |                                End Select        ||25239  |                                End Select        
25285  |                            End If                ||25240  |                            End If                
25286  |                        Else                      ||25241  |                        Else                      
25287  |                            '年率2行目以降        ||25242  |                            '年率2行目以降        
25288  |                            '前半金額部分         ||25243  |                            '前半金額部分         
25289  |                            .Cells(StartLine + Add||25244  |                            .Cells(StartLine + Add
25290  |                            If gbuMGetUPDRec.N(lRe||25245  |                            If gbuMGetUPDRec.N(lRe
25291  |                                .Cells(StartLine +||25246  |                                .Cells(StartLine +
25292  |                                    sWord28a & CSt||25247  |                                    sWord28a & CSt
25293  |                            Else                  ||25248  |                            Else                  
25294  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||25249  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
25295  |                                '取得NAV区分が4:日||25250  |                                '取得NAV区分が4:日
25296  |                                If gbuMGetUPDRec.N||25251  |                                If gbuMGetUPDRec.N
25297  |                                    .Cells(StartLi||25252  |                                    .Cells(StartLi
25298  |                                        sWord66a &||25253  |                                        sWord66a &
25299  |                                Else              ||25254  |                                Else              
25300  |                                    .Cells(StartLi||25255  |                                    .Cells(StartLi
25301  |                                        sWord28a &||25256  |                                        sWord28a &
25302  |                                End If            ||25257  |                                End If            
25303  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||25258  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
25304  |                            End If                ||25259  |                            End If                
25305  |                            '年率　累積値セット   ||25260  |                            '年率　累積値セット   
25306  |                            TotalRate = TotalRate ||25261  |                            TotalRate = TotalRate 
25307  |                            '後半の文言           ||25262  |                            '後半の文言           
25308  |                            .Cells(StartLine + Add||25263  |                            .Cells(StartLine + Add
25309  |                            Select Case gbuMGetUPD||25264  |                            Select Case gbuMGetUPD
25310  |                                Case cAud         ||25265  |                                Case cAud         
25311  |                                    .Cells(StartLi||25266  |                                    .Cells(StartLi
25312  |                                        sAuda & sW||25267  |                                        sAuda & sW
25313  |                                        Format(gty||25268  |                                        Format(gty
25314  |                                Case cCad         ||25269  |                                Case cCad         
25315  |                                    .Cells(StartLi||25270  |                                    .Cells(StartLi
25316  |                                        sCada & sW||25271  |                                        sCada & sW
25317  |                                        Format(gty||25272  |                                        Format(gty
25318  |                                Case cChf         ||25273  |                                Case cChf         
25319  |                                    .Cells(StartLi||25274  |                                    .Cells(StartLi
25320  |                                        sChfa & sW||25275  |                                        sChfa & sW
25321  |                                        Format(gty||25276  |                                        Format(gty
25322  |                                Case cEur         ||25277  |                                Case cEur         
25323  |                                    .Cells(StartLi||25278  |                                    .Cells(StartLi
25324  |                                        sEura & sW||25279  |                                        sEura & sW
25325  |                                        Format(gty||25280  |                                        Format(gty
25326  |                                Case cGbp         ||25281  |                                Case cGbp         
25327  |                                    .Cells(StartLi||25282  |                                    .Cells(StartLi
25328  |                                        sGbpa & sW||25283  |                                        sGbpa & sW
25329  |                                        Format(gty||25284  |                                        Format(gty
25330  |                                Case cHkd         ||25285  |                                Case cHkd         
25331  |                                    .Cells(StartLi||25286  |                                    .Cells(StartLi
25332  |                                        sHkda & sW||25287  |                                        sHkda & sW
25333  |                                        Format(gty||25288  |                                        Format(gty
25334  |                                Case cJpy         ||25289  |                                Case cJpy         
25335  |                                    .Cells(StartLi||25290  |                                    .Cells(StartLi
25336  |                                        sYena & sW||25291  |                                        sYena & sW
25337  |                                        Format(gty||25292  |                                        Format(gty
25338  |                                Case cMyr         ||25293  |                                Case cMyr         
25339  |                                    .Cells(StartLi||25294  |                                    .Cells(StartLi
25340  |                                        sMyra & sW||25295  |                                        sMyra & sW
25341  |                                        Format(gty||25296  |                                        Format(gty
25342  |                                Case cNzd         ||25297  |                                Case cNzd         
25343  |                                    .Cells(StartLi||25298  |                                    .Cells(StartLi
25344  |                                        sNzda & sW||25299  |                                        sNzda & sW
25345  |                                        Format(gty||25300  |                                        Format(gty
25346  |                                Case cSek         ||25301  |                                Case cSek         
25347  |                                    .Cells(StartLi||25302  |                                    .Cells(StartLi
25348  |                                        sSeka & sW||25303  |                                        sSeka & sW
25349  |                                        Format(gty||25304  |                                        Format(gty
25350  |                                Case cSgd         ||25305  |                                Case cSgd         
25351  |                                    .Cells(StartLi||25306  |                                    .Cells(StartLi
25352  |                                        sSgda & sW||25307  |                                        sSgda & sW
25353  |                                        Format(gty||25308  |                                        Format(gty
25354  |                                Case cUsd         ||25309  |                                Case cUsd         
25355  |                                    .Cells(StartLi||25310  |                                    .Cells(StartLi
25356  |                                        sUsda & sW||25311  |                                        sUsda & sW
25357  |                                        Format(gty||25312  |                                        Format(gty
25358  |                                Case cNok         ||25313  |                                Case cNok         
25359  |                                    .Cells(StartLi||25314  |                                    .Cells(StartLi
25360  |                                        sNoka & sW||25315  |                                        sNoka & sW
25361  |                                        Format(gty||25316  |                                        Format(gty
25362  |                            End Select            ||25317  |                            End Select            
25363  |                        End If                    ||25318  |                        End If                    
25364  |                        '年率文言の行数をカウント ||25319  |                        '年率文言の行数をカウント 
25365  |                        J_AddCnt = J_AddCnt + 1   ||25320  |                        J_AddCnt = J_AddCnt + 1   
25366  |                    Next J                        ||25321  |                    Next J                        
25367  |                    '年率文言の行数にスペース行を ||25322  |                    '年率文言の行数にスペース行を 
25368  |                    RateCnt = RateCnt + KikanLine ||25323  |                    RateCnt = RateCnt + KikanLine 
25369  |                                                  ||25324  |                                                  
25370  |                    '次料率の行数を取得する       ||25325  |                    '次料率の行数を取得する       
25371  |                    '配列の要素の最大値までを取得 ||25326  |                    '配列の要素の最大値までを取得 
25372  |                    If i < UBound(gtypOtherComRec)||25327  |                    If i < UBound(gtypOtherComRec)
25373  |                        For Idx_i = i + 1 To i + 1||25328  |                        For Idx_i = i + 1 To i + 1
25374  |                            '料率カウント変数を初 ||25329  |                            '料率カウント変数を初 
25375  |                            J_Cnt = 0             ||25330  |                            J_Cnt = 0             
25376  |                            For Idx_j = LBound(gty||25331  |                            For Idx_j = LBound(gty
25377  |                                '料率の数を積算   ||25332  |                                '料率の数を積算   
25378  |                                J_Cnt = J_Cnt + 1 ||25333  |                                J_Cnt = J_Cnt + 1 
25379  |                            Next Idx_j            ||25334  |                            Next Idx_j            
25380  |                            AddRateCnt = (((J_Cnt ||25335  |                            AddRateCnt = (((J_Cnt 
25381  |                        Next Idx_i                ||25336  |                        Next Idx_i                
25382  |                    End If                        ||25337  |                    End If                        
25383  |                                                  ||25338  |                                                  
25384  |                    '行数を計算する               ||25339  |                    '行数を計算する               
25385  |                    GenPage = RateCnt + AddRateCnt||25340  |                    GenPage = RateCnt + AddRateCnt
25386  |                                                  ||25341  |                                                  
25387  |                    AddRateCnt = 0                ||25342  |                    AddRateCnt = 0                
25388  |                                                  ||25343  |                                                  
25389  |                    '行数が溢れたら改ページ       ||25344  |                    '行数が溢れたら改ページ       
25390  |                    If conSheetLastLine < GenPage ||25345  |                    If conSheetLastLine < GenPage 
25391  |                        'ループの開始ポジション変 ||25346  |                        'ループの開始ポジション変 
25392  |                        SetPoint = Add_i          ||25347  |                        SetPoint = Add_i          
25393  |                        Exit For                  ||25348  |                        Exit For                  
25394  |                    End If                        ||25349  |                    End If                        
25395  |                    '次の開始行をセット           ||25350  |                    '次の開始行をセット           
25396  |                    RateCnt = RateCnt + 1         ||25351  |                    RateCnt = RateCnt + 1         
25397  |                    StartLine = RateCnt           ||25352  |                    StartLine = RateCnt           
25398  |                Next i                            ||25353  |                Next i                            
25399  |            End If                                ||25354  |            End If                                
25400  |                                                  ||25355  |                                                  
25401  |        End With                                  ||25356  |        End With                                  
25402  |        'A4印刷用に上2行を削除して、プレビュー範囲||25357  |        'A4印刷用に上2行を削除して、プレビュー範囲
25403  |        xlSheet.Rows("1:2").Delete Shift:=xlUp    ||25358  |        xlSheet.Rows("1:2").Delete Shift:=xlUp    
25404  |    Next PgIndx                                   ||25359  |    Next PgIndx                                   
25405  |                                                  ||25360  |                                                  
25406  |End Sub                                           ||25361  |End Sub                                           
25407  |                                                  ||25362  |                                                  
25408  |'=================================================||25363  |'=================================================
25409  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   Tax_calc                     ||25364  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   Tax_calc                     
25410  |'機能            :   算出方法の判別処理           ||25365  |'機能            :   算出方法の判別処理           
25411  |'                                                 ||25366  |'                                                 
25412  |'日付               担当                修正内容  ||25367  |'日付               担当                修正内容  
25413  |'-------------------------------------------------||25368  |'-------------------------------------------------
25414  |'2014/02/19         M.Takada<SRA>       新規作成  ||25369  |'2014/02/19         M.Takada<SRA>       新規作成  
25415  |'=================================================||25370  |'=================================================
25416 L|Public Function Tax_calc(ByVal dStart As Date, ByV||25371 R|Public Function Tax_calc(ByVal sStart As Date, ByV
25417  |                                                  ||25372  |                                                  
25418  |    Dim s_Sql       As String           'SQL格納変||25373  |    Dim s_Sql       As String           'SQL格納変
25419 L|    'Dim strUse_Date As String           '最新の適||25374 R|    Dim strUse_Date As String           '最新の適 
25420  |                                                  ||25375  |                                                  
25421  |    '初期化                                       ||25376  |    '初期化                                       
25422  |    intCount = 1                                  ||25377  |    intCount = 1                                  
25423  |    Tax_Flg = False                               ||25378  |    Tax_Flg = False                               
25424  |                                                  ||25379  |                                                  
       |                                                  ||25380 R|                                                  
25425  |    '配列初期化                                   ||25381  |    '配列初期化                                   
25426  |    ReDim strTaxRate(2) '税率の格納配列           ||25382  |    ReDim strTaxRate(2) '税率の格納配列           
25427  |    ReDim strTaxNum(2)  '消費税額の格納配列       ||25383  |    ReDim strTaxNum(2)  '消費税額の格納配列       
25428  |    ReDim intDays(2)    '計算期間の格納配列       ||25384  |    ReDim intDays(2)    '計算期間の格納配列       
25429  |                                                  ||25385  |                                                  
25430  |    'SQL分の作成(税率TBLから格納されている税率を取||25386  |    'SQL分の作成(税率TBLから格納されている税率を取
25431 L|'2014/03/07 ======================================||25387 R|    s_Sql = ""                                    
25432 L|    's_Sql = ""                                   ||25388 R|    s_Sql = s_Sql & " SELECT Max(use_date) AS use_
25433 L|    's_Sql = s_Sql & " SELECT Max(use_date) AS use||25389 R|    s_Sql = s_Sql & " FROM cfr_tax_tbl "          
25434 L|    's_Sql = s_Sql & " FROM cfr_tax_tbl "         ||25390 R|    s_Sql = s_Sql & " WHERE use_date <= sEnd "    
25435 L|    's_Sql = s_Sql & " WHERE use_date < '" & dEnd ||25391 R|                                                  
25436 L|'2014/03/07 ======================================||       |                                                  
25437 L|    s_Sql = ""                                    ||       |                                                  
25438 L|    s_Sql = s_Sql & " SELECT Max(use_date) AS use_||       |                                                  
25439 L|    s_Sql = s_Sql & " WHERE ITEM_FLAG = '1' "     ||       |                                                  
25440 L|    s_Sql = s_Sql & " AND USE_DATE = "            ||       |                                                  
25441 L|    s_Sql = s_Sql & " (SELECT MAX(USE_DATE) AS USE||       |                                                  
25442 L|    s_Sql = s_Sql & " WHERE  ITEM_FLAG = '1' "    ||       |                                                  
25443 L|    s_Sql = s_Sql & " AND USE_DATE < '" & Replace(||       |                                                  
25444 L|                                                  ||       |                                                  
25445  |    'ﾀﾞｲﾅｾｯﾄの作成                                ||25392  |    'ﾀﾞｲﾅｾｯﾄの作成                                
25446  |    If (gintDyCreate(s_Sql) = False) Then         ||25393  |    If (gintDyCreate(s_Sql) = False) Then         
25447  |        Call subError("DBエラー", Str(9999), "gint||25394  |        Call subError("DBエラー", Str(9999), "gint
25448  |            "DB関数エラー", strErrCall, conTitle) ||25395  |            "DB関数エラー", strErrCall, conTitle) 
25449  |        Exit Function                             ||25396  |        Exit Function                             
25450  |    End If                                        ||25397  |    End If                                        
       |                                                  ||25398 R|                                                  
25451  |    '最新の適用開始日を変数に格納                 ||25399  |    '最新の適用開始日を変数に格納                 
25452  |    strUse_Date = gvlnDyDataN("use_date")         ||25400  |    strUse_Date = gvlnDyDataN("use_date")         
25453 L|                                                  ||25401 R|                                                  
25454  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             ||25402  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             
25455  |    Call gblnDyClose                              ||25403  |    Call gblnDyClose                              
25456 L|'2014/03/07 START   M.Takada 【管理会計】消費税率 ||       |                                                  
25457 L|    ''計算期間の取得                              ||       |                                                  
25458 L|    'If (dStart < strUse_Date) And (dEnd >= strUse||       |                                                  
25459 L|    '    '計算期間が税率変更を跨ぐ場合            ||       |                                                  
25460 L|    '    intCount = 1                             ||       |                                                  
25461 L|    '    '税率分割フラグをTrueにする              ||       |                                                  
25462 L|    '    Tax_Flg = True                           ||       |                                                  
25463 L|                                                  ||       |                                                  
25464 L|    '    '適用開始日以降の算出                    ||       |                                                  
25465 L|    '    Call Tax_Change_After(dStart, dEnd)      ||       |                                                  
25466 L|                                                  ||       |                                                  
25467 L|    '    '配列カウンターの加算                    ||       |                                                  
25468 L|    '    intCount = intCount + 1                  ||       |                                                  
25469 L|                                                  ||       |                                                  
25470 L|    '    '適用開始日以前の算出                    ||       |                                                  
25471 L|    '    Call Tax_Change_Before(dStart, dEnd)     ||       |                                                  
25472 L|                                                  ||       |                                                  
25473 L|    'ElseIf (dEnd < strUse_Date) Then             ||       |                                                  
25474 L|    '    '計算期間が税率変更前のみの場合          ||       |                                                  
25475 L|    '    intCount = 2                             ||       |                                                  
25476 L|    '    Call Tax_Change_Before(dStart, dEnd)     ||       |                                                  
25477 L|    '    Tax_Flg = False                          ||       |                                                  
25478 L|    'Else                                         ||       |                                                  
25479 L|    '    '計算期間が税率変更後のみの場合          ||       |                                                  
25480 L|    '    intCount = 1                             ||       |                                                  
25481 L|    '    Call Tax_Change_After(dStart, dEnd)      ||       |                                                  
25482 L|    '    Tax_Flg = False                          ||       |                                                  
25483 L|    'End If                                       ||       |                                                  
25484 L|                                                  ||       |                                                  
25485 L|    '計算期間の取得                               ||       |                                                  
25486 L|    If (CDate(gstrDateFormat(strUse_Date, 1)) < dS||       |                                                  
25487 L|        '計算期間に税率変更なしの場合             ||       |                                                  
25488 L|        '最新の適用税率を取得するSQL文を作成("計算||       |                                                  
25489 L|        s_Sql = ""                                ||       |                                                  
25490 L|        s_Sql = s_Sql & " SELECT tax_rate FROM cfr||       |                                                  
25491 L|        s_Sql = s_Sql & " WHERE ITEM_FLAG = '1' AN||       |                                                  
25492 L|        s_Sql = s_Sql & " USE_DATE = '" & strUse_D||       |                                                  
25493 L|                                                  ||       |                                                  
25494 L|        'ﾀﾞｲﾅｾｯﾄの作成                            ||       |                                                  
25495 L|        If (gintDyCreate(s_Sql) = False) Then     ||       |                                                  
25496 L|            Call subError("DBエラー", Str(9999), "||       |                                                  
25497 L|                "DB関数エラー", strErrCall, conTit||       |                                                  
25498 L|            Exit Function                         ||       |                                                  
25499 L|        End If                                    ||14174 M|        End If                                    
25500 L|                                                  ||25404 R|                                                  
25501 L|        '最新の適用税率を変数に格納               ||25405 R|    '計算期間の取得                               
25502 L|        strNoChgTaxRate = gvlnDyDataN("tax_rate") ||25406 R|    If (sStart < strUse_Date) And (sEnd >= strUse_
25503 L|                                                  ||       |                                                  
25504 L|        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         ||       |                                                  
25505 L|        Call gblnDyClose                          ||       |                                                  
25506 L|        '税額算出(小数以下がある場合、小数部を切り||       |                                                  
25507 L|        xlSheet.Cells(49, 29).NumberFormatLocal = ||       |                                                  
25508 L|        xlSheet.Cells(49, 29).Value = CStr(Format(||       |                                                  
25509 L|        xlSheet.Cells(49, 29).HorizontalAlignment ||       |                                                  
25510 L|        '下線                                     ||       |                                                  
25511 L|        With xlSheet.Range("M49:AL49").Borders(xlE||       |                                                  
25512 L|                    .LineStyle = xlContinuous     ||       |                                                  
25513 L|                    .Weight = xlThin              ||       |                                                  
25514 L|        End With                                  ||       |                                                  
25515 L|                                                  ||       |                                                  
25516 L|        Tax_Flg = False                           ||       |                                                  
25517 L|                                                  ||       |                                                  
25518 L|    ElseIf (dStart < CDate(gstrDateFormat(strUse_D||       |                                                  
25519  |        '計算期間が税率変更を跨ぐ場合             ||25407  |        '計算期間が税率変更を跨ぐ場合             
25520  |        intCount = 1                              ||25408  |        intCount = 1                              
25521  |        '税率分割フラグをTrueにする               ||25409  |        '税率分割フラグをTrueにする               
25522  |        Tax_Flg = True                            ||25410  |        Tax_Flg = True                            
25523  |                                                  ||25411  |                                                  
25524  |        '適用開始日以降の算出                     ||25412  |        '適用開始日以降の算出                     
25525 L|        Call Tax_Change_After(dStart, dEnd)       ||25413 R|        Call Tax_Change_After(sStart, sEnd)       
25526  |                                                  ||25414  |                                                  
25527  |        '配列カウンターの加算                     ||25415  |        '配列カウンターの加算                     
25528  |        intCount = intCount + 1                   ||25416  |        intCount = intCount + 1                   
25529  |                                                  ||25417  |                                                  
25530  |        '適用開始日以前の算出                     ||25418  |        '適用開始日以前の算出                     
25531 L|        Call Tax_Change_Before(dStart, dEnd)      ||25419 R|        Call Tax_Change_Before(sStart, sEnd)      
25532 L|                                                  ||25420 R|                                                  
25533 L|    End If                                        ||25421 R|                                                  
25534 L|'2014/03/07 END     M.Takada 【管理会計】消費税率 ||25422 R|    ElseIf (sEnd < strUse_Date) Then              
25535 L|                                                  ||25423 R|        '計算期間が税率変更前のみの場合           
       |                                                  ||25424 R|        intCount = 2                              
       |                                                  ||25425 R|        Call Tax_Change_Before(sStart, sEnd)      
       |                                                  ||25426 R|        Tax_Flg = False                           
       |                                                  ||25427 R|    Else                                          
       |                                                  ||25428 R|        '計算期間が税率変更後のみの場合           
       |                                                  ||25429 R|        intCount = 1                              
       |                                                  ||25430 R|        Call Tax_Change_After(sStart, sEnd)       
       |                                                  ||25431 R|        Tax_Flg = False                           
       |                                                  ||25432 R|    End If                                        
25536  |End Function                                      ||25433  |End Function                                      
25537  |                                                  ||25434  |                                                  
25538  |'=================================================||25435  |'=================================================
25539  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   Tax_Change_Before            ||25436  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   Tax_Change_Before            
25540  |'機能            :   (税率変更前)計算日数・税率・ ||25437  |'機能            :   (税率変更前)計算日数・税率・ 
25541  |'                                                 ||25438  |'                                                 
25542  |'日付               担当　              修正内容  ||25439  |'日付               担当　              修正内容  
25543  |'-------------------------------------------------||25440  |'-------------------------------------------------
25544  |'2014/02/19         M.Takada<SRA>        新規作成 ||25441  |'2014/02/19         M.Takada<SRA>        新規作成 
25545  |'=================================================||25442  |'=================================================
25546 L|Public Function Tax_Change_Before(ByVal dStart As ||25443 R|Public Function Tax_Change_Before(ByVal sStart As 
25547 L|    Dim s_Sql       As String           'SQL格納変||25444 R|                                                  
25548 L|    Dim strOldUseDate As String                   ||25445 R|    ReDim intDays(intCount)                       
25549 L|    intCount = 2                                  ||25446 R|    ReDim strTaxRate(intCount)                    
25550 L|                                                  ||25447 R|    ReDim strTaxNum(intCount)                     
25551 L|    ReDim Preserve intDays(intCount)              ||       |                                                  
25552 L|    ReDim Preserve strPayNum(intCount)            ||       |                                                  
25553 L|    ReDim Preserve strTaxRate(intCount)           ||       |                                                  
25554 L|    ReDim Preserve strTaxNum(intCount)            ||       |                                                  
25555  |                                                  ||25448  |                                                  
25556  |     '計算開始日〜変更前までの計算日数･税率･消費税||25449  |     '計算開始日〜変更前までの計算日数･税率･消費税
25557 L|     intDays(intCount) = DateDiff("d", dStart, CDa||25450 R|     intDays(intCount) = DateDiff("d", (strUse_Dat
25558 L|                                                  ||25451 R|                                                  
25559 L|                                                  ||25452 R|     '税率の取得SQLの作成                         
25560 L|    '税率の取得SQLの作成                          ||25453 R|     s_Sql = ""                                   
25561 L|'2014/03/07 START   M.Takada 【管理会計】消費税率 ||25454 R|     s_Sql = s_Sql & " SELECT tax_rate "          
25562 L|    's_Sql = ""                                   ||25455 R|     s_Sql = s_Sql & " FROM cfr_tax_tbl "         
25563 L|    's_Sql = s_Sql & " SELECT Max(tax_rate)  AS TA||25456 R|     s_Sql = s_Sql & " WHERE use_date Between '" &
25564 L|    's_Sql = s_Sql & " WHERE ITEM_FLAG = '1' AND U||       |                                                  
25565 L|    s_Sql = ""                                    ||       |                                                  
25566 L|    s_Sql = s_Sql & "SELECT Max(use_date) AS use_d||       |                                                  
25567 L|    s_Sql = s_Sql & "WHERE ITEM_FLAG = '1' "      ||       |                                                  
25568 L|    s_Sql = s_Sql & "AND USE_DATE = "             ||       |                                                  
25569 L|    s_Sql = s_Sql & "(SELECT MAX(USE_DATE) AS USE_||       |                                                  
25570 L|    s_Sql = s_Sql & "WHERE  ITEM_FLAG = '1'"      ||       |                                                  
25571 L|    s_Sql = s_Sql & "AND USE_DATE < '" & Replace(d||       |                                                  
25572 L|                                                  ||       |                                                  
25573 L|    'ﾀﾞｲﾅｾｯﾄの作成                                ||       |                                                  
25574 L|    If (gintDyCreate(s_Sql) = False) Then         ||       |                                                  
25575 L|        Call subError("DBエラー", Str(9999), "gint||       |                                                  
25576 L|            "DB関数エラー", strErrCall, conTitle) ||       |                                                  
25577 L|        Exit Function                             ||       |                                                  
25578 L|    End If                                        ||       |                                                  
25579 L|    '最新の適用開始日を変数に格納                 ||       |                                                  
25580 L|    strOldUseDate = gvlnDyDataN("use_date")       ||       |                                                  
25581 L|                                                  ||       |                                                  
25582 L|    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             ||       |                                                  
25583 L|    Call gblnDyClose                              ||       |                                                  
25584 L|                                                  ||       |                                                  
25585 L|    s_Sql = ""                                    ||       |                                                  
25586 L|    s_Sql = s_Sql & " SELECT tax_rate FROM cfr_tax||       |                                                  
25587 L|    s_Sql = s_Sql & " WHERE ITEM_FLAG = '1' AND " ||       |                                                  
25588 L|    s_Sql = s_Sql & " USE_DATE = '" & strOldUseDat||       |                                                  
25589 L|                                                  ||       |                                                  
25590 L|'2014/03/07 END     M.Takada 【管理会計】消費税率 ||       |                                                  
25591  |                                                  ||25457  |                                                  
25592  |     'ﾀﾞｲﾅｾｯﾄの作成                               ||25458  |     'ﾀﾞｲﾅｾｯﾄの作成                               
25593  |     If (gintDyCreate(s_Sql) = False) Then        ||25459  |     If (gintDyCreate(s_Sql) = False) Then        
25594  |         Call subError("DBエラー", Str(9999), "gin||25460  |         Call subError("DBエラー", Str(9999), "gin
25595  |             "DB関数エラー", strErrCall, conTitle)||25461  |             "DB関数エラー", strErrCall, conTitle)
25596  |         Exit Function                            ||25462  |         Exit Function                            
25597  |     End If                                       ||25463  |     End If                                       
25598  |                                                  ||25464  |                                                  
25599  |     '税率格納                                    ||25465  |     '税率格納                                    
25600  |     strTaxRate(intCount) = gvlnDyDataN("tax_rate"||25466  |     strTaxRate(intCount) = gvlnDyDataN("tax_rate"
25601  |                                                  ||25467  |                                                  
25602  |     '支払額                                      ||25468  |     '支払額                                      
25603 L|'2014/03/07 START   M.Takada 【管理会計】消費税率 ||25469 R|        If Tax_Flg = True Then                    
25604 L|     '    If Tax_Flg = True Then                  ||25470 R|            '計算開始日〜適用開始日(前日)までの支 
25605 L|     '       '計算開始日〜適用開始日(前日)までの支||25471 R|            '算出方法：投資顧問料*(計算開始日〜適 
25606 L|     '       '算出方法：投資顧問料*(計算開始日〜適||25472 R|            strChgPay = (mstrMonthlyPayCom * (Date
25607 L|     '       strChgPay = (mstrMonthlyPayCom * (Dat||25473 R|            '算出した値に小数点が存在するか検索し 
25608 L|     '       '算出した値に小数点が存在するか検索し||25474 R|            strPayNum(intCount) = Left(strChgPay, 
25609 L|     '       strPayNum(intCount) = Left(strChgPay,||25475 R|        Else                                      
25610 L|     '   Else                                     ||25476 R|            '消費税率の変更無しの場合、投資顧問料 
25611 L|     '       '消費税率の変更無しの場合、投資顧問料||25477 R|            strPayNum(intCount) = mstrMonthlyPayCo
25612 L|     '       strPayNum(intCount) = mstrMonthlyPayC||25478 R|        End If                                    
25613 L|     '   End If                                   ||       |                                                  
25614 L|                                                  ||       |                                                  
25615 L|    '計算開始日〜適用開始日(前日)までの支払額     ||       |                                                  
25616 L|    '算出方法：投資顧問料*(計算開始日〜適用開始日(||       |                                                  
25617 L|    strChgPay = (mstrMonthlyPayCom * ((DateDiff("d||       |                                                  
25618 L|                                                  ||       |                                                  
25619 L|    '算出した値に小数点が存在するか検索し、整数部 ||       |                                                  
25620 L|    strPayNum(intCount) = Left(strChgPay, InStr(1,||       |                                                  
25621 L|    strPayNum(intCount) = strPayNum(intCount) + 1 ||       |                                                  
25622 L|    'strPayNum(intCount) = Left(strChgPay, InStr(1||       |                                                  
25623 L|                                                  ||       |                                                  
25624 L|'2014/03/07 END     M.Takada 【管理会計】消費税率 ||       |                                                  
25625  |                                                  ||25479  |                                                  
25626  |     '税額算出                                    ||25480  |     '税額算出                                    
25627  |     strTaxNum(intCount) = Left((strPayNum(intCoun||25481  |     strTaxNum(intCount) = Left((strPayNum(intCoun
25628 L|                                                  ||25482 R|                                                  
25629  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             ||25483  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             
25630  |     Call gblnDyClose                             ||25484  |     Call gblnDyClose                             
25631  |End Function                                      ||25485  |End Function                                      
25632  |                                                  ||25486  |                                                  
25633  |                                                  ||25487  |                                                  
25634  |'=================================================||25488  |'=================================================
25635  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   Tax_Change_After             ||25489  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   Tax_Change_After             
25636  |'機能            :   (税率変更後)計算日数・税率・ ||25490  |'機能            :   (税率変更後)計算日数・税率・ 
25637  |'                                                 ||25491  |'                                                 
25638  |'日付               担当　              修正内容  ||25492  |'日付               担当　              修正内容  
25639  |'-------------------------------------------------||25493  |'-------------------------------------------------
25640  |'2014/02/19         M.Takada<SRA>        新規作成 ||25494  |'2014/02/19         M.Takada<SRA>        新規作成 
25641  |'=================================================||25495  |'=================================================
25642 L|Public Function Tax_Change_After(ByVal dStart As D||25496 R|Public Function Tax_Change_After(ByVal sStart As D
25643 L|    Dim s_Sql       As String           'SQL格納変||25497 R|                                                  
25644 L|    intCount = 1                                  ||25498 R|    ReDim intDays(intCount)                       
25645 L|    ReDim Preserve intDays(intCount)              ||25499 R|    ReDim strPayNum(intCount)                     
25646 L|    ReDim Preserve strPayNum(intCount)            ||25500 R|    ReDim strTaxRate(intCount)                    
25647 L|    ReDim Preserve strTaxRate(intCount)           ||25501 R|    ReDim strTaxNum(intCount)                     
25648 L|    ReDim Preserve strTaxNum(intCount)            ||25502 R|                                                  
25649 L|                                                  ||       |                                                  
25650  |     '変更後〜計算終了日までの計算日数･税率･消費税||25503  |     '変更後〜計算終了日までの計算日数･税率･消費税
25651 L|    intDays(intCount) = DateDiff("d", CDate(gstrDa||25504 R|     intDays(intCount) = DateDiff("d", strUse_Date
25652 L|                                                  ||25505 R|                                                  
25653  |     '税率の取得SQLの作成                         ||25506  |     '税率の取得SQLの作成                         
25654  |     s_Sql = ""                                   ||25507  |     s_Sql = ""                                   
25655 L|     s_Sql = s_Sql & "SELECT tax_rate "           ||25508 R|     s_Sql = s_Sql & " SELECT tax_rate "          
25656 L|     s_Sql = s_Sql & "FROM cfr_tax_tbl "          ||25509 R|     s_Sql = s_Sql & " FROM cfr_tax_tbl "         
25657 L|     s_Sql = s_Sql & "WHERE use_date = '" & strUse||25510 R|     s_Sql = s_Sql & " WHERE use_date = '" & strUs
25658  |                                                  ||25511  |                                                  
25659  |     'ﾀﾞｲﾅｾｯﾄの作成                               ||25512  |     'ﾀﾞｲﾅｾｯﾄの作成                               
25660  |     If (gintDyCreate(s_Sql) = False) Then        ||25513  |     If (gintDyCreate(s_Sql) = False) Then        
25661  |         Call subError("DBエラー", Str(9999), "gin||25514  |         Call subError("DBエラー", Str(9999), "gin
25662  |             "DB関数エラー", strErrCall, conTitle)||25515  |             "DB関数エラー", strErrCall, conTitle)
25663  |         Exit Function                            ||25516  |         Exit Function                            
25664  |     End If                                       ||25517  |     End If                                       
25665  |                                                  ||25518  |                                                  
25666 L|    '税率格納                                     ||25519 R|     '税率格納                                    
25667 L|    strTaxRate(intCount) = gvlnDyDataN("tax_rate")||25520 R|     strTaxRate(intCount) = gvlnDyDataN("tax_rate"
25668  |                                                  ||25521  |                                                  
25669  |     '支払額                                      ||25522  |     '支払額                                      
25670 L|'2014/03/07 START   M.Takada 【管理会計】消費税率 ||25523 R|        If Tax_Flg = True Then                    
25671 L|        'If Tax_Flg = True Then                   ||25524 R|            '適用開始日〜計算終了日までの支払額   
25672 L|        '    '適用開始日〜計算終了日までの支払額  ||25525 R|            '算出方法：投資顧問料*(適用開始日〜計 
25673 L|        '    '算出方法：投資顧問料*(適用開始日〜計||25526 R|            strChgPay = (mstrMonthlyPayCom * (Date
25674 L|        '    strChgPay = (mstrMonthlyPayCom * (Dat||25527 R|            '算出した支払額に小数以下がある場合、 
25675 L|        '    '算出した支払額に小数以下がある場合、||25528 R|            If InStr(1, strChgPay, ".") <> 0 Then 
25676 L|        '    If InStr(1, strChgPay, ".") <> 0 Then||25529 R|                strPayNum(intCount) = Left(strChgP
25677 L|        '        strPayNum(intCount) = Left(strChg||       |                                                  
25678 L|        '    Else                                 ||       |                                                  
25679 L|        '    End If                               ||       |                                                  
25680 L|        'Else                                     ||       |                                                  
25681 L|        '    '消費税率の変更無しの場合、投資顧問料||       |                                                  
25682 L|        '    strPayNum(intCount) = mstrMonthlyPayC||       |                                                  
25683 L|        'End If                                   ||       |                                                  
25684 L|                                                  ||       |                                                  
25685 L|    '適用開始日〜計算終了日までの支払額           ||       |                                                  
25686 L|    '算出方法：投資顧問料*(適用開始日〜計算終了日)||       |                                                  
25687 L|    strChgPay = (mstrMonthlyPayCom * (DateDiff("d"||       |                                                  
25688 L|                                                  ||       |                                                  
25689 L|    '算出した支払額に小数以下がある場合、小数部を ||       |                                                  
25690 L|    If InStr(1, strChgPay, ".") <> 0 Then         ||       |                                                  
25691 L|        strPayNum(intCount) = Left(strChgPay, InSt||       |                                                  
25692 L|    Else                                          ||       |                                                  
25693 L|        strPayNum(intCount) = strChgPay           ||       |                                                  
25694 L|    End If                                        ||       |                                                  
25695 L|                                                  ||       |                                                  
25696 L|'2014/03/07 END   M.Takada 【管理会計】消費税率変 ||       |                                                  
25697 L|    '税額算出(小数以下がある場合、小数部を切り捨て||       |                                                  
25698 L|    strTaxNum(intCount) = Left((strPayNum(intCount||       |                                                  
14196 M|            Else                                  ||25530 R|            Else                                  
       |                                                  ||25531 R|            End If                                
       |                                                  ||25532 R|        Else                                      
       |                                                  ||25533 R|            '消費税率の変更無しの場合、投資顧問料 
       |                                                  ||25534 R|            strPayNum(intCount) = mstrMonthlyPayCo
       |                                                  ||25535 R|        End If                                    
       |                                                  ||25536 R|                                                  
       |                                                  ||25537 R|     '税額算出(小数以下がある場合、小数部を切り捨 
       |                                                  ||25538 R|     strTaxNum(intCount) = Left((strPayNum(intCoun
25699  |                                                  ||25539  |                                                  
25700  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             ||25540  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             
25701  |     Call gblnDyClose                             ||25541  |     Call gblnDyClose                             
25702  |                                                  ||25542  |                                                  
25703  |End Function                                      ||25543  |End Function                                      
       |                                                  ||25544 R|                                                  
