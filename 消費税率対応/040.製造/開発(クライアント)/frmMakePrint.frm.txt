[1] : C:\Users\...\修正後\cfrUnpaid\frmMakePrint.frm      | [2] : C:\Users\...\修正前\cfrUnpaid\frmMakePrint.frm      
00001  |VERSION 5.00                                      ||00001  |VERSION 5.00                                      
00002  |Object = "{C0A63B80-4B21-11D3-BD95-D426EF2C7949}#1||00002  |Object = "{C0A63B80-4B21-11D3-BD95-D426EF2C7949}#1
00003  |Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1||00003  |Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1
00004  |Begin VB.Form frmMakePrint                        ||00004  |Begin VB.Form frmMakePrint                        
00005  |   Caption         =   "外部委託顧問料確認書作成" ||00005  |   Caption         =   "外部委託顧問料確認書作成" 
00006  |   ClientHeight    =   5595                       ||00006  |   ClientHeight    =   5595                       
00007  |   ClientLeft      =   165                        ||00007  |   ClientLeft      =   165                        
00008  |   ClientTop       =   855                        ||00008  |   ClientTop       =   855                        
00009  |   ClientWidth     =   9420                       ||00009  |   ClientWidth     =   9420                       
00010  |   LinkTopic       =   "Form1"                    ||00010  |   LinkTopic       =   "Form1"                    
00011  |   LockControls    =   -1  'True                  ||00011  |   LockControls    =   -1  'True                  
00012  |   ScaleHeight     =   5595                       ||00012  |   ScaleHeight     =   5595                       
00013  |   ScaleWidth      =   9420                       ||00013  |   ScaleWidth      =   9420                       
00014  |   StartUpPosition =   3  'Windows の既定値       ||00014  |   StartUpPosition =   3  'Windows の既定値       
00015  |   Begin VB.CommandButton cmdCheckClear           ||00015  |   Begin VB.CommandButton cmdCheckClear           
00016  |      Caption         =   "出力対象全てクリア"    ||00016  |      Caption         =   "出力対象全てクリア"    
00017  |      Height          =   345                     ||00017  |      Height          =   345                     
00018  |      Left            =   390                     ||00018  |      Left            =   390                     
00019  |      TabIndex        =   13                      ||00019  |      TabIndex        =   13                      
00020  |      Top             =   1080                    ||00020  |      Top             =   1080                    
00021  |      Width           =   1935                    ||00021  |      Width           =   1935                    
00022  |   End                                            ||00022  |   End                                            
00023  |   Begin VB.CheckBox chkAllSelect                 ||00023  |   Begin VB.CheckBox chkAllSelect                 
00024  |      Caption         =   "全てチェック"          ||00024  |      Caption         =   "全てチェック"          
00025  |      Height          =   255                     ||00025  |      Height          =   255                     
00026  |      Left            =   2460                    ||00026  |      Left            =   2460                    
00027  |      TabIndex        =   12                      ||00027  |      TabIndex        =   12                      
00028  |      Tag             =   "チェックボックス"      ||00028  |      Tag             =   "チェックボックス"      
00029  |      ToolTipText     =   "全ての出力チェックボッ ||00029  |      ToolTipText     =   "全ての出力チェックボッ 
00030  |      Top             =   1140                    ||00030  |      Top             =   1140                    
00031  |      Visible         =   0   'False              ||00031  |      Visible         =   0   'False              
00032  |      Width           =   1245                    ||00032  |      Width           =   1245                    
00033  |   End                                            ||00033  |   End                                            
00034  |   Begin VB.TextBox txtSysOutDate                 ||00034  |   Begin VB.TextBox txtSysOutDate                 
00035  |      Height          =   300                     ||00035  |      Height          =   300                     
00036  |      IMEMode         =   3  'ｵﾌ固定              ||00036  |      IMEMode         =   3  'ｵﾌ固定              
00037  |      Left            =   6600                    ||00037  |      Left            =   6600                    
00038  |      MaxLength       =   10                      ||00038  |      MaxLength       =   10                      
00039  |      TabIndex        =   3                       ||00039  |      TabIndex        =   3                       
00040  |      Tag             =   "出力日付"              ||00040  |      Tag             =   "出力日付"              
00041  |      Top             =   600                     ||00041  |      Top             =   600                     
00042  |      Width           =   2295                    ||00042  |      Width           =   2295                    
00043  |   End                                            ||00043  |   End                                            
00044  |   Begin VB.ComboBox cboBumonFlag                 ||00044  |   Begin VB.ComboBox cboBumonFlag                 
00045  |      Height          =   300                     ||00045  |      Height          =   300                     
00046  |      Left            =   6600                    ||00046  |      Left            =   6600                    
00047  |      Style           =   2  'ﾄﾞﾛｯﾌﾟﾀﾞｳﾝ ﾘｽﾄ      ||00047  |      Style           =   2  'ﾄﾞﾛｯﾌﾟﾀﾞｳﾝ ﾘｽﾄ      
00048  |      TabIndex        =   1                       ||00048  |      TabIndex        =   1                       
00049  |      Tag             =   "部署名"                ||00049  |      Tag             =   "部署名"                
00050  |      Top             =   120                     ||00050  |      Top             =   120                     
00051  |      Width           =   2280                    ||00051  |      Width           =   2280                    
00052  |   End                                            ||00052  |   End                                            
00053  |   Begin VB.TextBox txtInputTax                   ||00053  |   Begin VB.TextBox txtInputTax                   
00054  |      Alignment       =   1  '右揃え              ||00054  |      Alignment       =   1  '右揃え              
00055  |      Height          =   300                     ||00055  |      Height          =   300                     
00056  |      IMEMode         =   3  'ｵﾌ固定              ||00056  |      IMEMode         =   3  'ｵﾌ固定              
00057  |      Left            =   1545                    ||00057  |      Left            =   1545                    
00058  |      MaxLength       =   2                       ||00058  |      MaxLength       =   2                       
00059  |      TabIndex        =   2                       ||00059  |      TabIndex        =   2                       
00060  |      Tag             =   "消費税率"              ||00060  |      Tag             =   "消費税率"              
00061  |      ToolTipText     =   "入力できるのは整数2桁で||00061  |      ToolTipText     =   "入力できるのは整数2桁で
00062  |      Top             =   600                     ||00062  |      Top             =   600                     
00063  |      Visible         =   0   'False              ||00063  |      Visible         =   0   'False              
00064  |      Width           =   375                     ||00064  |      Width           =   375                     
00065  |   End                                            ||00065  |   End                                            
00066  |   Begin VB.CommandButton cmdCancel               ||00066  |   Begin VB.CommandButton cmdCancel               
00067  |      Caption         =   "キャンセル"            ||00067  |      Caption         =   "キャンセル"            
00068  |      Height          =   375                     ||00068  |      Height          =   375                     
00069  |      Left            =   6600                    ||00069  |      Left            =   6600                    
00070  |      TabIndex        =   5                       ||00070  |      TabIndex        =   5                       
00071  |      Tag             =   "キャンセルコマンドボタ ||00071  |      Tag             =   "キャンセルコマンドボタ 
00072  |      ToolTipText     =   "確認書作成画面を終了し ||00072  |      ToolTipText     =   "確認書作成画面を終了し 
00073  |      Top             =   1080                    ||00073  |      Top             =   1080                    
00074  |      Width           =   2295                    ||00074  |      Width           =   2295                    
00075  |   End                                            ||00075  |   End                                            
00076  |   Begin VB.CommandButton cmdMake                 ||00076  |   Begin VB.CommandButton cmdMake                 
00077  |      Caption         =   "確認書出力"            ||00077  |      Caption         =   "確認書出力"            
00078  |      Height          =   375                     ||00078  |      Height          =   375                     
00079  |      Left            =   4290                    ||00079  |      Left            =   4290                    
00080  |      TabIndex        =   4                       ||00080  |      TabIndex        =   4                       
00081  |      Tag             =   "作成コマンドボタン"    ||00081  |      Tag             =   "作成コマンドボタン"    
00082  |      ToolTipText     =   "確認書を作成します。"  ||00082  |      ToolTipText     =   "確認書を作成します。"  
00083  |      Top             =   1080                    ||00083  |      Top             =   1080                    
00084  |      Width           =   2235                    ||00084  |      Width           =   2235                    
00085  |   End                                            ||00085  |   End                                            
00086  |   Begin VB.TextBox txtInputName                  ||00086  |   Begin VB.TextBox txtInputName                  
00087  |      Height          =   300                     ||00087  |      Height          =   300                     
00088  |      IMEMode         =   1  'ｵﾝ                  ||00088  |      IMEMode         =   1  'ｵﾝ                  
00089  |      Left            =   1545                    ||00089  |      Left            =   1545                    
00090  |      MaxLength       =   10                      ||00090  |      MaxLength       =   10                      
00091  |      TabIndex        =   0                       ||00091  |      TabIndex        =   0                       
00092  |      Tag             =   "担当者"                ||00092  |      Tag             =   "担当者"                
00093  |      Top             =   120                     ||00093  |      Top             =   120                     
00094  |      Width           =   1815                    ||00094  |      Width           =   1815                    
00095  |   End                                            ||00095  |   End                                            
00096  |   Begin MSComDlg.CommonDialog dlgFileOut         ||00096  |   Begin MSComDlg.CommonDialog dlgFileOut         
00097  |      Left            =   120                     ||00097  |      Left            =   120                     
00098  |      Top             =   5040                    ||00098  |      Top             =   5040                    
00099  |      _ExtentX        =   847                     ||00099  |      _ExtentX        =   847                     
00100  |      _ExtentY        =   847                     ||00100  |      _ExtentY        =   847                     
00101  |      _Version        =   393216                  ||00101  |      _Version        =   393216                  
00102  |      CancelError     =   -1  'True               ||00102  |      CancelError     =   -1  'True               
00103  |      DefaultExt      =   "xls"                   ||00103  |      DefaultExt      =   "xls"                   
00104  |      DialogTitle     =   "外部委託顧問料確認書フ ||00104  |      DialogTitle     =   "外部委託顧問料確認書フ 
00105  |      Filter          =   "Microsoft EXCEL ブック ||00105  |      Filter          =   "Microsoft EXCEL ブック 
00106  |      FilterIndex     =   1                       ||00106  |      FilterIndex     =   1                       
00107  |      InitDir         =   "C:"                    ||00107  |      InitDir         =   "C:"                    
00108  |   End                                            ||00108  |   End                                            
00109  |   Begin VSFlex7LCtl.VSFlexGrid fgridMakePrint    ||00109  |   Begin VSFlex7LCtl.VSFlexGrid fgridMakePrint    
00110  |      Height          =   3855                    ||00110  |      Height          =   3855                    
00111  |      Left            =   120                     ||00111  |      Left            =   120                     
00112  |      TabIndex        =   9                       ||00112  |      TabIndex        =   9                       
00113  |      TabStop         =   0   'False              ||00113  |      TabStop         =   0   'False              
00114  |      Top             =   1560                    ||00114  |      Top             =   1560                    
00115  |      Width           =   9135                    ||00115  |      Width           =   9135                    
00116  |      _cx             =   16113                   ||00116  |      _cx             =   16113                   
00117  |      _cy             =   6800                    ||00117  |      _cy             =   6800                    
00118  |      _ConvInfo       =   1                       ||00118  |      _ConvInfo       =   1                       
00119  |      Appearance      =   1                       ||00119  |      Appearance      =   1                       
00120  |      BorderStyle     =   1                       ||00120  |      BorderStyle     =   1                       
00121  |      Enabled         =   -1  'True               ||00121  |      Enabled         =   -1  'True               
00122  |      BeginProperty Font {0BE35203-8F91-11CE-9DE3-||00122  |      BeginProperty Font {0BE35203-8F91-11CE-9DE3-
00123  |         Name            =   "ＭＳ Ｐゴシック"    ||00123  |         Name            =   "ＭＳ Ｐゴシック"    
00124  |         Size            =   9                    ||00124  |         Size            =   9                    
00125  |         Charset         =   128                  ||00125  |         Charset         =   128                  
00126  |         Weight          =   400                  ||00126  |         Weight          =   400                  
00127  |         Underline       =   0   'False           ||00127  |         Underline       =   0   'False           
00128  |         Italic          =   0   'False           ||00128  |         Italic          =   0   'False           
00129  |         Strikethrough   =   0   'False           ||00129  |         Strikethrough   =   0   'False           
00130  |      EndProperty                                 ||00130  |      EndProperty                                 
00131  |      MousePointer    =   0                       ||00131  |      MousePointer    =   0                       
00132  |      BackColor       =   -2147483643             ||00132  |      BackColor       =   -2147483643             
00133  |      ForeColor       =   -2147483640             ||00133  |      ForeColor       =   -2147483640             
00134  |      BackColorFixed  =   -2147483633             ||00134  |      BackColorFixed  =   -2147483633             
00135  |      ForeColorFixed  =   -2147483630             ||00135  |      ForeColorFixed  =   -2147483630             
00136  |      BackColorSel    =   -2147483644             ||00136  |      BackColorSel    =   -2147483644             
00137  |      ForeColorSel    =   -2147483634             ||00137  |      ForeColorSel    =   -2147483634             
00138  |      BackColorBkg    =   -2147483636             ||00138  |      BackColorBkg    =   -2147483636             
00139  |      BackColorAlternate=   -2147483643           ||00139  |      BackColorAlternate=   -2147483643           
00140  |      GridColor       =   -2147483633             ||00140  |      GridColor       =   -2147483633             
00141  |      GridColorFixed  =   -2147483632             ||00141  |      GridColorFixed  =   -2147483632             
00142  |      TreeColor       =   -2147483632             ||00142  |      TreeColor       =   -2147483632             
00143  |      FloodColor      =   192                     ||00143  |      FloodColor      =   192                     
00144  |      SheetBorder     =   -2147483642             ||00144  |      SheetBorder     =   -2147483642             
00145  |      FocusRect       =   1                       ||00145  |      FocusRect       =   1                       
00146  |      HighLight       =   1                       ||00146  |      HighLight       =   1                       
00147  |      AllowSelection  =   -1  'True               ||00147  |      AllowSelection  =   -1  'True               
00148  |      AllowBigSelection=   -1  'True              ||00148  |      AllowBigSelection=   -1  'True              
00149  |      AllowUserResizing=   1                      ||00149  |      AllowUserResizing=   1                      
00150  |      SelectionMode   =   0                       ||00150  |      SelectionMode   =   0                       
00151  |      GridLines       =   1                       ||00151  |      GridLines       =   1                       
00152  |      GridLinesFixed  =   2                       ||00152  |      GridLinesFixed  =   2                       
00153  |      GridLineWidth   =   1                       ||00153  |      GridLineWidth   =   1                       
00154  |      Rows            =   20                      ||00154  |      Rows            =   20                      
00155  |      Cols            =   30                      ||00155  |      Cols            =   30                      
00156  |      FixedRows       =   1                       ||00156  |      FixedRows       =   1                       
00157  |      FixedCols       =   1                       ||00157  |      FixedCols       =   1                       
00158  |      RowHeightMin    =   0                       ||00158  |      RowHeightMin    =   0                       
00159  |      RowHeightMax    =   0                       ||00159  |      RowHeightMax    =   0                       
00160  |      ColWidthMin     =   0                       ||00160  |      ColWidthMin     =   0                       
00161  |      ColWidthMax     =   0                       ||00161  |      ColWidthMax     =   0                       
00162  |      ExtendLastCol   =   0   'False              ||00162  |      ExtendLastCol   =   0   'False              
00163  |      FormatString    =   $"frmMakePrint.frx":0000||00163  |      FormatString    =   $"frmMakePrint.frx":0000
00164  |      ScrollTrack     =   0   'False              ||00164  |      ScrollTrack     =   0   'False              
00165  |      ScrollBars      =   3                       ||00165  |      ScrollBars      =   3                       
00166  |      ScrollTips      =   0   'False              ||00166  |      ScrollTips      =   0   'False              
00167  |      MergeCells      =   0                       ||00167  |      MergeCells      =   0                       
00168  |      MergeCompare    =   0                       ||00168  |      MergeCompare    =   0                       
00169  |      AutoResize      =   -1  'True               ||00169  |      AutoResize      =   -1  'True               
00170  |      AutoSizeMode    =   0                       ||00170  |      AutoSizeMode    =   0                       
00171  |      AutoSearch      =   0                       ||00171  |      AutoSearch      =   0                       
00172  |      AutoSearchDelay =   2                       ||00172  |      AutoSearchDelay =   2                       
00173  |      MultiTotals     =   -1  'True               ||00173  |      MultiTotals     =   -1  'True               
00174  |      SubtotalPosition=   1                       ||00174  |      SubtotalPosition=   1                       
00175  |      OutlineBar      =   0                       ||00175  |      OutlineBar      =   0                       
00176  |      OutlineCol      =   0                       ||00176  |      OutlineCol      =   0                       
00177  |      Ellipsis        =   0                       ||00177  |      Ellipsis        =   0                       
00178  |      ExplorerBar     =   1                       ||00178  |      ExplorerBar     =   1                       
00179  |      PicturesOver    =   0   'False              ||00179  |      PicturesOver    =   0   'False              
00180  |      FillStyle       =   0                       ||00180  |      FillStyle       =   0                       
00181  |      RightToLeft     =   0   'False              ||00181  |      RightToLeft     =   0   'False              
00182  |      PictureType     =   0                       ||00182  |      PictureType     =   0                       
00183  |      TabBehavior     =   1                       ||00183  |      TabBehavior     =   1                       
00184  |      OwnerDraw       =   0                       ||00184  |      OwnerDraw       =   0                       
00185  |      Editable        =   0                       ||00185  |      Editable        =   0                       
00186  |      ShowComboButton =   -1  'True               ||00186  |      ShowComboButton =   -1  'True               
00187  |      WordWrap        =   0   'False              ||00187  |      WordWrap        =   0   'False              
00188  |      TextStyle       =   0                       ||00188  |      TextStyle       =   0                       
00189  |      TextStyleFixed  =   0                       ||00189  |      TextStyleFixed  =   0                       
00190  |      OleDragMode     =   0                       ||00190  |      OleDragMode     =   0                       
00191  |      OleDropMode     =   0                       ||00191  |      OleDropMode     =   0                       
00192  |      ComboSearch     =   3                       ||00192  |      ComboSearch     =   3                       
00193  |      AutoSizeMouse   =   -1  'True               ||00193  |      AutoSizeMouse   =   -1  'True               
00194  |      FrozenRows      =   0                       ||00194  |      FrozenRows      =   0                       
00195  |      FrozenCols      =   0                       ||00195  |      FrozenCols      =   0                       
00196  |      AllowUserFreezing=   0                      ||00196  |      AllowUserFreezing=   0                      
00197  |      BackColorFrozen =   0                       ||00197  |      BackColorFrozen =   0                       
00198  |      ForeColorFrozen =   0                       ||00198  |      ForeColorFrozen =   0                       
00199  |      WallPaperAlignment=   9                     ||00199  |      WallPaperAlignment=   9                     
00200  |   End                                            ||00200  |   End                                            
00201  |   Begin VB.Label Label1                          ||00201  |   Begin VB.Label Label1                          
00202  |      AutoSize        =   -1  'True               ||00202  |      AutoSize        =   -1  'True               
00203  |      Caption         =   "%"                     ||00203  |      Caption         =   "%"                     
00204  |      Height          =   180                     ||00204  |      Height          =   180                     
00205  |      Left            =   2040                    ||00205  |      Left            =   2040                    
00206  |      TabIndex        =   11                      ||00206  |      TabIndex        =   11                      
00207  |      Tag             =   "%表示"                 ||00207  |      Tag             =   "%表示"                 
00208  |      Top             =   660                     ||00208  |      Top             =   660                     
00209  |      Visible         =   0   'False              ||00209  |      Visible         =   0   'False              
00210  |      Width           =   90                      ||00210  |      Width           =   90                      
00211  |   End                                            ||00211  |   End                                            
00212  |   Begin VB.Label lblSysOutDate                   ||00212  |   Begin VB.Label lblSysOutDate                   
00213  |      AutoSize        =   -1  'True               ||00213  |      AutoSize        =   -1  'True               
00214  |      Caption         =   "出力日付 (YYYY/MM/DD)" ||00214  |      Caption         =   "出力日付 (YYYY/MM/DD)" 
00215  |      Height          =   180                     ||00215  |      Height          =   180                     
00216  |      Left            =   4320                    ||00216  |      Left            =   4320                    
00217  |      TabIndex        =   10                      ||00217  |      TabIndex        =   10                      
00218  |      Tag             =   "基準月 (YYYY/MM)ラベル"||00218  |      Tag             =   "基準月 (YYYY/MM)ラベル"
00219  |      Top             =   660                     ||00219  |      Top             =   660                     
00220  |      Width           =   2010                    ||00220  |      Width           =   2010                    
00221  |   End                                            ||00221  |   End                                            
00222  |   Begin VB.Label lblBumonFlag                    ||00222  |   Begin VB.Label lblBumonFlag                    
00223  |      AutoSize        =   -1  'True               ||00223  |      AutoSize        =   -1  'True               
00224  |      Caption         =   "部署名"                ||00224  |      Caption         =   "部署名"                
00225  |      Height          =   180                     ||00225  |      Height          =   180                     
00226  |      Left            =   4320                    ||00226  |      Left            =   4320                    
00227  |      TabIndex        =   8                       ||00227  |      TabIndex        =   8                       
00228  |      Top             =   180                     ||00228  |      Top             =   180                     
00229  |      Width           =   540                     ||00229  |      Width           =   540                     
00230  |   End                                            ||00230  |   End                                            
00231  |   Begin VB.Label lblInpuTax                      ||00231  |   Begin VB.Label lblInpuTax                      
00232  |      AutoSize        =   -1  'True               ||00232  |      AutoSize        =   -1  'True               
00233  |      Caption         =   "消費税率"              ||00233  |      Caption         =   "消費税率"              
00234  |      Height          =   180                     ||00234  |      Height          =   180                     
00235  |      Left            =   480                     ||00235  |      Left            =   480                     
00236  |      TabIndex        =   7                       ||00236  |      TabIndex        =   7                       
00237  |      Tag             =   "基準月 (YYYY/MM)ラベル"||00237  |      Tag             =   "基準月 (YYYY/MM)ラベル"
00238  |      Top             =   660                     ||00238  |      Top             =   660                     
00239  |      Visible         =   0   'False              ||00239  |      Visible         =   0   'False              
00240  |      Width           =   720                     ||00240  |      Width           =   720                     
00241  |   End                                            ||00241  |   End                                            
00242  |   Begin VB.Label lblInputName                    ||00242  |   Begin VB.Label lblInputName                    
00243  |      AutoSize        =   -1  'True               ||00243  |      AutoSize        =   -1  'True               
00244  |      Caption         =   "担当者"                ||00244  |      Caption         =   "担当者"                
00245  |      Height          =   180                     ||00245  |      Height          =   180                     
00246  |      Left            =   480                     ||00246  |      Left            =   480                     
00247  |      TabIndex        =   6                       ||00247  |      TabIndex        =   6                       
00248  |      Tag             =   "基準月 (YYYY/MM)ラベル"||00248  |      Tag             =   "基準月 (YYYY/MM)ラベル"
00249  |      Top             =   180                     ||00249  |      Top             =   180                     
00250  |      Width           =   540                     ||00250  |      Width           =   540                     
00251  |   End                                            ||00251  |   End                                            
00252  |   Begin VB.Menu mnuFile                          ||00252  |   Begin VB.Menu mnuFile                          
00253  |      Caption         =   "ファイル(&F)"          ||00253  |      Caption         =   "ファイル(&F)"          
00254  |      Begin VB.Menu mnuEnd                        ||00254  |      Begin VB.Menu mnuEnd                        
00255  |         Caption         =   "終了(&X)"           ||00255  |         Caption         =   "終了(&X)"           
00256  |      End                                         ||00256  |      End                                         
00257  |   End                                            ||00257  |   End                                            
00258  |End                                               ||00258  |End                                               
00259  |Attribute VB_Name = "frmMakePrint"                ||00259  |Attribute VB_Name = "frmMakePrint"                
00260  |Attribute VB_GlobalNameSpace = False              ||00260  |Attribute VB_GlobalNameSpace = False              
00261  |Attribute VB_Creatable = False                    ||00261  |Attribute VB_Creatable = False                    
00262  |Attribute VB_PredeclaredId = True                 ||00262  |Attribute VB_PredeclaredId = True                 
00263  |Attribute VB_Exposed = False                      ||00263  |Attribute VB_Exposed = False                      
00264  |'=================================================||00264  |'=================================================
00265  |'プロジェクト       ：NAM 顧問料デイリー算出システ||00265  |'プロジェクト       ：NAM 顧問料デイリー算出システ
00266  |'プログラム名       ：外部委託顧問料確認書作成画面||00266  |'プログラム名       ：外部委託顧問料確認書作成画面
00267  |'プログラムID       ：frmMakePrint.frm            ||00267  |'プログラムID       ：frmMakePrint.frm            
00268  |'機能概要           ：外部委託顧問料確認書作成画面||00268  |'機能概要           ：外部委託顧問料確認書作成画面
00269  |'                                                 ||00269  |'                                                 
00270  |'日付         作者名            修正内容          ||00270  |'日付         作者名            修正内容          
00271  |'-------------------------------------------------||00271  |'-------------------------------------------------
00272  |'2004/08/03 　M.Katoh <SRA>  　新規作成           ||00272  |'2004/08/03 　M.Katoh <SRA>  　新規作成           
00273  |'2004/09/10   M.Yamazaki<SRA>  確認書にファンドコ ||00273  |'2004/09/10   M.Yamazaki<SRA>  確認書にファンドコ 
00274  |'2004/09/21   M.Yamazaki<SRA>  １契約に対して複数 ||00274  |'2004/09/21   M.Yamazaki<SRA>  １契約に対して複数 
00275  |'2004/09/28   M.Yamazaki<SRA>  月次NAVがない場合、||00275  |'2004/09/28   M.Yamazaki<SRA>  月次NAVがない場合、
00276  |'2004/11/08   M.Yamazaki<SRA>  NAVが倍になってしま||00276  |'2004/11/08   M.Yamazaki<SRA>  NAVが倍になってしま
00277  |'2004/11/10   M.Yamazaki<SRA>  見出し4行目のコメン||00277  |'2004/11/10   M.Yamazaki<SRA>  見出し4行目のコメン
00278  |'2004/11/16   M.Yamazaki<SRA>  前回締日がいつも締 ||00278  |'2004/11/16   M.Yamazaki<SRA>  前回締日がいつも締 
00279  |'2004/11/17   M.Yamazaki<SRA>  端数の四捨五入が正 ||00279  |'2004/11/17   M.Yamazaki<SRA>  端数の四捨五入が正 
00280  |'                              消費税は切り捨てる ||00280  |'                              消費税は切り捨てる 
00281  |'2004/12/13   M.Yamazaki<SRA>  前回締日取得時に適 ||00281  |'2004/12/13   M.Yamazaki<SRA>  前回締日取得時に適 
00282  |'2004/12/17   M.Yamazaki<SRA>  上限金額、下限金額 ||00282  |'2004/12/17   M.Yamazaki<SRA>  上限金額、下限金額 
00283  |'2004/12/29   M.Yamazaki<SRA>  NAV取得区分が日次NA||00283  |'2004/12/29   M.Yamazaki<SRA>  NAV取得区分が日次NA
00284  |'2005/01/11   M.Yamazaki<SRA>  名称使用許諾料の上 ||00284  |'2005/01/11   M.Yamazaki<SRA>  名称使用許諾料の上 
00285  |'2005/01/13   M.Yamazaki<SRA>  １契約複数口座の場 ||00285  |'2005/01/13   M.Yamazaki<SRA>  １契約複数口座の場 
00286  |'2005/01/17   M.Yamazaki<SRA>  換算レートの入力は ||00286  |'2005/01/17   M.Yamazaki<SRA>  換算レートの入力は 
00287  |'2005/03/09   M.Yamazaki<SRA>  別紙対応、消費税対 ||00287  |'2005/03/09   M.Yamazaki<SRA>  別紙対応、消費税対 
00288  |'2005/04/21   M.Yamazaki<SRA>  パフォーマンス改善 ||00288  |'2005/04/21   M.Yamazaki<SRA>  パフォーマンス改善 
00289  |'2005/04/22   M.Yamazaki<SRA>  顧問料計算終了日の ||00289  |'2005/04/22   M.Yamazaki<SRA>  顧問料計算終了日の 
00290  |'2005/04/22   M.Yamazaki<SRA>  重複データをグリッ ||00290  |'2005/04/22   M.Yamazaki<SRA>  重複データをグリッ 
00291  |'2005/07/25   K.Nishihama<SRA> 英文チェックボック ||00291  |'2005/07/25   K.Nishihama<SRA> 英文チェックボック 
00292  |'2006/04/11   K.Furuya <SRA>   外部委託顧問料改良(||00292  |'2006/04/11   K.Furuya <SRA>   外部委託顧問料改良(
00293  |'2006/07/03   K.Furuya <SRA>   期中料率変更契約/RA||00293  |'2006/07/03   K.Furuya <SRA>   期中料率変更契約/RA
00294  |'2008/03/12   K.Furuya <SRA>   ファンド決算期間で ||00294  |'2008/03/12   K.Furuya <SRA>   ファンド決算期間で 
00295 L|'2014/02/19   M.Takada <SRA>   【管理会計】消費税 ||       |                                                  
00296  |'=================================================||00295  |'=================================================
00297  |' 本製品に関するすべての権利は(株)野村総合研究所に||00296  |' 本製品に関するすべての権利は(株)野村総合研究所に
00298  |'による許可を得ずに、本製品の全部または一部を複製 ||00297  |'による許可を得ずに、本製品の全部または一部を複製 
00299  |'=================================================||00298  |'=================================================
00300  |Option Explicit                                   ||00299  |Option Explicit                                   
00301  |                                                  ||00300  |                                                  
00302  |Private Declare Function WinHelp& Lib "user32" Ali||00301  |Private Declare Function WinHelp& Lib "user32" Ali
00303  |    (ByVal hWnd As Long, ByVal lpHelpFile As Strin||00302  |    (ByVal hWnd As Long, ByVal lpHelpFile As Strin
00304  |    ByVal dwData As Long)                         ||00303  |    ByVal dwData As Long)                         
00305  |                                                  ||00304  |                                                  
00306  |'モジュール内共通データ（変数）定義               ||00305  |'モジュール内共通データ（変数）定義               
00307  |                                                  ||00306  |                                                  
00308  |'セキュリティ関数用                               ||00307  |'セキュリティ関数用                               
00309  |Dim mblnFlgUnload           As Boolean  'Unloadす ||00308  |Dim mblnFlgUnload           As Boolean  'Unloadす 
00310  |Dim mblnFinishStatus        As Boolean  '当Formス ||00309  |Dim mblnFinishStatus        As Boolean  '当Formス 
00311  |                                                  ||00310  |                                                  
00312  |'DB関数用                                         ||00311  |'DB関数用                                         
00313  |Dim mblnDBClose             As Boolean  'DB-Close ||00312  |Dim mblnDBClose             As Boolean  'DB-Close 
00314  |Dim mblnDynasetOpen         As Boolean  'DB-Dynase||00313  |Dim mblnDynasetOpen         As Boolean  'DB-Dynase
00315  |Dim mblnDynasetClose        As Boolean  'DB-DynaSe||00314  |Dim mblnDynasetClose        As Boolean  'DB-DynaSe
00316  |Dim mblnRollback            As Boolean  'DB-Rollba||00315  |Dim mblnRollback            As Boolean  'DB-Rollba
00317  |                                                  ||00316  |                                                  
00318  |Dim mstrbasedate            As String   '基準月(YY||00317  |Dim mstrbasedate            As String   '基準月(YY
00319  |Dim mstrbaseMonth           As String   '基準月(MM||00318  |Dim mstrbaseMonth           As String   '基準月(MM
00320  |Dim mstrbaseYear            As String   '基準月(YY||00319  |Dim mstrbaseYear            As String   '基準月(YY
00321  |Dim mstrbaseToday           As String   '当日日付(||00320  |Dim mstrbaseToday           As String   '当日日付(
00322  |Dim mstrYYYYMM              As String   'mstrbased||00321  |Dim mstrYYYYMM              As String   'mstrbased
00323  |Dim mstrYYYYMMDD            As String   'mstrbased||00322  |Dim mstrYYYYMMDD            As String   'mstrbased
00324  |                                                  ||00323  |                                                  
00325  |Dim mstrSettlementDate      As String   '対象前回 ||00324  |Dim mstrSettlementDate      As String   '対象前回 
00326  |Dim mstrNearSettleDate      As String   '対象直近 ||00325  |Dim mstrNearSettleDate      As String   '対象直近 
00327  |Dim mstrPaymentDate         As String   '対象支払 ||00326  |Dim mstrPaymentDate         As String   '対象支払 
00328  |Dim mstrDailyNav            As String   '対象日次N||00327  |Dim mstrDailyNav            As String   '対象日次N
00329  |Dim mstrMonthlyNav()        As String   '対象月次N||00328  |Dim mstrMonthlyNav()        As String   '対象月次N
00330  |Dim mstrMonthlyPayCom       As String   '対象月別 ||00329  |Dim mstrMonthlyPayCom       As String   '対象月別 
00331  |Dim gSysoutDataCnt          As Long     'Excelに出||00330  |Dim gSysoutDataCnt          As Long     'Excelに出
00332  |Dim gProcessCnt             As Long     '出力処理 ||00331  |Dim gProcessCnt             As Long     '出力処理 
00333  |Dim gTotalProcessCnt        As Long     '総計の出 ||00332  |Dim gTotalProcessCnt        As Long     '総計の出 
00334  |Dim gSaveFileCnt            As Long     '保存ファ ||00333  |Dim gSaveFileCnt            As Long     '保存ファ 
00335  |Dim mstrFileName            As String   '保存する ||00334  |Dim mstrFileName            As String   '保存する 
00336  |Dim mstrFileNameBK          As String   '保存する ||00335  |Dim mstrFileNameBK          As String   '保存する 
00337  |Dim mstrContractFlag()      As String   '契約区分 ||00336  |Dim mstrContractFlag()      As String   '契約区分 
00338  |                                                  ||00337  |                                                  
00339  |Dim xlApp                   As Excel.Application  ||00338  |Dim xlApp                   As Excel.Application  
00340  |Dim xlBook                  As Excel.Workbook     ||00339  |Dim xlBook                  As Excel.Workbook     
00341  |Dim xlSheet                 As Excel.Worksheet    ||00340  |Dim xlSheet                 As Excel.Worksheet    
00342  |'2004/11/17 Start                                 ||00341  |'2004/11/17 Start                                 
00343  |Dim dblValueIn              As Double             ||00342  |Dim dblValueIn              As Double             
00344  |Dim dblValueOut             As Double             ||00343  |Dim dblValueOut             As Double             
00345  |'2004/11/17 End                                   ||00344  |'2004/11/17 End                                   
00346  |'2005/02/02 Start                                 ||00345  |'2005/02/02 Start                                 
00347  |Dim dstrShimebi             As String             ||00346  |Dim dstrShimebi             As String             
00348  |'2005/02/02 End                                   ||00347  |'2005/02/02 End                                   
00349  |'2005/03/09 Start                                 ||00348  |'2005/03/09 Start                                 
00350  |Dim gTotalDnavCnt           As Long     '日次NAV一||00349  |Dim gTotalDnavCnt           As Long     '日次NAV一
00351  |Dim gTotalCnt               As Long               ||00350  |Dim gTotalCnt               As Long               
00352  |Dim dstrOldAccCode          As String             ||00351  |Dim dstrOldAccCode          As String             
00353  |Dim ddblconsumption_tax     As Double             ||00352  |Dim ddblconsumption_tax     As Double             
00354  |'2005/03/09 End                                   ||00353  |'2005/03/09 End                                   
00355  |'2005/04/21 Start                                 ||00354  |'2005/04/21 Start                                 
00356  |Dim lRecCnt2 As Long                              ||00355  |Dim lRecCnt2 As Long                              
00357  |Dim dstrSvSettlementDate As String                ||00356  |Dim dstrSvSettlementDate As String                
00358  |'2005/04/21 End                                   ||00357  |'2005/04/21 End                                   
00359  |'2005/04/22 Start                                 ||00358  |'2005/04/22 Start                                 
00360  |Dim lRowCnt         As Long                       ||00359  |Dim lRowCnt         As Long                       
00361  |'2005/04/22 End                                   ||00360  |'2005/04/22 End                                   
00362  |'2006/04/13 START K.Furuya 外部委託顧問料改良対応 ||00361  |'2006/04/13 START K.Furuya 外部委託顧問料改良対応 
00363  |Dim strErrCall      As String       'エラー       ||00362  |Dim strErrCall      As String       'エラー       
00364  |'2006/04/13 END   K.Furuya 外部委託顧問料改良対応 ||00363  |'2006/04/13 END   K.Furuya 外部委託顧問料改良対応 
00365  |'2006/07/13 START K.Furuya 期中料率変更契約/RAFI対||00364  |'2006/07/13 START K.Furuya 期中料率変更契約/RAFI対
00366  |Dim msAssetFlg            As String   '資産種別   ||00365  |Dim msAssetFlg            As String   '資産種別   
00367  |Dim msdstrCaldate         As String   'カレンダー ||00366  |Dim msdstrCaldate         As String   'カレンダー 
00368  |Dim msBabyAccountCode     As String   'マザー組入 ||00367  |Dim msBabyAccountCode     As String   'マザー組入 
00369  |Dim msContNo              As String   '契約番号   ||00368  |Dim msContNo              As String   '契約番号   
00370  |Dim msAccCode             As String   'ベビー口座 ||00369  |Dim msAccCode             As String   'ベビー口座 
00371  |Dim msMotherAccCode       As String   'マザー口座 ||00370  |Dim msMotherAccCode       As String   'マザー口座 
00372  |'2006/07/13 END   K.Furuya 期中料率変更契約/RAFI対||00371  |'2006/07/13 END   K.Furuya 期中料率変更契約/RAFI対
00373  |                                                  ||00372  |                                                  
00374 L|'2014/02/19 START M.Takada 【管理会計】消費税率変 ||       |                                                  
00375 L|Dim strTaxRate()    As String   '消費税率の格納配 ||       |                                                  
00376 L|Dim strPayNum()     As String   '(消費税率変更前後||       |                                                  
00377 L|Dim strChgPay     As String     '支払額の切り分け ||       |                                                  
00378 L|Dim strTaxNum()     As String   '消費税額の格納配 ||       |                                                  
00379 L|Dim intDays()       As Integer  '適用開始日を境に ||       |                                                  
00380 L|Dim intCount        As Integer  '配列用カウンター ||       |                                                  
00381 L|Dim Tax_Flg         As Boolean  '消費税額の分割算 ||       |                                                  
00382 L|'2014/02/19 END   M.Takada 【管理会計】消費税率変 ||       |                                                  
00383 L|                                                  ||       |                                                  
00384  |'Const定義                                        ||00373  |'Const定義                                        
00385  |Const conTitle      As String = "NAM顧問料算出 外 ||00374  |Const conTitle      As String = "NAM顧問料算出 外 
00386  |Const conMeForm     As String = "frmMakeprint"    ||00375  |Const conMeForm     As String = "frmMakeprint"    
00387  |Const sWord0a       As String = "ファンド支払投資 ||00376  |Const sWord0a       As String = "ファンド支払投資 
00388  |Const sWord0b       As String = "業務サービス料確 ||00377  |Const sWord0b       As String = "業務サービス料確 
00389  |Const sWord0c       As String = "名称使用許諾料確 ||00378  |Const sWord0c       As String = "名称使用許諾料確 
00390  |Const sWord1        As String = "野村ｱｾｯﾄﾏﾈｼﾞﾒﾝﾄ株||00379  |Const sWord1        As String = "野村ｱｾｯﾄﾏﾈｼﾞﾒﾝﾄ株
00391  |Const sWord2        As String = "財　務　部　　"  ||00380  |Const sWord2        As String = "財　務　部　　"  
00392  |'2004/11/10 Start                                 ||00381  |'2004/11/10 Start                                 
00393  |'Const sWord3    As String = "下記のとおり顧問料を||00382  |'Const sWord3    As String = "下記のとおり顧問料を
00394  |Const sWord3a       As String = "下記のとおり顧問 ||00383  |Const sWord3a       As String = "下記のとおり顧問 
00395  |Const sWord3b       As String = "下記のとおり業務 ||00384  |Const sWord3b       As String = "下記のとおり業務 
00396  |Const sWord3c       As String = "下記のとおり名称 ||00385  |Const sWord3c       As String = "下記のとおり名称 
00397  |'2004/11/10 End                                   ||00386  |'2004/11/10 End                                   
00398  |Const sWord4        As String = "ファンド名"      ||00387  |Const sWord4        As String = "ファンド名"      
00399  |'2004/09/10 Start                                 ||00388  |'2004/09/10 Start                                 
00400  |Const sWord4_2      As String = "ファンドコード"  ||00389  |Const sWord4_2      As String = "ファンドコード"  
00401  |'2004/09/10 End                                   ||00390  |'2004/09/10 End                                   
00402  |Const sWord5        As String = "計 算 期 間"     ||00391  |Const sWord5        As String = "計 算 期 間"     
00403  |Const sWord6        As String = "月末純資産"      ||00392  |Const sWord6        As String = "月末純資産"      
00404  |Const sWord7        As String = "日      付"      ||00393  |Const sWord7        As String = "日      付"      
00405  |Const sWord8        As String = "純　　資　　産"  ||00394  |Const sWord8        As String = "純　　資　　産"  
00406  |'2006/08/11 START K.Furuya                        ||00395  |'2006/08/11 START K.Furuya                        
00407  |'Const sWord9        As String = "合　　　 計"    ||00396  |'Const sWord9        As String = "合　　　 計"    
00408  |Const sWord9        As String = "合　　　計"      ||00397  |Const sWord9        As String = "合　　　計"      
00409  |'2006/08/11 END   K.Furuya                        ||00398  |'2006/08/11 END   K.Furuya                        
00410  |Const sWord10       As String = "年　　　率"      ||00399  |Const sWord10       As String = "年　　　率"      
00411  |'2004/09/10 Start                                 ||00400  |'2004/09/10 Start                                 
00412  |'Const sWord11   As String = "投資顧問料"         ||00401  |'Const sWord11   As String = "投資顧問料"         
00413  |Const sWord11a      As String = "投資顧問料"      ||00402  |Const sWord11a      As String = "投資顧問料"      
00414  |Const sWord11b      As String = "業務サービス料"  ||00403  |Const sWord11b      As String = "業務サービス料"  
00415  |Const sWord11c      As String = "名称使用許諾料"  ||00404  |Const sWord11c      As String = "名称使用許諾料"  
00416  |'2004/09/10 End                                   ||00405  |'2004/09/10 End                                   
00417  |Const sWord12       As String = "支　払　先"      ||00406  |Const sWord12       As String = "支　払　先"      
00418  |Const sWord13       As String = "支払予定日"      ||00407  |Const sWord13       As String = "支払予定日"      
00419  |Const sWord14       As String = "株式運用部"      ||00408  |Const sWord14       As String = "株式運用部"      
00420  |Const sWord15       As String = "担 当 者 印"     ||00409  |Const sWord15       As String = "担 当 者 印"     
00421  |Const sWord16       As String = "検　　印"        ||00410  |Const sWord16       As String = "検　　印"        
00422  |Const sWord17       As String = " 精　査　印"     ||00411  |Const sWord17       As String = " 精　査　印"     
00423  |Const sWord18       As String = "÷"              ||00412  |Const sWord18       As String = "÷"              
00424  |Const sWord19       As String = "："              ||00413  |Const sWord19       As String = "："              
00425  |Const sWord20       As String = " 〜 "            ||00414  |Const sWord20       As String = " 〜 "            
00426  |Const sWord21       As String = " ＝ "            ||00415  |Const sWord21       As String = " ＝ "            
00427  |Const sWord22       As String = "(消費税 "        ||00416  |Const sWord22       As String = "(消費税 "        
00428  |Const sWord23       As String = " %)"             ||00417  |Const sWord23       As String = " %)"             
00429  |Const sWord24       As String = "合 計"           ||00418  |Const sWord24       As String = "合 計"           
00430  |Const sWord25       As String = "月末"            ||00419  |Const sWord25       As String = "月末"            
00431  |Const sWord26       As String = "平均純資産総額の ||00420  |Const sWord26       As String = "平均純資産総額の 
00432  |'2005/01/12 Start                                 ||00421  |'2005/01/12 Start                                 
00433  |'Const sWord27   As String = "円までの部分 ・・・ ||00422  |'Const sWord27   As String = "円までの部分 ・・・ 
00434  |Const sWord27       As String = "までの部分 ・・・||00423  |Const sWord27       As String = "までの部分 ・・・
00435  |'2005/01/12 End                                   ||00424  |'2005/01/12 End                                   
00436  |Const sWord28       As String = "平均純資産総額の"||00425  |Const sWord28       As String = "平均純資産総額の"
00437  |'2005/01/12 Start                                 ||00426  |'2005/01/12 Start                                 
00438  |'Const sWord29   As String = "円を超えて"         ||00427  |'Const sWord29   As String = "円を超えて"         
00439  |Const sWord29       As String = "を超えて"        ||00428  |Const sWord29       As String = "を超えて"        
00440  |'2005/01/12 End                                   ||00429  |'2005/01/12 End                                   
00441  |Const sWord30       As String = "平均純資産総額の ||00430  |Const sWord30       As String = "平均純資産総額の 
00442  |'2005/01/12 Start                                 ||00431  |'2005/01/12 Start                                 
00443  |'Const sWord31   As String = "円を超える部分 ・・ ||00432  |'Const sWord31   As String = "円を超える部分 ・・ 
00444  |Const sWord31       As String = "を超える部分 ・・||00433  |Const sWord31       As String = "を超える部分 ・・
00445  |'2005/01/12 End                                   ||00434  |'2005/01/12 End                                   
00446  |                                                  ||00435  |                                                  
00447  |Const sWord32       As String = "%"               ||00436  |Const sWord32       As String = "%"               
00448  |Const sWord33       As String = "確認書"          ||00437  |Const sWord33       As String = "確認書"          
00449  |Const sWord34       As String = "年   月   日"    ||00438  |Const sWord34       As String = "年   月   日"    
00450  |Const sWord35       As String = "財　務　部"      ||00439  |Const sWord35       As String = "財　務　部"      
00451  |                                                  ||00440  |                                                  
00452  |Const sYen          As String = " 円"             ||00441  |Const sYen          As String = " 円"             
00453  |'2005/01/12 Start                                 ||00442  |'2005/01/12 Start                                 
00454  |Const sAud          As String = " Ａドル"         ||00443  |Const sAud          As String = " Ａドル"         
00455  |Const sCad          As String = " Ｃドル"         ||00444  |Const sCad          As String = " Ｃドル"         
00456  |Const sChf          As String = " Ｓフラン"       ||00445  |Const sChf          As String = " Ｓフラン"       
00457  |Const sEur          As String = " ユーロ"         ||00446  |Const sEur          As String = " ユーロ"         
00458  |Const sGbp          As String = " ポンド"         ||00447  |Const sGbp          As String = " ポンド"         
00459  |Const sHkd          As String = " ＨＫドル"       ||00448  |Const sHkd          As String = " ＨＫドル"       
00460  |Const sMyr          As String = " Ｍドル"         ||00449  |Const sMyr          As String = " Ｍドル"         
00461  |Const sNzd          As String = " ＮＺドル"       ||00450  |Const sNzd          As String = " ＮＺドル"       
00462  |Const sSek          As String = " Ｓクローネ"     ||00451  |Const sSek          As String = " Ｓクローネ"     
00463  |Const sSgd          As String = " Ｓドル"         ||00452  |Const sSgd          As String = " Ｓドル"         
00464  |Const sUsd          As String = " ＵＳドル"       ||00453  |Const sUsd          As String = " ＵＳドル"       
00465  |'2005/01/12 End                                   ||00454  |'2005/01/12 End                                   
00466  |'2005/01/21 Start                                 ||00455  |'2005/01/21 Start                                 
00467  |Const sNok          As String = " Ｎクローネ"     ||00456  |Const sNok          As String = " Ｎクローネ"     
00468  |'2005/01/21 End                                   ||00457  |'2005/01/21 End                                   
00469  |Const WordYear      As String = "年"              ||00458  |Const WordYear      As String = "年"              
00470  |Const WordMonth     As String = "月"              ||00459  |Const WordMonth     As String = "月"              
00471  |Const WordDay       As String = "日"              ||00460  |Const WordDay       As String = "日"              
00472  |'2005/01/12 Start                                 ||00461  |'2005/01/12 Start                                 
00473  |'2005/01/18 Start                                 ||00462  |'2005/01/18 Start                                 
00474  |'Const sWord36       As String = "換算元"         ||00463  |'Const sWord36       As String = "換算元"         
00475  |'Const sWord37       As String = "換算先"         ||00464  |'Const sWord37       As String = "換算先"         
00476  |'Const sWord38       As String = "(通貨)"         ||00465  |'Const sWord38       As String = "(通貨)"         
00477  |'Const sWord39       As String = "ＮＡＶ通貨"     ||00466  |'Const sWord39       As String = "ＮＡＶ通貨"     
00478  |'Const sWord40       As String = "閾値通貨"       ||00467  |'Const sWord40       As String = "閾値通貨"       
00479  |'Const sWord41       As String = "顧問料通貨"     ||00468  |'Const sWord41       As String = "顧問料通貨"     
00480  |'Const sWord42       As String = "支払通貨"       ||00469  |'Const sWord42       As String = "支払通貨"       
00481  |'2005/01/18 End                                   ||00470  |'2005/01/18 End                                   
00482  |Const sWord43       As String = "("               ||00471  |Const sWord43       As String = "("               
00483  |Const sWord44       As String = ")"               ||00472  |Const sWord44       As String = ")"               
00484  |'2005/01/18 Start                                 ||00473  |'2005/01/18 Start                                 
00485  |'Const sWord45       As String = "レート"         ||00474  |'Const sWord45       As String = "レート"         
00486  |'2005/01/18 End                                   ||00475  |'2005/01/18 End                                   
00487  |Const sWord46       As String = "支　払　額"      ||00476  |Const sWord46       As String = "支　払　額"      
00488  |Const sWordCap      As String = "上限金額："      ||00477  |Const sWordCap      As String = "上限金額："      
00489  |Const sWordFloor    As String = "下限金額："      ||00478  |Const sWordFloor    As String = "下限金額："      
00490  |'2005/01/12 End                                   ||00479  |'2005/01/12 End                                   
00491  |                                                  ||00480  |                                                  
00492  |'2005/03/09 Start                                 ||00481  |'2005/03/09 Start                                 
00493  |Const sWord47       As String = "日次NAV一覧"     ||00482  |Const sWord47       As String = "日次NAV一覧"     
00494  |Const sWord48       As String = "平　　　　　　　 ||00483  |Const sWord48       As String = "平　　　　　　　 
00495  |Const sWord49       As String = "合　　　　　　　 ||00484  |Const sWord49       As String = "合　　　　　　　 
00496  |Const sWord50       As String = "純資産総額"      ||00485  |Const sWord50       As String = "純資産総額"      
00497  |Const sWord51       As String = "平均純資産総額"  ||00486  |Const sWord51       As String = "平均純資産総額"  
00498  |'2005/03/09 End                                   ||00487  |'2005/03/09 End                                   
00499  |                                                  ||00488  |                                                  
00500  |'2005/03/18 Start                                 ||00489  |'2005/03/18 Start                                 
00501  |Const sWord52       As String = "(休日除く)"      ||00490  |Const sWord52       As String = "(休日除く)"      
00502  |'2005/03/18 End                                   ||00491  |'2005/03/18 End                                   
00503  |                                                  ||00492  |                                                  
00504  |'2006/07/14 START K.Furuya 期中料率変更契約対応   ||00493  |'2006/07/14 START K.Furuya 期中料率変更契約対応   
00505  |Const sWord53       As String = "料率変更履歴"    ||00494  |Const sWord53       As String = "料率変更履歴"    
00506  |Const sWord54       As String = "料率の変更があり ||00495  |Const sWord54       As String = "料率の変更があり 
00507  |Const sWord55       As String = "適用期間"        ||00496  |Const sWord55       As String = "適用期間"        
00508  |Const sWord56       As String = "年　　率"        ||00497  |Const sWord56       As String = "年　　率"        
00509  |Const sWord57       As String = "平均NAV"         ||00498  |Const sWord57       As String = "平均NAV"         
00510  |Const sWord58       As String = "総　合　計"      ||00499  |Const sWord58       As String = "総　合　計"      
00511  |Const sWord59       As String = "　"              ||00500  |Const sWord59       As String = "　"              
00512  |Const sWord60       As String = "-"               ||00501  |Const sWord60       As String = "-"               
00513  |Const sWord61       As String = "平均純資産"      ||00502  |Const sWord61       As String = "平均純資産"      
00514  |Const sWord62       As String = "_"               ||00503  |Const sWord62       As String = "_"               
00515  |'2006/07/14 END   K.Furuya 期中料率変更契約対応   ||00504  |'2006/07/14 END   K.Furuya 期中料率変更契約対応   
00516  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||00505  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
00517  |Const sWord63       As String = "日次時価総額一覧"||00506  |Const sWord63       As String = "日次時価総額一覧"
00518  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||00507  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
00519  |                                                  ||00508  |                                                  
00520 L|'2014/02/19 START M.Takada 【管理会計】消費税率変 ||       |                                                  
00521 L|Const sWordTitle    As String = "消費税額内訳書"  ||       |                                                  
00522 L|Const sWordComment  As String = "下記のとおり消費 ||       |                                                  
00523 L|Const sWord64       As String = "※計算期間内に消 ||       |                                                  
00524 L|Const sWord65       As String = "　別紙｢消費税額内||       |                                                  
00525 L|Const sWord66       As String = "消費税率"        ||       |                                                  
00526 L|Const sWord67       As String = "税率適用期間"    ||       |                                                  
00527 L|Const sWord68       As String = "支払額"          ||       |                                                  
00528 L|Const sWord69       As String = "消費税額"        ||       |                                                  
00529 L|Const sWord70       As String = "合計"            ||       |                                                  
00530 L|Const sWord71       As String = "(消費税)"        ||       |                                                  
00531 L|'2014/02/19 END   M.Takada 【管理会計】消費税率変 ||       |                                                  
00532 L|                                                  ||       |                                                  
00533  |Const conKotei      As Integer = 1      '固定料率 ||00509  |Const conKotei      As Integer = 1      '固定料率 
00534  |Const conDankai     As Integer = 2      '段階料率 ||00510  |Const conDankai     As Integer = 2      '段階料率 
00535  |Const conFlagON     As Integer = 1      '対象締日 ||00511  |Const conFlagON     As Integer = 1      '対象締日 
00536  |Const conFlagOFF    As Integer = 0      '対象締日 ||00512  |Const conFlagOFF    As Integer = 0      '対象締日 
00537  |Const conSheetLimit As Integer = 50     '1ブックに||00513  |Const conSheetLimit As Integer = 50     '1ブックに
00538  |Const conUrudoshi   As String = "0229"  '閏年日付 ||00514  |Const conUrudoshi   As String = "0229"  '閏年日付 
00539  |Const conNoUrudoshi As String = "0228"  '非閏年日 ||00515  |Const conNoUrudoshi As String = "0228"  '非閏年日 
00540  |Const conYearDays   As Integer = 365    '1年間の日||00516  |Const conYearDays   As Integer = 365    '1年間の日
00541  |                                                  ||00517  |                                                  
00542  |'2006/08/24 START K.Furuya 期中料率変更契約対応   ||00518  |'2006/08/24 START K.Furuya 期中料率変更契約対応   
00543  |Const conSheetLastLine As Integer = 62  '料率変更 ||00519  |Const conSheetLastLine As Integer = 62  '料率変更 
00544  |'2006/08/24 END   K.Furuya 期中料率変更契約対応   ||00520  |'2006/08/24 END   K.Furuya 期中料率変更契約対応   
00545  |                                                  ||00521  |                                                  
00546  |'2005/01/12 Start                                 ||00522  |'2005/01/12 Start                                 
00547  |Const conYearDays2  As Integer = 360    '1年間の日||00523  |Const conYearDays2  As Integer = 360    '1年間の日
00548  |Const cAud          As String = "AUD"             ||00524  |Const cAud          As String = "AUD"             
00549  |Const cCad          As String = "CAD"             ||00525  |Const cCad          As String = "CAD"             
00550  |Const cChf          As String = "CHF"             ||00526  |Const cChf          As String = "CHF"             
00551  |Const cEur          As String = "EUR"             ||00527  |Const cEur          As String = "EUR"             
00552  |Const cGbp          As String = "GBP"             ||00528  |Const cGbp          As String = "GBP"             
00553  |Const cHkd          As String = "HKD"             ||00529  |Const cHkd          As String = "HKD"             
00554  |Const cJpy          As String = "JPY"             ||00530  |Const cJpy          As String = "JPY"             
00555  |Const cMyr          As String = "MYR"             ||00531  |Const cMyr          As String = "MYR"             
00556  |Const cNzd          As String = "NZD"             ||00532  |Const cNzd          As String = "NZD"             
00557  |Const cSek          As String = "SEK"             ||00533  |Const cSek          As String = "SEK"             
00558  |Const cSgd          As String = "SGD"             ||00534  |Const cSgd          As String = "SGD"             
00559  |Const cUsd          As String = "USD"             ||00535  |Const cUsd          As String = "USD"             
00560  |'2005/01/12 End                                   ||00536  |'2005/01/12 End                                   
00561  |'2005/01/21 Start                                 ||00537  |'2005/01/21 Start                                 
00562  |Const cNok          As String = "NOK"             ||00538  |Const cNok          As String = "NOK"             
00563  |'2005/01/21 End                                   ||00539  |'2005/01/21 End                                   
00564  |                                                  ||00540  |                                                  
00565  |Const conColSysOutbln         As Integer = 1  '出 ||00541  |Const conColSysOutbln         As Integer = 1  '出 
00566  |                                                  ||00542  |                                                  
00567  |'2005/07/25 Start                                 ||00543  |'2005/07/25 Start                                 
00568  |Const conColEnglishbln        As Integer = 2  '英 ||00544  |Const conColEnglishbln        As Integer = 2  '英 
00569  |'2005/07/25 End                                   ||00545  |'2005/07/25 End                                   
00570  |                                                  ||00546  |                                                  
00571  |'2004/12/29 Start                                 ||00547  |'2004/12/29 Start                                 
00572  |'Const conColPayMentDate As Integer = 16 '支払予定||00548  |'Const conColPayMentDate As Integer = 16 '支払予定
00573  |'2005/07/25 Start                                 ||00549  |'2005/07/25 Start                                 
00574  |'Const conColPayMentDate       As Integer = 19 '支||00550  |'Const conColPayMentDate       As Integer = 19 '支
00575  |'2005/07/25 End                                   ||00551  |'2005/07/25 End                                   
00576  |Const conColPayMentDate       As Integer = 22 '支 ||00552  |Const conColPayMentDate       As Integer = 22 '支 
00577  |'2004/12/29 End                                   ||00553  |'2004/12/29 End                                   
00578  |'2005/01/17 Start                                 ||00554  |'2005/01/17 Start                                 
00579  |''2005/01/11 Start                                ||00555  |''2005/01/11 Start                                
00580  |'Const conColOtherRateRuleFlag As Integer = 15 '外||00556  |'Const conColOtherRateRuleFlag As Integer = 15 '外
00581  |'Const conColNavAmount         As Integer = 23 'NA||00557  |'Const conColNavAmount         As Integer = 23 'NA
00582  |'Const conColNavCom            As Integer = 24 'NA||00558  |'Const conColNavCom            As Integer = 24 'NA
00583  |'Const conColAmountCom         As Integer = 25 '閾||00559  |'Const conColAmountCom         As Integer = 25 '閾
00584  |'Const conColComPay            As Integer = 26 '顧||00560  |'Const conColComPay            As Integer = 26 '顧
00585  |''2005/01/11 End                                  ||00561  |''2005/01/11 End                                  
00586  |'2005/01/17 End                                   ||00562  |'2005/01/17 End                                   
00587  |'2005/01/18 Start                                 ||00563  |'2005/01/18 Start                                 
00588  |''2005/01/14 Start                                ||00564  |''2005/01/14 Start                                
00589  |'Const conColNavCurrencyCode      As Integer = 20 ||00565  |'Const conColNavCurrencyCode      As Integer = 20 
00590  |'Const conColAmountCurrencyCode   As Integer = 21 ||00566  |'Const conColAmountCurrencyCode   As Integer = 21 
00591  |'Const conColOtherComCurrencyCode As Integer = 22 ||00567  |'Const conColOtherComCurrencyCode As Integer = 22 
00592  |''2005/01/14 End                                  ||00568  |''2005/01/14 End                                  
00593  |'2005/01/18 End                                   ||00569  |'2005/01/18 End                                   
00594  |'2008/03/12 START ファンド決算期間での外部委託顧問||00570  |'2008/03/12 START ファンド決算期間での外部委託顧問
00595  |Const conColFndCalcFrom       As Integer = 28 'フ ||00571  |Const conColFndCalcFrom       As Integer = 28 'フ 
00596  |Const conColFndCalcTo         As Integer = 29 'フ ||00572  |Const conColFndCalcTo         As Integer = 29 'フ 
00597  |'2008/03/12 END   ファンド決算期間での外部委託顧問||00573  |'2008/03/12 END   ファンド決算期間での外部委託顧問
00598  |                                                  ||00574  |                                                  
00599  |                                                  ||00575  |                                                  
00600  |                                                  ||00576  |                                                  
00601  |                                                  ||00577  |                                                  
00602  |'2005/07/29 Start                                 ||00578  |'2005/07/29 Start                                 
00603  |'英文用確認書作成対応の為Const定義されている定数（||00579  |'英文用確認書作成対応の為Const定義されている定数（
00604  |                                                  ||00580  |                                                  
00605  |'Const定義                                        ||00581  |'Const定義                                        
00606  |Const sWord0d       As String = "Details of Adviso||00582  |Const sWord0d       As String = "Details of Adviso
00607  |Const sWord0e       As String = "Details of Servic||00583  |Const sWord0e       As String = "Details of Servic
00608  |Const sWord0f       As String = "Details of Licens||00584  |Const sWord0f       As String = "Details of Licens
00609  |Const sWord1a       As String = "Nomura Asset Mana||00585  |Const sWord1a       As String = "Nomura Asset Mana
00610  |Const sWord2a       As String = "Treasury & Contro||00586  |Const sWord2a       As String = "Treasury & Contro
00611  |'2006/08/18 START                                 ||00587  |'2006/08/18 START                                 
00612  |'Const sWord3d       As String = "Please confirm t||00588  |'Const sWord3d       As String = "Please confirm t
00613  |'Const sWord3e       As String = "Please confirm t||00589  |'Const sWord3e       As String = "Please confirm t
00614  |'Const sWord3f       As String = "Please confirm t||00590  |'Const sWord3f       As String = "Please confirm t
00615  |Const sWord3d       As String = "We would like to ||00591  |Const sWord3d       As String = "We would like to 
00616  |Const sWord3e       As String = "We would like to ||00592  |Const sWord3e       As String = "We would like to 
00617  |Const sWord3f       As String = "We would like to ||00593  |Const sWord3f       As String = "We would like to 
00618  |'2006/08/18 END                                   ||00594  |'2006/08/18 END                                   
00619  |Const sWord4a       As String = "Fund Name"       ||00595  |Const sWord4a       As String = "Fund Name"       
00620  |Const sWord4_2a     As String = "Fund Code"       ||00596  |Const sWord4_2a     As String = "Fund Code"       
00621  |'2006/08/18 START                                 ||00597  |'2006/08/18 START                                 
00622  |'Const sWord5a       As String = "Cover Period"   ||00598  |'Const sWord5a       As String = "Cover Period"   
00623  |'Const sWord6a       As String = "End of Month Net||00599  |'Const sWord6a       As String = "End of Month Net
00624  |Const sWord5a       As String = "Calculation Perio||00600  |Const sWord5a       As String = "Calculation Perio
00625  |Const sWord6a       As String = "Month-end Net Ass||00601  |Const sWord6a       As String = "Month-end Net Ass
00626  |'2006/08/18 END                                   ||00602  |'2006/08/18 END                                   
00627  |Const sWord7a       As String = "DATE"            ||00603  |Const sWord7a       As String = "DATE"            
00628  |Const sWord8a       As String = "Net Asset Value" ||00604  |Const sWord8a       As String = "Net Asset Value" 
00629  |Const sWord9a       As String = "Amount"          ||00605  |Const sWord9a       As String = "Amount"          
00630  |'2006/08/18 START                                 ||00606  |'2006/08/18 START                                 
00631  |'Const sWord10a      As String = "Advisory Rate"  ||00607  |'Const sWord10a      As String = "Advisory Rate"  
00632  |Const sWord10a      As String = "Annual Rate"     ||00608  |Const sWord10a      As String = "Annual Rate"     
00633  |'2006/08/18 END                                   ||00609  |'2006/08/18 END                                   
00634  |Const sWord11d      As String = "Advisory Fee"    ||00610  |Const sWord11d      As String = "Advisory Fee"    
00635  |Const sWord11e      As String = "Service Fee"     ||00611  |Const sWord11e      As String = "Service Fee"     
00636  |Const sWord11f      As String = "License Fee"     ||00612  |Const sWord11f      As String = "License Fee"     
00637  |Const sWord12a      As String = "Company"         ||00613  |Const sWord12a      As String = "Company"         
00638  |Const sWord13a      As String = "Payment Date"    ||00614  |Const sWord13a      As String = "Payment Date"    
00639  |'Const sWord14a      As String = "株式運用部(英語)||00615  |'Const sWord14a      As String = "株式運用部(英語)
00640  |'Const sWord15a      As String = "担 当 者 印(英語||00616  |'Const sWord15a      As String = "担 当 者 印(英語
00641  |'Const sWord16a      As String = "検　　印(英語)" ||00617  |'Const sWord16a      As String = "検　　印(英語)" 
00642  |'Const sWord17a       As String = " 精　査　印(英 ||00618  |'Const sWord17a       As String = " 精　査　印(英 
00643  |'Const sWord18       As String = "÷"             ||00619  |'Const sWord18       As String = "÷"             
00644  |'Const sWord19       As String = "："             ||00620  |'Const sWord19       As String = "："             
00645  |'Const sWord20       As String = " 〜 "           ||00621  |'Const sWord20       As String = " 〜 "           
00646  |'Const sWord21       As String = " ＝ "           ||00622  |'Const sWord21       As String = " ＝ "           
00647  |Const sWord22a       As String = "(Tax "          ||00623  |Const sWord22a       As String = "(Tax "          
00648  |'Const sWord23       As String = " %)"            ||00624  |'Const sWord23       As String = " %)"            
00649  |Const sWord24a       As String = "Amount"         ||00625  |Const sWord24a       As String = "Amount"         
00650  |Const sWord25a       As String = "月末(英語)"     ||00626  |Const sWord25a       As String = "月末(英語)"     
00651  |Const sWord26a       As String = "The First "     ||00627  |Const sWord26a       As String = "The First "     
00652  |Const sWord27a       As String = " of the Avarage ||00628  |Const sWord27a       As String = " of the Avarage 
00653  |Const sWord28a       As String = "The amount of Av||00629  |Const sWord28a       As String = "The amount of Av
00654  |Const sWord29a       As String = " and up to "    ||00630  |Const sWord29a       As String = " and up to "    
00655  |Const sWord30a       As String = " of the Average ||00631  |Const sWord30a       As String = " of the Average 
00656  |'Const sWord31a       As String = "を超える部分 ・||00632  |'Const sWord31a       As String = "を超える部分 ・
00657  |'Const sWord32       As String = "%"              ||00633  |'Const sWord32       As String = "%"              
00658  |Const sWord33a       As String = "確認書(英語)"   ||00634  |Const sWord33a       As String = "確認書(英語)"   
00659  |Const sWord34a       As String = "年   月   日(英 ||00635  |Const sWord34a       As String = "年   月   日(英 
00660  |'Const sWord35a       As String = "財　務　部(英語||00636  |'Const sWord35a       As String = "財　務　部(英語
00661  |Const sYena          As String = " Japanese yen"  ||00637  |Const sYena          As String = " Japanese yen"  
00662  |Const sAuda          As String = " AUD"           ||00638  |Const sAuda          As String = " AUD"           
00663  |Const sCada          As String = " CAD"           ||00639  |Const sCada          As String = " CAD"           
00664  |Const sChfa          As String = " CHF"           ||00640  |Const sChfa          As String = " CHF"           
00665  |Const sEura          As String = " EUR"           ||00641  |Const sEura          As String = " EUR"           
00666  |Const sGbpa          As String = " GBP"           ||00642  |Const sGbpa          As String = " GBP"           
00667  |Const sHkda          As String = " HKD"           ||00643  |Const sHkda          As String = " HKD"           
00668  |Const sMyra          As String = " MYR"           ||00644  |Const sMyra          As String = " MYR"           
00669  |Const sNzda          As String = " NZD"           ||00645  |Const sNzda          As String = " NZD"           
00670  |Const sSeka          As String = " SEK"           ||00646  |Const sSeka          As String = " SEK"           
00671  |Const sSgda          As String = " SGD"           ||00647  |Const sSgda          As String = " SGD"           
00672  |Const sUsda          As String = " USD"           ||00648  |Const sUsda          As String = " USD"           
00673  |Const sNoka          As String = " NOK"           ||00649  |Const sNoka          As String = " NOK"           
00674  |'Const WordYeara      As String = "年(英語)"      ||00650  |'Const WordYeara      As String = "年(英語)"      
00675  |'Const WordMontha     As String = "月(英語)"      ||00651  |'Const WordMontha     As String = "月(英語)"      
00676  |Const WordDaya       As String = "days"           ||00652  |Const WordDaya       As String = "days"           
00677  |'Const sWord43       As String = "("              ||00653  |'Const sWord43       As String = "("              
00678  |'Const sWord44       As String = ")"              ||00654  |'Const sWord44       As String = ")"              
00679  |'2006/08/18 START                                 ||00655  |'2006/08/18 START                                 
00680  |'Const sWord46a       As String = "Calculation"   ||00656  |'Const sWord46a       As String = "Calculation"   
00681  |Const sWord46a       As String = "Amount payable" ||00657  |Const sWord46a       As String = "Amount payable" 
00682  |'2006/08/18 END                                   ||00658  |'2006/08/18 END                                   
00683  |Const sWordCapa      As String = "Cap："          ||00659  |Const sWordCapa      As String = "Cap："          
00684  |Const sWordFloora    As String = "Floor："        ||00660  |Const sWordFloora    As String = "Floor："        
00685  |Const sWord47a       As String = "Daily NAV"      ||00661  |Const sWord47a       As String = "Daily NAV"      
00686  |Const sWord48a       As String = "AVERAGE"        ||00662  |Const sWord48a       As String = "AVERAGE"        
00687  |Const sWord49a       As String = "AMOUNT"         ||00663  |Const sWord49a       As String = "AMOUNT"         
00688  |Const sWord50a       As String = "Total NAV"      ||00664  |Const sWord50a       As String = "Total NAV"      
00689  |Const sWord51a       As String = "Average Net Asse||00665  |Const sWord51a       As String = "Average Net Asse
00690  |Const sWord52a       As String = "(each business d||00666  |Const sWord52a       As String = "(each business d
00691  |'2006/08/18 START 文言追加                        ||00667  |'2006/08/18 START 文言追加                        
00692  |Const sWord53a       As String = "Please refer to ||00668  |Const sWord53a       As String = "Please refer to 
00693  |Const sWord54a       As String = "Advice of change||00669  |Const sWord54a       As String = "Advice of change
00694  |Const sWord55a       As String = "Service of chang||00670  |Const sWord55a       As String = "Service of chang
00695  |Const sWord56a       As String = "License of chang||00671  |Const sWord56a       As String = "License of chang
00696  |Const sWord57a       As String = "Calculation Peri||00672  |Const sWord57a       As String = "Calculation Peri
00697  |Const sWord58a       As String = "AVERAGE NAV"    ||00673  |Const sWord58a       As String = "AVERAGE NAV"    
00698  |Const sWord59a       As String = "Cover Period"   ||00674  |Const sWord59a       As String = "Cover Period"   
00699  |Const sWord60a       As String = "料率変更履歴(英 ||00675  |Const sWord60a       As String = "料率変更履歴(英 
00700  |Const sWord61a       As String = "(英語)"         ||00676  |Const sWord61a       As String = "(英語)"         
00701  |Const sWord62a       As String = "Period Covered" ||00677  |Const sWord62a       As String = "Period Covered" 
00702  |'2006/08/18 END   文言追加                        ||00678  |'2006/08/18 END   文言追加                        
00703  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||00679  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
00704  |Const sWord63a       As String = "Month-end Market||00680  |Const sWord63a       As String = "Month-end Market
00705  |Const sWord64a       As String = "Market Value"   ||00681  |Const sWord64a       As String = "Market Value"   
00706  |Const sWord65a       As String = " of the Avarage ||00682  |Const sWord65a       As String = " of the Avarage 
00707  |Const sWord66a       As String = "The amount of Av||00683  |Const sWord66a       As String = "The amount of Av
00708  |Const sWord67a       As String = " of the Average ||00684  |Const sWord67a       As String = " of the Average 
00709  |Const sWord68a       As String = "Daily Market Val||00685  |Const sWord68a       As String = "Daily Market Val
00710  |Const sWord69a       As String = "Total Market Val||00686  |Const sWord69a       As String = "Total Market Val
00711  |Const sWord70a       As String = "Average Market V||00687  |Const sWord70a       As String = "Average Market V
00712  |Const sWord71a       As String = "AVERAGE MARKET V||00688  |Const sWord71a       As String = "AVERAGE MARKET V
00713  |                                                  ||00689  |                                                  
00714  |'2005/08/03 確認書一覧出力データ バッチ起動用に新 ||00690  |'2005/08/03 確認書一覧出力データ バッチ起動用に新 
00715  |Private Declare Function OpenProcess Lib "kernel32||00691  |Private Declare Function OpenProcess Lib "kernel32
00716  |Private Const SYNCHRONIZE = &H100000              ||00692  |Private Const SYNCHRONIZE = &H100000              
00717  |Private Declare Function WaitForSingleObject Lib "||00693  |Private Declare Function WaitForSingleObject Lib "
00718  |Private Const INFINITE = &HFFFF      '  Infinite t||00694  |Private Const INFINITE = &HFFFF      '  Infinite t
00719  |Private Declare Function CloseHandle Lib "kernel32||00695  |Private Declare Function CloseHandle Lib "kernel32
00720  |                                                  ||00696  |                                                  
00721  |'=================================================||00697  |'=================================================
00722  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fncOtherRealComUpdateInsert  ||00698  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fncOtherRealComUpdateInsert  
00723  |'機能            :   外部委託顧問料実払管理テーブ ||00699  |'機能            :   外部委託顧問料実払管理テーブ 
00724  |'                                                 ||00700  |'                                                 
00725  |'                                                 ||00701  |'                                                 
00726  |'日付               担当　              修正内容  ||00702  |'日付               担当　              修正内容  
00727  |'-------------------------------------------------||00703  |'-------------------------------------------------
00728  |'2006/04/10         K.Furuya<SRA>      新規作成   ||00704  |'2006/04/10         K.Furuya<SRA>      新規作成   
00729  |'2006/07/28         K.Furuya<SRA>      期中料率変 ||00705  |'2006/07/28         K.Furuya<SRA>      期中料率変 
00730  |'2008/10/15         K.Nishihama<SRA>   財務会計帳 ||00706  |'2008/10/15         K.Nishihama<SRA>   財務会計帳 
00731  |'=================================================||00707  |'=================================================
00732  |Private Function fncOtherRealComUpdateInsert(strCo||00708  |Private Function fncOtherRealComUpdateInsert(strCo
00733  |        strSettlement_Date As String, _           ||00709  |        strSettlement_Date As String, _           
00734  |        strOther_Cur_Code As String, _            ||00710  |        strOther_Cur_Code As String, _            
00735  |        strFix_Com_c As String, _                 ||00711  |        strFix_Com_c As String, _                 
00736  |        strFix_Com_j As String, _                 ||00712  |        strFix_Com_j As String, _                 
00737  |        strReal_Com_c As String, _                ||00713  |        strReal_Com_c As String, _                
00738  |        strReal_Com_j As String _                 ||00714  |        strReal_Com_j As String _                 
00739  |        ) As Integer                              ||00715  |        ) As Integer                              
00740  |                                                  ||00716  |                                                  
00741  |    Dim strSQL              As String             ||00717  |    Dim strSQL              As String             
00742  |    Dim WkContractNo        As String             ||00718  |    Dim WkContractNo        As String             
00743  |    Dim WkBaseMonth         As String             ||00719  |    Dim WkBaseMonth         As String             
00744  |    Dim WkCurCode           As String             ||00720  |    Dim WkCurCode           As String             
00745  |    Dim WkSettlementDate    As String             ||00721  |    Dim WkSettlementDate    As String             
00746  |    Dim WkFixComFlag        As String             ||00722  |    Dim WkFixComFlag        As String             
00747  |    Dim WkFixComC           As String             ||00723  |    Dim WkFixComC           As String             
00748  |    Dim WkFixComJ           As String             ||00724  |    Dim WkFixComJ           As String             
00749  |    Dim WkRealComFlag       As String             ||00725  |    Dim WkRealComFlag       As String             
00750  |    Dim WkRealComC          As String             ||00726  |    Dim WkRealComC          As String             
00751  |    Dim WkRealComJ          As String             ||00727  |    Dim WkRealComJ          As String             
00752  |    Dim WkRetRealComC       As String             ||00728  |    Dim WkRetRealComC       As String             
00753  |    Dim WkRetRealComJ       As String             ||00729  |    Dim WkRetRealComJ       As String             
00754  |    Dim WkFixCalcComYM      As String             ||00730  |    Dim WkFixCalcComYM      As String             
00755  |    Dim WkSettFixFlag       As String             ||00731  |    Dim WkSettFixFlag       As String             
00756  |    Dim blnret              As Boolean            ||00732  |    Dim blnret              As Boolean            
00757  |    Dim ErrorMsg            As String             ||00733  |    Dim ErrorMsg            As String             
00758  |    Dim strAsset_T_Cd       As String             ||00734  |    Dim strAsset_T_Cd       As String             
00759  |                                                  ||00735  |                                                  
00760  |    Dim uOtherRealComUPD    As tycfr_other_real_co||00736  |    Dim uOtherRealComUPD    As tycfr_other_real_co
00761  |                                                  ||00737  |                                                  
00762  |    fncOtherRealComUpdateInsert = -1              ||00738  |    fncOtherRealComUpdateInsert = -1              
00763  |                                                  ||00739  |                                                  
00764  |    'SQL文生成                                    ||00740  |    'SQL文生成                                    
00765  |    strSQL = ""                                   ||00741  |    strSQL = ""                                   
00766  |    strSQL = strSQL & "SELECT "                   ||00742  |    strSQL = strSQL & "SELECT "                   
00767  |    strSQL = strSQL & "    COM1.CONTRACT_NO,"     ||00743  |    strSQL = strSQL & "    COM1.CONTRACT_NO,"     
00768  |    strSQL = strSQL & "    COM1.BASE_MONTH,"      ||00744  |    strSQL = strSQL & "    COM1.BASE_MONTH,"      
00769  |    strSQL = strSQL & "    COM1.SETTLEMENT_DATE," ||00745  |    strSQL = strSQL & "    COM1.SETTLEMENT_DATE," 
00770  |    strSQL = strSQL & "    COM1.OTHER_CURRENCY_COD||00746  |    strSQL = strSQL & "    COM1.OTHER_CURRENCY_COD
00771  |    strSQL = strSQL & "    COM1.FIX_COM_FLAG,"    ||00747  |    strSQL = strSQL & "    COM1.FIX_COM_FLAG,"    
00772  |    strSQL = strSQL & "    COM1.FIX_COM_CALC_MONTH||00748  |    strSQL = strSQL & "    COM1.FIX_COM_CALC_MONTH
00773  |    strSQL = strSQL & "    COM1.FIX_COM_DATE,"    ||00749  |    strSQL = strSQL & "    COM1.FIX_COM_DATE,"    
00774  |    strSQL = strSQL & "    COM1.REAL_COM_FLAG,"   ||00750  |    strSQL = strSQL & "    COM1.REAL_COM_FLAG,"   
00775  |    strSQL = strSQL & "    COM1.FIX_COM_C,"       ||00751  |    strSQL = strSQL & "    COM1.FIX_COM_C,"       
00776  |    strSQL = strSQL & "    COM1.FIX_COM_J,"       ||00752  |    strSQL = strSQL & "    COM1.FIX_COM_J,"       
00777  |    strSQL = strSQL & "    COM3.SETT_FIX_FLAG,"   ||00753  |    strSQL = strSQL & "    COM3.SETT_FIX_FLAG,"   
00778  |    strSQL = strSQL & "    COM2.INVALID_FLAG"     ||00754  |    strSQL = strSQL & "    COM2.INVALID_FLAG"     
00779  |    strSQL = strSQL & " FROM CFR_OTHER_REAL_COM_TB||00755  |    strSQL = strSQL & " FROM CFR_OTHER_REAL_COM_TB
00780  |    strSQL = strSQL & "      CFR_CONTRACT_TBL COM2||00756  |    strSQL = strSQL & "      CFR_CONTRACT_TBL COM2
00781  |    strSQL = strSQL & "      CFR_OTHER_COM_RULE_TB||00757  |    strSQL = strSQL & "      CFR_OTHER_COM_RULE_TB
00782  |    strSQL = strSQL & " WHERE COM1.CONTRACT_NO = C||00758  |    strSQL = strSQL & " WHERE COM1.CONTRACT_NO = C
00783  |    strSQL = strSQL & "       COM1.CONTRACT_NO = C||00759  |    strSQL = strSQL & "       COM1.CONTRACT_NO = C
00784  |'2006/07/28 START K.Furuya 期中料率変更契約/RAFI対||00760  |'2006/07/28 START K.Furuya 期中料率変更契約/RAFI対
00785  |'    strSQL = strSQL & "       COM3.INVALID_FLAG =||00761  |'    strSQL = strSQL & "       COM3.INVALID_FLAG =
00786  |    strSQL = strSQL & "       (COM3.START_DATE <= ||00762  |    strSQL = strSQL & "       (COM3.START_DATE <= 
00787  |    strSQL = strSQL & "        '" & strSettlement_||00763  |    strSQL = strSQL & "        '" & strSettlement_
00788  |'2006/07/28 END   K.Furuya 期中料率変更契約/RAFI対||00764  |'2006/07/28 END   K.Furuya 期中料率変更契約/RAFI対
00789  |    strSQL = strSQL & "       COM1.CONTRACT_NO = '||00765  |    strSQL = strSQL & "       COM1.CONTRACT_NO = '
00790  |    strSQL = strSQL & "       COM1.SETTLEMENT_DATE||00766  |    strSQL = strSQL & "       COM1.SETTLEMENT_DATE
00791  |    'SQL実行                                      ||00767  |    'SQL実行                                      
00792  |    If (gintDyCreate(strSQL) = False) Then        ||00768  |    If (gintDyCreate(strSQL) = False) Then        
00793  |        Call subError("DBエラー", Str(9999), "gint||00769  |        Call subError("DBエラー", Str(9999), "gint
00794  |            "DB関数エラー", strErrCall, conTitle) ||00770  |            "DB関数エラー", strErrCall, conTitle) 
00795  |        GoTo ErrExit                              ||00771  |        GoTo ErrExit                              
00796  |    End If                                        ||00772  |    End If                                        
00797  |    '外部委託顧問料契約属性が無効の場合実払管理テ ||00773  |    '外部委託顧問料契約属性が無効の場合実払管理テ 
00798  |    If Not gblnDyEOF() Then                       ||00774  |    If Not gblnDyEOF() Then                       
00799  |        If Trim(gvlnDyDataS("invalid_flag")) = "1"||00775  |        If Trim(gvlnDyDataS("invalid_flag")) = "1"
00800  |            '更新なし                             ||00776  |            '更新なし                             
00801  |            fncOtherRealComUpdateInsert = 0       ||00777  |            fncOtherRealComUpdateInsert = 0       
00802  |            Exit Function                         ||00778  |            Exit Function                         
00803  |        End If                                    ||00779  |        End If                                    
00804  |    End If                                        ||00780  |    End If                                        
00805  |                                                  ||00781  |                                                  
00806  |    If gblnDyEOF() Then                           ||00782  |    If gblnDyEOF() Then                           
00807  |    'Insert実行                                   ||00783  |    'Insert実行                                   
00808  |                                                  ||00784  |                                                  
00809  |        'SQL文生成                                ||00785  |        'SQL文生成                                
00810  |        strSQL = ""                               ||00786  |        strSQL = ""                               
00811  |        strSQL = strSQL & "SELECT "               ||00787  |        strSQL = strSQL & "SELECT "               
00812  |        strSQL = strSQL & "    COM1.CONTRACT_NO," ||00788  |        strSQL = strSQL & "    COM1.CONTRACT_NO," 
00813  |        strSQL = strSQL & "    COM2.SETT_FIX_FLAG,||00789  |        strSQL = strSQL & "    COM2.SETT_FIX_FLAG,
00814  |        strSQL = strSQL & "    COM1.INVALID_FLAG" ||00790  |        strSQL = strSQL & "    COM1.INVALID_FLAG" 
00815  |        strSQL = strSQL & " FROM CFR_CONTRACT_TBL ||00791  |        strSQL = strSQL & " FROM CFR_CONTRACT_TBL 
00816  |        strSQL = strSQL & "      CFR_OTHER_COM_RUL||00792  |        strSQL = strSQL & "      CFR_OTHER_COM_RUL
00817  |        strSQL = strSQL & " WHERE COM1.CONTRACT_NO||00793  |        strSQL = strSQL & " WHERE COM1.CONTRACT_NO
00818  |'2006/07/28 START K.Furuya 期中料率変更契約/RAFI対||00794  |'2006/07/28 START K.Furuya 期中料率変更契約/RAFI対
00819  |'        strSQL = strSQL & "       COM2.INVALID_FL||00795  |'        strSQL = strSQL & "       COM2.INVALID_FL
00820  |        strSQL = strSQL & "       (COM2.START_DATE||00796  |        strSQL = strSQL & "       (COM2.START_DATE
00821  |        strSQL = strSQL & "        '" & strSettlem||00797  |        strSQL = strSQL & "        '" & strSettlem
00822  |'2006/07/28 END   K.Furuya 期中料率変更契約/RAFI対||00798  |'2006/07/28 END   K.Furuya 期中料率変更契約/RAFI対
00823  |        strSQL = strSQL & "       COM1.CONTRACT_NO||00799  |        strSQL = strSQL & "       COM1.CONTRACT_NO
00824  |                                                  ||00800  |                                                  
00825  |        If gintDyCreate(strSQL) = False Then      ||00801  |        If gintDyCreate(strSQL) = False Then      
00826  |            GoTo ErrExit                          ||00802  |            GoTo ErrExit                          
00827  |        End If                                    ||00803  |        End If                                    
00828  |                                                  ||00804  |                                                  
00829  |        '外部委託顧問料契約属性が無効の場合実払管 ||00805  |        '外部委託顧問料契約属性が無効の場合実払管 
00830  |        If Trim(gvlnDyDataS("invalid_flag")) = "1"||00806  |        If Trim(gvlnDyDataS("invalid_flag")) = "1"
00831  |            '更新なし                             ||00807  |            '更新なし                             
00832  |            fncOtherRealComUpdateInsert = 0       ||00808  |            fncOtherRealComUpdateInsert = 0       
00833  |            Exit Function                         ||00809  |            Exit Function                         
00834  |        End If                                    ||00810  |        End If                                    
00835  |                                                  ||00811  |                                                  
00836  |'''''''''''''''''''''2008/10/15 START K.Nishihama ||00812  |'''''''''''''''''''''2008/10/15 START K.Nishihama 
00837  |'''''''''''''''''''''確定額反映月の設定をやめる　 ||00813  |'''''''''''''''''''''確定額反映月の設定をやめる　 
00838  |'''''''''''''''''''''        WkSettFixFlag = Trim(||00814  |'''''''''''''''''''''        WkSettFixFlag = Trim(
00839  |'''''''''''''''''''''        If WkSettFixFlag = "1||00815  |'''''''''''''''''''''        If WkSettFixFlag = "1
00840  |'''''''''''''''''''''            WkFixCalcComYM = ||00816  |'''''''''''''''''''''            WkFixCalcComYM = 
00841  |'''''''''''''''''''''            WkBaseMonth = Mid||00817  |'''''''''''''''''''''            WkBaseMonth = Mid
00842  |'''''''''''''''''''''        Else                 ||00818  |'''''''''''''''''''''        Else                 
00843  |'''''''''''''''''''''            '確定顧問料計算済||00819  |'''''''''''''''''''''            '確定顧問料計算済
00844  |'''''''''''''''''''''            strSQL = ""      ||00820  |'''''''''''''''''''''            strSQL = ""      
00845  |'''''''''''''''''''''            strSQL = strSQL &||00821  |'''''''''''''''''''''            strSQL = strSQL &
00846  |'''''''''''''''''''''            strSQL = strSQL &||00822  |'''''''''''''''''''''            strSQL = strSQL &
00847  |'''''''''''''''''''''            strSQL = strSQL &||00823  |'''''''''''''''''''''            strSQL = strSQL &
00848  |'''''''''''''''''''''            strSQL = strSQL &||00824  |'''''''''''''''''''''            strSQL = strSQL &
00849  |'''''''''''''''''''''                             ||00825  |'''''''''''''''''''''                             
00850  |'''''''''''''''''''''            If gintDyCreate(s||00826  |'''''''''''''''''''''            If gintDyCreate(s
00851  |'''''''''''''''''''''                GoTo ErrExit ||00827  |'''''''''''''''''''''                GoTo ErrExit 
00852  |'''''''''''''''''''''            End If           ||00828  |'''''''''''''''''''''            End If           
00853  |'''''''''''''''''''''            '確定顧問料計算済||00829  |'''''''''''''''''''''            '確定顧問料計算済
00854  |'''''''''''''''''''''            WkFixCalcComYM = ||00830  |'''''''''''''''''''''            WkFixCalcComYM = 
00855  |'''''''''''''''''''''            '基準月をセット  ||00831  |'''''''''''''''''''''            '基準月をセット  
00856  |'''''''''''''''''''''            WkBaseMonth = Tri||00832  |'''''''''''''''''''''            WkBaseMonth = Tri
00857  |'''''''''''''''''''''        End If               ||00833  |'''''''''''''''''''''        End If               
00858  |'''''''''''''''''''''確定額反映月の設定をやめる　 ||00834  |'''''''''''''''''''''確定額反映月の設定をやめる　 
00859  |'''''''''''''''''''''2008/10/15 END K.Nishihama 財||00835  |'''''''''''''''''''''2008/10/15 END K.Nishihama 財
00860  |                                                  ||00836  |                                                  
00861  |'2008/10/15 START K.Nishihama 財務会計帳票対応    ||00837  |'2008/10/15 START K.Nishihama 財務会計帳票対応    
00862  |'上記をコメントした代わりに追加　★★★           ||00838  |'上記をコメントした代わりに追加　★★★           
00863  |'（基準月を生成）                                 ||00839  |'（基準月を生成）                                 
00864  |        WkSettFixFlag = Trim(gvlnDyDataS("SETT_FIX||00840  |        WkSettFixFlag = Trim(gvlnDyDataS("SETT_FIX
00865  |        If WkSettFixFlag = "1" Then               ||00841  |        If WkSettFixFlag = "1" Then               
00866  |            WkBaseMonth = Mid(Trim(strSettlement_D||00842  |            WkBaseMonth = Mid(Trim(strSettlement_D
00867  |        Else                                      ||00843  |        Else                                      
00868  |            'BaseMonthに設定する基準月は締め日+1日||00844  |            'BaseMonthに設定する基準月は締め日+1日
00869  |            Dim WkSettlementYear      As String   ||00845  |            Dim WkSettlementYear      As String   
00870  |            Dim WkSettlementMonth     As String   ||00846  |            Dim WkSettlementMonth     As String   
00871  |            Dim WkSettlementDay       As String   ||00847  |            Dim WkSettlementDay       As String   
00872  |            Dim WkSettlementYMD       As String   ||00848  |            Dim WkSettlementYMD       As String   
00873  |            Dim WkSettlementNextYMD   As String   ||00849  |            Dim WkSettlementNextYMD   As String   
00874  |                                                  ||00850  |                                                  
00875  |            WkSettlementYear = Mid(Trim(strSettlem||00851  |            WkSettlementYear = Mid(Trim(strSettlem
00876  |            WkSettlementMonth = Mid(Trim(strSettle||00852  |            WkSettlementMonth = Mid(Trim(strSettle
00877  |            WkSettlementDay = Mid(Trim(strSettleme||00853  |            WkSettlementDay = Mid(Trim(strSettleme
00878  |            WkSettlementYMD = WkSettlementYear & "||00854  |            WkSettlementYMD = WkSettlementYear & "
00879  |            WkSettlementNextYMD = DateAdd("d", 1, ||00855  |            WkSettlementNextYMD = DateAdd("d", 1, 
00880  |            WkBaseMonth = Mid(WkSettlementNextYMD,||00856  |            WkBaseMonth = Mid(WkSettlementNextYMD,
00881  |        End If                                    ||00857  |        End If                                    
00882  |'上記をコメントした代わりに追加　★★★           ||00858  |'上記をコメントした代わりに追加　★★★           
00883  |'2008/10/15 END K.Nishihama 財務会計帳票対応      ||00859  |'2008/10/15 END K.Nishihama 財務会計帳票対応      
00884  |                                                  ||00860  |                                                  
00885  |On Error Resume Next                              ||00861  |On Error Resume Next                              
00886  |        strAsset_T_Cd = "999"                     ||00862  |        strAsset_T_Cd = "999"                     
00887  |ReInsert:                                         ||00863  |ReInsert:                                         
00888  |                                                  ||00864  |                                                  
00889  |        'SQL文生成                                ||00865  |        'SQL文生成                                
00890  |        With uOtherRealComUPD                     ||00866  |        With uOtherRealComUPD                     
00891  |            .CONTRACT_NO = strContract_No         ||00867  |            .CONTRACT_NO = strContract_No         
00892  |            .BASE_MONTH = WkBaseMonth             ||00868  |            .BASE_MONTH = WkBaseMonth             
00893  |            .CURRENCY_CODE = "999"                ||00869  |            .CURRENCY_CODE = "999"                
00894  |            .ASSET_TYPE_CODE = strAsset_T_Cd      ||00870  |            .ASSET_TYPE_CODE = strAsset_T_Cd      
00895  |            .SETTLEMENT_DATE = strSettlement_Date ||00871  |            .SETTLEMENT_DATE = strSettlement_Date 
00896  |            .OTHER_CURRENCY_CODE = strOther_Cur_Co||00872  |            .OTHER_CURRENCY_CODE = strOther_Cur_Co
00897  |            .FIX_COM_FLAG = "1"                   ||00873  |            .FIX_COM_FLAG = "1"                   
00898  |            .FIX_COM_C = strFix_Com_c             ||00874  |            .FIX_COM_C = strFix_Com_c             
00899  |            .FIX_COM_J = strFix_Com_j             ||00875  |            .FIX_COM_J = strFix_Com_j             
00900  |            .FIX_COM_CALC_MONTH = WkFixCalcComYM  ||00876  |            .FIX_COM_CALC_MONTH = WkFixCalcComYM  
00901  |            .FIX_COM_DATE = strSettlement_Date    ||00877  |            .FIX_COM_DATE = strSettlement_Date    
00902  |            .REAL_COM_FLAG = "0"                  ||00878  |            .REAL_COM_FLAG = "0"                  
00903  |            .REAL_COM_C = strReal_Com_c           ||00879  |            .REAL_COM_C = strReal_Com_c           
00904  |            .REAL_COM_J = strReal_Com_j           ||00880  |            .REAL_COM_J = strReal_Com_j           
00905  |        End With                                  ||00881  |        End With                                  
00906  |        'SQL文生成                                ||00882  |        'SQL文生成                                
00907  |        strSQL = ""                               ||00883  |        strSQL = ""                               
00908  |        strSQL = gstrEditSQLcfr_OtherRealComForIns||00884  |        strSQL = gstrEditSQLcfr_OtherRealComForIns
00909  |                                                  ||00885  |                                                  
00910  |        'ＳＱＬ実行                               ||00886  |        'ＳＱＬ実行                               
00911  |         If (gblnMakePrintDbExec(strSQL, ErrorMsg,||00887  |         If (gblnMakePrintDbExec(strSQL, ErrorMsg,
00912  |            'DBアクセスエラー                     ||00888  |            'DBアクセスエラー                     
00913  |            '--更新失敗--ロールバック実行         ||00889  |            '--更新失敗--ロールバック実行         
00914  |            'メッセージ出力処理                   ||00890  |            'メッセージ出力処理                   
00915  |            blnret = gblnDbRollback               ||00891  |            blnret = gblnDbRollback               
00916  |            'エラーが一意制約違反の場合は、資産種 ||00892  |            'エラーが一意制約違反の場合は、資産種 
00917  |            If Trim(ErrorMsg) = "ORA-00001" Then  ||00893  |            If Trim(ErrorMsg) = "ORA-00001" Then  
00918  |                'SQL文を生成する(基準月の資産種別 ||00894  |                'SQL文を生成する(基準月の資産種別 
00919  |                strSQL = ""                       ||00895  |                strSQL = ""                       
00920  |                strSQL = strSQL & "SELECT"        ||00896  |                strSQL = strSQL & "SELECT"        
00921  |                strSQL = strSQL & "    CONTRACT_NO||00897  |                strSQL = strSQL & "    CONTRACT_NO
00922  |                strSQL = strSQL & "    BASE_MONTH,||00898  |                strSQL = strSQL & "    BASE_MONTH,
00923  |                strSQL = strSQL & "    MIN(ASSET_T||00899  |                strSQL = strSQL & "    MIN(ASSET_T
00924  |                strSQL = strSQL & " FROM CFR_OTHER||00900  |                strSQL = strSQL & " FROM CFR_OTHER
00925  |                strSQL = strSQL & " WHERE"        ||00901  |                strSQL = strSQL & " WHERE"        
00926  |                strSQL = strSQL & "    CONTRACT_NO||00902  |                strSQL = strSQL & "    CONTRACT_NO
00927  |                strSQL = strSQL & "    BASE_MONTH ||00903  |                strSQL = strSQL & "    BASE_MONTH 
00928  |                strSQL = strSQL & " GROUP BY"     ||00904  |                strSQL = strSQL & " GROUP BY"     
00929  |                strSQL = strSQL & "    CONTRACT_NO||00905  |                strSQL = strSQL & "    CONTRACT_NO
00930  |                strSQL = strSQL & "    BASE_MONTH"||00906  |                strSQL = strSQL & "    BASE_MONTH"
00931  |                                                  ||00907  |                                                  
00932  |                'SQL実行                          ||00908  |                'SQL実行                          
00933  |                If (gintDyCreate(strSQL) = False) ||00909  |                If (gintDyCreate(strSQL) = False) 
00934  |                    Call subError("DBエラー", Str(||00910  |                    Call subError("DBエラー", Str(
00935  |                        "DB関数エラー", strErrCall||00911  |                        "DB関数エラー", strErrCall
00936  |                    GoTo ErrExit                  ||00912  |                    GoTo ErrExit                  
00937  |                End If                            ||00913  |                End If                            
00938  |                                                  ||00914  |                                                  
00939  |                If Not gblnDyEOF() Then           ||00915  |                If Not gblnDyEOF() Then           
00940  |                    strAsset_T_Cd = Trim(gvlnDyDat||00916  |                    strAsset_T_Cd = Trim(gvlnDyDat
00941  |                End If                            ||00917  |                End If                            
00942  |                '資産種別をデクリメントする       ||00918  |                '資産種別をデクリメントする       
00943  |                strAsset_T_Cd = Format(CInt(strAss||00919  |                strAsset_T_Cd = Format(CInt(strAss
00944  |                GoTo ReInsert                     ||00920  |                GoTo ReInsert                     
00945  |            End If                                ||00921  |            End If                                
00946  |            Call gOnErrorMsg(strSQL$, "gblnDbExec(||00922  |            Call gOnErrorMsg(strSQL$, "gblnDbExec(
00947  |                                                  ||00923  |                                                  
00948  |            GoTo ErrExit                          ||00924  |            GoTo ErrExit                          
00949  |        End If                                    ||00925  |        End If                                    
00950  |    Else                                          ||00926  |    Else                                          
00951  |    'Update実行                                   ||00927  |    'Update実行                                   
00952  |        WkContractNo = Trim(gvlnDyDataS("contract_||00928  |        WkContractNo = Trim(gvlnDyDataS("contract_
00953  |        WkBaseMonth = Trim(gvlnDyDataS("base_month||00929  |        WkBaseMonth = Trim(gvlnDyDataS("base_month
00954  |        WkCurCode = Trim(gvlnDyDataS("other_curren||00930  |        WkCurCode = Trim(gvlnDyDataS("other_curren
00955  |        WkSettlementDate = Trim(gvlnDyDataS("settl||00931  |        WkSettlementDate = Trim(gvlnDyDataS("settl
00956  |        WkFixComFlag = Trim(gvlnDyDataS("fix_com_f||00932  |        WkFixComFlag = Trim(gvlnDyDataS("fix_com_f
00957  |        WkRealComFlag = Trim(gvlnDyDataS("real_com||00933  |        WkRealComFlag = Trim(gvlnDyDataS("real_com
00958  |        WkSettFixFlag = Trim(gvlnDyDataS("SETT_FIX||00934  |        WkSettFixFlag = Trim(gvlnDyDataS("SETT_FIX
00959  |        WkFixComC = strFix_Com_c                  ||00935  |        WkFixComC = strFix_Com_c                  
00960  |        WkFixComJ = strFix_Com_j                  ||00936  |        WkFixComJ = strFix_Com_j                  
00961  |        WkRealComC = strReal_Com_c                ||00937  |        WkRealComC = strReal_Com_c                
00962  |        WkRealComJ = strReal_Com_j                ||00938  |        WkRealComJ = strReal_Com_j                
00963  |                                                  ||00939  |                                                  
00964  |'''''''''''''''''''''2008/10/15 START K.Nishihama ||00940  |'''''''''''''''''''''2008/10/15 START K.Nishihama 
00965  |'''''''''''''''''''''確定額反映月の設定をやめる　 ||00941  |'''''''''''''''''''''確定額反映月の設定をやめる　 
00966  |'''''''''''''''''''''        If WkSettFixFlag = "1||00942  |'''''''''''''''''''''        If WkSettFixFlag = "1
00967  |'''''''''''''''''''''            WkFixCalcComYM = ||00943  |'''''''''''''''''''''            WkFixCalcComYM = 
00968  |'''''''''''''''''''''        Else                 ||00944  |'''''''''''''''''''''        Else                 
00969  |'''''''''''''''''''''            '確定顧問料計算済||00945  |'''''''''''''''''''''            '確定顧問料計算済
00970  |'''''''''''''''''''''            strSQL = ""      ||00946  |'''''''''''''''''''''            strSQL = ""      
00971  |'''''''''''''''''''''            strSQL = strSQL &||00947  |'''''''''''''''''''''            strSQL = strSQL &
00972  |'''''''''''''''''''''            strSQL = strSQL &||00948  |'''''''''''''''''''''            strSQL = strSQL &
00973  |'''''''''''''''''''''            strSQL = strSQL &||00949  |'''''''''''''''''''''            strSQL = strSQL &
00974  |'''''''''''''''''''''            strSQL = strSQL &||00950  |'''''''''''''''''''''            strSQL = strSQL &
00975  |'''''''''''''''''''''                             ||00951  |'''''''''''''''''''''                             
00976  |'''''''''''''''''''''            If gintDyCreate(s||00952  |'''''''''''''''''''''            If gintDyCreate(s
00977  |'''''''''''''''''''''                GoTo ErrExit ||00953  |'''''''''''''''''''''                GoTo ErrExit 
00978  |'''''''''''''''''''''            End If           ||00954  |'''''''''''''''''''''            End If           
00979  |'''''''''''''''''''''            '確定顧問料計算済||00955  |'''''''''''''''''''''            '確定顧問料計算済
00980  |'''''''''''''''''''''            WkFixCalcComYM = ||00956  |'''''''''''''''''''''            WkFixCalcComYM = 
00981  |'''''''''''''''''''''        End If               ||00957  |'''''''''''''''''''''        End If               
00982  |'''''''''''''''''''''確定額反映月の設定をやめる　 ||00958  |'''''''''''''''''''''確定額反映月の設定をやめる　 
00983  |'''''''''''''''''''''2008/10/15 END K.Nishihama 財||00959  |'''''''''''''''''''''2008/10/15 END K.Nishihama 財
00984  |                                                  ||00960  |                                                  
00985  |        'Case 1  ,確定入力区分 = '1' & 実払入力区 ||00961  |        'Case 1  ,確定入力区分 = '1' & 実払入力区 
00986  |        If WkFixComFlag = "0" And WkRealComFlag = ||00962  |        If WkFixComFlag = "0" And WkRealComFlag = 
00987  |            'SQL文生成                            ||00963  |            'SQL文生成                            
00988  |            strSQL = ""                           ||00964  |            strSQL = ""                           
00989  |            strSQL = gstrEditSQL_OtherRealComforUp||00965  |            strSQL = gstrEditSQL_OtherRealComforUp
00990  |                WkFixComC, WkFixComJ, WkFixCalcCom||00966  |                WkFixComC, WkFixComJ, WkFixCalcCom
00991  |        'Case 2  ,確定入力区分 = '1' & 実払入力区 ||00967  |        'Case 2  ,確定入力区分 = '1' & 実払入力区 
00992  |        ElseIf WkFixComFlag = "1" And WkRealComFla||00968  |        ElseIf WkFixComFlag = "1" And WkRealComFla
00993  |            'SQL文生成                            ||00969  |            'SQL文生成                            
00994  |            strSQL = ""                           ||00970  |            strSQL = ""                           
00995  |            strSQL = gstrEditSQL_OtherRealComforUp||00971  |            strSQL = gstrEditSQL_OtherRealComforUp
00996  |                WkFixComC, WkFixComJ, WkFixCalcCom||00972  |                WkFixComC, WkFixComJ, WkFixCalcCom
00997  |        'Case 3  ,確定入力区分 = '1' & 実払入力区 ||00973  |        'Case 3  ,確定入力区分 = '1' & 実払入力区 
00998  |        ElseIf WkFixComFlag = "1" And WkRealComFla||00974  |        ElseIf WkFixComFlag = "1" And WkRealComFla
00999  |            'SQL文生成                            ||00975  |            'SQL文生成                            
01000  |            strSQL = ""                           ||00976  |            strSQL = ""                           
01001  |            strSQL = gstrEditSQL_OtherRealComforUp||00977  |            strSQL = gstrEditSQL_OtherRealComforUp
01002  |                WkFixComC, WkFixComJ, WkFixCalcCom||00978  |                WkFixComC, WkFixComJ, WkFixCalcCom
01003  |        'Case 4  ,確定入力区分 = '2' & 実払入力区 ||00979  |        'Case 4  ,確定入力区分 = '2' & 実払入力区 
01004  |        ElseIf WkFixComFlag = "2" And WkRealComFla||00980  |        ElseIf WkFixComFlag = "2" And WkRealComFla
01005  |            'SQL文生成                            ||00981  |            'SQL文生成                            
01006  |            strSQL = ""                           ||00982  |            strSQL = ""                           
01007  |            strSQL = gstrEditSQL_OtherRealComforUp||00983  |            strSQL = gstrEditSQL_OtherRealComforUp
01008  |                WkFixComC, WkFixComJ, WkFixCalcCom||00984  |                WkFixComC, WkFixComJ, WkFixCalcCom
01009  |        'Case 5  ,確定入力区分 = '2' & 実払入力区 ||00985  |        'Case 5  ,確定入力区分 = '2' & 実払入力区 
01010  |        ElseIf WkFixComFlag = "2" And WkRealComFla||00986  |        ElseIf WkFixComFlag = "2" And WkRealComFla
01011  |            'SQL文生成                            ||00987  |            'SQL文生成                            
01012  |            strSQL = ""                           ||00988  |            strSQL = ""                           
01013  |            strSQL = gstrEditSQL_OtherRealComforUp||00989  |            strSQL = gstrEditSQL_OtherRealComforUp
01014  |                WkFixComC, WkFixComJ, WkFixCalcCom||00990  |                WkFixComC, WkFixComJ, WkFixCalcCom
01015  |        'Case 6  ,確定入力区分 = '2' & 実払入力区 ||00991  |        'Case 6  ,確定入力区分 = '2' & 実払入力区 
01016  |        Else                                      ||00992  |        Else                                      
01017  |            '更新なし                             ||00993  |            '更新なし                             
01018  |            fncOtherRealComUpdateInsert = 0       ||00994  |            fncOtherRealComUpdateInsert = 0       
01019  |            Exit Function                         ||00995  |            Exit Function                         
01020  |        End If                                    ||00996  |        End If                                    
01021  |        'SQL文実行                                ||00997  |        'SQL文実行                                
01022  |         If (gblnDbExec(strSQL, True) <> True) The||00998  |         If (gblnDbExec(strSQL, True) <> True) The
01023  |            'DBアクセスエラー                     ||00999  |            'DBアクセスエラー                     
01024  |            '--更新失敗--ロールバック実行         ||01000  |            '--更新失敗--ロールバック実行         
01025  |            'メッセージ出力処理                   ||01001  |            'メッセージ出力処理                   
01026  |            blnret = gblnDbRollback               ||01002  |            blnret = gblnDbRollback               
01027  |            Call gOnErrorMsg(strSQL$, "gblnDbExec(||01003  |            Call gOnErrorMsg(strSQL$, "gblnDbExec(
01028  |            GoTo ErrExit                          ||01004  |            GoTo ErrExit                          
01029  |        End If                                    ||01005  |        End If                                    
01030  |                                                  ||01006  |                                                  
01031  |    End If                                        ||01007  |    End If                                        
01032  |                                                  ||01008  |                                                  
01033  |    'DBクローズ                                   ||01009  |    'DBクローズ                                   
01034  |    If Not gblnDyClose() Then                     ||01010  |    If Not gblnDyClose() Then                     
01035  |        Call subPubError("DBエラー", Str(9999), "g||01011  |        Call subPubError("DBエラー", Str(9999), "g
01036  |            "DB関数エラー", strErrCall, conTitle) ||01012  |            "DB関数エラー", strErrCall, conTitle) 
01037  |    End If                                        ||01013  |    End If                                        
01038  |                                                  ||01014  |                                                  
01039  |    fncOtherRealComUpdateInsert = 0               ||01015  |    fncOtherRealComUpdateInsert = 0               
01040  |    Exit Function                                 ||01016  |    Exit Function                                 
01041  |                                                  ||01017  |                                                  
01042  |ErrExit:                                          ||01018  |ErrExit:                                          
01043  |                                                  ||01019  |                                                  
01044  |    'DBクローズ                                   ||01020  |    'DBクローズ                                   
01045  |    If Not gblnDyClose() Then                     ||01021  |    If Not gblnDyClose() Then                     
01046  |        Call subPubError("DBエラー", Str(9999), "g||01022  |        Call subPubError("DBエラー", Str(9999), "g
01047  |            "DB関数エラー", strErrCall, conTitle) ||01023  |            "DB関数エラー", strErrCall, conTitle) 
01048  |    End If                                        ||01024  |    End If                                        
01049  |                                                  ||01025  |                                                  
01050  |End Function                                      ||01026  |End Function                                      
01051  |                                                  ||01027  |                                                  
01052  |'2005/07/29 End                                   ||01028  |'2005/07/29 End                                   
01053  |                                                  ||01029  |                                                  
01054  |Private Sub cmdCancel_Click()                     ||01030  |Private Sub cmdCancel_Click()                     
01055  |    Unload Me                                     ||01031  |    Unload Me                                     
01056  |End Sub                                           ||01032  |End Sub                                           
01057  |                                                  ||01033  |                                                  
01058  |Private Sub cmdCheckClear_Click()                 ||01034  |Private Sub cmdCheckClear_Click()                 
01059  |                                                  ||01035  |                                                  
01060  |'=================================================||01036  |'=================================================
01061  |'処理内容     cmdCheckClear_Click時モジュール     ||01037  |'処理内容     cmdCheckClear_Click時モジュール     
01062  |'備考         「出力」チェックボックスのチェックを||01038  |'備考         「出力」チェックボックスのチェックを
01063  |'日付         担当               内容             ||01039  |'日付         担当               内容             
01064  |'------------ ----------------- ------------------||01040  |'------------ ----------------- ------------------
01065  |'2005/07/25   K.Nishihama<SRA>   新規作成         ||01041  |'2005/07/25   K.Nishihama<SRA>   新規作成         
01066  |'=================================================||01042  |'=================================================
01067  |    Dim lineCnt As Long                           ||01043  |    Dim lineCnt As Long                           
01068  |                                                  ||01044  |                                                  
01069  |    With fgridMakePrint                           ||01045  |    With fgridMakePrint                           
01070  |        For lineCnt = 0 To .Rows - 2              ||01046  |        For lineCnt = 0 To .Rows - 2              
01071  |            .Col = conColSysOutbln                ||01047  |            .Col = conColSysOutbln                
01072  |            .Row = lineCnt + 1                    ||01048  |            .Row = lineCnt + 1                    
01073  |            'チェックボックスをOFFする            ||01049  |            'チェックボックスをOFFする            
01074  |            .Text = 0                             ||01050  |            .Text = 0                             
01075  |            '背景色を通常色に戻す                 ||01051  |            '背景色を通常色に戻す                 
01076  |            .Cell(flexcpBackColor, .Row, 3, .Row, ||01052  |            .Cell(flexcpBackColor, .Row, 3, .Row, 
01077  |            .Cell(flexcpBackColor, .Row, 6, .Row, ||01053  |            .Cell(flexcpBackColor, .Row, 6, .Row, 
01078  |            .Cell(flexcpBackColor, .Row, 8, .Row, ||01054  |            .Cell(flexcpBackColor, .Row, 8, .Row, 
01079  |            .Cell(flexcpBackColor, .Row, 15, .Row,||01055  |            .Cell(flexcpBackColor, .Row, 15, .Row,
01080  |        Next lineCnt                              ||01056  |        Next lineCnt                              
01081  |    End With                                      ||01057  |    End With                                      
01082  |                                                  ||01058  |                                                  
01083  |End Sub                                           ||01059  |End Sub                                           
01084  |                                                  ||01060  |                                                  
01085  |'=================================================||01061  |'=================================================
01086  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fgridMakePrint_AfterEdit     ||01062  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fgridMakePrint_AfterEdit     
01087  |'機能            :   グリッド編集後エラーチェック ||01063  |'機能            :   グリッド編集後エラーチェック 
01088  |'                                                 ||01064  |'                                                 
01089  |'日付               担当　              修正内容  ||01065  |'日付               担当　              修正内容  
01090  |'-------------------------------------------------||01066  |'-------------------------------------------------
01091  |'2004/08/06         M.Katoh<SRA>       新規作成   ||01067  |'2004/08/06         M.Katoh<SRA>       新規作成   
01092  |'2005/01/11         M.Yamazaki <SRA>   入力チェッ ||01068  |'2005/01/11         M.Yamazaki <SRA>   入力チェッ 
01093  |'2005/01/17         M.Yamazaki <SRA>   入力チェッ ||01069  |'2005/01/17         M.Yamazaki <SRA>   入力チェッ 
01094  |'2008/03/12         K.Furuya<SRA>      ファンド決 ||01070  |'2008/03/12         K.Furuya<SRA>      ファンド決 
01095  |'=================================================||01071  |'=================================================
01096  |Private Sub fgridMakePrint_AfterEdit(ByVal Row As ||01072  |Private Sub fgridMakePrint_AfterEdit(ByVal Row As 
01097  |    Dim sBuf            As String                 ||01073  |    Dim sBuf            As String                 
01098  |                                                  ||01074  |                                                  
01099  |    With fgridMakePrint                           ||01075  |    With fgridMakePrint                           
01100  |'2005/01/17 Start                                 ||01076  |'2005/01/17 Start                                 
01101  |''2005/01/11 Start                                ||01077  |''2005/01/11 Start                                
01102  |''        If (Col = conColPayMentDate) Or (Col = c||01078  |''        If (Col = conColPayMentDate) Or (Col = c
01103  |'        If (Col = conColPayMentDate) Or (Col = co||01079  |'        If (Col = conColPayMentDate) Or (Col = co
01104  |'        Or (Col = conColNavAmount) Or (Col = conC||01080  |'        Or (Col = conColNavAmount) Or (Col = conC
01105  |'        Or (Col = conColAmountCom) Or (Col = conC||01081  |'        Or (Col = conColAmountCom) Or (Col = conC
01106  |''2005/01/11 End                                  ||01082  |''2005/01/11 End                                  
01107  |'2008/03/12 START ファンド決算期間での外部委託顧問||01083  |'2008/03/12 START ファンド決算期間での外部委託顧問
01108  |'        If (Col = conColPayMentDate) Or (Col = co||01084  |'        If (Col = conColPayMentDate) Or (Col = co
01109  |        '編集可能列にファンド計算を追加           ||01085  |        '編集可能列にファンド計算を追加           
01110  |        If (Col = conColPayMentDate) Or _         ||01086  |        If (Col = conColPayMentDate) Or _         
01111  |            (Col = conColSysOutbln) Or _          ||01087  |            (Col = conColSysOutbln) Or _          
01112  |            (Col = conColFndCalcFrom) Or _        ||01088  |            (Col = conColFndCalcFrom) Or _        
01113  |            (Col = conColFndCalcTo) Then          ||01089  |            (Col = conColFndCalcTo) Then          
01114  |'2008/03/12 START ファンド決算期間での外部委託顧問||01090  |'2008/03/12 START ファンド決算期間での外部委託顧問
01115  |'2005/01/17 End                                   ||01091  |'2005/01/17 End                                   
01116  |            If .EditText = "" Then                ||01092  |            If .EditText = "" Then                
01117  |                .BackColorSel = COLOR_CHG_OK_CELL ||01093  |                .BackColorSel = COLOR_CHG_OK_CELL 
01118  |                .ForeColorSel = vbWindowText      ||01094  |                .ForeColorSel = vbWindowText      
01119  |                Exit Sub                          ||01095  |                Exit Sub                          
01120  |            End If                                ||01096  |            End If                                
01121  |        End If                                    ||01097  |        End If                                    
01122  |'2005/01/17 Start                                 ||01098  |'2005/01/17 Start                                 
01123  |''2005/01/11 Start                                ||01099  |''2005/01/11 Start                                
01124  |''        If Col = conColPayMentDate Then '/をつけ||01100  |''        If Col = conColPayMentDate Then '/をつけ
01125  |''            sBuf = gstrDateFormat(.EditText, 1) ||01101  |''            sBuf = gstrDateFormat(.EditText, 1) 
01126  |''        End If                                  ||01102  |''        End If                                  
01127  |'        Select Case Col                          ||01103  |'        Select Case Col                          
01128  |'            Case conColPayMentDate               ||01104  |'            Case conColPayMentDate               
01129  |'                sBuf = gstrDateFormat(.EditText, ||01105  |'                sBuf = gstrDateFormat(.EditText, 
01130  |'            Case conColNavAmount                 ||01106  |'            Case conColNavAmount                 
01131  |'                If .Cell(flexcpText, Row, conColO||01107  |'                If .Cell(flexcpText, Row, conColO
01132  |'                    Exit Sub                     ||01108  |'                    Exit Sub                     
01133  |'                End If                           ||01109  |'                End If                           
01134  |'                If fnRateChk(.EditText) = False T||01110  |'                If fnRateChk(.EditText) = False T
01135  |'                    .Cell(flexcpBackColor, Row, C||01111  |'                    .Cell(flexcpBackColor, Row, C
01136  |''''''                    sBuf = Format(.EditText,||01112  |''''''                    sBuf = Format(.EditText,
01137  |'                    sBuf = Format(.EditText, "##0||01113  |'                    sBuf = Format(.EditText, "##0
01138  |'                Else                             ||01114  |'                Else                             
01139  |'                    MsgSend "レート入力エラー    ||01115  |'                    MsgSend "レート入力エラー    
01140  |'                    sBuf = .EditText             ||01116  |'                    sBuf = .EditText             
01141  |'                    .Cell(flexcpBackColor, Row, C||01117  |'                    .Cell(flexcpBackColor, Row, C
01142  |'                End If                           ||01118  |'                End If                           
01143  |'            Case conColNavCom                    ||01119  |'            Case conColNavCom                    
01144  |'                If fnRateChk(.EditText) = False T||01120  |'                If fnRateChk(.EditText) = False T
01145  |'                    .Cell(flexcpBackColor, Row, C||01121  |'                    .Cell(flexcpBackColor, Row, C
01146  |''''''                    sBuf = Format(.EditText,||01122  |''''''                    sBuf = Format(.EditText,
01147  |'                    sBuf = Format(.EditText, "##0||01123  |'                    sBuf = Format(.EditText, "##0
01148  |'                Else                             ||01124  |'                Else                             
01149  |'                    MsgSend "レート入力エラー    ||01125  |'                    MsgSend "レート入力エラー    
01150  |'                    sBuf = .EditText             ||01126  |'                    sBuf = .EditText             
01151  |'                    .Cell(flexcpBackColor, Row, C||01127  |'                    .Cell(flexcpBackColor, Row, C
01152  |'                End If                           ||01128  |'                End If                           
01153  |'            Case conColAmountCom                 ||01129  |'            Case conColAmountCom                 
01154  |'                If .Cell(flexcpText, Row, conColO||01130  |'                If .Cell(flexcpText, Row, conColO
01155  |'                    Exit Sub                     ||01131  |'                    Exit Sub                     
01156  |'                End If                           ||01132  |'                End If                           
01157  |'                If fnRateChk(.EditText) = False T||01133  |'                If fnRateChk(.EditText) = False T
01158  |'                    .Cell(flexcpBackColor, Row, C||01134  |'                    .Cell(flexcpBackColor, Row, C
01159  |''''''                    sBuf = Format(.EditText,||01135  |''''''                    sBuf = Format(.EditText,
01160  |'                    sBuf = Format(.EditText, "##0||01136  |'                    sBuf = Format(.EditText, "##0
01161  |'                Else                             ||01137  |'                Else                             
01162  |'                    MsgSend "レート入力エラー    ||01138  |'                    MsgSend "レート入力エラー    
01163  |'                    sBuf = .EditText             ||01139  |'                    sBuf = .EditText             
01164  |'                    .Cell(flexcpBackColor, Row, C||01140  |'                    .Cell(flexcpBackColor, Row, C
01165  |'                End If                           ||01141  |'                End If                           
01166  |'            Case conColComPay                    ||01142  |'            Case conColComPay                    
01167  |'                If fnRateChk(.EditText) = False T||01143  |'                If fnRateChk(.EditText) = False T
01168  |'                    .Cell(flexcpBackColor, Row, C||01144  |'                    .Cell(flexcpBackColor, Row, C
01169  |''''''                    sBuf = Format(.EditText,||01145  |''''''                    sBuf = Format(.EditText,
01170  |'                    sBuf = Format(.EditText, "##0||01146  |'                    sBuf = Format(.EditText, "##0
01171  |'                Else                             ||01147  |'                Else                             
01172  |'                    MsgSend "レート入力エラー    ||01148  |'                    MsgSend "レート入力エラー    
01173  |'                    sBuf = .EditText             ||01149  |'                    sBuf = .EditText             
01174  |'                    .Cell(flexcpBackColor, Row, C||01150  |'                    .Cell(flexcpBackColor, Row, C
01175  |'                End If                           ||01151  |'                End If                           
01176  |'        End Select                               ||01152  |'        End Select                               
01177  |''2005/01/11 End                                  ||01153  |''2005/01/11 End                                  
01178  |        If Col = conColPayMentDate Then '/をつける||01154  |        If Col = conColPayMentDate Then '/をつける
01179  |            sBuf = gstrDateFormat(.EditText, 1)   ||01155  |            sBuf = gstrDateFormat(.EditText, 1)   
01180  |        End If                                    ||01156  |        End If                                    
01181  |'2005/01/17 End                                   ||01157  |'2005/01/17 End                                   
01182  |'2008/03/12 START ファンド決算期間での外部委託顧問||01158  |'2008/03/12 START ファンド決算期間での外部委託顧問
01183  |        If Col = conColFndCalcFrom Then '/をつける||01159  |        If Col = conColFndCalcFrom Then '/をつける
01184  |            sBuf = gstrDateFormat(.EditText, 1)   ||01160  |            sBuf = gstrDateFormat(.EditText, 1)   
01185  |        End If                                    ||01161  |        End If                                    
01186  |        If Col = conColFndCalcTo Then '/をつける  ||01162  |        If Col = conColFndCalcTo Then '/をつける  
01187  |            sBuf = gstrDateFormat(.EditText, 1)   ||01163  |            sBuf = gstrDateFormat(.EditText, 1)   
01188  |        End If                                    ||01164  |        End If                                    
01189  |'2008/03/12 START ファンド決算期間での外部委託顧問||01165  |'2008/03/12 START ファンド決算期間での外部委託顧問
01190  |        .Text = sBuf                              ||01166  |        .Text = sBuf                              
01191  |    End With                                      ||01167  |    End With                                      
01192  |End Sub                                           ||01168  |End Sub                                           
01193  |                                                  ||01169  |                                                  
01194  |'=================================================||01170  |'=================================================
01195  |'処理内容     確認書作成対象情報表示グリッド　クリ||01171  |'処理内容     確認書作成対象情報表示グリッド　クリ
01196  |'備考                                             ||01172  |'備考                                             
01197  |'                                                 ||01173  |'                                                 
01198  |'日付         担当               内容             ||01174  |'日付         担当               内容             
01199  |'------------ ----------------- ------------------||01175  |'------------ ----------------- ------------------
01200  |'2004/08/06   M.Katoh <SRA>  　　新規作成         ||01176  |'2004/08/06   M.Katoh <SRA>  　　新規作成         
01201  |'2006/07/04   K.Furuya<SRA>      期中料率変更契約/||01177  |'2006/07/04   K.Furuya<SRA>      期中料率変更契約/
01202  |'                                グリッドの出力チ ||01178  |'                                グリッドの出力チ 
01203  |'                                選択行の背景色が ||01179  |'                                選択行の背景色が 
01204  |'=================================================||01180  |'=================================================
01205  |Private Sub fgridMakePrint_Click()                ||01181  |Private Sub fgridMakePrint_Click()                
01206  |    'チェックされた行の番号                       ||01182  |    'チェックされた行の番号                       
01207  |    Dim NowRow  As Integer                        ||01183  |    Dim NowRow  As Integer                        
01208  |    With fgridMakePrint                           ||01184  |    With fgridMakePrint                           
01209  |        'チェックされた行の番号を取得             ||01185  |        'チェックされた行の番号を取得             
01210  |        NowRow = .Row                             ||01186  |        NowRow = .Row                             
01211  |        If .CellChecked = flexChecked Then        ||01187  |        If .CellChecked = flexChecked Then        
01212  |            .CellChecked = flexUnchecked          ||01188  |            .CellChecked = flexUnchecked          
01213  |            'チェックを外したら通常色に戻す       ||01189  |            'チェックを外したら通常色に戻す       
01214  |            .Cell(flexcpBackColor, NowRow, 3, NowR||01190  |            .Cell(flexcpBackColor, NowRow, 3, NowR
01215  |            .Cell(flexcpBackColor, NowRow, 6, NowR||01191  |            .Cell(flexcpBackColor, NowRow, 6, NowR
01216  |            .Cell(flexcpBackColor, NowRow, 8, NowR||01192  |            .Cell(flexcpBackColor, NowRow, 8, NowR
01217  |            .Cell(flexcpBackColor, NowRow, 15, Now||01193  |            .Cell(flexcpBackColor, NowRow, 15, Now
01218  |        ElseIf .CellChecked = flexUnchecked Then  ||01194  |        ElseIf .CellChecked = flexUnchecked Then  
01219  |            .CellChecked = flexChecked            ||01195  |            .CellChecked = flexChecked            
01220  |            'チェックしたら選択色に変える         ||01196  |            'チェックしたら選択色に変える         
01221  |            .Cell(flexcpBackColor, NowRow, 3, NowR||01197  |            .Cell(flexcpBackColor, NowRow, 3, NowR
01222  |            .Cell(flexcpBackColor, NowRow, 6, NowR||01198  |            .Cell(flexcpBackColor, NowRow, 6, NowR
01223  |            .Cell(flexcpBackColor, NowRow, 8, NowR||01199  |            .Cell(flexcpBackColor, NowRow, 8, NowR
01224  |            .Cell(flexcpBackColor, NowRow, 15, Now||01200  |            .Cell(flexcpBackColor, NowRow, 15, Now
01225  |        End If                                    ||01201  |        End If                                    
01226  |    End With                                      ||01202  |    End With                                      
01227  |End Sub                                           ||01203  |End Sub                                           
01228  |                                                  ||01204  |                                                  
01229  |'=================================================||01205  |'=================================================
01230  |'処理内容  VSFLEX：カラム編集に入る直前処理       ||01206  |'処理内容  VSFLEX：カラム編集に入る直前処理       
01231  |'備考                                             ||01207  |'備考                                             
01232  |'                                                 ||01208  |'                                                 
01233  |'日付         担当               内容             ||01209  |'日付         担当               内容             
01234  |'------------ ----------------- ------------------||01210  |'------------ ----------------- ------------------
01235  |'2004/08/06   M.Katoh<SRA>       新規作成         ||01211  |'2004/08/06   M.Katoh<SRA>       新規作成         
01236  |'2005/01/11   M.Yamazaki<SRA>    変更可能列追加   ||01212  |'2005/01/11   M.Yamazaki<SRA>    変更可能列追加   
01237  |'2005/01/14   M.Yamazaki<SRA>    各通貨(NAV通貨、 ||01213  |'2005/01/14   M.Yamazaki<SRA>    各通貨(NAV通貨、 
01238  |'2005/01/17   M.Yamazaki<SRA>    各通貨(NAV通貨、 ||01214  |'2005/01/17   M.Yamazaki<SRA>    各通貨(NAV通貨、 
01239  |'2008/03/12   K.Furuya<SRA>      ファンド決算期間 ||01215  |'2008/03/12   K.Furuya<SRA>      ファンド決算期間 
01240  |'=================================================||01216  |'=================================================
01241  |Private Sub fgridMakePrint_BeforeEdit(ByVal Row As||01217  |Private Sub fgridMakePrint_BeforeEdit(ByVal Row As
01242  |                                                  ||01218  |                                                  
01243  |'2005/01/17 Start                                 ||01219  |'2005/01/17 Start                                 
01244  |''2005/01/11 Start                                ||01220  |''2005/01/11 Start                                
01245  |''    '変更可能列(支払予定日)以外は変更不可にする ||01221  |''    '変更可能列(支払予定日)以外は変更不可にする 
01246  |''    If (Col = conColPayMentDate) Then           ||01222  |''    If (Col = conColPayMentDate) Then           
01247  |'    If (Col = conColPayMentDate) _               ||01223  |'    If (Col = conColPayMentDate) _               
01248  |'    Or (Col = conColNavAmount) _                 ||01224  |'    Or (Col = conColNavAmount) _                 
01249  |'    Or (Col = conColNavCom) _                    ||01225  |'    Or (Col = conColNavCom) _                    
01250  |'    Or (Col = conColAmountCom) _                 ||01226  |'    Or (Col = conColAmountCom) _                 
01251  |'    Or (Col = conColComPay) Then                 ||01227  |'    Or (Col = conColComPay) Then                 
01252  |'        If fgridMakePrint.Cell(flexcpText, Row, c||01228  |'        If fgridMakePrint.Cell(flexcpText, Row, c
01253  |'            If ((Col = conColNavAmount) Or (Col =||01229  |'            If ((Col = conColNavAmount) Or (Col =
01254  |'                Cancel = True                    ||01230  |'                Cancel = True                    
01255  |'            End If                               ||01231  |'            End If                               
01256  |'        End If                                   ||01232  |'        End If                                   
01257  |''2005/01/11 End                                  ||01233  |''2005/01/11 End                                  
01258  |''2005/01/14 Start                                ||01234  |''2005/01/14 Start                                
01259  |'        'NAV通貨 VS. 閾値通貨 入力制御(NAV通貨 →||01235  |'        'NAV通貨 VS. 閾値通貨 入力制御(NAV通貨 →
01260  |'        If fgridMakePrint.Cell(flexcpText, Row, c||01236  |'        If fgridMakePrint.Cell(flexcpText, Row, c
01261  |'            If (Col = conColNavAmount) Then      ||01237  |'            If (Col = conColNavAmount) Then      
01262  |'                Cancel = True                    ||01238  |'                Cancel = True                    
01263  |'            End If                               ||01239  |'            End If                               
01264  |'        End If                                   ||01240  |'        End If                                   
01265  |'        'NAV通貨 VS. 外部委託顧問料通貨 入力制御(||01241  |'        'NAV通貨 VS. 外部委託顧問料通貨 入力制御(
01266  |'        If fgridMakePrint.Cell(flexcpText, Row, c||01242  |'        If fgridMakePrint.Cell(flexcpText, Row, c
01267  |'            If (Col = conColNavCom) Then         ||01243  |'            If (Col = conColNavCom) Then         
01268  |'                Cancel = True                    ||01244  |'                Cancel = True                    
01269  |'            End If                               ||01245  |'            End If                               
01270  |'        End If                                   ||01246  |'        End If                                   
01271  |'        '閾値通貨 VS. 外部委託顧問料通貨 入力制御||01247  |'        '閾値通貨 VS. 外部委託顧問料通貨 入力制御
01272  |'        If fgridMakePrint.Cell(flexcpText, Row, c||01248  |'        If fgridMakePrint.Cell(flexcpText, Row, c
01273  |'            If (Col = conColAmountCom) Then      ||01249  |'            If (Col = conColAmountCom) Then      
01274  |'                Cancel = True                    ||01250  |'                Cancel = True                    
01275  |'            End If                               ||01251  |'            End If                               
01276  |'        End If                                   ||01252  |'        End If                                   
01277  |'        '外部委託顧問料通貨 VS. 支払通貨('JPY'固 ||01253  |'        '外部委託顧問料通貨 VS. 支払通貨('JPY'固 
01278  |'        If fgridMakePrint.Cell(flexcpText, Row, c||01254  |'        If fgridMakePrint.Cell(flexcpText, Row, c
01279  |'            If (Col = conColComPay) Then         ||01255  |'            If (Col = conColComPay) Then         
01280  |'                Cancel = True                    ||01256  |'                Cancel = True                    
01281  |'            End If                               ||01257  |'            End If                               
01282  |'        End If                                   ||01258  |'        End If                                   
01283  |''2005/01/14 End                                  ||01259  |''2005/01/14 End                                  
01284  |'2008/03/12 START ファンド決算期間での外部委託顧問||01260  |'2008/03/12 START ファンド決算期間での外部委託顧問
01285  |    '変更可能列(支払予定日とファンド計算日)以外は ||01261  |    '変更可能列(支払予定日とファンド計算日)以外は 
01286  |    If (Col = conColPayMentDate) Or (Col = conColF||01262  |    If (Col = conColPayMentDate) Or (Col = conColF
01287  |    Else                                          ||01263  |    Else                                          
01288  |        Cancel = True                             ||01264  |        Cancel = True                             
01289  |    End If                                        ||01265  |    End If                                        
01290  |'2008/03/12 END   ファンド決算期間での外部委託顧問||01266  |'2008/03/12 END   ファンド決算期間での外部委託顧問
01291  |'2005/01/17 End                                   ||01267  |'2005/01/17 End                                   
01292  |End Sub                                           ||01268  |End Sub                                           
01293  |                                                  ||01269  |                                                  
01294  |'=================================================||01270  |'=================================================
01295  |'処理内容  VSFLEX：編集可能カラムでDeleteKeyを押さ||01271  |'処理内容  VSFLEX：編集可能カラムでDeleteKeyを押さ
01296  |'備考                                             ||01272  |'備考                                             
01297  |'                                                 ||01273  |'                                                 
01298  |'日付         担当               内容             ||01274  |'日付         担当               内容             
01299  |'------------ ----------------- ------------------||01275  |'------------ ----------------- ------------------
01300  |'2004/08/06   M.Katoh <SRA>     新規作成          ||01276  |'2004/08/06   M.Katoh <SRA>     新規作成          
01301  |'2005/01/11   M.Yamazaki <SRA>  列追加            ||01277  |'2005/01/11   M.Yamazaki <SRA>  列追加            
01302  |'2005/01/17   M.Yamazaki <SRA>  列追加をせず元に戻||01278  |'2005/01/17   M.Yamazaki <SRA>  列追加をせず元に戻
01303  |'2008/03/12   K.Furuya<SRA>     ファンド決算期間で||01279  |'2008/03/12   K.Furuya<SRA>     ファンド決算期間で
01304  |'=================================================||01280  |'=================================================
01305  |Private Sub fgridMakePrint_KeyDown(KeyCode As Inte||01281  |Private Sub fgridMakePrint_KeyDown(KeyCode As Inte
01306  |    Dim NowRow As Long                            ||01282  |    Dim NowRow As Long                            
01307  |    Dim NowCol As Long                            ||01283  |    Dim NowCol As Long                            
01308  |    Dim intRtn                                    ||01284  |    Dim intRtn                                    
01309  |                                                  ||01285  |                                                  
01310  |    NowRow = fgridMakePrint.Row  '現在行          ||01286  |    NowRow = fgridMakePrint.Row  '現在行          
01311  |    NowCol = fgridMakePrint.Col  '現在列          ||01287  |    NowCol = fgridMakePrint.Col  '現在列          
01312  |                                                  ||01288  |                                                  
01313  |    'Deleteキー押下                               ||01289  |    'Deleteキー押下                               
01314  |    If KeyCode = vbKeyDelete Then                 ||01290  |    If KeyCode = vbKeyDelete Then                 
01315  |        With fgridMakePrint                       ||01291  |        With fgridMakePrint                       
01316  |            Select Case NowCol                    ||01292  |            Select Case NowCol                    
01317  |                '支払予定日列                     ||01293  |                '支払予定日列                     
01318  |                Case conColPayMentDate            ||01294  |                Case conColPayMentDate            
01319  |                    .Cell(flexcpBackColor, NowRow,||01295  |                    .Cell(flexcpBackColor, NowRow,
01320  |                    .Cell(flexcpText, NowRow, NowC||01296  |                    .Cell(flexcpText, NowRow, NowC
01321  |'2008/03/12   K.Furuya<SRA>      ファンド決算期間 ||01297  |'2008/03/12   K.Furuya<SRA>      ファンド決算期間 
01322  |                'ファンド計算FROM列               ||01298  |                'ファンド計算FROM列               
01323  |                Case conColFndCalcFrom            ||01299  |                Case conColFndCalcFrom            
01324  |                    .Cell(flexcpBackColor, NowRow,||01300  |                    .Cell(flexcpBackColor, NowRow,
01325  |                    .Cell(flexcpText, NowRow, NowC||01301  |                    .Cell(flexcpText, NowRow, NowC
01326  |                'ファンド計算TO列                 ||01302  |                'ファンド計算TO列                 
01327  |                Case conColFndCalcTo              ||01303  |                Case conColFndCalcTo              
01328  |                    .Cell(flexcpBackColor, NowRow,||01304  |                    .Cell(flexcpBackColor, NowRow,
01329  |                    .Cell(flexcpText, NowRow, NowC||01305  |                    .Cell(flexcpText, NowRow, NowC
01330  |'2008/03/12   K.Furuya<SRA>      ファンド決算期間 ||01306  |'2008/03/12   K.Furuya<SRA>      ファンド決算期間 
01331  |                                                  ||01307  |                                                  
01332  |'2005/01/17 Start                                 ||01308  |'2005/01/17 Start                                 
01333  |''2005/01/11 Start                                ||01309  |''2005/01/11 Start                                
01334  |'                'NAV通貨→閾値通貨換算レート列   ||01310  |'                'NAV通貨→閾値通貨換算レート列   
01335  |'                Case conColNavAmount             ||01311  |'                Case conColNavAmount             
01336  |'                    .Cell(flexcpBackColor, NowRow||01312  |'                    .Cell(flexcpBackColor, NowRow
01337  |'                    .Cell(flexcpText, NowRow, Now||01313  |'                    .Cell(flexcpText, NowRow, Now
01338  |'                'NAV通貨→顧問料通貨換算レート列 ||01314  |'                'NAV通貨→顧問料通貨換算レート列 
01339  |'                Case conColNavCom                ||01315  |'                Case conColNavCom                
01340  |'                    .Cell(flexcpBackColor, NowRow||01316  |'                    .Cell(flexcpBackColor, NowRow
01341  |'                    .Cell(flexcpText, NowRow, Now||01317  |'                    .Cell(flexcpText, NowRow, Now
01342  |'                '閾値通貨→顧問料通貨換算レート列||01318  |'                '閾値通貨→顧問料通貨換算レート列
01343  |'                Case conColAmountCom             ||01319  |'                Case conColAmountCom             
01344  |'                    .Cell(flexcpBackColor, NowRow||01320  |'                    .Cell(flexcpBackColor, NowRow
01345  |'                    .Cell(flexcpText, NowRow, Now||01321  |'                    .Cell(flexcpText, NowRow, Now
01346  |'                '顧問料レート→支払(円)換算レート||01322  |'                '顧問料レート→支払(円)換算レート
01347  |'                Case conColComPay                ||01323  |'                Case conColComPay                
01348  |'                    .Cell(flexcpBackColor, NowRow||01324  |'                    .Cell(flexcpBackColor, NowRow
01349  |'                    .Cell(flexcpText, NowRow, Now||01325  |'                    .Cell(flexcpText, NowRow, Now
01350  |''2005/01/11 End                                  ||01326  |''2005/01/11 End                                  
01351  |'2005/01/17 End                                   ||01327  |'2005/01/17 End                                   
01352  |            End Select                            ||01328  |            End Select                            
01353  |        End With                                  ||01329  |        End With                                  
01354  |    End If                                        ||01330  |    End If                                        
01355  |                                                  ||01331  |                                                  
01356  |End Sub                                           ||01332  |End Sub                                           
01357  |                                                  ||01333  |                                                  
01358  |'=================================================||01334  |'=================================================
01359  |'処理内容  VSFLEX：入力可能列のKeyPressEdit時処理 ||01335  |'処理内容  VSFLEX：入力可能列のKeyPressEdit時処理 
01360  |'備考                                             ||01336  |'備考                                             
01361  |'                                                 ||01337  |'                                                 
01362  |'日付         担当               内容             ||01338  |'日付         担当               内容             
01363  |'------------ ----------------- ------------------||01339  |'------------ ----------------- ------------------
01364  |'2004/08/06   M.Katoh <SRA>     新規作成          ||01340  |'2004/08/06   M.Katoh <SRA>     新規作成          
01365  |'2005/01/11   M.Yamazaki<SRA>   変更可能列追加    ||01341  |'2005/01/11   M.Yamazaki<SRA>   変更可能列追加    
01366  |'2005/01/17   M.Yamazaki<SRA>   変更可能列追加をせ||01342  |'2005/01/17   M.Yamazaki<SRA>   変更可能列追加をせ
01367  |'2008/03/12   K.Furuya<SRA>     ファンド決算期間で||01343  |'2008/03/12   K.Furuya<SRA>     ファンド決算期間で
01368  |'=================================================||01344  |'=================================================
01369  |Private Sub fgridMakePrint_KeyPressEdit(ByVal Row ||01345  |Private Sub fgridMakePrint_KeyPressEdit(ByVal Row 
01370  |    Dim NowCol As Long                            ||01346  |    Dim NowCol As Long                            
01371  |    Dim intRtn                                    ||01347  |    Dim intRtn                                    
01372  |                                                  ||01348  |                                                  
01373  |    NowCol = fgridMakePrint.Col  '現在列          ||01349  |    NowCol = fgridMakePrint.Col  '現在列          
01374  |                                                  ||01350  |                                                  
01375  |'2005/01/17 Start                                 ||01351  |'2005/01/17 Start                                 
01376  |''2005/01/11 Start                                ||01352  |''2005/01/11 Start                                
01377  |''    '支払予定日の列                             ||01353  |''    '支払予定日の列                             
01378  |''    If NowCol = conColPayMentDate Then          ||01354  |''    If NowCol = conColPayMentDate Then          
01379  |''    '   半角数字のみ入力可                      ||01355  |''    '   半角数字のみ入力可                      
01380  |''        Call gChkInputChar(KeyAscii, "0001010") ||01356  |''        Call gChkInputChar(KeyAscii, "0001010") 
01381  |''    End If                                      ||01357  |''    End If                                      
01382  |'    If (NowCol = conColPayMentDate) _            ||01358  |'    If (NowCol = conColPayMentDate) _            
01383  |'    Or (NowCol = conColNavAmount) _              ||01359  |'    Or (NowCol = conColNavAmount) _              
01384  |'    Or (NowCol = conColNavCom) _                 ||01360  |'    Or (NowCol = conColNavCom) _                 
01385  |'    Or (NowCol = conColAmountCom) _              ||01361  |'    Or (NowCol = conColAmountCom) _              
01386  |'    Or (NowCol = conColComPay) Then              ||01362  |'    Or (NowCol = conColComPay) Then              
01387  |'    '   半角数字のみ入力可                       ||01363  |'    '   半角数字のみ入力可                       
01388  |'        Call gChkInputChar(KeyAscii, "0001010")  ||01364  |'        Call gChkInputChar(KeyAscii, "0001010")  
01389  |'    End If                                       ||01365  |'    End If                                       
01390  |''2005/01/11 End                                  ||01366  |''2005/01/11 End                                  
01391  |    '支払予定日の列                               ||01367  |    '支払予定日の列                               
01392  |    If NowCol = conColPayMentDate Then            ||01368  |    If NowCol = conColPayMentDate Then            
01393  |    '   半角数字のみ入力可                        ||01369  |    '   半角数字のみ入力可                        
01394  |        Call gChkInputChar(KeyAscii, "0001010")   ||01370  |        Call gChkInputChar(KeyAscii, "0001010")   
01395  |    End If                                        ||01371  |    End If                                        
01396  |'2005/01/17 End                                   ||01372  |'2005/01/17 End                                   
01397  |'2008/03/12 START ファンド決算期間での外部委託顧問||01373  |'2008/03/12 START ファンド決算期間での外部委託顧問
01398  |    'ファンド計算FROMの列                         ||01374  |    'ファンド計算FROMの列                         
01399  |    If NowCol = conColFndCalcFrom Then            ||01375  |    If NowCol = conColFndCalcFrom Then            
01400  |    '   半角数字のみ入力可                        ||01376  |    '   半角数字のみ入力可                        
01401  |        Call gChkInputChar(KeyAscii, "0001010")   ||01377  |        Call gChkInputChar(KeyAscii, "0001010")   
01402  |    End If                                        ||01378  |    End If                                        
01403  |    'ファンド計算TOの列                           ||01379  |    'ファンド計算TOの列                           
01404  |    If NowCol = conColFndCalcTo Then              ||01380  |    If NowCol = conColFndCalcTo Then              
01405  |    '   半角数字のみ入力可                        ||01381  |    '   半角数字のみ入力可                        
01406  |        Call gChkInputChar(KeyAscii, "0001010")   ||01382  |        Call gChkInputChar(KeyAscii, "0001010")   
01407  |    End If                                        ||01383  |    End If                                        
01408  |'2008/03/12 END   ファンド決算期間での外部委託顧問||01384  |'2008/03/12 END   ファンド決算期間での外部委託顧問
01409  |End Sub                                           ||01385  |End Sub                                           
01410  |                                                  ||01386  |                                                  
01411  |'=================================================||01387  |'=================================================
01412  |'処理内容  VSFLEX：入力可能列のValidateEdit時処理 ||01388  |'処理内容  VSFLEX：入力可能列のValidateEdit時処理 
01413  |'備考                                             ||01389  |'備考                                             
01414  |'                                                 ||01390  |'                                                 
01415  |'日付         担当               内容             ||01391  |'日付         担当               内容             
01416  |'------------ ----------------- ------------------||01392  |'------------ ----------------- ------------------
01417  |'2004/08/06   M.Katoh <SRA>     新規作成          ||01393  |'2004/08/06   M.Katoh <SRA>     新規作成          
01418  |'2005/01/11   M.Yamazaki <SRA>  入力チェック列追加||01394  |'2005/01/11   M.Yamazaki <SRA>  入力チェック列追加
01419  |'2005/01/17   M.Yamazaki <SRA>  入力チェック列追加||01395  |'2005/01/17   M.Yamazaki <SRA>  入力チェック列追加
01420  |'=================================================||01396  |'=================================================
01421  |Private Sub fgridMakePrint_ValidateEdit(ByVal Row ||01397  |Private Sub fgridMakePrint_ValidateEdit(ByVal Row 
01422  |    Dim strtxt As String            '入力文字列の ||01398  |    Dim strtxt As String            '入力文字列の 
01423  |    Dim intRtn As Integer                         ||01399  |    Dim intRtn As Integer                         
01424  |                                                  ||01400  |                                                  
01425  |    '出力列の場合チェック不要                     ||01401  |    '出力列の場合チェック不要                     
01426  |    If (Col = conColSysOutbln) Then               ||01402  |    If (Col = conColSysOutbln) Then               
01427  |        GoTo EndProc                              ||01403  |        GoTo EndProc                              
01428  |    End If                                        ||01404  |    End If                                        
01429  |                                                  ||01405  |                                                  
01430  |    With fgridMakePrint                           ||01406  |    With fgridMakePrint                           
01431  |'2005/01/17 Start                                 ||01407  |'2005/01/17 Start                                 
01432  |''2005/01/11 Start                                ||01408  |''2005/01/11 Start                                
01433  |''        '入力列のチェック                       ||01409  |''        '入力列のチェック                       
01434  |''        strtxt = gstrDateFormat(Trim(.EditText),||01410  |''        strtxt = gstrDateFormat(Trim(.EditText),
01435  |''        If strtxt = "" Then '未入力             ||01411  |''        If strtxt = "" Then '未入力             
01436  |''            .Cell(flexcpBackColor, Row, Col) = C||01412  |''            .Cell(flexcpBackColor, Row, Col) = C
01437  |''        Else                                    ||01413  |''        Else                                    
01438  |''            If (IsDate(strtxt) = False) Then    ||01414  |''            If (IsDate(strtxt) = False) Then    
01439  |''                .Cell(flexcpBackColor, Row, Col)||01415  |''                .Cell(flexcpBackColor, Row, Col)
01440  |''                intRtn = MsgBox("日付を入力して ||01416  |''                intRtn = MsgBox("日付を入力して 
01441  |''                    vbCritical, "日付チェック") ||01417  |''                    vbCritical, "日付チェック") 
01442  |''            Else                                ||01418  |''            Else                                
01443  |''                .Cell(flexcpBackColor, Row, Col)||01419  |''                .Cell(flexcpBackColor, Row, Col)
01444  |''            End If                              ||01420  |''            End If                              
01445  |''        End If                                  ||01421  |''        End If                                  
01446  |'        Select Case Col                          ||01422  |'        Select Case Col                          
01447  |'            Case conColPayMentDate               ||01423  |'            Case conColPayMentDate               
01448  |'                '入力列のチェック                ||01424  |'                '入力列のチェック                
01449  |'                strtxt = gstrDateFormat(Trim(.Edi||01425  |'                strtxt = gstrDateFormat(Trim(.Edi
01450  |'                If strtxt = "" Then '未入力      ||01426  |'                If strtxt = "" Then '未入力      
01451  |'                    .Cell(flexcpBackColor, Row, C||01427  |'                    .Cell(flexcpBackColor, Row, C
01452  |'                Else                             ||01428  |'                Else                             
01453  |'                    If (IsDate(strtxt) = False) T||01429  |'                    If (IsDate(strtxt) = False) T
01454  |'                        .Cell(flexcpBackColor, Ro||01430  |'                        .Cell(flexcpBackColor, Ro
01455  |'                        intRtn = MsgBox("日付を入||01431  |'                        intRtn = MsgBox("日付を入
01456  |'                            vbCritical, "日付チェ||01432  |'                            vbCritical, "日付チェ
01457  |'                    Else                         ||01433  |'                    Else                         
01458  |'                        .Cell(flexcpBackColor, Ro||01434  |'                        .Cell(flexcpBackColor, Ro
01459  |'                    End If                       ||01435  |'                    End If                       
01460  |'                End If                           ||01436  |'                End If                           
01461  |'            Case conColNavAmount                 ||01437  |'            Case conColNavAmount                 
01462  |'                '入力列のチェック                ||01438  |'                '入力列のチェック                
01463  |'                strtxt = Trim(.EditText)         ||01439  |'                strtxt = Trim(.EditText)         
01464  |'                If strtxt = "" Then '未入力      ||01440  |'                If strtxt = "" Then '未入力      
01465  |'                    .Cell(flexcpBackColor, Row, C||01441  |'                    .Cell(flexcpBackColor, Row, C
01466  |'                Else                             ||01442  |'                Else                             
01467  |'                    If (IsNumeric(strtxt) = False||01443  |'                    If (IsNumeric(strtxt) = False
01468  |'                        .Cell(flexcpBackColor, Ro||01444  |'                        .Cell(flexcpBackColor, Ro
01469  |'                        intRtn = MsgBox("換算レー||01445  |'                        intRtn = MsgBox("換算レー
01470  |'                            vbCritical, "換算レー||01446  |'                            vbCritical, "換算レー
01471  |'                    Else                         ||01447  |'                    Else                         
01472  |'                        .Cell(flexcpBackColor, Ro||01448  |'                        .Cell(flexcpBackColor, Ro
01473  |'                    End If                       ||01449  |'                    End If                       
01474  |'                End If                           ||01450  |'                End If                           
01475  |'            Case conColNavCom                    ||01451  |'            Case conColNavCom                    
01476  |'                '入力列のチェック                ||01452  |'                '入力列のチェック                
01477  |'                strtxt = Trim(.EditText)         ||01453  |'                strtxt = Trim(.EditText)         
01478  |'                If strtxt = "" Then '未入力      ||01454  |'                If strtxt = "" Then '未入力      
01479  |'                    .Cell(flexcpBackColor, Row, C||01455  |'                    .Cell(flexcpBackColor, Row, C
01480  |'                Else                             ||01456  |'                Else                             
01481  |'                    If (IsNumeric(strtxt) = False||01457  |'                    If (IsNumeric(strtxt) = False
01482  |'                        .Cell(flexcpBackColor, Ro||01458  |'                        .Cell(flexcpBackColor, Ro
01483  |'                        intRtn = MsgBox("換算レー||01459  |'                        intRtn = MsgBox("換算レー
01484  |'                            vbCritical, "換算レー||01460  |'                            vbCritical, "換算レー
01485  |'                    Else                         ||01461  |'                    Else                         
01486  |'                        .Cell(flexcpBackColor, Ro||01462  |'                        .Cell(flexcpBackColor, Ro
01487  |'                    End If                       ||01463  |'                    End If                       
01488  |'                End If                           ||01464  |'                End If                           
01489  |'            Case conColAmountCom                 ||01465  |'            Case conColAmountCom                 
01490  |'                '入力列のチェック                ||01466  |'                '入力列のチェック                
01491  |'                strtxt = Trim(.EditText)         ||01467  |'                strtxt = Trim(.EditText)         
01492  |'                If strtxt = "" Then '未入力      ||01468  |'                If strtxt = "" Then '未入力      
01493  |'                    .Cell(flexcpBackColor, Row, C||01469  |'                    .Cell(flexcpBackColor, Row, C
01494  |'                Else                             ||01470  |'                Else                             
01495  |'                    If (IsNumeric(strtxt) = False||01471  |'                    If (IsNumeric(strtxt) = False
01496  |'                        .Cell(flexcpBackColor, Ro||01472  |'                        .Cell(flexcpBackColor, Ro
01497  |'                        intRtn = MsgBox("換算レー||01473  |'                        intRtn = MsgBox("換算レー
01498  |'                            vbCritical, "換算レー||01474  |'                            vbCritical, "換算レー
01499  |'                    Else                         ||01475  |'                    Else                         
01500  |'                        .Cell(flexcpBackColor, Ro||01476  |'                        .Cell(flexcpBackColor, Ro
01501  |'                    End If                       ||01477  |'                    End If                       
01502  |'                End If                           ||01478  |'                End If                           
01503  |'            Case conColComPay                    ||01479  |'            Case conColComPay                    
01504  |'                '入力列のチェック                ||01480  |'                '入力列のチェック                
01505  |'                strtxt = Trim(.EditText)         ||01481  |'                strtxt = Trim(.EditText)         
01506  |'                If strtxt = "" Then '未入力      ||01482  |'                If strtxt = "" Then '未入力      
01507  |'                    .Cell(flexcpBackColor, Row, C||01483  |'                    .Cell(flexcpBackColor, Row, C
01508  |'                Else                             ||01484  |'                Else                             
01509  |'                    If (IsNumeric(strtxt) = False||01485  |'                    If (IsNumeric(strtxt) = False
01510  |'                        .Cell(flexcpBackColor, Ro||01486  |'                        .Cell(flexcpBackColor, Ro
01511  |'                        intRtn = MsgBox("換算レー||01487  |'                        intRtn = MsgBox("換算レー
01512  |'                            vbCritical, "換算レー||01488  |'                            vbCritical, "換算レー
01513  |'                    Else                         ||01489  |'                    Else                         
01514  |'                        .Cell(flexcpBackColor, Ro||01490  |'                        .Cell(flexcpBackColor, Ro
01515  |'                    End If                       ||01491  |'                    End If                       
01516  |'                End If                           ||01492  |'                End If                           
01517  |'        End Select                               ||01493  |'        End Select                               
01518  |''2005/01/11 End                                  ||01494  |''2005/01/11 End                                  
01519  |        '入力列のチェック                         ||01495  |        '入力列のチェック                         
01520  |        strtxt = gstrDateFormat(Trim(.EditText), 1||01496  |        strtxt = gstrDateFormat(Trim(.EditText), 1
01521  |        If strtxt = "" Then '未入力               ||01497  |        If strtxt = "" Then '未入力               
01522  |            .Cell(flexcpBackColor, Row, Col) = COL||01498  |            .Cell(flexcpBackColor, Row, Col) = COL
01523  |        Else                                      ||01499  |        Else                                      
01524  |            If (IsDate(strtxt) = False) Then      ||01500  |            If (IsDate(strtxt) = False) Then      
01525  |                .Cell(flexcpBackColor, Row, Col) =||01501  |                .Cell(flexcpBackColor, Row, Col) =
01526  |                intRtn = MsgBox("日付を入力してく ||01502  |                intRtn = MsgBox("日付を入力してく 
01527  |                    vbCritical, "日付チェック")   ||01503  |                    vbCritical, "日付チェック")   
01528  |            Else                                  ||01504  |            Else                                  
01529  |                .Cell(flexcpBackColor, Row, Col) =||01505  |                .Cell(flexcpBackColor, Row, Col) =
01530  |            End If                                ||01506  |            End If                                
01531  |        End If                                    ||01507  |        End If                                    
01532  |'2005/01/17 End                                   ||01508  |'2005/01/17 End                                   
01533  |                                                  ||01509  |                                                  
01534  |    End With                                      ||01510  |    End With                                      
01535  |EndProc:                                          ||01511  |EndProc:                                          
01536  |                                                  ||01512  |                                                  
01537  |End Sub                                           ||01513  |End Sub                                           
01538  |                                                  ||01514  |                                                  
01539  |'=================================================||01515  |'=================================================
01540  |'処理内容     FormResize時処理                    ||01516  |'処理内容     FormResize時処理                    
01541  |'備考                                             ||01517  |'備考                                             
01542  |'                                                 ||01518  |'                                                 
01543  |'日付         担当               内容             ||01519  |'日付         担当               内容             
01544  |'------------ ----------------- ------------------||01520  |'------------ ----------------- ------------------
01545  |'2004/08/23   M.Katoh <SRA>     新規作成          ||01521  |'2004/08/23   M.Katoh <SRA>     新規作成          
01546  |'=================================================||01522  |'=================================================
01547  |Private Sub Form_Resize()                         ||01523  |Private Sub Form_Resize()                         
01548  |    On Error GoTo OnErrorProc                     ||01524  |    On Error GoTo OnErrorProc                     
01549  |                                                  ||01525  |                                                  
01550  |    Const conMeModule As String = "Form_Resize" ' ||01526  |    Const conMeModule As String = "Form_Resize" ' 
01551  |    Dim strErrCall As String        'エラー呼出元 ||01527  |    Dim strErrCall As String        'エラー呼出元 
01552  |                                                  ||01528  |                                                  
01553  |    'エラー呼出元設定                             ||01529  |    'エラー呼出元設定                             
01554  |    strErrCall = conMeForm & ":" & conMeModule    ||01530  |    strErrCall = conMeForm & ":" & conMeModule    
01555  |                                                  ||01531  |                                                  
01556  |    ' フォームのサイズが変更されたときのリサイズ処||01532  |    ' フォームのサイズが変更されたときのリサイズ処
01557  |    ' 記述します。                                ||01533  |    ' 記述します。                                
01558  |    On Error Resume Next                          ||01534  |    On Error Resume Next                          
01559  |                                                  ||01535  |                                                  
01560  |    ' 上のグリッド(fgridDailyOtherCom)のリサイズ処||01536  |    ' 上のグリッド(fgridDailyOtherCom)のリサイズ処
01561  |    On Error Resume Next                          ||01537  |    On Error Resume Next                          
01562  |    Dim h!                                        ||01538  |    Dim h!                                        
01563  |    With fgridMakePrint                           ||01539  |    With fgridMakePrint                           
01564  |        h = ScaleHeight - .Top - .Left            ||01540  |        h = ScaleHeight - .Top - .Left            
01565  |        .Move .Left, .Top, ScaleWidth - 2 * .Left,||01541  |        .Move .Left, .Top, ScaleWidth - 2 * .Left,
01566  |    End With                                      ||01542  |    End With                                      
01567  |                                                  ||01543  |                                                  
01568  |    GoTo EndProc                                  ||01544  |    GoTo EndProc                                  
01569  |                                                  ||01545  |                                                  
01570  |OnErrorProc:                                      ||01546  |OnErrorProc:                                      
01571  |    Call subError("システムエラー", Str(Err.Number||01547  |    Call subError("システムエラー", Str(Err.Number
01572  |        Error, strErrCall, conTitle)              ||01548  |        Error, strErrCall, conTitle)              
01573  |    Exit Sub                                      ||01549  |    Exit Sub                                      
01574  |                                                  ||01550  |                                                  
01575  |ErrorProc:                                        ||01551  |ErrorProc:                                        
01576  |    Exit Sub                                      ||01552  |    Exit Sub                                      
01577  |                                                  ||01553  |                                                  
01578  |EndProc:                                          ||01554  |EndProc:                                          
01579  |                                                  ||01555  |                                                  
01580  |End Sub                                           ||01556  |End Sub                                           
01581  |                                                  ||01557  |                                                  
01582  |Private Sub mnuEnd_Click()                        ||01558  |Private Sub mnuEnd_Click()                        
01583  |    Unload Me                                     ||01559  |    Unload Me                                     
01584  |End Sub                                           ||01560  |End Sub                                           
01585  |                                                  ||01561  |                                                  
01586  |'=================================================||01562  |'=================================================
01587  |'処理内容  FormKeyDown時処理                      ||01563  |'処理内容  FormKeyDown時処理                      
01588  |'備考      FormのKeyPreviewをTrueにした上で、エン ||01564  |'備考      FormのKeyPreviewをTrueにした上で、エン 
01589  |'                                                 ||01565  |'                                                 
01590  |'日付         担当               内容             ||01566  |'日付         担当               内容             
01591  |'------------ ----------------- ------------------||01567  |'------------ ----------------- ------------------
01592  |'2004/04/01   H.Yonehara <SRA>  新規作成          ||01568  |'2004/04/01   H.Yonehara <SRA>  新規作成          
01593  |'=================================================||01569  |'=================================================
01594  |Private Sub Form_KeyDown(KeyCode As Integer, Shift||01570  |Private Sub Form_KeyDown(KeyCode As Integer, Shift
01595  |    If (KeyCode = vbKeyReturn) Then               ||01571  |    If (KeyCode = vbKeyReturn) Then               
01596  |        KeyCode = 0                               ||01572  |        KeyCode = 0                               
01597  |        SendKeys "{TAB}"                          ||01573  |        SendKeys "{TAB}"                          
01598  |    End If                                        ||01574  |    End If                                        
01599  |End Sub                                           ||01575  |End Sub                                           
01600  |                                                  ||01576  |                                                  
01601  |'=================================================||01577  |'=================================================
01602  |'処理内容     FormLoad時モジュール                ||01578  |'処理内容     FormLoad時モジュール                
01603  |'備考                                             ||01579  |'備考                                             
01604  |'                                                 ||01580  |'                                                 
01605  |'日付         担当               内容             ||01581  |'日付         担当               内容             
01606  |'------------ ----------------- ------------------||01582  |'------------ ----------------- ------------------
01607  |'2004/08/03   M.Katoh <SRA>     新規作成          ||01583  |'2004/08/03   M.Katoh <SRA>     新規作成          
01608  |'2008/03/12   K.Furuya<SRA>     ファンド決算期間で||01584  |'2008/03/12   K.Furuya<SRA>     ファンド決算期間で
01609  |'=================================================||01585  |'=================================================
01610  |Private Sub Form_load()                           ||01586  |Private Sub Form_load()                           
01611  |    On Error GoTo OnErrorProc                     ||01587  |    On Error GoTo OnErrorProc                     
01612  |                                                  ||01588  |                                                  
01613  |    Const conMeModule As String = "Form_Load" '当 ||01589  |    Const conMeModule As String = "Form_Load" '当 
01614  |    Dim strErrCall As String        'エラー呼出元 ||01590  |    Dim strErrCall As String        'エラー呼出元 
01615  |                                                  ||01591  |                                                  
01616  |    'エラー呼出元設定                             ||01592  |    'エラー呼出元設定                             
01617  |    strErrCall = conMeForm & ":" & conMeModule    ||01593  |    strErrCall = conMeForm & ":" & conMeModule    
01618  |                                                  ||01594  |                                                  
01619  |    'マウスポインター砂時計                       ||01595  |    'マウスポインター砂時計                       
01620  |    Screen.MousePointer = vbHourglass             ||01596  |    Screen.MousePointer = vbHourglass             
01621  |                                                  ||01597  |                                                  
01622  |    '初期設定                                     ||01598  |    '初期設定                                     
01623  |    mblnFlgUnload = True                        'U||01599  |    mblnFlgUnload = True                        'U
01624  |    mblnFinishStatus = True                     ' ||01600  |    mblnFinishStatus = True                     ' 
01625  |    mblnDBClose = False                         'D||01601  |    mblnDBClose = False                         'D
01626  |    mblnDynasetOpen = False                     'D||01602  |    mblnDynasetOpen = False                     'D
01627  |    mblnDynasetClose = False                    'D||01603  |    mblnDynasetClose = False                    'D
01628  |    mblnRollback = False                        'D||01604  |    mblnRollback = False                        'D
01629  |    mstrbasedate = ""                           'G||01605  |    mstrbasedate = ""                           'G
01630  |    mstrYYYYMMDD = ""                           'm||01606  |    mstrYYYYMMDD = ""                           'm
01631  |    mstrYYYYMM = ""                               ||01607  |    mstrYYYYMM = ""                               
01632  |    mstrbaseToday = ""                           '||01608  |    mstrbaseToday = ""                           '
01633  |                                                  ||01609  |                                                  
01634  |    mstrYYYYMM = gstrZengetuYYYYMM                ||01610  |    mstrYYYYMM = gstrZengetuYYYYMM                
01635  |    mstrYYYYMMDD = gstrZengetuYYYYMMDD            ||01611  |    mstrYYYYMMDD = gstrZengetuYYYYMMDD            
01636  |    mstrbaseToday = gstrDateFormat2(CStr(DATE), 1)||01612  |    mstrbaseToday = gstrDateFormat2(CStr(DATE), 1)
01637  |                                                  ||01613  |                                                  
01638  |    '基準月セット                                 ||01614  |    '基準月セット                                 
01639  |    mstrbasedate = Trim(mstrYYYYMM)               ||01615  |    mstrbasedate = Trim(mstrYYYYMM)               
01640  |    mstrbaseMonth = Mid(mstrbasedate, 5, 2)       ||01616  |    mstrbaseMonth = Mid(mstrbasedate, 5, 2)       
01641  |    mstrbaseYear = Mid(mstrbasedate, 1, 4)        ||01617  |    mstrbaseYear = Mid(mstrbasedate, 1, 4)        
01642  |                                                  ||01618  |                                                  
01643  |    'コンスタント配列の取得(契約区分)             ||01619  |    'コンスタント配列の取得(契約区分)             
01644  |    Call gParseStringGet(CONTRACT_FLAG, mstrContra||01620  |    Call gParseStringGet(CONTRACT_FLAG, mstrContra
01645  |                                                  ||01621  |                                                  
01646  |'2006/07/13 START K.Furuya 期中料率変更契約/RAFI対||01622  |'2006/07/13 START K.Furuya 期中料率変更契約/RAFI対
01647  |'    Me.Width = 9705                              ||01623  |'    Me.Width = 9705                              
01648  |'    Me.Height = 6330                             ||01624  |'    Me.Height = 6330                             
01649  |'2008/03/12 START ファンド決算期間での外部委託顧問||01625  |'2008/03/12 START ファンド決算期間での外部委託顧問
01650  |'    Me.Width = 12945                             ||01626  |'    Me.Width = 12945                             
01651  |    Me.Width = 15950                              ||01627  |    Me.Width = 15950                              
01652  |'2008/03/12 END   ファンド決算期間での外部委託顧問||01628  |'2008/03/12 END   ファンド決算期間での外部委託顧問
01653  |    Me.Height = 8850                              ||01629  |    Me.Height = 8850                              
01654  |'2006/07/13 END   K.Furuya 期中料率変更契約/RAFI対||01630  |'2006/07/13 END   K.Furuya 期中料率変更契約/RAFI対
01655  |                                                  ||01631  |                                                  
01656  |    '画面共通初期処理                             ||01632  |    '画面共通初期処理                             
01657  |    Call gFormIni(Me)                             ||01633  |    Call gFormIni(Me)                             
01658  |                                                  ||01634  |                                                  
01659  |    '確認書作成情報グリッド初期処理               ||01635  |    '確認書作成情報グリッド初期処理               
01660  |    Call sbMakePrintFlexGridIni                   ||01636  |    Call sbMakePrintFlexGridIni                   
01661  |                                                  ||01637  |                                                  
01662  |    '出力日付に当日日付をセット                   ||01638  |    '出力日付に当日日付をセット                   
01663  |    txtSysOutDate.Text = Format(DATE, "YYYY/MM/DD"||01639  |    txtSysOutDate.Text = Format(DATE, "YYYY/MM/DD"
01664  |                                                  ||01640  |                                                  
01665  |'''''    '確認書作成データ抽出処理                ||01641  |'''''    '確認書作成データ抽出処理                
01666  |'''''    If fnMakePrintDataSet() = False Then     ||01642  |'''''    If fnMakePrintDataSet() = False Then     
01667  |'''''        Unload Me                            ||01643  |'''''        Unload Me                            
01668  |'''''        GoTo ErrorProc                       ||01644  |'''''        GoTo ErrorProc                       
01669  |'''''    Else                                     ||01645  |'''''    Else                                     
01670  |'''''        Me.Enabled = True                    ||01646  |'''''        Me.Enabled = True                    
01671  |'''''        Me.Refresh                           ||01647  |'''''        Me.Refresh                           
01672  |'''''    End If                                   ||01648  |'''''    End If                                   
01673  |                                                  ||01649  |                                                  
01674  |'2005/08/03大改修実施     '確認書作成データ抽出処 ||01650  |'2005/08/03大改修実施     '確認書作成データ抽出処 
01675  |    If fnMakePrintDataSet_New() = False Then      ||01651  |    If fnMakePrintDataSet_New() = False Then      
01676  |        Unload Me                                 ||01652  |        Unload Me                                 
01677  |        GoTo ErrorProc                            ||01653  |        GoTo ErrorProc                            
01678  |    Else                                          ||01654  |    Else                                          
01679  |        Me.Enabled = True                         ||01655  |        Me.Enabled = True                         
01680  |        Me.Refresh                                ||01656  |        Me.Refresh                                
01681  |    End If                                        ||01657  |    End If                                        
01682  |                                                  ||01658  |                                                  
01683  |    '部署名コンボボックスにコンスタントセット     ||01659  |    '部署名コンボボックスにコンスタントセット     
01684  |    Call gConstDataSetToCombo(cboBumonFlag, BUMON_||01660  |    Call gConstDataSetToCombo(cboBumonFlag, BUMON_
01685  |                                                  ||01661  |                                                  
01686  |''debug                                           ||01662  |''debug                                           
01687  |'txtInputName.Text = "吉 池"                      ||01663  |'txtInputName.Text = "吉 池"                      
01688  |'txtInputTax.Text = "5"                           ||01664  |'txtInputTax.Text = "5"                           
01689  |                                                  ||01665  |                                                  
01690  |    GoTo EndProc                                  ||01666  |    GoTo EndProc                                  
01691  |                                                  ||01667  |                                                  
01692  |OnErrorProc:                                      ||01668  |OnErrorProc:                                      
01693  |    Call subError("システムエラー", Str(Err.Number||01669  |    Call subError("システムエラー", Str(Err.Number
01694  |        Error, strErrCall, conTitle)              ||01670  |        Error, strErrCall, conTitle)              
01695  |    Exit Sub                                      ||01671  |    Exit Sub                                      
01696  |                                                  ||01672  |                                                  
01697  |ErrorProc:                                        ||01673  |ErrorProc:                                        
01698  |    'マウスポインター元に戻す                     ||01674  |    'マウスポインター元に戻す                     
01699  |    Screen.MousePointer = vbDefault               ||01675  |    Screen.MousePointer = vbDefault               
01700  |    Exit Sub                                      ||01676  |    Exit Sub                                      
01701  |                                                  ||01677  |                                                  
01702  |EndProc:                                          ||01678  |EndProc:                                          
01703  |    'マウスポインター元に戻す                     ||01679  |    'マウスポインター元に戻す                     
01704  |    Screen.MousePointer = vbDefault               ||01680  |    Screen.MousePointer = vbDefault               
01705  |End Sub                                           ||01681  |End Sub                                           
01706  |                                                  ||01682  |                                                  
01707  |'=================================================||01683  |'=================================================
01708  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnMakePrintDataSet_New       ||01684  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnMakePrintDataSet_New       
01709  |'機能            :   確認書作成テーブルデータ抽出 ||01685  |'機能            :   確認書作成テーブルデータ抽出 
01710  |'                                                 ||01686  |'                                                 
01711  |'日付               担当　              修正内容  ||01687  |'日付               担当　              修正内容  
01712  |'-------------------------------------------------||01688  |'-------------------------------------------------
01713  |'2005/08/03         K.Nishihama<SRA>   新規作成   ||01689  |'2005/08/03         K.Nishihama<SRA>   新規作成   
01714 L|'2014/02/19         M.Takada   <SRA>   【管理会計 ||       |                                                  
01715  |'=================================================||01690  |'=================================================
01716  |Private Function fnMakePrintDataSet_New() As Boole||01691  |Private Function fnMakePrintDataSet_New() As Boole
01717  |                                                  ||01692  |                                                  
01718  |    Const conMeModule   As String = "fnMakePrintDa||01693  |    Const conMeModule   As String = "fnMakePrintDa
01719  |    Dim strErrCall      As String        'エラー呼||01694  |    Dim strErrCall      As String        'エラー呼
01720  |    Dim sSql            As String                 ||01695  |    Dim sSql            As String                 
01721  |    Dim lRecCnt         As Long                   ||01696  |    Dim lRecCnt         As Long                   
01722  |    Dim lActiveIdx      As Long                   ||01697  |    Dim lActiveIdx      As Long                   
01723  |    Dim iRet            As Integer                ||01698  |    Dim iRet            As Integer                
01724  |    Dim intRtn As Long                            ||01699  |    Dim intRtn As Long                            
01725  |    Dim strCommandLine As String                  ||01700  |    Dim strCommandLine As String                  
01726  |                                                  ||01701  |                                                  
01727  |    '初期処理                                     ||01702  |    '初期処理                                     
01728  |    fnMakePrintDataSet_New = False                ||01703  |    fnMakePrintDataSet_New = False                
01729  |                                                  ||01704  |                                                  
01730  |    'エラー呼出元設定                             ||01705  |    'エラー呼出元設定                             
01731  |    strErrCall = conMeForm & ":" & conMeModule    ||01706  |    strErrCall = conMeForm & ":" & conMeModule    
01732  |                                                  ||01707  |                                                  
01733  |    '起動するUNIXバッチ名とクライアントテンポラリ ||01708  |    '起動するUNIXバッチ名とクライアントテンポラリ 
01734  |    gstrCfrBatch = gstrCfrRootDir & gstrCfrExeDir ||01709  |    gstrCfrBatch = gstrCfrRootDir & gstrCfrExeDir 
01735  |    gstrCfrBatchTempFile = gstrCfrBatchConfirmDraw||01710  |    gstrCfrBatchTempFile = gstrCfrBatchConfirmDraw
01736  |                                                  ||01711  |                                                  
01737  |    strCommandLine = _                            ||01712  |    strCommandLine = _                            
01738  |        "cmd.exe /c rsh.exe" _                    ||01713  |        "cmd.exe /c rsh.exe" _                    
01739  |        & " " & gstrCfrUnixServer _               ||01714  |        & " " & gstrCfrUnixServer _               
01740  |        & " -l " & gstrCfrUnixUser _              ||01715  |        & " -l " & gstrCfrUnixUser _              
01741  |        & " " & gstrCfrBatch _                    ||01716  |        & " " & gstrCfrBatch _                    
01742  |        & " > " & gstrCfrBatchTempFile            ||01717  |        & " > " & gstrCfrBatchTempFile            
01743  |                                                  ||01718  |                                                  
01744  |        ' コマンドの実行                          ||01719  |        ' コマンドの実行                          
01745  |    If Not SyncShell(strCommandLine, vbHide) Then ||01720  |    If Not SyncShell(strCommandLine, vbHide) Then 
01746  |        intRtn = MsgBox("システムエラー：SyncShell||01721  |        intRtn = MsgBox("システムエラー：SyncShell
01747  |        Exit Function                             ||01722  |        Exit Function                             
01748  |    End If                                        ||01723  |    End If                                        
01749  |                                                  ||01724  |                                                  
01750  |    'ｲﾝﾃﾞｯｸｽ初期化                                ||01725  |    'ｲﾝﾃﾞｯｸｽ初期化                                
01751  |    lRecCnt = 0                                   ||01726  |    lRecCnt = 0                                   
01752  |    lRowCnt = 0                                   ||01727  |    lRowCnt = 0                                   
01753  |    lActiveIdx = 0                                ||01728  |    lActiveIdx = 0                                
01754  |    'DBオープン                                   ||01729  |    'DBオープン                                   
01755  |    If Not gintDbOpen() Then                      ||01730  |    If Not gintDbOpen() Then                      
01756  |        Exit Function                             ||01731  |        Exit Function                             
01757  |    End If                                        ||01732  |    End If                                        
01758  |                                                  ||01733  |                                                  
01759  |    'SQL文作成 一覧表示データ取得                 ||01734  |    'SQL文作成 一覧表示データ取得                 
01760  |    sSql = ""                                     ||01735  |    sSql = ""                                     
01761  |    sSql = sSql & "SELECT * FROM CFR_DETAIL_TBL or||01736  |    sSql = sSql & "SELECT * FROM CFR_DETAIL_TBL or
01762  |                                                  ||01737  |                                                  
01763  |    'ﾀﾞｲﾅｾｯﾄの作成                                ||01738  |    'ﾀﾞｲﾅｾｯﾄの作成                                
01764  |    If (gintDyCreate(sSql) = False) Then          ||01739  |    If (gintDyCreate(sSql) = False) Then          
01765  |        Call subError("DBエラー", Str(9999), "gint||01740  |        Call subError("DBエラー", Str(9999), "gint
01766  |            "DB関数エラー", strErrCall, conTitle) ||01741  |            "DB関数エラー", strErrCall, conTitle) 
01767  |        Exit Function                             ||01742  |        Exit Function                             
01768  |    End If                                        ||01743  |    End If                                        
01769  |                                                  ||01744  |                                                  
01770  |    '配列初期化                                   ||01745  |    '配列初期化                                   
01771  |    ReDim gbuMGetUPDRec.N(0)                      ||01746  |    ReDim gbuMGetUPDRec.N(0)                      
01772  |                                                  ||01747  |                                                  
01773  |    'EOF判定処理                                  ||01748  |    'EOF判定処理                                  
01774  |    Do Until gblnDyEOF()                          ||01749  |    Do Until gblnDyEOF()                          
01775  |        '対象データ抽出                           ||01750  |        '対象データ抽出                           
01776  |        '配列にセット                             ||01751  |        '配列にセット                             
01777  |        Call sbMGetDataGet(lRecCnt)               ||01752  |        Call sbMGetDataGet(lRecCnt)               
01778  |        lRecCnt = lRecCnt + 1                     ||01753  |        lRecCnt = lRecCnt + 1                     
01779  |        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                         ||01754  |        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                         
01780  |        Call gDyNext                              ||01755  |        Call gDyNext                              
01781  |    Loop                                          ||01756  |    Loop                                          
01782  |                                                  ||01757  |                                                  
01783  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             ||01758  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             
01784  |    Call gblnDyClose                              ||01759  |    Call gblnDyClose                              
01785  |                                                  ||01760  |                                                  
01786 L|'2014/02/19 START M.Takada 【管理会計】消費税率変 ||01761 R|    'SQL文作成 消費税率取得                       
01787 L|    ''SQL文作成 消費税率取得                      ||01762 R|    sSql = "SELECT CONSUMPTION_TAX FROM CFR_CONSUM
01788 L|    'sSql = "SELECT CONSUMPTION_TAX FROM CFR_CONSU||01763 R|                                                  
01789 L|                                                  ||       |                                                  
01790 L|    ''ﾀﾞｲﾅｾｯﾄの作成                               ||       |                                                  
01791 L|    'If (gintDyCreate(sSql) = False) Then         ||       |                                                  
01792 L|    '    Call subError("DBエラー", Str(9999), "gin||       |                                                  
01793 L|    '        "DB関数エラー", strErrCall, conTitle)||       |                                                  
01794 L|    '    Exit Function                            ||       |                                                  
01795 L|    'End If                                       ||       |                                                  
01796 L|                                                  ||       |                                                  
01797 L|    'ddblconsumption_tax = gvlnDyDataN("CONSUMPTIO||       |                                                  
25392 M|    'ﾀﾞｲﾅｾｯﾄの作成                                ||01764 R|    'ﾀﾞｲﾅｾｯﾄの作成                                
       |                                                  ||01765 R|    If (gintDyCreate(sSql) = False) Then          
01798 L|                                                  ||01770 M|                                                  
01799 L|    ''ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                            ||       |                                                  
01800 L|    'Call gblnDyClose                             ||       |                                                  
01801 L|'2014/02/19 END   M.Takada 【管理会計】消費税率変 ||       |                                                  
25394 M|        Call subError("DBエラー", Str(9999), "gint||01766 R|        Call subError("DBエラー", Str(9999), "gint
25395 M|            "DB関数エラー", strErrCall, conTitle) ||01767 R|            "DB関数エラー", strErrCall, conTitle) 
25396 M|        Exit Function                             ||01768 R|        Exit Function                             
25397 M|    End If                                        ||01769 R|    End If                                        
01798 M|                                                  ||01770 R|                                                  
       |                                                  ||01771 R|    ddblconsumption_tax = gvlnDyDataN("CONSUMPTION
       |                                                  ||01772 R|                                                  
       |                                                  ||01773 R|    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             
       |                                                  ||01774 R|    Call gblnDyClose                              
01802  |                                                  ||01775  |                                                  
01803  |    'グリッドデータセット処理                     ||01776  |    'グリッドデータセット処理                     
01804  |    lRecCnt = 0                                   ||01777  |    lRecCnt = 0                                   
01805  |    For lRecCnt = LBound(gbuMGetUPDRec.N) To UBoun||01778  |    For lRecCnt = LBound(gbuMGetUPDRec.N) To UBoun
01806  |        'グリッドの行カウンターアップ             ||01779  |        'グリッドの行カウンターアップ             
01807  |        lRowCnt = lRowCnt + 1                     ||01780  |        lRowCnt = lRowCnt + 1                     
01808  |        'グリッドにセット                         ||01781  |        'グリッドにセット                         
01809  |        Call sbMakePrintFlexGridDataSet(lRowCnt, l||01782  |        Call sbMakePrintFlexGridDataSet(lRowCnt, l
01810  |    Next lRecCnt                                  ||01783  |    Next lRecCnt                                  
01811  |                                                  ||01784  |                                                  
01812  |    With fgridMakePrint                           ||01785  |    With fgridMakePrint                           
01813  |        '抽出０件の場合は出力ボタンを無効にする   ||01786  |        '抽出０件の場合は出力ボタンを無効にする   
01814  |        If lRowCnt = 0 Then                       ||01787  |        If lRowCnt = 0 Then                       
01815  |            cmdMake.Enabled = False               ||01788  |            cmdMake.Enabled = False               
01816  |            iRet = MsgBox("出力情報がありません。"||01789  |            iRet = MsgBox("出力情報がありません。"
01817  |            .Editable = flexEDNone        'グリッ ||01790  |            .Editable = flexEDNone        'グリッ 
01818  |        Else                                      ||01791  |        Else                                      
01819  |            cmdMake.Enabled = True                ||01792  |            cmdMake.Enabled = True                
01820  |            .Editable = flexEDKbdMouse    'グリッ ||01793  |            .Editable = flexEDKbdMouse    'グリッ 
01821  |            .Select 1, 0                          ||01794  |            .Select 1, 0                          
01822  |        End If                                    ||01795  |        End If                                    
01823  |                                                  ||01796  |                                                  
01824  |        'スクロールバー表示・非表示設定           ||01797  |        'スクロールバー表示・非表示設定           
01825  |        If lRowCnt < 16 Then                      ||01798  |        If lRowCnt < 16 Then                      
01826  |            .Left = .Left + 120                   ||01799  |            .Left = .Left + 120                   
01827  |            .Width = .Width - 240                 ||01800  |            .Width = .Width - 240                 
01828  |        End If                                    ||01801  |        End If                                    
01829  |                                                  ||01802  |                                                  
01830  |        If lRowCnt > 1 Then                       ||01803  |        If lRowCnt > 1 Then                       
01831  |            '表示行設定                           ||01804  |            '表示行設定                           
01832  |            .TopRow = lActiveIdx                  ||01805  |            .TopRow = lActiveIdx                  
01833  |            lActiveIdx = lActiveIdx + 1           ||01806  |            lActiveIdx = lActiveIdx + 1           
01834  |            .Row = lActiveIdx                     ||01807  |            .Row = lActiveIdx                     
01835  |        End If                                    ||01808  |        End If                                    
01836  |                                                  ||01809  |                                                  
01837  |        'グリッド表示                             ||01810  |        'グリッド表示                             
01838  |        .Visible = True                           ||01811  |        .Visible = True                           
01839  |    End With                                      ||01812  |    End With                                      
01840  |                                                  ||01813  |                                                  
01841  |    '戻り値セット                                 ||01814  |    '戻り値セット                                 
01842  |    fnMakePrintDataSet_New = True                 ||01815  |    fnMakePrintDataSet_New = True                 
01843  |                                                  ||01816  |                                                  
01844  |End Function                                      ||01817  |End Function                                      
01845  |                                                  ||01818  |                                                  
01846  |'=================================================||01819  |'=================================================
01847  |'処理内容  同期実行                               ||01820  |'処理内容  同期実行                               
01848  |'備考                                             ||01821  |'備考                                             
01849  |'                                                 ||01822  |'                                                 
01850  |'日付         担当               内容             ||01823  |'日付         担当               内容             
01851  |'------------ ----------------- ------------------||01824  |'------------ ----------------- ------------------
01852  |'2004/03/17   H.Yonehara <SRA>  新規作成          ||01825  |'2004/03/17   H.Yonehara <SRA>  新規作成          
01853  |'=================================================||01826  |'=================================================
01854  |' 同期実行                                        ||01827  |' 同期実行                                        
01855  |Private Function SyncShell(ByVal cmdLine, ByVal wi||01828  |Private Function SyncShell(ByVal cmdLine, ByVal wi
01856  |    Dim processId As Long                         ||01829  |    Dim processId As Long                         
01857  |    Dim hProcess As Long                          ||01830  |    Dim hProcess As Long                          
01858  |    Dim Ret As Long                               ||01831  |    Dim Ret As Long                               
01859  |    Dim intRtn As Integer                         ||01832  |    Dim intRtn As Integer                         
01860  |'    Dim exitCode As Long                         ||01833  |'    Dim exitCode As Long                         
01861  |                                                  ||01834  |                                                  
01862  |    SyncShell = False                             ||01835  |    SyncShell = False                             
01863  |                                                  ||01836  |                                                  
01864  |    On Error Resume Next                          ||01837  |    On Error Resume Next                          
01865  |    processId = 0                                 ||01838  |    processId = 0                                 
01866  |    processId = Shell(cmdLine, windowStyle)       ||01839  |    processId = Shell(cmdLine, windowStyle)       
01867  |    If processId = 0 Then                         ||01840  |    If processId = 0 Then                         
01868  |        intRtn = MsgBox("システムエラー：起動エラ ||01841  |        intRtn = MsgBox("システムエラー：起動エラ 
01869  |           vbCritical + vbOKOnly, conTitle)       ||01842  |           vbCritical + vbOKOnly, conTitle)       
01870  |        'MsgBox "起動エラー(PC内)"                ||01843  |        'MsgBox "起動エラー(PC内)"                
01871  |        Exit Function                             ||01844  |        Exit Function                             
01872  |    End If                                        ||01845  |    End If                                        
01873  |    On Error GoTo 0                               ||01846  |    On Error GoTo 0                               
01874  |                                                  ||01847  |                                                  
01875  |    hProcess = OpenProcess(SYNCHRONIZE, 0, process||01848  |    hProcess = OpenProcess(SYNCHRONIZE, 0, process
01876  |    If hProcess = 0 Then                          ||01849  |    If hProcess = 0 Then                          
01877  |        intRtn = MsgBox("システムエラー：プロセス ||01850  |        intRtn = MsgBox("システムエラー：プロセス 
01878  |            vbCritical + vbOKOnly, conTitle)      ||01851  |            vbCritical + vbOKOnly, conTitle)      
01879  |        'MsgBox "プロセスハンドル取得エラー"      ||01852  |        'MsgBox "プロセスハンドル取得エラー"      
01880  |        Exit Function                             ||01853  |        Exit Function                             
01881  |    End If                                        ||01854  |    End If                                        
01882  |                                                  ||01855  |                                                  
01883  |'   ★画面を書き換えたい場合は、こっち            ||01856  |'   ★画面を書き換えたい場合は、こっち            
01884  |'   ※但しDoEventで機能ボタンや×ボタンを押せてし ||01857  |'   ※但しDoEventで機能ボタンや×ボタンを押せてし 
01885  |'     イベントが起こってしまうので対処が必要      ||01858  |'     イベントが起こってしまうので対処が必要      
01886  |'    ret = WaitForSingleObject(hProcess, 100)     ||01859  |'    ret = WaitForSingleObject(hProcess, 100)     
01887  |'    Do While ret = WAIT_TIMEOUT                  ||01860  |'    Do While ret = WAIT_TIMEOUT                  
01888  |'        DoEvents                                 ||01861  |'        DoEvents                                 
01889  |'        ret = WaitForSingleObject(hProcess, 100) ||01862  |'        ret = WaitForSingleObject(hProcess, 100) 
01890  |'    Loop                                         ||01863  |'    Loop                                         
01891  |'   ★画面を固めてしまって良い場合は､こっち       ||01864  |'   ★画面を固めてしまって良い場合は､こっち       
01892  |    Ret = WaitForSingleObject(hProcess, INFINITE) ||01865  |    Ret = WaitForSingleObject(hProcess, INFINITE) 
01893  |                                                  ||01866  |                                                  
01894  |'   終了コード取得・・・意味ない                  ||01867  |'   終了コード取得・・・意味ない                  
01895  |'    ret = GetExitCodeProcess(hProcess, exitCode) ||01868  |'    ret = GetExitCodeProcess(hProcess, exitCode) 
01896  |'    Debug.Print "EXIT = " & exitCode             ||01869  |'    Debug.Print "EXIT = " & exitCode             
01897  |                                                  ||01870  |                                                  
01898  |    Ret = CloseHandle(hProcess)                   ||01871  |    Ret = CloseHandle(hProcess)                   
01899  |                                                  ||01872  |                                                  
01900  |    SyncShell = True                              ||01873  |    SyncShell = True                              
01901  |End Function                                      ||01874  |End Function                                      
01902  |                                                  ||01875  |                                                  
01903  |'=================================================||01876  |'=================================================
01904  |'処理内容     FormUnload時モジュール              ||01877  |'処理内容     FormUnload時モジュール              
01905  |'備考                                             ||01878  |'備考                                             
01906  |'                                                 ||01879  |'                                                 
01907  |'日付         担当               内容             ||01880  |'日付         担当               内容             
01908  |'------------ ----------------- ------------------||01881  |'------------ ----------------- ------------------
01909  |'2004/08/03   M.Katoh <SRA>     新規作成          ||01882  |'2004/08/03   M.Katoh <SRA>     新規作成          
01910  |'=================================================||01883  |'=================================================
01911  |Private Sub Form_Unload(Cancel As Integer)        ||01884  |Private Sub Form_Unload(Cancel As Integer)        
01912  |    On Error GoTo OnErrorProc                     ||01885  |    On Error GoTo OnErrorProc                     
01913  |                                                  ||01886  |                                                  
01914  |    Const conMeModule As String = "Form_Unload" ' ||01887  |    Const conMeModule As String = "Form_Unload" ' 
01915  |    Dim strErrCall As String        'エラー呼出元 ||01888  |    Dim strErrCall As String        'エラー呼出元 
01916  |                                                  ||01889  |                                                  
01917  |    'エラー呼出元設定                             ||01890  |    'エラー呼出元設定                             
01918  |    strErrCall = conMeForm & ":" & conMeModule    ||01891  |    strErrCall = conMeForm & ":" & conMeModule    
01919  |                                                  ||01892  |                                                  
01920  |    '初期設定                                     ||01893  |    '初期設定                                     
01921  |     mblnFlgUnload = False                        ||01894  |     mblnFlgUnload = False                        
01922  |                                                  ||01895  |                                                  
01923  |    'Dynasetクローズ処理                          ||01896  |    'Dynasetクローズ処理                          
01924  |    If gblnDynasetClose Then                      ||01897  |    If gblnDynasetClose Then                      
01925  |        If Not gblnDyClose Then                   ||01898  |        If Not gblnDyClose Then                   
01926  |            Call subError("DBエラー", Str(9999), "||01899  |            Call subError("DBエラー", Str(9999), "
01927  |                "DB関数エラー", strErrCall, conTit||01900  |                "DB関数エラー", strErrCall, conTit
01928  |        End If                                    ||01901  |        End If                                    
01929  |    End If                                        ||01902  |    End If                                        
01930  |                                                  ||01903  |                                                  
01931  |    '一応、変数開放する方向で…                   ||01904  |    '一応、変数開放する方向で…                   
01932  |    Set xlApp = Nothing                           ||01905  |    Set xlApp = Nothing                           
01933  |    Set xlBook = Nothing                          ||01906  |    Set xlBook = Nothing                          
01934  |    Set xlSheet = Nothing                         ||01907  |    Set xlSheet = Nothing                         
01935  |                                                  ||01908  |                                                  
01936  |    gblnDynasetClose = False                      ||01909  |    gblnDynasetClose = False                      
01937  |                                                  ||01910  |                                                  
01938  |    GoTo EndProc                                  ||01911  |    GoTo EndProc                                  
01939  |                                                  ||01912  |                                                  
01940  |OnErrorProc:                                      ||01913  |OnErrorProc:                                      
01941  |    Call subError("システムエラー", Str(Err.Number||01914  |    Call subError("システムエラー", Str(Err.Number
01942  |        Error, strErrCall, conTitle)              ||01915  |        Error, strErrCall, conTitle)              
01943  |    'マウスポインター元に戻す                     ||01916  |    'マウスポインター元に戻す                     
01944  |    Screen.MousePointer = vbDefault               ||01917  |    Screen.MousePointer = vbDefault               
01945  |    Exit Sub                                      ||01918  |    Exit Sub                                      
01946  |                                                  ||01919  |                                                  
01947  |EndProc:                                          ||01920  |EndProc:                                          
01948  |    'マウスポインター元に戻す                     ||01921  |    'マウスポインター元に戻す                     
01949  |    Screen.MousePointer = vbDefault               ||01922  |    Screen.MousePointer = vbDefault               
01950  |                                                  ||01923  |                                                  
01951  |End Sub                                           ||01924  |End Sub                                           
01952  |                                                  ||01925  |                                                  
01953  |'=================================================||01926  |'=================================================
01954  |'処理内容     確認書出力ボタン押下時処理          ||01927  |'処理内容     確認書出力ボタン押下時処理          
01955  |'備考                                             ||01928  |'備考                                             
01956  |'                                                 ||01929  |'                                                 
01957  |'日付         担当               内容             ||01930  |'日付         担当               内容             
01958  |'------------ ----------------- ------------------||01931  |'------------ ----------------- ------------------
01959  |'2004/08/03   M.Katoh <SRA>     新規作成          ||01932  |'2004/08/03   M.Katoh <SRA>     新規作成          
01960  |                                                  ||01933  |                                                  
01961  |'=================================================||01934  |'=================================================
01962  |Private Sub cmdMake_Click()                       ||01935  |Private Sub cmdMake_Click()                       
01963  |                                                  ||01936  |                                                  
01964  |    Const conMeModule   As String = "cmdMake_Click||01937  |    Const conMeModule   As String = "cmdMake_Click
01965  |    Dim strErrCall      As String        'エラー呼||01938  |    Dim strErrCall      As String        'エラー呼
01966  |    Dim dDate           As Date                   ||01939  |    Dim dDate           As Date                   
01967  |    Dim strFname        As String                 ||01940  |    Dim strFname        As String                 
01968  |    Dim iRet            As Integer                ||01941  |    Dim iRet            As Integer                
01969  |    Dim iIdx    As Integer                        ||01942  |    Dim iIdx    As Integer                        
01970  |    Dim ChkFLG$                                   ||01943  |    Dim ChkFLG$                                   
01971  |                                                  ||01944  |                                                  
01972  |On Error Resume Next                              ||01945  |On Error Resume Next                              
01973  |                                                  ||01946  |                                                  
01974  |    'エラー呼出元設定                             ||01947  |    'エラー呼出元設定                             
01975  |    strErrCall = conMeForm & ":" & conMeModule    ||01948  |    strErrCall = conMeForm & ":" & conMeModule    
01976  |                                                  ||01949  |                                                  
01977  |    'マウスポインター砂時計                       ||01950  |    'マウスポインター砂時計                       
01978  |    Screen.MousePointer = vbHourglass             ||01951  |    Screen.MousePointer = vbHourglass             
01979  |                                                  ||01952  |                                                  
01980  |    '出力チェックボックスのチェック確認           ||01953  |    '出力チェックボックスのチェック確認           
01981  |    ChkFLG = "OFF"                                ||01954  |    ChkFLG = "OFF"                                
01982  |    With fgridMakePrint                           ||01955  |    With fgridMakePrint                           
01983  |        .Col = conColSysOutbln   '出力フラグを選択||01956  |        .Col = conColSysOutbln   '出力フラグを選択
01984  |                                                  ||01957  |                                                  
01985  |'        For iIdx = .LeftCol - 1 To .Rows - 1     ||01958  |'        For iIdx = .LeftCol - 1 To .Rows - 1     
01986  |        For iIdx = 0 To .Rows - 1                 ||01959  |        For iIdx = 0 To .Rows - 1                 
01987  |            .Row = iIdx                           ||01960  |            .Row = iIdx                           
01988  |            '現在行の取消チェックボックスを確認し ||01961  |            '現在行の取消チェックボックスを確認し 
01989  |            If .CellChecked = flexChecked Or .Cell||01962  |            If .CellChecked = flexChecked Or .Cell
01990  |                ChkFLG = "ON"                     ||01963  |                ChkFLG = "ON"                     
01991  |                Exit For                          ||01964  |                Exit For                          
01992  |            End If                                ||01965  |            End If                                
01993  |        Next iIdx                                 ||01966  |        Next iIdx                                 
01994  |        'フラグが「OFF」なら、処理中止            ||01967  |        'フラグが「OFF」なら、処理中止            
01995  |        If ChkFLG = "OFF" Then                    ||01968  |        If ChkFLG = "OFF" Then                    
01996  |            MsgBox "出力チェックボックスが１つもチ||01969  |            MsgBox "出力チェックボックスが１つもチ
01997  |            GoTo EndProc                          ||01970  |            GoTo EndProc                          
01998  |        End If                                    ||01971  |        End If                                    
01999  |    End With                                      ||01972  |    End With                                      
02000  |                                                  ||01973  |                                                  
02001  |    '入力チェック                                 ||01974  |    '入力チェック                                 
02002  |    If fnNyuryokuCheck = False Then               ||01975  |    If fnNyuryokuCheck = False Then               
02003  |        'マウスポインター元に戻す                 ||01976  |        'マウスポインター元に戻す                 
02004  |        Screen.MousePointer = vbDefault           ||01977  |        Screen.MousePointer = vbDefault           
02005  |        Exit Sub                                  ||01978  |        Exit Sub                                  
02006  |    End If                                        ||01979  |    End If                                        
02007  |                                                  ||01980  |                                                  
02008  |    'ファイル上書き確認                           ||01981  |    'ファイル上書き確認                           
02009  |    dlgFileOut.Flags = cdlOFNOverwritePrompt + cdl||01982  |    dlgFileOut.Flags = cdlOFNOverwritePrompt + cdl
02010  |    'キャンセル時エラーとする                     ||01983  |    'キャンセル時エラーとする                     
02011  |    dlgFileOut.CancelError = True                 ||01984  |    dlgFileOut.CancelError = True                 
02012  |    'ｺﾓﾝﾀﾞｲｱﾛｸﾞ表示                               ||01985  |    'ｺﾓﾝﾀﾞｲｱﾛｸﾞ表示                               
02013  |    dlgFileOut.ShowSave                           ||01986  |    dlgFileOut.ShowSave                           
02014  |    'ファイル名を保存する                         ||01987  |    'ファイル名を保存する                         
02015  |    mstrFileName = dlgFileOut.FileName            ||01988  |    mstrFileName = dlgFileOut.FileName            
02016  |    mstrFileNameBK = mstrFileName                 ||01989  |    mstrFileNameBK = mstrFileName                 
02017  |                                                  ||01990  |                                                  
02018  |    'エラー確認                                   ||01991  |    'エラー確認                                   
02019  |    If Err.Number <> 0 Then                       ||01992  |    If Err.Number <> 0 Then                       
02020  |        'キャンセル時                             ||01993  |        'キャンセル時                             
02021  |        Err.Clear                                 ||01994  |        Err.Clear                                 
02022  |        'マウスポインター元に戻す                 ||01995  |        'マウスポインター元に戻す                 
02023  |        Screen.MousePointer = vbDefault           ||01996  |        Screen.MousePointer = vbDefault           
02024  |        Exit Sub                                  ||01997  |        Exit Sub                                  
02025  |    End If                                        ||01998  |    End If                                        
02026  |                                                  ||01999  |                                                  
02027  |On Error GoTo OnErrorProc                         ||02000  |On Error GoTo OnErrorProc                         
02028  |                                                  ||02001  |                                                  
02029  |    '指定したファイルの使用チェック               ||02002  |    '指定したファイルの使用チェック               
02030  |    If fnblnUseCheck(mstrFileName) = False Then   ||02003  |    If fnblnUseCheck(mstrFileName) = False Then   
02031  |        GoTo EndProc                              ||02004  |        GoTo EndProc                              
02032  |    End If                                        ||02005  |    End If                                        
02033  |                                                  ||02006  |                                                  
02034  |    'グリッドの非表示                             ||02007  |    'グリッドの非表示                             
02035  |    fgridMakePrint.Visible = False                ||02008  |    fgridMakePrint.Visible = False                
02036  |                                                  ||02009  |                                                  
02037  |    'カウンターの初期化                           ||02010  |    'カウンターの初期化                           
02038  |    gSaveFileCnt = 0                              ||02011  |    gSaveFileCnt = 0                              
02039  |    gProcessCnt = 0                               ||02012  |    gProcessCnt = 0                               
02040  |    gTotalProcessCnt = 0                          ||02013  |    gTotalProcessCnt = 0                          
02041  |'2005/03/09 Start                                 ||02014  |'2005/03/09 Start                                 
02042  |    gTotalDnavCnt = 0                             ||02015  |    gTotalDnavCnt = 0                             
02043  |    gTotalCnt = 0                                 ||02016  |    gTotalCnt = 0                                 
02044  |    dstrOldAccCode = ""                           ||02017  |    dstrOldAccCode = ""                           
02045  |'2005/03/09 End                                   ||02018  |'2005/03/09 End                                   
02046  |                                                  ||02019  |                                                  
02047  |    '確認書作成モジュール実行                     ||02020  |    '確認書作成モジュール実行                     
02048  |'2006/07/03 START K.Furuya 期中料率変更契約/RAFI対||02021  |'2006/07/03 START K.Furuya 期中料率変更契約/RAFI対
02049  |'    If fnblMakePrint() = False Then              ||02022  |'    If fnblMakePrint() = False Then              
02050  |'        GoTo OnErrorProc                         ||02023  |'        GoTo OnErrorProc                         
02051  |'    End If                                       ||02024  |'    End If                                       
02052  |    If fnblMakePrint_New() = False Then           ||02025  |    If fnblMakePrint_New() = False Then           
02053  |        GoTo OnErrorProc                          ||02026  |        GoTo OnErrorProc                          
02054  |    End If                                        ||02027  |    End If                                        
02055  |'2006/07/03 END   K.Furuya 期中料率変更契約/RAFI対||02028  |'2006/07/03 END   K.Furuya 期中料率変更契約/RAFI対
02056  |                                                  ||02029  |                                                  
02057  |    'グリッドの表示                               ||02030  |    'グリッドの表示                               
02058  |    fgridMakePrint.Visible = True                 ||02031  |    fgridMakePrint.Visible = True                 
02059  |                                                  ||02032  |                                                  
02060  |    iRet = MsgBox("確認書をEXCELファイルに出力しま||02033  |    iRet = MsgBox("確認書をEXCELファイルに出力しま
02061  |                                                  ||02034  |                                                  
02062  |    GoTo EndProc                                  ||02035  |    GoTo EndProc                                  
02063  |                                                  ||02036  |                                                  
02064  |OnErrorProc:                                      ||02037  |OnErrorProc:                                      
02065  |    Call subError("システムエラー", Str(Err.Number||02038  |    Call subError("システムエラー", Str(Err.Number
02066  |        Error, strErrCall, conTitle)              ||02039  |        Error, strErrCall, conTitle)              
02067  |    'マウスポインター元に戻す                     ||02040  |    'マウスポインター元に戻す                     
02068  |    Screen.MousePointer = vbDefault               ||02041  |    Screen.MousePointer = vbDefault               
02069  |                                                  ||02042  |                                                  
02070  |EndProc:                                          ||02043  |EndProc:                                          
02071  |    'マウスポインター元に戻す                     ||02044  |    'マウスポインター元に戻す                     
02072  |    Screen.MousePointer = vbDefault               ||02045  |    Screen.MousePointer = vbDefault               
02073  |End Sub                                           ||02046  |End Sub                                           
02074  |                                                  ||02047  |                                                  
02075  |'=================================================||02048  |'=================================================
02076  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblnUseCheck                ||02049  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblnUseCheck                
02077  |'機能            :   同名ファイルを保存する(上書き||02050  |'機能            :   同名ファイルを保存する(上書き
02078  |'                   そのファイルが使用されていない||02051  |'                   そのファイルが使用されていない
02079  |'                                                 ||02052  |'                                                 
02080  |'日付         担当               内容             ||02053  |'日付         担当               内容             
02081  |'------------ ----------------- ------------------||02054  |'------------ ----------------- ------------------
02082  |'2004/08/03   M.Katoh <SRA>     新規作成          ||02055  |'2004/08/03   M.Katoh <SRA>     新規作成          
02083  |'=================================================||02056  |'=================================================
02084  |Private Function fnblnUseCheck( _                 ||02057  |Private Function fnblnUseCheck( _                 
02085  |    ByVal FName As String _                       ||02058  |    ByVal FName As String _                       
02086  |) As Boolean                                      ||02059  |) As Boolean                                      
02087  |    On Error Resume Next                          ||02060  |    On Error Resume Next                          
02088  |    Dim strFile     As String                     ||02061  |    Dim strFile     As String                     
02089  |                                                  ||02062  |                                                  
02090  |    '戻り値初期化                                 ||02063  |    '戻り値初期化                                 
02091  |    fnblnUseCheck = False                         ||02064  |    fnblnUseCheck = False                         
02092  |                                                  ||02065  |                                                  
02093  |    'ファイルが存在するか調べる                   ||02066  |    'ファイルが存在するか調べる                   
02094  |    strFile = Dir$(FName)                         ||02067  |    strFile = Dir$(FName)                         
02095  |    If Len(strFile) = 0 Then                      ||02068  |    If Len(strFile) = 0 Then                      
02096  |        'ファイルが存在しなければ問題なし         ||02069  |        'ファイルが存在しなければ問題なし         
02097  |    Else                                          ||02070  |    Else                                          
02098  |        'ファイルがあればファイルの名前を同じ名前 ||02071  |        'ファイルがあればファイルの名前を同じ名前 
02099  |        Name FName As FName                       ||02072  |        Name FName As FName                       
02100  |        'ファイルが使用中であればエラーが発生しま ||02073  |        'ファイルが使用中であればエラーが発生しま 
02101  |        If Err.Number Then                        ||02074  |        If Err.Number Then                        
02102  |            MsgBox "上書きしようとしたファイルは使||02075  |            MsgBox "上書きしようとしたファイルは使
02103  |            'エラーが発生した場合は Err オブジェク||02076  |            'エラーが発生した場合は Err オブジェク
02104  |            Err.Clear                             ||02077  |            Err.Clear                             
02105  |            Exit Function                         ||02078  |            Exit Function                         
02106  |        End If                                    ||02079  |        End If                                    
02107  |    End If                                        ||02080  |    End If                                        
02108  |                                                  ||02081  |                                                  
02109  |    '正常戻り値をセットする                       ||02082  |    '正常戻り値をセットする                       
02110  |    fnblnUseCheck = True                          ||02083  |    fnblnUseCheck = True                          
02111  |                                                  ||02084  |                                                  
02112  |End Function                                      ||02085  |End Function                                      
02113  |                                                  ||02086  |                                                  
02114  |'=================================================||02087  |'=================================================
02115  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblMakePrint                ||02088  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblMakePrint                
02116  |'機能            :   確認書のExcel出力            ||02089  |'機能            :   確認書のExcel出力            
02117  |'                                                 ||02090  |'                                                 
02118  |'日付               担当　              修正内容  ||02091  |'日付               担当　              修正内容  
02119  |'-------------------------------------------------||02092  |'-------------------------------------------------
02120  |'2004/08/03         M.Katoh<SRA>       新規作成   ||02093  |'2004/08/03         M.Katoh<SRA>       新規作成   
02121  |'2004/09/02         M.Yamazaki<SRA>     複数ページ||02094  |'2004/09/02         M.Yamazaki<SRA>     複数ページ
02122  |'2004/09/21         M.Yamazaki<SRA>    １契約に対 ||02095  |'2004/09/21         M.Yamazaki<SRA>    １契約に対 
02123  |'2004/11/08         M.Yamazaki<SRA>    NAVが倍にな||02096  |'2004/11/08         M.Yamazaki<SRA>    NAVが倍にな
02124  |'2004/11/16         M.Yamazaki<SRA>    前回締日が ||02097  |'2004/11/16         M.Yamazaki<SRA>    前回締日が 
02125  |'2004/12/13         M.Yamazaki<SRA>    前回締日取 ||02098  |'2004/12/13         M.Yamazaki<SRA>    前回締日取 
02126  |'2005/02/02         M.Yamazaki<SRA>    前回締日取 ||02099  |'2005/02/02         M.Yamazaki<SRA>    前回締日取 
02127  |'2005/02/22         S.Kaketani<SRA>    前回締日取 ||02100  |'2005/02/22         S.Kaketani<SRA>    前回締日取 
02128  |'2006/07/03         K.Furuya <SRA>     期中料率変 ||02101  |'2006/07/03         K.Furuya <SRA>     期中料率変 
02129  |'                                      ソースが煩 ||02102  |'                                      ソースが煩 
02130  |'                                      作り変えの ||02103  |'                                      作り変えの 
02131  |'=================================================||02104  |'=================================================
02132  |Private Function fnblMakePrint( _                 ||02105  |Private Function fnblMakePrint( _                 
02133  |) As Boolean                                      ||02106  |) As Boolean                                      
02134  |                                                  ||02107  |                                                  
02135  |                                                  ||02108  |                                                  
02136  |'#################################################||02109  |'#################################################
02137  |'2006/07/03 START K.Furuya 期中料率変更契約/RAFI対||02110  |'2006/07/03 START K.Furuya 期中料率変更契約/RAFI対
02138  |'#################################################||02111  |'#################################################
02139  |'    Dim sSql            As String                ||02112  |'    Dim sSql            As String                
02140  |'    Dim lRecCnt         As Long                  ||02113  |'    Dim lRecCnt         As Long                  
02141  |'    Dim lRecDayCnt      As Long                  ||02114  |'    Dim lRecDayCnt      As Long                  
02142  |'    Dim lGridCnt        As Long                  ||02115  |'    Dim lGridCnt        As Long                  
02143  |'    Dim Cnt             As Long                  ||02116  |'    Dim Cnt             As Long                  
02144  |'    Dim MonthlyCnt      As Long                  ||02117  |'    Dim MonthlyCnt      As Long                  
02145  |'    Dim sStart          As String                ||02118  |'    Dim sStart          As String                
02146  |'    Dim sEnd            As String                ||02119  |'    Dim sEnd            As String                
02147  |'    Dim sContractNo     As String                ||02120  |'    Dim sContractNo     As String                
02148  |'    Dim sAccCode        As String                ||02121  |'    Dim sAccCode        As String                
02149  |'    Dim sCurrencyCode   As String                ||02122  |'    Dim sCurrencyCode   As String                
02150  |'    Dim sBaseDate       As String                ||02123  |'    Dim sBaseDate       As String                
02151  |'    Dim sSettleDate     As String                ||02124  |'    Dim sSettleDate     As String                
02152  |'    Dim sRuleNo         As String                ||02125  |'    Dim sRuleNo         As String                
02153  |'    Dim sPayDate        As String                ||02126  |'    Dim sPayDate        As String                
02154  |'    Dim ParaYear        As String                ||02127  |'    Dim ParaYear        As String                
02155  |'    Dim ParaMonth       As String                ||02128  |'    Dim ParaMonth       As String                
02156  |'    Dim ParaDay         As String                ||02129  |'    Dim ParaDay         As String                
02157  |'    Dim sZenkai         As String                ||02130  |'    Dim sZenkai         As String                
02158  |'    Dim sNearMonth      As String                ||02131  |'    Dim sNearMonth      As String                
02159  |'    Dim LastYearFlag    As Boolean               ||02132  |'    Dim LastYearFlag    As Boolean               
02160  |'    Dim strErrCall      As String                ||02133  |'    Dim strErrCall      As String                
02161  |'    Const conMeModule   As String = "fnblMakePrin||02134  |'    Const conMeModule   As String = "fnblMakePrin
02162  |''2004/09/21 Start                                ||02135  |''2004/09/21 Start                                
02163  |'    Dim sContNo         As String                ||02136  |'    Dim sContNo         As String                
02164  |''2004/09/21 End                                  ||02137  |''2004/09/21 End                                  
02165  |''2004/11/08 Start                                ||02138  |''2004/11/08 Start                                
02166  |'    Dim ddblNav As Double                        ||02139  |'    Dim ddblNav As Double                        
02167  |'    Dim ddblCnt As Double                        ||02140  |'    Dim ddblCnt As Double                        
02168  |'    Dim ddblNavTotal                             ||02141  |'    Dim ddblNavTotal                             
02169  |'    Dim dstrMonthOld As String                   ||02142  |'    Dim dstrMonthOld As String                   
02170  |'    Dim dstrMonthNew As String                   ||02143  |'    Dim dstrMonthNew As String                   
02171  |'    Dim i As Integer                             ||02144  |'    Dim i As Integer                             
02172  |''2004/11/08 End                                  ||02145  |''2004/11/08 End                                  
02173  |'                                                 ||02146  |'                                                 
02174  |'On Error GoTo OnErrorProc                        ||02147  |'On Error GoTo OnErrorProc                        
02175  |'                                                 ||02148  |'                                                 
02176  |'    '戻り値初期化                                ||02149  |'    '戻り値初期化                                
02177  |'    fnblMakePrint = False                        ||02150  |'    fnblMakePrint = False                        
02178  |'                                                 ||02151  |'                                                 
02179  |'    'エラー呼出元設定                            ||02152  |'    'エラー呼出元設定                            
02180  |'    strErrCall = conMeForm & ":" & conMeModule   ||02153  |'    strErrCall = conMeForm & ":" & conMeModule   
02181  |'                                                 ||02154  |'                                                 
02182  |'    '初期化                                      ||02155  |'    '初期化                                      
02183  |'    lRecCnt = 0                                  ||02156  |'    lRecCnt = 0                                  
02184  |'    lRecDayCnt = 0                               ||02157  |'    lRecDayCnt = 0                               
02185  |'    gProcessCnt = 0                              ||02158  |'    gProcessCnt = 0                              
02186  |'    lGridCnt = 0                                 ||02159  |'    lGridCnt = 0                                 
02187  |'    ddblNav = 0                                  ||02160  |'    ddblNav = 0                                  
02188  |'    ddblCnt = 0                                  ||02161  |'    ddblCnt = 0                                  
02189  |'                                                 ||02162  |'                                                 
02190  |'    'DBオープン                                  ||02163  |'    'DBオープン                                  
02191  |'    If Not gintDbOpen() Then                     ||02164  |'    If Not gintDbOpen() Then                     
02192  |'        Exit Function                            ||02165  |'        Exit Function                            
02193  |'    End If                                       ||02166  |'    End If                                       
02194  |'                                                 ||02167  |'                                                 
02195  |'    'グリッドデータを配列に格納する              ||02168  |'    'グリッドデータを配列に格納する              
02196  |'    '配列初期化                                  ||02169  |'    '配列初期化                                  
02197  |'    ReDim gbuMGetUPDRec.N(0)                     ||02170  |'    ReDim gbuMGetUPDRec.N(0)                     
02198  |'    'スプレット表示件数が１件以上の場合のみ      ||02171  |'    'スプレット表示件数が１件以上の場合のみ      
02199  |'    With fgridMakePrint                          ||02172  |'    With fgridMakePrint                          
02200  |'        If .Rows > 1 Then                        ||02173  |'        If .Rows > 1 Then                        
02201  |'            'グリッドデータセット処理            ||02174  |'            'グリッドデータセット処理            
02202  |'            For lGridCnt = 0 To .Rows - 2        ||02175  |'            For lGridCnt = 0 To .Rows - 2        
02203  |'                '出力列を選択する                ||02176  |'                '出力列を選択する                
02204  |'                .Col = conColSysOutbln           ||02177  |'                .Col = conColSysOutbln           
02205  |'                .Row = lGridCnt + 1              ||02178  |'                .Row = lGridCnt + 1              
02206  |'                If .Text = True Then             ||02179  |'                If .Text = True Then             
02207  |'                    '対象データ抽出              ||02180  |'                    '対象データ抽出              
02208  |'                    Call sbGridDataGet(lGridCnt, ||02181  |'                    Call sbGridDataGet(lGridCnt, 
02209  |'                    '配列の要素数設定カウンターア||02182  |'                    '配列の要素数設定カウンターア
02210  |'                    lRecCnt = lRecCnt + 1        ||02183  |'                    lRecCnt = lRecCnt + 1        
02211  |'                End If                           ||02184  |'                End If                           
02212  |'            Next lGridCnt                        ||02185  |'            Next lGridCnt                        
02213  |'        Else                                     ||02186  |'        Else                                     
02214  |'            MsgBox "グリッドデータがないですよ！"||02187  |'            MsgBox "グリッドデータがないですよ！"
02215  |'            Exit Function                        ||02188  |'            Exit Function                        
02216  |'        End If                                   ||02189  |'        End If                                   
02217  |'        '後で使うので、カウンター変数を初期化    ||02190  |'        '後で使うので、カウンター変数を初期化    
02218  |'        lRecCnt = 0                              ||02191  |'        lRecCnt = 0                              
02219  |'    End With                                     ||02192  |'    End With                                     
02220  |'                                                 ||02193  |'                                                 
02221  |'    '取得した契約番号分ループする                ||02194  |'    '取得した契約番号分ループする                
02222  |'    For Cnt = LBound(gbuMGetUPDRec.N) To UBound(g||02195  |'    For Cnt = LBound(gbuMGetUPDRec.N) To UBound(g
02223  |'            '変数の初期化                        ||02196  |'            '変数の初期化                        
02224  |'            mstrPaymentDate = ""                 ||02197  |'            mstrPaymentDate = ""                 
02225  |'            mstrNearSettleDate = ""              ||02198  |'            mstrNearSettleDate = ""              
02226  |'            mstrSettlementDate = ""              ||02199  |'            mstrSettlementDate = ""              
02227  |'            MonthlyCnt = 0                       ||02200  |'            MonthlyCnt = 0                       
02228  |'            LastYearFlag = False                 ||02201  |'            LastYearFlag = False                 
02229  |'            '支払予定日をセット                  ||02202  |'            '支払予定日をセット                  
02230  |''2004/09/02 Start                                ||02203  |''2004/09/02 Start                                
02231  |''            fgridMakePrint.Col = conColPayMentDa||02204  |''            fgridMakePrint.Col = conColPayMentDa
02232  |''            fgridMakePrint.Row = Cnt + 1        ||02205  |''            fgridMakePrint.Row = Cnt + 1        
02233  |''            sPayDate = fgridMakePrint.Text      ||02206  |''            sPayDate = fgridMakePrint.Text      
02234  |''            mstrPaymentDate = fgridMakePrint.Tex||02207  |''            mstrPaymentDate = fgridMakePrint.Tex
02235  |'            sPayDate = gbuMGetUPDRec.N(Cnt).MGET_||02208  |'            sPayDate = gbuMGetUPDRec.N(Cnt).MGET_
02236  |'            mstrPaymentDate = gbuMGetUPDRec.N(Cnt||02209  |'            mstrPaymentDate = gbuMGetUPDRec.N(Cnt
02237  |''2004/09/02 End                                  ||02210  |''2004/09/02 End                                  
02238  |'            '処理回数をカウントアップ            ||02211  |'            '処理回数をカウントアップ            
02239  |'            gProcessCnt = gProcessCnt + 1        ||02212  |'            gProcessCnt = gProcessCnt + 1        
02240  |''SQL文の作成(外部委託顧問料締日取得)             ||02213  |''SQL文の作成(外部委託顧問料締日取得)             
02241  |'            sContractNo = gbuMGetUPDRec.N(Cnt).MG||02214  |'            sContractNo = gbuMGetUPDRec.N(Cnt).MG
02242  |'            sSettleDate = gbuMGetUPDRec.N(Cnt).MG||02215  |'            sSettleDate = gbuMGetUPDRec.N(Cnt).MG
02243  |'            '基準年をセット                      ||02216  |'            '基準年をセット                      
02244  |'            mstrbaseYear = Mid(sSettleDate, 1, 4)||02217  |'            mstrbaseYear = Mid(sSettleDate, 1, 4)
02245  |'            '直近締日を設定                      ||02218  |'            '直近締日を設定                      
02246  |'            mstrNearSettleDate = sSettleDate     ||02219  |'            mstrNearSettleDate = sSettleDate     
02247  |'                                                 ||02220  |'                                                 
02248  |''2005/02/02 Start                                ||02221  |''2005/02/02 Start                                
02249  |''            '前回締日を設定する                 ||02222  |''            '前回締日を設定する                 
02250  |''            sSettleDate = gbuMGetUPDRec.N(Cnt).M||02223  |''            sSettleDate = gbuMGetUPDRec.N(Cnt).M
02251  |'''2004/12/13 Start                               ||02224  |'''2004/12/13 Start                               
02252  |'''            sSql = gstrEditSQLcfr_MaxSettlement||02225  |'''            sSql = gstrEditSQLcfr_MaxSettlement
02253  |'''                    sContractNo, Mid(sSettleDat||02226  |'''                    sContractNo, Mid(sSettleDat
02254  |''            sSql = gstrEditSQLcfr_MaxSettlementD||02227  |''            sSql = gstrEditSQLcfr_MaxSettlementD
02255  |''                    sContractNo, mstrbaseToday, ||02228  |''                    sContractNo, mstrbaseToday, 
02256  |'''2004/12/13 End                                 ||02229  |'''2004/12/13 End                                 
02257  |''            'ﾀﾞｲﾅｾｯﾄの作成                      ||02230  |''            'ﾀﾞｲﾅｾｯﾄの作成                      
02258  |''            If gintDyCreate(sSql) = False Then  ||02231  |''            If gintDyCreate(sSql) = False Then  
02259  |''                Exit Function                   ||02232  |''                Exit Function                   
02260  |''            End If                              ||02233  |''            End If                              
02261  |''            'EOF判定処理                        ||02234  |''            'EOF判定処理                        
02262  |''            If gblnDyEOF() = False Then         ||02235  |''            If gblnDyEOF() = False Then         
02263  |''                '対象締日データ抽出             ||02236  |''                '対象締日データ抽出             
02264  |''                mstrSettlementDate = gvlnDyDataS||02237  |''                mstrSettlementDate = gvlnDyDataS
02265  |''            End If                              ||02238  |''            End If                              
02266  |''            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                   ||02239  |''            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                   
02267  |''            Call gblnDyClose                    ||02240  |''            Call gblnDyClose                    
02268  |''                '前回締日を設定                 ||02241  |''                '前回締日を設定                 
02269  |''            If Mid(mstrNearSettleDate, 5, 4) < m||02242  |''            If Mid(mstrNearSettleDate, 5, 4) < m
02270  |''                '前年フラグを更新               ||02243  |''                '前年フラグを更新               
02271  |''                LastYearFlag = True             ||02244  |''                LastYearFlag = True             
02272  |''            End If                              ||02245  |''            End If                              
02273  |''                                                ||02246  |''                                                
02274  |'''前回締日が去年の場合の処理                     ||02247  |'''前回締日が去年の場合の処理                     
02275  |''            If mstrSettlementDate = "" Then     ||02248  |''            If mstrSettlementDate = "" Then     
02276  |''                '前年フラグを更新               ||02249  |''                '前年フラグを更新               
02277  |''                LastYearFlag = True             ||02250  |''                LastYearFlag = True             
02278  |''                'SQL文の作成(外部委託顧問料締日 ||02251  |''                'SQL文の作成(外部委託顧問料締日 
02279  |'''2004/12/13 Start                               ||02252  |'''2004/12/13 Start                               
02280  |'''                sSql = gstrEditSQLcfr_MaxSettle||02253  |'''                sSql = gstrEditSQLcfr_MaxSettle
02281  |'''                    sContractNo)               ||02254  |'''                    sContractNo)               
02282  |''                sSql = gstrEditSQLcfr_MaxSettlem||02255  |''                sSql = gstrEditSQLcfr_MaxSettlem
02283  |''                    sContractNo, mstrbaseToday) ||02256  |''                    sContractNo, mstrbaseToday) 
02284  |'''2004/12/13 End                                 ||02257  |'''2004/12/13 End                                 
02285  |''                'ﾀﾞｲﾅｾｯﾄの作成                  ||02258  |''                'ﾀﾞｲﾅｾｯﾄの作成                  
02286  |''                If gintDyCreate(sSql) = False Th||02259  |''                If gintDyCreate(sSql) = False Th
02287  |''                    Exit Function               ||02260  |''                    Exit Function               
02288  |''                End If                          ||02261  |''                End If                          
02289  |''                '対象締日データ抽出             ||02262  |''                '対象締日データ抽出             
02290  |''                mstrSettlementDate = gvlnDyDataS||02263  |''                mstrSettlementDate = gvlnDyDataS
02291  |''                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理               ||02264  |''                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理               
02292  |''                Call gblnDyClose                ||02265  |''                Call gblnDyClose                
02293  |''            End If                              ||02266  |''            End If                              
02294  |''                                                ||02267  |''                                                
02295  |''            '締日取得のチェック                 ||02268  |''            '締日取得のチェック                 
02296  |''            If mstrSettlementDate = "" Then     ||02269  |''            If mstrSettlementDate = "" Then     
02297  |''                MsgBox "締日が取得できてません。||02270  |''                MsgBox "締日が取得できてません。
02298  |''                Exit Function                   ||02271  |''                Exit Function                   
02299  |''            End If                              ||02272  |''            End If                              
02300  |''                                                ||02273  |''                                                
02301  |''            '営業フラグチェック(締日をYYYYMMDD形||02274  |''            '営業フラグチェック(締日をYYYYMMDD形
02302  |''            '前回締日                           ||02275  |''            '前回締日                           
02303  |''            If LastYearFlag = True Then         ||02276  |''            If LastYearFlag = True Then         
02304  |''                ParaYear = Mid((CInt(mstrbaseYea||02277  |''                ParaYear = Mid((CInt(mstrbaseYea
02305  |''            Else                                ||02278  |''            Else                                
02306  |''                ParaYear = Mid(mstrbaseYear, 1, ||02279  |''                ParaYear = Mid(mstrbaseYear, 1, 
02307  |''            End If                              ||02280  |''            End If                              
02308  |''            mstrSettlementDate = ParaYear & mstr||02281  |''            mstrSettlementDate = ParaYear & mstr
02309  |'''2004/11/16 Start                               ||02282  |'''2004/11/16 Start                               
02310  |''            'カレンダーテーブル該当データ取得用 ||02283  |''            'カレンダーテーブル該当データ取得用 
02311  |''            sSql = gstrEditSQLCalGetSelect(mstrS||02284  |''            sSql = gstrEditSQLCalGetSelect(mstrS
02312  |''            'ﾀﾞｲﾅｾｯﾄの作成                      ||02285  |''            'ﾀﾞｲﾅｾｯﾄの作成                      
02313  |''            If gintDyCreate(sSql) = False Then  ||02286  |''            If gintDyCreate(sSql) = False Then  
02314  |''                Exit Function                   ||02287  |''                Exit Function                   
02315  |''            End If                              ||02288  |''            End If                              
02316  |''            'EOF判定処理                        ||02289  |''            'EOF判定処理                        
02317  |''            If gblnDyEOF() = False Then         ||02290  |''            If gblnDyEOF() = False Then         
02318  |''                '対象締日抽出                   ||02291  |''                '対象締日抽出                   
02319  |''                mstrSettlementDate = gvlnDyDataN||02292  |''                mstrSettlementDate = gvlnDyDataN
02320  |''            End If                              ||02293  |''            End If                              
02321  |''            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                   ||02294  |''            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                   
02322  |''            Call gblnDyClose                    ||02295  |''            Call gblnDyClose                    
02323  |'''2004/11/16 End                                 ||02296  |'''2004/11/16 End                                 
02324  |'            '前回締日営業日翌日の設定            ||02297  |'            '前回締日営業日翌日の設定            
02325  |'            mstrSettlementDate = gbuMGetUPDRec.N(||02298  |'            mstrSettlementDate = gbuMGetUPDRec.N(
02326  |''2005/02/02 End                                  ||02299  |''2005/02/02 End                                  
02327  |'        '顧問料計算開始日・終了日との整合性をチェ||02300  |'        '顧問料計算開始日・終了日との整合性をチェ
02328  |'            sStart = gbuMGetUPDRec.N(Cnt).MGET_co||02301  |'            sStart = gbuMGetUPDRec.N(Cnt).MGET_co
02329  |'            sEnd = gbuMGetUPDRec.N(Cnt).MGET_com_||02302  |'            sEnd = gbuMGetUPDRec.N(Cnt).MGET_com_
02330  |'            '前回締日 < 顧問料計算開始日 の場合、||02303  |'            '前回締日 < 顧問料計算開始日 の場合、
02331  |'            If sStart <> "" Then                 ||02304  |'            If sStart <> "" Then                 
02332  |'                If mstrSettlementDate < sStart Th||02305  |'                If mstrSettlementDate < sStart Th
02333  |'                    mstrSettlementDate = sStart  ||02306  |'                    mstrSettlementDate = sStart  
02334  |''2005/02/02 Start                                ||02307  |''2005/02/02 Start                                
02335  |''                Else                            ||02308  |''                Else                            
02336  |''                    '前回締日に変更がない場合は ||02309  |''                    '前回締日に変更がない場合は 
02337  |''                    mstrSettlementDate = gstrDat||02310  |''                    mstrSettlementDate = gstrDat
02338  |''2005/02/02 End                                  ||02311  |''2005/02/02 End                                  
02339  |'                End If                           ||02312  |'                End If                           
02340  |''2005/02/02 Start                                ||02313  |''2005/02/02 Start                                
02341  |''            Else                                ||02314  |''            Else                                
02342  |''                '前回締日に変更がない場合は、前 ||02315  |''                '前回締日に変更がない場合は、前 
02343  |''                mstrSettlementDate = gstrDateFor||02316  |''                mstrSettlementDate = gstrDateFor
02344  |''2005/02/02 End                                  ||02317  |''2005/02/02 End                                  
02345  |'            End If                               ||02318  |'            End If                               
02346  |''2005/02/02 Start                                ||02319  |''2005/02/02 Start                                
02347  |''            '前回締日に+1した時に、年を跨いだ場 ||02320  |''            '前回締日に+1した時に、年を跨いだ場 
02348  |''            If Mid(mstrSettlementDate, 1, 4) = m||02321  |''            If Mid(mstrSettlementDate, 1, 4) = m
02349  |''                LastYearFlag = False            ||02322  |''                LastYearFlag = False            
02350  |''            End If                              ||02323  |''            End If                              
02351  |''2005/02/02 End                                  ||02324  |''2005/02/02 End                                  
02352  |'                                                 ||02325  |'                                                 
02353  |'            '直近締日 < 顧問料計算終了日 の場合、||02326  |'            '直近締日 < 顧問料計算終了日 の場合、
02354  |'            If sEnd <> "" Then                   ||02327  |'            If sEnd <> "" Then                   
02355  |'                If mstrNearSettleDate > sEnd Then||02328  |'                If mstrNearSettleDate > sEnd Then
02356  |'                    mstrNearSettleDate = sEnd    ||02329  |'                    mstrNearSettleDate = sEnd    
02357  |'                End If                           ||02330  |'                End If                           
02358  |'            End If                               ||02331  |'            End If                               
02359  |'                                                 ||02332  |'                                                 
02360  |''SQL文の作成(日次NAV取得)                        ||02333  |''SQL文の作成(日次NAV取得)                        
02361  |''2004/09/21 Start                                ||02334  |''2004/09/21 Start                                
02362  |''            sAccCode = gbuMGetUPDRec.N(Cnt).MGET||02335  |''            sAccCode = gbuMGetUPDRec.N(Cnt).MGET
02363  |''            sCurrencyCode = gbuMGetUPDRec.N(Cnt)||02336  |''            sCurrencyCode = gbuMGetUPDRec.N(Cnt)
02364  |''            '日次NAVは当年度のNAVを取得する     ||02337  |''            '日次NAVは当年度のNAVを取得する     
02365  |''            sSql = gstrEditSQLcfr_DailyNavForSel||02338  |''            sSql = gstrEditSQLcfr_DailyNavForSel
02366  |''                sAccCode, mstrNearSettleDate, sC||02339  |''                sAccCode, mstrNearSettleDate, sC
02367  |'            sContNo = gbuMGetUPDRec.N(Cnt).MGET_c||02340  |'            sContNo = gbuMGetUPDRec.N(Cnt).MGET_c
02368  |'            '日次NAVは当年度のNAVを取得する      ||02341  |'            '日次NAVは当年度のNAVを取得する      
02369  |'            sSql = gstrEditSQLcfr_DailyNavForSele||02342  |'            sSql = gstrEditSQLcfr_DailyNavForSele
02370  |'                sContNo, mstrNearSettleDate)     ||02343  |'                sContNo, mstrNearSettleDate)     
02371  |''2004/09/21 End                                  ||02344  |''2004/09/21 End                                  
02372  |'            'ﾀﾞｲﾅｾｯﾄの作成                       ||02345  |'            'ﾀﾞｲﾅｾｯﾄの作成                       
02373  |'            If gintDyCreate(sSql) = False Then   ||02346  |'            If gintDyCreate(sSql) = False Then   
02374  |'                Exit Function                    ||02347  |'                Exit Function                    
02375  |'            End If                               ||02348  |'            End If                               
02376  |''2004/11/08 Start                                ||02349  |''2004/11/08 Start                                
02377  |''            '対象締日データ抽出                 ||02350  |''            '対象締日データ抽出                 
02378  |''            mstrDailyNav = gvlnDyDataS("NET_ASSE||02351  |''            mstrDailyNav = gvlnDyDataS("NET_ASSE
02379  |'            mstrDailyNav = 0                     ||02352  |'            mstrDailyNav = 0                     
02380  |'            ddblNav = 0                          ||02353  |'            ddblNav = 0                          
02381  |'            ddblCnt = 0                          ||02354  |'            ddblCnt = 0                          
02382  |'            'EOF判定処理                         ||02355  |'            'EOF判定処理                         
02383  |'            Do Until gblnDyEOF()                 ||02356  |'            Do Until gblnDyEOF()                 
02384  |'                ddblNav = gvlnDyDataN("NET_ASSET_||02357  |'                ddblNav = gvlnDyDataN("NET_ASSET_
02385  |'                ddblCnt = gvlnDyDataN("NAV_CNT") ||02358  |'                ddblCnt = gvlnDyDataN("NAV_CNT") 
02386  |'                If ddblCnt > 0 Then              ||02359  |'                If ddblCnt > 0 Then              
02387  |'                    mstrDailyNav = mstrDailyNav +||02360  |'                    mstrDailyNav = mstrDailyNav +
02388  |'                Else                             ||02361  |'                Else                             
02389  |'                    mstrDailyNav = mstrDailyNav +||02362  |'                    mstrDailyNav = mstrDailyNav +
02390  |'                End If                           ||02363  |'                End If                           
02391  |'                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                ||02364  |'                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                
02392  |'                Call gDyNext                     ||02365  |'                Call gDyNext                     
02393  |'            Loop                                 ||02366  |'            Loop                                 
02394  |''2004/11/08 End                                  ||02367  |''2004/11/08 End                                  
02395  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    ||02368  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    
02396  |'            Call gblnDyClose                     ||02369  |'            Call gblnDyClose                     
02397  |'                                                 ||02370  |'                                                 
02398  |''SQL文の作成(月次NAV取得)                        ||02371  |''SQL文の作成(月次NAV取得)                        
02399  |'            '配列初期化                          ||02372  |'            '配列初期化                          
02400  |'            ReDim gtypcfr_mnav_tbl(0)            ||02373  |'            ReDim gtypcfr_mnav_tbl(0)            
02401  |'                                                 ||02374  |'                                                 
02402  |''2005/02/22 Start                                ||02375  |''2005/02/22 Start                                
02403  |'            '前回締日の月をセット(YYYYMM形式でセ ||02376  |'            '前回締日の月をセット(YYYYMM形式でセ 
02404  |''            If LastYearFlag = True Then         ||02377  |''            If LastYearFlag = True Then         
02405  |''                sZenkai = CStr(CInt(mstrbaseYear||02378  |''                sZenkai = CStr(CInt(mstrbaseYear
02406  |''            Else                                ||02379  |''            Else                                
02407  |''                sZenkai = mstrbaseYear & Mid(mst||02380  |''                sZenkai = mstrbaseYear & Mid(mst
02408  |''            End If                              ||02381  |''            End If                              
02409  |'             sZenkai = Mid(mstrSettlementDate, 1,||02382  |'             sZenkai = Mid(mstrSettlementDate, 1,
02410  |''2005/02/22 Start                                ||02383  |''2005/02/22 Start                                
02411  |'                                                 ||02384  |'                                                 
02412  |'            '直近締日の月の前月をセット          ||02385  |'            '直近締日の月の前月をセット          
02413  |'            sNearMonth = DateAdd("m", -1, gstrDat||02386  |'            sNearMonth = DateAdd("m", -1, gstrDat
02414  |'            sNearMonth = Mid(gstrDateFormat2(sNea||02387  |'            sNearMonth = Mid(gstrDateFormat2(sNea
02415  |'                                                 ||02388  |'                                                 
02416  |''2004/09/21 Start                                ||02389  |''2004/09/21 Start                                
02417  |''            sSql = gstrEditSQLcfr_MonthlyNavForS||02390  |''            sSql = gstrEditSQLcfr_MonthlyNavForS
02418  |''                sAccCode, sNearMonth, sZenkai, s||02391  |''                sAccCode, sNearMonth, sZenkai, s
02419  |'            sSql = gstrEditSQLcfr_MonthlyNavForSe||02392  |'            sSql = gstrEditSQLcfr_MonthlyNavForSe
02420  |'                sContNo, sNearMonth, sZenkai)    ||02393  |'                sContNo, sNearMonth, sZenkai)    
02421  |''2004/09/21 End                                  ||02394  |''2004/09/21 End                                  
02422  |'            'ﾀﾞｲﾅｾｯﾄの作成                       ||02395  |'            'ﾀﾞｲﾅｾｯﾄの作成                       
02423  |'            If gintDyCreate(sSql) = False Then   ||02396  |'            If gintDyCreate(sSql) = False Then   
02424  |'                Exit Function                    ||02397  |'                Exit Function                    
02425  |'            End If                               ||02398  |'            End If                               
02426  |''2004/11/08 Start                                ||02399  |''2004/11/08 Start                                
02427  |'            dstrMonthOld = ""                    ||02400  |'            dstrMonthOld = ""                    
02428  |'            dstrMonthNew = ""                    ||02401  |'            dstrMonthNew = ""                    
02429  |'            ddblNav = 0                          ||02402  |'            ddblNav = 0                          
02430  |'            ddblCnt = 0                          ||02403  |'            ddblCnt = 0                          
02431  |'            ddblNavTotal = 0                     ||02404  |'            ddblNavTotal = 0                     
02432  |'            i = 0                                ||02405  |'            i = 0                                
02433  |''2004/11/08 End                                  ||02406  |''2004/11/08 End                                  
02434  |'            Do Until gblnDyEOF()                 ||02407  |'            Do Until gblnDyEOF()                 
02435  |''2004/11/08 Start                                ||02408  |''2004/11/08 Start                                
02436  |'                '動的配列更新                    ||02409  |'                '動的配列更新                    
02437  |''                ReDim Preserve gtypcfr_mnav_tbl(||02410  |''                ReDim Preserve gtypcfr_mnav_tbl(
02438  |'                '対象月次NAV抽出                 ||02411  |'                '対象月次NAV抽出                 
02439  |''                gtypcfr_mnav_tbl(MonthlyCnt).bas||02412  |''                gtypcfr_mnav_tbl(MonthlyCnt).bas
02440  |''                gtypcfr_mnav_tbl(MonthlyCnt).net||02413  |''                gtypcfr_mnav_tbl(MonthlyCnt).net
02441  |''                MonthlyCnt = MonthlyCnt + 1     ||02414  |''                MonthlyCnt = MonthlyCnt + 1     
02442  |'                dstrMonthNew = gvlnDyDataS("base_||02415  |'                dstrMonthNew = gvlnDyDataS("base_
02443  |'                If dstrMonthNew <> dstrMonthOld T||02416  |'                If dstrMonthNew <> dstrMonthOld T
02444  |'                    If i = 0 Then                ||02417  |'                    If i = 0 Then                
02445  |'                        '動的配列更新            ||02418  |'                        '動的配列更新            
02446  |'                        ReDim Preserve gtypcfr_mn||02419  |'                        ReDim Preserve gtypcfr_mn
02447  |'                        i = 1                    ||02420  |'                        i = 1                    
02448  |'                    Else                         ||02421  |'                    Else                         
02449  |'                        MonthlyCnt = MonthlyCnt +||02422  |'                        MonthlyCnt = MonthlyCnt +
02450  |'                        ReDim Preserve gtypcfr_mn||02423  |'                        ReDim Preserve gtypcfr_mn
02451  |'                        ddblNav = 0              ||02424  |'                        ddblNav = 0              
02452  |'                        ddblCnt = 0              ||02425  |'                        ddblCnt = 0              
02453  |'                        ddblNavTotal = 0         ||02426  |'                        ddblNavTotal = 0         
02454  |'                    End If                       ||02427  |'                    End If                       
02455  |'                End If                           ||02428  |'                End If                           
02456  |'                ddblNav = gvlnDyDataN("NET_ASSET_||02429  |'                ddblNav = gvlnDyDataN("NET_ASSET_
02457  |'                ddblCnt = gvlnDyDataN("NAV_CNT") ||02430  |'                ddblCnt = gvlnDyDataN("NAV_CNT") 
02458  |'                If ddblCnt > 0 Then              ||02431  |'                If ddblCnt > 0 Then              
02459  |'                    ddblNavTotal = ddblNavTotal +||02432  |'                    ddblNavTotal = ddblNavTotal +
02460  |'                Else                             ||02433  |'                Else                             
02461  |'                    ddblNavTotal = ddblNavTotal +||02434  |'                    ddblNavTotal = ddblNavTotal +
02462  |'                End If                           ||02435  |'                End If                           
02463  |'                gtypcfr_mnav_tbl(MonthlyCnt).BASE||02436  |'                gtypcfr_mnav_tbl(MonthlyCnt).BASE
02464  |'                gtypcfr_mnav_tbl(MonthlyCnt).net_||02437  |'                gtypcfr_mnav_tbl(MonthlyCnt).net_
02465  |'                dstrMonthOld = dstrMonthNew      ||02438  |'                dstrMonthOld = dstrMonthNew      
02466  |''2004/11/08 End                                  ||02439  |''2004/11/08 End                                  
02467  |'                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                ||02440  |'                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                
02468  |'                Call gDyNext                     ||02441  |'                Call gDyNext                     
02469  |'            Loop                                 ||02442  |'            Loop                                 
02470  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    ||02443  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    
02471  |'            Call gblnDyClose                     ||02444  |'            Call gblnDyClose                     
02472  |'                                                 ||02445  |'                                                 
02473  |''SQL文の作成(月別支払顧問料)                     ||02446  |''SQL文の作成(月別支払顧問料)                     
02474  |''            sZenkai = DateAdd("m", 1, gstrDateFo||02447  |''            sZenkai = DateAdd("m", 1, gstrDateFo
02475  |''            sZenkai = Mid(gstrDateFormat2(sZenka||02448  |''            sZenkai = Mid(gstrDateFormat2(sZenka
02476  |''            sNearMonth = Mid(mstrNearSettleDate,||02449  |''            sNearMonth = Mid(mstrNearSettleDate,
02477  |''            sSql = gstrEditSQLcfr_MonthlyPayComF||02450  |''            sSql = gstrEditSQLcfr_MonthlyPayComF
02478  |''                sContractNo, sZenkai, sNearMonth||02451  |''                sContractNo, sZenkai, sNearMonth
02479  |''            'ﾀﾞｲﾅｾｯﾄの作成                      ||02452  |''            'ﾀﾞｲﾅｾｯﾄの作成                      
02480  |''            If gintDyCreate(sSql) = False Then  ||02453  |''            If gintDyCreate(sSql) = False Then  
02481  |''                Exit Function                   ||02454  |''                Exit Function                   
02482  |''            End If                              ||02455  |''            End If                              
02483  |''            '対象月別支払顧問料累計値抽出       ||02456  |''            '対象月別支払顧問料累計値抽出       
02484  |''            mstrMonthlyPayCom = gvlnDyDataS("SUM||02457  |''            mstrMonthlyPayCom = gvlnDyDataS("SUM
02485  |''            If mstrMonthlyPayCom <> "" Then     ||02458  |''            If mstrMonthlyPayCom <> "" Then     
02486  |''                mstrMonthlyPayCom = Round(gvlnDy||02459  |''                mstrMonthlyPayCom = Round(gvlnDy
02487  |''            End If                              ||02460  |''            End If                              
02488  |''            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                   ||02461  |''            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                   
02489  |''            Call gblnDyClose                    ||02462  |''            Call gblnDyClose                    
02490  |'                                                 ||02463  |'                                                 
02491  |''SQL文の作成(外部委託顧問料率取得)               ||02464  |''SQL文の作成(外部委託顧問料率取得)               
02492  |'            sRuleNo = gbuMGetUPDRec.N(Cnt).MGET_O||02465  |'            sRuleNo = gbuMGetUPDRec.N(Cnt).MGET_O
02493  |'            sSql = gstrEditSQLcfr_OtherComRateFor||02466  |'            sSql = gstrEditSQLcfr_OtherComRateFor
02494  |'                sContractNo, sRuleNo)            ||02467  |'                sContractNo, sRuleNo)            
02495  |'            'ﾀﾞｲﾅｾｯﾄの作成                       ||02468  |'            'ﾀﾞｲﾅｾｯﾄの作成                       
02496  |'            If gintDyCreate(sSql) = False Then   ||02469  |'            If gintDyCreate(sSql) = False Then   
02497  |'                Exit Function                    ||02470  |'                Exit Function                    
02498  |'            End If                               ||02471  |'            End If                               
02499  |'            '配列初期化                          ||02472  |'            '配列初期化                          
02500  |'            ReDim gbuOtherComRateGetUPDRec.N(0)  ||02473  |'            ReDim gbuOtherComRateGetUPDRec.N(0)  
02501  |'            MonthlyCnt = 0                       ||02474  |'            MonthlyCnt = 0                       
02502  |'            'EOF判定処理                         ||02475  |'            'EOF判定処理                         
02503  |'            Do Until gblnDyEOF()                 ||02476  |'            Do Until gblnDyEOF()                 
02504  |'                '対象データ抽出                  ||02477  |'                '対象データ抽出                  
02505  |'                Call sbOtherComDataGet(MonthlyCnt||02478  |'                Call sbOtherComDataGet(MonthlyCnt
02506  |'                MonthlyCnt = MonthlyCnt + 1      ||02479  |'                MonthlyCnt = MonthlyCnt + 1      
02507  |'                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                ||02480  |'                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                
02508  |'                Call gDyNext                     ||02481  |'                Call gDyNext                     
02509  |'            Loop                                 ||02482  |'            Loop                                 
02510  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    ||02483  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    
02511  |'            Call gblnDyClose                     ||02484  |'            Call gblnDyClose                     
02512  |'                                                 ||02485  |'                                                 
02513  |''確認書の作成                                    ||02486  |''確認書の作成                                    
02514  |'                                                 ||02487  |'                                                 
02515  |'    If gProcessCnt <> 1 Then                     ||02488  |'    If gProcessCnt <> 1 Then                     
02516  |'        '2回目以降はシートの追加                 ||02489  |'        '2回目以降はシートの追加                 
02517  |'        xlBook.Worksheets.Add after:=xlBook.Sheet||02490  |'        xlBook.Worksheets.Add after:=xlBook.Sheet
02518  |'    Else                                         ||02491  |'    Else                                         
02519  |'        '1回目はオブジェクトの設定               ||02492  |'        '1回目はオブジェクトの設定               
02520  |'        Set xlApp = CreateObject("Excel.Applicati||02493  |'        Set xlApp = CreateObject("Excel.Applicati
02521  |'        Set xlBook = xlApp.Workbooks.Add         ||02494  |'        Set xlBook = xlApp.Workbooks.Add         
02522  |'    End If                                       ||02495  |'    End If                                       
02523  |'    Set xlSheet = xlBook.Sheets(gProcessCnt)     ||02496  |'    Set xlSheet = xlBook.Sheets(gProcessCnt)     
02524  |'                                                 ||02497  |'                                                 
02525  |'    If fnblExcelOut(Cnt) = False Then            ||02498  |'    If fnblExcelOut(Cnt) = False Then            
02526  |'        MsgBox "確認書の作成でエラーが発生しまし ||02499  |'        MsgBox "確認書の作成でエラーが発生しまし 
02527  |'        Exit Function                            ||02500  |'        Exit Function                            
02528  |'    End If                                       ||02501  |'    End If                                       
02529  |'                                                 ||02502  |'                                                 
02530  |'    If gbuMGetUPDRec.N(Cnt).MGET_company_flag = "||02503  |'    If gbuMGetUPDRec.N(Cnt).MGET_company_flag = "
02531  |'        xlBook.Worksheets.Add after:=xlBook.Sheet||02504  |'        xlBook.Worksheets.Add after:=xlBook.Sheet
02532  |'        gProcessCnt = gProcessCnt + 1            ||02505  |'        gProcessCnt = gProcessCnt + 1            
02533  |'                                                 ||02506  |'                                                 
02534  |'        If fnblExcelEnglishOut(Cnt) = False Then ||02507  |'        If fnblExcelEnglishOut(Cnt) = False Then 
02535  |'            MsgBox "英文確認書の作成でエラーが発 ||02508  |'            MsgBox "英文確認書の作成でエラーが発 
02536  |'            Exit Function                        ||02509  |'            Exit Function                        
02537  |'        End If                                   ||02510  |'        End If                                   
02538  |'    End If                                       ||02511  |'    End If                                       
02539  |'                                                 ||02512  |'                                                 
02540  |'    'Excel の Worksheet 削除用カウンタ変数       ||02513  |'    'Excel の Worksheet 削除用カウンタ変数       
02541  |'    Dim Ws_Cnt      As Integer                   ||02514  |'    Dim Ws_Cnt      As Integer                   
02542  |'    Dim Ws_Del_Cnt  As Integer                   ||02515  |'    Dim Ws_Del_Cnt  As Integer                   
02543  |'    Dim Ws_Del_Cnt2 As Integer                   ||02516  |'    Dim Ws_Del_Cnt2 As Integer                   
02544  |'                                                 ||02517  |'                                                 
02545  |'                                                 ||02518  |'                                                 
02546  |'    '動的ファイル名部分を取得                    ||02519  |'    '動的ファイル名部分を取得                    
02547  |'    If gTotalProcessCnt = 1 Then                 ||02520  |'    If gTotalProcessCnt = 1 Then                 
02548  |'        Call sbFileNameChange                    ||02521  |'        Call sbFileNameChange                    
02549  |'    End If                                       ||02522  |'    End If                                       
02550  |'                                                 ||02523  |'                                                 
02551  |'    'Excel の Worksheet 削除用カウンタ初期化     ||02524  |'    'Excel の Worksheet 削除用カウンタ初期化     
02552  |'    Ws_Cnt = xlBook.Worksheets.Count             ||02525  |'    Ws_Cnt = xlBook.Worksheets.Count             
02553  |'    Ws_Del_Cnt2 = 0                              ||02526  |'    Ws_Del_Cnt2 = 0                              
02554  |'    '出力するデータ数のカウント(gSysoutDataCnt)と||02527  |'    '出力するデータ数のカウント(gSysoutDataCnt)と
02555  |'    If gTotalProcessCnt = gSysoutDataCnt Then    ||02528  |'    If gTotalProcessCnt = gSysoutDataCnt Then    
02556  |'        ' WorkBookが存在すれば削除               ||02529  |'        ' WorkBookが存在すれば削除               
02557  |'        If Dir(mstrFileName) <> "" Then          ||02530  |'        If Dir(mstrFileName) <> "" Then          
02558  |'            Kill (mstrFileName)                  ||02531  |'            Kill (mstrFileName)                  
02559  |'        End If                                   ||02532  |'        End If                                   
02560  |'                                                 ||02533  |'                                                 
02561  |'        'シート名を調査しシート削除              ||02534  |'        'シート名を調査しシート削除              
02562  |'        For Ws_Del_Cnt = 1 To Ws_Cnt             ||02535  |'        For Ws_Del_Cnt = 1 To Ws_Cnt             
02563  |'            If Left(xlBook.Worksheets(Ws_Del_Cnt)||02536  |'            If Left(xlBook.Worksheets(Ws_Del_Cnt)
02564  |'                'シートの削除                    ||02537  |'                'シートの削除                    
02565  |'                Application.DisplayAlerts = False||02538  |'                Application.DisplayAlerts = False
02566  |'                xlBook.Worksheets(Ws_Del_Cnt).Del||02539  |'                xlBook.Worksheets(Ws_Del_Cnt).Del
02567  |'                Application.DisplayAlerts = True ||02540  |'                Application.DisplayAlerts = True 
02568  |'                Ws_Del_Cnt = Ws_Del_Cnt - 1      ||02541  |'                Ws_Del_Cnt = Ws_Del_Cnt - 1      
02569  |'                Ws_Del_Cnt2 = Ws_Del_Cnt2 + 1    ||02542  |'                Ws_Del_Cnt2 = Ws_Del_Cnt2 + 1    
02570  |'                If Ws_Del_Cnt2 = 2 Then          ||02543  |'                If Ws_Del_Cnt2 = 2 Then          
02571  |'                    Exit For                     ||02544  |'                    Exit For                     
02572  |'                End If                           ||02545  |'                End If                           
02573  |'            End If                               ||02546  |'            End If                               
02574  |'        Next Ws_Del_Cnt                          ||02547  |'        Next Ws_Del_Cnt                          
02575  |'                                                 ||02548  |'                                                 
02576  |'        '見易いようにシートの1枚目を選択する     ||02549  |'        '見易いようにシートの1枚目を選択する     
02577  |'        xlBook.Worksheets(1).Select              ||02550  |'        xlBook.Worksheets(1).Select              
02578  |'                                                 ||02551  |'                                                 
02579  |'        xlBook.SaveAs mstrFileName               ||02552  |'        xlBook.SaveAs mstrFileName               
02580  |'        xlBook.Close                             ||02553  |'        xlBook.Close                             
02581  |'        xlApp.Quit                               ||02554  |'        xlApp.Quit                               
02582  |'                                                 ||02555  |'                                                 
02583  |'        Set xlApp = Nothing                      ||02556  |'        Set xlApp = Nothing                      
02584  |'        Set xlBook = Nothing                     ||02557  |'        Set xlBook = Nothing                     
02585  |'        Set xlSheet = Nothing                    ||02558  |'        Set xlSheet = Nothing                    
02586  |'                                                 ||02559  |'                                                 
02587  |'        '処理回数カウンターの初期化              ||02560  |'        '処理回数カウンターの初期化              
02588  |'        gProcessCnt = 0                          ||02561  |'        gProcessCnt = 0                          
02589  |'        '保存ファイル名の修正                    ||02562  |'        '保存ファイル名の修正                    
02590  |'        gSaveFileCnt = gSaveFileCnt + 1          ||02563  |'        gSaveFileCnt = gSaveFileCnt + 1          
02591  |'        mstrFileName = mstrFileNameBK & " (" & gS||02564  |'        mstrFileName = mstrFileNameBK & " (" & gS
02592  |'    End If                                       ||02565  |'    End If                                       
02593  |'                                                 ||02566  |'                                                 
02594  |'                                                 ||02567  |'                                                 
02595  |'                                                 ||02568  |'                                                 
02596  |''        End If                                  ||02569  |''        End If                                  
02597  |'    Next Cnt                                     ||02570  |'    Next Cnt                                     
02598  |'                                                 ||02571  |'                                                 
02599  |'    '正常戻り値セット                            ||02572  |'    '正常戻り値セット                            
02600  |'    fnblMakePrint = True                         ||02573  |'    fnblMakePrint = True                         
02601  |'    GoTo EndProc                                 ||02574  |'    GoTo EndProc                                 
02602  |'                                                 ||02575  |'                                                 
02603  |'OnErrorProc:                                     ||02576  |'OnErrorProc:                                     
02604  |'    Call subError("システムエラー", Str(Err.Numbe||02577  |'    Call subError("システムエラー", Str(Err.Numbe
02605  |'        Error, strErrCall, conTitle)             ||02578  |'        Error, strErrCall, conTitle)             
02606  |'    'マウスポインター元に戻す                    ||02579  |'    'マウスポインター元に戻す                    
02607  |'    Screen.MousePointer = vbDefault              ||02580  |'    Screen.MousePointer = vbDefault              
02608  |'                                                 ||02581  |'                                                 
02609  |'EndProc:                                         ||02582  |'EndProc:                                         
02610  |'#################################################||02583  |'#################################################
02611  |'2006/07/03 END   K.Furuya 期中料率変更契約/RAFI対||02584  |'2006/07/03 END   K.Furuya 期中料率変更契約/RAFI対
02612  |'#################################################||02585  |'#################################################
02613  |                                                  ||02586  |                                                  
02614  |End Function                                      ||02587  |End Function                                      
02615  |                                                  ||02588  |                                                  
02616  |'=================================================||02589  |'=================================================
02617  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMGetDataGet                ||02590  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMGetDataGet                
02618  |'機能            :   対象月次外部委託顧問料率取得 ||02591  |'機能            :   対象月次外部委託顧問料率取得 
02619  |'                                                 ||02592  |'                                                 
02620  |'日付               担当　              修正内容  ||02593  |'日付               担当　              修正内容  
02621  |'-------------------------------------------------||02594  |'-------------------------------------------------
02622  |'2004/08/04         M.Katoh<SRA>       新規作成   ||02595  |'2004/08/04         M.Katoh<SRA>       新規作成   
02623  |'2004/12/17         M.Yamazaki<SRA>    上限金額、 ||02596  |'2004/12/17         M.Yamazaki<SRA>    上限金額、 
02624  |'2005/01/11         M.Yamazaki<SRA>    閾値通貨、 ||02597  |'2005/01/11         M.Yamazaki<SRA>    閾値通貨、 
02625  |'2005/01/18         M.Yamazaki<SRA>    口座属性・ ||02598  |'2005/01/18         M.Yamazaki<SRA>    口座属性・ 
02626  |'2005/03/09         M.Yamazaki<SRA>    外部委託顧 ||02599  |'2005/03/09         M.Yamazaki<SRA>    外部委託顧 
02627  |'2008/03/26         K.Furuya<SRA>      ファンド決 ||02600  |'2008/03/26         K.Furuya<SRA>      ファンド決 
02628  |'=================================================||02601  |'=================================================
02629  |Private Sub sbMGetDataGet( _                      ||02602  |Private Sub sbMGetDataGet( _                      
02630  |    ByVal lRecIdx As Long _                       ||02603  |    ByVal lRecIdx As Long _                       
02631  |)                                                 ||02604  |)                                                 
02632  |                                                  ||02605  |                                                  
02633  |    '動的配列更新                                 ||02606  |    '動的配列更新                                 
02634  |    ReDim Preserve gbuMGetUPDRec.N(0 To lRecIdx)  ||02607  |    ReDim Preserve gbuMGetUPDRec.N(0 To lRecIdx)  
02635  |                                                  ||02608  |                                                  
02636  |    With gbuMGetUPDRec.N(lRecIdx)                 ||02609  |    With gbuMGetUPDRec.N(lRecIdx)                 
02637  |'''''        .MGET_contract_no = gvlnDyDataS("Cont||02610  |'''''        .MGET_contract_no = gvlnDyDataS("Cont
02638  |'''''        .MGET_contract_name = gvlnDyDataS("Co||02611  |'''''        .MGET_contract_name = gvlnDyDataS("Co
02639  |'''''        .MGET_contract_flag = gvlnDyDataS("Co||02612  |'''''        .MGET_contract_flag = gvlnDyDataS("Co
02640  |'''''        .MGET_account_code = gvlnDyDataS("acc||02613  |'''''        .MGET_account_code = gvlnDyDataS("acc
02641  |'''''        .MGET_account_name = gvlnDyDataS("acc||02614  |'''''        .MGET_account_name = gvlnDyDataS("acc
02642  |''''''2005/01/18 Start                            ||02615  |''''''2005/01/18 Start                            
02643  |'''''        .MGET_acc_invalid_flag = gvlnDyDataS(||02616  |'''''        .MGET_acc_invalid_flag = gvlnDyDataS(
02644  |''''''2005/01/18 End                              ||02617  |''''''2005/01/18 End                              
02645  |'''''        .MGET_base_currency_code = gvlnDyData||02618  |'''''        .MGET_base_currency_code = gvlnDyData
02646  |'''''        .MGET_settlement_date = gvlnDyDataS("||02619  |'''''        .MGET_settlement_date = gvlnDyDataS("
02647  |'''''        .MGET_settlement_date_YYYYMMDD = gvln||02620  |'''''        .MGET_settlement_date_YYYYMMDD = gvln
02648  |'''''        .MGET_com_calc_start = gvlnDyDataS("c||02621  |'''''        .MGET_com_calc_start = gvlnDyDataS("c
02649  |'''''        .MGET_com_calc_end = gvlnDyDataS("com||02622  |'''''        .MGET_com_calc_end = gvlnDyDataS("com
02650  |'''''        .MGET_company_code = gvlnDyDataS("com||02623  |'''''        .MGET_company_code = gvlnDyDataS("com
02651  |'''''        .MGET_company_name = gvlnDyDataS("com||02624  |'''''        .MGET_company_name = gvlnDyDataS("com
02652  |'''''                                             ||02625  |'''''                                             
02653  |'''''        .MGET_OTHER_COM_RULE_NO = gvlnDyDataN||02626  |'''''        .MGET_OTHER_COM_RULE_NO = gvlnDyDataN
02654  |'''''        .MGET_other_rate_rule_flag = gvlnDyDa||02627  |'''''        .MGET_other_rate_rule_flag = gvlnDyDa
02655  |''''''2004/12/17 Start                            ||02628  |''''''2004/12/17 Start                            
02656  |'''''        .MGET_cap = gvlnDyDataS("CAP")       ||02629  |'''''        .MGET_cap = gvlnDyDataS("CAP")       
02657  |'''''        .MGET_floor = gvlnDyDataS("FLOOR")   ||02630  |'''''        .MGET_floor = gvlnDyDataS("FLOOR")   
02658  |'''''        .MGET_nav_get_flag = gvlnDyDataS("NAV||02631  |'''''        .MGET_nav_get_flag = gvlnDyDataS("NAV
02659  |''''''2004/12/17 End                              ||02632  |''''''2004/12/17 End                              
02660  |''''''2005/01/11 Start                            ||02633  |''''''2005/01/11 Start                            
02661  |'''''        .MGET_amount_currency_code = gvlnDyDa||02634  |'''''        .MGET_amount_currency_code = gvlnDyDa
02662  |'''''        .MGET_other_com_currency_code = gvlnD||02635  |'''''        .MGET_other_com_currency_code = gvlnD
02663  |'''''        .MGET_days_in_a_year = gvlnDyDataS("D||02636  |'''''        .MGET_days_in_a_year = gvlnDyDataS("D
02664  |''''''2005/01/11 End                              ||02637  |''''''2005/01/11 End                              
02665  |''''''2005/02/02 Start                            ||02638  |''''''2005/02/02 Start                            
02666  |'''''        .MGET_yokujitu = ""                  ||02639  |'''''        .MGET_yokujitu = ""                  
02667  |''''''2005/02/02 End                              ||02640  |''''''2005/02/02 End                              
02668  |''''''2005/03/09 Start                            ||02641  |''''''2005/03/09 Start                            
02669  |'''''        .MGET_tax_calc_flag = gvlnDyDataS("TA||02642  |'''''        .MGET_tax_calc_flag = gvlnDyDataS("TA
02670  |''''''2005/03/09 End                              ||02643  |''''''2005/03/09 End                              
02671  |                                                  ||02644  |                                                  
02672  |        .MGET_company_flag = gvlnDyDataS("COMPANY_||02645  |        .MGET_company_flag = gvlnDyDataS("COMPANY_
02673  |        .MGET_contract_no = gvlnDyDataS("Contract_||02646  |        .MGET_contract_no = gvlnDyDataS("Contract_
02674  |        .MGET_contract_name = gvlnDyDataS("Contrac||02647  |        .MGET_contract_name = gvlnDyDataS("Contrac
02675  |        .MGET_contract_name_e = gvlnDyDataS("Contr||02648  |        .MGET_contract_name_e = gvlnDyDataS("Contr
02676  |        .MGET_contract_flag = gvlnDyDataS("Contrac||02649  |        .MGET_contract_flag = gvlnDyDataS("Contrac
02677  |        .MGET_settlement_date = gvlnDyDataS("sett_||02650  |        .MGET_settlement_date = gvlnDyDataS("sett_
02678  |        .MGET_account_code = gvlnDyDataS("account_||02651  |        .MGET_account_code = gvlnDyDataS("account_
02679  |        .MGET_account_name = gvlnDyDataS("account_||02652  |        .MGET_account_name = gvlnDyDataS("account_
02680  |        .MGET_base_currency_code = gvlnDyDataS("ba||02653  |        .MGET_base_currency_code = gvlnDyDataS("ba
02681  |        .MGET_com_calc_start = gvlnDyDataS("com_ca||02654  |        .MGET_com_calc_start = gvlnDyDataS("com_ca
02682  |        .MGET_com_calc_end = gvlnDyDataS("com_calc||02655  |        .MGET_com_calc_end = gvlnDyDataS("com_calc
02683  |        .MGET_company_code = gvlnDyDataS("company_||02656  |        .MGET_company_code = gvlnDyDataS("company_
02684  |        .MGET_company_name = gvlnDyDataS("company_||02657  |        .MGET_company_name = gvlnDyDataS("company_
02685  |        .MGET_company_name_e = gvlnDyDataS("compan||02658  |        .MGET_company_name_e = gvlnDyDataS("compan
02686  |        .MGET_OTHER_COM_RULE_NO = gvlnDyDataN("OTH||02659  |        .MGET_OTHER_COM_RULE_NO = gvlnDyDataN("OTH
02687  |        .MGET_other_rate_rule_flag = gvlnDyDataN("||02660  |        .MGET_other_rate_rule_flag = gvlnDyDataN("
02688  |        .MGET_nav_get_flag = gvlnDyDataS("NAV_GET_||02661  |        .MGET_nav_get_flag = gvlnDyDataS("NAV_GET_
02689  |                                                  ||02662  |                                                  
02690  |        '上限値に"-99"が入っている場合は、""と置き||02663  |        '上限値に"-99"が入っている場合は、""と置き
02691  |        If gvlnDyDataS("CAP") = "-99" Then        ||02664  |        If gvlnDyDataS("CAP") = "-99" Then        
02692  |            .MGET_cap = ""                        ||02665  |            .MGET_cap = ""                        
02693  |        Else                                      ||02666  |        Else                                      
02694  |            .MGET_cap = gvlnDyDataS("CAP")        ||02667  |            .MGET_cap = gvlnDyDataS("CAP")        
02695  |        End If                                    ||02668  |        End If                                    
02696  |                                                  ||02669  |                                                  
02697  |        '下限値に"-99"が入っている場合は、""と置き||02670  |        '下限値に"-99"が入っている場合は、""と置き
02698  |        If gvlnDyDataS("FLOOR") = "-99" Then      ||02671  |        If gvlnDyDataS("FLOOR") = "-99" Then      
02699  |            .MGET_floor = ""                      ||02672  |            .MGET_floor = ""                      
02700  |        Else                                      ||02673  |        Else                                      
02701  |            .MGET_floor = gvlnDyDataS("FLOOR")    ||02674  |            .MGET_floor = gvlnDyDataS("FLOOR")    
02702  |        End If                                    ||02675  |        End If                                    
02703  |                                                  ||02676  |                                                  
02704  |        .MGET_amount_currency_code = gvlnDyDataS("||02677  |        .MGET_amount_currency_code = gvlnDyDataS("
02705  |        .MGET_other_com_currency_code = gvlnDyData||02678  |        .MGET_other_com_currency_code = gvlnDyData
02706  |        .MGET_days_in_a_year = gvlnDyDataS("DAYS_I||02679  |        .MGET_days_in_a_year = gvlnDyDataS("DAYS_I
02707  |        .MGET_settlement_date_YYYYMMDD = gvlnDyDat||02680  |        .MGET_settlement_date_YYYYMMDD = gvlnDyDat
02708  |        .MGET_tax_calc_flag = gvlnDyDataS("TAX_CAL||02681  |        .MGET_tax_calc_flag = gvlnDyDataS("TAX_CAL
02709  |'2008/03/26 START ファンド決算期間での外部委託顧問||02682  |'2008/03/26 START ファンド決算期間での外部委託顧問
02710  |        .MGET_other_real_flag = "0"               ||02683  |        .MGET_other_real_flag = "0"               
02711  |'2008/03/26 END   ファンド決算期間での外部委託顧問||02684  |'2008/03/26 END   ファンド決算期間での外部委託顧問
02712  |                                                  ||02685  |                                                  
02713  |    End With                                      ||02686  |    End With                                      
02714  |                                                  ||02687  |                                                  
02715  |End Sub                                           ||02688  |End Sub                                           
02716  |                                                  ||02689  |                                                  
02717  |'=================================================||02690  |'=================================================
02718  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbOtherComDataGet            ||02691  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbOtherComDataGet            
02719  |'機能            :   対象外部委託顧問料率取得テー ||02692  |'機能            :   対象外部委託顧問料率取得テー 
02720  |'                                                 ||02693  |'                                                 
02721  |'日付               担当　              修正内容  ||02694  |'日付               担当　              修正内容  
02722  |'-------------------------------------------------||02695  |'-------------------------------------------------
02723  |'2004/08/05         M.Katoh<SRA>       新規作成   ||02696  |'2004/08/05         M.Katoh<SRA>       新規作成   
02724  |'2006/07/07         K.Furuya<SRA>      期中料率変 ||02697  |'2006/07/07         K.Furuya<SRA>      期中料率変 
02725  |'                                      計算期間の ||02698  |'                                      計算期間の 
02726  |'=================================================||02699  |'=================================================
02727  |Private Sub sbOtherComDataGet( _                  ||02700  |Private Sub sbOtherComDataGet( _                  
02728  |    ByVal lRecIdx As Long _                       ||02701  |    ByVal lRecIdx As Long _                       
02729  |)                                                 ||02702  |)                                                 
02730  |                                                  ||02703  |                                                  
02731  |    '動的配列更新                                 ||02704  |    '動的配列更新                                 
02732  |    ReDim Preserve gbuOtherComRateGetUPDRec.N(0 To||02705  |    ReDim Preserve gbuOtherComRateGetUPDRec.N(0 To
02733  |                                                  ||02706  |                                                  
02734  |'2006/07/07 START K.Furuya 期中料率変更契約/RAFI対||02707  |'2006/07/07 START K.Furuya 期中料率変更契約/RAFI対
02735  |'    With gbuOtherComRateGetUPDRec.N(lRecIdx)     ||02708  |'    With gbuOtherComRateGetUPDRec.N(lRecIdx)     
02736  |'        .RGET_CONTRACT_NO = gvlnDyDataS("Contract||02709  |'        .RGET_CONTRACT_NO = gvlnDyDataS("Contract
02737  |'        .RGET_OTHER_COM_RULE_NO = gvlnDyDataN("OT||02710  |'        .RGET_OTHER_COM_RULE_NO = gvlnDyDataN("OT
02738  |'        .RGET_OTHER_COM_RULE_ORDER = gvlnDyDataN(||02711  |'        .RGET_OTHER_COM_RULE_ORDER = gvlnDyDataN(
02739  |'        .RGET_THRESHOLD_AMOUNT = gvlnDyDataN("THR||02712  |'        .RGET_THRESHOLD_AMOUNT = gvlnDyDataN("THR
02740  |'        .RGET_OTHER_COM_RATE = gvlnDyDataN("OTHER||02713  |'        .RGET_OTHER_COM_RATE = gvlnDyDataN("OTHER
02741  |'        .RGET_RITSU = gvlnDyDataN("RITSU")       ||02714  |'        .RGET_RITSU = gvlnDyDataN("RITSU")       
02742  |'    End With                                     ||02715  |'    End With                                     
02743  |    With gbuOtherComRateGetUPDRec.N(lRecIdx)      ||02716  |    With gbuOtherComRateGetUPDRec.N(lRecIdx)      
02744  |        .RGET_START_DATE = gvlnDyDataS("START_DATE||02717  |        .RGET_START_DATE = gvlnDyDataS("START_DATE
02745  |        .RGET_END_DATE = gvlnDyDataS("END_DATE")  ||02718  |        .RGET_END_DATE = gvlnDyDataS("END_DATE")  
02746  |        .RGET_CONTRACT_NO = gvlnDyDataS("Contract_||02719  |        .RGET_CONTRACT_NO = gvlnDyDataS("Contract_
02747  |        .RGET_OTHER_COM_RULE_NO = gvlnDyDataN("OTH||02720  |        .RGET_OTHER_COM_RULE_NO = gvlnDyDataN("OTH
02748  |        .RGET_OTHER_COM_RULE_ORDER = gvlnDyDataN("||02721  |        .RGET_OTHER_COM_RULE_ORDER = gvlnDyDataN("
02749  |        .RGET_THRESHOLD_AMOUNT = gvlnDyDataN("THRE||02722  |        .RGET_THRESHOLD_AMOUNT = gvlnDyDataN("THRE
02750  |        .RGET_OTHER_COM_RATE = gvlnDyDataN("OTHER_||02723  |        .RGET_OTHER_COM_RATE = gvlnDyDataN("OTHER_
02751  |        .RGET_RITSU = gvlnDyDataN("RITSU")        ||02724  |        .RGET_RITSU = gvlnDyDataN("RITSU")        
02752  |        .RGET_RULE_NO_CNT = gvlnDyDataN("RULE_NO_C||02725  |        .RGET_RULE_NO_CNT = gvlnDyDataN("RULE_NO_C
02753  |    End With                                      ||02726  |    End With                                      
02754  |'2006/07/07 END   K.Furuya 期中料率変更契約/RAFI対||02727  |'2006/07/07 END   K.Furuya 期中料率変更契約/RAFI対
02755  |                                                  ||02728  |                                                  
02756  |End Sub                                           ||02729  |End Sub                                           
02757  |                                                  ||02730  |                                                  
02758  |'=================================================||02731  |'=================================================
02759  |'処理内容     締日チェック：fnChkSettlementDate   ||02732  |'処理内容     締日チェック：fnChkSettlementDate   
02760  |'備考         締日が営業日かチェックして、対象締日||02733  |'備考         締日が営業日かチェックして、対象締日
02761  |'                                                 ||02734  |'                                                 
02762  |'引数         strSettlementDate:対象締日,iNum：処 ||02735  |'引数         strSettlementDate:対象締日,iNum：処 
02763  |'             iNum = 1：直近締日セット,iNum = 2： ||02736  |'             iNum = 1：直近締日セット,iNum = 2： 
02764  |'                                                 ||02737  |'                                                 
02765  |'日付         担当               内容             ||02738  |'日付         担当               内容             
02766  |'------------ ----------------- ------------------||02739  |'------------ ----------------- ------------------
02767  |'2004/08/24   M.Katoh <SRA>     新規作成          ||02740  |'2004/08/24   M.Katoh <SRA>     新規作成          
02768  |'=================================================||02741  |'=================================================
02769  |Private Function fnChkSettlementDate( _           ||02742  |Private Function fnChkSettlementDate( _           
02770  |    ByVal strSettlementDate As String, _          ||02743  |    ByVal strSettlementDate As String, _          
02771  |    ByVal iNum As String _                        ||02744  |    ByVal iNum As String _                        
02772  |) As Boolean                                      ||02745  |) As Boolean                                      
02773  |                                                  ||02746  |                                                  
02774  |On Error GoTo OnErrorProc                         ||02747  |On Error GoTo OnErrorProc                         
02775  |                                                  ||02748  |                                                  
02776  |    Const conMeModule As String = "sbChkSettlement||02749  |    Const conMeModule As String = "sbChkSettlement
02777  |    Dim sSql        As String                     ||02750  |    Dim sSql        As String                     
02778  |    Dim sWorkWhere  As String                     ||02751  |    Dim sWorkWhere  As String                     
02779  |    Dim blnret      As Boolean                    ||02752  |    Dim blnret      As Boolean                    
02780  |    Dim iEigyoFlag  As Integer                    ||02753  |    Dim iEigyoFlag  As Integer                    
02781  |    Dim strErrCall  As String        'エラー呼出元||02754  |    Dim strErrCall  As String        'エラー呼出元
02782  |    Dim WorkDate    As String                     ||02755  |    Dim WorkDate    As String                     
02783  |                                                  ||02756  |                                                  
02784  |    '戻り値初期化                                 ||02757  |    '戻り値初期化                                 
02785  |    fnChkSettlementDate = False                   ||02758  |    fnChkSettlementDate = False                   
02786  |                                                  ||02759  |                                                  
02787  |    'カレンダーテーブル該当データ取得用ＳＱＬ     ||02760  |    'カレンダーテーブル該当データ取得用ＳＱＬ     
02788  |    sSql = gstrEditSQLCalGetSelect(strSettlementDa||02761  |    sSql = gstrEditSQLCalGetSelect(strSettlementDa
02789  |    'ﾀﾞｲﾅｾｯﾄの作成                                ||02762  |    'ﾀﾞｲﾅｾｯﾄの作成                                
02790  |    If gintDyCreate(sSql) = False Then            ||02763  |    If gintDyCreate(sSql) = False Then            
02791  |        Exit Function                             ||02764  |        Exit Function                             
02792  |    End If                                        ||02765  |    End If                                        
02793  |    'EOF判定処理                                  ||02766  |    'EOF判定処理                                  
02794  |    If gblnDyEOF() = False Then                   ||02767  |    If gblnDyEOF() = False Then                   
02795  |        '対象締日抽出                             ||02768  |        '対象締日抽出                             
02796  |        WorkDate = gvlnDyDataN("CAL_EIGYO_YMD")   ||02769  |        WorkDate = gvlnDyDataN("CAL_EIGYO_YMD")   
02797  |    End If                                        ||02770  |    End If                                        
02798  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             ||02771  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             
02799  |    Call gblnDyClose                              ||02772  |    Call gblnDyClose                              
02800  |                                                  ||02773  |                                                  
02801  |    '締日を格納する                               ||02774  |    '締日を格納する                               
02802  |    If iNum = 1 Then                              ||02775  |    If iNum = 1 Then                              
02803  |        mstrNearSettleDate = WorkDate             ||02776  |        mstrNearSettleDate = WorkDate             
02804  |    ElseIf iNum = 2 Then                          ||02777  |    ElseIf iNum = 2 Then                          
02805  |        mstrSettlementDate = WorkDate             ||02778  |        mstrSettlementDate = WorkDate             
02806  |    End If                                        ||02779  |    End If                                        
02807  |                                                  ||02780  |                                                  
02808  |    If WorkDate = "" Then                         ||02781  |    If WorkDate = "" Then                         
02809  |        MsgBox "締日が存在してません。。。", vbCri||02782  |        MsgBox "締日が存在してません。。。", vbCri
02810  |        GoTo EndProc                              ||02783  |        GoTo EndProc                              
02811  |    End If                                        ||02784  |    End If                                        
02812  |                                                  ||02785  |                                                  
02813  |    '正常戻り値セット                             ||02786  |    '正常戻り値セット                             
02814  |    fnChkSettlementDate = True                    ||02787  |    fnChkSettlementDate = True                    
02815  |    GoTo EndProc                                  ||02788  |    GoTo EndProc                                  
02816  |                                                  ||02789  |                                                  
02817  |OnErrorProc:                                      ||02790  |OnErrorProc:                                      
02818  |    Call subError("システムエラー", Str(Err.Number||02791  |    Call subError("システムエラー", Str(Err.Number
02819  |        Error, strErrCall, conTitle)              ||02792  |        Error, strErrCall, conTitle)              
02820  |    Exit Function                                 ||02793  |    Exit Function                                 
02821  |                                                  ||02794  |                                                  
02822  |EndProc:                                          ||02795  |EndProc:                                          
02823  |                                                  ||02796  |                                                  
02824  |End Function                                      ||02797  |End Function                                      
02825  |                                                  ||02798  |                                                  
02826  |'=================================================||02799  |'=================================================
02827  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelOut                 ||02800  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelOut                 
02828  |'機能            :   確認書のExcel出力            ||02801  |'機能            :   確認書のExcel出力            
02829  |'                                                 ||02802  |'                                                 
02830  |'日付               担当　              修正内容  ||02803  |'日付               担当　              修正内容  
02831  |'-------------------------------------------------||02804  |'-------------------------------------------------
02832  |'2004/08/03         M.Katoh<SRA>       新規作成   ||02805  |'2004/08/03         M.Katoh<SRA>       新規作成   
02833  |'2004/09/10         M.Yamazaki<SRA>    確認書にフ ||02806  |'2004/09/10         M.Yamazaki<SRA>    確認書にフ 
02834  |'2004/09/21         M.Yamazaki<SRA>    １契約に対 ||02807  |'2004/09/21         M.Yamazaki<SRA>    １契約に対 
02835  |'2004/09/28         M.Yamazaki<SRA>    月次NAVがな||02808  |'2004/09/28         M.Yamazaki<SRA>    月次NAVがな
02836  |'2004/11/10         M.Yamazaki<SRA>    見出し4行目||02809  |'2004/11/10         M.Yamazaki<SRA>    見出し4行目
02837  |'2004/11/17         M.Yamazaki<SRA>    端数の四捨 ||02810  |'2004/11/17         M.Yamazaki<SRA>    端数の四捨 
02838  |'                                      消費税は切 ||02811  |'                                      消費税は切 
02839  |'2004/12/29         M.Yamazaki<SRA>    NAV取得区分||02812  |'2004/12/29         M.Yamazaki<SRA>    NAV取得区分
02840  |'2005/01/06         M.Yamazaki<SRA>    名称使用許 ||02813  |'2005/01/06         M.Yamazaki<SRA>    名称使用許 
02841  |'2005/01/11         M.Yamazaki<SRA>    名称使用許 ||02814  |'2005/01/11         M.Yamazaki<SRA>    名称使用許 
02842  |'2005/01/13         M.Yamazaki<SRA>    １契約複数 ||02815  |'2005/01/13         M.Yamazaki<SRA>    １契約複数 
02843  |'2005/01/17         M.Yamazaki<SRA>    換算レート ||02816  |'2005/01/17         M.Yamazaki<SRA>    換算レート 
02844  |'                                      またレート ||02817  |'                                      またレート 
02845  |'2005/01/20         M.Yamazaki<SRA>    日次NAVにデ||02818  |'2005/01/20         M.Yamazaki<SRA>    日次NAVにデ
02846  |'                                      前営業日の ||02819  |'                                      前営業日の 
02847  |'2005/03/09         M.Yamazaki<SRA>    外部委託顧 ||02820  |'2005/03/09         M.Yamazaki<SRA>    外部委託顧 
02848  |'                                      消費税計算 ||02821  |'                                      消費税計算 
02849  |'2005/03/15         M.Yamazaki<SRA>    名称使用許 ||02822  |'2005/03/15         M.Yamazaki<SRA>    名称使用許 
02850  |'2005/03/18         M.Yamazaki<SRA>    名称使用許 ||02823  |'2005/03/18         M.Yamazaki<SRA>    名称使用許 
02851  |'2005/03/25         M.Yamazaki<SRA>    帳票出力時 ||02824  |'2005/03/25         M.Yamazaki<SRA>    帳票出力時 
02852  |'                                      日次NAV平均||02825  |'                                      日次NAV平均
02853  |'                                      計算期間の ||02826  |'                                      計算期間の 
02854  |'2006/04/11         K.Furuya <SRA>     外部委託顧 ||02827  |'2006/04/11         K.Furuya <SRA>     外部委託顧 
02855  |'2006/07/03         K.Furuya <SRA>     期中料率変 ||02828  |'2006/07/03         K.Furuya <SRA>     期中料率変 
02856  |'                                      ソースが煩 ||02829  |'                                      ソースが煩 
02857  |'                                      作り変えの ||02830  |'                                      作り変えの 
02858  |'=================================================||02831  |'=================================================
02859  |Private Function fnblExcelOut( _                  ||02832  |Private Function fnblExcelOut( _                  
02860  |    ByVal lRecIdx As Long _                       ||02833  |    ByVal lRecIdx As Long _                       
02861  |) As Boolean                                      ||02834  |) As Boolean                                      
02862  |                                                  ||02835  |                                                  
02863  |                                                  ||02836  |                                                  
02864  |'#################################################||02837  |'#################################################
02865  |'2006/07/03 START K.Furuya 期中料率変更契約/RAFI対||02838  |'2006/07/03 START K.Furuya 期中料率変更契約/RAFI対
02866  |'#################################################||02839  |'#################################################
02867  |'                                                 ||02840  |'                                                 
02868  |'    Dim dStart      As Date     '計算期間　開始日||02841  |'    Dim dStart      As Date     '計算期間　開始日
02869  |'    Dim dEnd        As Date     '計算期間　終了日||02842  |'    Dim dEnd        As Date     '計算期間　終了日
02870  |'    Dim sSql        As String                    ||02843  |'    Dim sSql        As String                    
02871  |'    Dim sCurrencyCode As String '通貨コード(SQL文||02844  |'    Dim sCurrencyCode As String '通貨コード(SQL文
02872  |'    Dim AccCode     As String   '口座コード(SQL文||02845  |'    Dim AccCode     As String   '口座コード(SQL文
02873  |'    Dim sDate       As Date     '支払予定日      ||02846  |'    Dim sDate       As Date     '支払予定日      
02874  |'    Dim sName       As String   '担当者名        ||02847  |'    Dim sName       As String   '担当者名        
02875  |'    Dim i           As Integer  'カウンター      ||02848  |'    Dim i           As Integer  'カウンター      
02876  |'    Dim ColNum      As Integer  '部署名コンボボッ||02849  |'    Dim ColNum      As Integer  '部署名コンボボッ
02877  |'    Dim ColWord     As String   '部署名コンボボッ||02850  |'    Dim ColWord     As String   '部署名コンボボッ
02878  |'    Dim iSyouhizei  As Long     '消費税          ||02851  |'    Dim iSyouhizei  As Long     '消費税          
02879  |'    Dim iRowCnt     As Long     '月末純資産データ||02852  |'    Dim iRowCnt     As Long     '月末純資産データ
02880  |'    Dim TotalNav    As Currency '累積NAV         ||02853  |'    Dim TotalNav    As Currency '累積NAV         
02881  |'    Dim TotalRate   As Currency '累積閾値        ||02854  |'    Dim TotalRate   As Currency '累積閾値        
02882  |'    Dim cRate       As Currency '料率            ||02855  |'    Dim cRate       As Currency '料率            
02883  |'    Dim WorkRate    As Currency '一つ前の累積閾値||02856  |'    Dim WorkRate    As Currency '一つ前の累積閾値
02884  |'    Dim TotalCom    As Currency '累積投資顧問料  ||02857  |'    Dim TotalCom    As Currency '累積投資顧問料  
02885  |'    Dim lTaxNum     As Currency '消費税値        ||02858  |'    Dim lTaxNum     As Currency '消費税値        
02886  |'    Dim lMonthlyPayCom As Currency  '月別支払額  ||02859  |'    Dim lMonthlyPayCom As Currency  '月別支払額  
02887  |'    Dim lCalcNav    As Currency '計算対象NAV     ||02860  |'    Dim lCalcNav    As Currency '計算対象NAV     
02888  |'    Dim iCalcNum    As Integer  '計算期間日数    ||02861  |'    Dim iCalcNum    As Integer  '計算期間日数    
02889  |'    'Excel の Application 変数とエラーをトラップ ||02862  |'    'Excel の Application 変数とエラーをトラップ 
02890  |'    Dim iTries      As Integer                   ||02863  |'    Dim iTries      As Integer                   
02891  |'    Dim strErrCall      As String 'エラー呼出元  ||02864  |'    Dim strErrCall      As String 'エラー呼出元  
02892  |'    Const conMeModule   As String = "fnblExcelOut||02865  |'    Const conMeModule   As String = "fnblExcelOut
02893  |'    'Excel の Worksheet 削除用カウンタ変数       ||02866  |'    'Excel の Worksheet 削除用カウンタ変数       
02894  |'    Dim Ws_Cnt      As Integer                   ||02867  |'    Dim Ws_Cnt      As Integer                   
02895  |'    Dim Ws_Del_Cnt  As Integer                   ||02868  |'    Dim Ws_Del_Cnt  As Integer                   
02896  |'    Dim Ws_Del_Cnt2 As Integer                   ||02869  |'    Dim Ws_Del_Cnt2 As Integer                   
02897  |''2004/09/21 Start                                ||02870  |''2004/09/21 Start                                
02898  |'    Dim ContNo      As String   '契約番号(SQL文作||02871  |'    Dim ContNo      As String   '契約番号(SQL文作
02899  |'    Dim NavGetCnt   As Long                      ||02872  |'    Dim NavGetCnt   As Long                      
02900  |'    Dim sGetAccCode As String                    ||02873  |'    Dim sGetAccCode As String                    
02901  |''2004/09/21 End                                  ||02874  |''2004/09/21 End                                  
02902  |''2004/09/28 Start                                ||02875  |''2004/09/28 Start                                
02903  |'    Dim Mnav_Flg    As String                    ||02876  |'    Dim Mnav_Flg    As String                    
02904  |''2004/09/28 End                                  ||02877  |''2004/09/28 End                                  
02905  |''2004/12/29 Start                                ||02878  |''2004/12/29 Start                                
02906  |'    Dim sStart As String            '計算対象　開||02879  |'    Dim sStart As String            '計算対象　開
02907  |'    Dim sEnd As String              '計算対象　終||02880  |'    Dim sEnd As String              '計算対象　終
02908  |'    Dim dstrBasedate As String      '基準日用ワー||02881  |'    Dim dstrBasedate As String      '基準日用ワー
02909  |'    Dim dstrCaldate() As String     'カレンダー日||02882  |'    Dim dstrCaldate() As String     'カレンダー日
02910  |'    Dim ddblDailynav() As Double    '日次NAV用格 ||02883  |'    Dim ddblDailynav() As Double    '日次NAV用格 
02911  |'    Dim dlngCnt As Long             '計算対象期間||02884  |'    Dim dlngCnt As Long             '計算対象期間
02912  |'    Dim dstrCaldate2 As String      'カレンダー日||02885  |'    Dim dstrCaldate2 As String      'カレンダー日
02913  |'    Dim dstrBasedate2 As String     '基準日(/編集||02886  |'    Dim dstrBasedate2 As String     '基準日(/編集
02914  |'    Dim dlngDiffdate As Long        'カレンダー日||02887  |'    Dim dlngDiffdate As Long        'カレンダー日
02915  |'    Dim dintFor As Integer          'For文用変数 ||02888  |'    Dim dintFor As Integer          'For文用変数 
02916  |'    Dim ddblTtalnav As Double       '日次NAV累積 ||02889  |'    Dim ddblTtalnav As Double       '日次NAV累積 
02917  |''2004/12/29 End                                  ||02890  |''2004/12/29 End                                  
02918  |''2005/01/06 Start                                ||02891  |''2005/01/06 Start                                
02919  |'    Dim dstrAvgNav As String                     ||02892  |'    Dim dstrAvgNav As String                     
02920  |''2005/01/06 End                                  ||02893  |''2005/01/06 End                                  
02921  |''2005/01/11 Start                                ||02894  |''2005/01/11 Start                                
02922  |'    Dim ddblNearNav As Double                    ||02895  |'    Dim ddblNearNav As Double                    
02923  |''2005/01/11 End                                  ||02896  |''2005/01/11 End                                  
02924  |''2005/01/12 Start                                ||02897  |''2005/01/12 Start                                
02925  |''''''Dim ddblShiharai As Double                  ||02898  |''''''Dim ddblShiharai As Double                  
02926  |''2005/01/12 End                                  ||02899  |''2005/01/12 End                                  
02927  |''2005/01/13 Start                                ||02900  |''2005/01/13 Start                                
02928  |'    Dim dstrAccCd() As String                    ||02901  |'    Dim dstrAccCd() As String                    
02929  |'    Dim dstrBsCCd() As String                    ||02902  |'    Dim dstrBsCCd() As String                    
02930  |'    Dim intRtn      As Integer                   ||02903  |'    Dim intRtn      As Integer                   
02931  |''2005/01/13 End                                  ||02904  |''2005/01/13 End                                  
02932  |''2005/01/17 Start                                ||02905  |''2005/01/17 Start                                
02933  |'    Dim dstrDate         As String               ||02906  |'    Dim dstrDate         As String               
02934  |'    Dim dstrCurrencyCode As String               ||02907  |'    Dim dstrCurrencyCode As String               
02935  |'    Dim ddblExchangeRate As Double               ||02908  |'    Dim ddblExchangeRate As Double               
02936  |''2005/01/17 End                                  ||02909  |''2005/01/17 End                                  
02937  |''2005/03/09 Start                                ||02910  |''2005/03/09 Start                                
02938  |'    Dim dintPage    As Integer                   ||02911  |'    Dim dintPage    As Integer                   
02939  |'    Dim dintPageIni As Integer                   ||02912  |'    Dim dintPageIni As Integer                   
02940  |'    Dim dintAmari   As Integer                   ||02913  |'    Dim dintAmari   As Integer                   
02941  |'    Dim dCalDate    As Date                      ||02914  |'    Dim dCalDate    As Date                      
02942  |'    Dim J           As Integer                   ||02915  |'    Dim J           As Integer                   
02943  |'    Dim K           As Integer                   ||02916  |'    Dim K           As Integer                   
02944  |'    Dim L           As Integer                   ||02917  |'    Dim L           As Integer                   
02945  |'    Dim AvgNav      As Currency                  ||02918  |'    Dim AvgNav      As Currency                  
02946  |'    Dim dintFor2    As Integer                   ||02919  |'    Dim dintFor2    As Integer                   
02947  |''2005/03/09 End                                  ||02920  |''2005/03/09 End                                  
02948  |''2005/03/18 Start                                ||02921  |''2005/03/18 Start                                
02949  |'    Dim dlngMeisyoSu As Integer                  ||02922  |'    Dim dlngMeisyoSu As Integer                  
02950  |''2005/03/18 End                                  ||02923  |''2005/03/18 End                                  
02951  |''2005/03/25 Start                                ||02924  |''2005/03/25 Start                                
02952  |'    Dim dlngCntsv As Long                        ||02925  |'    Dim dlngCntsv As Long                        
02953  |''2005/03/25 End                                  ||02926  |''2005/03/25 End                                  
02954  |'                                                 ||02927  |'                                                 
02955  |'    '2006/04/12 START K.Furuya 実払管理テーブル更||02928  |'    '2006/04/12 START K.Furuya 実払管理テーブル更
02956  |'    Dim WkContractNo        As String            ||02929  |'    Dim WkContractNo        As String            
02957  |'    Dim WkCurCode           As String            ||02930  |'    Dim WkCurCode           As String            
02958  |'    Dim WkSettlementDate    As String            ||02931  |'    Dim WkSettlementDate    As String            
02959  |'    Dim WkFixComC           As String            ||02932  |'    Dim WkFixComC           As String            
02960  |'    Dim WkFixComJ           As String            ||02933  |'    Dim WkFixComJ           As String            
02961  |'    Dim WkRealComC          As String            ||02934  |'    Dim WkRealComC          As String            
02962  |'    Dim WkRealComJ          As String            ||02935  |'    Dim WkRealComJ          As String            
02963  |'    '2006/04/12 END   K.Furuya 実払管理テーブル更||02936  |'    '2006/04/12 END   K.Furuya 実払管理テーブル更
02964  |'                                                 ||02937  |'                                                 
02965  |'    '戻り値初期化                                ||02938  |'    '戻り値初期化                                
02966  |'    fnblExcelOut = False                         ||02939  |'    fnblExcelOut = False                         
02967  |'    i = 0                                        ||02940  |'    i = 0                                        
02968  |'                                                 ||02941  |'                                                 
02969  |'On Error Resume Next                             ||02942  |'On Error Resume Next                             
02970  |'                                                 ||02943  |'                                                 
02971  |''    If gProcessCnt <> 1 Then                    ||02944  |''    If gProcessCnt <> 1 Then                    
02972  |''        '2回目以降はシートの追加                ||02945  |''        '2回目以降はシートの追加                
02973  |''        xlBook.Worksheets.Add after:=xlBook.Shee||02946  |''        xlBook.Worksheets.Add after:=xlBook.Shee
02974  |''    Else                                        ||02947  |''    Else                                        
02975  |''        '1回目はオブジェクトの設定              ||02948  |''        '1回目はオブジェクトの設定              
02976  |''        Set xlApp = CreateObject("Excel.Applicat||02949  |''        Set xlApp = CreateObject("Excel.Applicat
02977  |''        Set xlBook = xlApp.Workbooks.Add        ||02950  |''        Set xlBook = xlApp.Workbooks.Add        
02978  |''    End If                                      ||02951  |''    End If                                      
02979  |''    Set xlSheet = xlBook.Sheets(gProcessCnt)    ||02952  |''    Set xlSheet = xlBook.Sheets(gProcessCnt)    
02980  |'                                                 ||02953  |'                                                 
02981  |'    'Excelフォーマットを調整                     ||02954  |'    'Excelフォーマットを調整                     
02982  |'    xlSheet.Cells.ColumnWidth = 1                ||02955  |'    xlSheet.Cells.ColumnWidth = 1                
02983  |'    xlSheet.Cells.Font.Size = 11                 ||02956  |'    xlSheet.Cells.Font.Size = 11                 
02984  |'    'シート名を設定(確認書**)                    ||02957  |'    'シート名を設定(確認書**)                    
02985  |''2005/03/09 Start                                ||02958  |''2005/03/09 Start                                
02986  |''    xlBook.Sheets(gProcessCnt).Name = sWord33 & ||02959  |''    xlBook.Sheets(gProcessCnt).Name = sWord33 & 
02987  |'    xlBook.Sheets(gProcessCnt).Name = sWord33 & (||02960  |'    xlBook.Sheets(gProcessCnt).Name = sWord33 & (
02988  |''2005/03/09 End                                  ||02961  |''2005/03/09 End                                  
02989  |'    'シートの余白を設定                          ||02962  |'    'シートの余白を設定                          
02990  |'    xlSheet.PageSetup.TopMargin = Application.Inc||02963  |'    xlSheet.PageSetup.TopMargin = Application.Inc
02991  |'    xlSheet.PageSetup.BottomMargin = Application.||02964  |'    xlSheet.PageSetup.BottomMargin = Application.
02992  |''2005/01/20 Start                                ||02965  |''2005/01/20 Start                                
02993  |'    xlSheet.PageSetup.LeftMargin = Application.In||02966  |'    xlSheet.PageSetup.LeftMargin = Application.In
02994  |''    xlSheet.PageSetup.LeftMargin = Application.I||02967  |''    xlSheet.PageSetup.LeftMargin = Application.I
02995  |''2005/01/20 End                                  ||02968  |''2005/01/20 End                                  
02996  |''2005/01/20 Start                                ||02969  |''2005/01/20 Start                                
02997  |''    xlSheet.PageSetup.RightMargin = Application.||02970  |''    xlSheet.PageSetup.RightMargin = Application.
02998  |'    xlSheet.PageSetup.RightMargin = Application.I||02971  |'    xlSheet.PageSetup.RightMargin = Application.I
02999  |''2005/01/20 End                                  ||02972  |''2005/01/20 End                                  
03000  |'                                                 ||02973  |'                                                 
03001  |'    '総計の出力処理カウンターアップ              ||02974  |'    '総計の出力処理カウンターアップ              
03002  |'    gTotalProcessCnt = gTotalProcessCnt + 1      ||02975  |'    gTotalProcessCnt = gTotalProcessCnt + 1      
03003  |'                                                 ||02976  |'                                                 
03004  |'    DoEvents                                     ||02977  |'    DoEvents                                     
03005  |'    With xlSheet                                 ||02978  |'    With xlSheet                                 
03006  |'        '題目                                    ||02979  |'        '題目                                    
03007  |''2004/09/01 Start                                ||02980  |''2004/09/01 Start                                
03008  |''        Select Case gbuMGetUPDRec.N(lRecIdx).MGE||02981  |''        Select Case gbuMGetUPDRec.N(lRecIdx).MGE
03009  |''            Case mstrContractFlag(1)            ||02982  |''            Case mstrContractFlag(1)            
03010  |''                .Cells(5, 1).Value = sWord0a    ||02983  |''                .Cells(5, 1).Value = sWord0a    
03011  |''            Case mstrContractFlag(2)            ||02984  |''            Case mstrContractFlag(2)            
03012  |''                .Cells(5, 1).Value = sWord0b    ||02985  |''                .Cells(5, 1).Value = sWord0b    
03013  |''            Case mstrContractFlag(3)            ||02986  |''            Case mstrContractFlag(3)            
03014  |''                .Cells(5, 1).Value = sWord0c    ||02987  |''                .Cells(5, 1).Value = sWord0c    
03015  |''            Case Else                           ||02988  |''            Case Else                           
03016  |''                MsgBox "契約区分が変です。", vbC||02989  |''                MsgBox "契約区分が変です。", vbC
03017  |''        End Select                              ||02990  |''        End Select                              
03018  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).||02991  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).
03019  |'            Case Mid(mstrContractFlag(1), 1, 1)  ||02992  |'            Case Mid(mstrContractFlag(1), 1, 1)  
03020  |'                .Cells(5, 1).Value = sWord0a     ||02993  |'                .Cells(5, 1).Value = sWord0a     
03021  |'            Case Mid(mstrContractFlag(2), 1, 1)  ||02994  |'            Case Mid(mstrContractFlag(2), 1, 1)  
03022  |'                .Cells(5, 1).Value = sWord0b     ||02995  |'                .Cells(5, 1).Value = sWord0b     
03023  |'            Case Mid(mstrContractFlag(3), 1, 1)  ||02996  |'            Case Mid(mstrContractFlag(3), 1, 1)  
03024  |'                .Cells(5, 1).Value = sWord0c     ||02997  |'                .Cells(5, 1).Value = sWord0c     
03025  |'            Case Else                            ||02998  |'            Case Else                            
03026  |'                MsgBox "契約区分が不正です。", vb||02999  |'                MsgBox "契約区分が不正です。", vb
03027  |'        End Select                               ||03000  |'        End Select                               
03028  |''2004/09/01 Start                                ||03001  |''2004/09/01 Start                                
03029  |'        .Cells(5, 1).Font.Size = 14              ||03002  |'        .Cells(5, 1).Font.Size = 14              
03030  |''2005/01/12 Start                                ||03003  |''2005/01/12 Start                                
03031  |''        .Range("A5:BE5").HorizontalAlignment = x||03004  |''        .Range("A5:BE5").HorizontalAlignment = x
03032  |''2005/01/20 Start                                ||03005  |''2005/01/20 Start                                
03033  |''        .Range("A5:BF5").HorizontalAlignment = x||03006  |''        .Range("A5:BF5").HorizontalAlignment = x
03034  |''        .Range("A5:BD5").HorizontalAlignment = x||03007  |''        .Range("A5:BD5").HorizontalAlignment = x
03035  |'        .Range("A5:BG5").HorizontalAlignment = xl||03008  |'        .Range("A5:BG5").HorizontalAlignment = xl
03036  |''2005/01/20 End                                  ||03009  |''2005/01/20 End                                  
03037  |''2005/01/12 End                                  ||03010  |''2005/01/12 End                                  
03038  |'        '出力日付                                ||03011  |'        '出力日付                                
03039  |'        If RTrim(txtSysOutDate.Text) = "" Then   ||03012  |'        If RTrim(txtSysOutDate.Text) = "" Then   
03040  |''2005/01/12 Start                                ||03013  |''2005/01/12 Start                                
03041  |''            .Cells(3, 54).Value = sWord34       ||03014  |''            .Cells(3, 54).Value = sWord34       
03042  |''            .Cells(3, 54).HorizontalAlignment = ||03015  |''            .Cells(3, 54).HorizontalAlignment = 
03043  |''        Else                                    ||03016  |''        Else                                    
03044  |''            .Cells(3, 45).Value = CStr(Format(tx||03017  |''            .Cells(3, 45).Value = CStr(Format(tx
03045  |'            .Cells(3, 50).Value = sWord34        ||03018  |'            .Cells(3, 50).Value = sWord34        
03046  |'            .Cells(3, 50).HorizontalAlignment = x||03019  |'            .Cells(3, 50).HorizontalAlignment = x
03047  |'        Else                                     ||03020  |'        Else                                     
03048  |'            .Cells(3, 43).Value = CStr(Format(txt||03021  |'            .Cells(3, 43).Value = CStr(Format(txt
03049  |''2005/01/12 End                                  ||03022  |''2005/01/12 End                                  
03050  |'        End If                                   ||03023  |'        End If                                   
03051  |'        '財務部　担当者                          ||03024  |'        '財務部　担当者                          
03052  |'        sName = RTrim(txtInputName.Text)         ||03025  |'        sName = RTrim(txtInputName.Text)         
03053  |'        '財務部                                  ||03026  |'        '財務部                                  
03054  |''2005/01/12 Start                                ||03027  |''2005/01/12 Start                                
03055  |''        .Cells(7, 39).Value = sWord1            ||03028  |''        .Cells(7, 39).Value = sWord1            
03056  |''        .Cells(8, 41).Value = sWord2 & sName    ||03029  |''        .Cells(8, 41).Value = sWord2 & sName    
03057  |'        .Cells(7, 37).Value = sWord1             ||03030  |'        .Cells(7, 37).Value = sWord1             
03058  |'        .Cells(8, 39).Value = sWord2 & sName     ||03031  |'        .Cells(8, 39).Value = sWord2 & sName     
03059  |''2005/01/12 End                                  ||03032  |''2005/01/12 End                                  
03060  |'        '下記のとおり･･･                         ||03033  |'        '下記のとおり･･･                         
03061  |''2004/11/10 Start                                ||03034  |''2004/11/10 Start                                
03062  |''        .Cells(10, 2).Value = sWord3            ||03035  |''        .Cells(10, 2).Value = sWord3            
03063  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).||03036  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).
03064  |'            Case Mid(mstrContractFlag(1), 1, 1)  ||03037  |'            Case Mid(mstrContractFlag(1), 1, 1)  
03065  |'                .Cells(10, 2).Value = sWord3a    ||03038  |'                .Cells(10, 2).Value = sWord3a    
03066  |'            Case Mid(mstrContractFlag(2), 1, 1)  ||03039  |'            Case Mid(mstrContractFlag(2), 1, 1)  
03067  |'                .Cells(10, 2).Value = sWord3b    ||03040  |'                .Cells(10, 2).Value = sWord3b    
03068  |'            Case Mid(mstrContractFlag(3), 1, 1)  ||03041  |'            Case Mid(mstrContractFlag(3), 1, 1)  
03069  |'                .Cells(10, 2).Value = sWord3c    ||03042  |'                .Cells(10, 2).Value = sWord3c    
03070  |'            Case Else                            ||03043  |'            Case Else                            
03071  |'        End Select                               ||03044  |'        End Select                               
03072  |''2004/11/10 End                                  ||03045  |''2004/11/10 End                                  
03073  |'        'ファンド名                              ||03046  |'        'ファンド名                              
03074  |''2005/03/09 Start                                ||03047  |''2005/03/09 Start                                
03075  |''        .Cells(13, 2).Value = sWord4            ||03048  |''        .Cells(13, 2).Value = sWord4            
03076  |'        .Cells(12, 2).Value = sWord4             ||03049  |'        .Cells(12, 2).Value = sWord4             
03077  |''2005/03/09 End                                  ||03050  |''2005/03/09 End                                  
03078  |''2004/09/10 Start                                ||03051  |''2004/09/10 Start                                
03079  |''        .Cells(13, 10).Value = sWord19          ||03052  |''        .Cells(13, 10).Value = sWord19          
03080  |''2005/03/09 Start                                ||03053  |''2005/03/09 Start                                
03081  |'''2005/01/12 Start                               ||03054  |'''2005/01/12 Start                               
03082  |'''        .Cells(13, 11).Value = sWord19         ||03055  |'''        .Cells(13, 11).Value = sWord19         
03083  |'''        .Cells(13, 9).Value = sWord19          ||03056  |'''        .Cells(13, 9).Value = sWord19          
03084  |'''2005/01/12 End                                 ||03057  |'''2005/01/12 End                                 
03085  |'        .Cells(12, 11).Value = sWord19           ||03058  |'        .Cells(12, 11).Value = sWord19           
03086  |''2005/03/09 End                                  ||03059  |''2005/03/09 End                                  
03087  |''2004/09/10 End                                  ||03060  |''2004/09/10 End                                  
03088  |''2005/03/09 Start                                ||03061  |''2005/03/09 Start                                
03089  |'''2005/01/12 Start                               ||03062  |'''2005/01/12 Start                               
03090  |''        .Cells(13, 13).Value = gbuMGetUPDRec.N(l||03063  |''        .Cells(13, 13).Value = gbuMGetUPDRec.N(l
03091  |'''        .Cells(13, 11).Value = gbuMGetUPDRec.N(||03064  |'''        .Cells(13, 11).Value = gbuMGetUPDRec.N(
03092  |'''2005/01/12 End                                 ||03065  |'''2005/01/12 End                                 
03093  |'        .Cells(12, 13).Value = gbuMGetUPDRec.N(lR||03066  |'        .Cells(12, 13).Value = gbuMGetUPDRec.N(lR
03094  |''2005/03/09 End                                  ||03067  |''2005/03/09 End                                  
03095  |''2005/03/09 Start                                ||03068  |''2005/03/09 Start                                
03096  |''2004/09/10 Start                                ||03069  |''2004/09/10 Start                                
03097  |''        'ファンドコード                         ||03070  |''        'ファンドコード                         
03098  |''        .Cells(14, 2).Value = sWord4_2          ||03071  |''        .Cells(14, 2).Value = sWord4_2          
03099  |'''2005/01/12 Start                               ||03072  |'''2005/01/12 Start                               
03100  |''        .Cells(14, 11).Value = sWord19          ||03073  |''        .Cells(14, 11).Value = sWord19          
03101  |''        .Cells(14, 13).NumberFormatLocal = "@"  ||03074  |''        .Cells(14, 13).NumberFormatLocal = "@"  
03102  |'        'ファンドコード                          ||03075  |'        'ファンドコード                          
03103  |'        .Cells(13, 2).Value = sWord4_2           ||03076  |'        .Cells(13, 2).Value = sWord4_2           
03104  |'        .Cells(13, 11).Value = sWord19           ||03077  |'        .Cells(13, 11).Value = sWord19           
03105  |'        .Cells(13, 13).NumberFormatLocal = "@"   ||03078  |'        .Cells(13, 13).NumberFormatLocal = "@"   
03106  |''2005/03/09 End                                  ||03079  |''2005/03/09 End                                  
03107  |''        .Cells(14, 9).Value = sWord19           ||03080  |''        .Cells(14, 9).Value = sWord19           
03108  |''        .Cells(14, 11).NumberFormatLocal = "@"  ||03081  |''        .Cells(14, 11).NumberFormatLocal = "@"  
03109  |''2005/01/12 End                                  ||03082  |''2005/01/12 End                                  
03110  |''        .Cells(14, 13).Value = gbuMGetUPDRec.N(l||03083  |''        .Cells(14, 13).Value = gbuMGetUPDRec.N(l
03111  |''2004/09/10 End                                  ||03084  |''2004/09/10 End                                  
03112  |''2004/09/21 Start                                ||03085  |''2004/09/21 Start                                
03113  |'        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_co||03086  |'        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_co
03114  |'        sSql = gstrEditSQLcfr_NavGetForSelectList||03087  |'        sSql = gstrEditSQLcfr_NavGetForSelectList
03115  |'        'ﾀﾞｲﾅｾｯﾄの作成                           ||03088  |'        'ﾀﾞｲﾅｾｯﾄの作成                           
03116  |'        If gintDyCreate(sSql) = False Then       ||03089  |'        If gintDyCreate(sSql) = False Then       
03117  |'            Exit Function                        ||03090  |'            Exit Function                        
03118  |'        End If                                   ||03091  |'        End If                                   
03119  |'                                                 ||03092  |'                                                 
03120  |'        '2006/04/12 START K.Furuya 実払管理テーブ||03093  |'        '2006/04/12 START K.Furuya 実払管理テーブ
03121  |'        '契約番号を取得                          ||03094  |'        '契約番号を取得                          
03122  |'        WkContractNo = ""                        ||03095  |'        WkContractNo = ""                        
03123  |'        WkContractNo = ContNo                    ||03096  |'        WkContractNo = ContNo                    
03124  |'        '2006/04/12 END   K.Furuya 実払管理テーブ||03097  |'        '2006/04/12 END   K.Furuya 実払管理テーブ
03125  |'                                                 ||03098  |'                                                 
03126  |'        Do Until gblnDyEOF()                     ||03099  |'        Do Until gblnDyEOF()                     
03127  |'            '動的配列更新                        ||03100  |'            '動的配列更新                        
03128  |'            ReDim Preserve gtypcfr_navget_tbl(0 T||03101  |'            ReDim Preserve gtypcfr_navget_tbl(0 T
03129  |''2005/01/13 Start                                ||03102  |''2005/01/13 Start                                
03130  |'            ReDim Preserve dstrAccCd(0 To NavGetC||03103  |'            ReDim Preserve dstrAccCd(0 To NavGetC
03131  |''2005/01/13 End                                  ||03104  |''2005/01/13 End                                  
03132  |'            'NAV取得抽出                         ||03105  |'            'NAV取得抽出                         
03133  |'            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT||03106  |'            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT
03134  |'            If NavGetCnt > 0 Then                ||03107  |'            If NavGetCnt > 0 Then                
03135  |'                sGetAccCode = sGetAccCode & " , "||03108  |'                sGetAccCode = sGetAccCode & " , "
03136  |'            Else                                 ||03109  |'            Else                                 
03137  |'                sGetAccCode = sGetAccCode & gtypc||03110  |'                sGetAccCode = sGetAccCode & gtypc
03138  |'            End If                               ||03111  |'            End If                               
03139  |''2005/01/13 Start                                ||03112  |''2005/01/13 Start                                
03140  |'            '口座コードの格納(１契約複数口座の場 ||03113  |'            '口座コードの格納(１契約複数口座の場 
03141  |'            dstrAccCd(NavGetCnt) = gtypcfr_navget||03114  |'            dstrAccCd(NavGetCnt) = gtypcfr_navget
03142  |''2005/01/13 End                                  ||03115  |''2005/01/13 End                                  
03143  |'            NavGetCnt = NavGetCnt + 1            ||03116  |'            NavGetCnt = NavGetCnt + 1            
03144  |'            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                    ||03117  |'            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                    
03145  |'            Call gDyNext                         ||03118  |'            Call gDyNext                         
03146  |'        Loop                                     ||03119  |'        Loop                                     
03147  |'        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                        ||03120  |'        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                        
03148  |'        Call gblnDyClose                         ||03121  |'        Call gblnDyClose                         
03149  |''2005/01/13 Start                                ||03122  |''2005/01/13 Start                                
03150  |'        '１契約複数口座の場合に口座のベース通貨に||03123  |'        '１契約複数口座の場合に口座のベース通貨に
03151  |'        ReDim dstrBsCCd(0 To NavGetCnt - 1)      ||03124  |'        ReDim dstrBsCCd(0 To NavGetCnt - 1)      
03152  |'        If NavGetCnt - 1 > 0 Then                ||03125  |'        If NavGetCnt - 1 > 0 Then                
03153  |'            For dintFor = 0 To NavGetCnt - 1     ||03126  |'            For dintFor = 0 To NavGetCnt - 1     
03154  |'                sSql = ""                        ||03127  |'                sSql = ""                        
03155  |'                sSql = sSql & "SELECT ACCOUNT_COD||03128  |'                sSql = sSql & "SELECT ACCOUNT_COD
03156  |'                sSql = sSql & "WHERE ACCOUNT_CODE||03129  |'                sSql = sSql & "WHERE ACCOUNT_CODE
03157  |'                'ﾀﾞｲﾅｾｯﾄの作成                   ||03130  |'                'ﾀﾞｲﾅｾｯﾄの作成                   
03158  |'                If gintDyCreate(sSql) = False The||03131  |'                If gintDyCreate(sSql) = False The
03159  |'                    Exit Function                ||03132  |'                    Exit Function                
03160  |'                Else                             ||03133  |'                Else                             
03161  |'                    dstrBsCCd(dintFor) = gvlnDyDa||03134  |'                    dstrBsCCd(dintFor) = gvlnDyDa
03162  |'                End If                           ||03135  |'                End If                           
03163  |'                If dintFor > 0 Then              ||03136  |'                If dintFor > 0 Then              
03164  |'                    If dstrBsCCd(dintFor) <> dstr||03137  |'                    If dstrBsCCd(dintFor) <> dstr
03165  |'                        intRtn = MsgBox("ファンド||03138  |'                        intRtn = MsgBox("ファンド
03166  |'                        Exit Function            ||03139  |'                        Exit Function            
03167  |'                    End If                       ||03140  |'                    End If                       
03168  |'                End If                           ||03141  |'                End If                           
03169  |'            Next dintFor                         ||03142  |'            Next dintFor                         
03170  |'                                                 ||03143  |'                                                 
03171  |'        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                        ||03144  |'        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                        
03172  |'        Call gblnDyClose                         ||03145  |'        Call gblnDyClose                         
03173  |'                                                 ||03146  |'                                                 
03174  |'        End If                                   ||03147  |'        End If                                   
03175  |'        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                        ||03148  |'        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                        
03176  |''        Call gblnDyClose                        ||03149  |''        Call gblnDyClose                        
03177  |''2005/01/13 End                                  ||03150  |''2005/01/13 End                                  
03178  |''2005/03/09 Start                                ||03151  |''2005/03/09 Start                                
03179  |'''2005/01/12 Start                               ||03152  |'''2005/01/12 Start                               
03180  |''        .Cells(14, 13).Value = sGetAccCode      ||03153  |''        .Cells(14, 13).Value = sGetAccCode      
03181  |'''        .Cells(14, 11).Value = sGetAccCode     ||03154  |'''        .Cells(14, 11).Value = sGetAccCode     
03182  |'''2005/01/12 End                                 ||03155  |'''2005/01/12 End                                 
03183  |'''2004/09/21 End                                 ||03156  |'''2004/09/21 End                                 
03184  |'        .Cells(13, 13).Value = sGetAccCode       ||03157  |'        .Cells(13, 13).Value = sGetAccCode       
03185  |''2005/03/09 End                                  ||03158  |''2005/03/09 End                                  
03186  |'                                                 ||03159  |'                                                 
03187  |''2005/03/09 Start                                ||03160  |''2005/03/09 Start                                
03188  |''        '計算期間                               ||03161  |''        '計算期間                               
03189  |''        .Cells(16, 2).Value = sWord5            ||03162  |''        .Cells(16, 2).Value = sWord5            
03190  |'''2004/09/10 Start                               ||03163  |'''2004/09/10 Start                               
03191  |'''        .Cells(16, 10).Value = sWord19         ||03164  |'''        .Cells(16, 10).Value = sWord19         
03192  |'''2005/01/12 Start                               ||03165  |'''2005/01/12 Start                               
03193  |''        .Cells(16, 11).Value = sWord19          ||03166  |''        .Cells(16, 11).Value = sWord19          
03194  |'''        .Cells(16, 9).Value = sWord19          ||03167  |'''        .Cells(16, 9).Value = sWord19          
03195  |'''2005/01/12 End                                 ||03168  |'''2005/01/12 End                                 
03196  |'''2004/09/10 End                                 ||03169  |'''2004/09/10 End                                 
03197  |'        '計算期間                                ||03170  |'        '計算期間                                
03198  |'        .Cells(15, 2).Value = sWord5             ||03171  |'        .Cells(15, 2).Value = sWord5             
03199  |'        .Cells(15, 11).Value = sWord19           ||03172  |'        .Cells(15, 11).Value = sWord19           
03200  |''2005/03/09 End                                  ||03173  |''2005/03/09 End                                  
03201  |'        '前回締日・直近締日セット                ||03174  |'        '前回締日・直近締日セット                
03202  |'        dStart = CDate(gstrDateFormat(mstrSettlem||03175  |'        dStart = CDate(gstrDateFormat(mstrSettlem
03203  |'        dEnd = CDate(gstrDateFormat(mstrNearSettl||03176  |'        dEnd = CDate(gstrDateFormat(mstrNearSettl
03204  |''2005/01/17 Start                                ||03177  |''2005/01/17 Start                                
03205  |'        dstrDate = Replace(CStr(dEnd), "/", "")  ||03178  |'        dstrDate = Replace(CStr(dEnd), "/", "")  
03206  |'                                                 ||03179  |'                                                 
03207  |'        '2006/04/12 START K.Furuya 実払管理テーブ||03180  |'        '2006/04/12 START K.Furuya 実払管理テーブ
03208  |'        '締日を取得                              ||03181  |'        '締日を取得                              
03209  |'        WkSettlementDate = ""                    ||03182  |'        WkSettlementDate = ""                    
03210  |'        WkSettlementDate = dstrDate              ||03183  |'        WkSettlementDate = dstrDate              
03211  |'        '2006/04/12 END   K.Furuya 実払管理テーブ||03184  |'        '2006/04/12 END   K.Furuya 実払管理テーブ
03212  |'                                                 ||03185  |'                                                 
03213  |''2005/01/17 End                                  ||03186  |''2005/01/17 End                                  
03214  |''2005/03/09 Start                                ||03187  |''2005/03/09 Start                                
03215  |'''2005/01/12 Start                               ||03188  |'''2005/01/12 Start                               
03216  |''        .Cells(16, 13).Value = _                ||03189  |''        .Cells(16, 13).Value = _                
03217  |''            CStr(Format(dStart, "YYYY年M月D日"))||03190  |''            CStr(Format(dStart, "YYYY年M月D日"))
03218  |''            CStr(Format(dEnd, "YYYY年M月D日")) &||03191  |''            CStr(Format(dEnd, "YYYY年M月D日")) &
03219  |''            (DateDiff("d", dStart, dEnd) + 1) & ||03192  |''            (DateDiff("d", dStart, dEnd) + 1) & 
03220  |'''        .Cells(16, 11).Value = _               ||03193  |'''        .Cells(16, 11).Value = _               
03221  |'''            CStr(Format(dStart, "YYYY年M月D日")||03194  |'''            CStr(Format(dStart, "YYYY年M月D日")
03222  |'''            CStr(Format(dEnd, "YYYY年M月D日")) ||03195  |'''            CStr(Format(dEnd, "YYYY年M月D日")) 
03223  |'''            (DateDiff("d", dStart, dEnd) + 1) &||03196  |'''            (DateDiff("d", dStart, dEnd) + 1) &
03224  |'''2005/01/12 End                                 ||03197  |'''2005/01/12 End                                 
03225  |''2005/03/18 Start                                ||03198  |''2005/03/18 Start                                
03226  |''        .Cells(15, 13).Value = _                ||03199  |''        .Cells(15, 13).Value = _                
03227  |''            CStr(Format(dStart, "YYYY年M月D日"))||03200  |''            CStr(Format(dStart, "YYYY年M月D日"))
03228  |''2005/03/18 End                                  ||03201  |''2005/03/18 End                                  
03229  |''2005/03/09 End                                  ||03202  |''2005/03/09 End                                  
03230  |'        iCalcNum = DateDiff("d", dStart, dEnd) + ||03203  |'        iCalcNum = DateDiff("d", dStart, dEnd) + 
03231  |'                                                 ||03204  |'                                                 
03232  |''2005/03/09 Start                                ||03205  |''2005/03/09 Start                                
03233  |'        '純資産総額                              ||03206  |'        '純資産総額                              
03234  |'        .Cells(17, 2).Value = sWord50            ||03207  |'        .Cells(17, 2).Value = sWord50            
03235  |'        .Cells(17, 11).Value = sWord19           ||03208  |'        .Cells(17, 11).Value = sWord19           
03236  |''2005/03/09 End                                  ||03209  |''2005/03/09 End                                  
03237  |'                                                 ||03210  |'                                                 
03238  |'    '月末純資産                                  ||03211  |'    '月末純資産                                  
03239  |'        .Cells(19, 2).Value = sWord6             ||03212  |'        .Cells(19, 2).Value = sWord6             
03240  |''2004/09/10 Start                                ||03213  |''2004/09/10 Start                                
03241  |''        .Cells(19, 10).Value = sWord19          ||03214  |''        .Cells(19, 10).Value = sWord19          
03242  |''2005/01/12 Start                                ||03215  |''2005/01/12 Start                                
03243  |'        .Cells(19, 11).Value = sWord19           ||03216  |'        .Cells(19, 11).Value = sWord19           
03244  |''        .Cells(19, 9).Value = sWord19           ||03217  |''        .Cells(19, 9).Value = sWord19           
03245  |''2005/01/12 End                                  ||03218  |''2005/01/12 End                                  
03246  |''2004/09/10 End                                  ||03219  |''2004/09/10 End                                  
03247  |''2005/01/12 Start                                ||03220  |''2005/01/12 Start                                
03248  |'        '純資産                                  ||03221  |'        '純資産                                  
03249  |'        .Cells(19, 26).Value = sWord8            ||03222  |'        .Cells(19, 26).Value = sWord8            
03250  |''        .Range("Z19:AM19").HorizontalAlignment =||03223  |''        .Range("Z19:AM19").HorizontalAlignment =
03251  |'        .Range("Z19:AN19").HorizontalAlignment = ||03224  |'        .Range("Z19:AN19").HorizontalAlignment = 
03252  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ ||03225  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ 
03253  |'        '合計(純資産)                            ||03226  |'        '合計(純資産)                            
03254  |'        .Cells(33, 14).Value = sWord9            ||03227  |'        .Cells(33, 14).Value = sWord9            
03255  |'        .Range("N33:Y33").HorizontalAlignment = x||03228  |'        .Range("N33:Y33").HorizontalAlignment = x
03256  |''2005/03/09 End @@@@@ 合計行を出力しないならここ ||03229  |''2005/03/09 End @@@@@ 合計行を出力しないならここ 
03257  |'        '日付                                    ||03230  |'        '日付                                    
03258  |'        .Cells(19, 14).Value = sWord7            ||03231  |'        .Cells(19, 14).Value = sWord7            
03259  |'        .Range("N19:Y19").HorizontalAlignment = x||03232  |'        .Range("N19:Y19").HorizontalAlignment = x
03260  |''        '純資産                                 ||03233  |''        '純資産                                 
03261  |''        .Cells(19, 24).Value = sWord8           ||03234  |''        .Cells(19, 24).Value = sWord8           
03262  |''        .Range("X19:AL19").HorizontalAlignment =||03235  |''        .Range("X19:AL19").HorizontalAlignment =
03263  |''        '合計(純資産)                           ||03236  |''        '合計(純資産)                           
03264  |''        .Cells(33, 12).Value = sWord9           ||03237  |''        .Cells(33, 12).Value = sWord9           
03265  |''        .Range("L33:W33").HorizontalAlignment = ||03238  |''        .Range("L33:W33").HorizontalAlignment = 
03266  |''        '日付                                   ||03239  |''        '日付                                   
03267  |''        .Cells(19, 12).Value = sWord7           ||03240  |''        .Cells(19, 12).Value = sWord7           
03268  |''        .Range("L19:W19").HorizontalAlignment = ||03241  |''        .Range("L19:W19").HorizontalAlignment = 
03269  |'                                                 ||03242  |'                                                 
03270  |''2005/01/17 Start                                ||03243  |''2005/01/17 Start                                
03271  |''        '換算元                                 ||03244  |''        '換算元                                 
03272  |''        .Cells(19, 40).Value = sWord36          ||03245  |''        .Cells(19, 40).Value = sWord36          
03273  |''        .Range("AN19:AT19").HorizontalAlignment ||03246  |''        .Range("AN19:AT19").HorizontalAlignment 
03274  |''        '換算先                                 ||03247  |''        '換算先                                 
03275  |''        .Cells(19, 47).Value = sWord37          ||03248  |''        .Cells(19, 47).Value = sWord37          
03276  |''        .Range("AU19:BA19").HorizontalAlignment ||03249  |''        .Range("AU19:BA19").HorizontalAlignment 
03277  |''        '換算元(通貨)                           ||03250  |''        '換算元(通貨)                           
03278  |''        .Cells(20, 40).Value = sWord38          ||03251  |''        .Cells(20, 40).Value = sWord38          
03279  |''        .Range("AN20:AT20").HorizontalAlignment ||03252  |''        .Range("AN20:AT20").HorizontalAlignment 
03280  |''        '換算先(通貨)                           ||03253  |''        '換算先(通貨)                           
03281  |''        .Cells(20, 47).Value = sWord38          ||03254  |''        .Cells(20, 47).Value = sWord38          
03282  |''        .Range("AU20:BA20").HorizontalAlignment ||03255  |''        .Range("AU20:BA20").HorizontalAlignment 
03283  |''        'レート                                 ||03256  |''        'レート                                 
03284  |''        .Cells(20, 54).Value = sWord45          ||03257  |''        .Cells(20, 54).Value = sWord45          
03285  |''        .Range("BB20:BF20").HorizontalAlignment ||03258  |''        .Range("BB20:BF20").HorizontalAlignment 
03286  |''                                                ||03259  |''                                                
03287  |''        'NAV通貨→閾値通貨(NAV通貨)             ||03260  |''        'NAV通貨→閾値通貨(NAV通貨)             
03288  |''        .Cells(21, 40).Value = sWord39          ||03261  |''        .Cells(21, 40).Value = sWord39          
03289  |''        .Range("AN21:AT21").HorizontalAlignment ||03262  |''        .Range("AN21:AT21").HorizontalAlignment 
03290  |''        'NAV通貨→閾値通貨(閾値通貨)            ||03263  |''        'NAV通貨→閾値通貨(閾値通貨)            
03291  |''        .Cells(21, 47).Value = sWord40          ||03264  |''        .Cells(21, 47).Value = sWord40          
03292  |''        .Range("AU21:BA21").HorizontalAlignment ||03265  |''        .Range("AU21:BA21").HorizontalAlignment 
03293  |''        'NAV通貨→閾値通貨(NAV通貨)             ||03266  |''        'NAV通貨→閾値通貨(NAV通貨)             
03294  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_base_cu||03267  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_base_cu
03295  |''            .Cells(22, 42).Value = sWord43 & gbu||03268  |''            .Cells(22, 42).Value = sWord43 & gbu
03296  |'''            .Range("AN22:AT22").HorizontalAlign||03269  |'''            .Range("AN22:AT22").HorizontalAlign
03297  |''        Else                                    ||03270  |''        Else                                    
03298  |''            .Cells(22, 42).Value = ""           ||03271  |''            .Cells(22, 42).Value = ""           
03299  |'''            .Range("AN22:AT22").HorizontalAlign||03272  |'''            .Range("AN22:AT22").HorizontalAlign
03300  |''        End If                                  ||03273  |''        End If                                  
03301  |''        'NAV通貨→閾値通貨(閾値通貨)            ||03274  |''        'NAV通貨→閾値通貨(閾値通貨)            
03302  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_amount_||03275  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_amount_
03303  |''            .Cells(22, 49).Value = sWord43 & gbu||03276  |''            .Cells(22, 49).Value = sWord43 & gbu
03304  |'''            .Range("AU22:BA22").HorizontalAlign||03277  |'''            .Range("AU22:BA22").HorizontalAlign
03305  |''        Else                                    ||03278  |''        Else                                    
03306  |''            .Cells(22, 49).Value = ""           ||03279  |''            .Cells(22, 49).Value = ""           
03307  |'''            .Range("AU22:BA22").HorizontalAlign||03280  |'''            .Range("AU22:BA22").HorizontalAlign
03308  |''        End If                                  ||03281  |''        End If                                  
03309  |''        'NAV通貨→閾値通貨(レート)              ||03282  |''        'NAV通貨→閾値通貨(レート)              
03310  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_NavAmou||03283  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_NavAmou
03311  |''            .Cells(22, 58).NumberFormatLocal = "||03284  |''            .Cells(22, 58).NumberFormatLocal = "
03312  |''            .Cells(22, 58).Value = Format(gbuMGe||03285  |''            .Cells(22, 58).Value = Format(gbuMGe
03313  |''            .Cells(22, 58).HorizontalAlignment =||03286  |''            .Cells(22, 58).HorizontalAlignment =
03314  |'''            .Range("BB22:BF22").HorizontalAlign||03287  |'''            .Range("BB22:BF22").HorizontalAlign
03315  |''        Else                                    ||03288  |''        Else                                    
03316  |''            .Cells(22, 58).NumberFormatLocal = "||03289  |''            .Cells(22, 58).NumberFormatLocal = "
03317  |''            .Cells(22, 58).Value = ""           ||03290  |''            .Cells(22, 58).Value = ""           
03318  |''            .Cells(22, 58).HorizontalAlignment =||03291  |''            .Cells(22, 58).HorizontalAlignment =
03319  |'''            .Range("BB22:BF22").HorizontalAlign||03292  |'''            .Range("BB22:BF22").HorizontalAlign
03320  |''        End If                                  ||03293  |''        End If                                  
03321  |''                                                ||03294  |''                                                
03322  |''        'NAV通貨→顧問料通貨(NAV通貨)           ||03295  |''        'NAV通貨→顧問料通貨(NAV通貨)           
03323  |''        .Cells(23, 40).Value = sWord39          ||03296  |''        .Cells(23, 40).Value = sWord39          
03324  |''        .Range("AN23:AT23").HorizontalAlignment ||03297  |''        .Range("AN23:AT23").HorizontalAlignment 
03325  |''        'NAV通貨→顧問料通貨(顧問料通貨)        ||03298  |''        'NAV通貨→顧問料通貨(顧問料通貨)        
03326  |''        .Cells(23, 47).Value = sWord41          ||03299  |''        .Cells(23, 47).Value = sWord41          
03327  |''        .Range("AU23:BA23").HorizontalAlignment ||03300  |''        .Range("AU23:BA23").HorizontalAlignment 
03328  |''        'NAV通貨→顧問料通貨(NAV通貨)           ||03301  |''        'NAV通貨→顧問料通貨(NAV通貨)           
03329  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_base_cu||03302  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_base_cu
03330  |''            .Cells(24, 42).Value = sWord43 & gbu||03303  |''            .Cells(24, 42).Value = sWord43 & gbu
03331  |'''            .Range("AN24:AT24").HorizontalAlign||03304  |'''            .Range("AN24:AT24").HorizontalAlign
03332  |''        Else                                    ||03305  |''        Else                                    
03333  |''            .Cells(24, 42).Value = ""           ||03306  |''            .Cells(24, 42).Value = ""           
03334  |'''            .Range("AN24:AT24").HorizontalAlign||03307  |'''            .Range("AN24:AT24").HorizontalAlign
03335  |''        End If                                  ||03308  |''        End If                                  
03336  |''        'NAV通貨→顧問料通貨(顧問料通貨)        ||03309  |''        'NAV通貨→顧問料通貨(顧問料通貨)        
03337  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_other_c||03310  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_other_c
03338  |''            .Cells(24, 49).Value = sWord43 & gbu||03311  |''            .Cells(24, 49).Value = sWord43 & gbu
03339  |'''            .Range("AU24:BA24").HorizontalAlign||03312  |'''            .Range("AU24:BA24").HorizontalAlign
03340  |''        Else                                    ||03313  |''        Else                                    
03341  |''            .Cells(24, 49).Value = ""           ||03314  |''            .Cells(24, 49).Value = ""           
03342  |'''            .Range("AU24:BA24").HorizontalAlign||03315  |'''            .Range("AU24:BA24").HorizontalAlign
03343  |''        End If                                  ||03316  |''        End If                                  
03344  |''        'NAV通貨→顧問料通貨(レート)            ||03317  |''        'NAV通貨→顧問料通貨(レート)            
03345  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_NavCom ||03318  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_NavCom 
03346  |''            .Cells(24, 58).NumberFormatLocal = "||03319  |''            .Cells(24, 58).NumberFormatLocal = "
03347  |''            .Cells(24, 58).Value = Format(gbuMGe||03320  |''            .Cells(24, 58).Value = Format(gbuMGe
03348  |''            .Cells(24, 58).HorizontalAlignment =||03321  |''            .Cells(24, 58).HorizontalAlignment =
03349  |'''            .Range("BB24:BF24").HorizontalAlign||03322  |'''            .Range("BB24:BF24").HorizontalAlign
03350  |''        Else                                    ||03323  |''        Else                                    
03351  |''            .Cells(24, 58).NumberFormatLocal = "||03324  |''            .Cells(24, 58).NumberFormatLocal = "
03352  |''            .Cells(24, 58).Value = ""           ||03325  |''            .Cells(24, 58).Value = ""           
03353  |''            .Cells(24, 58).HorizontalAlignment =||03326  |''            .Cells(24, 58).HorizontalAlignment =
03354  |'''            .Range("BB24:BF24").HorizontalAlign||03327  |'''            .Range("BB24:BF24").HorizontalAlign
03355  |''        End If                                  ||03328  |''        End If                                  
03356  |''                                                ||03329  |''                                                
03357  |''        '閾値通貨→顧問料通貨(閾値通貨)         ||03330  |''        '閾値通貨→顧問料通貨(閾値通貨)         
03358  |''        .Cells(25, 40).Value = sWord40          ||03331  |''        .Cells(25, 40).Value = sWord40          
03359  |''        .Range("AN25:AT25").HorizontalAlignment ||03332  |''        .Range("AN25:AT25").HorizontalAlignment 
03360  |''        '閾値通貨→顧問料通貨(顧問料通貨)       ||03333  |''        '閾値通貨→顧問料通貨(顧問料通貨)       
03361  |''        .Cells(25, 47).Value = sWord41          ||03334  |''        .Cells(25, 47).Value = sWord41          
03362  |''        .Range("AU25:BA25").HorizontalAlignment ||03335  |''        .Range("AU25:BA25").HorizontalAlignment 
03363  |''        '閾値通貨→顧問料通貨(閾値通貨)         ||03336  |''        '閾値通貨→顧問料通貨(閾値通貨)         
03364  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_amount_||03337  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_amount_
03365  |''            .Cells(26, 42).Value = sWord43 & gbu||03338  |''            .Cells(26, 42).Value = sWord43 & gbu
03366  |'''            .Range("AN26:AT26").HorizontalAlign||03339  |'''            .Range("AN26:AT26").HorizontalAlign
03367  |''        Else                                    ||03340  |''        Else                                    
03368  |''            .Cells(26, 42).Value = ""           ||03341  |''            .Cells(26, 42).Value = ""           
03369  |'''            .Range("AN26:AT26").HorizontalAlign||03342  |'''            .Range("AN26:AT26").HorizontalAlign
03370  |''        End If                                  ||03343  |''        End If                                  
03371  |''        '閾値通貨→顧問料通貨(顧問料通貨)       ||03344  |''        '閾値通貨→顧問料通貨(顧問料通貨)       
03372  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_other_c||03345  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_other_c
03373  |''            .Cells(26, 49).Value = sWord43 & gbu||03346  |''            .Cells(26, 49).Value = sWord43 & gbu
03374  |'''            .Range("AU26:BA26").HorizontalAlign||03347  |'''            .Range("AU26:BA26").HorizontalAlign
03375  |''        Else                                    ||03348  |''        Else                                    
03376  |''            .Cells(26, 49).Value = ""           ||03349  |''            .Cells(26, 49).Value = ""           
03377  |'''            .Range("AU26:BA26").HorizontalAlign||03350  |'''            .Range("AU26:BA26").HorizontalAlign
03378  |''        End If                                  ||03351  |''        End If                                  
03379  |''        '閾値通貨→顧問料通貨(レート)           ||03352  |''        '閾値通貨→顧問料通貨(レート)           
03380  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_AmountC||03353  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_AmountC
03381  |''            .Cells(26, 58).NumberFormatLocal = "||03354  |''            .Cells(26, 58).NumberFormatLocal = "
03382  |''            .Cells(26, 58).Value = Format(gbuMGe||03355  |''            .Cells(26, 58).Value = Format(gbuMGe
03383  |''            .Cells(26, 58).HorizontalAlignment =||03356  |''            .Cells(26, 58).HorizontalAlignment =
03384  |'''            .Range("BB26:BF26").HorizontalAlign||03357  |'''            .Range("BB26:BF26").HorizontalAlign
03385  |''        Else                                    ||03358  |''        Else                                    
03386  |''            .Cells(26, 58).NumberFormatLocal = "||03359  |''            .Cells(26, 58).NumberFormatLocal = "
03387  |''            .Cells(26, 58).Value = ""           ||03360  |''            .Cells(26, 58).Value = ""           
03388  |''            .Cells(26, 58).HorizontalAlignment =||03361  |''            .Cells(26, 58).HorizontalAlignment =
03389  |'''            .Range("BB26:BF26").HorizontalAlign||03362  |'''            .Range("BB26:BF26").HorizontalAlign
03390  |''        End If                                  ||03363  |''        End If                                  
03391  |''                                                ||03364  |''                                                
03392  |''        '顧問料通貨→支払通貨(顧問料通貨)       ||03365  |''        '顧問料通貨→支払通貨(顧問料通貨)       
03393  |''        .Cells(27, 40).Value = sWord41          ||03366  |''        .Cells(27, 40).Value = sWord41          
03394  |''        .Range("AN27:AT27").HorizontalAlignment ||03367  |''        .Range("AN27:AT27").HorizontalAlignment 
03395  |''        '顧問料通貨→支払通貨(支払通貨)         ||03368  |''        '顧問料通貨→支払通貨(支払通貨)         
03396  |''        .Cells(27, 47).Value = sWord42          ||03369  |''        .Cells(27, 47).Value = sWord42          
03397  |''        .Range("AU27:BA27").HorizontalAlignment ||03370  |''        .Range("AU27:BA27").HorizontalAlignment 
03398  |''        '顧問料通貨→支払通貨(顧問料通貨)       ||03371  |''        '顧問料通貨→支払通貨(顧問料通貨)       
03399  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_other_c||03372  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_other_c
03400  |''            .Cells(28, 42).Value = sWord43 & gbu||03373  |''            .Cells(28, 42).Value = sWord43 & gbu
03401  |'''            .Range("AN28:AT28").HorizontalAlign||03374  |'''            .Range("AN28:AT28").HorizontalAlign
03402  |''        Else                                    ||03375  |''        Else                                    
03403  |''            .Cells(28, 42).Value = ""           ||03376  |''            .Cells(28, 42).Value = ""           
03404  |'''            .Range("AN28:AT28").HorizontalAlign||03377  |'''            .Range("AN28:AT28").HorizontalAlign
03405  |''        End If                                  ||03378  |''        End If                                  
03406  |''        '顧問料通貨→支払通貨(支払通貨)         ||03379  |''        '顧問料通貨→支払通貨(支払通貨)         
03407  |''        .Cells(28, 49).Value = sWord43 & "JPY" &||03380  |''        .Cells(28, 49).Value = sWord43 & "JPY" &
03408  |'''        .Range("AU28:BA28").HorizontalAlignment||03381  |'''        .Range("AU28:BA28").HorizontalAlignment
03409  |''        '顧問料通貨→支払通貨(レート)           ||03382  |''        '顧問料通貨→支払通貨(レート)           
03410  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_ComPay ||03383  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_ComPay 
03411  |''            .Cells(28, 58).NumberFormatLocal = "||03384  |''            .Cells(28, 58).NumberFormatLocal = "
03412  |''            .Cells(28, 58).Value = Format(gbuMGe||03385  |''            .Cells(28, 58).Value = Format(gbuMGe
03413  |''            .Cells(28, 58).HorizontalAlignment =||03386  |''            .Cells(28, 58).HorizontalAlignment =
03414  |'''            .Range("BB28:BF28").HorizontalAlign||03387  |'''            .Range("BB28:BF28").HorizontalAlign
03415  |''        Else                                    ||03388  |''        Else                                    
03416  |''            .Cells(28, 58).NumberFormatLocal = "||03389  |''            .Cells(28, 58).NumberFormatLocal = "
03417  |''            .Cells(28, 58).Value = ""           ||03390  |''            .Cells(28, 58).Value = ""           
03418  |''            .Cells(28, 58).HorizontalAlignment =||03391  |''            .Cells(28, 58).HorizontalAlignment =
03419  |'''            .Range("BB28:BF28").HorizontalAlign||03392  |'''            .Range("BB28:BF28").HorizontalAlign
03420  |''        End If                                  ||03393  |''        End If                                  
03421  |''2005/01/17 End                                  ||03394  |''2005/01/17 End                                  
03422  |'                                                 ||03395  |'                                                 
03423  |''2005/01/12 End                                  ||03396  |''2005/01/12 End                                  
03424  |'        iRowCnt = 0                              ||03397  |'        iRowCnt = 0                              
03425  |'        TotalNav = 0                             ||03398  |'        TotalNav = 0                             
03426  |''2004/09/28 Start                                ||03399  |''2004/09/28 Start                                
03427  |'        Mnav_Flg = 0                             ||03400  |'        Mnav_Flg = 0                             
03428  |''2004/09/28 End                                  ||03401  |''2004/09/28 End                                  
03429  |'                                                 ||03402  |'                                                 
03430  |''2005/03/09 Start                                ||03403  |''2005/03/09 Start                                
03431  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_contrac||03404  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_contrac
03432  |''        '契約区分「1」or「2」                   ||03405  |''        '契約区分「1」or「2」                   
03433  |''        '契約区分「1」or「2」or (「3」and 取得NA||03406  |''        '契約区分「1」or「2」or (「3」and 取得NA
03434  |''2005/03/25 Start                                ||03407  |''2005/03/25 Start                                
03435  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_contrac||03408  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_contrac
03436  |''        Or gbuMGetUPDRec.N(lRecIdx).MGET_contrac||03409  |''        Or gbuMGetUPDRec.N(lRecIdx).MGET_contrac
03437  |''        Or (gbuMGetUPDRec.N(lRecIdx).MGET_contra||03410  |''        Or (gbuMGetUPDRec.N(lRecIdx).MGET_contra
03438  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||03411  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
03439  |'        Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||03412  |'        Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
03440  |'        Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_con||03413  |'        Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_con
03441  |''2005/03/25 End                                  ||03414  |''2005/03/25 End                                  
03442  |''2005/03/09 End                                  ||03415  |''2005/03/09 End                                  
03443  |''2004/12/29 Start                                ||03416  |''2004/12/29 Start                                
03444  |''        '月次NAVを累積                          ||03417  |''        '月次NAVを累積                          
03445  |''          For i = LBound(gtypcfr_mnav_tbl) To UB||03418  |''          For i = LBound(gtypcfr_mnav_tbl) To UB
03446  |''          '2004/09/28 Start                     ||03419  |''          '2004/09/28 Start                     
03447  |'''              '日付                            ||03420  |'''              '日付                            
03448  |'''              .Cells(20 + i, 15).Value = _     ||03421  |'''              .Cells(20 + i, 15).Value = _     
03449  |'''                  Mid(gtypcfr_mnav_tbl(i).base_||03422  |'''                  Mid(gtypcfr_mnav_tbl(i).base_
03450  |'''                      WordYear & CInt(Mid(gtypc||03423  |'''                      WordYear & CInt(Mid(gtypc
03451  |'''              '純資産                          ||03424  |'''              '純資産                          
03452  |'''              .Cells(20 + i, 37).NumberFormatLo||03425  |'''              .Cells(20 + i, 37).NumberFormatLo
03453  |'''              .Cells(20 + i, 37).Value = CStr(F||03426  |'''              .Cells(20 + i, 37).Value = CStr(F
03454  |'''              .Cells(20 + i, 37).HorizontalAlig||03427  |'''              .Cells(20 + i, 37).HorizontalAlig
03455  |'''              TotalNav = TotalNav + CCur(gtypcf||03428  |'''              TotalNav = TotalNav + CCur(gtypcf
03456  |'''              iRowCnt = iRowCnt + 1            ||03429  |'''              iRowCnt = iRowCnt + 1            
03457  |''              If Len(gtypcfr_mnav_tbl(i).base_mo||03430  |''              If Len(gtypcfr_mnav_tbl(i).base_mo
03458  |''                '日付                           ||03431  |''                '日付                           
03459  |''                .Cells(20 + i, 15).Value = _    ||03432  |''                .Cells(20 + i, 15).Value = _    
03460  |''                    Mid(gtypcfr_mnav_tbl(i).base||03433  |''                    Mid(gtypcfr_mnav_tbl(i).base
03461  |''                        WordYear & CInt(Mid(gtyp||03434  |''                        WordYear & CInt(Mid(gtyp
03462  |''                '純資産                         ||03435  |''                '純資産                         
03463  |''                .Cells(20 + i, 37).NumberFormatL||03436  |''                .Cells(20 + i, 37).NumberFormatL
03464  |''                .Cells(20 + i, 37).Value = CStr(||03437  |''                .Cells(20 + i, 37).Value = CStr(
03465  |''                .Cells(20 + i, 37).HorizontalAli||03438  |''                .Cells(20 + i, 37).HorizontalAli
03466  |''                TotalNav = TotalNav + CCur(gtypc||03439  |''                TotalNav = TotalNav + CCur(gtypc
03467  |''                iRowCnt = iRowCnt + 1           ||03440  |''                iRowCnt = iRowCnt + 1           
03468  |''              Else                              ||03441  |''              Else                              
03469  |''                Mnav_Flg = 1                    ||03442  |''                Mnav_Flg = 1                    
03470  |''              End If                            ||03443  |''              End If                            
03471  |''          '2004/09/28 End                       ||03444  |''          '2004/09/28 End                       
03472  |''          Next i                                ||03445  |''          Next i                                
03473  |''        '日次NAVを算出                          ||03446  |''        '日次NAVを算出                          
03474  |''        '2004/09/28 Start                       ||03447  |''        '2004/09/28 Start                       
03475  |''          If Mnav_Flg = 1 Then                  ||03448  |''          If Mnav_Flg = 1 Then                  
03476  |''            i = i - 1                           ||03449  |''            i = i - 1                           
03477  |''          End If                                ||03450  |''          End If                                
03478  |''        '2004/09/28 End                         ||03451  |''        '2004/09/28 End                         
03479  |''          If mstrDailyNav <> "" Then            ||03452  |''          If mstrDailyNav <> "" Then            
03480  |''              '日付                             ||03453  |''              '日付                             
03481  |''              .Cells(20 + i, 15).Value = CStr(Fo||03454  |''              .Cells(20 + i, 15).Value = CStr(Fo
03482  |''              '純資産                           ||03455  |''              '純資産                           
03483  |''              .Cells(20 + i, 37).NumberFormatLoc||03456  |''              .Cells(20 + i, 37).NumberFormatLoc
03484  |''              .Cells(20 + i, 37).Value = CStr(Fo||03457  |''              .Cells(20 + i, 37).Value = CStr(Fo
03485  |''              .Cells(20 + i, 37).HorizontalAlign||03458  |''              .Cells(20 + i, 37).HorizontalAlign
03486  |''              TotalNav = TotalNav + CCur(mstrDai||03459  |''              TotalNav = TotalNav + CCur(mstrDai
03487  |''              iRowCnt = iRowCnt + 1             ||03460  |''              iRowCnt = iRowCnt + 1             
03488  |''          End If                                ||03461  |''          End If                                
03489  |''          '対象締日データ抽出                   ||03462  |''          '対象締日データ抽出                   
03490  |''          .Cells(20, 37).NumberFormatLocal = "@"||03463  |''          .Cells(20, 37).NumberFormatLocal = "@"
03491  |''          .Cells(20, 37).Value = CStr(Format(Tot||03464  |''          .Cells(20, 37).Value = CStr(Format(Tot
03492  |''          .Cells(20, 37).HorizontalAlignment = x||03465  |''          .Cells(20, 37).HorizontalAlignment = x
03493  |''          '合計(月末純資産)                     ||03466  |''          '合計(月末純資産)                     
03494  |''          .Cells(33, 37).NumberFormatLocal = "@"||03467  |''          .Cells(33, 37).NumberFormatLocal = "@"
03495  |''          .Cells(33, 37).Value = CStr(Format(Tot||03468  |''          .Cells(33, 37).Value = CStr(Format(Tot
03496  |''          .Cells(33, 37).HorizontalAlignment = x||03469  |''          .Cells(33, 37).HorizontalAlignment = x
03497  |''          '計算期間の純資産総額の合計(月末純資産||03470  |''          '計算期間の純資産総額の合計(月末純資産
03498  |''          .Cells(36, 23).NumberFormatLocal = "@"||03471  |''          .Cells(36, 23).NumberFormatLocal = "@"
03499  |''          .Cells(36, 23).Value = CStr(Format(Tot||03472  |''          .Cells(36, 23).Value = CStr(Format(Tot
03500  |''          .Cells(36, 23).HorizontalAlignment = x||03473  |''          .Cells(36, 23).HorizontalAlignment = x
03501  |''          '計算期間の純資産総額の合計÷計算期間 ||03474  |''          '計算期間の純資産総額の合計÷計算期間 
03502  |''          .Cells(36, 35).NumberFormatLocal = "@"||03475  |''          .Cells(36, 35).NumberFormatLocal = "@"
03503  |'''2004/11/17 Start                               ||03476  |'''2004/11/17 Start                               
03504  |'''          .Cells(35, 35).NumberFormatLocal = "@||03477  |'''          .Cells(35, 35).NumberFormatLocal = "@
03505  |'''          .Cells(35, 35).Value = CStr(Format(To||03478  |'''          .Cells(35, 35).Value = CStr(Format(To
03506  |'''          .Cells(36, 35).Value = CStr(Format(Ro||03479  |'''          .Cells(36, 35).Value = CStr(Format(Ro
03507  |''          dblValueIn = TotalNav / iRowCnt       ||03480  |''          dblValueIn = TotalNav / iRowCnt       
03508  |''          Call sbGetRoundValue(dblValueIn)      ||03481  |''          Call sbGetRoundValue(dblValueIn)      
03509  |''          .Cells(36, 35).Value = CStr(Format(dbl||03482  |''          .Cells(36, 35).Value = CStr(Format(dbl
03510  |'''2004/11/17 End                                 ||03483  |'''2004/11/17 End                                 
03511  |''          '÷??＝                               ||03484  |''          '÷??＝                               
03512  |''          .Cells(36, 26).Value = sWord18 & "   "||03485  |''          .Cells(36, 26).Value = sWord18 & "   "
03513  |''2005/03/09 Start                                ||03486  |''2005/03/09 Start                                
03514  |''            Select Case gbuMGetUPDRec.N(lRecIdx)||03487  |''            Select Case gbuMGetUPDRec.N(lRecIdx)
03515  |''                '契約区分：外部委託顧問料計算   ||03488  |''                '契約区分：外部委託顧問料計算   
03516  |''                Case mstrContractFlag(1)        ||03489  |''                Case mstrContractFlag(1)        
03517  |''2005/03/09 End                                  ||03490  |''2005/03/09 End                                  
03518  |'                    '月末NAV取得                 ||03491  |'                    '月末NAV取得                 
03519  |'                    If gbuMGetUPDRec.N(lRecIdx).M||03492  |'                    If gbuMGetUPDRec.N(lRecIdx).M
03520  |'                        '月次NAVを累積           ||03493  |'                        '月次NAVを累積           
03521  |'                          For i = LBound(gtypcfr_||03494  |'                          For i = LBound(gtypcfr_
03522  |'                          '2004/09/28 Start      ||03495  |'                          '2004/09/28 Start      
03523  |'                '              '日付             ||03496  |'                '              '日付             
03524  |'                '              .Cells(20 + i, 15)||03497  |'                '              .Cells(20 + i, 15)
03525  |'                '                  Mid(gtypcfr_mn||03498  |'                '                  Mid(gtypcfr_mn
03526  |'                '                      WordYear &||03499  |'                '                      WordYear &
03527  |'                '              '純資産           ||03500  |'                '              '純資産           
03528  |'                '              .Cells(20 + i, 37)||03501  |'                '              .Cells(20 + i, 37)
03529  |'                '              .Cells(20 + i, 37)||03502  |'                '              .Cells(20 + i, 37)
03530  |'                '              .Cells(20 + i, 37)||03503  |'                '              .Cells(20 + i, 37)
03531  |'                '              TotalNav = TotalNa||03504  |'                '              TotalNav = TotalNa
03532  |'                '              iRowCnt = iRowCnt ||03505  |'                '              iRowCnt = iRowCnt 
03533  |'                              If Len(gtypcfr_mnav||03506  |'                              If Len(gtypcfr_mnav
03534  |''2005/01/12 Start                                ||03507  |''2005/01/12 Start                                
03535  |'                                '日付            ||03508  |'                                '日付            
03536  |'                                .Cells(20 + i, 15||03509  |'                                .Cells(20 + i, 15
03537  |'                                        WordYear ||03510  |'                                        WordYear 
03538  |''                                '純資産         ||03511  |''                                '純資産         
03539  |''                                .Cells(20 + i, 3||03512  |''                                .Cells(20 + i, 3
03540  |'''2005/01/11 Start                               ||03513  |'''2005/01/11 Start                               
03541  |'''                                .Cells(20 + i, ||03514  |'''                                .Cells(20 + i, 
03542  |''                                .Cells(20 + i, 3||03515  |''                                .Cells(20 + i, 3
03543  |'''2005/01/11 End                                 ||03516  |'''2005/01/11 End                                 
03544  |''                                .Cells(20 + i, 3||03517  |''                                .Cells(20 + i, 3
03545  |''                                '日付           ||03518  |''                                '日付           
03546  |''                                .Cells(20 + i, 1||03519  |''                                .Cells(20 + i, 1
03547  |''                                    Mid(gtypcfr_||03520  |''                                    Mid(gtypcfr_
03548  |''                                        WordYear||03521  |''                                        WordYear
03549  |'                                '純資産          ||03522  |'                                '純資産          
03550  |''2005/01/13 Start                                ||03523  |''2005/01/13 Start                                
03551  |''                                .Cells(20 + i, 4||03524  |''                                .Cells(20 + i, 4
03552  |''                                .Cells(20 + i, 3||03525  |''                                .Cells(20 + i, 3
03553  |'                                .Cells(20 + i, 39||03526  |'                                .Cells(20 + i, 39
03554  |''2005/01/13 End                                  ||03527  |''2005/01/13 End                                  
03555  |''2005/01/11 Start                                ||03528  |''2005/01/11 Start                                
03556  |''                                .Cells(20 + i, 4||03529  |''                                .Cells(20 + i, 4
03557  |''                                .Cells(20 + i, 3||03530  |''                                .Cells(20 + i, 3
03558  |''2005/01/20 Start                                ||03531  |''2005/01/20 Start                                
03559  |''                                .Cells(20 + i, 3||03532  |''                                .Cells(20 + i, 3
03560  |'                                If gbuMGetUPDRec.||03533  |'                                If gbuMGetUPDRec.
03561  |'                                    .Cells(20 + i||03534  |'                                    .Cells(20 + i
03562  |'                                Else             ||03535  |'                                Else             
03563  |'                                    .Cells(20 + i||03536  |'                                    .Cells(20 + i
03564  |'                                End If           ||03537  |'                                End If           
03565  |''2005/01/20 End                                  ||03538  |''2005/01/20 End                                  
03566  |''2005/01/11 End                                  ||03539  |''2005/01/11 End                                  
03567  |''                                .Cells(20 + i, 4||03540  |''                                .Cells(20 + i, 4
03568  |''                                .Cells(20 + i, 3||03541  |''                                .Cells(20 + i, 3
03569  |'                                .Cells(20 + i, 39||03542  |'                                .Cells(20 + i, 39
03570  |''2005/01/12 End                                  ||03543  |''2005/01/12 End                                  
03571  |'                                TotalNav = TotalN||03544  |'                                TotalNav = TotalN
03572  |'                                iRowCnt = iRowCnt||03545  |'                                iRowCnt = iRowCnt
03573  |'                              Else               ||03546  |'                              Else               
03574  |'                                Mnav_Flg = 1     ||03547  |'                                Mnav_Flg = 1     
03575  |'                              End If             ||03548  |'                              End If             
03576  |'                          '2004/09/28 End        ||03549  |'                          '2004/09/28 End        
03577  |'                          Next i                 ||03550  |'                          Next i                 
03578  |'                        '日次NAVを算出           ||03551  |'                        '日次NAVを算出           
03579  |'                        '2004/09/28 Start        ||03552  |'                        '2004/09/28 Start        
03580  |'                          If Mnav_Flg = 1 Then   ||03553  |'                          If Mnav_Flg = 1 Then   
03581  |'                            i = i - 1            ||03554  |'                            i = i - 1            
03582  |'                          End If                 ||03555  |'                          End If                 
03583  |'                        '2004/09/28 End          ||03556  |'                        '2004/09/28 End          
03584  |'                          If mstrDailyNav <> "" T||03557  |'                          If mstrDailyNav <> "" T
03585  |''2005/01/12 Start                                ||03558  |''2005/01/12 Start                                
03586  |'                              '日付              ||03559  |'                              '日付              
03587  |'                              .Cells(20 + i, 15).||03560  |'                              .Cells(20 + i, 15).
03588  |''                              '純資産           ||03561  |''                              '純資産           
03589  |''                              .Cells(20 + i, 37)||03562  |''                              .Cells(20 + i, 37)
03590  |'''2005/01/11 Start                               ||03563  |'''2005/01/11 Start                               
03591  |'''                              .Cells(20 + i, 37||03564  |'''                              .Cells(20 + i, 37
03592  |''                              .Cells(20 + i, 37)||03565  |''                              .Cells(20 + i, 37)
03593  |'''2005/01/11 End                                 ||03566  |'''2005/01/11 End                                 
03594  |''                              .Cells(20 + i, 37)||03567  |''                              .Cells(20 + i, 37)
03595  |''                              '日付             ||03568  |''                              '日付             
03596  |''                              .Cells(20 + i, 13)||03569  |''                              .Cells(20 + i, 13)
03597  |'                              '純資産            ||03570  |'                              '純資産            
03598  |''                              .Cells(20 + i, 47)||03571  |''                              .Cells(20 + i, 47)
03599  |''                              .Cells(20 + i, 37)||03572  |''                              .Cells(20 + i, 37)
03600  |'                              .Cells(20 + i, 39).||03573  |'                              .Cells(20 + i, 39).
03601  |''2005/01/11 Start                                ||03574  |''2005/01/11 Start                                
03602  |''                              .Cells(20 + i, 47)||03575  |''                              .Cells(20 + i, 47)
03603  |''                              .Cells(20 + i, 37)||03576  |''                              .Cells(20 + i, 37)
03604  |''2005/01/20 Start                                ||03577  |''2005/01/20 Start                                
03605  |''                              .Cells(20 + i, 39)||03578  |''                              .Cells(20 + i, 39)
03606  |'                                If gbuMGetUPDRec.||03579  |'                                If gbuMGetUPDRec.
03607  |'                                    .Cells(20 + i||03580  |'                                    .Cells(20 + i
03608  |'                                Else             ||03581  |'                                Else             
03609  |'                                    .Cells(20 + i||03582  |'                                    .Cells(20 + i
03610  |'                                End If           ||03583  |'                                End If           
03611  |''2005/01/20 End                                  ||03584  |''2005/01/20 End                                  
03612  |''2005/01/11 End                                  ||03585  |''2005/01/11 End                                  
03613  |''                              .Cells(20 + i, 47)||03586  |''                              .Cells(20 + i, 47)
03614  |''                              .Cells(20 + i, 37)||03587  |''                              .Cells(20 + i, 37)
03615  |'                              .Cells(20 + i, 39).||03588  |'                              .Cells(20 + i, 39).
03616  |''2005/01/12 End                                  ||03589  |''2005/01/12 End                                  
03617  |'                              TotalNav = TotalNav||03590  |'                              TotalNav = TotalNav
03618  |'                              iRowCnt = iRowCnt +||03591  |'                              iRowCnt = iRowCnt +
03619  |'                          End If                 ||03592  |'                          End If                 
03620  |''2005/01/12 Start                                ||03593  |''2005/01/12 Start                                
03621  |''                          '合計(月末純資産)     ||03594  |''                          '合計(月末純資産)     
03622  |''                          .Cells(33, 37).NumberF||03595  |''                          .Cells(33, 37).NumberF
03623  |'''2005/01/11 Start                               ||03596  |'''2005/01/11 Start                               
03624  |'''                          .Cells(33, 37).Value ||03597  |'''                          .Cells(33, 37).Value 
03625  |''                          .Cells(33, 37).Value =||03598  |''                          .Cells(33, 37).Value =
03626  |'''2005/01/11 End                                 ||03599  |'''2005/01/11 End                                 
03627  |''                          .Cells(33, 37).Horizon||03600  |''                          .Cells(33, 37).Horizon
03628  |''                          '計算期間の純資産総額 ||03601  |''                          '計算期間の純資産総額 
03629  |''                          .Cells(36, 23).NumberF||03602  |''                          .Cells(36, 23).NumberF
03630  |'''2005/01/11 Start                               ||03603  |'''2005/01/11 Start                               
03631  |'''                          .Cells(36, 23).Value ||03604  |'''                          .Cells(36, 23).Value 
03632  |''                          .Cells(36, 23).Value =||03605  |''                          .Cells(36, 23).Value =
03633  |'''2005/01/11 End                                 ||03606  |'''2005/01/11 End                                 
03634  |''                          .Cells(36, 23).Horizon||03607  |''                          .Cells(36, 23).Horizon
03635  |''                          '計算期間の純資産総額 ||03608  |''                          '計算期間の純資産総額 
03636  |''                          .Cells(36, 35).NumberF||03609  |''                          .Cells(36, 35).NumberF
03637  |'                          '合計(月末純資産)      ||03610  |'                          '合計(月末純資産)      
03638  |''                          .Cells(33, 47).NumberF||03611  |''                          .Cells(33, 47).NumberF
03639  |''                          .Cells(33, 37).NumberF||03612  |''                          .Cells(33, 37).NumberF
03640  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ ||03613  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ 
03641  |'                          .Cells(33, 39).NumberFo||03614  |'                          .Cells(33, 39).NumberFo
03642  |''2005/03/09 End @@@@@ 合計行を出力しないならここ ||03615  |''2005/03/09 End @@@@@ 合計行を出力しないならここ 
03643  |''2005/03/09 Start                                ||03616  |''2005/03/09 Start                                
03644  |'                          .Cells(17, 23).NumberFo||03617  |'                          .Cells(17, 23).NumberFo
03645  |''2005/03/09 End                                  ||03618  |''2005/03/09 End                                  
03646  |''2005/01/11 Start                                ||03619  |''2005/01/11 Start                                
03647  |''                          .Cells(33, 47).Value =||03620  |''                          .Cells(33, 47).Value =
03648  |''                          .Cells(33, 37).Value =||03621  |''                          .Cells(33, 37).Value =
03649  |''2005/01/20 Start                                ||03622  |''2005/01/20 Start                                
03650  |''                          .Cells(33, 39).Value =||03623  |''                          .Cells(33, 39).Value =
03651  |'                            If gbuMGetUPDRec.N(lR||03624  |'                            If gbuMGetUPDRec.N(lR
03652  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ ||03625  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ 
03653  |'                                .Cells(33, 39).Va||03626  |'                                .Cells(33, 39).Va
03654  |''2005/03/09 End @@@@@ 合計行を出力しないならここ ||03627  |''2005/03/09 End @@@@@ 合計行を出力しないならここ 
03655  |''2005/03/09 Start                                ||03628  |''2005/03/09 Start                                
03656  |'                                .Cells(17, 23).Va||03629  |'                                .Cells(17, 23).Va
03657  |''2005/03/09 End                                  ||03630  |''2005/03/09 End                                  
03658  |'                            Else                 ||03631  |'                            Else                 
03659  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ ||03632  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ 
03660  |'                                .Cells(33, 39).Va||03633  |'                                .Cells(33, 39).Va
03661  |''2005/03/09 End @@@@@ 合計行を出力しないならここ ||03634  |''2005/03/09 End @@@@@ 合計行を出力しないならここ 
03662  |''2005/03/09 Start                                ||03635  |''2005/03/09 Start                                
03663  |'                                .Cells(17, 23).Va||03636  |'                                .Cells(17, 23).Va
03664  |''2005/03/09 End                                  ||03637  |''2005/03/09 End                                  
03665  |'                            End If               ||03638  |'                            End If               
03666  |''2005/01/20 End                                  ||03639  |''2005/01/20 End                                  
03667  |''2005/01/11 End                                  ||03640  |''2005/01/11 End                                  
03668  |''                          .Cells(33, 47).Horizon||03641  |''                          .Cells(33, 47).Horizon
03669  |''                          .Cells(33, 37).Horizon||03642  |''                          .Cells(33, 37).Horizon
03670  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ ||03643  |''2005/03/09 Start @@@@@ 合計行を出力しないならこ 
03671  |'                          .Cells(33, 39).Horizont||03644  |'                          .Cells(33, 39).Horizont
03672  |''2005/03/09 End @@@@@ 合計行を出力しないならここ ||03645  |''2005/03/09 End @@@@@ 合計行を出力しないならここ 
03673  |''2005/03/09 Start                                ||03646  |''2005/03/09 Start                                
03674  |'                          .Cells(17, 23).Horizont||03647  |'                          .Cells(17, 23).Horizont
03675  |''2005/03/09 End                                  ||03648  |''2005/03/09 End                                  
03676  |''2005/03/09 Start                                ||03649  |''2005/03/09 Start                                
03677  |'                        '平均純資産総額          ||03650  |'                        '平均純資産総額          
03678  |'                        .Cells(36, 2).Value = sWo||03651  |'                        .Cells(36, 2).Value = sWo
03679  |'                        .Cells(36, 11).Value = sW||03652  |'                        .Cells(36, 11).Value = sW
03680  |''2005/03/09 End                                  ||03653  |''2005/03/09 End                                  
03681  |'                          '計算期間の純資産総額の||03654  |'                          '計算期間の純資産総額の
03682  |''                          .Cells(36, 21).NumberF||03655  |''                          .Cells(36, 21).NumberF
03683  |'                          .Cells(36, 23).NumberFo||03656  |'                          .Cells(36, 23).NumberFo
03684  |''2005/01/11 Start                                ||03657  |''2005/01/11 Start                                
03685  |''2005/01/20 Start                                ||03658  |''2005/01/20 Start                                
03686  |''                          .Cells(36, 23).Value =||03659  |''                          .Cells(36, 23).Value =
03687  |'                            If gbuMGetUPDRec.N(lR||03660  |'                            If gbuMGetUPDRec.N(lR
03688  |'                                .Cells(36, 23).Va||03661  |'                                .Cells(36, 23).Va
03689  |'                            Else                 ||03662  |'                            Else                 
03690  |'                                .Cells(36, 23).Va||03663  |'                                .Cells(36, 23).Va
03691  |'                            End If               ||03664  |'                            End If               
03692  |''2005/01/20 End                                  ||03665  |''2005/01/20 End                                  
03693  |''                          .Cells(36, 21).Value =||03666  |''                          .Cells(36, 21).Value =
03694  |''2005/01/11 End                                  ||03667  |''2005/01/11 End                                  
03695  |''                          .Cells(36, 21).Horizon||03668  |''                          .Cells(36, 21).Horizon
03696  |'                          .Cells(36, 23).Horizont||03669  |'                          .Cells(36, 23).Horizont
03697  |'                          '計算期間の純資産総額の||03670  |'                          '計算期間の純資産総額の
03698  |''                          .Cells(36, 33).NumberF||03671  |''                          .Cells(36, 33).NumberF
03699  |'                          .Cells(36, 35).NumberFo||03672  |'                          .Cells(36, 35).NumberFo
03700  |''2005/01/12 End                                  ||03673  |''2005/01/12 End                                  
03701  |'                '2004/11/17 Start                ||03674  |'                '2004/11/17 Start                
03702  |'                '          .Cells(35, 35).NumberF||03675  |'                '          .Cells(35, 35).NumberF
03703  |'                '          .Cells(35, 35).Value =||03676  |'                '          .Cells(35, 35).Value =
03704  |'                '          .Cells(36, 35).Value =||03677  |'                '          .Cells(36, 35).Value =
03705  |'                          dblValueIn = TotalNav /||03678  |'                          dblValueIn = TotalNav /
03706  |'''''''2005/01/11 Start                           ||03679  |'''''''2005/01/11 Start                           
03707  |''''''                          Select Case gbuMGe||03680  |''''''                          Select Case gbuMGe
03708  |''''''                            Case "1"    '固 ||03681  |''''''                            Case "1"    '固 
03709  |''''''                                'NAV通貨と外||03682  |''''''                                'NAV通貨と外
03710  |''''''                                If gbuMGetUP||03683  |''''''                                If gbuMGetUP
03711  |''''''                                    '外部委 ||03684  |''''''                                    '外部委 
03712  |''''''                                    If gbuMG||03685  |''''''                                    If gbuMG
03713  |''''''                                    End If  ||03686  |''''''                                    End If  
03714  |''''''                                End If      ||03687  |''''''                                End If      
03715  |''''''                                'NAV通貨と外||03688  |''''''                                'NAV通貨と外
03716  |''''''                                If gbuMGetUP||03689  |''''''                                If gbuMGetUP
03717  |''''''                                    '外部委 ||03690  |''''''                                    '外部委 
03718  |''''''                                    If gbuMG||03691  |''''''                                    If gbuMG
03719  |''''''                                    End If  ||03692  |''''''                                    End If  
03720  |''''''                                End If      ||03693  |''''''                                End If      
03721  |''''''                            Case "2"    '段 ||03694  |''''''                            Case "2"    '段 
03722  |''''''                                'NAV通貨と閾||03695  |''''''                                'NAV通貨と閾
03723  |''''''                                If gbuMGetUP||03696  |''''''                                If gbuMGetUP
03724  |''''''                                    '閾値通 ||03697  |''''''                                    '閾値通 
03725  |''''''                                    If gbuMG||03698  |''''''                                    If gbuMG
03726  |''''''                                        '外 ||03699  |''''''                                        '外 
03727  |''''''                                        If g||03700  |''''''                                        If g
03728  |''''''                                            ||03701  |''''''                                            
03729  |''''''                                        End ||03702  |''''''                                        End 
03730  |''''''                                    End If  ||03703  |''''''                                    End If  
03731  |''''''                                End If      ||03704  |''''''                                End If      
03732  |''''''                                'NAV通貨と閾||03705  |''''''                                'NAV通貨と閾
03733  |''''''                                If gbuMGetUP||03706  |''''''                                If gbuMGetUP
03734  |''''''                                    '閾値通 ||03707  |''''''                                    '閾値通 
03735  |''''''                                    If gbuMG||03708  |''''''                                    If gbuMG
03736  |''''''                                        '外 ||03709  |''''''                                        '外 
03737  |''''''                                        If g||03710  |''''''                                        If g
03738  |''''''                                            ||03711  |''''''                                            
03739  |''''''                                        End ||03712  |''''''                                        End 
03740  |''''''                                    End If  ||03713  |''''''                                    End If  
03741  |''''''                                End If      ||03714  |''''''                                End If      
03742  |''''''                          End Select        ||03715  |''''''                          End Select        
03743  |'''''''2005/01/11 End                             ||03716  |'''''''2005/01/11 End                             
03744  |''2005/01/13 Start                                ||03717  |''2005/01/13 Start                                
03745  |''                          Call sbGetRoundValue(d||03718  |''                          Call sbGetRoundValue(d
03746  |''2005/01/20 Start                                ||03719  |''2005/01/20 Start                                
03747  |'                          If gbuMGetUPDRec.N(lRec||03720  |'                          If gbuMGetUPDRec.N(lRec
03748  |'                                Call sbGetRoundVa||03721  |'                                Call sbGetRoundVa
03749  |'                          Else                   ||03722  |'                          Else                   
03750  |'                                Call sbGetRoundVa||03723  |'                                Call sbGetRoundVa
03751  |'                          End If                 ||03724  |'                          End If                 
03752  |''2005/01/20 End                                  ||03725  |''2005/01/20 End                                  
03753  |''2005/01/13 End                                  ||03726  |''2005/01/13 End                                  
03754  |''2005/01/11 Start                                ||03727  |''2005/01/11 Start                                
03755  |''                          .Cells(36, 35).Value =||03728  |''                          .Cells(36, 35).Value =
03756  |''2005/01/12 Start                                ||03729  |''2005/01/12 Start                                
03757  |''平均NAV(計算対象NAV)                            ||03730  |''平均NAV(計算対象NAV)                            
03758  |''2005/01/20 Start                                ||03731  |''2005/01/20 Start                                
03759  |''                          .Cells(36, 35).Value =||03732  |''                          .Cells(36, 35).Value =
03760  |'                            If gbuMGetUPDRec.N(lR||03733  |'                            If gbuMGetUPDRec.N(lR
03761  |'                                .Cells(36, 35).Va||03734  |'                                .Cells(36, 35).Va
03762  |'                            Else                 ||03735  |'                            Else                 
03763  |'                                .Cells(36, 35).Va||03736  |'                                .Cells(36, 35).Va
03764  |'                            End If               ||03737  |'                            End If               
03765  |''2005/01/20 End                                  ||03738  |''2005/01/20 End                                  
03766  |''2005/01/11 End                                  ||03739  |''2005/01/11 End                                  
03767  |'                '2004/11/17 End                  ||03740  |'                '2004/11/17 End                  
03768  |'                          '÷??＝                ||03741  |'                          '÷??＝                
03769  |'                          .Cells(36, 26).Value = ||03742  |'                          .Cells(36, 26).Value = 
03770  |'''平均NAV(計算対象NAV)                           ||03743  |'''平均NAV(計算対象NAV)                           
03771  |''                          .Cells(36, 33).Value =||03744  |''                          .Cells(36, 33).Value =
03772  |'''2005/01/11 End                                 ||03745  |'''2005/01/11 End                                 
03773  |''                '2004/11/17 End                 ||03746  |''                '2004/11/17 End                 
03774  |''                          '÷??＝               ||03747  |''                          '÷??＝               
03775  |''                          .Cells(36, 24).Value =||03748  |''                          .Cells(36, 24).Value =
03776  |''2005/01/12 End                                  ||03749  |''2005/01/12 End                                  
03777  |'                    Else                         ||03750  |'                    Else                         
03778  |''2005/03/09 Start                                ||03751  |''2005/03/09 Start                                
03779  |'''2005/01/11 Start                               ||03752  |'''2005/01/11 Start                               
03780  |''                        '日次NAV平均取得        ||03753  |''                        '日次NAV平均取得        
03781  |''                        sStart = gstrDateFormat2||03754  |''                        sStart = gstrDateFormat2
03782  |''                        sEnd = gstrDateFormat2(C||03755  |''                        sEnd = gstrDateFormat2(C
03783  |''                                                ||03756  |''                                                
03784  |''                        '計算開始日と外部委託顧 ||03757  |''                        '計算開始日と外部委託顧 
03785  |''                        If sStart = gbuMGetUPDRe||03758  |''                        If sStart = gbuMGetUPDRe
03786  |''                            sSql = ""           ||03759  |''                            sSql = ""           
03787  |''                            sSql = sSql & "SELEC||03760  |''                            sSql = sSql & "SELEC
03788  |''                            sSql = sSql & "FROM ||03761  |''                            sSql = sSql & "FROM 
03789  |''                            sSql = sSql & "WHERE||03762  |''                            sSql = sSql & "WHERE
03790  |''                                                ||03763  |''                                                
03791  |''                            'ﾀﾞｲﾅｾｯﾄの作成      ||03764  |''                            'ﾀﾞｲﾅｾｯﾄの作成      
03792  |''                            If gintDyCreate(sSql||03765  |''                            If gintDyCreate(sSql
03793  |''                                Exit Function   ||03766  |''                                Exit Function   
03794  |''                            Else                ||03767  |''                            Else                
03795  |''                                '休日の場合、翌 ||03768  |''                                '休日の場合、翌 
03796  |''                                If gvlnDyDataS("||03769  |''                                If gvlnDyDataS("
03797  |''                                    sSql = ""   ||03770  |''                                    sSql = ""   
03798  |''                                    sSql = sSql ||03771  |''                                    sSql = sSql 
03799  |''                                    sSql = sSql ||03772  |''                                    sSql = sSql 
03800  |''                                    sSql = sSql ||03773  |''                                    sSql = sSql 
03801  |''                                    sSql = sSql ||03774  |''                                    sSql = sSql 
03802  |''                                    sSql = sSql ||03775  |''                                    sSql = sSql 
03803  |''                                    sSql = sSql ||03776  |''                                    sSql = sSql 
03804  |''                                    sSql = sSql ||03777  |''                                    sSql = sSql 
03805  |''                                    sSql = sSql ||03778  |''                                    sSql = sSql 
03806  |''                                                ||03779  |''                                                
03807  |''                                    'ﾀﾞｲﾅｾｯﾄの作||03780  |''                                    'ﾀﾞｲﾅｾｯﾄの作
03808  |''                                    If gintDyCre||03781  |''                                    If gintDyCre
03809  |''                                        Exit Fun||03782  |''                                        Exit Fun
03810  |''                                    Else        ||03783  |''                                    Else        
03811  |''                                        ddblNear||03784  |''                                        ddblNear
03812  |'''2005/01/24 Start                               ||03785  |'''2005/01/24 Start                               
03813  |''                                        sSql = "||03786  |''                                        sSql = "
03814  |''                                        sSql = s||03787  |''                                        sSql = s
03815  |''                                        sSql = s||03788  |''                                        sSql = s
03816  |''                                        sSql = s||03789  |''                                        sSql = s
03817  |''                                        sSql = s||03790  |''                                        sSql = s
03818  |''                                        sSql = s||03791  |''                                        sSql = s
03819  |''                                        sSql = s||03792  |''                                        sSql = s
03820  |''                                        sSql = s||03793  |''                                        sSql = s
03821  |''                                        'ﾀﾞｲﾅｾｯﾄ||03794  |''                                        'ﾀﾞｲﾅｾｯﾄ
03822  |''                                        If gintD||03795  |''                                        If gintD
03823  |''                                            Exit||03796  |''                                            Exit
03824  |''                                        Else    ||03797  |''                                        Else    
03825  |''                                            sSta||03798  |''                                            sSta
03826  |''                                            dSta||03799  |''                                            dSta
03827  |''                                            .Cel||03800  |''                                            .Cel
03828  |''                                                ||03801  |''                                                
03829  |''                                                ||03802  |''                                                
03830  |''                                                ||03803  |''                                                
03831  |''                                            iCal||03804  |''                                            iCal
03832  |''                                        End If  ||03805  |''                                        End If  
03833  |'''2005/01/24 End                                 ||03806  |'''2005/01/24 End                                 
03834  |''                                    End If      ||03807  |''                                    End If      
03835  |''                                End If          ||03808  |''                                End If          
03836  |''                            End If              ||03809  |''                            End If              
03837  |''                        End If                  ||03810  |''                        End If                  
03838  |'''2005/01/11 End                                 ||03811  |'''2005/01/11 End                                 
03839  |''                        sSql = ""               ||03812  |''                        sSql = ""               
03840  |''                        sSql = sSql & "SELECT   ||03813  |''                        sSql = sSql & "SELECT   
03841  |''                        sSql = sSql & "FROM  CFR||03814  |''                        sSql = sSql & "FROM  CFR
03842  |''                        sSql = sSql & "WHERE CAL||03815  |''                        sSql = sSql & "WHERE CAL
03843  |''                        sSql = sSql & "AND   CAL||03816  |''                        sSql = sSql & "AND   CAL
03844  |''                        sSql = sSql & "ORDER BY ||03817  |''                        sSql = sSql & "ORDER BY 
03845  |''                                                ||03818  |''                                                
03846  |''                        'ﾀﾞｲﾅｾｯﾄの作成          ||03819  |''                        'ﾀﾞｲﾅｾｯﾄの作成          
03847  |''                        If gintDyCreate(sSql) = ||03820  |''                        If gintDyCreate(sSql) = 
03848  |''                            Exit Function       ||03821  |''                            Exit Function       
03849  |''                        End If                  ||03822  |''                        End If                  
03850  |''                                                ||03823  |''                                                
03851  |''                        ReDim dstrCaldate(gbxOra||03824  |''                        ReDim dstrCaldate(gbxOra
03852  |''                        ReDim ddblDailynav(gbxOr||03825  |''                        ReDim ddblDailynav(gbxOr
03853  |''                                                ||03826  |''                                                
03854  |''                        'EOF判定処理            ||03827  |''                        'EOF判定処理            
03855  |''                        dlngCnt = 0             ||03828  |''                        dlngCnt = 0             
03856  |''                                                ||03829  |''                                                
03857  |''                        Do Until gblnDyEOF()    ||03830  |''                        Do Until gblnDyEOF()    
03858  |''                            dlngCnt = dlngCnt + ||03831  |''                            dlngCnt = dlngCnt + 
03859  |''                            '抽出データセット   ||03832  |''                            '抽出データセット   
03860  |''                            dstrCaldate(dlngCnt)||03833  |''                            dstrCaldate(dlngCnt)
03861  |''                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ   ||03834  |''                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ   
03862  |''                            Call gDyNext        ||03835  |''                            Call gDyNext        
03863  |''                        Loop                    ||03836  |''                        Loop                    
03864  |''                                                ||03837  |''                                                
03865  |''                        sSql = ""               ||03838  |''                        sSql = ""               
03866  |''                        sSql = sSql & "SELECT   ||03839  |''                        sSql = sSql & "SELECT   
03867  |''                        sSql = sSql & "FROM  CFR||03840  |''                        sSql = sSql & "FROM  CFR
03868  |''                        sSql = sSql & "WHERE    ||03841  |''                        sSql = sSql & "WHERE    
03869  |''                        sSql = sSql & "AND   ((C||03842  |''                        sSql = sSql & "AND   ((C
03870  |''                        sSql = sSql & "AND   ((C||03843  |''                        sSql = sSql & "AND   ((C
03871  |''                        sSql = sSql & "AND   ((C||03844  |''                        sSql = sSql & "AND   ((C
03872  |''                        sSql = sSql & "AND   ((C||03845  |''                        sSql = sSql & "AND   ((C
03873  |''                        sSql = sSql & "ORDER BY ||03846  |''                        sSql = sSql & "ORDER BY 
03874  |''                                                ||03847  |''                                                
03875  |''                        If gintDyCreate(sSql) = ||03848  |''                        If gintDyCreate(sSql) = 
03876  |''                            Exit Function       ||03849  |''                            Exit Function       
03877  |''                        End If                  ||03850  |''                        End If                  
03878  |''                                                ||03851  |''                                                
03879  |''                        dlngCnt = 0             ||03852  |''                        dlngCnt = 0             
03880  |''                                                ||03853  |''                                                
03881  |''                        Do Until gblnDyEOF()    ||03854  |''                        Do Until gblnDyEOF()    
03882  |''                            dlngCnt = dlngCnt + ||03855  |''                            dlngCnt = dlngCnt + 
03883  |''                            '抽出データセット   ||03856  |''                            '抽出データセット   
03884  |''                            dstrBasedate = gvlnD||03857  |''                            dstrBasedate = gvlnD
03885  |''                            If Mid(dstrCaldate(d||03858  |''                            If Mid(dstrCaldate(d
03886  |''                                ddblDailynav(dln||03859  |''                                ddblDailynav(dln
03887  |''                            Else                ||03860  |''                            Else                
03888  |''                                '計算開始日が外 ||03861  |''                                '計算開始日が外 
03889  |''                                If ddblNearNav <||03862  |''                                If ddblNearNav <
03890  |''                                And dlngCnt = 1 ||03863  |''                                And dlngCnt = 1 
03891  |''                                    dstrCaldate2||03864  |''                                    dstrCaldate2
03892  |''                                    dstrBasedate||03865  |''                                    dstrBasedate
03893  |''                                    dlngDiffdate||03866  |''                                    dlngDiffdate
03894  |''                                                ||03867  |''                                                
03895  |''                                    For dintFor ||03868  |''                                    For dintFor 
03896  |''                                        ddblDail||03869  |''                                        ddblDail
03897  |''                                        dlngCnt ||03870  |''                                        dlngCnt 
03898  |''                                    Next dintFor||03871  |''                                    Next dintFor
03899  |'''2005/01/18 Start                               ||03872  |'''2005/01/18 Start                               
03900  |''                                    ddblDailynav||03873  |''                                    ddblDailynav
03901  |'''2005/01/18 End                                 ||03874  |'''2005/01/18 End                                 
03902  |''                                Else            ||03875  |''                                Else            
03903  |''                                    '日次NAVにデ||03876  |''                                    '日次NAVにデ
03904  |''                                    dstrCaldate2||03877  |''                                    dstrCaldate2
03905  |''                                    dstrBasedate||03878  |''                                    dstrBasedate
03906  |''                                    dlngDiffdate||03879  |''                                    dlngDiffdate
03907  |''                                                ||03880  |''                                                
03908  |''                                    For dintFor ||03881  |''                                    For dintFor 
03909  |'''2005/01/18 Start                               ||03882  |'''2005/01/18 Start                               
03910  |'''                                        ddblDai||03883  |'''                                        ddblDai
03911  |'''                                        dlngCnt||03884  |'''                                        dlngCnt
03912  |''                                        If ddblD||03885  |''                                        If ddblD
03913  |''                                            ddbl||03886  |''                                            ddbl
03914  |''                                        Else    ||03887  |''                                        Else    
03915  |''                                            '日 ||03888  |''                                            '日 
03916  |'''2005/01/20 Start                               ||03889  |'''2005/01/20 Start                               
03917  |'''                                            ddb||03890  |'''                                            ddb
03918  |''                                            intR||03891  |''                                            intR
03919  |''                                            vbLf||03892  |''                                            vbLf
03920  |''                                            vbLf||03893  |''                                            vbLf
03921  |''                                                ||03894  |''                                                
03922  |''                                            Exit||03895  |''                                            Exit
03923  |'''2005/01/20 End                                 ||03896  |'''2005/01/20 End                                 
03924  |''                                        End If  ||03897  |''                                        End If  
03925  |''                                        dlngCnt ||03898  |''                                        dlngCnt 
03926  |'''2005/01/18 End                                 ||03899  |'''2005/01/18 End                                 
03927  |''                                    Next dintFor||03900  |''                                    Next dintFor
03928  |'''2005/01/18 Start                               ||03901  |'''2005/01/18 Start                               
03929  |''                                    ddblDailynav||03902  |''                                    ddblDailynav
03930  |'''2005/01/18 End                                 ||03903  |'''2005/01/18 End                                 
03931  |''                                End If          ||03904  |''                                End If          
03932  |''                                                ||03905  |''                                                
03933  |''''                                If Mid(dstrCal||03906  |''''                                If Mid(dstrCal
03934  |''''                                And Mid(dstrCa||03907  |''''                                And Mid(dstrCa
03935  |'''                                If Mid(dstrCald||03908  |'''                                If Mid(dstrCald
03936  |'''                                    '休日の場合||03909  |'''                                    '休日の場合
03937  |'''                                    dstrCaldate||03910  |'''                                    dstrCaldate
03938  |'''                                    dstrBasedat||03911  |'''                                    dstrBasedat
03939  |'''                                    dlngDiffdat||03912  |'''                                    dlngDiffdat
03940  |''''                                    dlngDiffda||03913  |''''                                    dlngDiffda
03941  |'''                                               ||03914  |'''                                               
03942  |'''                                    For dintFor||03915  |'''                                    For dintFor
03943  |'''                                        ddblDai||03916  |'''                                        ddblDai
03944  |'''                                        dlngCnt||03917  |'''                                        dlngCnt
03945  |'''                                    Next dintFo||03918  |'''                                    Next dintFo
03946  |''''                                    ddblDailyn||03919  |''''                                    ddblDailyn
03947  |'''                                Else           ||03920  |'''                                Else           
03948  |'''                                    '営業日の場||03921  |'''                                    '営業日の場
03949  |'''                                    dstrCaldate||03922  |'''                                    dstrCaldate
03950  |'''                                    dstrBasedat||03923  |'''                                    dstrBasedat
03951  |'''                                    dlngDiffdat||03924  |'''                                    dlngDiffdat
03952  |'''                                               ||03925  |'''                                               
03953  |'''                                    For dintFor||03926  |'''                                    For dintFor
03954  |'''                                        ddblDai||03927  |'''                                        ddblDai
03955  |'''                                        dlngCnt||03928  |'''                                        dlngCnt
03956  |'''                                    Next dintFo||03929  |'''                                    Next dintFo
03957  |''''                                    ddblDailyn||03930  |''''                                    ddblDailyn
03958  |'''                                End If         ||03931  |'''                                End If         
03959  |''                            End If              ||03932  |''                            End If              
03960  |''                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ   ||03933  |''                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ   
03961  |''                            Call gDyNext        ||03934  |''                            Call gDyNext        
03962  |''                        Loop                    ||03935  |''                        Loop                    
03963  |''                                                ||03936  |''                                                
03964  |''                        ddblTtalnav = 0         ||03937  |''                        ddblTtalnav = 0         
03965  |''                                                ||03938  |''                                                
03966  |''                        For dintFor = 1 To dlngC||03939  |''                        For dintFor = 1 To dlngC
03967  |''                            ddblTtalnav = ddblTt||03940  |''                            ddblTtalnav = ddblTt
03968  |''                        Next dintFor            ||03941  |''                        Next dintFor            
03969  |''                                                ||03942  |''                                                
03970  |''                        iRowCnt = dlngCnt       ||03943  |''                        iRowCnt = dlngCnt       
03971  |'''2005/01/18 Start                               ||03944  |'''2005/01/18 Start                               
03972  |'''                        TotalNav = ddblTtalnav ||03945  |'''                        TotalNav = ddblTtalnav 
03973  |''                        TotalNav = ddblTtalnav  ||03946  |''                        TotalNav = ddblTtalnav  
03974  |'''2005/01/18 End                                 ||03947  |'''2005/01/18 End                                 
03975  |''                        dblValueIn = TotalNav   ||03948  |''                        dblValueIn = TotalNav   
03976  |'''2005/01/13 Start                               ||03949  |'''2005/01/13 Start                               
03977  |'''                        Call sbGetRoundValue(db||03950  |'''                        Call sbGetRoundValue(db
03978  |''                        Call sbGetRoundValue2(db||03951  |''                        Call sbGetRoundValue2(db
03979  |'''2005/01/13 End                                 ||03952  |'''2005/01/13 End                                 
03980  |''                        TotalNav = dblValueOut  ||03953  |''                        TotalNav = dblValueOut  
03981  |''                                                ||03954  |''                                                
03982  |'''2005/03/09 Start                               ||03955  |'''2005/03/09 Start                               
03983  |''''2005/01/12 Start                              ||03956  |''''2005/01/12 Start                              
03984  |''''                      '対象締日データ抽出     ||03957  |''''                      '対象締日データ抽出     
03985  |''''                      .Cells(20, 37).NumberFor||03958  |''''                      .Cells(20, 37).NumberFor
03986  |'''''2005/01/11 Start                             ||03959  |'''''2005/01/11 Start                             
03987  |'''''                      .Cells(20, 37).Value = ||03960  |'''''                      .Cells(20, 37).Value = 
03988  |''''                      .Cells(20, 37).Value = C||03961  |''''                      .Cells(20, 37).Value = C
03989  |'''''2005/01/11 End                               ||03962  |'''''2005/01/11 End                               
03990  |''''                      .Cells(20, 37).Horizonta||03963  |''''                      .Cells(20, 37).Horizonta
03991  |''''                      '合計(月末純資産)       ||03964  |''''                      '合計(月末純資産)       
03992  |''''                      .Cells(33, 37).NumberFor||03965  |''''                      .Cells(33, 37).NumberFor
03993  |'''''2005/01/11 Start                             ||03966  |'''''2005/01/11 Start                             
03994  |'''''                      .Cells(33, 37).Value = ||03967  |'''''                      .Cells(33, 37).Value = 
03995  |''''                      .Cells(33, 37).Value = C||03968  |''''                      .Cells(33, 37).Value = C
03996  |'''''2005/01/11 End                               ||03969  |'''''2005/01/11 End                               
03997  |''''                      .Cells(33, 37).Horizonta||03970  |''''                      .Cells(33, 37).Horizonta
03998  |''''                      '計算期間の純資産総額の ||03971  |''''                      '計算期間の純資産総額の 
03999  |''''                      .Cells(36, 23).NumberFor||03972  |''''                      .Cells(36, 23).NumberFor
04000  |'''''2005/01/11 Start                             ||03973  |'''''2005/01/11 Start                             
04001  |'''''                      .Cells(36, 23).Value = ||03974  |'''''                      .Cells(36, 23).Value = 
04002  |''''                      .Cells(36, 23).Value = C||03975  |''''                      .Cells(36, 23).Value = C
04003  |'''''2005/01/11 End                               ||03976  |'''''2005/01/11 End                               
04004  |''''                      .Cells(36, 23).Horizonta||03977  |''''                      .Cells(36, 23).Horizonta
04005  |''''                      '計算期間の純資産総額の ||03978  |''''                      '計算期間の純資産総額の 
04006  |''''                      .Cells(36, 35).NumberFor||03979  |''''                      .Cells(36, 35).NumberFor
04007  |'''                      '対象締日データ抽出      ||03980  |'''                      '対象締日データ抽出      
04008  |''''                      .Cells(20, 37).NumberFor||03981  |''''                      .Cells(20, 37).NumberFor
04009  |''''2005/03/09 Start                              ||03982  |''''2005/03/09 Start                              
04010  |''''                      .Cells(20, 39).NumberFor||03983  |''''                      .Cells(20, 39).NumberFor
04011  |''''2005/03/09 End                                ||03984  |''''2005/03/09 End                                
04012  |''''2005/01/11 Start                              ||03985  |''''2005/01/11 Start                              
04013  |''''                      .Cells(20, 37).Value = C||03986  |''''                      .Cells(20, 37).Value = C
04014  |''''                      .Cells(20, 37).Value = C||03987  |''''                      .Cells(20, 37).Value = C
04015  |''''2005/01/20 Start                              ||03988  |''''2005/01/20 Start                              
04016  |''''                      .Cells(20, 39).Value = C||03989  |''''                      .Cells(20, 39).Value = C
04017  |''''2005/03/09 Start                              ||03990  |''''2005/03/09 Start                              
04018  |''''                        If gbuMGetUPDRec.N(lRe||03991  |''''                        If gbuMGetUPDRec.N(lRe
04019  |''''                            .Cells(20, 39).Val||03992  |''''                            .Cells(20, 39).Val
04020  |''''                        Else                  ||03993  |''''                        Else                  
04021  |''''                            .Cells(20, 39).Val||03994  |''''                            .Cells(20, 39).Val
04022  |''''                        End If                ||03995  |''''                        End If                
04023  |''''2005/03/09 End                                ||03996  |''''2005/03/09 End                                
04024  |''''2005/01/20 End                                ||03997  |''''2005/01/20 End                                
04025  |''''2005/01/11 End                                ||03998  |''''2005/01/11 End                                
04026  |''''                      .Cells(20, 37).Horizonta||03999  |''''                      .Cells(20, 37).Horizonta
04027  |''''2005/03/09 Start                              ||04000  |''''2005/03/09 Start                              
04028  |''''                      .Cells(20, 39).Horizonta||04001  |''''                      .Cells(20, 39).Horizonta
04029  |''''2005/03/09 End                                ||04002  |''''2005/03/09 End                                
04030  |'''                      '合計(月末純資産)        ||04003  |'''                      '合計(月末純資産)        
04031  |''''                      .Cells(33, 37).NumberFor||04004  |''''                      .Cells(33, 37).NumberFor
04032  |''''2005/03/09 Start                              ||04005  |''''2005/03/09 Start                              
04033  |''''                      .Cells(33, 39).NumberFor||04006  |''''                      .Cells(33, 39).NumberFor
04034  |''''2005/03/09 End                                ||04007  |''''2005/03/09 End                                
04035  |''''2005/03/09 Start                              ||04008  |''''2005/03/09 Start                              
04036  |'''                      .Cells(17, 21).NumberForm||04009  |'''                      .Cells(17, 21).NumberForm
04037  |''''2005/03/09 End                                ||04010  |''''2005/03/09 End                                
04038  |''''2005/01/11 Start                              ||04011  |''''2005/01/11 Start                              
04039  |''''                      .Cells(33, 37).Value = C||04012  |''''                      .Cells(33, 37).Value = C
04040  |''''                      .Cells(33, 37).Value = C||04013  |''''                      .Cells(33, 37).Value = C
04041  |''''2005/01/20 Start                              ||04014  |''''2005/01/20 Start                              
04042  |''''                      .Cells(33, 39).Value = C||04015  |''''                      .Cells(33, 39).Value = C
04043  |'''                        If gbuMGetUPDRec.N(lRec||04016  |'''                        If gbuMGetUPDRec.N(lRec
04044  |''''2005/03/09 Start                              ||04017  |''''2005/03/09 Start                              
04045  |''''                            .Cells(33, 39).Val||04018  |''''                            .Cells(33, 39).Val
04046  |''''2005/03/09 End                                ||04019  |''''2005/03/09 End                                
04047  |''''2005/03/09 Start                              ||04020  |''''2005/03/09 Start                              
04048  |'''                            .Cells(17, 21).Valu||04021  |'''                            .Cells(17, 21).Valu
04049  |''''2005/03/09 End                                ||04022  |''''2005/03/09 End                                
04050  |'''                        Else                   ||04023  |'''                        Else                   
04051  |''''2005/03/09 Start                              ||04024  |''''2005/03/09 Start                              
04052  |''''                            .Cells(33, 39).Val||04025  |''''                            .Cells(33, 39).Val
04053  |''''2005/03/09 End                                ||04026  |''''2005/03/09 End                                
04054  |''''2005/03/09 Start                              ||04027  |''''2005/03/09 Start                              
04055  |'''                            .Cells(17, 21).Valu||04028  |'''                            .Cells(17, 21).Valu
04056  |''''2005/03/09 End                                ||04029  |''''2005/03/09 End                                
04057  |'''                        End If                 ||04030  |'''                        End If                 
04058  |''''2005/01/20 End                                ||04031  |''''2005/01/20 End                                
04059  |''''2005/01/11 End                                ||04032  |''''2005/01/11 End                                
04060  |''''                      .Cells(33, 37).Horizonta||04033  |''''                      .Cells(33, 37).Horizonta
04061  |''''2005/03/09 Start                              ||04034  |''''2005/03/09 Start                              
04062  |''''                      .Cells(33, 39).Horizonta||04035  |''''                      .Cells(33, 39).Horizonta
04063  |''''2005/03/09 End                                ||04036  |''''2005/03/09 End                                
04064  |''''2005/03/09 Start                              ||04037  |''''2005/03/09 Start                              
04065  |'''                      .Cells(17, 21).Horizontal||04038  |'''                      .Cells(17, 21).Horizontal
04066  |''''2005/03/09 End                                ||04039  |''''2005/03/09 End                                
04067  |''''2005/03/09 Start                              ||04040  |''''2005/03/09 Start                              
04068  |'''                        '平均純資産総額        ||04041  |'''                        '平均純資産総額        
04069  |'''                        .Cells(36, 2).Value = s||04042  |'''                        .Cells(36, 2).Value = s
04070  |'''                        .Cells(36, 11).Value = ||04043  |'''                        .Cells(36, 11).Value = 
04071  |''''2005/03/09 End                                ||04044  |''''2005/03/09 End                                
04072  |'''                      '計算期間の純資産総額の合||04045  |'''                      '計算期間の純資産総額の合
04073  |''''                      .Cells(36, 21).NumberFor||04046  |''''                      .Cells(36, 21).NumberFor
04074  |'''                      .Cells(36, 23).NumberForm||04047  |'''                      .Cells(36, 23).NumberForm
04075  |''''2005/01/11 Start                              ||04048  |''''2005/01/11 Start                              
04076  |''''                      .Cells(36, 23).Value = C||04049  |''''                      .Cells(36, 23).Value = C
04077  |''''                      .Cells(36, 21).Value = C||04050  |''''                      .Cells(36, 21).Value = C
04078  |''''2005/01/20 Start                              ||04051  |''''2005/01/20 Start                              
04079  |''''                      .Cells(36, 23).Value = C||04052  |''''                      .Cells(36, 23).Value = C
04080  |'''                        If gbuMGetUPDRec.N(lRec||04053  |'''                        If gbuMGetUPDRec.N(lRec
04081  |'''                            .Cells(36, 23).Valu||04054  |'''                            .Cells(36, 23).Valu
04082  |'''                        Else                   ||04055  |'''                        Else                   
04083  |'''                            .Cells(36, 23).Valu||04056  |'''                            .Cells(36, 23).Valu
04084  |'''                        End If                 ||04057  |'''                        End If                 
04085  |''''2005/01/20 End                                ||04058  |''''2005/01/20 End                                
04086  |''''2005/01/11 End                                ||04059  |''''2005/01/11 End                                
04087  |''''                      .Cells(36, 21).Horizonta||04060  |''''                      .Cells(36, 21).Horizonta
04088  |'''                      .Cells(36, 23).Horizontal||04061  |'''                      .Cells(36, 23).Horizontal
04089  |'''                      '計算期間の純資産総額の合||04062  |'''                      '計算期間の純資産総額の合
04090  |''''                      .Cells(36, 33).NumberFor||04063  |''''                      .Cells(36, 33).NumberFor
04091  |'''                      .Cells(36, 35).NumberForm||04064  |'''                      .Cells(36, 35).NumberForm
04092  |''''2005/01/12 End                                ||04065  |''''2005/01/12 End                                
04093  |'''            '2004/11/17 Start                  ||04066  |'''            '2004/11/17 Start                  
04094  |'''            '          .Cells(35, 35).NumberFor||04067  |'''            '          .Cells(35, 35).NumberFor
04095  |'''            '          .Cells(35, 35).Value = C||04068  |'''            '          .Cells(35, 35).Value = C
04096  |'''            '          .Cells(36, 35).Value = C||04069  |'''            '          .Cells(36, 35).Value = C
04097  |'''                      dblValueIn = TotalNav / i||04070  |'''                      dblValueIn = TotalNav / i
04098  |'''''''''2005/01/11 Start                         ||04071  |'''''''''2005/01/11 Start                         
04099  |''''''''                        Select Case gbuMGe||04072  |''''''''                        Select Case gbuMGe
04100  |''''''''                          Case "1"    '固 ||04073  |''''''''                          Case "1"    '固 
04101  |''''''''                              'NAV通貨と外||04074  |''''''''                              'NAV通貨と外
04102  |''''''''                              If gbuMGetUP||04075  |''''''''                              If gbuMGetUP
04103  |''''''''                                  '外部委 ||04076  |''''''''                                  '外部委 
04104  |''''''''                                  If gbuMG||04077  |''''''''                                  If gbuMG
04105  |''''''''                                  End If  ||04078  |''''''''                                  End If  
04106  |''''''''                              End If      ||04079  |''''''''                              End If      
04107  |''''''''                              'NAV通貨と外||04080  |''''''''                              'NAV通貨と外
04108  |''''''''                              If gbuMGetUP||04081  |''''''''                              If gbuMGetUP
04109  |''''''''                                  '外部委 ||04082  |''''''''                                  '外部委 
04110  |''''''''                                  If gbuMG||04083  |''''''''                                  If gbuMG
04111  |''''''''                                  End If  ||04084  |''''''''                                  End If  
04112  |''''''''                              End If      ||04085  |''''''''                              End If      
04113  |''''''''                          Case "2"    '段 ||04086  |''''''''                          Case "2"    '段 
04114  |''''''''                              'NAV通貨と閾||04087  |''''''''                              'NAV通貨と閾
04115  |''''''''                              If gbuMGetUP||04088  |''''''''                              If gbuMGetUP
04116  |''''''''                                  '閾値通 ||04089  |''''''''                                  '閾値通 
04117  |''''''''                                  If gbuMG||04090  |''''''''                                  If gbuMG
04118  |''''''''                                      '外 ||04091  |''''''''                                      '外 
04119  |''''''''                                      If g||04092  |''''''''                                      If g
04120  |''''''''                                          ||04093  |''''''''                                          
04121  |''''''''                                      End ||04094  |''''''''                                      End 
04122  |''''''''                                  End If  ||04095  |''''''''                                  End If  
04123  |''''''''                              End If      ||04096  |''''''''                              End If      
04124  |''''''''                              'NAV通貨と閾||04097  |''''''''                              'NAV通貨と閾
04125  |''''''''                              If gbuMGetUP||04098  |''''''''                              If gbuMGetUP
04126  |''''''''                                  '閾値通 ||04099  |''''''''                                  '閾値通 
04127  |''''''''                                  If gbuMG||04100  |''''''''                                  If gbuMG
04128  |''''''''                                      '外 ||04101  |''''''''                                      '外 
04129  |''''''''                                      If g||04102  |''''''''                                      If g
04130  |''''''''                                          ||04103  |''''''''                                          
04131  |''''''''                                      End ||04104  |''''''''                                      End 
04132  |''''''''                                  End If  ||04105  |''''''''                                  End If  
04133  |''''''''                              End If      ||04106  |''''''''                              End If      
04134  |''''''''                        End Select        ||04107  |''''''''                        End Select        
04135  |'''''''''2005/01/11 End                           ||04108  |'''''''''2005/01/11 End                           
04136  |''''2005/01/13 Start                              ||04109  |''''2005/01/13 Start                              
04137  |''''                      Call sbGetRoundValue(dbl||04110  |''''                      Call sbGetRoundValue(dbl
04138  |''''2005/01/20 Start                              ||04111  |''''2005/01/20 Start                              
04139  |''''                      Call sbGetRoundValue2(db||04112  |''''                      Call sbGetRoundValue2(db
04140  |'''                      If gbuMGetUPDRec.N(lRecId||04113  |'''                      If gbuMGetUPDRec.N(lRecId
04141  |'''                            Call sbGetRoundValu||04114  |'''                            Call sbGetRoundValu
04142  |'''                      Else                     ||04115  |'''                      Else                     
04143  |'''                            Call sbGetRoundValu||04116  |'''                            Call sbGetRoundValu
04144  |'''                      End If                   ||04117  |'''                      End If                   
04145  |''''2005/01/20 End                                ||04118  |''''2005/01/20 End                                
04146  |''''2005/01/13 End                                ||04119  |''''2005/01/13 End                                
04147  |''''2005/01/11 Start                              ||04120  |''''2005/01/11 Start                              
04148  |''''                      .Cells(36, 35).Value = C||04121  |''''                      .Cells(36, 35).Value = C
04149  |''''2005/01/12 Start                              ||04122  |''''2005/01/12 Start                              
04150  |'''''平均NAV(計算対象NAV)                         ||04123  |'''''平均NAV(計算対象NAV)                         
04151  |''''                      .Cells(36, 35).Value = C||04124  |''''                      .Cells(36, 35).Value = C
04152  |'''''2005/01/11 End                               ||04125  |'''''2005/01/11 End                               
04153  |''''            '2004/11/17 End                   ||04126  |''''            '2004/11/17 End                   
04154  |''''                      '÷??＝                 ||04127  |''''                      '÷??＝                 
04155  |''''                      .Cells(36, 26).Value = s||04128  |''''                      .Cells(36, 26).Value = s
04156  |''''平均NAV(計算対象NAV)                          ||04129  |''''平均NAV(計算対象NAV)                          
04157  |''''                      .Cells(36, 33).Value = C||04130  |''''                      .Cells(36, 33).Value = C
04158  |''''2005/01/20 Start                              ||04131  |''''2005/01/20 Start                              
04159  |''''                      .Cells(36, 35).Value = C||04132  |''''                      .Cells(36, 35).Value = C
04160  |'''                        If gbuMGetUPDRec.N(lRec||04133  |'''                        If gbuMGetUPDRec.N(lRec
04161  |'''                            .Cells(36, 35).Valu||04134  |'''                            .Cells(36, 35).Valu
04162  |'''                        Else                   ||04135  |'''                        Else                   
04163  |'''                            .Cells(36, 35).Valu||04136  |'''                            .Cells(36, 35).Valu
04164  |'''                        End If                 ||04137  |'''                        End If                 
04165  |''''2005/01/20 End                                ||04138  |''''2005/01/20 End                                
04166  |''''2005/01/11 End                                ||04139  |''''2005/01/11 End                                
04167  |''''2005/03/09 Start                              ||04140  |''''2005/03/09 Start                              
04168  |'''                        AvgNav = dblValueOut   ||04141  |'''                        AvgNav = dblValueOut   
04169  |''''2005/03/09 End                                ||04142  |''''2005/03/09 End                                
04170  |'''            '2004/11/17 End                    ||04143  |'''            '2004/11/17 End                    
04171  |'''                      '÷??＝                  ||04144  |'''                      '÷??＝                  
04172  |''''                      .Cells(36, 24).Value = s||04145  |''''                      .Cells(36, 24).Value = s
04173  |'''                      .Cells(36, 26).Value = sW||04146  |'''                      .Cells(36, 26).Value = sW
04174  |''''2005/01/12 End                                ||04147  |''''2005/01/12 End                                
04175  |'''2005/03/09 End                                 ||04148  |'''2005/03/09 End                                 
04176  |''                    End If                      ||04149  |''                    End If                      
04177  |'                    ddblTtalnav = 0              ||04150  |'                    ddblTtalnav = 0              
04178  |'                    For dintFor = 0 To NavGetCnt ||04151  |'                    For dintFor = 0 To NavGetCnt 
04179  |'                                                 ||04152  |'                                                 
04180  |'                        '日次NAV平均取得         ||04153  |'                        '日次NAV平均取得         
04181  |'                        sStart = gstrDateFormat2(||04154  |'                        sStart = gstrDateFormat2(
04182  |'                        sEnd = gstrDateFormat2(CS||04155  |'                        sEnd = gstrDateFormat2(CS
04183  |'                                                 ||04156  |'                                                 
04184  |'                        '計算開始日と外部委託顧問||04157  |'                        '計算開始日と外部委託顧問
04185  |'                        If sStart = gbuMGetUPDRec||04158  |'                        If sStart = gbuMGetUPDRec
04186  |'                            sSql = ""            ||04159  |'                            sSql = ""            
04187  |'                            sSql = sSql & "SELECT||04160  |'                            sSql = sSql & "SELECT
04188  |'                                                 ||04161  |'                                                 
04189  |'                            'ﾀﾞｲﾅｾｯﾄの作成       ||04162  |'                            'ﾀﾞｲﾅｾｯﾄの作成       
04190  |'                            If gintDyCreate(sSql)||04163  |'                            If gintDyCreate(sSql)
04191  |'                                Exit Function    ||04164  |'                                Exit Function    
04192  |'                            Else                 ||04165  |'                            Else                 
04193  |'                                '休日の場合、翌営||04166  |'                                '休日の場合、翌営
04194  |'                                If gvlnDyDataS("E||04167  |'                                If gvlnDyDataS("E
04195  |'                                    sSql = ""    ||04168  |'                                    sSql = ""    
04196  |'                                    sSql = sSql &||04169  |'                                    sSql = sSql &
04197  |'                                    sSql = sSql &||04170  |'                                    sSql = sSql &
04198  |'                                    sSql = sSql &||04171  |'                                    sSql = sSql &
04199  |'                                    sSql = sSql &||04172  |'                                    sSql = sSql &
04200  |'                                                 ||04173  |'                                                 
04201  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||04174  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
04202  |'                                    If gintDyCrea||04175  |'                                    If gintDyCrea
04203  |'                                        Exit Func||04176  |'                                        Exit Func
04204  |'                                    Else         ||04177  |'                                    Else         
04205  |'                                        ddblNearN||04178  |'                                        ddblNearN
04206  |'                                        sSql = ""||04179  |'                                        sSql = ""
04207  |'                                        sSql = sS||04180  |'                                        sSql = sS
04208  |'                                        sSql = sS||04181  |'                                        sSql = sS
04209  |'                                        sSql = sS||04182  |'                                        sSql = sS
04210  |'                                        sSql = sS||04183  |'                                        sSql = sS
04211  |'                                        'ﾀﾞｲﾅｾｯﾄ ||04184  |'                                        'ﾀﾞｲﾅｾｯﾄ 
04212  |'                                        If gintDy||04185  |'                                        If gintDy
04213  |'                                            Exit ||04186  |'                                            Exit 
04214  |'                                        Else     ||04187  |'                                        Else     
04215  |'                                            sStar||04188  |'                                            sStar
04216  |'                                            dStar||04189  |'                                            dStar
04217  |'                                            .Cell||04190  |'                                            .Cell
04218  |'                                                C||04191  |'                                                C
04219  |'                                            iCalc||04192  |'                                            iCalc
04220  |'                                        End If   ||04193  |'                                        End If   
04221  |'                                    End If       ||04194  |'                                    End If       
04222  |'                                End If           ||04195  |'                                End If           
04223  |'                            End If               ||04196  |'                            End If               
04224  |'                        End If                   ||04197  |'                        End If                   
04225  |'                        sSql = ""                ||04198  |'                        sSql = ""                
04226  |'                        sSql = sSql & "SELECT CAL||04199  |'                        sSql = sSql & "SELECT CAL
04227  |'                        sSql = sSql & "WHERE CAL_||04200  |'                        sSql = sSql & "WHERE CAL_
04228  |'                                                 ||04201  |'                                                 
04229  |'                        'ﾀﾞｲﾅｾｯﾄの作成           ||04202  |'                        'ﾀﾞｲﾅｾｯﾄの作成           
04230  |'                        If gintDyCreate(sSql) = F||04203  |'                        If gintDyCreate(sSql) = F
04231  |'                            Exit Function        ||04204  |'                            Exit Function        
04232  |'                        End If                   ||04205  |'                        End If                   
04233  |'                                                 ||04206  |'                                                 
04234  |'                        If dlngCnt = 0 Then      ||04207  |'                        If dlngCnt = 0 Then      
04235  |'                            ReDim dstrCaldate(gbx||04208  |'                            ReDim dstrCaldate(gbx
04236  |'                            ReDim ddblDailynav(gb||04209  |'                            ReDim ddblDailynav(gb
04237  |'                        End If                   ||04210  |'                        End If                   
04238  |'                                                 ||04211  |'                                                 
04239  |'                        'EOF判定処理             ||04212  |'                        'EOF判定処理             
04240  |'                        dlngCnt = 0              ||04213  |'                        dlngCnt = 0              
04241  |'                                                 ||04214  |'                                                 
04242  |'                        Do Until gblnDyEOF()     ||04215  |'                        Do Until gblnDyEOF()     
04243  |'                            dlngCnt = dlngCnt + 1||04216  |'                            dlngCnt = dlngCnt + 1
04244  |'                            '抽出データセット    ||04217  |'                            '抽出データセット    
04245  |'                            dstrCaldate(dlngCnt) ||04218  |'                            dstrCaldate(dlngCnt) 
04246  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    ||04219  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    
04247  |'                            Call gDyNext         ||04220  |'                            Call gDyNext         
04248  |'                        Loop                     ||04221  |'                        Loop                     
04249  |'                                                 ||04222  |'                                                 
04250  |'                                                 ||04223  |'                                                 
04251  |'                        '2005/08/26　START       ||04224  |'                        '2005/08/26　START       
04252  |'                        '変数sStartに格納されてい||04225  |'                        '変数sStartに格納されてい
04253  |'                        '変数sStartの直近の営業日||04226  |'                        '変数sStartの直近の営業日
04254  |'                        '（変数sStartに格納されて||04227  |'                        '（変数sStartに格納されて
04255  |'                        '　直近日付が存在しない場||04228  |'                        '　直近日付が存在しない場
04256  |'                                                 ||04229  |'                                                 
04257  |'                        sSql = ""                ||04230  |'                        sSql = ""                
04258  |'                        sSql = sSql & "SELECT MAX||04231  |'                        sSql = sSql & "SELECT MAX
04259  |'                        sSql = sSql & "FROM   CFR||04232  |'                        sSql = sSql & "FROM   CFR
04260  |'                        sSql = sSql & "WHERE  BAS||04233  |'                        sSql = sSql & "WHERE  BAS
04261  |'                        sSql = sSql & "AND    ACC||04234  |'                        sSql = sSql & "AND    ACC
04262  |'                                                 ||04235  |'                                                 
04263  |'                        'ﾀﾞｲﾅｾｯﾄの作成           ||04236  |'                        'ﾀﾞｲﾅｾｯﾄの作成           
04264  |'                        If gintDyCreate(sSql) = F||04237  |'                        If gintDyCreate(sSql) = F
04265  |'                            Exit Function        ||04238  |'                            Exit Function        
04266  |'                        End If                   ||04239  |'                        End If                   
04267  |'                                                 ||04240  |'                                                 
04268  |'                        Do Until gblnDyEOF()     ||04241  |'                        Do Until gblnDyEOF()     
04269  |'                           '抽出データセット     ||04242  |'                           '抽出データセット     
04270  |'                            sStart = gvlnDyDataS(||04243  |'                            sStart = gvlnDyDataS(
04271  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    ||04244  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    
04272  |'                            Call gDyNext         ||04245  |'                            Call gDyNext         
04273  |'                        Loop                     ||04246  |'                        Loop                     
04274  |'                                                 ||04247  |'                                                 
04275  |'                        '2005/08/26　END         ||04248  |'                        '2005/08/26　END         
04276  |'                                                 ||04249  |'                                                 
04277  |'                        sSql = ""                ||04250  |'                        sSql = ""                
04278  |'                        sSql = sSql & "SELECT ACC||04251  |'                        sSql = sSql & "SELECT ACC
04279  |'                        sSql = sSql & "WHERE (((C||04252  |'                        sSql = sSql & "WHERE (((C
04280  |'                        sSql = sSql & "AND ((CFR_||04253  |'                        sSql = sSql & "AND ((CFR_
04281  |'                        sSql = sSql & "AND ((CFR_||04254  |'                        sSql = sSql & "AND ((CFR_
04282  |'                        sSql = sSql & "ORDER BY C||04255  |'                        sSql = sSql & "ORDER BY C
04283  |'                                                 ||04256  |'                                                 
04284  |'                        If gintDyCreate(sSql) = F||04257  |'                        If gintDyCreate(sSql) = F
04285  |'                            Exit Function        ||04258  |'                            Exit Function        
04286  |'                        End If                   ||04259  |'                        End If                   
04287  |'                                                 ||04260  |'                                                 
04288  |''2005/03/25 Start                                ||04261  |''2005/03/25 Start                                
04289  |'                        dlngCntsv = dlngCnt      ||04262  |'                        dlngCntsv = dlngCnt      
04290  |''2005/03/25 End                                  ||04263  |''2005/03/25 End                                  
04291  |'                        dlngCnt = 0              ||04264  |'                        dlngCnt = 0              
04292  |'                                                 ||04265  |'                                                 
04293  |'                        Do Until gblnDyEOF()     ||04266  |'                        Do Until gblnDyEOF()     
04294  |'                            dlngCnt = dlngCnt + 1||04267  |'                            dlngCnt = dlngCnt + 1
04295  |'                            '抽出データセット    ||04268  |'                            '抽出データセット    
04296  |'                            dstrBasedate = gvlnDy||04269  |'                            dstrBasedate = gvlnDy
04297  |'                            If Mid(dstrCaldate(dl||04270  |'                            If Mid(dstrCaldate(dl
04298  |'                                ddblDailynav(dlng||04271  |'                                ddblDailynav(dlng
04299  |'                            Else                 ||04272  |'                            Else                 
04300  |'                                '計算開始日が外部||04273  |'                                '計算開始日が外部
04301  |'                                If ddblNearNav <>||04274  |'                                If ddblNearNav <>
04302  |'                                And dlngCnt = 1 T||04275  |'                                And dlngCnt = 1 T
04303  |'                                    dstrCaldate2 ||04276  |'                                    dstrCaldate2 
04304  |'                                    dstrBasedate2||04277  |'                                    dstrBasedate2
04305  |'                                    dlngDiffdate ||04278  |'                                    dlngDiffdate 
04306  |'                                                 ||04279  |'                                                 
04307  |'                                    For dintFor2 ||04280  |'                                    For dintFor2 
04308  |'                                        ddblDaily||04281  |'                                        ddblDaily
04309  |'                                        dlngCnt =||04282  |'                                        dlngCnt =
04310  |'                                    Next dintFor2||04283  |'                                    Next dintFor2
04311  |'                                    ddblDailynav(||04284  |'                                    ddblDailynav(
04312  |'                                Else             ||04285  |'                                Else             
04313  |'                                    '日次NAVにデ ||04286  |'                                    '日次NAVにデ 
04314  |'                                    dstrCaldate2 ||04287  |'                                    dstrCaldate2 
04315  |'                                    dstrBasedate2||04288  |'                                    dstrBasedate2
04316  |'                                    dlngDiffdate ||04289  |'                                    dlngDiffdate 
04317  |'                                                 ||04290  |'                                                 
04318  |'                                    For dintFor2 ||04291  |'                                    For dintFor2 
04319  |'                                        If ddblDa||04292  |'                                        If ddblDa
04320  |'                                            ddblD||04293  |'                                            ddblD
04321  |'                                        Else     ||04294  |'                                        Else     
04322  |'                                            '日次||04295  |'                                            '日次
04323  |'                                            intRt||04296  |'                                            intRt
04324  |'                                            vbLf ||04297  |'                                            vbLf 
04325  |'                                            vbLf ||04298  |'                                            vbLf 
04326  |'                                                v||04299  |'                                                v
04327  |'                                            Exit ||04300  |'                                            Exit 
04328  |'                                        End If   ||04301  |'                                        End If   
04329  |'                                        dlngCnt =||04302  |'                                        dlngCnt =
04330  |'                                    Next dintFor2||04303  |'                                    Next dintFor2
04331  |'                                    ddblDailynav(||04304  |'                                    ddblDailynav(
04332  |'                                End If           ||04305  |'                                End If           
04333  |'                                                 ||04306  |'                                                 
04334  |'                            End If               ||04307  |'                            End If               
04335  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    ||04308  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    
04336  |'                            Call gDyNext         ||04309  |'                            Call gDyNext         
04337  |'                        Loop                     ||04310  |'                        Loop                     
04338  |'                                                 ||04311  |'                                                 
04339  |'                    Next dintFor                 ||04312  |'                    Next dintFor                 
04340  |'                                                 ||04313  |'                                                 
04341  |''2005/03/25 Start                                ||04314  |''2005/03/25 Start                                
04342  |'                    If dlngCntsv <> dlngCnt Then ||04315  |'                    If dlngCntsv <> dlngCnt Then 
04343  |'                        For dintFor2 = dlngCnt + ||04316  |'                        For dintFor2 = dlngCnt + 
04344  |'                            ddblDailynav(dintFor2||04317  |'                            ddblDailynav(dintFor2
04345  |'                        Next dintFor2            ||04318  |'                        Next dintFor2            
04346  |'                        dlngCnt = dlngCntsv      ||04319  |'                        dlngCnt = dlngCntsv      
04347  |'                    End If                       ||04320  |'                    End If                       
04348  |''2005/03/25 End                                  ||04321  |''2005/03/25 End                                  
04349  |'                                                 ||04322  |'                                                 
04350  |'                    ddblTtalnav = 0              ||04323  |'                    ddblTtalnav = 0              
04351  |'                                                 ||04324  |'                                                 
04352  |'                    For dintFor2 = 1 To dlngCnt  ||04325  |'                    For dintFor2 = 1 To dlngCnt  
04353  |'                        ddblTtalnav = ddblTtalnav||04326  |'                        ddblTtalnav = ddblTtalnav
04354  |'                    Next dintFor2                ||04327  |'                    Next dintFor2                
04355  |'                                                 ||04328  |'                                                 
04356  |'                    iRowCnt = dlngCnt            ||04329  |'                    iRowCnt = dlngCnt            
04357  |'                    TotalNav = ddblTtalnav       ||04330  |'                    TotalNav = ddblTtalnav       
04358  |'                    dblValueIn = TotalNav        ||04331  |'                    dblValueIn = TotalNav        
04359  |'                    Call sbGetRoundValue2(dblValu||04332  |'                    Call sbGetRoundValue2(dblValu
04360  |'                    TotalNav = dblValueOut       ||04333  |'                    TotalNav = dblValueOut       
04361  |''2005/03/09 End                                  ||04334  |''2005/03/09 End                                  
04362  |''2005/03/09 Start                                ||04335  |''2005/03/09 Start                                
04363  |'                      '合計(月末純資産)          ||04336  |'                      '合計(月末純資産)          
04364  |'                      .Cells(17, 23).NumberFormat||04337  |'                      .Cells(17, 23).NumberFormat
04365  |'                        If gbuMGetUPDRec.N(lRecId||04338  |'                        If gbuMGetUPDRec.N(lRecId
04366  |'                            .Cells(17, 23).Value ||04339  |'                            .Cells(17, 23).Value 
04367  |'                        Else                     ||04340  |'                        Else                     
04368  |'                            .Cells(17, 23).Value ||04341  |'                            .Cells(17, 23).Value 
04369  |'                        End If                   ||04342  |'                        End If                   
04370  |'                      .Cells(17, 23).HorizontalAl||04343  |'                      .Cells(17, 23).HorizontalAl
04371  |'                        '平均純資産総額          ||04344  |'                        '平均純資産総額          
04372  |'                        .Cells(36, 2).Value = sWo||04345  |'                        .Cells(36, 2).Value = sWo
04373  |'                        .Cells(36, 11).Value = sW||04346  |'                        .Cells(36, 11).Value = sW
04374  |'                      '計算期間の純資産総額の合計||04347  |'                      '計算期間の純資産総額の合計
04375  |'                      .Cells(36, 23).NumberFormat||04348  |'                      .Cells(36, 23).NumberFormat
04376  |'                        If gbuMGetUPDRec.N(lRecId||04349  |'                        If gbuMGetUPDRec.N(lRecId
04377  |'                            .Cells(36, 23).Value ||04350  |'                            .Cells(36, 23).Value 
04378  |'                        Else                     ||04351  |'                        Else                     
04379  |'                            .Cells(36, 23).Value ||04352  |'                            .Cells(36, 23).Value 
04380  |'                        End If                   ||04353  |'                        End If                   
04381  |'                      .Cells(36, 23).HorizontalAl||04354  |'                      .Cells(36, 23).HorizontalAl
04382  |'                      '計算期間の純資産総額の合計||04355  |'                      '計算期間の純資産総額の合計
04383  |'                      .Cells(36, 35).NumberFormat||04356  |'                      .Cells(36, 35).NumberFormat
04384  |'                      dblValueIn = TotalNav / iRo||04357  |'                      dblValueIn = TotalNav / iRo
04385  |'                      If gbuMGetUPDRec.N(lRecIdx)||04358  |'                      If gbuMGetUPDRec.N(lRecIdx)
04386  |'                            Call sbGetRoundValue2||04359  |'                            Call sbGetRoundValue2
04387  |'                      Else                       ||04360  |'                      Else                       
04388  |'                            Call sbGetRoundValue(||04361  |'                            Call sbGetRoundValue(
04389  |'                      End If                     ||04362  |'                      End If                     
04390  |'                        If gbuMGetUPDRec.N(lRecId||04363  |'                        If gbuMGetUPDRec.N(lRecId
04391  |'                            .Cells(36, 35).Value ||04364  |'                            .Cells(36, 35).Value 
04392  |'                        Else                     ||04365  |'                        Else                     
04393  |'                            .Cells(36, 35).Value ||04366  |'                            .Cells(36, 35).Value 
04394  |'                        End If                   ||04367  |'                        End If                   
04395  |'                        AvgNav = dblValueOut     ||04368  |'                        AvgNav = dblValueOut     
04396  |'                      '÷??＝                    ||04369  |'                      '÷??＝                    
04397  |'                      .Cells(36, 26).Value = sWor||04370  |'                      .Cells(36, 26).Value = sWor
04398  |'        End If                                   ||04371  |'        End If                                   
04399  |''2005/03/09 End                                  ||04372  |''2005/03/09 End                                  
04400  |''2005/03/09 Start                                ||04373  |''2005/03/09 Start                                
04401  |''                '契約区分：業務サービス料計算   ||04374  |''                '契約区分：業務サービス料計算   
04402  |''                Case mstrContractFlag(2)        ||04375  |''                Case mstrContractFlag(2)        
04403  |''                    '月次NAVを累積              ||04376  |''                    '月次NAVを累積              
04404  |''                      For i = LBound(gtypcfr_mna||04377  |''                      For i = LBound(gtypcfr_mna
04405  |''                      '2004/09/28 Start         ||04378  |''                      '2004/09/28 Start         
04406  |''            '              '日付                ||04379  |''            '              '日付                
04407  |''            '              .Cells(20 + i, 15).Va||04380  |''            '              .Cells(20 + i, 15).Va
04408  |''            '                  Mid(gtypcfr_mnav_||04381  |''            '                  Mid(gtypcfr_mnav_
04409  |''            '                      WordYear & CI||04382  |''            '                      WordYear & CI
04410  |''            '              '純資産              ||04383  |''            '              '純資産              
04411  |''            '              .Cells(20 + i, 37).Nu||04384  |''            '              .Cells(20 + i, 37).Nu
04412  |''            '              .Cells(20 + i, 37).Va||04385  |''            '              .Cells(20 + i, 37).Va
04413  |''            '              .Cells(20 + i, 37).Ho||04386  |''            '              .Cells(20 + i, 37).Ho
04414  |''            '              TotalNav = TotalNav +||04387  |''            '              TotalNav = TotalNav +
04415  |''            '              iRowCnt = iRowCnt + 1||04388  |''            '              iRowCnt = iRowCnt + 1
04416  |''                          If Len(gtypcfr_mnav_tb||04389  |''                          If Len(gtypcfr_mnav_tb
04417  |'''2005/01/12 Start                               ||04390  |'''2005/01/12 Start                               
04418  |''                            '日付               ||04391  |''                            '日付               
04419  |''                            .Cells(20 + i, 15).V||04392  |''                            .Cells(20 + i, 15).V
04420  |''                                Mid(gtypcfr_mnav||04393  |''                                Mid(gtypcfr_mnav
04421  |''                                    WordYear & C||04394  |''                                    WordYear & C
04422  |'''                            '純資産            ||04395  |'''                            '純資産            
04423  |'''                            .Cells(20 + i, 37).||04396  |'''                            .Cells(20 + i, 37).
04424  |''''2005/01/11 Start                              ||04397  |''''2005/01/11 Start                              
04425  |''''                            .Cells(20 + i, 37)||04398  |''''                            .Cells(20 + i, 37)
04426  |'''                            .Cells(20 + i, 37).||04399  |'''                            .Cells(20 + i, 37).
04427  |''''2005/01/11 End                                ||04400  |''''2005/01/11 End                                
04428  |'''                            .Cells(20 + i, 37).||04401  |'''                            .Cells(20 + i, 37).
04429  |'''                            '日付              ||04402  |'''                            '日付              
04430  |'''                            .Cells(20 + i, 13).||04403  |'''                            .Cells(20 + i, 13).
04431  |'''                                Mid(gtypcfr_mna||04404  |'''                                Mid(gtypcfr_mna
04432  |'''                                    WordYear & ||04405  |'''                                    WordYear & 
04433  |''                            '純資産             ||04406  |''                            '純資産             
04434  |'''                            .Cells(20 + i, 37).||04407  |'''                            .Cells(20 + i, 37).
04435  |''                            .Cells(20 + i, 39).N||04408  |''                            .Cells(20 + i, 39).N
04436  |'''2005/01/11 Start                               ||04409  |'''2005/01/11 Start                               
04437  |'''                            .Cells(20 + i, 37).||04410  |'''                            .Cells(20 + i, 37).
04438  |'''                            .Cells(20 + i, 37).||04411  |'''                            .Cells(20 + i, 37).
04439  |'''2005/01/20 Start                               ||04412  |'''2005/01/20 Start                               
04440  |'''                            .Cells(20 + i, 39).||04413  |'''                            .Cells(20 + i, 39).
04441  |''                            If gbuMGetUPDRec.N(l||04414  |''                            If gbuMGetUPDRec.N(l
04442  |''                                .Cells(20 + i, 3||04415  |''                                .Cells(20 + i, 3
04443  |''                            Else                ||04416  |''                            Else                
04444  |''                                .Cells(20 + i, 3||04417  |''                                .Cells(20 + i, 3
04445  |''                            End If              ||04418  |''                            End If              
04446  |'''2005/01/20 End                                 ||04419  |'''2005/01/20 End                                 
04447  |'''2005/01/11 End                                 ||04420  |'''2005/01/11 End                                 
04448  |'''                            .Cells(20 + i, 37).||04421  |'''                            .Cells(20 + i, 37).
04449  |''                            .Cells(20 + i, 39).H||04422  |''                            .Cells(20 + i, 39).H
04450  |'''2005/01/12 End                                 ||04423  |'''2005/01/12 End                                 
04451  |''                            TotalNav = TotalNav ||04424  |''                            TotalNav = TotalNav 
04452  |''                            iRowCnt = iRowCnt + ||04425  |''                            iRowCnt = iRowCnt + 
04453  |''                          Else                  ||04426  |''                          Else                  
04454  |''                            Mnav_Flg = 1        ||04427  |''                            Mnav_Flg = 1        
04455  |''                          End If                ||04428  |''                          End If                
04456  |''                      '2004/09/28 End           ||04429  |''                      '2004/09/28 End           
04457  |''                      Next i                    ||04430  |''                      Next i                    
04458  |''                    '日次NAVを算出              ||04431  |''                    '日次NAVを算出              
04459  |''                    '2004/09/28 Start           ||04432  |''                    '2004/09/28 Start           
04460  |''                      If Mnav_Flg = 1 Then      ||04433  |''                      If Mnav_Flg = 1 Then      
04461  |''                        i = i - 1               ||04434  |''                        i = i - 1               
04462  |''                      End If                    ||04435  |''                      End If                    
04463  |''                    '2004/09/28 End             ||04436  |''                    '2004/09/28 End             
04464  |''                      If mstrDailyNav <> "" Then||04437  |''                      If mstrDailyNav <> "" Then
04465  |'''2005/01/12 Start                               ||04438  |'''2005/01/12 Start                               
04466  |''                          '日付                 ||04439  |''                          '日付                 
04467  |''                          .Cells(20 + i, 15).Val||04440  |''                          .Cells(20 + i, 15).Val
04468  |'''                          '純資産              ||04441  |'''                          '純資産              
04469  |'''                          .Cells(20 + i, 37).Nu||04442  |'''                          .Cells(20 + i, 37).Nu
04470  |''''2005/01/11 Start                              ||04443  |''''2005/01/11 Start                              
04471  |''''                          .Cells(20 + i, 37).V||04444  |''''                          .Cells(20 + i, 37).V
04472  |'''                          .Cells(20 + i, 37).Va||04445  |'''                          .Cells(20 + i, 37).Va
04473  |''''2005/01/11 End                                ||04446  |''''2005/01/11 End                                
04474  |'''                          .Cells(20 + i, 37).Ho||04447  |'''                          .Cells(20 + i, 37).Ho
04475  |'''                          '日付                ||04448  |'''                          '日付                
04476  |'''                          .Cells(20 + i, 13).Va||04449  |'''                          .Cells(20 + i, 13).Va
04477  |''                          '純資産               ||04450  |''                          '純資産               
04478  |'''                          .Cells(20 + i, 37).Nu||04451  |'''                          .Cells(20 + i, 37).Nu
04479  |''                          .Cells(20 + i, 39).Num||04452  |''                          .Cells(20 + i, 39).Num
04480  |'''2005/01/11 Start                               ||04453  |'''2005/01/11 Start                               
04481  |'''                          .Cells(20 + i, 37).Va||04454  |'''                          .Cells(20 + i, 37).Va
04482  |'''                          .Cells(20 + i, 37).Va||04455  |'''                          .Cells(20 + i, 37).Va
04483  |'''2005/01/20 Start                               ||04456  |'''2005/01/20 Start                               
04484  |'''                          .Cells(20 + i, 39).Va||04457  |'''                          .Cells(20 + i, 39).Va
04485  |''                            If gbuMGetUPDRec.N(l||04458  |''                            If gbuMGetUPDRec.N(l
04486  |''                                .Cells(20 + i, 3||04459  |''                                .Cells(20 + i, 3
04487  |''                            Else                ||04460  |''                            Else                
04488  |''                                .Cells(20 + i, 3||04461  |''                                .Cells(20 + i, 3
04489  |''                            End If              ||04462  |''                            End If              
04490  |'''2005/01/20 End                                 ||04463  |'''2005/01/20 End                                 
04491  |'''2005/01/11 End                                 ||04464  |'''2005/01/11 End                                 
04492  |'''                          .Cells(20 + i, 37).Ho||04465  |'''                          .Cells(20 + i, 37).Ho
04493  |''                          .Cells(20 + i, 39).Hor||04466  |''                          .Cells(20 + i, 39).Hor
04494  |'''2005/01/12 End                                 ||04467  |'''2005/01/12 End                                 
04495  |''                          TotalNav = TotalNav + ||04468  |''                          TotalNav = TotalNav + 
04496  |''                          iRowCnt = iRowCnt + 1 ||04469  |''                          iRowCnt = iRowCnt + 1 
04497  |''                      End If                    ||04470  |''                      End If                    
04498  |'''2005/01/12 Start                               ||04471  |'''2005/01/12 Start                               
04499  |'''                      '対象締日データ抽出      ||04472  |'''                      '対象締日データ抽出      
04500  |'''                      .Cells(20, 37).NumberForm||04473  |'''                      .Cells(20, 37).NumberForm
04501  |''''2005/01/11 Start                              ||04474  |''''2005/01/11 Start                              
04502  |''''                      .Cells(20, 37).Value = C||04475  |''''                      .Cells(20, 37).Value = C
04503  |'''                      .Cells(20, 37).Value = CS||04476  |'''                      .Cells(20, 37).Value = CS
04504  |''''2005/01/11 End                                ||04477  |''''2005/01/11 End                                
04505  |'''                      .Cells(20, 37).Horizontal||04478  |'''                      .Cells(20, 37).Horizontal
04506  |'''                      '合計(月末純資産)        ||04479  |'''                      '合計(月末純資産)        
04507  |'''                      .Cells(33, 37).NumberForm||04480  |'''                      .Cells(33, 37).NumberForm
04508  |''''2005/01/11 Start                              ||04481  |''''2005/01/11 Start                              
04509  |''''                      .Cells(33, 37).Value = C||04482  |''''                      .Cells(33, 37).Value = C
04510  |'''                      .Cells(33, 37).Value = CS||04483  |'''                      .Cells(33, 37).Value = CS
04511  |''''2005/01/11 End                                ||04484  |''''2005/01/11 End                                
04512  |'''                      .Cells(33, 37).Horizontal||04485  |'''                      .Cells(33, 37).Horizontal
04513  |'''                      '計算期間の純資産総額の合||04486  |'''                      '計算期間の純資産総額の合
04514  |'''                      .Cells(36, 23).NumberForm||04487  |'''                      .Cells(36, 23).NumberForm
04515  |''''2005/01/11 Start                              ||04488  |''''2005/01/11 Start                              
04516  |''''                      .Cells(36, 23).Value = C||04489  |''''                      .Cells(36, 23).Value = C
04517  |'''                      .Cells(36, 23).Value = CS||04490  |'''                      .Cells(36, 23).Value = CS
04518  |''''2005/01/11 End                                ||04491  |''''2005/01/11 End                                
04519  |'''                      .Cells(36, 23).Horizontal||04492  |'''                      .Cells(36, 23).Horizontal
04520  |'''                      '計算期間の純資産総額の合||04493  |'''                      '計算期間の純資産総額の合
04521  |'''                      .Cells(36, 35).NumberForm||04494  |'''                      .Cells(36, 35).NumberForm
04522  |''''''''2005/01/18 Start　業務サービス料のときは明||04495  |''''''''2005/01/18 Start　業務サービス料のときは明
04523  |'''''''                      '対象締日データ抽出  ||04496  |'''''''                      '対象締日データ抽出  
04524  |'''''''                      .Cells(20, 37).Number||04497  |'''''''                      .Cells(20, 37).Number
04525  |''''''''2005/01/11 Start                          ||04498  |''''''''2005/01/11 Start                          
04526  |''''''''                      .Cells(20, 37).Value||04499  |''''''''                      .Cells(20, 37).Value
04527  |'''''''                      .Cells(20, 37).Value ||04500  |'''''''                      .Cells(20, 37).Value 
04528  |''''''''2005/01/11 End                            ||04501  |''''''''2005/01/11 End                            
04529  |'''''''                      .Cells(20, 37).Horizo||04502  |'''''''                      .Cells(20, 37).Horizo
04530  |''''''''2005/01/18 End                            ||04503  |''''''''2005/01/18 End                            
04531  |''                      '合計(月末純資産)         ||04504  |''                      '合計(月末純資産)         
04532  |'''                      .Cells(33, 37).NumberForm||04505  |'''                      .Cells(33, 37).NumberForm
04533  |''                      .Cells(33, 39).NumberForma||04506  |''                      .Cells(33, 39).NumberForma
04534  |'''2005/01/11 Start                               ||04507  |'''2005/01/11 Start                               
04535  |'''                      .Cells(33, 37).Value = CS||04508  |'''                      .Cells(33, 37).Value = CS
04536  |'''                      .Cells(33, 37).Value = CS||04509  |'''                      .Cells(33, 37).Value = CS
04537  |'''2005/01/20 Start                               ||04510  |'''2005/01/20 Start                               
04538  |'''                      .Cells(33, 39).Value = CS||04511  |'''                      .Cells(33, 39).Value = CS
04539  |''                        If gbuMGetUPDRec.N(lRecI||04512  |''                        If gbuMGetUPDRec.N(lRecI
04540  |''                            .Cells(33, 39).Value||04513  |''                            .Cells(33, 39).Value
04541  |''                        Else                    ||04514  |''                        Else                    
04542  |''                            .Cells(33, 39).Value||04515  |''                            .Cells(33, 39).Value
04543  |''                        End If                  ||04516  |''                        End If                  
04544  |'''2005/01/20 End                                 ||04517  |'''2005/01/20 End                                 
04545  |'''2005/01/11 End                                 ||04518  |'''2005/01/11 End                                 
04546  |'''                      .Cells(33, 37).Horizontal||04519  |'''                      .Cells(33, 37).Horizontal
04547  |''                      .Cells(33, 39).HorizontalA||04520  |''                      .Cells(33, 39).HorizontalA
04548  |''                      '計算期間の純資産総額の合 ||04521  |''                      '計算期間の純資産総額の合 
04549  |'''                      .Cells(36, 21).NumberForm||04522  |'''                      .Cells(36, 21).NumberForm
04550  |''                      .Cells(36, 23).NumberForma||04523  |''                      .Cells(36, 23).NumberForma
04551  |'''2005/01/11 Start                               ||04524  |'''2005/01/11 Start                               
04552  |'''                      .Cells(36, 23).Value = CS||04525  |'''                      .Cells(36, 23).Value = CS
04553  |'''                      .Cells(36, 21).Value = CS||04526  |'''                      .Cells(36, 21).Value = CS
04554  |'''2005/01/20 Start                               ||04527  |'''2005/01/20 Start                               
04555  |'''                      .Cells(36, 23).Value = CS||04528  |'''                      .Cells(36, 23).Value = CS
04556  |''                        If gbuMGetUPDRec.N(lRecI||04529  |''                        If gbuMGetUPDRec.N(lRecI
04557  |''                            .Cells(36, 23).Value||04530  |''                            .Cells(36, 23).Value
04558  |''                        Else                    ||04531  |''                        Else                    
04559  |''                            .Cells(36, 23).Value||04532  |''                            .Cells(36, 23).Value
04560  |''                        End If                  ||04533  |''                        End If                  
04561  |'''2005/01/20 End                                 ||04534  |'''2005/01/20 End                                 
04562  |'''2005/01/11 End                                 ||04535  |'''2005/01/11 End                                 
04563  |'''                      .Cells(36, 21).Horizontal||04536  |'''                      .Cells(36, 21).Horizontal
04564  |''                      .Cells(36, 23).HorizontalA||04537  |''                      .Cells(36, 23).HorizontalA
04565  |''                      '計算期間の純資産総額の合 ||04538  |''                      '計算期間の純資産総額の合 
04566  |'''                      .Cells(36, 33).NumberForm||04539  |'''                      .Cells(36, 33).NumberForm
04567  |''                      .Cells(36, 35).NumberForma||04540  |''                      .Cells(36, 35).NumberForma
04568  |'''2005/01/12 End                                 ||04541  |'''2005/01/12 End                                 
04569  |''            '2004/11/17 Start                   ||04542  |''            '2004/11/17 Start                   
04570  |''            '          .Cells(35, 35).NumberForm||04543  |''            '          .Cells(35, 35).NumberForm
04571  |''            '          .Cells(35, 35).Value = CS||04544  |''            '          .Cells(35, 35).Value = CS
04572  |''            '          .Cells(36, 35).Value = CS||04545  |''            '          .Cells(36, 35).Value = CS
04573  |''                      dblValueIn = TotalNav / iR||04546  |''                      dblValueIn = TotalNav / iR
04574  |''''''''2005/01/11 Start                          ||04547  |''''''''2005/01/11 Start                          
04575  |'''''''                    Select Case gbuMGetUPDR||04548  |'''''''                    Select Case gbuMGetUPDR
04576  |'''''''                      Case "1"    '固定料率||04549  |'''''''                      Case "1"    '固定料率
04577  |'''''''                          'NAV通貨と外部委 ||04550  |'''''''                          'NAV通貨と外部委 
04578  |'''''''                          If gbuMGetUPDRec.||04551  |'''''''                          If gbuMGetUPDRec.
04579  |'''''''                              '外部委託顧問||04552  |'''''''                              '外部委託顧問
04580  |'''''''                              If gbuMGetUPD||04553  |'''''''                              If gbuMGetUPD
04581  |'''''''                              End If       ||04554  |'''''''                              End If       
04582  |'''''''                          End If           ||04555  |'''''''                          End If           
04583  |'''''''                          'NAV通貨と外部委 ||04556  |'''''''                          'NAV通貨と外部委 
04584  |'''''''                          If gbuMGetUPDRec.||04557  |'''''''                          If gbuMGetUPDRec.
04585  |'''''''                              '外部委託顧問||04558  |'''''''                              '外部委託顧問
04586  |'''''''                              If gbuMGetUPD||04559  |'''''''                              If gbuMGetUPD
04587  |'''''''                              End If       ||04560  |'''''''                              End If       
04588  |'''''''                          End If           ||04561  |'''''''                          End If           
04589  |'''''''                      Case "2"    '段階料率||04562  |'''''''                      Case "2"    '段階料率
04590  |'''''''                          'NAV通貨と閾値通 ||04563  |'''''''                          'NAV通貨と閾値通 
04591  |'''''''                          If gbuMGetUPDRec.||04564  |'''''''                          If gbuMGetUPDRec.
04592  |'''''''                              '閾値通貨と外||04565  |'''''''                              '閾値通貨と外
04593  |'''''''                              If gbuMGetUPD||04566  |'''''''                              If gbuMGetUPD
04594  |'''''''                                  '外部委託||04567  |'''''''                                  '外部委託
04595  |'''''''                                  If gbuMGe||04568  |'''''''                                  If gbuMGe
04596  |'''''''                                      dblVa||04569  |'''''''                                      dblVa
04597  |'''''''                                  End If   ||04570  |'''''''                                  End If   
04598  |'''''''                              End If       ||04571  |'''''''                              End If       
04599  |'''''''                          End If           ||04572  |'''''''                          End If           
04600  |'''''''                          'NAV通貨と閾値通 ||04573  |'''''''                          'NAV通貨と閾値通 
04601  |'''''''                          If gbuMGetUPDRec.||04574  |'''''''                          If gbuMGetUPDRec.
04602  |'''''''                              '閾値通貨と外||04575  |'''''''                              '閾値通貨と外
04603  |'''''''                              If gbuMGetUPD||04576  |'''''''                              If gbuMGetUPD
04604  |'''''''                                  '外部委託||04577  |'''''''                                  '外部委託
04605  |'''''''                                  If gbuMGe||04578  |'''''''                                  If gbuMGe
04606  |'''''''                                      dblVa||04579  |'''''''                                      dblVa
04607  |'''''''                                  End If   ||04580  |'''''''                                  End If   
04608  |'''''''                              End If       ||04581  |'''''''                              End If       
04609  |'''''''                          End If           ||04582  |'''''''                          End If           
04610  |'''''''                    End Select             ||04583  |'''''''                    End Select             
04611  |''''''''2005/01/11 End                            ||04584  |''''''''2005/01/11 End                            
04612  |'''2005/01/13 Start                               ||04585  |'''2005/01/13 Start                               
04613  |'''                      Call sbGetRoundValue(dblV||04586  |'''                      Call sbGetRoundValue(dblV
04614  |'''2005/01/20 Start                               ||04587  |'''2005/01/20 Start                               
04615  |'''                      Call sbGetRoundValue2(dbl||04588  |'''                      Call sbGetRoundValue2(dbl
04616  |''                      If gbuMGetUPDRec.N(lRecIdx||04589  |''                      If gbuMGetUPDRec.N(lRecIdx
04617  |''                        Call sbGetRoundValue2(db||04590  |''                        Call sbGetRoundValue2(db
04618  |''                      Else                      ||04591  |''                      Else                      
04619  |''                        Call sbGetRoundValue(dbl||04592  |''                        Call sbGetRoundValue(dbl
04620  |''                      End If                    ||04593  |''                      End If                    
04621  |'''2005/01/20 End                                 ||04594  |'''2005/01/20 End                                 
04622  |'''2005/01/13 End                                 ||04595  |'''2005/01/13 End                                 
04623  |'''2005/01/11 Start                               ||04596  |'''2005/01/11 Start                               
04624  |'''                      .Cells(36, 35).Value = CS||04597  |'''                      .Cells(36, 35).Value = CS
04625  |'''2005/01/12 Start                               ||04598  |'''2005/01/12 Start                               
04626  |''''平均NAV(計算対象NAV)                          ||04599  |''''平均NAV(計算対象NAV)                          
04627  |'''                      .Cells(36, 35).Value = CS||04600  |'''                      .Cells(36, 35).Value = CS
04628  |''''2005/01/11 End                                ||04601  |''''2005/01/11 End                                
04629  |'''            '2004/11/17 End                    ||04602  |'''            '2004/11/17 End                    
04630  |'''                      '÷??＝                  ||04603  |'''                      '÷??＝                  
04631  |'''                      .Cells(36, 26).Value = sW||04604  |'''                      .Cells(36, 26).Value = sW
04632  |'''平均NAV(計算対象NAV)                           ||04605  |'''平均NAV(計算対象NAV)                           
04633  |'''                      .Cells(36, 33).Value = CS||04606  |'''                      .Cells(36, 33).Value = CS
04634  |'''2005/01/20 Start                               ||04607  |'''2005/01/20 Start                               
04635  |'''                      .Cells(36, 35).Value = CS||04608  |'''                      .Cells(36, 35).Value = CS
04636  |''                        If gbuMGetUPDRec.N(lRecI||04609  |''                        If gbuMGetUPDRec.N(lRecI
04637  |''                            .Cells(36, 35).Value||04610  |''                            .Cells(36, 35).Value
04638  |''                        Else                    ||04611  |''                        Else                    
04639  |''                            .Cells(36, 35).Value||04612  |''                            .Cells(36, 35).Value
04640  |''                        End If                  ||04613  |''                        End If                  
04641  |'''2005/01/20 End                                 ||04614  |'''2005/01/20 End                                 
04642  |'''2005/01/11 End                                 ||04615  |'''2005/01/11 End                                 
04643  |''            '2004/11/17 End                     ||04616  |''            '2004/11/17 End                     
04644  |''                      '÷??＝                   ||04617  |''                      '÷??＝                   
04645  |'''                      .Cells(36, 24).Value = sW||04618  |'''                      .Cells(36, 24).Value = sW
04646  |''                      .Cells(36, 26).Value = sWo||04619  |''                      .Cells(36, 26).Value = sWo
04647  |'''2005/01/12 End                                 ||04620  |'''2005/01/12 End                                 
04648  |''            End Select                          ||04621  |''            End Select                          
04649  |'''2004/12/29 End                                 ||04622  |'''2004/12/29 End                                 
04650  |''2005/03/09 End                                  ||04623  |''2005/03/09 End                                  
04651  |''2005/03/09 Start                                ||04624  |''2005/03/09 Start                                
04652  |''        '契約区分：名称使用許諾料計算           ||04625  |''        '契約区分：名称使用許諾料計算           
04653  |''        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_con||04626  |''        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_con
04654  |'        '契約区分：名称使用許諾料計算　かつ　日次||04627  |'        '契約区分：名称使用許諾料計算　かつ　日次
04655  |'        Else                                     ||04628  |'        Else                                     
04656  |''2005/03/09 End                                  ||04629  |''2005/03/09 End                                  
04657  |'On Error GoTo OnErrorProc                        ||04630  |'On Error GoTo OnErrorProc                        
04658  |'                                                 ||04631  |'                                                 
04659  |'            '契約区分「3」の場合                 ||04632  |'            '契約区分「3」の場合                 
04660  |''2004/12/29 Start                                ||04633  |''2004/12/29 Start                                
04661  |''            Dim sStart As String    '計算対象　 ||04634  |''            Dim sStart As String    '計算対象　 
04662  |''            Dim sEnd As String      '計算対象　 ||04635  |''            Dim sEnd As String      '計算対象　 
04663  |''2004/12/29 End                                  ||04636  |''2004/12/29 End                                  
04664  |''2005/03/09 End                                  ||04637  |''2005/03/09 End                                  
04665  |''2005/03/09 Start                                ||04638  |''2005/03/09 Start                                
04666  |''            sStart = gstrDateFormat2(CStr(dStart||04639  |''            sStart = gstrDateFormat2(CStr(dStart
04667  |''            sEnd = gstrDateFormat2(CStr(dEnd), 1||04640  |''            sEnd = gstrDateFormat2(CStr(dEnd), 1
04668  |'''2004/09/21 Start                               ||04641  |'''2004/09/21 Start                               
04669  |'''            sCurrencyCode = gbuMGetUPDRec.N(lRe||04642  |'''            sCurrencyCode = gbuMGetUPDRec.N(lRe
04670  |'''            AccCode = gbuMGetUPDRec.N(lRecIdx).||04643  |'''            AccCode = gbuMGetUPDRec.N(lRecIdx).
04671  |'''            '日次NAVの平均を算出               ||04644  |'''            '日次NAVの平均を算出               
04672  |'''            sSql = gstrEditSQLcfr_DailyAvgForSe||04645  |'''            sSql = gstrEditSQLcfr_DailyAvgForSe
04673  |'''                AccCode, sStart, sEnd, sCurrenc||04646  |'''                AccCode, sStart, sEnd, sCurrenc
04674  |''            If NavGetCnt > 1 Then               ||04647  |''            If NavGetCnt > 1 Then               
04675  |''                '１契約複数口座の場合           ||04648  |''                '１契約複数口座の場合           
04676  |''                ContNo = gbuMGetUPDRec.N(lRecIdx||04649  |''                ContNo = gbuMGetUPDRec.N(lRecIdx
04677  |''                '日次NAVの平均を算出            ||04650  |''                '日次NAVの平均を算出            
04678  |''                sSql = gstrEditSQLcfr_DailyAvgFo||04651  |''                sSql = gstrEditSQLcfr_DailyAvgFo
04679  |''            Else                                ||04652  |''            Else                                
04680  |''                '１契約１口座の場合             ||04653  |''                '１契約１口座の場合             
04681  |''                sCurrencyCode = gbuMGetUPDRec.N(||04654  |''                sCurrencyCode = gbuMGetUPDRec.N(
04682  |''                AccCode = gbuMGetUPDRec.N(lRecId||04655  |''                AccCode = gbuMGetUPDRec.N(lRecId
04683  |''                '日次NAVの平均を算出            ||04656  |''                '日次NAVの平均を算出            
04684  |''                sSql = gstrEditSQLcfr_DailyAvgFo||04657  |''                sSql = gstrEditSQLcfr_DailyAvgFo
04685  |''            End If                              ||04658  |''            End If                              
04686  |'''2004/09/21 End                                 ||04659  |'''2004/09/21 End                                 
04687  |''            'ﾀﾞｲﾅｾｯﾄの作成                      ||04660  |''            'ﾀﾞｲﾅｾｯﾄの作成                      
04688  |''            If gintDyCreate(sSql) = False Then  ||04661  |''            If gintDyCreate(sSql) = False Then  
04689  |''                Exit Function                   ||04662  |''                Exit Function                   
04690  |''            End If                              ||04663  |''            End If                              
04691  |'''2005/01/06 Start                               ||04664  |'''2005/01/06 Start                               
04692  |'''            '対象締日データ抽出                ||04665  |'''            '対象締日データ抽出                
04693  |'''            .Cells(20, 37).NumberFormatLocal = ||04666  |'''            .Cells(20, 37).NumberFormatLocal = 
04694  |'''            .Cells(20, 37).Value = CStr(Format(||04667  |'''            .Cells(20, 37).Value = CStr(Format(
04695  |'''            .Cells(20, 37).HorizontalAlignment ||04668  |'''            .Cells(20, 37).HorizontalAlignment 
04696  |'''            '合計(月末純資産)                  ||04669  |'''            '合計(月末純資産)                  
04697  |'''            .Cells(33, 37).NumberFormatLocal = ||04670  |'''            .Cells(33, 37).NumberFormatLocal = 
04698  |'''            .Cells(33, 37).Value = CStr(Format(||04671  |'''            .Cells(33, 37).Value = CStr(Format(
04699  |'''            .Cells(33, 37).HorizontalAlignment ||04672  |'''            .Cells(33, 37).HorizontalAlignment 
04700  |'''            '投資顧問料計算用計算対象NAVに日次 ||04673  |'''            '投資顧問料計算用計算対象NAVに日次 
04701  |'''            If gvlnDyDataS("AVG(CFR_DAILY_NAV_T||04674  |'''            If gvlnDyDataS("AVG(CFR_DAILY_NAV_T
04702  |'''                lCalcNav = 0                   ||04675  |'''                lCalcNav = 0                   
04703  |'''            Else                               ||04676  |'''            Else                               
04704  |''''2004/11/17 Start                              ||04677  |''''2004/11/17 Start                              
04705  |''''                lCalcNav = Format(Round(gvlnDy||04678  |''''                lCalcNav = Format(Round(gvlnDy
04706  |'''                dblValueIn = gvlnDyDataN("AVG(C||04679  |'''                dblValueIn = gvlnDyDataN("AVG(C
04707  |'''                Call sbGetRoundValue(dblValueIn||04680  |'''                Call sbGetRoundValue(dblValueIn
04708  |'''                lCalcNav = CStr(Format(dblValue||04681  |'''                lCalcNav = CStr(Format(dblValue
04709  |''''2004/11/17 End                                ||04682  |''''2004/11/17 End                                
04710  |'''            End If                             ||04683  |'''            End If                             
04711  |''                                                ||04684  |''                                                
04712  |'''2005/01/20 Start                               ||04685  |'''2005/01/20 Start                               
04713  |'''            dstrAvgNav = gvlnDyDataS("AVG(CFR_D||04686  |'''            dstrAvgNav = gvlnDyDataS("AVG(CFR_D
04714  |''            dblValueIn = gvlnDyDataS("AVG(CFR_DA||04687  |''            dblValueIn = gvlnDyDataS("AVG(CFR_DA
04715  |''            If gbuMGetUPDRec.N(lRecIdx).MGET_bas||04688  |''            If gbuMGetUPDRec.N(lRecIdx).MGET_bas
04716  |''                Call sbGetRoundValue2(dblValueIn||04689  |''                Call sbGetRoundValue2(dblValueIn
04717  |''            Else                                ||04690  |''            Else                                
04718  |''                Call sbGetRoundValue(dblValueIn)||04691  |''                Call sbGetRoundValue(dblValueIn)
04719  |''            End If                              ||04692  |''            End If                              
04720  |''            dstrAvgNav = dblValueOut            ||04693  |''            dstrAvgNav = dblValueOut            
04721  |'''2005/01/20 End                                 ||04694  |'''2005/01/20 End                                 
04722  |''                                                ||04695  |''                                                
04723  |'''2005/03/09 Start                               ||04696  |'''2005/03/09 Start                               
04724  |''            If NavGetCnt > 1 Then               ||04697  |''            If NavGetCnt > 1 Then               
04725  |''                '１契約複数口座の場合           ||04698  |''                '１契約複数口座の場合           
04726  |''                ContNo = gbuMGetUPDRec.N(lRecIdx||04699  |''                ContNo = gbuMGetUPDRec.N(lRecIdx
04727  |''                '日次NAVの合計を算出            ||04700  |''                '日次NAVの合計を算出            
04728  |''                sSql = gstrEditSQLcfr_DailyAllFo||04701  |''                sSql = gstrEditSQLcfr_DailyAllFo
04729  |''            Else                                ||04702  |''            Else                                
04730  |''                '１契約１口座の場合             ||04703  |''                '１契約１口座の場合             
04731  |''                sCurrencyCode = gbuMGetUPDRec.N(||04704  |''                sCurrencyCode = gbuMGetUPDRec.N(
04732  |''                AccCode = gbuMGetUPDRec.N(lRecId||04705  |''                AccCode = gbuMGetUPDRec.N(lRecId
04733  |''                '日次NAVの合計を算出            ||04706  |''                '日次NAVの合計を算出            
04734  |''                sSql = gstrEditSQLcfr_DailyAllFo||04707  |''                sSql = gstrEditSQLcfr_DailyAllFo
04735  |''            End If                              ||04708  |''            End If                              
04736  |''            'ﾀﾞｲﾅｾｯﾄの作成                      ||04709  |''            'ﾀﾞｲﾅｾｯﾄの作成                      
04737  |''            If gintDyCreate(sSql) = False Then  ||04710  |''            If gintDyCreate(sSql) = False Then  
04738  |''                Exit Function                   ||04711  |''                Exit Function                   
04739  |''            End If                              ||04712  |''            End If                              
04740  |''                                                ||04713  |''                                                
04741  |''            ReDim dstrCaldate(gbxOraDynaset.Reco||04714  |''            ReDim dstrCaldate(gbxOraDynaset.Reco
04742  |''            ReDim ddblDailynav(gbxOraDynaset.Rec||04715  |''            ReDim ddblDailynav(gbxOraDynaset.Rec
04743  |''                                                ||04716  |''                                                
04744  |''            'EOF判定処理                        ||04717  |''            'EOF判定処理                        
04745  |''            dlngCnt = 0                         ||04718  |''            dlngCnt = 0                         
04746  |''                                                ||04719  |''                                                
04747  |''            Do Until gblnDyEOF()                ||04720  |''            Do Until gblnDyEOF()                
04748  |''                dlngCnt = dlngCnt + 1           ||04721  |''                dlngCnt = dlngCnt + 1           
04749  |''                '抽出データセット               ||04722  |''                '抽出データセット               
04750  |''                dstrCaldate(dlngCnt) = gvlnDyDat||04723  |''                dstrCaldate(dlngCnt) = gvlnDyDat
04751  |''                ddblDailynav(dlngCnt) = gvlnDyDa||04724  |''                ddblDailynav(dlngCnt) = gvlnDyDa
04752  |''                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ               ||04725  |''                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ               
04753  |''                Call gDyNext                    ||04726  |''                Call gDyNext                    
04754  |''            Loop                                ||04727  |''            Loop                                
04755  |''                                                ||04728  |''                                                
04756  |'''2005/03/09 End                                 ||04729  |'''2005/03/09 End                                 
04757  |'            ddblTtalnav = 0                      ||04730  |'            ddblTtalnav = 0                      
04758  |'            For dintFor = 0 To NavGetCnt - 1     ||04731  |'            For dintFor = 0 To NavGetCnt - 1     
04759  |'                                                 ||04732  |'                                                 
04760  |'                '日次NAV平均取得                 ||04733  |'                '日次NAV平均取得                 
04761  |'                sStart = gstrDateFormat2(CStr(dSt||04734  |'                sStart = gstrDateFormat2(CStr(dSt
04762  |'                sEnd = gstrDateFormat2(CStr(dEnd)||04735  |'                sEnd = gstrDateFormat2(CStr(dEnd)
04763  |'                                                 ||04736  |'                                                 
04764  |'                sSql = ""                        ||04737  |'                sSql = ""                        
04765  |'                sSql = sSql & "SELECT ACCOUNT_COD||04738  |'                sSql = sSql & "SELECT ACCOUNT_COD
04766  |'                sSql = sSql & "WHERE (((CFR_DAILY||04739  |'                sSql = sSql & "WHERE (((CFR_DAILY
04767  |'                sSql = sSql & "AND ((CFR_DAILY_NA||04740  |'                sSql = sSql & "AND ((CFR_DAILY_NA
04768  |'                sSql = sSql & "AND ((CFR_DAILY_NA||04741  |'                sSql = sSql & "AND ((CFR_DAILY_NA
04769  |'                sSql = sSql & "ORDER BY CFR_DAILY||04742  |'                sSql = sSql & "ORDER BY CFR_DAILY
04770  |'                                                 ||04743  |'                                                 
04771  |'                If gintDyCreate(sSql) = False The||04744  |'                If gintDyCreate(sSql) = False The
04772  |'                    Exit Function                ||04745  |'                    Exit Function                
04773  |'                End If                           ||04746  |'                End If                           
04774  |'                                                 ||04747  |'                                                 
04775  |'                If dlngCnt = 0 Then              ||04748  |'                If dlngCnt = 0 Then              
04776  |'                    ReDim dstrCaldate(gbxOraDynas||04749  |'                    ReDim dstrCaldate(gbxOraDynas
04777  |'                    ReDim ddblDailynav(gbxOraDyna||04750  |'                    ReDim ddblDailynav(gbxOraDyna
04778  |'                End If                           ||04751  |'                End If                           
04779  |'                                                 ||04752  |'                                                 
04780  |'                dlngCnt = 0                      ||04753  |'                dlngCnt = 0                      
04781  |'                                                 ||04754  |'                                                 
04782  |'                Do Until gblnDyEOF()             ||04755  |'                Do Until gblnDyEOF()             
04783  |'                    dlngCnt = dlngCnt + 1        ||04756  |'                    dlngCnt = dlngCnt + 1        
04784  |'                    '抽出データセット            ||04757  |'                    '抽出データセット            
04785  |'                    dstrCaldate(dlngCnt) = gvlnDy||04758  |'                    dstrCaldate(dlngCnt) = gvlnDy
04786  |'                    ddblDailynav(dlngCnt) = ddblD||04759  |'                    ddblDailynav(dlngCnt) = ddblD
04787  |'                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ            ||04760  |'                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ            
04788  |'                    Call gDyNext                 ||04761  |'                    Call gDyNext                 
04789  |'                Loop                             ||04762  |'                Loop                             
04790  |'                                                 ||04763  |'                                                 
04791  |'            Next dintFor                         ||04764  |'            Next dintFor                         
04792  |'                                                 ||04765  |'                                                 
04793  |'            ddblTtalnav = 0                      ||04766  |'            ddblTtalnav = 0                      
04794  |'                                                 ||04767  |'                                                 
04795  |'            For dintFor2 = 1 To dlngCnt          ||04768  |'            For dintFor2 = 1 To dlngCnt          
04796  |'                ddblTtalnav = ddblTtalnav + ddblD||04769  |'                ddblTtalnav = ddblTtalnav + ddblD
04797  |'            Next dintFor2                        ||04770  |'            Next dintFor2                        
04798  |'                                                 ||04771  |'                                                 
04799  |'            iRowCnt = dlngCnt                    ||04772  |'            iRowCnt = dlngCnt                    
04800  |''2005/03/18 Start                                ||04773  |''2005/03/18 Start                                
04801  |'            dlngMeisyoSu = dlngCnt               ||04774  |'            dlngMeisyoSu = dlngCnt               
04802  |''2005/03/18 End                                  ||04775  |''2005/03/18 End                                  
04803  |'            TotalNav = ddblTtalnav               ||04776  |'            TotalNav = ddblTtalnav               
04804  |'            dblValueIn = TotalNav                ||04777  |'            dblValueIn = TotalNav                
04805  |'            Call sbGetRoundValue2(dblValueIn)    ||04778  |'            Call sbGetRoundValue2(dblValueIn)    
04806  |'            TotalNav = dblValueOut               ||04779  |'            TotalNav = dblValueOut               
04807  |'                                                 ||04780  |'                                                 
04808  |'            '計算期間の純資産総額の合計÷計算期間||04781  |'            '計算期間の純資産総額の合計÷計算期間
04809  |'            dblValueIn = TotalNav / iRowCnt      ||04782  |'            dblValueIn = TotalNav / iRowCnt      
04810  |'            iCalcNum = iRowCnt                   ||04783  |'            iCalcNum = iRowCnt                   
04811  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base||04784  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base
04812  |'                  Call sbGetRoundValue2(dblValueI||04785  |'                  Call sbGetRoundValue2(dblValueI
04813  |'            Else                                 ||04786  |'            Else                                 
04814  |'                  Call sbGetRoundValue(dblValueIn||04787  |'                  Call sbGetRoundValue(dblValueIn
04815  |'            End If                               ||04788  |'            End If                               
04816  |'            dstrAvgNav = dblValueOut             ||04789  |'            dstrAvgNav = dblValueOut             
04817  |''2005/03/09 End                                  ||04790  |''2005/03/09 End                                  
04818  |''2005/03/15 Start                                ||04791  |''2005/03/15 Start                                
04819  |'            AvgNav = dstrAvgNav                  ||04792  |'            AvgNav = dstrAvgNav                  
04820  |''2005/03/15 End                                  ||04793  |''2005/03/15 End                                  
04821  |'                                                 ||04794  |'                                                 
04822  |''2005/01/18 Start                                ||04795  |''2005/01/18 Start                                
04823  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    ||04796  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    
04824  |'            Call gblnDyClose                     ||04797  |'            Call gblnDyClose                     
04825  |''2005/01/18 End                                  ||04798  |''2005/01/18 End                                  
04826  |''2005/01/12 Start                                ||04799  |''2005/01/12 Start                                
04827  |''            '対象締日データ抽出                 ||04800  |''            '対象締日データ抽出                 
04828  |''            .Cells(20, 37).NumberFormatLocal = "||04801  |''            .Cells(20, 37).NumberFormatLocal = "
04829  |'''2005/01/11 Start                               ||04802  |'''2005/01/11 Start                               
04830  |'''            .Cells(20, 37).Value = CStr(Format(||04803  |'''            .Cells(20, 37).Value = CStr(Format(
04831  |''            .Cells(20, 37).Value = CStr(Format(d||04804  |''            .Cells(20, 37).Value = CStr(Format(d
04832  |'''2005/01/11 End                                 ||04805  |'''2005/01/11 End                                 
04833  |''            .Cells(20, 37).HorizontalAlignment =||04806  |''            .Cells(20, 37).HorizontalAlignment =
04834  |''            '合計(月末純資産)                   ||04807  |''            '合計(月末純資産)                   
04835  |''            .Cells(33, 37).NumberFormatLocal = "||04808  |''            .Cells(33, 37).NumberFormatLocal = "
04836  |'''2005/01/11 Start                               ||04809  |'''2005/01/11 Start                               
04837  |'''            .Cells(33, 37).Value = CStr(Format(||04810  |'''            .Cells(33, 37).Value = CStr(Format(
04838  |''            .Cells(33, 37).Value = CStr(Format(d||04811  |''            .Cells(33, 37).Value = CStr(Format(d
04839  |'''2005/01/11 End                                 ||04812  |'''2005/01/11 End                                 
04840  |''            .Cells(33, 37).HorizontalAlignment =||04813  |''            .Cells(33, 37).HorizontalAlignment =
04841  |'            '対象締日データ抽出                  ||04814  |'            '対象締日データ抽出                  
04842  |''            .Cells(20, 37).NumberFormatLocal = "||04815  |''            .Cells(20, 37).NumberFormatLocal = "
04843  |''2005/03/09 Start                                ||04816  |''2005/03/09 Start                                
04844  |''            .Cells(20, 39).NumberFormatLocal = "||04817  |''            .Cells(20, 39).NumberFormatLocal = "
04845  |''2005/03/09 End                                  ||04818  |''2005/03/09 End                                  
04846  |''2005/01/11 Start                                ||04819  |''2005/01/11 Start                                
04847  |''            .Cells(20, 37).Value = CStr(Format(d||04820  |''            .Cells(20, 37).Value = CStr(Format(d
04848  |''            .Cells(20, 37).Value = CStr(Format(d||04821  |''            .Cells(20, 37).Value = CStr(Format(d
04849  |''2005/01/20 Start                                ||04822  |''2005/01/20 Start                                
04850  |''            .Cells(20, 39).Value = CStr(Format(d||04823  |''            .Cells(20, 39).Value = CStr(Format(d
04851  |''2005/03/09 Start                                ||04824  |''2005/03/09 Start                                
04852  |''            If gbuMGetUPDRec.N(lRecIdx).MGET_bas||04825  |''            If gbuMGetUPDRec.N(lRecIdx).MGET_bas
04853  |''                .Cells(20, 39).Value = CStr(Form||04826  |''                .Cells(20, 39).Value = CStr(Form
04854  |''            Else                                ||04827  |''            Else                                
04855  |''                .Cells(20, 39).Value = CStr(Form||04828  |''                .Cells(20, 39).Value = CStr(Form
04856  |''            End If                              ||04829  |''            End If                              
04857  |''2005/03/09 End                                  ||04830  |''2005/03/09 End                                  
04858  |''2005/01/20 End                                  ||04831  |''2005/01/20 End                                  
04859  |''2005/01/11 End                                  ||04832  |''2005/01/11 End                                  
04860  |''            .Cells(20, 37).HorizontalAlignment =||04833  |''            .Cells(20, 37).HorizontalAlignment =
04861  |''2005/03/09 Start                                ||04834  |''2005/03/09 Start                                
04862  |''            .Cells(20, 39).HorizontalAlignment =||04835  |''            .Cells(20, 39).HorizontalAlignment =
04863  |''2005/03/09 End                                  ||04836  |''2005/03/09 End                                  
04864  |'            '合計(月末純資産)                    ||04837  |'            '合計(月末純資産)                    
04865  |''            .Cells(33, 37).NumberFormatLocal = "||04838  |''            .Cells(33, 37).NumberFormatLocal = "
04866  |''2005/03/09 Start                                ||04839  |''2005/03/09 Start                                
04867  |''            .Cells(33, 39).NumberFormatLocal = "||04840  |''            .Cells(33, 39).NumberFormatLocal = "
04868  |''2005/03/09 End                                  ||04841  |''2005/03/09 End                                  
04869  |''2005/03/09 Start                                ||04842  |''2005/03/09 Start                                
04870  |'            .Cells(17, 23).NumberFormatLocal = "@||04843  |'            .Cells(17, 23).NumberFormatLocal = "@
04871  |''2005/03/09 End                                  ||04844  |''2005/03/09 End                                  
04872  |''2005/01/11 Start                                ||04845  |''2005/01/11 Start                                
04873  |''            .Cells(33, 37).Value = CStr(Format(d||04846  |''            .Cells(33, 37).Value = CStr(Format(d
04874  |''            .Cells(33, 37).Value = CStr(Format(d||04847  |''            .Cells(33, 37).Value = CStr(Format(d
04875  |''2005/01/20 Start                                ||04848  |''2005/01/20 Start                                
04876  |''            .Cells(20, 39).Value = CStr(Format(d||04849  |''            .Cells(20, 39).Value = CStr(Format(d
04877  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base||04850  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base
04878  |''2005/03/09 Start                                ||04851  |''2005/03/09 Start                                
04879  |''                .Cells(33, 39).Value = CStr(Form||04852  |''                .Cells(33, 39).Value = CStr(Form
04880  |''2005/03/09 End                                  ||04853  |''2005/03/09 End                                  
04881  |''2005/03/15 Start                                ||04854  |''2005/03/15 Start                                
04882  |'''2005/03/09 Start                               ||04855  |'''2005/03/09 Start                               
04883  |''                .Cells(17, 23).Value = CStr(Form||04856  |''                .Cells(17, 23).Value = CStr(Form
04884  |'''2005/03/09 End                                 ||04857  |'''2005/03/09 End                                 
04885  |'                .Cells(17, 23).Value = CStr(Forma||04858  |'                .Cells(17, 23).Value = CStr(Forma
04886  |''2005/03/15 End                                  ||04859  |''2005/03/15 End                                  
04887  |'            Else                                 ||04860  |'            Else                                 
04888  |''2005/03/09 Start                                ||04861  |''2005/03/09 Start                                
04889  |''                .Cells(33, 39).Value = CStr(Form||04862  |''                .Cells(33, 39).Value = CStr(Form
04890  |''2005/03/09 End                                  ||04863  |''2005/03/09 End                                  
04891  |''2005/03/15 Start                                ||04864  |''2005/03/15 Start                                
04892  |'''2005/03/09 Start                               ||04865  |'''2005/03/09 Start                               
04893  |''                .Cells(17, 23).Value = CStr(Form||04866  |''                .Cells(17, 23).Value = CStr(Form
04894  |'''2005/03/09 End                                 ||04867  |'''2005/03/09 End                                 
04895  |'                .Cells(17, 23).Value = CStr(Forma||04868  |'                .Cells(17, 23).Value = CStr(Forma
04896  |''2005/03/15 End                                  ||04869  |''2005/03/15 End                                  
04897  |'            End If                               ||04870  |'            End If                               
04898  |''2005/01/20 End                                  ||04871  |''2005/01/20 End                                  
04899  |''2005/01/11 End                                  ||04872  |''2005/01/11 End                                  
04900  |''            .Cells(33, 37).HorizontalAlignment =||04873  |''            .Cells(33, 37).HorizontalAlignment =
04901  |''2005/03/09 Start                                ||04874  |''2005/03/09 Start                                
04902  |''            .Cells(33, 39).HorizontalAlignment =||04875  |''            .Cells(33, 39).HorizontalAlignment =
04903  |''2005/03/09 End                                  ||04876  |''2005/03/09 End                                  
04904  |''2005/03/09 Start                                ||04877  |''2005/03/09 Start                                
04905  |'            .Cells(17, 23).HorizontalAlignment = ||04878  |'            .Cells(17, 23).HorizontalAlignment = 
04906  |''2005/03/09 End                                  ||04879  |''2005/03/09 End                                  
04907  |''2005/03/15 Start                                ||04880  |''2005/03/15 Start                                
04908  |'            '平均純資産総額                      ||04881  |'            '平均純資産総額                      
04909  |'            .Cells(36, 2).Value = sWord51        ||04882  |'            .Cells(36, 2).Value = sWord51        
04910  |'            .Cells(36, 11).Value = sWord19       ||04883  |'            .Cells(36, 11).Value = sWord19       
04911  |'            '計算期間の純資産総額の合計(月末純資 ||04884  |'            '計算期間の純資産総額の合計(月末純資 
04912  |'            .Cells(36, 23).NumberFormatLocal = "@||04885  |'            .Cells(36, 23).NumberFormatLocal = "@
04913  |'              If gbuMGetUPDRec.N(lRecIdx).MGET_ba||04886  |'              If gbuMGetUPDRec.N(lRecIdx).MGET_ba
04914  |'                  .Cells(36, 23).Value = CStr(For||04887  |'                  .Cells(36, 23).Value = CStr(For
04915  |'              Else                               ||04888  |'              Else                               
04916  |'                  .Cells(36, 23).Value = CStr(For||04889  |'                  .Cells(36, 23).Value = CStr(For
04917  |'              End If                             ||04890  |'              End If                             
04918  |'            .Cells(36, 23).HorizontalAlignment = ||04891  |'            .Cells(36, 23).HorizontalAlignment = 
04919  |'            '÷??＝                              ||04892  |'            '÷??＝                              
04920  |'            .Cells(36, 26).Value = sWord18 & "   ||04893  |'            .Cells(36, 26).Value = sWord18 & "   
04921  |'            '計算期間の純資産総額の合計÷計算期間||04894  |'            '計算期間の純資産総額の合計÷計算期間
04922  |'            .Cells(36, 35).NumberFormatLocal = "@||04895  |'            .Cells(36, 35).NumberFormatLocal = "@
04923  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base||04896  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base
04924  |'                .Cells(36, 35).Value = CStr(Forma||04897  |'                .Cells(36, 35).Value = CStr(Forma
04925  |'            Else                                 ||04898  |'            Else                                 
04926  |'                .Cells(36, 35).Value = CStr(Forma||04899  |'                .Cells(36, 35).Value = CStr(Forma
04927  |'            End If                               ||04900  |'            End If                               
04928  |''2005/03/15 End                                  ||04901  |''2005/03/15 End                                  
04929  |''2005/01/12 End                                  ||04902  |''2005/01/12 End                                  
04930  |''2005/01/17 Start                                ||04903  |''2005/01/17 Start                                
04931  |'            ddblExchangeRate = 0                 ||04904  |'            ddblExchangeRate = 0                 
04932  |''2005/01/17 End                                  ||04905  |''2005/01/17 End                                  
04933  |'            '投資顧問料計算用計算対象NAVに日次平 ||04906  |'            '投資顧問料計算用計算対象NAVに日次平 
04934  |'            If dstrAvgNav = "" Then              ||04907  |'            If dstrAvgNav = "" Then              
04935  |'                lCalcNav = 0                     ||04908  |'                lCalcNav = 0                     
04936  |'            Else                                 ||04909  |'            Else                                 
04937  |''2004/11/17 Start                                ||04910  |''2004/11/17 Start                                
04938  |''                lCalcNav = Format(Round(gvlnDyDa||04911  |''                lCalcNav = Format(Round(gvlnDyDa
04939  |'                dblValueIn = CDbl(dstrAvgNav)    ||04912  |'                dblValueIn = CDbl(dstrAvgNav)    
04940  |''2005/01/11 Start                                ||04913  |''2005/01/11 Start                                
04941  |'                '@@@@@ NAV通貨から閾値通貨に換算 ||04914  |'                '@@@@@ NAV通貨から閾値通貨に換算 
04942  |'                Select Case gbuMGetUPDRec.N(lRecI||04915  |'                Select Case gbuMGetUPDRec.N(lRecI
04943  |'                  Case "1"    '固定料率          ||04916  |'                  Case "1"    '固定料率          
04944  |''2005/01/20 Start                                ||04917  |''2005/01/20 Start                                
04945  |''                      'NAV通貨と外部委託顧問料通||04918  |''                      'NAV通貨と外部委託顧問料通
04946  |''                      If gbuMGetUPDRec.N(lRecIdx||04919  |''                      If gbuMGetUPDRec.N(lRecIdx
04947  |''                          '外部委託顧問料通貨が ||04920  |''                          '外部委託顧問料通貨が 
04948  |''                          If gbuMGetUPDRec.N(lRe||04921  |''                          If gbuMGetUPDRec.N(lRe
04949  |''                          End If                ||04922  |''                          End If                
04950  |''                      End If                    ||04923  |''                      End If                    
04951  |''                      'NAV通貨と外部委託顧問料通||04924  |''                      'NAV通貨と外部委託顧問料通
04952  |''                      If gbuMGetUPDRec.N(lRecIdx||04925  |''                      If gbuMGetUPDRec.N(lRecIdx
04953  |''                          '外部委託顧問料通貨が ||04926  |''                          '外部委託顧問料通貨が 
04954  |''                          If gbuMGetUPDRec.N(lRe||04927  |''                          If gbuMGetUPDRec.N(lRe
04955  |''                          End If                ||04928  |''                          End If                
04956  |''                      End If                    ||04929  |''                      End If                    
04957  |'                    If gbuMGetUPDRec.N(lRecIdx).M||04930  |'                    If gbuMGetUPDRec.N(lRecIdx).M
04958  |'                        'NAV通貨→JPYの為替レート||04931  |'                        'NAV通貨→JPYの為替レート
04959  |'                        dstrCurrencyCode = gbuMGe||04932  |'                        dstrCurrencyCode = gbuMGe
04960  |'                        ddblExchangeRate = fnstrE||04933  |'                        ddblExchangeRate = fnstrE
04961  |'                        If ddblExchangeRate = 0 T||04934  |'                        If ddblExchangeRate = 0 T
04962  |'                          intRtn = MsgBox("ＴＴＭ||04935  |'                          intRtn = MsgBox("ＴＴＭ
04963  |'                          vbLf & "対象通貨コード ||04936  |'                          vbLf & "対象通貨コード 
04964  |'                          vbLf & "基準日 ： [ " &||04937  |'                          vbLf & "基準日 ： [ " &
04965  |'                              vbCritical, "ＴＴＭ||04938  |'                              vbCritical, "ＴＴＭ
04966  |'                          Exit Function          ||04939  |'                          Exit Function          
04967  |'                        End If                   ||04940  |'                        End If                   
04968  |'                        'NAV通貨→JPYへレート換算||04941  |'                        'NAV通貨→JPYへレート換算
04969  |'                        dblValueIn = dblValueIn *||04942  |'                        dblValueIn = dblValueIn *
04970  |'                    End If                       ||04943  |'                    End If                       
04971  |''2005/01/20 End                                  ||04944  |''2005/01/20 End                                  
04972  |'                  Case "2"    '段階料率          ||04945  |'                  Case "2"    '段階料率          
04973  |''2005/01/26 Start                                ||04946  |''2005/01/26 Start                                
04974  |''''''                      'NAV通貨と閾値通貨が相||04947  |''''''                      'NAV通貨と閾値通貨が相
04975  |''''''                      If gbuMGetUPDRec.N(lRe||04948  |''''''                      If gbuMGetUPDRec.N(lRe
04976  |''''''                          '閾値通貨と外部委 ||04949  |''''''                          '閾値通貨と外部委 
04977  |''''''                          If gbuMGetUPDRec.N||04950  |''''''                          If gbuMGetUPDRec.N
04978  |''''''                              '外部委託顧問 ||04951  |''''''                              '外部委託顧問 
04979  |''''''                              If gbuMGetUPDR||04952  |''''''                              If gbuMGetUPDR
04980  |'''''''2005/01/17 Start                           ||04953  |'''''''2005/01/17 Start                           
04981  |'''''''                                  dblValueI||04954  |'''''''                                  dblValueI
04982  |''''''                                  'NAV通貨→||04955  |''''''                                  'NAV通貨→
04983  |''''''                                  dstrCurren||04956  |''''''                                  dstrCurren
04984  |''''''                                  ddblExchan||04957  |''''''                                  ddblExchan
04985  |''''''                                  If ddblExc||04958  |''''''                                  If ddblExc
04986  |''''''                                    intRtn =||04959  |''''''                                    intRtn =
04987  |''''''                                    vbLf & "||04960  |''''''                                    vbLf & "
04988  |''''''                                    vbLf & "||04961  |''''''                                    vbLf & "
04989  |''''''                                        vbCr||04962  |''''''                                        vbCr
04990  |''''''                                    Exit Fun||04963  |''''''                                    Exit Fun
04991  |''''''                                  End If    ||04964  |''''''                                  End If    
04992  |''''''                                  'NAV通貨→||04965  |''''''                                  'NAV通貨→
04993  |''''''                                  dblValueIn||04966  |''''''                                  dblValueIn
04994  |''''''                                  '閾値通貨 ||04967  |''''''                                  '閾値通貨 
04995  |''''''                                  dstrCurren||04968  |''''''                                  dstrCurren
04996  |''''''                                  ddblExchan||04969  |''''''                                  ddblExchan
04997  |''''''                                  If ddblExc||04970  |''''''                                  If ddblExc
04998  |''''''                                    intRtn =||04971  |''''''                                    intRtn =
04999  |''''''                                    vbLf & "||04972  |''''''                                    vbLf & "
05000  |''''''                                    vbLf & "||04973  |''''''                                    vbLf & "
05001  |''''''                                        vbCr||04974  |''''''                                        vbCr
05002  |''''''                                    Exit Fun||04975  |''''''                                    Exit Fun
05003  |''''''                                  End If    ||04976  |''''''                                  End If    
05004  |''''''                                  'JPY→閾値||04977  |''''''                                  'JPY→閾値
05005  |''''''                                  dblValueIn||04978  |''''''                                  dblValueIn
05006  |'''''''2005/01/17 End                             ||04979  |'''''''2005/01/17 End                             
05007  |''''''                              End If        ||04980  |''''''                              End If        
05008  |''''''                          End If            ||04981  |''''''                          End If            
05009  |''''''                      End If                ||04982  |''''''                      End If                
05010  |''''''                      'NAV通貨と閾値通貨が相||04983  |''''''                      'NAV通貨と閾値通貨が相
05011  |''''''                      If gbuMGetUPDRec.N(lRe||04984  |''''''                      If gbuMGetUPDRec.N(lRe
05012  |''''''                          '閾値通貨と外部委 ||04985  |''''''                          '閾値通貨と外部委 
05013  |''''''                          If gbuMGetUPDRec.N||04986  |''''''                          If gbuMGetUPDRec.N
05014  |''''''                              '外部委託顧問 ||04987  |''''''                              '外部委託顧問 
05015  |''''''                              If gbuMGetUPDR||04988  |''''''                              If gbuMGetUPDR
05016  |'''''''2005/01/17 Start                           ||04989  |'''''''2005/01/17 Start                           
05017  |'''''''                                  dblValueI||04990  |'''''''                                  dblValueI
05018  |''''''                                  'NAV通貨→||04991  |''''''                                  'NAV通貨→
05019  |''''''                                  dstrCurren||04992  |''''''                                  dstrCurren
05020  |''''''                                  ddblExchan||04993  |''''''                                  ddblExchan
05021  |''''''                                  If ddblExc||04994  |''''''                                  If ddblExc
05022  |''''''                                    intRtn =||04995  |''''''                                    intRtn =
05023  |''''''                                    vbLf & "||04996  |''''''                                    vbLf & "
05024  |''''''                                    vbLf & "||04997  |''''''                                    vbLf & "
05025  |''''''                                        vbCr||04998  |''''''                                        vbCr
05026  |''''''                                    Exit Fun||04999  |''''''                                    Exit Fun
05027  |''''''                                  End If    ||05000  |''''''                                  End If    
05028  |''''''                                  'NAV通貨→||05001  |''''''                                  'NAV通貨→
05029  |''''''                                  dblValueIn||05002  |''''''                                  dblValueIn
05030  |''''''                                  '閾値通貨 ||05003  |''''''                                  '閾値通貨 
05031  |''''''                                  dstrCurren||05004  |''''''                                  dstrCurren
05032  |''''''                                  ddblExchan||05005  |''''''                                  ddblExchan
05033  |''''''                                  If ddblExc||05006  |''''''                                  If ddblExc
05034  |''''''                                    intRtn =||05007  |''''''                                    intRtn =
05035  |''''''                                    vbLf & "||05008  |''''''                                    vbLf & "
05036  |''''''                                    vbLf & "||05009  |''''''                                    vbLf & "
05037  |''''''                                        vbCr||05010  |''''''                                        vbCr
05038  |''''''                                    Exit Fun||05011  |''''''                                    Exit Fun
05039  |''''''                                  End If    ||05012  |''''''                                  End If    
05040  |''''''                                  'JPY→閾値||05013  |''''''                                  'JPY→閾値
05041  |''''''                                  dblValueIn||05014  |''''''                                  dblValueIn
05042  |'''''''2005/01/17 End                             ||05015  |'''''''2005/01/17 End                             
05043  |''''''                              End If        ||05016  |''''''                              End If        
05044  |''''''                          End If            ||05017  |''''''                          End If            
05045  |''''''                      End If                ||05018  |''''''                      End If                
05046  |'                    If gbuMGetUPDRec.N(lRecIdx).M||05019  |'                    If gbuMGetUPDRec.N(lRecIdx).M
05047  |'                        If gbuMGetUPDRec.N(lRecId||05020  |'                        If gbuMGetUPDRec.N(lRecId
05048  |'                        Else                     ||05021  |'                        Else                     
05049  |'                            '閾値通貨→JPYの為替 ||05022  |'                            '閾値通貨→JPYの為替 
05050  |'                            dstrCurrencyCode = gb||05023  |'                            dstrCurrencyCode = gb
05051  |'                            ddblExchangeRate = fn||05024  |'                            ddblExchangeRate = fn
05052  |'                            If ddblExchangeRate =||05025  |'                            If ddblExchangeRate =
05053  |'                              intRtn = MsgBox("Ｔ||05026  |'                              intRtn = MsgBox("Ｔ
05054  |'                              vbLf & "対象通貨コ ||05027  |'                              vbLf & "対象通貨コ 
05055  |'                              vbLf & "基準日 ： [||05028  |'                              vbLf & "基準日 ： [
05056  |'                                  vbCritical, "Ｔ||05029  |'                                  vbCritical, "Ｔ
05057  |'                              Exit Function      ||05030  |'                              Exit Function      
05058  |'                            End If               ||05031  |'                            End If               
05059  |'                            'JPY→閾値通貨へレー ||05032  |'                            'JPY→閾値通貨へレー 
05060  |'                            dblValueIn = dblValue||05033  |'                            dblValueIn = dblValue
05061  |'                        End If                   ||05034  |'                        End If                   
05062  |'                    Else                         ||05035  |'                    Else                         
05063  |'                        'NAV通貨→JPYの為替レート||05036  |'                        'NAV通貨→JPYの為替レート
05064  |'                        dstrCurrencyCode = gbuMGe||05037  |'                        dstrCurrencyCode = gbuMGe
05065  |'                        ddblExchangeRate = fnstrE||05038  |'                        ddblExchangeRate = fnstrE
05066  |'                        If ddblExchangeRate = 0 T||05039  |'                        If ddblExchangeRate = 0 T
05067  |'                          intRtn = MsgBox("ＴＴＭ||05040  |'                          intRtn = MsgBox("ＴＴＭ
05068  |'                          vbLf & "対象通貨コード ||05041  |'                          vbLf & "対象通貨コード 
05069  |'                          vbLf & "基準日 ： [ " &||05042  |'                          vbLf & "基準日 ： [ " &
05070  |'                              vbCritical, "ＴＴＭ||05043  |'                              vbCritical, "ＴＴＭ
05071  |'                          Exit Function          ||05044  |'                          Exit Function          
05072  |'                        End If                   ||05045  |'                        End If                   
05073  |'                        'NAV通貨→JPYへレート換算||05046  |'                        'NAV通貨→JPYへレート換算
05074  |'                        dblValueIn = dblValueIn *||05047  |'                        dblValueIn = dblValueIn *
05075  |'                        If gbuMGetUPDRec.N(lRecId||05048  |'                        If gbuMGetUPDRec.N(lRecId
05076  |'                        Else                     ||05049  |'                        Else                     
05077  |'                            '閾値通貨→JPYの為替 ||05050  |'                            '閾値通貨→JPYの為替 
05078  |'                            dstrCurrencyCode = gb||05051  |'                            dstrCurrencyCode = gb
05079  |'                            ddblExchangeRate = fn||05052  |'                            ddblExchangeRate = fn
05080  |'                            If ddblExchangeRate =||05053  |'                            If ddblExchangeRate =
05081  |'                              intRtn = MsgBox("Ｔ||05054  |'                              intRtn = MsgBox("Ｔ
05082  |'                              vbLf & "対象通貨コ ||05055  |'                              vbLf & "対象通貨コ 
05083  |'                              vbLf & "基準日 ： [||05056  |'                              vbLf & "基準日 ： [
05084  |'                                  vbCritical, "Ｔ||05057  |'                                  vbCritical, "Ｔ
05085  |'                              Exit Function      ||05058  |'                              Exit Function      
05086  |'                            End If               ||05059  |'                            End If               
05087  |'                            'JPY→閾値通貨へ逆レ ||05060  |'                            'JPY→閾値通貨へ逆レ 
05088  |'                            dblValueIn = dblValue||05061  |'                            dblValueIn = dblValue
05089  |'                        End If                   ||05062  |'                        End If                   
05090  |'                    End If                       ||05063  |'                    End If                       
05091  |''2005/01/26 End                                  ||05064  |''2005/01/26 End                                  
05092  |'                End Select                       ||05065  |'                End Select                       
05093  |'                '@@@@@ NAV通貨から閾値通貨に換算 ||05066  |'                '@@@@@ NAV通貨から閾値通貨に換算 
05094  |''2005/01/11 End                                  ||05067  |''2005/01/11 End                                  
05095  |''2005/01/13 Start                                ||05068  |''2005/01/13 Start                                
05096  |''                Call sbGetRoundValue(dblValueIn)||05069  |''                Call sbGetRoundValue(dblValueIn)
05097  |'                Call sbGetRoundValue2(dblValueIn)||05070  |'                Call sbGetRoundValue2(dblValueIn)
05098  |''2005/01/13 End                                  ||05071  |''2005/01/13 End                                  
05099  |''2005/01/11 Start                                ||05072  |''2005/01/11 Start                                
05100  |''                lCalcNav = CStr(Format(dblValueO||05073  |''                lCalcNav = CStr(Format(dblValueO
05101  |''閾値レート換算後平均NAV(計算対象NAV)            ||05074  |''閾値レート換算後平均NAV(計算対象NAV)            
05102  |'                lCalcNav = CStr(Format(dblValueOu||05075  |'                lCalcNav = CStr(Format(dblValueOu
05103  |''2005/01/11 End                                  ||05076  |''2005/01/11 End                                  
05104  |''2004/11/17 End                                  ||05077  |''2004/11/17 End                                  
05105  |'            End If                               ||05078  |'            End If                               
05106  |''''''            '@@@@@※ここではなく顧問料に換算||05079  |''''''            '@@@@@※ここではなく顧問料に換算
05107  |''''''            If Len(gbuMGetUPDRec.N(lRecIdx).||05080  |''''''            If Len(gbuMGetUPDRec.N(lRecIdx).
05108  |''''''                If lCalcNav < CDbl(gbuMGetUP||05081  |''''''                If lCalcNav < CDbl(gbuMGetUP
05109  |''''''                    lCalcNav = CDbl(gbuMGetU||05082  |''''''                    lCalcNav = CDbl(gbuMGetU
05110  |''''''                End If                      ||05083  |''''''                End If                      
05111  |''''''            End If                          ||05084  |''''''            End If                          
05112  |''''''            If Len(gbuMGetUPDRec.N(lRecIdx).||05085  |''''''            If Len(gbuMGetUPDRec.N(lRecIdx).
05113  |''''''                If lCalcNav > CDbl(gbuMGetUP||05086  |''''''                If lCalcNav > CDbl(gbuMGetUP
05114  |''''''                    lCalcNav = CDbl(gbuMGetU||05087  |''''''                    lCalcNav = CDbl(gbuMGetU
05115  |''''''                End If                      ||05088  |''''''                End If                      
05116  |''''''            End If                          ||05089  |''''''            End If                          
05117  |''2005/01/06 End                                  ||05090  |''2005/01/06 End                                  
05118  |''2005/01/18 Start                                ||05091  |''2005/01/18 Start                                
05119  |''            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                   ||05092  |''            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                   
05120  |''            Call gblnDyClose                    ||05093  |''            Call gblnDyClose                    
05121  |''2005/01/18 End                                  ||05094  |''2005/01/18 End                                  
05122  |'                                                 ||05095  |'                                                 
05123  |'On Error Resume Next                             ||05096  |'On Error Resume Next                             
05124  |'        End If                                   ||05097  |'        End If                                   
05125  |'                                                 ||05098  |'                                                 
05126  |'    '投資顧問料                                  ||05099  |'    '投資顧問料                                  
05127  |'        Dim dRitsu As Double    '外部委託顧問料率||05100  |'        Dim dRitsu As Double    '外部委託顧問料率
05128  |'        dRitsu = 0                               ||05101  |'        dRitsu = 0                               
05129  |'        TotalRate = 0                            ||05102  |'        TotalRate = 0                            
05130  |''2005/01/17 Start                                ||05103  |''2005/01/17 Start                                
05131  |'        ddblExchangeRate = 0                     ||05104  |'        ddblExchangeRate = 0                     
05132  |''2005/01/17 End                                  ||05105  |''2005/01/17 End                                  
05133  |'        '計算対象NAVを変数にセット               ||05106  |'        '計算対象NAVを変数にセット               
05134  |''2005/03/09 Start                                ||05107  |''2005/03/09 Start                                
05135  |''        '契約区分：外部委託顧問料計算または業務 ||05108  |''        '契約区分：外部委託顧問料計算または業務 
05136  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_contrac||05109  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_contrac
05137  |''2005/03/09 End                                  ||05110  |''2005/03/09 End                                  
05138  |'            lCalcNav = 0                         ||05111  |'            lCalcNav = 0                         
05139  |''2004/11/17 Start                                ||05112  |''2004/11/17 Start                                
05140  |''            lCalcNav = Format(Round(TotalNav / i||05113  |''            lCalcNav = Format(Round(TotalNav / i
05141  |'            dblValueIn = TotalNav / iRowCnt      ||05114  |'            dblValueIn = TotalNav / iRowCnt      
05142  |''2005/01/12 Start                                ||05115  |''2005/01/12 Start                                
05143  |'            '@@@@@ NAV通貨から閾値通貨に換算 @@@@||05116  |'            '@@@@@ NAV通貨から閾値通貨に換算 @@@@
05144  |'            Select Case gbuMGetUPDRec.N(lRecIdx).||05117  |'            Select Case gbuMGetUPDRec.N(lRecIdx).
05145  |'              Case "1"    '固定料率(固定料率の場 ||05118  |'              Case "1"    '固定料率(固定料率の場 
05146  |'                  'NAV通貨と外部委託顧問料通貨が ||05119  |'                  'NAV通貨と外部委託顧問料通貨が 
05147  |''2005/01/20 Start                                ||05120  |''2005/01/20 Start                                
05148  |''                  If gbuMGetUPDRec.N(lRecIdx).MG||05121  |''                  If gbuMGetUPDRec.N(lRecIdx).MG
05149  |''                      '外部委託顧問料通貨が円以 ||05122  |''                      '外部委託顧問料通貨が円以 
05150  |''                      If gbuMGetUPDRec.N(lRecIdx||05123  |''                      If gbuMGetUPDRec.N(lRecIdx
05151  |''                      End If                    ||05124  |''                      End If                    
05152  |''                  End If                        ||05125  |''                  End If                        
05153  |''                  'NAV通貨と外部委託顧問料通貨が||05126  |''                  'NAV通貨と外部委託顧問料通貨が
05154  |''                  If gbuMGetUPDRec.N(lRecIdx).MG||05127  |''                  If gbuMGetUPDRec.N(lRecIdx).MG
05155  |''                      '外部委託顧問料通貨が円   ||05128  |''                      '外部委託顧問料通貨が円   
05156  |''                      If gbuMGetUPDRec.N(lRecIdx||05129  |''                      If gbuMGetUPDRec.N(lRecIdx
05157  |''                      End If                    ||05130  |''                      End If                    
05158  |''                  End If                        ||05131  |''                  End If                        
05159  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||05132  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
05160  |'                    'NAV通貨→JPYの為替レートを取||05133  |'                    'NAV通貨→JPYの為替レートを取
05161  |'                    dstrCurrencyCode = gbuMGetUPD||05134  |'                    dstrCurrencyCode = gbuMGetUPD
05162  |'                    ddblExchangeRate = fnstrExcha||05135  |'                    ddblExchangeRate = fnstrExcha
05163  |'                    If ddblExchangeRate = 0 Then ||05136  |'                    If ddblExchangeRate = 0 Then 
05164  |'                      intRtn = MsgBox("ＴＴＭが取||05137  |'                      intRtn = MsgBox("ＴＴＭが取
05165  |'                      vbLf & "対象通貨コード ： [||05138  |'                      vbLf & "対象通貨コード ： [
05166  |'                      vbLf & "基準日 ： [ " & Mid||05139  |'                      vbLf & "基準日 ： [ " & Mid
05167  |'                          vbCritical, "ＴＴＭ取得||05140  |'                          vbCritical, "ＴＴＭ取得
05168  |'                      Exit Function              ||05141  |'                      Exit Function              
05169  |'                    End If                       ||05142  |'                    End If                       
05170  |'                    'NAV通貨→JPYへレート換算    ||05143  |'                    'NAV通貨→JPYへレート換算    
05171  |'                    dblValueIn = dblValueIn * ddb||05144  |'                    dblValueIn = dblValueIn * ddb
05172  |'                End If                           ||05145  |'                End If                           
05173  |''2005/01/20 End                                  ||05146  |''2005/01/20 End                                  
05174  |'              Case "2"    '段階料率              ||05147  |'              Case "2"    '段階料率              
05175  |''2005/01/26 Start                                ||05148  |''2005/01/26 Start                                
05176  |'''''''2005/01/17 Start @@@@@@@@@@                ||05149  |'''''''2005/01/17 Start @@@@@@@@@@                
05177  |'''''''                    'NAV通貨→JPY→閾値通貨||05150  |'''''''                    'NAV通貨→JPY→閾値通貨
05178  |'''''''                    'NAV通貨→JPYの為替レー||05151  |'''''''                    'NAV通貨→JPYの為替レー
05179  |'''''''                    dstrDate = Replace(CStr||05152  |'''''''                    dstrDate = Replace(CStr
05180  |'''''''                    dstrCurrencyCode = gbuM||05153  |'''''''                    dstrCurrencyCode = gbuM
05181  |'''''''                    ddblExchangeRate = fnst||05154  |'''''''                    ddblExchangeRate = fnst
05182  |'''''''                    '閾値通貨→JPYの為替レ ||05155  |'''''''                    '閾値通貨→JPYの為替レ 
05183  |'''''''                    dstrDate = Replace(CStr||05156  |'''''''                    dstrDate = Replace(CStr
05184  |'''''''                    dstrCurrencyCode = gbuM||05157  |'''''''                    dstrCurrencyCode = gbuM
05185  |'''''''                    ddblExchangeRate = fnst||05158  |'''''''                    ddblExchangeRate = fnst
05186  |'''''''                                           ||05159  |'''''''                                           
05187  |'''''''                    sSql = ""              ||05160  |'''''''                    sSql = ""              
05188  |'''''''                    sSql = sSql & "SELECT  ||05161  |'''''''                    sSql = sSql & "SELECT  
05189  |'''''''                    sSql = sSql & "TBL_TTM1||05162  |'''''''                    sSql = sSql & "TBL_TTM1
05190  |'''''''                    sSql = sSql & "TBL_TTM1||05163  |'''''''                    sSql = sSql & "TBL_TTM1
05191  |'''''''                    sSql = sSql & "TBL_TTM1||05164  |'''''''                    sSql = sSql & "TBL_TTM1
05192  |'''''''                    sSql = sSql & "TBL_TTM1||05165  |'''''''                    sSql = sSql & "TBL_TTM1
05193  |'''''''                    sSql = sSql & "FROM (SE||05166  |'''''''                    sSql = sSql & "FROM (SE
05194  |'''''''                    sSql = sSql & "WK_TTM.c||05167  |'''''''                    sSql = sSql & "WK_TTM.c
05195  |'''''''                    sSql = sSql & "TO_CHAR(||05168  |'''''''                    sSql = sSql & "TO_CHAR(
05196  |'''''''                    sSql = sSql & "NVL(WK_T||05169  |'''''''                    sSql = sSql & "NVL(WK_T
05197  |'''''''                    sSql = sSql & "TO_CHAR(||05170  |'''''''                    sSql = sSql & "TO_CHAR(
05198  |'''''''                    sSql = sSql & "FROM cfr||05171  |'''''''                    sSql = sSql & "FROM cfr
05199  |'''''''                    sSql = sSql & "WHERE " ||05172  |'''''''                    sSql = sSql & "WHERE " 
05200  |'''''''                    sSql = sSql & "(WK_TTM.||05173  |'''''''                    sSql = sSql & "(WK_TTM.
05201  |'''''''                    sSql = sSql & "FROM cfr||05174  |'''''''                    sSql = sSql & "FROM cfr
05202  |'''''''                    sSql = sSql & "WHERE TT||05175  |'''''''                    sSql = sSql & "WHERE TT
05203  |'''''''                    sSql = sSql & "AND TTM1||05176  |'''''''                    sSql = sSql & "AND TTM1
05204  |'''''''                    sSql = sSql & dstrDate ||05177  |'''''''                    sSql = sSql & dstrDate 
05205  |'''''''                    sSql = sSql & "' "     ||05178  |'''''''                    sSql = sSql & "' "     
05206  |'''''''                    sSql = sSql & "GROUP BY||05179  |'''''''                    sSql = sSql & "GROUP BY
05207  |'''''''                    sSql = sSql & "AND WK_T||05180  |'''''''                    sSql = sSql & "AND WK_T
05208  |'''''''                    sSql = sSql & dstrCurre||05181  |'''''''                    sSql = sSql & dstrCurre
05209  |'''''''                    sSql = sSql & "') TBL_T||05182  |'''''''                    sSql = sSql & "') TBL_T
05210  |'''''''                    'ﾀﾞｲﾅｾｯﾄの作成         ||05183  |'''''''                    'ﾀﾞｲﾅｾｯﾄの作成         
05211  |'''''''                    If gintDyCreate(sSql) =||05184  |'''''''                    If gintDyCreate(sSql) =
05212  |'''''''                        Exit Function      ||05185  |'''''''                        Exit Function      
05213  |'''''''                    Else                   ||05186  |'''''''                    Else                   
05214  |'''''''                        dstrBsCCd(dintFor) ||05187  |'''''''                        dstrBsCCd(dintFor) 
05215  |'''''''                    End If                 ||05188  |'''''''                    End If                 
05216  |'''''''                    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理      ||05189  |'''''''                    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理      
05217  |'''''''                    Call gblnDyClose       ||05190  |'''''''                    Call gblnDyClose       
05218  |''''''                                            ||05191  |''''''                                            
05219  |''''''                  'JPY→閾値通貨のレートを取||05192  |''''''                  'JPY→閾値通貨のレートを取
05220  |'''''''2005/01/17 End                             ||05193  |'''''''2005/01/17 End                             
05221  |''''''                  'NAV通貨と閾値通貨が相違  ||05194  |''''''                  'NAV通貨と閾値通貨が相違  
05222  |''''''                  If gbuMGetUPDRec.N(lRecIdx||05195  |''''''                  If gbuMGetUPDRec.N(lRecIdx
05223  |''''''                      '閾値通貨と外部委託顧 ||05196  |''''''                      '閾値通貨と外部委託顧 
05224  |''''''                      If gbuMGetUPDRec.N(lRe||05197  |''''''                      If gbuMGetUPDRec.N(lRe
05225  |''''''                          '外部委託顧問料通 ||05198  |''''''                          '外部委託顧問料通 
05226  |''''''                          If gbuMGetUPDRec.N||05199  |''''''                          If gbuMGetUPDRec.N
05227  |'''''''2005/01/17 Start                           ||05200  |'''''''2005/01/17 Start                           
05228  |'''''''                              dblValueIn = ||05201  |'''''''                              dblValueIn = 
05229  |''''''                              'NAV通貨→JPY ||05202  |''''''                              'NAV通貨→JPY 
05230  |''''''                              dstrCurrencyCo||05203  |''''''                              dstrCurrencyCo
05231  |''''''                              ddblExchangeRa||05204  |''''''                              ddblExchangeRa
05232  |''''''                              If ddblExchang||05205  |''''''                              If ddblExchang
05233  |''''''                                intRtn = Msg||05206  |''''''                                intRtn = Msg
05234  |''''''                                vbLf & "対象||05207  |''''''                                vbLf & "対象
05235  |''''''                                vbLf & "基準||05208  |''''''                                vbLf & "基準
05236  |''''''                                    vbCritic||05209  |''''''                                    vbCritic
05237  |''''''                                Exit Functio||05210  |''''''                                Exit Functio
05238  |''''''                              End If        ||05211  |''''''                              End If        
05239  |''''''                              'NAV通貨→JPY ||05212  |''''''                              'NAV通貨→JPY 
05240  |'''''''2005/01/18 Start                           ||05213  |'''''''2005/01/18 Start                           
05241  |'''''''                              dblValueIn = ||05214  |'''''''                              dblValueIn = 
05242  |''''''                              dblValueIn = d||05215  |''''''                              dblValueIn = d
05243  |'''''''2005/01/18 End                             ||05216  |'''''''2005/01/18 End                             
05244  |''''''                              '閾値通貨→JPY||05217  |''''''                              '閾値通貨→JPY
05245  |''''''                              dstrCurrencyCo||05218  |''''''                              dstrCurrencyCo
05246  |''''''                              ddblExchangeRa||05219  |''''''                              ddblExchangeRa
05247  |''''''                              If ddblExchang||05220  |''''''                              If ddblExchang
05248  |''''''                                intRtn = Msg||05221  |''''''                                intRtn = Msg
05249  |''''''                                vbLf & "対象||05222  |''''''                                vbLf & "対象
05250  |''''''                                vbLf & "基準||05223  |''''''                                vbLf & "基準
05251  |''''''                                    vbCritic||05224  |''''''                                    vbCritic
05252  |''''''                                Exit Functio||05225  |''''''                                Exit Functio
05253  |''''''                              End If        ||05226  |''''''                              End If        
05254  |''''''                              'JPY→閾値通貨||05227  |''''''                              'JPY→閾値通貨
05255  |''''''                              dblValueIn = d||05228  |''''''                              dblValueIn = d
05256  |'''''''2005/01/17 End                             ||05229  |'''''''2005/01/17 End                             
05257  |''''''                          End If            ||05230  |''''''                          End If            
05258  |''''''                      End If                ||05231  |''''''                      End If                
05259  |''''''                  End If                    ||05232  |''''''                  End If                    
05260  |''''''                  'NAV通貨と閾値通貨が相違  ||05233  |''''''                  'NAV通貨と閾値通貨が相違  
05261  |''''''                  If gbuMGetUPDRec.N(lRecIdx||05234  |''''''                  If gbuMGetUPDRec.N(lRecIdx
05262  |''''''                      '閾値通貨と外部委託顧 ||05235  |''''''                      '閾値通貨と外部委託顧 
05263  |''''''                      If gbuMGetUPDRec.N(lRe||05236  |''''''                      If gbuMGetUPDRec.N(lRe
05264  |''''''                          '外部委託顧問料通 ||05237  |''''''                          '外部委託顧問料通 
05265  |''''''                          If gbuMGetUPDRec.N||05238  |''''''                          If gbuMGetUPDRec.N
05266  |'''''''2005/01/17 Start                           ||05239  |'''''''2005/01/17 Start                           
05267  |'''''''                              dblValueIn = ||05240  |'''''''                              dblValueIn = 
05268  |''''''                              'NAV通貨→JPY ||05241  |''''''                              'NAV通貨→JPY 
05269  |''''''                              dstrCurrencyCo||05242  |''''''                              dstrCurrencyCo
05270  |''''''                              ddblExchangeRa||05243  |''''''                              ddblExchangeRa
05271  |''''''                              If ddblExchang||05244  |''''''                              If ddblExchang
05272  |''''''                                intRtn = Msg||05245  |''''''                                intRtn = Msg
05273  |''''''                                vbLf & "対象||05246  |''''''                                vbLf & "対象
05274  |''''''                                vbLf & "基準||05247  |''''''                                vbLf & "基準
05275  |''''''                                    vbCritic||05248  |''''''                                    vbCritic
05276  |''''''                                Exit Functio||05249  |''''''                                Exit Functio
05277  |''''''                              End If        ||05250  |''''''                              End If        
05278  |''''''                              'NAV通貨→JPY ||05251  |''''''                              'NAV通貨→JPY 
05279  |'''''''2005/01/18 Start                           ||05252  |'''''''2005/01/18 Start                           
05280  |'''''''                              dblValueIn = ||05253  |'''''''                              dblValueIn = 
05281  |''''''                              dblValueIn = d||05254  |''''''                              dblValueIn = d
05282  |'''''''2005/01/18 End                             ||05255  |'''''''2005/01/18 End                             
05283  |''''''                              '閾値通貨→JPY||05256  |''''''                              '閾値通貨→JPY
05284  |''''''                              dstrCurrencyCo||05257  |''''''                              dstrCurrencyCo
05285  |''''''                              ddblExchangeRa||05258  |''''''                              ddblExchangeRa
05286  |''''''                              If ddblExchang||05259  |''''''                              If ddblExchang
05287  |''''''                                intRtn = Msg||05260  |''''''                                intRtn = Msg
05288  |''''''                                vbLf & "対象||05261  |''''''                                vbLf & "対象
05289  |''''''                                vbLf & "基準||05262  |''''''                                vbLf & "基準
05290  |''''''                                    vbCritic||05263  |''''''                                    vbCritic
05291  |''''''                                Exit Functio||05264  |''''''                                Exit Functio
05292  |''''''                              End If        ||05265  |''''''                              End If        
05293  |''''''                              'JPY→閾値通貨||05266  |''''''                              'JPY→閾値通貨
05294  |''''''                              dblValueIn = d||05267  |''''''                              dblValueIn = d
05295  |'''''''2005/01/17 End                             ||05268  |'''''''2005/01/17 End                             
05296  |''''''                          End If            ||05269  |''''''                          End If            
05297  |''''''                      End If                ||05270  |''''''                      End If                
05298  |''''''                  End If                    ||05271  |''''''                  End If                    
05299  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||05272  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
05300  |'                    If gbuMGetUPDRec.N(lRecIdx).M||05273  |'                    If gbuMGetUPDRec.N(lRecIdx).M
05301  |'                    Else                         ||05274  |'                    Else                         
05302  |'                        '閾値通貨→JPYの為替レー ||05275  |'                        '閾値通貨→JPYの為替レー 
05303  |'                        dstrCurrencyCode = gbuMGe||05276  |'                        dstrCurrencyCode = gbuMGe
05304  |'                        ddblExchangeRate = fnstrE||05277  |'                        ddblExchangeRate = fnstrE
05305  |'                        If ddblExchangeRate = 0 T||05278  |'                        If ddblExchangeRate = 0 T
05306  |'                          intRtn = MsgBox("ＴＴＭ||05279  |'                          intRtn = MsgBox("ＴＴＭ
05307  |'                          vbLf & "対象通貨コード ||05280  |'                          vbLf & "対象通貨コード 
05308  |'                          vbLf & "基準日 ： [ " &||05281  |'                          vbLf & "基準日 ： [ " &
05309  |'                              vbCritical, "ＴＴＭ||05282  |'                              vbCritical, "ＴＴＭ
05310  |'                          Exit Function          ||05283  |'                          Exit Function          
05311  |'                        End If                   ||05284  |'                        End If                   
05312  |'                        'JPY→閾値通貨へレート換 ||05285  |'                        'JPY→閾値通貨へレート換 
05313  |'                        dblValueIn = dblValueIn *||05286  |'                        dblValueIn = dblValueIn *
05314  |'                    End If                       ||05287  |'                    End If                       
05315  |'                Else                             ||05288  |'                Else                             
05316  |'                    'NAV通貨→JPYの為替レートを取||05289  |'                    'NAV通貨→JPYの為替レートを取
05317  |'                    dstrCurrencyCode = gbuMGetUPD||05290  |'                    dstrCurrencyCode = gbuMGetUPD
05318  |'                    ddblExchangeRate = fnstrExcha||05291  |'                    ddblExchangeRate = fnstrExcha
05319  |'                    If ddblExchangeRate = 0 Then ||05292  |'                    If ddblExchangeRate = 0 Then 
05320  |'                      intRtn = MsgBox("ＴＴＭが取||05293  |'                      intRtn = MsgBox("ＴＴＭが取
05321  |'                      vbLf & "対象通貨コード ： [||05294  |'                      vbLf & "対象通貨コード ： [
05322  |'                      vbLf & "基準日 ： [ " & Mid||05295  |'                      vbLf & "基準日 ： [ " & Mid
05323  |'                          vbCritical, "ＴＴＭ取得||05296  |'                          vbCritical, "ＴＴＭ取得
05324  |'                      Exit Function              ||05297  |'                      Exit Function              
05325  |'                    End If                       ||05298  |'                    End If                       
05326  |'                    'NAV通貨→JPYへレート換算    ||05299  |'                    'NAV通貨→JPYへレート換算    
05327  |'                    dblValueIn = dblValueIn * ddb||05300  |'                    dblValueIn = dblValueIn * ddb
05328  |'                    If gbuMGetUPDRec.N(lRecIdx).M||05301  |'                    If gbuMGetUPDRec.N(lRecIdx).M
05329  |'                    Else                         ||05302  |'                    Else                         
05330  |'                        '閾値通貨→JPYの為替レー ||05303  |'                        '閾値通貨→JPYの為替レー 
05331  |'                        dstrCurrencyCode = gbuMGe||05304  |'                        dstrCurrencyCode = gbuMGe
05332  |'                        ddblExchangeRate = fnstrE||05305  |'                        ddblExchangeRate = fnstrE
05333  |'                        If ddblExchangeRate = 0 T||05306  |'                        If ddblExchangeRate = 0 T
05334  |'                          intRtn = MsgBox("ＴＴＭ||05307  |'                          intRtn = MsgBox("ＴＴＭ
05335  |'                          vbLf & "対象通貨コード ||05308  |'                          vbLf & "対象通貨コード 
05336  |'                          vbLf & "基準日 ： [ " &||05309  |'                          vbLf & "基準日 ： [ " &
05337  |'                              vbCritical, "ＴＴＭ||05310  |'                              vbCritical, "ＴＴＭ
05338  |'                          Exit Function          ||05311  |'                          Exit Function          
05339  |'                        End If                   ||05312  |'                        End If                   
05340  |'                        'JPY→閾値通貨へ逆レート ||05313  |'                        'JPY→閾値通貨へ逆レート 
05341  |'                        dblValueIn = dblValueIn /||05314  |'                        dblValueIn = dblValueIn /
05342  |'                    End If                       ||05315  |'                    End If                       
05343  |'                End If                           ||05316  |'                End If                           
05344  |''2005/01/26 End                                  ||05317  |''2005/01/26 End                                  
05345  |'            End Select                           ||05318  |'            End Select                           
05346  |'            '@@@@@ NAV通貨から閾値通貨に換算 @@@@||05319  |'            '@@@@@ NAV通貨から閾値通貨に換算 @@@@
05347  |''2005/01/12 End                                  ||05320  |''2005/01/12 End                                  
05348  |''2005/01/13 Start                                ||05321  |''2005/01/13 Start                                
05349  |''            Call sbGetRoundValue(dblValueIn)    ||05322  |''            Call sbGetRoundValue(dblValueIn)    
05350  |'            Call sbGetRoundValue2(dblValueIn)    ||05323  |'            Call sbGetRoundValue2(dblValueIn)    
05351  |''2005/01/13 End                                  ||05324  |''2005/01/13 End                                  
05352  |''2005/01/12 Start                                ||05325  |''2005/01/12 Start                                
05353  |''            lCalcNav = CStr(Format(dblValueOut, ||05326  |''            lCalcNav = CStr(Format(dblValueOut, 
05354  |'            lCalcNav = CStr(Format(dblValueOut, "||05327  |'            lCalcNav = CStr(Format(dblValueOut, "
05355  |''2005/01/12 End                                  ||05328  |''2005/01/12 End                                  
05356  |''2004/11/17 End                                  ||05329  |''2004/11/17 End                                  
05357  |''2005/03/09 Start                                ||05330  |''2005/03/09 Start                                
05358  |''        End If                                  ||05331  |''        End If                                  
05359  |''2005/03/09 End                                  ||05332  |''2005/03/09 End                                  
05360  |'        '固定料率                                ||05333  |'        '固定料率                                
05361  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_ra||05334  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_ra
05362  |'            '計算対称NAV × 外部委託顧問料率 ÷ 1||05335  |'            '計算対称NAV × 外部委託顧問料率 ÷ 1
05363  |'            dRitsu = CDbl(gbuOtherComRateGetUPDRe||05336  |'            dRitsu = CDbl(gbuOtherComRateGetUPDRe
05364  |''2004/11/17 Start                                ||05337  |''2004/11/17 Start                                
05365  |''            mstrMonthlyPayCom = CCur(Round(lCalc||05338  |''            mstrMonthlyPayCom = CCur(Round(lCalc
05366  |''2005/01/12 Start                                ||05339  |''2005/01/12 Start                                
05367  |''            dblValueIn = lCalcNav * dRitsu / 100||05340  |''            dblValueIn = lCalcNav * dRitsu / 100
05368  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days||05341  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days
05369  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days||05342  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days
05370  |'                '一年間の日数：365日またはカレン ||05343  |'                '一年間の日数：365日またはカレン 
05371  |'                dblValueIn = lCalcNav * dRitsu / ||05344  |'                dblValueIn = lCalcNav * dRitsu / 
05372  |'            Else                                 ||05345  |'            Else                                 
05373  |'                '一年間の日数：360日             ||05346  |'                '一年間の日数：360日             
05374  |'                dblValueIn = lCalcNav * dRitsu / ||05347  |'                dblValueIn = lCalcNav * dRitsu / 
05375  |'            End If                               ||05348  |'            End If                               
05376  |''2005/01/12 End                                  ||05349  |''2005/01/12 End                                  
05377  |''2005/01/12 Start                                ||05350  |''2005/01/12 Start                                
05378  |''            Call sbGetRoundValue(dblValueIn)    ||05351  |''            Call sbGetRoundValue(dblValueIn)    
05379  |''            mstrMonthlyPayCom = CStr(Format(dblV||05352  |''            mstrMonthlyPayCom = CStr(Format(dblV
05380  |''2005/01/12 End                                  ||05353  |''2005/01/12 End                                  
05381  |''2004/11/17 End                                  ||05354  |''2004/11/17 End                                  
05382  |'        '段階料率                                ||05355  |'        '段階料率                                
05383  |'        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_othe||05356  |'        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_othe
05384  |'            '料率分ループ処理                    ||05357  |'            '料率分ループ処理                    
05385  |'            For i = LBound(gbuOtherComRateGetUPDR||05358  |'            For i = LBound(gbuOtherComRateGetUPDR
05386  |'                TotalRate = TotalRate + CCur(gbuO||05359  |'                TotalRate = TotalRate + CCur(gbuO
05387  |'                cRate = CCur(gbuOtherComRateGetUP||05360  |'                cRate = CCur(gbuOtherComRateGetUP
05388  |'                dRitsu = CDbl(gbuOtherComRateGetU||05361  |'                dRitsu = CDbl(gbuOtherComRateGetU
05389  |'                If i = UBound(gbuOtherComRateGetU||05362  |'                If i = UBound(gbuOtherComRateGetU
05390  |'                    '(前回閾値)：累積閾値 = WORK ||05363  |'                    '(前回閾値)：累積閾値 = WORK 
05391  |'                    TotalRate = WorkRate         ||05364  |'                    TotalRate = WorkRate         
05392  |'                ElseIf TotalRate <= lCalcNav Then||05365  |'                ElseIf TotalRate <= lCalcNav Then
05393  |'                    '累積投資顧問料 = 累積投資顧 ||05366  |'                    '累積投資顧問料 = 累積投資顧 
05394  |''2004/11/17 Start                                ||05367  |''2004/11/17 Start                                
05395  |''                    TotalCom = TotalCom + CCur(R||05368  |''                    TotalCom = TotalCom + CCur(R
05396  |'                    dblValueIn = cRate * dRitsu /||05369  |'                    dblValueIn = cRate * dRitsu /
05397  |''2005/01/13 Start                                ||05370  |''2005/01/13 Start                                
05398  |''                    Call sbGetRoundValue(dblValu||05371  |''                    Call sbGetRoundValue(dblValu
05399  |'                    Call sbGetRoundValue2(dblValu||05372  |'                    Call sbGetRoundValue2(dblValu
05400  |''2005/01/13 End                                  ||05373  |''2005/01/13 End                                  
05401  |'                    TotalCom = TotalCom + dblValu||05374  |'                    TotalCom = TotalCom + dblValu
05402  |''2004/11/17 End                                  ||05375  |''2004/11/17 End                                  
05403  |'                Else                             ||05376  |'                Else                             
05404  |'                    '(前回閾値)：累積閾値 = WORK ||05377  |'                    '(前回閾値)：累積閾値 = WORK 
05405  |'                    TotalRate = WorkRate         ||05378  |'                    TotalRate = WorkRate         
05406  |'                    Exit For                     ||05379  |'                    Exit For                     
05407  |'                End If                           ||05380  |'                End If                           
05408  |'                '累積閾値をWORKに格納(一つ前の閾 ||05381  |'                '累積閾値をWORKに格納(一つ前の閾 
05409  |'                WorkRate = TotalRate             ||05382  |'                WorkRate = TotalRate             
05410  |'            Next i                               ||05383  |'            Next i                               
05411  |'            '累積投資顧問料 = 累積投資顧問料 + ( ||05384  |'            '累積投資顧問料 = 累積投資顧問料 + ( 
05412  |''2004/11/17 Start                                ||05385  |''2004/11/17 Start                                
05413  |''            TotalCom = TotalCom + CCur(Round((lC||05386  |''            TotalCom = TotalCom + CCur(Round((lC
05414  |''            dblValueIn = (lCalcNav - TotalRate) ||05387  |''            dblValueIn = (lCalcNav - TotalRate) 
05415  |''            Call sbGetRoundValue(dblValueIn)    ||05388  |''            Call sbGetRoundValue(dblValueIn)    
05416  |''            TotalCom = TotalCom + dblValueOut   ||05389  |''            TotalCom = TotalCom + dblValueOut   
05417  |'            dblValueIn = (lCalcNav - TotalRate) *||05390  |'            dblValueIn = (lCalcNav - TotalRate) *
05418  |'            TotalCom = TotalCom + dblValueIn     ||05391  |'            TotalCom = TotalCom + dblValueIn     
05419  |''2004/11/17 End                                  ||05392  |''2004/11/17 End                                  
05420  |'            '投資顧問料 = 累積投資顧問料 × 計算 ||05393  |'            '投資顧問料 = 累積投資顧問料 × 計算 
05421  |''2004/11/17 Start                                ||05394  |''2004/11/17 Start                                
05422  |''            mstrMonthlyPayCom = CCur(Round(Total||05395  |''            mstrMonthlyPayCom = CCur(Round(Total
05423  |''2005/01/12 Start                                ||05396  |''2005/01/12 Start                                
05424  |''            dblValueIn = TotalCom * iCalcNum / c||05397  |''            dblValueIn = TotalCom * iCalcNum / c
05425  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days||05398  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days
05426  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days||05399  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days
05427  |'                '一年間の日数：365日またはカレン ||05400  |'                '一年間の日数：365日またはカレン 
05428  |''2005/01/18 Start                                ||05401  |''2005/01/18 Start                                
05429  |''                dblValueIn = lCalcNav * dRitsu /||05402  |''                dblValueIn = lCalcNav * dRitsu /
05430  |'                dblValueIn = TotalCom * iCalcNum ||05403  |'                dblValueIn = TotalCom * iCalcNum 
05431  |''2005/01/18 End                                  ||05404  |''2005/01/18 End                                  
05432  |'            Else                                 ||05405  |'            Else                                 
05433  |'                '一年間の日数：360日             ||05406  |'                '一年間の日数：360日             
05434  |''2005/01/18 Start                                ||05407  |''2005/01/18 Start                                
05435  |''                dblValueIn = lCalcNav * dRitsu /||05408  |''                dblValueIn = lCalcNav * dRitsu /
05436  |'                dblValueIn = TotalCom * iCalcNum ||05409  |'                dblValueIn = TotalCom * iCalcNum 
05437  |''2005/01/18 End                                  ||05410  |''2005/01/18 End                                  
05438  |'            End If                               ||05411  |'            End If                               
05439  |''2005/01/12 End                                  ||05412  |''2005/01/12 End                                  
05440  |''2005/01/12 Start                                ||05413  |''2005/01/12 Start                                
05441  |''            Call sbGetRoundValue(dblValueIn)    ||05414  |''            Call sbGetRoundValue(dblValueIn)    
05442  |''            mstrMonthlyPayCom = dblValueOut     ||05415  |''            mstrMonthlyPayCom = dblValueOut     
05443  |''2005/01/12 End                                  ||05416  |''2005/01/12 End                                  
05444  |''2004/11/17 End                                  ||05417  |''2004/11/17 End                                  
05445  |'        End If                                   ||05418  |'        End If                                   
05446  |''2005/01/12 Start                                ||05419  |''2005/01/12 Start                                
05447  |''''''        '支払への換算用に保存               ||05420  |''''''        '支払への換算用に保存               
05448  |''''''        ddblShiharai = dblValueIn           ||05421  |''''''        ddblShiharai = dblValueIn           
05449  |''2005/01/17 Start                                ||05422  |''2005/01/17 Start                                
05450  |'        ddblExchangeRate = 0                     ||05423  |'        ddblExchangeRate = 0                     
05451  |''2005/01/17 End                                  ||05424  |''2005/01/17 End                                  
05452  |'        '@@@@@ 外部委託顧問料に換算 @@@@@        ||05425  |'        '@@@@@ 外部委託顧問料に換算 @@@@@        
05453  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET||05426  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET
05454  |'          Case "1"    '固定料率                  ||05427  |'          Case "1"    '固定料率                  
05455  |''2005/01/26 Start                                ||05428  |''2005/01/26 Start                                
05456  |''''''              'NAV通貨と外部委託顧問料通貨が||05429  |''''''              'NAV通貨と外部委託顧問料通貨が
05457  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG||05430  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG
05458  |''''''                  '外部委託顧問料通貨が円以 ||05431  |''''''                  '外部委託顧問料通貨が円以 
05459  |''''''                  If gbuMGetUPDRec.N(lRecIdx||05432  |''''''                  If gbuMGetUPDRec.N(lRecIdx
05460  |''''''                    'NAV通貨から外部委託顧問||05433  |''''''                    'NAV通貨から外部委託顧問
05461  |'''''''2005/01/17 Start                           ||05434  |'''''''2005/01/17 Start                           
05462  |'''''''                    dblValueIn = dblValueIn||05435  |'''''''                    dblValueIn = dblValueIn
05463  |'''''''2005/01/18 Start                           ||05436  |'''''''2005/01/18 Start                           
05464  |'''''''                    'NAV通貨→JPYの為替レー||05437  |'''''''                    'NAV通貨→JPYの為替レー
05465  |'''''''                    dstrCurrencyCode = gbuM||05438  |'''''''                    dstrCurrencyCode = gbuM
05466  |'''''''                    ddblExchangeRate = fnst||05439  |'''''''                    ddblExchangeRate = fnst
05467  |'''''''                    If ddblExchangeRate = 0||05440  |'''''''                    If ddblExchangeRate = 0
05468  |'''''''                      intRtn = MsgBox("ＴＴ||05441  |'''''''                      intRtn = MsgBox("ＴＴ
05469  |'''''''                      vbLf & "対象通貨コー ||05442  |'''''''                      vbLf & "対象通貨コー 
05470  |'''''''                      vbLf & "基準日 ： [ "||05443  |'''''''                      vbLf & "基準日 ： [ "
05471  |'''''''                          vbCritical, "ＴＴ||05444  |'''''''                          vbCritical, "ＴＴ
05472  |'''''''                      Exit Function        ||05445  |'''''''                      Exit Function        
05473  |'''''''                    End If                 ||05446  |'''''''                    End If                 
05474  |'''''''                    'NAV通貨→JPYへレート換||05447  |'''''''                    'NAV通貨→JPYへレート換
05475  |'''''''                    dblValueIn = dblValueIn||05448  |'''''''                    dblValueIn = dblValueIn
05476  |'''''''                    '閾値通貨→JPYの為替レ ||05449  |'''''''                    '閾値通貨→JPYの為替レ 
05477  |'''''''                    dstrCurrencyCode = gbuM||05450  |'''''''                    dstrCurrencyCode = gbuM
05478  |'''''''                    ddblExchangeRate = fnst||05451  |'''''''                    ddblExchangeRate = fnst
05479  |'''''''                    '閾値通貨→JPYへレート ||05452  |'''''''                    '閾値通貨→JPYへレート 
05480  |'''''''                    dblValueIn = dblValueIn||05453  |'''''''                    dblValueIn = dblValueIn
05481  |'''''''2005/01/18 End                             ||05454  |'''''''2005/01/18 End                             
05482  |''''''                    '外部委託顧問料通貨→JPY||05455  |''''''                    '外部委託顧問料通貨→JPY
05483  |''''''                    dstrCurrencyCode = gbuMG||05456  |''''''                    dstrCurrencyCode = gbuMG
05484  |''''''                    ddblExchangeRate = fnstr||05457  |''''''                    ddblExchangeRate = fnstr
05485  |''''''                    If ddblExchangeRate = 0 ||05458  |''''''                    If ddblExchangeRate = 0 
05486  |''''''                      intRtn = MsgBox("ＴＴ ||05459  |''''''                      intRtn = MsgBox("ＴＴ 
05487  |''''''                      vbLf & "対象通貨コード||05460  |''''''                      vbLf & "対象通貨コード
05488  |''''''                      vbLf & "基準日 ： [ " ||05461  |''''''                      vbLf & "基準日 ： [ " 
05489  |''''''                          vbCritical, "ＴＴ ||05462  |''''''                          vbCritical, "ＴＴ 
05490  |''''''                      Exit Function         ||05463  |''''''                      Exit Function         
05491  |''''''                    End If                  ||05464  |''''''                    End If                  
05492  |''''''                    'JPY→閾値通貨へ逆レート||05465  |''''''                    'JPY→閾値通貨へ逆レート
05493  |''''''                    dblValueIn = dblValueIn ||05466  |''''''                    dblValueIn = dblValueIn 
05494  |'''''''2005/01/17 End                             ||05467  |'''''''2005/01/17 End                             
05495  |''''''                  End If                    ||05468  |''''''                  End If                    
05496  |''''''              End If                        ||05469  |''''''              End If                        
05497  |''''''              'NAV通貨と外部委託顧問料通貨が||05470  |''''''              'NAV通貨と外部委託顧問料通貨が
05498  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG||05471  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG
05499  |''''''                  '外部委託顧問料通貨が円   ||05472  |''''''                  '外部委託顧問料通貨が円   
05500  |''''''                  If gbuMGetUPDRec.N(lRecIdx||05473  |''''''                  If gbuMGetUPDRec.N(lRecIdx
05501  |''''''                    'NAV通貨から外部委託顧問||05474  |''''''                    'NAV通貨から外部委託顧問
05502  |'''''''2005/01/17 Start                           ||05475  |'''''''2005/01/17 Start                           
05503  |'''''''                    dblValueIn = dblValueIn||05476  |'''''''                    dblValueIn = dblValueIn
05504  |'''''''2005/01/18 Start                           ||05477  |'''''''2005/01/18 Start                           
05505  |''''''                    'NAV通貨→JPYの為替レー ||05478  |''''''                    'NAV通貨→JPYの為替レー 
05506  |'''''''                    dstrCurrencyCode = gbuM||05479  |'''''''                    dstrCurrencyCode = gbuM
05507  |'''''''                    ddblExchangeRate = fnst||05480  |'''''''                    ddblExchangeRate = fnst
05508  |'''''''                    If ddblExchangeRate = 0||05481  |'''''''                    If ddblExchangeRate = 0
05509  |'''''''                      intRtn = MsgBox("ＴＴ||05482  |'''''''                      intRtn = MsgBox("ＴＴ
05510  |'''''''                      vbLf & "対象通貨コー ||05483  |'''''''                      vbLf & "対象通貨コー 
05511  |'''''''                      vbLf & "基準日 ： [ "||05484  |'''''''                      vbLf & "基準日 ： [ "
05512  |'''''''                          vbCritical, "ＴＴ||05485  |'''''''                          vbCritical, "ＴＴ
05513  |'''''''                      Exit Function        ||05486  |'''''''                      Exit Function        
05514  |'''''''                    End If                 ||05487  |'''''''                    End If                 
05515  |'''''''                    'NAV通貨→JPYへレート換||05488  |'''''''                    'NAV通貨→JPYへレート換
05516  |'''''''                    dblValueIn = dblValueIn||05489  |'''''''                    dblValueIn = dblValueIn
05517  |'''''''                    '閾値通貨→JPYの為替レ ||05490  |'''''''                    '閾値通貨→JPYの為替レ 
05518  |'''''''                    dstrCurrencyCode = gbuM||05491  |'''''''                    dstrCurrencyCode = gbuM
05519  |'''''''                    ddblExchangeRate = fnst||05492  |'''''''                    ddblExchangeRate = fnst
05520  |'''''''                    If ddblExchangeRate = 0||05493  |'''''''                    If ddblExchangeRate = 0
05521  |'''''''                      intRtn = MsgBox("ＴＴ||05494  |'''''''                      intRtn = MsgBox("ＴＴ
05522  |'''''''                      vbLf & "対象通貨コー ||05495  |'''''''                      vbLf & "対象通貨コー 
05523  |'''''''                      vbLf & "基準日 ： [ "||05496  |'''''''                      vbLf & "基準日 ： [ "
05524  |'''''''                          vbCritical, "ＴＴ||05497  |'''''''                          vbCritical, "ＴＴ
05525  |'''''''                      Exit Function        ||05498  |'''''''                      Exit Function        
05526  |'''''''                    End If                 ||05499  |'''''''                    End If                 
05527  |'''''''                    '閾値通貨→JPYへレート ||05500  |'''''''                    '閾値通貨→JPYへレート 
05528  |'''''''                    dblValueIn = dblValueIn||05501  |'''''''                    dblValueIn = dblValueIn
05529  |'''''''2005/01/18 End                             ||05502  |'''''''2005/01/18 End                             
05530  |'''''''''''                    '外部委託顧問料通貨||05503  |'''''''''''                    '外部委託顧問料通貨
05531  |'''''''''''                    dstrCurrencyCode = ||05504  |'''''''''''                    dstrCurrencyCode = 
05532  |'''''''''''                    ddblExchangeRate = ||05505  |'''''''''''                    ddblExchangeRate = 
05533  |'''''''''''                    'JPY→閾値通貨へ逆 ||05506  |'''''''''''                    'JPY→閾値通貨へ逆 
05534  |'''''''''''                    dblValueIn = dblVal||05507  |'''''''''''                    dblValueIn = dblVal
05535  |'''''''2005/01/17 End                             ||05508  |'''''''2005/01/17 End                             
05536  |''''''                  End If                    ||05509  |''''''                  End If                    
05537  |''''''              End If                        ||05510  |''''''              End If                        
05538  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||05511  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
05539  |'                Else                             ||05512  |'                Else                             
05540  |'                  '外部委託顧問料通貨→JPYの為替 ||05513  |'                  '外部委託顧問料通貨→JPYの為替 
05541  |'                  dstrCurrencyCode = gbuMGetUPDRe||05514  |'                  dstrCurrencyCode = gbuMGetUPDRe
05542  |'                  ddblExchangeRate = fnstrExchang||05515  |'                  ddblExchangeRate = fnstrExchang
05543  |'                  If ddblExchangeRate = 0 Then   ||05516  |'                  If ddblExchangeRate = 0 Then   
05544  |'                    intRtn = MsgBox("ＴＴＭが取得||05517  |'                    intRtn = MsgBox("ＴＴＭが取得
05545  |'                    vbLf & "対象通貨コード ： [ "||05518  |'                    vbLf & "対象通貨コード ： [ "
05546  |'                    vbLf & "基準日 ： [ " & Mid(d||05519  |'                    vbLf & "基準日 ： [ " & Mid(d
05547  |'                        vbCritical, "ＴＴＭ取得エ||05520  |'                        vbCritical, "ＴＴＭ取得エ
05548  |'                    Exit Function                ||05521  |'                    Exit Function                
05549  |'                  End If                         ||05522  |'                  End If                         
05550  |'                  'JPY→閾値通貨へ逆レート換算   ||05523  |'                  'JPY→閾値通貨へ逆レート換算   
05551  |'                  dblValueIn = dblValueIn / ddblE||05524  |'                  dblValueIn = dblValueIn / ddblE
05552  |'                End If                           ||05525  |'                End If                           
05553  |''2005/01/26 End                                  ||05526  |''2005/01/26 End                                  
05554  |'          Case "2"    '段階料率                  ||05527  |'          Case "2"    '段階料率                  
05555  |''2005/01/26 Start                                ||05528  |''2005/01/26 Start                                
05556  |''''''              'NAV通貨と閾値通貨が相違      ||05529  |''''''              'NAV通貨と閾値通貨が相違      
05557  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG||05530  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG
05558  |''''''                  '閾値通貨と外部委託顧問料 ||05531  |''''''                  '閾値通貨と外部委託顧問料 
05559  |''''''                  If gbuMGetUPDRec.N(lRecIdx||05532  |''''''                  If gbuMGetUPDRec.N(lRecIdx
05560  |''''''                      '外部委託顧問料通貨が ||05533  |''''''                      '外部委託顧問料通貨が 
05561  |''''''                      If gbuMGetUPDRec.N(lRe||05534  |''''''                      If gbuMGetUPDRec.N(lRe
05562  |''''''                        '閾値通貨から外部委 ||05535  |''''''                        '閾値通貨から外部委 
05563  |'''''''2005/01/17 Start                           ||05536  |'''''''2005/01/17 Start                           
05564  |'''''''                         dblValueIn = dblVa||05537  |'''''''                         dblValueIn = dblVa
05565  |'''''''2005/01/18 Start                           ||05538  |'''''''2005/01/18 Start                           
05566  |'''''''                         'NAV通貨→JPYの為 ||05539  |'''''''                         'NAV通貨→JPYの為 
05567  |'''''''                         dstrCurrencyCode =||05540  |'''''''                         dstrCurrencyCode =
05568  |'''''''                         ddblExchangeRate =||05541  |'''''''                         ddblExchangeRate =
05569  |'''''''                         'NAV通貨→JPYへレ ||05542  |'''''''                         'NAV通貨→JPYへレ 
05570  |'''''''                         dblValueIn = dblVa||05543  |'''''''                         dblValueIn = dblVa
05571  |''''''                         '閾値通貨→JPYの為 ||05544  |''''''                         '閾値通貨→JPYの為 
05572  |''''''                         dstrCurrencyCode = ||05545  |''''''                         dstrCurrencyCode = 
05573  |''''''                         ddblExchangeRate = ||05546  |''''''                         ddblExchangeRate = 
05574  |''''''                         If ddblExchangeRate||05547  |''''''                         If ddblExchangeRate
05575  |''''''                           intRtn = MsgBox("||05548  |''''''                           intRtn = MsgBox("
05576  |''''''                           vbLf & "対象通貨 ||05549  |''''''                           vbLf & "対象通貨 
05577  |''''''                           vbLf & "基準日 ：||05550  |''''''                           vbLf & "基準日 ：
05578  |''''''                               vbCritical, "||05551  |''''''                               vbCritical, "
05579  |''''''                           Exit Function    ||05552  |''''''                           Exit Function    
05580  |''''''                         End If             ||05553  |''''''                         End If             
05581  |''''''                         '閾値通貨→JPYへレ ||05554  |''''''                         '閾値通貨→JPYへレ 
05582  |''''''                         dblValueIn = dblVal||05555  |''''''                         dblValueIn = dblVal
05583  |'''''''2005/01/18 End                             ||05556  |'''''''2005/01/18 End                             
05584  |''''''                         '外部委託顧問料通貨||05557  |''''''                         '外部委託顧問料通貨
05585  |''''''                         dstrCurrencyCode = ||05558  |''''''                         dstrCurrencyCode = 
05586  |''''''                         ddblExchangeRate = ||05559  |''''''                         ddblExchangeRate = 
05587  |''''''                         If ddblExchangeRate||05560  |''''''                         If ddblExchangeRate
05588  |''''''                           intRtn = MsgBox("||05561  |''''''                           intRtn = MsgBox("
05589  |''''''                           vbLf & "対象通貨 ||05562  |''''''                           vbLf & "対象通貨 
05590  |''''''                           vbLf & "基準日 ：||05563  |''''''                           vbLf & "基準日 ：
05591  |''''''                               vbCritical, "||05564  |''''''                               vbCritical, "
05592  |''''''                           Exit Function    ||05565  |''''''                           Exit Function    
05593  |''''''                         End If             ||05566  |''''''                         End If             
05594  |''''''                         'JPY→閾値通貨へ逆 ||05567  |''''''                         'JPY→閾値通貨へ逆 
05595  |''''''                         dblValueIn = dblVal||05568  |''''''                         dblValueIn = dblVal
05596  |'''''''2005/01/17 End                             ||05569  |'''''''2005/01/17 End                             
05597  |''''''                      End If                ||05570  |''''''                      End If                
05598  |''''''                  End If                    ||05571  |''''''                  End If                    
05599  |''''''              End If                        ||05572  |''''''              End If                        
05600  |''''''              'NAV通貨と閾値通貨が相違      ||05573  |''''''              'NAV通貨と閾値通貨が相違      
05601  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG||05574  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG
05602  |''''''                  '閾値通貨と外部委託顧問料 ||05575  |''''''                  '閾値通貨と外部委託顧問料 
05603  |''''''                  If gbuMGetUPDRec.N(lRecIdx||05576  |''''''                  If gbuMGetUPDRec.N(lRecIdx
05604  |''''''                      '外部委託顧問料通貨が ||05577  |''''''                      '外部委託顧問料通貨が 
05605  |''''''                      If gbuMGetUPDRec.N(lRe||05578  |''''''                      If gbuMGetUPDRec.N(lRe
05606  |''''''                        '閾値通貨から外部委 ||05579  |''''''                        '閾値通貨から外部委 
05607  |'''''''2005/01/17 Start                           ||05580  |'''''''2005/01/17 Start                           
05608  |'''''''                         dblValueIn = dblVa||05581  |'''''''                         dblValueIn = dblVa
05609  |'''''''2005/01/18 Start                           ||05582  |'''''''2005/01/18 Start                           
05610  |'''''''                         'NAV通貨→JPYの為 ||05583  |'''''''                         'NAV通貨→JPYの為 
05611  |'''''''                         dstrCurrencyCode =||05584  |'''''''                         dstrCurrencyCode =
05612  |'''''''                         ddblExchangeRate =||05585  |'''''''                         ddblExchangeRate =
05613  |'''''''                         'NAV通貨→JPYへレ ||05586  |'''''''                         'NAV通貨→JPYへレ 
05614  |'''''''                         dblValueIn = dblVa||05587  |'''''''                         dblValueIn = dblVa
05615  |''''''                         '閾値通貨→JPYの為 ||05588  |''''''                         '閾値通貨→JPYの為 
05616  |''''''                         dstrCurrencyCode = ||05589  |''''''                         dstrCurrencyCode = 
05617  |''''''                         ddblExchangeRate = ||05590  |''''''                         ddblExchangeRate = 
05618  |''''''                         If ddblExchangeRate||05591  |''''''                         If ddblExchangeRate
05619  |''''''                           intRtn = MsgBox("||05592  |''''''                           intRtn = MsgBox("
05620  |''''''                           vbLf & "対象通貨 ||05593  |''''''                           vbLf & "対象通貨 
05621  |''''''                           vbLf & "基準日 ：||05594  |''''''                           vbLf & "基準日 ：
05622  |''''''                               vbCritical, "||05595  |''''''                               vbCritical, "
05623  |''''''                           Exit Function    ||05596  |''''''                           Exit Function    
05624  |''''''                         End If             ||05597  |''''''                         End If             
05625  |''''''                         '閾値通貨→JPYへレ ||05598  |''''''                         '閾値通貨→JPYへレ 
05626  |''''''                         dblValueIn = dblVal||05599  |''''''                         dblValueIn = dblVal
05627  |'''''''2005/01/18 End                             ||05600  |'''''''2005/01/18 End                             
05628  |'''''''                         '外部委託顧問料通 ||05601  |'''''''                         '外部委託顧問料通 
05629  |'''''''                         dstrCurrencyCode =||05602  |'''''''                         dstrCurrencyCode =
05630  |'''''''                         ddblExchangeRate =||05603  |'''''''                         ddblExchangeRate =
05631  |'''''''                         'JPY→閾値通貨へ逆||05604  |'''''''                         'JPY→閾値通貨へ逆
05632  |'''''''                         dblValueIn = dblVa||05605  |'''''''                         dblValueIn = dblVa
05633  |'''''''2005/01/17 End                             ||05606  |'''''''2005/01/17 End                             
05634  |''''''                      End If                ||05607  |''''''                      End If                
05635  |''''''                  End If                    ||05608  |''''''                  End If                    
05636  |''''''              End If                        ||05609  |''''''              End If                        
05637  |'            '                                    ||05610  |'            '                                    
05638  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe||05611  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe
05639  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||05612  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
05640  |'                Else                             ||05613  |'                Else                             
05641  |'                    '閾値通貨→JPYの為替レートを ||05614  |'                    '閾値通貨→JPYの為替レートを 
05642  |'                    dstrCurrencyCode = gbuMGetUPD||05615  |'                    dstrCurrencyCode = gbuMGetUPD
05643  |'                    ddblExchangeRate = fnstrExcha||05616  |'                    ddblExchangeRate = fnstrExcha
05644  |'                    'JPY→閾値通貨へ逆レート換算 ||05617  |'                    'JPY→閾値通貨へ逆レート換算 
05645  |'                    dblValueIn = dblValueIn / ddb||05618  |'                    dblValueIn = dblValueIn / ddb
05646  |'                End If                           ||05619  |'                End If                           
05647  |'            Else                                 ||05620  |'            Else                                 
05648  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||05621  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
05649  |'                    '外部委託顧問料通貨→JPYの為 ||05622  |'                    '外部委託顧問料通貨→JPYの為 
05650  |'                    dstrCurrencyCode = gbuMGetUPD||05623  |'                    dstrCurrencyCode = gbuMGetUPD
05651  |'                    ddblExchangeRate = fnstrExcha||05624  |'                    ddblExchangeRate = fnstrExcha
05652  |'                    'JPY→閾値通貨へレート換算   ||05625  |'                    'JPY→閾値通貨へレート換算   
05653  |'                    dblValueIn = dblValueIn / ddb||05626  |'                    dblValueIn = dblValueIn / ddb
05654  |'                Else                             ||05627  |'                Else                             
05655  |'                    '閾値通貨→JPYの為替レートを ||05628  |'                    '閾値通貨→JPYの為替レートを 
05656  |'                    dstrCurrencyCode = gbuMGetUPD||05629  |'                    dstrCurrencyCode = gbuMGetUPD
05657  |'                    ddblExchangeRate = fnstrExcha||05630  |'                    ddblExchangeRate = fnstrExcha
05658  |'                    'JPY→閾値通貨へ逆レート換算 ||05631  |'                    'JPY→閾値通貨へ逆レート換算 
05659  |'                    dblValueIn = dblValueIn * ddb||05632  |'                    dblValueIn = dblValueIn * ddb
05660  |'                    '外部委託顧問料通貨→JPYの為 ||05633  |'                    '外部委託顧問料通貨→JPYの為 
05661  |'                    dstrCurrencyCode = gbuMGetUPD||05634  |'                    dstrCurrencyCode = gbuMGetUPD
05662  |'                    ddblExchangeRate = fnstrExcha||05635  |'                    ddblExchangeRate = fnstrExcha
05663  |'                    'JPY→閾値通貨へ逆レート換算 ||05636  |'                    'JPY→閾値通貨へ逆レート換算 
05664  |'                    dblValueIn = dblValueIn / ddb||05637  |'                    dblValueIn = dblValueIn / ddb
05665  |'                End If                           ||05638  |'                End If                           
05666  |'            End If                               ||05639  |'            End If                               
05667  |''2005/01/26 End                                  ||05640  |''2005/01/26 End                                  
05668  |'        End Select                               ||05641  |'        End Select                               
05669  |'        '@@@@@ 外部委託顧問料に換算 @@@@@        ||05642  |'        '@@@@@ 外部委託顧問料に換算 @@@@@        
05670  |''2005/01/13 Start                                ||05643  |''2005/01/13 Start                                
05671  |''        Call sbGetRoundValue(dblValueIn)        ||05644  |''        Call sbGetRoundValue(dblValueIn)        
05672  |'        Call sbGetRoundValue2(dblValueIn)        ||05645  |'        Call sbGetRoundValue2(dblValueIn)        
05673  |''2005/01/13 End                                  ||05646  |''2005/01/13 End                                  
05674  |'        mstrMonthlyPayCom = dblValueOut          ||05647  |'        mstrMonthlyPayCom = dblValueOut          
05675  |''2005/01/12 End                                  ||05648  |''2005/01/12 End                                  
05676  |'                                                 ||05649  |'                                                 
05677  |''2005/01/12 Start                                ||05650  |''2005/01/12 Start                                
05678  |''        '年率                                   ||05651  |''        '年率                                   
05679  |''        .Cells(39, 2).Value = sWord10           ||05652  |''        .Cells(39, 2).Value = sWord10           
05680  |'''2004/09/10 Start                               ||05653  |'''2004/09/10 Start                               
05681  |'''        .Cells(39, 10).Value = sWord19         ||05654  |'''        .Cells(39, 10).Value = sWord19         
05682  |'        .Cells(39, 11).Value = sWord19           ||05655  |'        .Cells(39, 11).Value = sWord19           
05683  |'        '年率                                    ||05656  |'        '年率                                    
05684  |'        .Cells(39, 2).Value = sWord10            ||05657  |'        .Cells(39, 2).Value = sWord10            
05685  |''2004/09/10 Start                                ||05658  |''2004/09/10 Start                                
05686  |''        .Cells(39, 10).Value = sWord19          ||05659  |''        .Cells(39, 10).Value = sWord19          
05687  |''        .Cells(39, 9).Value = sWord19           ||05660  |''        .Cells(39, 9).Value = sWord19           
05688  |''2005/01/12 End                                  ||05661  |''2005/01/12 End                                  
05689  |''2004/09/10 End                                  ||05662  |''2004/09/10 End                                  
05690  |'        TotalRate = 0                            ||05663  |'        TotalRate = 0                            
05691  |'        '固定料率                                ||05664  |'        '固定料率                                
05692  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_ra||05665  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_ra
05693  |'            '年率1行固定                         ||05666  |'            '年率1行固定                         
05694  |''2004/11/17 Start                                ||05667  |''2004/11/17 Start                                
05695  |''            .Cells(39, 13).Value = _            ||05668  |''            .Cells(39, 13).Value = _            
05696  |''                sWord30 & Format(gbuOtherComRate||05669  |''                sWord30 & Format(gbuOtherComRate
05697  |''2005/01/12 Start                                ||05670  |''2005/01/12 Start                                
05698  |'            .Cells(39, 13).Value = _             ||05671  |'            .Cells(39, 13).Value = _             
05699  |'                sWord30 & Format(gbuOtherComRateG||05672  |'                sWord30 & Format(gbuOtherComRateG
05700  |''            .Cells(39, 11).Value = _            ||05673  |''            .Cells(39, 11).Value = _            
05701  |''                sWord30 & Format(gbuOtherComRate||05674  |''                sWord30 & Format(gbuOtherComRate
05702  |''2005/01/12 End                                  ||05675  |''2005/01/12 End                                  
05703  |''2004/11/17 End                                  ||05676  |''2004/11/17 End                                  
05704  |'        '段階料率                                ||05677  |'        '段階料率                                
05705  |'        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_othe||05678  |'        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_othe
05706  |'            '料率順位のデータ数により処理を分岐  ||05679  |'            '料率順位のデータ数により処理を分岐  
05707  |'            iRowCnt = 0                          ||05680  |'            iRowCnt = 0                          
05708  |'            If UBound(gbuOtherComRateGetUPDRec.N)||05681  |'            If UBound(gbuOtherComRateGetUPDRec.N)
05709  |'                '料率データが4件以上のときは行間 ||05682  |'                '料率データが4件以上のときは行間 
05710  |'                For i = LBound(gbuOtherComRateGet||05683  |'                For i = LBound(gbuOtherComRateGet
05711  |'                    If i = 0 Then                ||05684  |'                    If i = 0 Then                
05712  |'                        '年率1行目               ||05685  |'                        '年率1行目               
05713  |''2005/01/12 Start                                ||05686  |''2005/01/12 Start                                
05714  |''                        .Cells(39, 13).Value = _||05687  |''                        .Cells(39, 13).Value = _
05715  |''                            sWord26 & CStr(Forma||05688  |''                            sWord26 & CStr(Forma
05716  |''                            sWord27 & Format(gbu||05689  |''                            sWord27 & Format(gbu
05717  |'                        Select Case gbuMGetUPDRec||05690  |'                        Select Case gbuMGetUPDRec
05718  |'                            Case cAud            ||05691  |'                            Case cAud            
05719  |'                                .Cells(39, 13).Va||05692  |'                                .Cells(39, 13).Va
05720  |'                                    sWord26 & CSt||05693  |'                                    sWord26 & CSt
05721  |'                                    sAud & sWord2||05694  |'                                    sAud & sWord2
05722  |'                            Case cCad            ||05695  |'                            Case cCad            
05723  |'                                .Cells(39, 13).Va||05696  |'                                .Cells(39, 13).Va
05724  |'                                    sWord26 & CSt||05697  |'                                    sWord26 & CSt
05725  |'                                    sCad & sWord2||05698  |'                                    sCad & sWord2
05726  |'                            Case cChf            ||05699  |'                            Case cChf            
05727  |'                                .Cells(39, 13).Va||05700  |'                                .Cells(39, 13).Va
05728  |'                                    sWord26 & CSt||05701  |'                                    sWord26 & CSt
05729  |'                                    sChf & sWord2||05702  |'                                    sChf & sWord2
05730  |'                            Case cEur            ||05703  |'                            Case cEur            
05731  |'                                .Cells(39, 13).Va||05704  |'                                .Cells(39, 13).Va
05732  |'                                    sWord26 & CSt||05705  |'                                    sWord26 & CSt
05733  |'                                    sEur & sWord2||05706  |'                                    sEur & sWord2
05734  |'                            Case cGbp            ||05707  |'                            Case cGbp            
05735  |'                                .Cells(39, 13).Va||05708  |'                                .Cells(39, 13).Va
05736  |'                                    sWord26 & CSt||05709  |'                                    sWord26 & CSt
05737  |'                                    sGbp & sWord2||05710  |'                                    sGbp & sWord2
05738  |'                            Case cHkd            ||05711  |'                            Case cHkd            
05739  |'                                .Cells(39, 13).Va||05712  |'                                .Cells(39, 13).Va
05740  |'                                    sWord26 & CSt||05713  |'                                    sWord26 & CSt
05741  |'                                    sHkd & sWord2||05714  |'                                    sHkd & sWord2
05742  |'                            Case cJpy            ||05715  |'                            Case cJpy            
05743  |'                                .Cells(39, 13).Va||05716  |'                                .Cells(39, 13).Va
05744  |'                                    sWord26 & CSt||05717  |'                                    sWord26 & CSt
05745  |'                                    sYen & sWord2||05718  |'                                    sYen & sWord2
05746  |'                            Case cMyr            ||05719  |'                            Case cMyr            
05747  |'                                .Cells(39, 13).Va||05720  |'                                .Cells(39, 13).Va
05748  |'                                    sWord26 & CSt||05721  |'                                    sWord26 & CSt
05749  |'                                    sMyr & sWord2||05722  |'                                    sMyr & sWord2
05750  |'                            Case cNzd            ||05723  |'                            Case cNzd            
05751  |'                                .Cells(39, 13).Va||05724  |'                                .Cells(39, 13).Va
05752  |'                                    sWord26 & CSt||05725  |'                                    sWord26 & CSt
05753  |'                                    sNzd & sWord2||05726  |'                                    sNzd & sWord2
05754  |'                            Case cSek            ||05727  |'                            Case cSek            
05755  |'                                .Cells(39, 13).Va||05728  |'                                .Cells(39, 13).Va
05756  |'                                    sWord26 & CSt||05729  |'                                    sWord26 & CSt
05757  |'                                    sSek & sWord2||05730  |'                                    sSek & sWord2
05758  |'                            Case cSgd            ||05731  |'                            Case cSgd            
05759  |'                                .Cells(39, 13).Va||05732  |'                                .Cells(39, 13).Va
05760  |'                                    sWord26 & CSt||05733  |'                                    sWord26 & CSt
05761  |'                                    sSgd & sWord2||05734  |'                                    sSgd & sWord2
05762  |'                            Case cUsd            ||05735  |'                            Case cUsd            
05763  |'                                .Cells(39, 13).Va||05736  |'                                .Cells(39, 13).Va
05764  |'                                    sWord26 & CSt||05737  |'                                    sWord26 & CSt
05765  |'                                    sUsd & sWord2||05738  |'                                    sUsd & sWord2
05766  |'                            Case cNok            ||05739  |'                            Case cNok            
05767  |'                                .Cells(39, 13).Va||05740  |'                                .Cells(39, 13).Va
05768  |'                                    sWord26 & CSt||05741  |'                                    sWord26 & CSt
05769  |'                                    sNok & sWord2||05742  |'                                    sNok & sWord2
05770  |'                        End Select               ||05743  |'                        End Select               
05771  |''2005/01/12 End                                  ||05744  |''2005/01/12 End                                  
05772  |'                        '年率　累積値セット      ||05745  |'                        '年率　累積値セット      
05773  |'                        TotalRate = CCur(gbuOther||05746  |'                        TotalRate = CCur(gbuOther
05774  |'                    ElseIf i = UBound(gbuOtherCom||05747  |'                    ElseIf i = UBound(gbuOtherCom
05775  |'                        '年率最終行              ||05748  |'                        '年率最終行              
05776  |''2005/01/12 Start                                ||05749  |''2005/01/12 Start                                
05777  |'                        '前半金額部分            ||05750  |'                        '前半金額部分            
05778  |'                        .Cells(39 + i, 23).Number||05751  |'                        .Cells(39 + i, 23).Number
05779  |''2005/01/20 Start                                ||05752  |''2005/01/20 Start                                
05780  |''                        .Cells(39 + i, 23).Value||05753  |''                        .Cells(39 + i, 23).Value
05781  |'                        If gbuMGetUPDRec.N(lRecId||05754  |'                        If gbuMGetUPDRec.N(lRecId
05782  |'                            .Cells(39 + i, 23).Va||05755  |'                            .Cells(39 + i, 23).Va
05783  |'                        Else                     ||05756  |'                        Else                     
05784  |'                            .Cells(39 + i, 23).Va||05757  |'                            .Cells(39 + i, 23).Va
05785  |'                        End If                   ||05758  |'                        End If                   
05786  |''2005/01/20 End                                  ||05759  |''2005/01/20 End                                  
05787  |'                        .Cells(39 + i, 23).Horizo||05760  |'                        .Cells(39 + i, 23).Horizo
05788  |''                        '前半金額部分           ||05761  |''                        '前半金額部分           
05789  |''                        .Cells(39 + i, 21).Numbe||05762  |''                        .Cells(39 + i, 21).Numbe
05790  |''                        .Cells(39 + i, 21).Value||05763  |''                        .Cells(39 + i, 21).Value
05791  |''                        .Cells(39 + i, 21).Horiz||05764  |''                        .Cells(39 + i, 21).Horiz
05792  |''2005/01/12 End                                  ||05765  |''2005/01/12 End                                  
05793  |''                        '年率　累積値セット     ||05766  |''                        '年率　累積値セット     
05794  |''                        TotalRate = TotalRate + ||05767  |''                        TotalRate = TotalRate + 
05795  |'                        '後半の文言              ||05768  |'                        '後半の文言              
05796  |''2005/01/12 Start                                ||05769  |''2005/01/12 Start                                
05797  |''                        .Cells(39 + i, 24).Value||05770  |''                        .Cells(39 + i, 24).Value
05798  |''                            sWord31 & Format(gbu||05771  |''                            sWord31 & Format(gbu
05799  |'                        Select Case gbuMGetUPDRec||05772  |'                        Select Case gbuMGetUPDRec
05800  |'                            Case cAud            ||05773  |'                            Case cAud            
05801  |'                                .Cells(39 + i, 24||05774  |'                                .Cells(39 + i, 24
05802  |'                                    sAud & sWord3||05775  |'                                    sAud & sWord3
05803  |'                            Case cCad            ||05776  |'                            Case cCad            
05804  |'                                .Cells(39 + i, 24||05777  |'                                .Cells(39 + i, 24
05805  |'                                    sCad & sWord3||05778  |'                                    sCad & sWord3
05806  |'                            Case cChf            ||05779  |'                            Case cChf            
05807  |'                                .Cells(39 + i, 24||05780  |'                                .Cells(39 + i, 24
05808  |'                                    sChf & sWord3||05781  |'                                    sChf & sWord3
05809  |'                            Case cEur            ||05782  |'                            Case cEur            
05810  |'                                .Cells(39 + i, 24||05783  |'                                .Cells(39 + i, 24
05811  |'                                    sEur & sWord3||05784  |'                                    sEur & sWord3
05812  |'                            Case cGbp            ||05785  |'                            Case cGbp            
05813  |'                                .Cells(39 + i, 24||05786  |'                                .Cells(39 + i, 24
05814  |'                                    sGbp & sWord3||05787  |'                                    sGbp & sWord3
05815  |'                            Case cHkd            ||05788  |'                            Case cHkd            
05816  |'                                .Cells(39 + i, 24||05789  |'                                .Cells(39 + i, 24
05817  |'                                    sHkd & sWord3||05790  |'                                    sHkd & sWord3
05818  |'                            Case cJpy            ||05791  |'                            Case cJpy            
05819  |'                                .Cells(39 + i, 24||05792  |'                                .Cells(39 + i, 24
05820  |'                                    sYen & sWord3||05793  |'                                    sYen & sWord3
05821  |'                            Case cMyr            ||05794  |'                            Case cMyr            
05822  |'                                .Cells(39 + i, 24||05795  |'                                .Cells(39 + i, 24
05823  |'                                    sMyr & sWord3||05796  |'                                    sMyr & sWord3
05824  |'                            Case cNzd            ||05797  |'                            Case cNzd            
05825  |'                                .Cells(39 + i, 24||05798  |'                                .Cells(39 + i, 24
05826  |'                                    sNzd & sWord3||05799  |'                                    sNzd & sWord3
05827  |'                            Case cSek            ||05800  |'                            Case cSek            
05828  |'                                .Cells(39 + i, 24||05801  |'                                .Cells(39 + i, 24
05829  |'                                    sSek & sWord3||05802  |'                                    sSek & sWord3
05830  |'                            Case cSgd            ||05803  |'                            Case cSgd            
05831  |'                                .Cells(39 + i, 24||05804  |'                                .Cells(39 + i, 24
05832  |'                                    sSgd & sWord3||05805  |'                                    sSgd & sWord3
05833  |'                            Case cUsd            ||05806  |'                            Case cUsd            
05834  |'                                .Cells(39 + i, 24||05807  |'                                .Cells(39 + i, 24
05835  |'                                    sUsd & sWord3||05808  |'                                    sUsd & sWord3
05836  |'                            Case cNok            ||05809  |'                            Case cNok            
05837  |'                                .Cells(39 + i, 24||05810  |'                                .Cells(39 + i, 24
05838  |'                                    sNok & sWord3||05811  |'                                    sNok & sWord3
05839  |'                        End Select               ||05812  |'                        End Select               
05840  |''2005/01/12 End                                  ||05813  |''2005/01/12 End                                  
05841  |'                    Else                         ||05814  |'                    Else                         
05842  |'                        '年率2行目以降           ||05815  |'                        '年率2行目以降           
05843  |''2005/01/12 Start                                ||05816  |''2005/01/12 Start                                
05844  |'                        '前半金額部分            ||05817  |'                        '前半金額部分            
05845  |'                        .Cells(39 + i, 23).Number||05818  |'                        .Cells(39 + i, 23).Number
05846  |''                        .Cells(39 + i, 23).Value||05819  |''                        .Cells(39 + i, 23).Value
05847  |''2005/01/20 Start                                ||05820  |''2005/01/20 Start                                
05848  |''                        .Cells(39 + i, 23).Value||05821  |''                        .Cells(39 + i, 23).Value
05849  |'                        If gbuMGetUPDRec.N(lRecId||05822  |'                        If gbuMGetUPDRec.N(lRecId
05850  |'                            .Cells(39 + i, 23).Va||05823  |'                            .Cells(39 + i, 23).Va
05851  |'                        Else                     ||05824  |'                        Else                     
05852  |'                            .Cells(39 + i, 23).Va||05825  |'                            .Cells(39 + i, 23).Va
05853  |'                        End If                   ||05826  |'                        End If                   
05854  |''2005/01/20 End                                  ||05827  |''2005/01/20 End                                  
05855  |'                        .Cells(39 + i, 23).Horizo||05828  |'                        .Cells(39 + i, 23).Horizo
05856  |''                        '前半金額部分           ||05829  |''                        '前半金額部分           
05857  |''                        .Cells(39 + i, 21).Numbe||05830  |''                        .Cells(39 + i, 21).Numbe
05858  |''                        .Cells(39 + i, 21).Value||05831  |''                        .Cells(39 + i, 21).Value
05859  |''                        .Cells(39 + i, 21).Horiz||05832  |''                        .Cells(39 + i, 21).Horiz
05860  |''2005/01/12 End                                  ||05833  |''2005/01/12 End                                  
05861  |'                        '年率　累積値セット      ||05834  |'                        '年率　累積値セット      
05862  |'                        TotalRate = TotalRate + C||05835  |'                        TotalRate = TotalRate + C
05863  |'                        '後半の文言              ||05836  |'                        '後半の文言              
05864  |''2005/01/12 Start                                ||05837  |''2005/01/12 Start                                
05865  |''                        .Cells(39 + i, 24).Value||05838  |''                        .Cells(39 + i, 24).Value
05866  |''                            sWord29 & CStr(Forma||05839  |''                            sWord29 & CStr(Forma
05867  |''                            Format(gbuOtherComRa||05840  |''                            Format(gbuOtherComRa
05868  |'                        Select Case gbuMGetUPDRec||05841  |'                        Select Case gbuMGetUPDRec
05869  |'                            Case cAud            ||05842  |'                            Case cAud            
05870  |'                                .Cells(39 + i, 24||05843  |'                                .Cells(39 + i, 24
05871  |'                                    sAud & sWord2||05844  |'                                    sAud & sWord2
05872  |'                                    Format(gbuOth||05845  |'                                    Format(gbuOth
05873  |'                            Case cCad            ||05846  |'                            Case cCad            
05874  |'                                .Cells(39 + i, 24||05847  |'                                .Cells(39 + i, 24
05875  |'                                    sCad & sWord2||05848  |'                                    sCad & sWord2
05876  |'                                    Format(gbuOth||05849  |'                                    Format(gbuOth
05877  |'                            Case cChf            ||05850  |'                            Case cChf            
05878  |'                                .Cells(39 + i, 24||05851  |'                                .Cells(39 + i, 24
05879  |'                                    sChf & sWord2||05852  |'                                    sChf & sWord2
05880  |'                                    Format(gbuOth||05853  |'                                    Format(gbuOth
05881  |'                            Case cEur            ||05854  |'                            Case cEur            
05882  |'                                .Cells(39 + i, 24||05855  |'                                .Cells(39 + i, 24
05883  |'                                    sEur & sWord2||05856  |'                                    sEur & sWord2
05884  |'                                    Format(gbuOth||05857  |'                                    Format(gbuOth
05885  |'                            Case cGbp            ||05858  |'                            Case cGbp            
05886  |'                                .Cells(39 + i, 24||05859  |'                                .Cells(39 + i, 24
05887  |'                                    sGbp & sWord2||05860  |'                                    sGbp & sWord2
05888  |'                                    Format(gbuOth||05861  |'                                    Format(gbuOth
05889  |'                            Case cHkd            ||05862  |'                            Case cHkd            
05890  |'                                .Cells(39 + i, 24||05863  |'                                .Cells(39 + i, 24
05891  |'                                    sHkd & sWord2||05864  |'                                    sHkd & sWord2
05892  |'                                    Format(gbuOth||05865  |'                                    Format(gbuOth
05893  |'                            Case cJpy            ||05866  |'                            Case cJpy            
05894  |'                                .Cells(39 + i, 24||05867  |'                                .Cells(39 + i, 24
05895  |'                                    sYen & sWord2||05868  |'                                    sYen & sWord2
05896  |'                                    Format(gbuOth||05869  |'                                    Format(gbuOth
05897  |'                            Case cMyr            ||05870  |'                            Case cMyr            
05898  |'                                .Cells(39 + i, 24||05871  |'                                .Cells(39 + i, 24
05899  |'                                    sMyr & sWord2||05872  |'                                    sMyr & sWord2
05900  |'                                    Format(gbuOth||05873  |'                                    Format(gbuOth
05901  |'                            Case cNzd            ||05874  |'                            Case cNzd            
05902  |'                                .Cells(39 + i, 24||05875  |'                                .Cells(39 + i, 24
05903  |'                                    sNzd & sWord2||05876  |'                                    sNzd & sWord2
05904  |'                                    Format(gbuOth||05877  |'                                    Format(gbuOth
05905  |'                            Case cSek            ||05878  |'                            Case cSek            
05906  |'                                .Cells(39 + i, 24||05879  |'                                .Cells(39 + i, 24
05907  |'                                    sSek & sWord2||05880  |'                                    sSek & sWord2
05908  |'                                    Format(gbuOth||05881  |'                                    Format(gbuOth
05909  |'                            Case cSgd            ||05882  |'                            Case cSgd            
05910  |'                                .Cells(39 + i, 24||05883  |'                                .Cells(39 + i, 24
05911  |'                                    sSgd & sWord2||05884  |'                                    sSgd & sWord2
05912  |'                                    Format(gbuOth||05885  |'                                    Format(gbuOth
05913  |'                            Case cUsd            ||05886  |'                            Case cUsd            
05914  |'                                .Cells(39 + i, 24||05887  |'                                .Cells(39 + i, 24
05915  |'                                    sUsd & sWord2||05888  |'                                    sUsd & sWord2
05916  |'                                    Format(gbuOth||05889  |'                                    Format(gbuOth
05917  |'                            Case cNok            ||05890  |'                            Case cNok            
05918  |'                                .Cells(39 + i, 24||05891  |'                                .Cells(39 + i, 24
05919  |'                                    sNok & sWord2||05892  |'                                    sNok & sWord2
05920  |'                                    Format(gbuOth||05893  |'                                    Format(gbuOth
05921  |'                        End Select               ||05894  |'                        End Select               
05922  |''2005/01/12 End                                  ||05895  |''2005/01/12 End                                  
05923  |'                    End If                       ||05896  |'                    End If                       
05924  |'                Next i                           ||05897  |'                Next i                           
05925  |'            Else                                 ||05898  |'            Else                                 
05926  |'                '料率データが3件以下のときは行間 ||05899  |'                '料率データが3件以下のときは行間 
05927  |'                For i = LBound(gbuOtherComRateGet||05900  |'                For i = LBound(gbuOtherComRateGet
05928  |'                    If i = 0 Then                ||05901  |'                    If i = 0 Then                
05929  |'                        '年率1行目               ||05902  |'                        '年率1行目               
05930  |''2005/01/12 Start                                ||05903  |''2005/01/12 Start                                
05931  |''                        .Cells(39, 13).Value = _||05904  |''                        .Cells(39, 13).Value = _
05932  |''                            sWord26 & CStr(Forma||05905  |''                            sWord26 & CStr(Forma
05933  |''                            sWord27 & Format(gbu||05906  |''                            sWord27 & Format(gbu
05934  |'                        Select Case gbuMGetUPDRec||05907  |'                        Select Case gbuMGetUPDRec
05935  |'                            Case cAud            ||05908  |'                            Case cAud            
05936  |'                                .Cells(39, 13).Va||05909  |'                                .Cells(39, 13).Va
05937  |'                                    sWord26 & CSt||05910  |'                                    sWord26 & CSt
05938  |'                                    sAud & sWord2||05911  |'                                    sAud & sWord2
05939  |'                            Case cCad            ||05912  |'                            Case cCad            
05940  |'                                .Cells(39, 13).Va||05913  |'                                .Cells(39, 13).Va
05941  |'                                    sWord26 & CSt||05914  |'                                    sWord26 & CSt
05942  |'                                    sCad & sWord2||05915  |'                                    sCad & sWord2
05943  |'                            Case cChf            ||05916  |'                            Case cChf            
05944  |'                                .Cells(39, 13).Va||05917  |'                                .Cells(39, 13).Va
05945  |'                                    sWord26 & CSt||05918  |'                                    sWord26 & CSt
05946  |'                                    sChf & sWord2||05919  |'                                    sChf & sWord2
05947  |'                            Case cEur            ||05920  |'                            Case cEur            
05948  |'                                .Cells(39, 13).Va||05921  |'                                .Cells(39, 13).Va
05949  |'                                    sWord26 & CSt||05922  |'                                    sWord26 & CSt
05950  |'                                    sEur & sWord2||05923  |'                                    sEur & sWord2
05951  |'                            Case cGbp            ||05924  |'                            Case cGbp            
05952  |'                                .Cells(39, 13).Va||05925  |'                                .Cells(39, 13).Va
05953  |'                                    sWord26 & CSt||05926  |'                                    sWord26 & CSt
05954  |'                                    sGbp & sWord2||05927  |'                                    sGbp & sWord2
05955  |'                            Case cHkd            ||05928  |'                            Case cHkd            
05956  |'                                .Cells(39, 13).Va||05929  |'                                .Cells(39, 13).Va
05957  |'                                    sWord26 & CSt||05930  |'                                    sWord26 & CSt
05958  |'                                    sHkd & sWord2||05931  |'                                    sHkd & sWord2
05959  |'                            Case cJpy            ||05932  |'                            Case cJpy            
05960  |'                                .Cells(39, 13).Va||05933  |'                                .Cells(39, 13).Va
05961  |'                                    sWord26 & CSt||05934  |'                                    sWord26 & CSt
05962  |'                                    sYen & sWord2||05935  |'                                    sYen & sWord2
05963  |'                            Case cMyr            ||05936  |'                            Case cMyr            
05964  |'                                .Cells(39, 13).Va||05937  |'                                .Cells(39, 13).Va
05965  |'                                    sWord26 & CSt||05938  |'                                    sWord26 & CSt
05966  |'                                    sMyr & sWord2||05939  |'                                    sMyr & sWord2
05967  |'                            Case cNzd            ||05940  |'                            Case cNzd            
05968  |'                                .Cells(39, 13).Va||05941  |'                                .Cells(39, 13).Va
05969  |'                                    sWord26 & CSt||05942  |'                                    sWord26 & CSt
05970  |'                                    sNzd & sWord2||05943  |'                                    sNzd & sWord2
05971  |'                            Case cSek            ||05944  |'                            Case cSek            
05972  |'                                .Cells(39, 13).Va||05945  |'                                .Cells(39, 13).Va
05973  |'                                    sWord26 & CSt||05946  |'                                    sWord26 & CSt
05974  |'                                    sSek & sWord2||05947  |'                                    sSek & sWord2
05975  |'                            Case cSgd            ||05948  |'                            Case cSgd            
05976  |'                                .Cells(39, 13).Va||05949  |'                                .Cells(39, 13).Va
05977  |'                                    sWord26 & CSt||05950  |'                                    sWord26 & CSt
05978  |'                                    sSgd & sWord2||05951  |'                                    sSgd & sWord2
05979  |'                            Case cUsd            ||05952  |'                            Case cUsd            
05980  |'                                .Cells(39, 13).Va||05953  |'                                .Cells(39, 13).Va
05981  |'                                    sWord26 & CSt||05954  |'                                    sWord26 & CSt
05982  |'                                    sUsd & sWord2||05955  |'                                    sUsd & sWord2
05983  |'                            Case cNok            ||05956  |'                            Case cNok            
05984  |'                                .Cells(39, 13).Va||05957  |'                                .Cells(39, 13).Va
05985  |'                                    sWord26 & CSt||05958  |'                                    sWord26 & CSt
05986  |'                                    sNok & sWord2||05959  |'                                    sNok & sWord2
05987  |'                        End Select               ||05960  |'                        End Select               
05988  |''2005/01/12 End                                  ||05961  |''2005/01/12 End                                  
05989  |'                        '年率　累積値セット      ||05962  |'                        '年率　累積値セット      
05990  |'                        TotalRate = CCur(gbuOther||05963  |'                        TotalRate = CCur(gbuOther
05991  |'                    ElseIf i = UBound(gbuOtherCom||05964  |'                    ElseIf i = UBound(gbuOtherCom
05992  |'                        If UBound(gbuOtherComRate||05965  |'                        If UBound(gbuOtherComRate
05993  |'                            '年率最終行          ||05966  |'                            '年率最終行          
05994  |''2005/01/12 Start                                ||05967  |''2005/01/12 Start                                
05995  |'                            '前半金額部分        ||05968  |'                            '前半金額部分        
05996  |'                            .Cells(39 + i + 2, 23||05969  |'                            .Cells(39 + i + 2, 23
05997  |''                            .Cells(39 + i + 2, 2||05970  |''                            .Cells(39 + i + 2, 2
05998  |''2005/01/20 Start                                ||05971  |''2005/01/20 Start                                
05999  |''                            .Cells(39 + i + 2, 2||05972  |''                            .Cells(39 + i + 2, 2
06000  |'                            If gbuMGetUPDRec.N(lR||05973  |'                            If gbuMGetUPDRec.N(lR
06001  |'                                .Cells(39 + i + 2||05974  |'                                .Cells(39 + i + 2
06002  |'                            Else                 ||05975  |'                            Else                 
06003  |'                                .Cells(39 + i + 2||05976  |'                                .Cells(39 + i + 2
06004  |'                            End If               ||05977  |'                            End If               
06005  |''2005/01/20 End                                  ||05978  |''2005/01/20 End                                  
06006  |'                            .Cells(39 + i + 2, 23||05979  |'                            .Cells(39 + i + 2, 23
06007  |''                            '前半金額部分       ||05980  |''                            '前半金額部分       
06008  |''                            .Cells(39 + i + 2, 2||05981  |''                            .Cells(39 + i + 2, 2
06009  |''                            .Cells(39 + i + 2, 2||05982  |''                            .Cells(39 + i + 2, 2
06010  |''                            .Cells(39 + i + 2, 2||05983  |''                            .Cells(39 + i + 2, 2
06011  |''2005/01/12 End                                  ||05984  |''2005/01/12 End                                  
06012  |'    '                        '年率　累積値セット ||05985  |'    '                        '年率　累積値セット 
06013  |'    '                        TotalRate = TotalRat||05986  |'    '                        TotalRate = TotalRat
06014  |'                            '後半の文言          ||05987  |'                            '後半の文言          
06015  |''2005/01/12 Start                                ||05988  |''2005/01/12 Start                                
06016  |''                            .Cells(39 + i + 2, 2||05989  |''                            .Cells(39 + i + 2, 2
06017  |''                                sWord31 & Format||05990  |''                                sWord31 & Format
06018  |'                            Select Case gbuMGetUP||05991  |'                            Select Case gbuMGetUP
06019  |'                                Case cAud        ||05992  |'                                Case cAud        
06020  |'                                    .Cells(39 + i||05993  |'                                    .Cells(39 + i
06021  |'                                        sAud & sW||05994  |'                                        sAud & sW
06022  |'                                Case cCad        ||05995  |'                                Case cCad        
06023  |'                                    .Cells(39 + i||05996  |'                                    .Cells(39 + i
06024  |'                                        sCad & sW||05997  |'                                        sCad & sW
06025  |'                                Case cChf        ||05998  |'                                Case cChf        
06026  |'                                    .Cells(39 + i||05999  |'                                    .Cells(39 + i
06027  |'                                        sChf & sW||06000  |'                                        sChf & sW
06028  |'                                Case cEur        ||06001  |'                                Case cEur        
06029  |'                                    .Cells(39 + i||06002  |'                                    .Cells(39 + i
06030  |'                                        sEur & sW||06003  |'                                        sEur & sW
06031  |'                                Case cGbp        ||06004  |'                                Case cGbp        
06032  |'                                    .Cells(39 + i||06005  |'                                    .Cells(39 + i
06033  |'                                        sGbp & sW||06006  |'                                        sGbp & sW
06034  |'                                Case cHkd        ||06007  |'                                Case cHkd        
06035  |'                                    .Cells(39 + i||06008  |'                                    .Cells(39 + i
06036  |'                                        sHkd & sW||06009  |'                                        sHkd & sW
06037  |'                                Case cJpy        ||06010  |'                                Case cJpy        
06038  |'                                    .Cells(39 + i||06011  |'                                    .Cells(39 + i
06039  |'                                        sYen & sW||06012  |'                                        sYen & sW
06040  |'                                Case cMyr        ||06013  |'                                Case cMyr        
06041  |'                                    .Cells(39 + i||06014  |'                                    .Cells(39 + i
06042  |'                                        sMyr & sW||06015  |'                                        sMyr & sW
06043  |'                                Case cNzd        ||06016  |'                                Case cNzd        
06044  |'                                    .Cells(39 + i||06017  |'                                    .Cells(39 + i
06045  |'                                        sNzd & sW||06018  |'                                        sNzd & sW
06046  |'                                Case cSek        ||06019  |'                                Case cSek        
06047  |'                                    .Cells(39 + i||06020  |'                                    .Cells(39 + i
06048  |'                                        sSek & sW||06021  |'                                        sSek & sW
06049  |'                                Case cSgd        ||06022  |'                                Case cSgd        
06050  |'                                    .Cells(39 + i||06023  |'                                    .Cells(39 + i
06051  |'                                        sSgd & sW||06024  |'                                        sSgd & sW
06052  |'                                Case cUsd        ||06025  |'                                Case cUsd        
06053  |'                                    .Cells(39 + i||06026  |'                                    .Cells(39 + i
06054  |'                                        sUsd & sW||06027  |'                                        sUsd & sW
06055  |'                                Case cNok        ||06028  |'                                Case cNok        
06056  |'                                    .Cells(39 + i||06029  |'                                    .Cells(39 + i
06057  |'                                        sNok & sW||06030  |'                                        sNok & sW
06058  |'                            End Select           ||06031  |'                            End Select           
06059  |''2005/01/12 End                                  ||06032  |''2005/01/12 End                                  
06060  |'                        Else                     ||06033  |'                        Else                     
06061  |'                            '年率最終行          ||06034  |'                            '年率最終行          
06062  |''2005/01/12 Start                                ||06035  |''2005/01/12 Start                                
06063  |'                            '前半金額部分        ||06036  |'                            '前半金額部分        
06064  |'                            .Cells(39 + i + 1, 23||06037  |'                            .Cells(39 + i + 1, 23
06065  |''                            .Cells(39 + i + 1, 2||06038  |''                            .Cells(39 + i + 1, 2
06066  |''2005/01/20 Start                                ||06039  |''2005/01/20 Start                                
06067  |''                            .Cells(39 + i + 1, 2||06040  |''                            .Cells(39 + i + 1, 2
06068  |'                            If gbuMGetUPDRec.N(lR||06041  |'                            If gbuMGetUPDRec.N(lR
06069  |'                                .Cells(39 + i + 1||06042  |'                                .Cells(39 + i + 1
06070  |'                            Else                 ||06043  |'                            Else                 
06071  |'                                .Cells(39 + i + 1||06044  |'                                .Cells(39 + i + 1
06072  |'                            End If               ||06045  |'                            End If               
06073  |''2005/01/20 End                                  ||06046  |''2005/01/20 End                                  
06074  |'                            .Cells(39 + i + 1, 23||06047  |'                            .Cells(39 + i + 1, 23
06075  |''                            '前半金額部分       ||06048  |''                            '前半金額部分       
06076  |''                            .Cells(39 + i + 1, 2||06049  |''                            .Cells(39 + i + 1, 2
06077  |''                            .Cells(39 + i + 1, 2||06050  |''                            .Cells(39 + i + 1, 2
06078  |''                            .Cells(39 + i + 1, 2||06051  |''                            .Cells(39 + i + 1, 2
06079  |''2005/01/12 End                                  ||06052  |''2005/01/12 End                                  
06080  |'    '                        '年率　累積値セット ||06053  |'    '                        '年率　累積値セット 
06081  |'    '                        TotalRate = TotalRat||06054  |'    '                        TotalRate = TotalRat
06082  |'                            '後半の文言          ||06055  |'                            '後半の文言          
06083  |''2005/01/12 Start                                ||06056  |''2005/01/12 Start                                
06084  |''                            .Cells(39 + i + 1, 2||06057  |''                            .Cells(39 + i + 1, 2
06085  |''                                sWord31 & Format||06058  |''                                sWord31 & Format
06086  |'                            Select Case gbuMGetUP||06059  |'                            Select Case gbuMGetUP
06087  |'                                Case cAud        ||06060  |'                                Case cAud        
06088  |'                                    .Cells(39 + i||06061  |'                                    .Cells(39 + i
06089  |'                                        sAud & sW||06062  |'                                        sAud & sW
06090  |'                                Case cCad        ||06063  |'                                Case cCad        
06091  |'                                    .Cells(39 + i||06064  |'                                    .Cells(39 + i
06092  |'                                        sCad & sW||06065  |'                                        sCad & sW
06093  |'                                Case cChf        ||06066  |'                                Case cChf        
06094  |'                                    .Cells(39 + i||06067  |'                                    .Cells(39 + i
06095  |'                                        sChf & sW||06068  |'                                        sChf & sW
06096  |'                                Case cEur        ||06069  |'                                Case cEur        
06097  |'                                    .Cells(39 + i||06070  |'                                    .Cells(39 + i
06098  |'                                        sEur & sW||06071  |'                                        sEur & sW
06099  |'                                Case cGbp        ||06072  |'                                Case cGbp        
06100  |'                                    .Cells(39 + i||06073  |'                                    .Cells(39 + i
06101  |'                                        sGbp & sW||06074  |'                                        sGbp & sW
06102  |'                                Case cHkd        ||06075  |'                                Case cHkd        
06103  |'                                    .Cells(39 + i||06076  |'                                    .Cells(39 + i
06104  |'                                        sHkd & sW||06077  |'                                        sHkd & sW
06105  |'                                Case cJpy        ||06078  |'                                Case cJpy        
06106  |'                                    .Cells(39 + i||06079  |'                                    .Cells(39 + i
06107  |'                                        sYen & sW||06080  |'                                        sYen & sW
06108  |'                                Case cMyr        ||06081  |'                                Case cMyr        
06109  |'                                    .Cells(39 + i||06082  |'                                    .Cells(39 + i
06110  |'                                        sMyr & sW||06083  |'                                        sMyr & sW
06111  |'                                Case cNzd        ||06084  |'                                Case cNzd        
06112  |'                                    .Cells(39 + i||06085  |'                                    .Cells(39 + i
06113  |'                                        sNzd & sW||06086  |'                                        sNzd & sW
06114  |'                                Case cSek        ||06087  |'                                Case cSek        
06115  |'                                    .Cells(39 + i||06088  |'                                    .Cells(39 + i
06116  |'                                        sSek & sW||06089  |'                                        sSek & sW
06117  |'                                Case cSgd        ||06090  |'                                Case cSgd        
06118  |'                                    .Cells(39 + i||06091  |'                                    .Cells(39 + i
06119  |'                                        sSgd & sW||06092  |'                                        sSgd & sW
06120  |'                                Case cUsd        ||06093  |'                                Case cUsd        
06121  |'                                    .Cells(39 + i||06094  |'                                    .Cells(39 + i
06122  |'                                        sUsd & sW||06095  |'                                        sUsd & sW
06123  |'                                Case cNok        ||06096  |'                                Case cNok        
06124  |'                                    .Cells(39 + i||06097  |'                                    .Cells(39 + i
06125  |'                                        sNok & sW||06098  |'                                        sNok & sW
06126  |'                            End Select           ||06099  |'                            End Select           
06127  |''2005/01/12 End                                  ||06100  |''2005/01/12 End                                  
06128  |'                        End If                   ||06101  |'                        End If                   
06129  |'                    Else                         ||06102  |'                    Else                         
06130  |'                        '年率2行目以降           ||06103  |'                        '年率2行目以降           
06131  |''2005/01/12 Start                                ||06104  |''2005/01/12 Start                                
06132  |'                        '前半金額部分            ||06105  |'                        '前半金額部分            
06133  |'                        .Cells(39 + i + 1, 23).Nu||06106  |'                        .Cells(39 + i + 1, 23).Nu
06134  |''                        .Cells(39 + i + 1, 23).V||06107  |''                        .Cells(39 + i + 1, 23).V
06135  |''2005/01/20 Start                                ||06108  |''2005/01/20 Start                                
06136  |''                        .Cells(39 + i + 1, 23).V||06109  |''                        .Cells(39 + i + 1, 23).V
06137  |'                        If gbuMGetUPDRec.N(lRecId||06110  |'                        If gbuMGetUPDRec.N(lRecId
06138  |'                            .Cells(39 + i + 1, 23||06111  |'                            .Cells(39 + i + 1, 23
06139  |'                        Else                     ||06112  |'                        Else                     
06140  |'                            .Cells(39 + i + 1, 23||06113  |'                            .Cells(39 + i + 1, 23
06141  |'                        End If                   ||06114  |'                        End If                   
06142  |''2005/01/20 End                                  ||06115  |''2005/01/20 End                                  
06143  |'                        .Cells(39 + i + 1, 23).Ho||06116  |'                        .Cells(39 + i + 1, 23).Ho
06144  |''                        '前半金額部分           ||06117  |''                        '前半金額部分           
06145  |''                        .Cells(39 + i + 1, 21).N||06118  |''                        .Cells(39 + i + 1, 21).N
06146  |''                        .Cells(39 + i + 1, 21).V||06119  |''                        .Cells(39 + i + 1, 21).V
06147  |''                        .Cells(39 + i + 1, 21).H||06120  |''                        .Cells(39 + i + 1, 21).H
06148  |''2005/01/12 End                                  ||06121  |''2005/01/12 End                                  
06149  |'                        '年率　累積値セット      ||06122  |'                        '年率　累積値セット      
06150  |'                        TotalRate = TotalRate + C||06123  |'                        TotalRate = TotalRate + C
06151  |'                        '後半の文言              ||06124  |'                        '後半の文言              
06152  |''2005/01/12 Start                                ||06125  |''2005/01/12 Start                                
06153  |''                        .Cells(39 + i + 1, 24).V||06126  |''                        .Cells(39 + i + 1, 24).V
06154  |''                            sWord29 & CStr(Forma||06127  |''                            sWord29 & CStr(Forma
06155  |''                            Format(gbuOtherComRa||06128  |''                            Format(gbuOtherComRa
06156  |'                        Select Case gbuMGetUPDRec||06129  |'                        Select Case gbuMGetUPDRec
06157  |'                            Case cAud            ||06130  |'                            Case cAud            
06158  |'                                .Cells(39 + i + 1||06131  |'                                .Cells(39 + i + 1
06159  |'                                    sAud & sWord2||06132  |'                                    sAud & sWord2
06160  |'                                    Format(gbuOth||06133  |'                                    Format(gbuOth
06161  |'                            Case cCad            ||06134  |'                            Case cCad            
06162  |'                                .Cells(39 + i + 1||06135  |'                                .Cells(39 + i + 1
06163  |'                                    sCad & sWord2||06136  |'                                    sCad & sWord2
06164  |'                                    Format(gbuOth||06137  |'                                    Format(gbuOth
06165  |'                            Case cChf            ||06138  |'                            Case cChf            
06166  |'                                .Cells(39 + i + 1||06139  |'                                .Cells(39 + i + 1
06167  |'                                    sChf & sWord2||06140  |'                                    sChf & sWord2
06168  |'                                    Format(gbuOth||06141  |'                                    Format(gbuOth
06169  |'                            Case cEur            ||06142  |'                            Case cEur            
06170  |'                                .Cells(39 + i + 1||06143  |'                                .Cells(39 + i + 1
06171  |'                                    sEur & sWord2||06144  |'                                    sEur & sWord2
06172  |'                                    Format(gbuOth||06145  |'                                    Format(gbuOth
06173  |'                            Case cGbp            ||06146  |'                            Case cGbp            
06174  |'                                .Cells(39 + i + 1||06147  |'                                .Cells(39 + i + 1
06175  |'                                    sGbp & sWord2||06148  |'                                    sGbp & sWord2
06176  |'                                    Format(gbuOth||06149  |'                                    Format(gbuOth
06177  |'                            Case cHkd            ||06150  |'                            Case cHkd            
06178  |'                                .Cells(39 + i + 1||06151  |'                                .Cells(39 + i + 1
06179  |'                                    sHkd & sWord2||06152  |'                                    sHkd & sWord2
06180  |'                                    Format(gbuOth||06153  |'                                    Format(gbuOth
06181  |'                            Case cJpy            ||06154  |'                            Case cJpy            
06182  |'                                .Cells(39 + i + 1||06155  |'                                .Cells(39 + i + 1
06183  |'                                    sYen & sWord2||06156  |'                                    sYen & sWord2
06184  |'                                    Format(gbuOth||06157  |'                                    Format(gbuOth
06185  |'                            Case cMyr            ||06158  |'                            Case cMyr            
06186  |'                                .Cells(39 + i + 1||06159  |'                                .Cells(39 + i + 1
06187  |'                                    sMyr & sWord2||06160  |'                                    sMyr & sWord2
06188  |'                                    Format(gbuOth||06161  |'                                    Format(gbuOth
06189  |'                            Case cNzd            ||06162  |'                            Case cNzd            
06190  |'                                .Cells(39 + i + 1||06163  |'                                .Cells(39 + i + 1
06191  |'                                    sNzd & sWord2||06164  |'                                    sNzd & sWord2
06192  |'                                    Format(gbuOth||06165  |'                                    Format(gbuOth
06193  |'                            Case cSek            ||06166  |'                            Case cSek            
06194  |'                                .Cells(39 + i + 1||06167  |'                                .Cells(39 + i + 1
06195  |'                                    sSek & sWord2||06168  |'                                    sSek & sWord2
06196  |'                                    Format(gbuOth||06169  |'                                    Format(gbuOth
06197  |'                            Case cSgd            ||06170  |'                            Case cSgd            
06198  |'                                .Cells(39 + i + 1||06171  |'                                .Cells(39 + i + 1
06199  |'                                    sSgd & sWord2||06172  |'                                    sSgd & sWord2
06200  |'                                    Format(gbuOth||06173  |'                                    Format(gbuOth
06201  |'                            Case cUsd            ||06174  |'                            Case cUsd            
06202  |'                                .Cells(39 + i + 1||06175  |'                                .Cells(39 + i + 1
06203  |'                                    sUsd & sWord2||06176  |'                                    sUsd & sWord2
06204  |'                                    Format(gbuOth||06177  |'                                    Format(gbuOth
06205  |'                            Case cNok            ||06178  |'                            Case cNok            
06206  |'                                .Cells(39 + i + 1||06179  |'                                .Cells(39 + i + 1
06207  |'                                    sNok & sWord2||06180  |'                                    sNok & sWord2
06208  |'                                    Format(gbuOth||06181  |'                                    Format(gbuOth
06209  |'                        End Select               ||06182  |'                        End Select               
06210  |''2005/01/12 End                                  ||06183  |''2005/01/12 End                                  
06211  |'                    End If                       ||06184  |'                    End If                       
06212  |'                Next i                           ||06185  |'                Next i                           
06213  |'            End If                               ||06186  |'            End If                               
06214  |'        End If                                   ||06187  |'        End If                                   
06215  |'                                                 ||06188  |'                                                 
06216  |'        '投資顧問料                              ||06189  |'        '投資顧問料                              
06217  |''2004/09/10 Start                                ||06190  |''2004/09/10 Start                                
06218  |''        .Cells(46, 2).Value = sWord11           ||06191  |''        .Cells(46, 2).Value = sWord11           
06219  |''        .Cells(46, 10).Value = sWord19          ||06192  |''        .Cells(46, 10).Value = sWord19          
06220  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).||06193  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).
06221  |'            Case Mid(mstrContractFlag(1), 1, 1)  ||06194  |'            Case Mid(mstrContractFlag(1), 1, 1)  
06222  |'                .Cells(46, 2).Value = sWord11a   ||06195  |'                .Cells(46, 2).Value = sWord11a   
06223  |'            Case Mid(mstrContractFlag(2), 1, 1)  ||06196  |'            Case Mid(mstrContractFlag(2), 1, 1)  
06224  |'                .Cells(46, 2).Value = sWord11b   ||06197  |'                .Cells(46, 2).Value = sWord11b   
06225  |'            Case Mid(mstrContractFlag(3), 1, 1)  ||06198  |'            Case Mid(mstrContractFlag(3), 1, 1)  
06226  |'                .Cells(46, 2).Value = sWord11c   ||06199  |'                .Cells(46, 2).Value = sWord11c   
06227  |'            Case Else                            ||06200  |'            Case Else                            
06228  |'                MsgBox "契約区分が不正です。", vb||06201  |'                MsgBox "契約区分が不正です。", vb
06229  |'        End Select                               ||06202  |'        End Select                               
06230  |'        .Cells(46, 11).Value = sWord19           ||06203  |'        .Cells(46, 11).Value = sWord19           
06231  |''2004/09/10 End                                  ||06204  |''2004/09/10 End                                  
06232  |'                                                 ||06205  |'                                                 
06233  |''2005/01/12 Start                                ||06206  |''2005/01/12 Start                                
06234  |'        '外部委託顧問料                          ||06207  |'        '外部委託顧問料                          
06235  |''        .Cells(46, 30).NumberFormatLocal = "@"  ||06208  |''        .Cells(46, 30).NumberFormatLocal = "@"  
06236  |''2005/01/20 Start                                ||06209  |''2005/01/20 Start                                
06237  |''        .Cells(46, 31).NumberFormatLocal = "@"  ||06210  |''        .Cells(46, 31).NumberFormatLocal = "@"  
06238  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||06211  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
06239  |'            .Cells(46, 31).NumberFormatLocal = "@||06212  |'            .Cells(46, 31).NumberFormatLocal = "@
06240  |'        Else                                     ||06213  |'        Else                                     
06241  |'            .Cells(46, 29).NumberFormatLocal = "@||06214  |'            .Cells(46, 29).NumberFormatLocal = "@
06242  |'        End If                                   ||06215  |'        End If                                   
06243  |''2005/01/20 End                                  ||06216  |''2005/01/20 End                                  
06244  |'        '契約区分が名称使用許諾料の場合上限・下限||06217  |'        '契約区分が名称使用許諾料の場合上限・下限
06245  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||06218  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
06246  |'            '下限金額より換算した金額が小さい場合||06219  |'            '下限金額より換算した金額が小さい場合
06247  |'            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_||06220  |'            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_
06248  |'                If mstrMonthlyPayCom < CDbl(gbuMG||06221  |'                If mstrMonthlyPayCom < CDbl(gbuMG
06249  |'                    mstrMonthlyPayCom = CDbl(gbuM||06222  |'                    mstrMonthlyPayCom = CDbl(gbuM
06250  |'                End If                           ||06223  |'                End If                           
06251  |'            End If                               ||06224  |'            End If                               
06252  |'            '上限金額より換算した金額が大きい場合||06225  |'            '上限金額より換算した金額が大きい場合
06253  |'            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_||06226  |'            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_
06254  |'                If mstrMonthlyPayCom > CDbl(gbuMG||06227  |'                If mstrMonthlyPayCom > CDbl(gbuMG
06255  |'                    mstrMonthlyPayCom = CDbl(gbuM||06228  |'                    mstrMonthlyPayCom = CDbl(gbuM
06256  |'                End If                           ||06229  |'                End If                           
06257  |'            End If                               ||06230  |'            End If                               
06258  |''2005/01/20 Start                                ||06231  |''2005/01/20 Start                                
06259  |'            dblValueIn = CDbl(mstrMonthlyPayCom) ||06232  |'            dblValueIn = CDbl(mstrMonthlyPayCom) 
06260  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou||06233  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou
06261  |'                Call sbGetRoundValue2(dblValueIn)||06234  |'                Call sbGetRoundValue2(dblValueIn)
06262  |'            Else                                 ||06235  |'            Else                                 
06263  |'                Call sbGetRoundValue(dblValueIn) ||06236  |'                Call sbGetRoundValue(dblValueIn) 
06264  |'            End If                               ||06237  |'            End If                               
06265  |'            mstrMonthlyPayCom = dblValueOut      ||06238  |'            mstrMonthlyPayCom = dblValueOut      
06266  |''2005/01/20 End                                  ||06239  |''2005/01/20 End                                  
06267  |'        End If                                   ||06240  |'        End If                                   
06268  |'                                                 ||06241  |'                                                 
06269  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET||06242  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET
06270  |'            Case cAud                            ||06243  |'            Case cAud                            
06271  |'                .Cells(46, 31).Value = CStr(Forma||06244  |'                .Cells(46, 31).Value = CStr(Forma
06272  |'                .Cells(46, 32).Value = sAud      ||06245  |'                .Cells(46, 32).Value = sAud      
06273  |'            Case cCad                            ||06246  |'            Case cCad                            
06274  |'                .Cells(46, 31).Value = CStr(Forma||06247  |'                .Cells(46, 31).Value = CStr(Forma
06275  |'                .Cells(46, 32).Value = sCad      ||06248  |'                .Cells(46, 32).Value = sCad      
06276  |'            Case cChf                            ||06249  |'            Case cChf                            
06277  |'                .Cells(46, 31).Value = CStr(Forma||06250  |'                .Cells(46, 31).Value = CStr(Forma
06278  |'                .Cells(46, 32).Value = sChf      ||06251  |'                .Cells(46, 32).Value = sChf      
06279  |'            Case cEur                            ||06252  |'            Case cEur                            
06280  |'                .Cells(46, 31).Value = CStr(Forma||06253  |'                .Cells(46, 31).Value = CStr(Forma
06281  |'                .Cells(46, 32).Value = sEur      ||06254  |'                .Cells(46, 32).Value = sEur      
06282  |'            Case cGbp                            ||06255  |'            Case cGbp                            
06283  |'                .Cells(46, 31).Value = CStr(Forma||06256  |'                .Cells(46, 31).Value = CStr(Forma
06284  |'                .Cells(46, 32).Value = sGbp      ||06257  |'                .Cells(46, 32).Value = sGbp      
06285  |'            Case cHkd                            ||06258  |'            Case cHkd                            
06286  |'                .Cells(46, 31).Value = CStr(Forma||06259  |'                .Cells(46, 31).Value = CStr(Forma
06287  |'                .Cells(46, 32).Value = sHkd      ||06260  |'                .Cells(46, 32).Value = sHkd      
06288  |'            Case cJpy                            ||06261  |'            Case cJpy                            
06289  |'                .Cells(46, 29).Value = CStr(Forma||06262  |'                .Cells(46, 29).Value = CStr(Forma
06290  |'                .Cells(46, 32).Value = sYen      ||06263  |'                .Cells(46, 32).Value = sYen      
06291  |'            Case cMyr                            ||06264  |'            Case cMyr                            
06292  |'                .Cells(46, 31).Value = CStr(Forma||06265  |'                .Cells(46, 31).Value = CStr(Forma
06293  |'                .Cells(46, 32).Value = sMyr      ||06266  |'                .Cells(46, 32).Value = sMyr      
06294  |'            Case cNzd                            ||06267  |'            Case cNzd                            
06295  |'                .Cells(46, 31).Value = CStr(Forma||06268  |'                .Cells(46, 31).Value = CStr(Forma
06296  |'                .Cells(46, 32).Value = sNzd      ||06269  |'                .Cells(46, 32).Value = sNzd      
06297  |'            Case cSek                            ||06270  |'            Case cSek                            
06298  |'                .Cells(46, 31).Value = CStr(Forma||06271  |'                .Cells(46, 31).Value = CStr(Forma
06299  |'                .Cells(46, 32).Value = sSek      ||06272  |'                .Cells(46, 32).Value = sSek      
06300  |'            Case cSgd                            ||06273  |'            Case cSgd                            
06301  |'                .Cells(46, 31).Value = CStr(Forma||06274  |'                .Cells(46, 31).Value = CStr(Forma
06302  |'                .Cells(46, 32).Value = sSgd      ||06275  |'                .Cells(46, 32).Value = sSgd      
06303  |'            Case cUsd                            ||06276  |'            Case cUsd                            
06304  |'                .Cells(46, 31).Value = CStr(Forma||06277  |'                .Cells(46, 31).Value = CStr(Forma
06305  |'                .Cells(46, 32).Value = sUsd      ||06278  |'                .Cells(46, 32).Value = sUsd      
06306  |'            Case cNok                            ||06279  |'            Case cNok                            
06307  |'                .Cells(46, 31).Value = CStr(Forma||06280  |'                .Cells(46, 31).Value = CStr(Forma
06308  |'                .Cells(46, 32).Value = sNok      ||06281  |'                .Cells(46, 32).Value = sNok      
06309  |'        End Select                               ||06282  |'        End Select                               
06310  |'                                                 ||06283  |'                                                 
06311  |'        '顧問料                                  ||06284  |'        '顧問料                                  
06312  |''        .Cells(46, 30).HorizontalAlignment = xlR||06285  |''        .Cells(46, 30).HorizontalAlignment = xlR
06313  |''2005/01/20 Start                                ||06286  |''2005/01/20 Start                                
06314  |''        .Cells(46, 31).HorizontalAlignment = xlR||06287  |''        .Cells(46, 31).HorizontalAlignment = xlR
06315  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||06288  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
06316  |'            .Cells(46, 31).HorizontalAlignment = ||06289  |'            .Cells(46, 31).HorizontalAlignment = 
06317  |'        Else                                     ||06290  |'        Else                                     
06318  |'            .Cells(46, 29).HorizontalAlignment = ||06291  |'            .Cells(46, 29).HorizontalAlignment = 
06319  |'        End If                                   ||06292  |'        End If                                   
06320  |''2005/01/20 End                                  ||06293  |''2005/01/20 End                                  
06321  |'                                                 ||06294  |'                                                 
06322  |'        '契約区分が名称使用許諾料の場合上限・下限||06295  |'        '契約区分が名称使用許諾料の場合上限・下限
06323  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||06296  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
06324  |'            '上限金額                            ||06297  |'            '上限金額                            
06325  |'            .Cells(46, 39).Value = sWordCap      ||06298  |'            .Cells(46, 39).Value = sWordCap      
06326  |'            .Cells(46, 57).NumberFormatLocal = "@||06299  |'            .Cells(46, 57).NumberFormatLocal = "@
06327  |''2005/01/20 Start                                ||06300  |''2005/01/20 Start                                
06328  |''            .Cells(46, 57).Value = Format(gbuMGe||06301  |''            .Cells(46, 57).Value = Format(gbuMGe
06329  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou||06302  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou
06330  |'                .Cells(46, 57).Value = Format(gbu||06303  |'                .Cells(46, 57).Value = Format(gbu
06331  |'            Else                                 ||06304  |'            Else                                 
06332  |'                .Cells(46, 57).Value = Format(gbu||06305  |'                .Cells(46, 57).Value = Format(gbu
06333  |'            End If                               ||06306  |'            End If                               
06334  |''2005/01/20 End                                  ||06307  |''2005/01/20 End                                  
06335  |'            .Cells(46, 57).HorizontalAlignment = ||06308  |'            .Cells(46, 57).HorizontalAlignment = 
06336  |'            '下限金額                            ||06309  |'            '下限金額                            
06337  |'            .Cells(47, 39).Value = sWordFloor    ||06310  |'            .Cells(47, 39).Value = sWordFloor    
06338  |'            .Cells(47, 57).NumberFormatLocal = "@||06311  |'            .Cells(47, 57).NumberFormatLocal = "@
06339  |''2005/01/20 Start                                ||06312  |''2005/01/20 Start                                
06340  |''            .Cells(47, 57).Value = Format(gbuMGe||06313  |''            .Cells(47, 57).Value = Format(gbuMGe
06341  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou||06314  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou
06342  |'                .Cells(47, 57).Value = Format(gbu||06315  |'                .Cells(47, 57).Value = Format(gbu
06343  |'            Else                                 ||06316  |'            Else                                 
06344  |'                .Cells(47, 57).Value = Format(gbu||06317  |'                .Cells(47, 57).Value = Format(gbu
06345  |'            End If                               ||06318  |'            End If                               
06346  |''2005/01/20 End                                  ||06319  |''2005/01/20 End                                  
06347  |'            .Cells(47, 57).HorizontalAlignment = ||06320  |'            .Cells(47, 57).HorizontalAlignment = 
06348  |'        End If                                   ||06321  |'        End If                                   
06349  |'                                                 ||06322  |'                                                 
06350  |''2005/01/12 End                                  ||06323  |''2005/01/12 End                                  
06351  |'                                                 ||06324  |'                                                 
06352  |''2005/01/17 Start                                ||06325  |''2005/01/17 Start                                
06353  |'        ddblExchangeRate = 0                     ||06326  |'        ddblExchangeRate = 0                     
06354  |''2005/01/17 End                                  ||06327  |''2005/01/17 End                                  
06355  |''2005/01/12 Start                                ||06328  |''2005/01/12 Start                                
06356  |'        '@@@@@ 支払に換算 @@@@@                  ||06329  |'        '@@@@@ 支払に換算 @@@@@                  
06357  |''''''        dblValueIn = ddblShiharai           ||06330  |''''''        dblValueIn = ddblShiharai           
06358  |'        dblValueIn = mstrMonthlyPayCom           ||06331  |'        dblValueIn = mstrMonthlyPayCom           
06359  |'                                                 ||06332  |'                                                 
06360  |'        '2006/04/12 START K.Furuya 実払管理テーブ||06333  |'        '2006/04/12 START K.Furuya 実払管理テーブ
06361  |'        '通貨円以外の場合確定顧問料通貨を取得    ||06334  |'        '通貨円以外の場合確定顧問料通貨を取得    
06362  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||06335  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
06363  |'            WkFixComC = ""                       ||06336  |'            WkFixComC = ""                       
06364  |'            WkRealComC = ""                      ||06337  |'            WkRealComC = ""                      
06365  |'            WkFixComC = mstrMonthlyPayCom        ||06338  |'            WkFixComC = mstrMonthlyPayCom        
06366  |'            WkRealComC = mstrMonthlyPayCom       ||06339  |'            WkRealComC = mstrMonthlyPayCom       
06367  |'        End If                                   ||06340  |'        End If                                   
06368  |'        '通貨を取得                              ||06341  |'        '通貨を取得                              
06369  |'        WkCurCode = ""                           ||06342  |'        WkCurCode = ""                           
06370  |'        WkCurCode = Trim(gbuMGetUPDRec.N(lRecIdx)||06343  |'        WkCurCode = Trim(gbuMGetUPDRec.N(lRecIdx)
06371  |'        '2006/04/12 END   K.Furuya 実払管理テーブ||06344  |'        '2006/04/12 END   K.Furuya 実払管理テーブ
06372  |'                                                 ||06345  |'                                                 
06373  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET||06346  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET
06374  |'          Case "1"    '固定料率                  ||06347  |'          Case "1"    '固定料率                  
06375  |''2005/01/26 Start                                ||06348  |''2005/01/26 Start                                
06376  |''''''              'NAV通貨と外部委託顧問料通貨が||06349  |''''''              'NAV通貨と外部委託顧問料通貨が
06377  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG||06350  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG
06378  |''''''                  '外部委託顧問料通貨が円以 ||06351  |''''''                  '外部委託顧問料通貨が円以 
06379  |''''''                  If gbuMGetUPDRec.N(lRecIdx||06352  |''''''                  If gbuMGetUPDRec.N(lRecIdx
06380  |''''''                    '外部委託顧問料通貨から ||06353  |''''''                    '外部委託顧問料通貨から 
06381  |'''''''2005/01/17 Start                           ||06354  |'''''''2005/01/17 Start                           
06382  |'''''''                    dblValueIn = dblValueIn||06355  |'''''''                    dblValueIn = dblValueIn
06383  |''''''                    '外部委託顧問料通貨→JPY||06356  |''''''                    '外部委託顧問料通貨→JPY
06384  |''''''                    dstrCurrencyCode = gbuMG||06357  |''''''                    dstrCurrencyCode = gbuMG
06385  |''''''                    ddblExchangeRate = fnstr||06358  |''''''                    ddblExchangeRate = fnstr
06386  |''''''                    If ddblExchangeRate = 0 ||06359  |''''''                    If ddblExchangeRate = 0 
06387  |''''''                      intRtn = MsgBox("ＴＴ ||06360  |''''''                      intRtn = MsgBox("ＴＴ 
06388  |''''''                      vbLf & "対象通貨コード||06361  |''''''                      vbLf & "対象通貨コード
06389  |''''''                      vbLf & "基準日 ： [ " ||06362  |''''''                      vbLf & "基準日 ： [ " 
06390  |''''''                          vbCritical, "ＴＴ ||06363  |''''''                          vbCritical, "ＴＴ 
06391  |''''''                      Exit Function         ||06364  |''''''                      Exit Function         
06392  |''''''                    End If                  ||06365  |''''''                    End If                  
06393  |''''''                    '外部委託顧問料通貨→JPY||06366  |''''''                    '外部委託顧問料通貨→JPY
06394  |''''''                    dblValueIn = dblValueIn ||06367  |''''''                    dblValueIn = dblValueIn 
06395  |'''''''2005/01/17 End                             ||06368  |'''''''2005/01/17 End                             
06396  |''''''                  End If                    ||06369  |''''''                  End If                    
06397  |''''''              End If                        ||06370  |''''''              End If                        
06398  |''''''              'NAV通貨と外部委託顧問料通貨が||06371  |''''''              'NAV通貨と外部委託顧問料通貨が
06399  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG||06372  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG
06400  |''''''                  '外部委託顧問料通貨が円   ||06373  |''''''                  '外部委託顧問料通貨が円   
06401  |''''''                  If gbuMGetUPDRec.N(lRecIdx||06374  |''''''                  If gbuMGetUPDRec.N(lRecIdx
06402  |''''''                  End If                    ||06375  |''''''                  End If                    
06403  |''''''              End If                        ||06376  |''''''              End If                        
06404  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||06377  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
06405  |'                Else                             ||06378  |'                Else                             
06406  |'                  '外部委託顧問料通貨→JPYの為替 ||06379  |'                  '外部委託顧問料通貨→JPYの為替 
06407  |'                  dstrCurrencyCode = gbuMGetUPDRe||06380  |'                  dstrCurrencyCode = gbuMGetUPDRe
06408  |'                  ddblExchangeRate = fnstrExchang||06381  |'                  ddblExchangeRate = fnstrExchang
06409  |'                  If ddblExchangeRate = 0 Then   ||06382  |'                  If ddblExchangeRate = 0 Then   
06410  |'                    intRtn = MsgBox("ＴＴＭが取得||06383  |'                    intRtn = MsgBox("ＴＴＭが取得
06411  |'                    vbLf & "対象通貨コード ： [ "||06384  |'                    vbLf & "対象通貨コード ： [ "
06412  |'                    vbLf & "基準日 ： [ " & Mid(d||06385  |'                    vbLf & "基準日 ： [ " & Mid(d
06413  |'                        vbCritical, "ＴＴＭ取得エ||06386  |'                        vbCritical, "ＴＴＭ取得エ
06414  |'                    Exit Function                ||06387  |'                    Exit Function                
06415  |'                  End If                         ||06388  |'                  End If                         
06416  |'                  'JPY→支払通貨へレート換算     ||06389  |'                  'JPY→支払通貨へレート換算     
06417  |'                  dblValueIn = dblValueIn * ddblE||06390  |'                  dblValueIn = dblValueIn * ddblE
06418  |'                End If                           ||06391  |'                End If                           
06419  |''2005/01/26 End                                  ||06392  |''2005/01/26 End                                  
06420  |'          Case "2"    '段階料率                  ||06393  |'          Case "2"    '段階料率                  
06421  |''2005/01/26 Start                                ||06394  |''2005/01/26 Start                                
06422  |''''''              'NAV通貨と閾値通貨が相違      ||06395  |''''''              'NAV通貨と閾値通貨が相違      
06423  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG||06396  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG
06424  |''''''                  '閾値通貨と外部委託顧問料 ||06397  |''''''                  '閾値通貨と外部委託顧問料 
06425  |''''''                  If gbuMGetUPDRec.N(lRecIdx||06398  |''''''                  If gbuMGetUPDRec.N(lRecIdx
06426  |''''''                      '外部委託顧問料通貨が ||06399  |''''''                      '外部委託顧問料通貨が 
06427  |''''''                      If gbuMGetUPDRec.N(lRe||06400  |''''''                      If gbuMGetUPDRec.N(lRe
06428  |''''''                        '外部委託顧問料通貨 ||06401  |''''''                        '外部委託顧問料通貨 
06429  |'''''''2005/01/17 Start                           ||06402  |'''''''2005/01/17 Start                           
06430  |'''''''                        dblValueIn = dblVal||06403  |'''''''                        dblValueIn = dblVal
06431  |''''''                        '外部委託顧問料通貨 ||06404  |''''''                        '外部委託顧問料通貨 
06432  |''''''                        dstrCurrencyCode = g||06405  |''''''                        dstrCurrencyCode = g
06433  |''''''                        ddblExchangeRate = f||06406  |''''''                        ddblExchangeRate = f
06434  |''''''                        If ddblExchangeRate ||06407  |''''''                        If ddblExchangeRate 
06435  |''''''                          intRtn = MsgBox(" ||06408  |''''''                          intRtn = MsgBox(" 
06436  |''''''                          vbLf & "対象通貨コ||06409  |''''''                          vbLf & "対象通貨コ
06437  |''''''                          vbLf & "基準日 ： ||06410  |''''''                          vbLf & "基準日 ： 
06438  |''''''                              vbCritical, " ||06411  |''''''                              vbCritical, " 
06439  |''''''                          Exit Function     ||06412  |''''''                          Exit Function     
06440  |''''''                        End If              ||06413  |''''''                        End If              
06441  |''''''                        '外部委託顧問料通貨 ||06414  |''''''                        '外部委託顧問料通貨 
06442  |''''''                        dblValueIn = dblValu||06415  |''''''                        dblValueIn = dblValu
06443  |'''''''2005/01/17 End                             ||06416  |'''''''2005/01/17 End                             
06444  |''''''                      End If                ||06417  |''''''                      End If                
06445  |''''''                  End If                    ||06418  |''''''                  End If                    
06446  |''''''              End If                        ||06419  |''''''              End If                        
06447  |''''''              'NAV通貨と閾値通貨が相違      ||06420  |''''''              'NAV通貨と閾値通貨が相違      
06448  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG||06421  |''''''              If gbuMGetUPDRec.N(lRecIdx).MG
06449  |''''''                  '閾値通貨と外部委託顧問料 ||06422  |''''''                  '閾値通貨と外部委託顧問料 
06450  |''''''                  If gbuMGetUPDRec.N(lRecIdx||06423  |''''''                  If gbuMGetUPDRec.N(lRecIdx
06451  |''''''                      '外部委託顧問料通貨が ||06424  |''''''                      '外部委託顧問料通貨が 
06452  |''''''                      If gbuMGetUPDRec.N(lRe||06425  |''''''                      If gbuMGetUPDRec.N(lRe
06453  |''''''                      End If                ||06426  |''''''                      End If                
06454  |''''''                  End If                    ||06427  |''''''                  End If                    
06455  |''''''              End If                        ||06428  |''''''              End If                        
06456  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe||06429  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe
06457  |'            Else                                 ||06430  |'            Else                                 
06458  |'                '外部委託顧問料通貨→JPYの為替レ ||06431  |'                '外部委託顧問料通貨→JPYの為替レ 
06459  |'                dstrCurrencyCode = gbuMGetUPDRec.||06432  |'                dstrCurrencyCode = gbuMGetUPDRec.
06460  |'                ddblExchangeRate = fnstrExchangeR||06433  |'                ddblExchangeRate = fnstrExchangeR
06461  |'                If ddblExchangeRate = 0 Then     ||06434  |'                If ddblExchangeRate = 0 Then     
06462  |'                  intRtn = MsgBox("ＴＴＭが取得で||06435  |'                  intRtn = MsgBox("ＴＴＭが取得で
06463  |'                  vbLf & "対象通貨コード ： [ " &||06436  |'                  vbLf & "対象通貨コード ： [ " &
06464  |'                  vbLf & "基準日 ： [ " & Mid(dst||06437  |'                  vbLf & "基準日 ： [ " & Mid(dst
06465  |'                      vbCritical, "ＴＴＭ取得エラ||06438  |'                      vbCritical, "ＴＴＭ取得エラ
06466  |'                  Exit Function                  ||06439  |'                  Exit Function                  
06467  |'                End If                           ||06440  |'                End If                           
06468  |'                '外部委託顧問料通貨→JPYへレート ||06441  |'                '外部委託顧問料通貨→JPYへレート 
06469  |'                dblValueIn = dblValueIn * ddblExc||06442  |'                dblValueIn = dblValueIn * ddblExc
06470  |'            End If                               ||06443  |'            End If                               
06471  |''2005/01/26 End                                  ||06444  |''2005/01/26 End                                  
06472  |'        End Select                               ||06445  |'        End Select                               
06473  |'        '@@@@@ 支払に換算 @@@@@                  ||06446  |'        '@@@@@ 支払に換算 @@@@@                  
06474  |'        Call sbGetRoundValue(dblValueIn)         ||06447  |'        Call sbGetRoundValue(dblValueIn)         
06475  |'        mstrMonthlyPayCom = dblValueOut          ||06448  |'        mstrMonthlyPayCom = dblValueOut          
06476  |'                                                 ||06449  |'                                                 
06477  |'        '2006/04/12 START K.Furuya 実払管理テーブ||06450  |'        '2006/04/12 START K.Furuya 実払管理テーブ
06478  |'        '確定額と実払額を取得                    ||06451  |'        '確定額と実払額を取得                    
06479  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||06452  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
06480  |'            WkFixComC = ""                       ||06453  |'            WkFixComC = ""                       
06481  |'            WkFixComJ = ""                       ||06454  |'            WkFixComJ = ""                       
06482  |'            WkRealComC = ""                      ||06455  |'            WkRealComC = ""                      
06483  |'            WkRealComJ = ""                      ||06456  |'            WkRealComJ = ""                      
06484  |'            WkFixComC = mstrMonthlyPayCom        ||06457  |'            WkFixComC = mstrMonthlyPayCom        
06485  |'            WkFixComJ = mstrMonthlyPayCom        ||06458  |'            WkFixComJ = mstrMonthlyPayCom        
06486  |'            WkRealComC = mstrMonthlyPayCom       ||06459  |'            WkRealComC = mstrMonthlyPayCom       
06487  |'            WkRealComJ = mstrMonthlyPayCom       ||06460  |'            WkRealComJ = mstrMonthlyPayCom       
06488  |'        Else                                     ||06461  |'        Else                                     
06489  |'            WkFixComJ = ""                       ||06462  |'            WkFixComJ = ""                       
06490  |'            WkRealComJ = ""                      ||06463  |'            WkRealComJ = ""                      
06491  |'            WkFixComJ = mstrMonthlyPayCom        ||06464  |'            WkFixComJ = mstrMonthlyPayCom        
06492  |'            WkRealComJ = mstrMonthlyPayCom       ||06465  |'            WkRealComJ = mstrMonthlyPayCom       
06493  |'        End If                                   ||06466  |'        End If                                   
06494  |'        '2006/04/12 END   K.Furuya 実払管理テーブ||06467  |'        '2006/04/12 END   K.Furuya 実払管理テーブ
06495  |'                                                 ||06468  |'                                                 
06496  |''2005/01/12 End                                  ||06469  |''2005/01/12 End                                  
06497  |'                                                 ||06470  |'                                                 
06498  |''2005/01/17 Start                                ||06471  |''2005/01/17 Start                                
06499  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe||06472  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe
06500  |'                'TTMレート                       ||06473  |'                'TTMレート                       
06501  |'                .Cells(47, 19).Value = sWord43   ||06474  |'                .Cells(47, 19).Value = sWord43   
06502  |'                .Cells(47, 33).NumberFormatLocal ||06475  |'                .Cells(47, 33).NumberFormatLocal 
06503  |'                .Cells(47, 33).Value = Format(ddb||06476  |'                .Cells(47, 33).Value = Format(ddb
06504  |'                .Cells(47, 33).HorizontalAlignmen||06477  |'                .Cells(47, 33).HorizontalAlignmen
06505  |'                .Cells(47, 34).Value = sWord44   ||06478  |'                .Cells(47, 34).Value = sWord44   
06506  |'            End If                               ||06479  |'            End If                               
06507  |''2005/01/17 End                                  ||06480  |''2005/01/17 End                                  
06508  |''2005/01/12 Start                                ||06481  |''2005/01/12 Start                                
06509  |''        '税抜金額(月別支払顧問料の累計)         ||06482  |''        '税抜金額(月別支払顧問料の累計)         
06510  |''        .Cells(46, 27).NumberFormatLocal = "@"  ||06483  |''        .Cells(46, 27).NumberFormatLocal = "@"  
06511  |''        .Cells(46, 27).Value = CStr(Format(mstrM||06484  |''        .Cells(46, 27).Value = CStr(Format(mstrM
06512  |''        .Cells(46, 27).HorizontalAlignment = xlR||06485  |''        .Cells(46, 27).HorizontalAlignment = xlR
06513  |''2005/01/13 Start                                ||06486  |''2005/01/13 Start                                
06514  |'            '支払額                              ||06487  |'            '支払額                              
06515  |'            .Cells(48, 2).Value = sWord46        ||06488  |'            .Cells(48, 2).Value = sWord46        
06516  |'            .Cells(48, 11).Value = sWord19       ||06489  |'            .Cells(48, 11).Value = sWord19       
06517  |''2005/01/13 End                                  ||06490  |''2005/01/13 End                                  
06518  |'            '税抜金額(月別支払顧問料の累計)      ||06491  |'            '税抜金額(月別支払顧問料の累計)      
06519  |'            .Cells(48, 29).NumberFormatLocal = "@||06492  |'            .Cells(48, 29).NumberFormatLocal = "@
06520  |'            .Cells(48, 29).Value = CStr(Format(ms||06493  |'            .Cells(48, 29).Value = CStr(Format(ms
06521  |'            .Cells(48, 29).HorizontalAlignment = ||06494  |'            .Cells(48, 29).HorizontalAlignment = 
06522  |'            .Cells(48, 32).Value = sYen          ||06495  |'            .Cells(48, 32).Value = sYen          
06523  |''2005/01/12 End                                  ||06496  |''2005/01/12 End                                  
06524  |'                                                 ||06497  |'                                                 
06525  |''2005/03/09 Start                                ||06498  |''2005/03/09 Start                                
06526  |''        '消費税率テキストボックス入力の場合のみ ||06499  |''        '消費税率テキストボックス入力の場合のみ 
06527  |''        If txtInputTax.Text <> "" Then          ||06500  |''        If txtInputTax.Text <> "" Then          
06528  |''            '(消費税XX%)                        ||06501  |''            '(消費税XX%)                        
06529  |''            iSyouhizei = CInt(Trim(txtInputTax.T||06502  |''            iSyouhizei = CInt(Trim(txtInputTax.T
06530  |'''2005/01/12 Start                               ||06503  |'''2005/01/12 Start                               
06531  |'''            .Cells(47, 29).Value = sWord22 & iS||06504  |'''            .Cells(47, 29).Value = sWord22 & iS
06532  |''            .Cells(49, 32).Value = sWord22 & iSy||06505  |''            .Cells(49, 32).Value = sWord22 & iSy
06533  |'''2005/01/12 End                                 ||06506  |'''2005/01/12 End                                 
06534  |'''2004/11/17 Start                               ||06507  |'''2004/11/17 Start                               
06535  |'''            lTaxNum = Round(mstrMonthlyPayCom *||06508  |'''            lTaxNum = Round(mstrMonthlyPayCom *
06536  |''            dblValueIn = mstrMonthlyPayCom * iSy||06509  |''            dblValueIn = mstrMonthlyPayCom * iSy
06537  |''            Call sbGetRoundValueTax(dblValueIn) ||06510  |''            Call sbGetRoundValueTax(dblValueIn) 
06538  |''            lTaxNum = dblValueOut               ||06511  |''            lTaxNum = dblValueOut               
06539  |'''2004/11/17 End                                 ||06512  |'''2004/11/17 End                                 
06540  |'''2005/01/12 Start                               ||06513  |'''2005/01/12 Start                               
06541  |'''            .Cells(47, 27).NumberFormatLocal = ||06514  |'''            .Cells(47, 27).NumberFormatLocal = 
06542  |'''            .Cells(47, 27).Value = CStr(Format(||06515  |'''            .Cells(47, 27).Value = CStr(Format(
06543  |'''            .Cells(47, 27).HorizontalAlignment ||06516  |'''            .Cells(47, 27).HorizontalAlignment 
06544  |'''            '合計(消費税＋月別支払顧問料の累計)||06517  |'''            '合計(消費税＋月別支払顧問料の累計)
06545  |'''            .Cells(48, 14).Value = sWord24     ||06518  |'''            .Cells(48, 14).Value = sWord24     
06546  |''            .Cells(49, 29).NumberFormatLocal = "||06519  |''            .Cells(49, 29).NumberFormatLocal = "
06547  |''            .Cells(49, 29).Value = CStr(Format((||06520  |''            .Cells(49, 29).Value = CStr(Format((
06548  |''            .Cells(49, 29).HorizontalAlignment =||06521  |''            .Cells(49, 29).HorizontalAlignment =
06549  |''            '合計(消費税＋月別支払顧問料の累計) ||06522  |''            '合計(消費税＋月別支払顧問料の累計) 
06550  |''            .Cells(50, 13).Value = sWord24      ||06523  |''            .Cells(50, 13).Value = sWord24      
06551  |'''2005/01/12 End                                 ||06524  |'''2005/01/12 End                                 
06552  |'''2004/11/17 Start                               ||06525  |'''2004/11/17 Start                               
06553  |'''            lMonthlyPayCom = Round(lTaxNum + CC||06526  |'''            lMonthlyPayCom = Round(lTaxNum + CC
06554  |''            dblValueIn = lTaxNum + CCur(mstrMont||06527  |''            dblValueIn = lTaxNum + CCur(mstrMont
06555  |''            Call sbGetRoundValue(dblValueIn)    ||06528  |''            Call sbGetRoundValue(dblValueIn)    
06556  |''            lMonthlyPayCom = dblValueOut        ||06529  |''            lMonthlyPayCom = dblValueOut        
06557  |'''2004/11/17 End                                 ||06530  |'''2004/11/17 End                                 
06558  |'''2005/01/12 Start                               ||06531  |'''2005/01/12 Start                               
06559  |'''            .Cells(48, 27).NumberFormatLocal = ||06532  |'''            .Cells(48, 27).NumberFormatLocal = 
06560  |'''            .Cells(48, 27).Value = CStr(Format(||06533  |'''            .Cells(48, 27).Value = CStr(Format(
06561  |'''            .Cells(48, 27).HorizontalAlignment ||06534  |'''            .Cells(48, 27).HorizontalAlignment 
06562  |'''            '円                                ||06535  |'''            '円                                
06563  |'''            .Cells(48, 29).Value = sYen        ||06536  |'''            .Cells(48, 29).Value = sYen        
06564  |'''            '下線                              ||06537  |'''            '下線                              
06565  |'''            With xlSheet.Range("M47:AL47").Bord||06538  |'''            With xlSheet.Range("M47:AL47").Bord
06566  |'''                .LineStyle = xlContinuous      ||06539  |'''                .LineStyle = xlContinuous      
06567  |'''                .Weight = xlThin               ||06540  |'''                .Weight = xlThin               
06568  |'''            End With                           ||06541  |'''            End With                           
06569  |'''        Else                                   ||06542  |'''        Else                                   
06570  |'''            '月別支払顧問料の累計＋円          ||06543  |'''            '月別支払顧問料の累計＋円          
06571  |'''            .Cells(46, 27).Value = ""          ||06544  |'''            .Cells(46, 27).Value = ""          
06572  |'''            .Cells(46, 13).Value = CStr(Format(||06545  |'''            .Cells(46, 13).Value = CStr(Format(
06573  |''            .Cells(50, 29).NumberFormatLocal = "||06546  |''            .Cells(50, 29).NumberFormatLocal = "
06574  |''            .Cells(50, 29).Value = CStr(Format(l||06547  |''            .Cells(50, 29).Value = CStr(Format(l
06575  |''            .Cells(50, 29).HorizontalAlignment =||06548  |''            .Cells(50, 29).HorizontalAlignment =
06576  |''            '円                                 ||06549  |''            '円                                 
06577  |''            .Cells(50, 32).Value = sYen         ||06550  |''            .Cells(50, 32).Value = sYen         
06578  |''            '下線                               ||06551  |''            '下線                               
06579  |''            With xlSheet.Range("M49:AL49").Borde||06552  |''            With xlSheet.Range("M49:AL49").Borde
06580  |''                .LineStyle = xlContinuous       ||06553  |''                .LineStyle = xlContinuous       
06581  |''                .Weight = xlThin                ||06554  |''                .Weight = xlThin                
06582  |''            End With                            ||06555  |''            End With                            
06583  |''        Else                                    ||06556  |''        Else                                    
06584  |'''            '月別支払顧問料の累計＋円          ||06557  |'''            '月別支払顧問料の累計＋円          
06585  |'''            .Cells(48, 28).Value = ""          ||06558  |'''            .Cells(48, 28).Value = ""          
06586  |'''            .Cells(48, 28).Value = CStr(Format(||06559  |'''            .Cells(48, 28).Value = CStr(Format(
06587  |'''2005/01/12 End                                 ||06560  |'''2005/01/12 End                                 
06588  |'''            '下線                              ||06561  |'''            '下線                              
06589  |'''            With xlSheet.Range("M46:AN46").Bord||06562  |'''            With xlSheet.Range("M46:AN46").Bord
06590  |'''                .LineStyle = xlContinuous      ||06563  |'''                .LineStyle = xlContinuous      
06591  |'''                .Weight = xlThin               ||06564  |'''                .Weight = xlThin               
06592  |'''            End With                           ||06565  |'''            End With                           
06593  |''        End If                                  ||06566  |''        End If                                  
06594  |'        '消費税計算有無：「有り」の場合のみ、消費||06567  |'        '消費税計算有無：「有り」の場合のみ、消費
06595  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc||06568  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc
06596  |'            '(消費税XX%)                         ||06569  |'            '(消費税XX%)                         
06597  |'            iSyouhizei = ddblconsumption_tax     ||06570  |'            iSyouhizei = ddblconsumption_tax     
06598  |'            .Cells(49, 32).Value = sWord22 & iSyo||06571  |'            .Cells(49, 32).Value = sWord22 & iSyo
06599  |'            dblValueIn = mstrMonthlyPayCom * iSyo||06572  |'            dblValueIn = mstrMonthlyPayCom * iSyo
06600  |'            Call sbGetRoundValueTax(dblValueIn)  ||06573  |'            Call sbGetRoundValueTax(dblValueIn)  
06601  |'            lTaxNum = dblValueOut                ||06574  |'            lTaxNum = dblValueOut                
06602  |'            .Cells(49, 29).NumberFormatLocal = "@||06575  |'            .Cells(49, 29).NumberFormatLocal = "@
06603  |'            .Cells(49, 29).Value = CStr(Format((l||06576  |'            .Cells(49, 29).Value = CStr(Format((l
06604  |'            .Cells(49, 29).HorizontalAlignment = ||06577  |'            .Cells(49, 29).HorizontalAlignment = 
06605  |'            '合計(消費税＋月別支払顧問料の累計)  ||06578  |'            '合計(消費税＋月別支払顧問料の累計)  
06606  |'            .Cells(50, 13).Value = sWord24       ||06579  |'            .Cells(50, 13).Value = sWord24       
06607  |'            dblValueIn = lTaxNum + CCur(mstrMonth||06580  |'            dblValueIn = lTaxNum + CCur(mstrMonth
06608  |'            Call sbGetRoundValue(dblValueIn)     ||06581  |'            Call sbGetRoundValue(dblValueIn)     
06609  |'            lMonthlyPayCom = dblValueOut         ||06582  |'            lMonthlyPayCom = dblValueOut         
06610  |'            .Cells(50, 29).NumberFormatLocal = "@||06583  |'            .Cells(50, 29).NumberFormatLocal = "@
06611  |'            .Cells(50, 29).Value = CStr(Format(lM||06584  |'            .Cells(50, 29).Value = CStr(Format(lM
06612  |'            .Cells(50, 29).HorizontalAlignment = ||06585  |'            .Cells(50, 29).HorizontalAlignment = 
06613  |'            '円                                  ||06586  |'            '円                                  
06614  |'            .Cells(50, 32).Value = sYen          ||06587  |'            .Cells(50, 32).Value = sYen          
06615  |'            '下線                                ||06588  |'            '下線                                
06616  |'            With xlSheet.Range("M49:AL49").Border||06589  |'            With xlSheet.Range("M49:AL49").Border
06617  |'                .LineStyle = xlContinuous        ||06590  |'                .LineStyle = xlContinuous        
06618  |'                .Weight = xlThin                 ||06591  |'                .Weight = xlThin                 
06619  |'            End With                             ||06592  |'            End With                             
06620  |'        Else                                     ||06593  |'        Else                                     
06621  |'        End If                                   ||06594  |'        End If                                   
06622  |''2005/03/09 End                                  ||06595  |''2005/03/09 End                                  
06623  |'                                                 ||06596  |'                                                 
06624  |''2005/01/12 Start                                ||06597  |''2005/01/12 Start                                
06625  |''        '支払先                                 ||06598  |''        '支払先                                 
06626  |''        .Cells(50, 2).Value = sWord12           ||06599  |''        .Cells(50, 2).Value = sWord12           
06627  |'''2004/09/10 Start                               ||06600  |'''2004/09/10 Start                               
06628  |'''        .Cells(50, 10).Value = sWord19         ||06601  |'''        .Cells(50, 10).Value = sWord19         
06629  |''        .Cells(50, 11).Value = sWord19          ||06602  |''        .Cells(50, 11).Value = sWord19          
06630  |'''2004/09/10 End                                 ||06603  |'''2004/09/10 End                                 
06631  |''        .Cells(50, 13).Value = gbuMGetUPDRec.N(l||06604  |''        .Cells(50, 13).Value = gbuMGetUPDRec.N(l
06632  |''        '支払予定日                             ||06605  |''        '支払予定日                             
06633  |''        .Cells(53, 2).Value = sWord13           ||06606  |''        .Cells(53, 2).Value = sWord13           
06634  |'''2004/09/10 Start                               ||06607  |'''2004/09/10 Start                               
06635  |'''        .Cells(53, 10).Value = sWord19         ||06608  |'''        .Cells(53, 10).Value = sWord19         
06636  |''        .Cells(53, 11).Value = sWord19          ||06609  |''        .Cells(53, 11).Value = sWord19          
06637  |'''2004/09/10 End                                 ||06610  |'''2004/09/10 End                                 
06638  |''        '支払予定日                             ||06611  |''        '支払予定日                             
06639  |''        sDate = Trim(mstrPaymentDate)           ||06612  |''        sDate = Trim(mstrPaymentDate)           
06640  |''        .Cells(53, 13).Value = _                ||06613  |''        .Cells(53, 13).Value = _                
06641  |''            Format(sDate, "YYYY") & WordYear & _||06614  |''            Format(sDate, "YYYY") & WordYear & _
06642  |''            Format(sDate, "M") & WordMonth & _  ||06615  |''            Format(sDate, "M") & WordMonth & _  
06643  |''            Format(sDate, "D") & WordDay        ||06616  |''            Format(sDate, "D") & WordDay        
06644  |'        '支払先                                  ||06617  |'        '支払先                                  
06645  |'        .Cells(52, 2).Value = sWord12            ||06618  |'        .Cells(52, 2).Value = sWord12            
06646  |''2004/09/10 Start                                ||06619  |''2004/09/10 Start                                
06647  |''        .Cells(50, 10).Value = sWord19          ||06620  |''        .Cells(50, 10).Value = sWord19          
06648  |'        .Cells(52, 11).Value = sWord19           ||06621  |'        .Cells(52, 11).Value = sWord19           
06649  |''2004/09/10 End                                  ||06622  |''2004/09/10 End                                  
06650  |'        .Cells(52, 13).Value = gbuMGetUPDRec.N(lR||06623  |'        .Cells(52, 13).Value = gbuMGetUPDRec.N(lR
06651  |'        '支払予定日                              ||06624  |'        '支払予定日                              
06652  |'        .Cells(54, 2).Value = sWord13            ||06625  |'        .Cells(54, 2).Value = sWord13            
06653  |''2004/09/10 Start                                ||06626  |''2004/09/10 Start                                
06654  |''        .Cells(53, 10).Value = sWord19          ||06627  |''        .Cells(53, 10).Value = sWord19          
06655  |'        .Cells(54, 11).Value = sWord19           ||06628  |'        .Cells(54, 11).Value = sWord19           
06656  |''2004/09/10 End                                  ||06629  |''2004/09/10 End                                  
06657  |'        '支払予定日                              ||06630  |'        '支払予定日                              
06658  |'        sDate = Trim(mstrPaymentDate)            ||06631  |'        sDate = Trim(mstrPaymentDate)            
06659  |'        .Cells(54, 13).Value = _                 ||06632  |'        .Cells(54, 13).Value = _                 
06660  |'            Format(sDate, "YYYY") & WordYear & _ ||06633  |'            Format(sDate, "YYYY") & WordYear & _ 
06661  |'            Format(sDate, "M") & WordMonth & _   ||06634  |'            Format(sDate, "M") & WordMonth & _   
06662  |'            Format(sDate, "D") & WordDay         ||06635  |'            Format(sDate, "D") & WordDay         
06663  |''2005/01/12 End                                  ||06636  |''2005/01/12 End                                  
06664  |'      '部署名                                    ||06637  |'      '部署名                                    
06665  |'        'コンボ左の数字取得                      ||06638  |'        'コンボ左の数字取得                      
06666  |'        ColNum = Trim(gstrComboCodeGet(cboBumonFl||06639  |'        ColNum = Trim(gstrComboCodeGet(cboBumonFl
06667  |'        'コンボ「：」以下の文字列                ||06640  |'        'コンボ「：」以下の文字列                
06668  |'        ColWord = Trim(gstrComboDataGet(cboBumonF||06641  |'        ColWord = Trim(gstrComboDataGet(cboBumonF
06669  |''2005/01/12 Start                                ||06642  |''2005/01/12 Start                                
06670  |''        .Cells(56, 2).Value = ColWord           ||06643  |''        .Cells(56, 2).Value = ColWord           
06671  |''        .Range("B56:S56").HorizontalAlignment = ||06644  |''        .Range("B56:S56").HorizontalAlignment = 
06672  |''        '担当者印                               ||06645  |''        '担当者印                               
06673  |''        .Cells(57, 2).Value = sWord15           ||06646  |''        .Cells(57, 2).Value = sWord15           
06674  |''        .Range("B57:J57").HorizontalAlignment = ||06647  |''        .Range("B57:J57").HorizontalAlignment = 
06675  |''        '検印                                   ||06648  |''        '検印                                   
06676  |''        .Cells(57, 11).Value = sWord16          ||06649  |''        .Cells(57, 11).Value = sWord16          
06677  |''        .Range("K57:S57").HorizontalAlignment = ||06650  |''        .Range("K57:S57").HorizontalAlignment = 
06678  |''        '財務部                                 ||06651  |''        '財務部                                 
06679  |''        .Cells(56, 26).Value = sWord35          ||06652  |''        .Cells(56, 26).Value = sWord35          
06680  |''        .Range("Z56:AQ56").HorizontalAlignment =||06653  |''        .Range("Z56:AQ56").HorizontalAlignment =
06681  |''        '精査印                                 ||06654  |''        '精査印                                 
06682  |''        .Cells(57, 26).Value = sWord17          ||06655  |''        .Cells(57, 26).Value = sWord17          
06683  |''        .Range("Z57:AH57").HorizontalAlignment =||06656  |''        .Range("Z57:AH57").HorizontalAlignment =
06684  |''        '検印                                   ||06657  |''        '検印                                   
06685  |''        .Cells(57, 35).Value = sWord16          ||06658  |''        .Cells(57, 35).Value = sWord16          
06686  |''        .Range("AI57:AQ57").HorizontalAlignment ||06659  |''        .Range("AI57:AQ57").HorizontalAlignment 
06687  |'        .Cells(56, 2).Value = ColWord            ||06660  |'        .Cells(56, 2).Value = ColWord            
06688  |'        .Range("B56:S56").HorizontalAlignment = x||06661  |'        .Range("B56:S56").HorizontalAlignment = x
06689  |'        '担当者印                                ||06662  |'        '担当者印                                
06690  |'        .Cells(57, 2).Value = sWord15            ||06663  |'        .Cells(57, 2).Value = sWord15            
06691  |'        .Range("B57:J57").HorizontalAlignment = x||06664  |'        .Range("B57:J57").HorizontalAlignment = x
06692  |'        '検印                                    ||06665  |'        '検印                                    
06693  |'        .Cells(57, 11).Value = sWord16           ||06666  |'        .Cells(57, 11).Value = sWord16           
06694  |'        .Range("K57:S57").HorizontalAlignment = x||06667  |'        .Range("K57:S57").HorizontalAlignment = x
06695  |'        '財務部                                  ||06668  |'        '財務部                                  
06696  |'        .Cells(56, 24).Value = sWord35           ||06669  |'        .Cells(56, 24).Value = sWord35           
06697  |'        .Range("X56:AO56").HorizontalAlignment = ||06670  |'        .Range("X56:AO56").HorizontalAlignment = 
06698  |'        '精査印                                  ||06671  |'        '精査印                                  
06699  |'        .Cells(57, 24).Value = sWord17           ||06672  |'        .Cells(57, 24).Value = sWord17           
06700  |'        .Range("X57:AF57").HorizontalAlignment = ||06673  |'        .Range("X57:AF57").HorizontalAlignment = 
06701  |'        '検印                                    ||06674  |'        '検印                                    
06702  |'        .Cells(57, 33).Value = sWord16           ||06675  |'        .Cells(57, 33).Value = sWord16           
06703  |'        .Range("AG57:AO57").HorizontalAlignment =||06676  |'        .Range("AG57:AO57").HorizontalAlignment =
06704  |''2005/01/12 End                                  ||06677  |''2005/01/12 End                                  
06705  |'                                                 ||06678  |'                                                 
06706  |'    End With                                     ||06679  |'    End With                                     
06707  |'                                                 ||06680  |'                                                 
06708  |''2005/01/12 Start                                ||06681  |''2005/01/12 Start                                
06709  |''    '月末純資産(外枠)                           ||06682  |''    '月末純資産(外枠)                           
06710  |''    With xlSheet.Range("N19:AM33").Borders(xlEdg||06683  |''    With xlSheet.Range("N19:AM33").Borders(xlEdg
06711  |''        .LineStyle = xlContinuous               ||06684  |''        .LineStyle = xlContinuous               
06712  |''        .Weight = xlThin                        ||06685  |''        .Weight = xlThin                        
06713  |''    End With                                    ||06686  |''    End With                                    
06714  |''    With xlSheet.Range("N19:AM33").Borders(xlEdg||06687  |''    With xlSheet.Range("N19:AM33").Borders(xlEdg
06715  |''        .LineStyle = xlContinuous               ||06688  |''        .LineStyle = xlContinuous               
06716  |''        .Weight = xlThin                        ||06689  |''        .Weight = xlThin                        
06717  |''    End With                                    ||06690  |''    End With                                    
06718  |''    With xlSheet.Range("N19:AM33").Borders(xlEdg||06691  |''    With xlSheet.Range("N19:AM33").Borders(xlEdg
06719  |''        .LineStyle = xlContinuous               ||06692  |''        .LineStyle = xlContinuous               
06720  |''        .Weight = xlThin                        ||06693  |''        .Weight = xlThin                        
06721  |''    End With                                    ||06694  |''    End With                                    
06722  |''    With xlSheet.Range("N19:AM33").Borders(xlEdg||06695  |''    With xlSheet.Range("N19:AM33").Borders(xlEdg
06723  |''        .LineStyle = xlContinuous               ||06696  |''        .LineStyle = xlContinuous               
06724  |''        .Weight = xlThin                        ||06697  |''        .Weight = xlThin                        
06725  |''    End With                                    ||06698  |''    End With                                    
06726  |''    With xlSheet.Range("N19:AM33").Borders(xlIns||06699  |''    With xlSheet.Range("N19:AM33").Borders(xlIns
06727  |''        .LineStyle = xlContinuous               ||06700  |''        .LineStyle = xlContinuous               
06728  |''        .Weight = xlThin                        ||06701  |''        .Weight = xlThin                        
06729  |''    End With                                    ||06702  |''    End With                                    
06730  |''    '月末純資産(真中縦線)                       ||06703  |''    '月末純資産(真中縦線)                       
06731  |''    With xlSheet.Range("Y19:Y33").Borders(xlEdge||06704  |''    With xlSheet.Range("Y19:Y33").Borders(xlEdge
06732  |''        .LineStyle = xlContinuous               ||06705  |''        .LineStyle = xlContinuous               
06733  |''        .Weight = xlThin                        ||06706  |''        .Weight = xlThin                        
06734  |''    End With                                    ||06707  |''    End With                                    
06735  |''    '月末純資産(左側捺印欄　外枠)               ||06708  |''    '月末純資産(左側捺印欄　外枠)               
06736  |''    With xlSheet.Range("B56:S63").Borders(xlEdge||06709  |''    With xlSheet.Range("B56:S63").Borders(xlEdge
06737  |''        .LineStyle = xlContinuous               ||06710  |''        .LineStyle = xlContinuous               
06738  |''        .Weight = xlThin                        ||06711  |''        .Weight = xlThin                        
06739  |''    End With                                    ||06712  |''    End With                                    
06740  |''    With xlSheet.Range("B56:S63").Borders(xlEdge||06713  |''    With xlSheet.Range("B56:S63").Borders(xlEdge
06741  |''        .LineStyle = xlContinuous               ||06714  |''        .LineStyle = xlContinuous               
06742  |''        .Weight = xlThin                        ||06715  |''        .Weight = xlThin                        
06743  |''    End With                                    ||06716  |''    End With                                    
06744  |''    With xlSheet.Range("B56:S63").Borders(xlEdge||06717  |''    With xlSheet.Range("B56:S63").Borders(xlEdge
06745  |''        .LineStyle = xlContinuous               ||06718  |''        .LineStyle = xlContinuous               
06746  |''        .Weight = xlThin                        ||06719  |''        .Weight = xlThin                        
06747  |''    End With                                    ||06720  |''    End With                                    
06748  |''    With xlSheet.Range("B56:S63").Borders(xlEdge||06721  |''    With xlSheet.Range("B56:S63").Borders(xlEdge
06749  |''        .LineStyle = xlContinuous               ||06722  |''        .LineStyle = xlContinuous               
06750  |''        .Weight = xlThin                        ||06723  |''        .Weight = xlThin                        
06751  |''    End With                                    ||06724  |''    End With                                    
06752  |''    '月末純資産(左側捺印欄　上枠)               ||06725  |''    '月末純資産(左側捺印欄　上枠)               
06753  |''    With xlSheet.Range("B56:S57").Borders(xlEdge||06726  |''    With xlSheet.Range("B56:S57").Borders(xlEdge
06754  |''        .LineStyle = xlContinuous               ||06727  |''        .LineStyle = xlContinuous               
06755  |''        .Weight = xlThin                        ||06728  |''        .Weight = xlThin                        
06756  |''    End With                                    ||06729  |''    End With                                    
06757  |''    With xlSheet.Range("B56:S57").Borders(xlInsi||06730  |''    With xlSheet.Range("B56:S57").Borders(xlInsi
06758  |''        .LineStyle = xlContinuous               ||06731  |''        .LineStyle = xlContinuous               
06759  |''        .Weight = xlThin                        ||06732  |''        .Weight = xlThin                        
06760  |''    End With                                    ||06733  |''    End With                                    
06761  |''    '月末純資産(左側捺印欄　縦線)               ||06734  |''    '月末純資産(左側捺印欄　縦線)               
06762  |''    With xlSheet.Range("J57:J63").Borders(xlEdge||06735  |''    With xlSheet.Range("J57:J63").Borders(xlEdge
06763  |''        .LineStyle = xlContinuous               ||06736  |''        .LineStyle = xlContinuous               
06764  |''        .Weight = xlThin                        ||06737  |''        .Weight = xlThin                        
06765  |''    End With                                    ||06738  |''    End With                                    
06766  |''    '月末純資産(右側捺印欄　外枠)               ||06739  |''    '月末純資産(右側捺印欄　外枠)               
06767  |''    With xlSheet.Range("Z56:AQ63").Borders(xlEdg||06740  |''    With xlSheet.Range("Z56:AQ63").Borders(xlEdg
06768  |''        .LineStyle = xlContinuous               ||06741  |''        .LineStyle = xlContinuous               
06769  |''        .Weight = xlThin                        ||06742  |''        .Weight = xlThin                        
06770  |''    End With                                    ||06743  |''    End With                                    
06771  |''    With xlSheet.Range("Z56:AQ63").Borders(xlEdg||06744  |''    With xlSheet.Range("Z56:AQ63").Borders(xlEdg
06772  |''        .LineStyle = xlContinuous               ||06745  |''        .LineStyle = xlContinuous               
06773  |''        .Weight = xlThin                        ||06746  |''        .Weight = xlThin                        
06774  |''    End With                                    ||06747  |''    End With                                    
06775  |''    With xlSheet.Range("Z56:AQ63").Borders(xlEdg||06748  |''    With xlSheet.Range("Z56:AQ63").Borders(xlEdg
06776  |''        .LineStyle = xlContinuous               ||06749  |''        .LineStyle = xlContinuous               
06777  |''        .Weight = xlThin                        ||06750  |''        .Weight = xlThin                        
06778  |''    End With                                    ||06751  |''    End With                                    
06779  |''    With xlSheet.Range("Z56:AQ63").Borders(xlEdg||06752  |''    With xlSheet.Range("Z56:AQ63").Borders(xlEdg
06780  |''        .LineStyle = xlContinuous               ||06753  |''        .LineStyle = xlContinuous               
06781  |''        .Weight = xlThin                        ||06754  |''        .Weight = xlThin                        
06782  |''    End With                                    ||06755  |''    End With                                    
06783  |''    '月末純資産(右側捺印欄　上枠)               ||06756  |''    '月末純資産(右側捺印欄　上枠)               
06784  |''    With xlSheet.Range("Z56:AQ57").Borders(xlEdg||06757  |''    With xlSheet.Range("Z56:AQ57").Borders(xlEdg
06785  |''        .LineStyle = xlContinuous               ||06758  |''        .LineStyle = xlContinuous               
06786  |''        .Weight = xlThin                        ||06759  |''        .Weight = xlThin                        
06787  |''    End With                                    ||06760  |''    End With                                    
06788  |''    With xlSheet.Range("Z56:AQ57").Borders(xlEdg||06761  |''    With xlSheet.Range("Z56:AQ57").Borders(xlEdg
06789  |''        .LineStyle = xlContinuous               ||06762  |''        .LineStyle = xlContinuous               
06790  |''        .Weight = xlThin                        ||06763  |''        .Weight = xlThin                        
06791  |''    End With                                    ||06764  |''    End With                                    
06792  |''    With xlSheet.Range("Z56:AQ57").Borders(xlIns||06765  |''    With xlSheet.Range("Z56:AQ57").Borders(xlIns
06793  |''        .LineStyle = xlContinuous               ||06766  |''        .LineStyle = xlContinuous               
06794  |''        .Weight = xlThin                        ||06767  |''        .Weight = xlThin                        
06795  |''    End With                                    ||06768  |''    End With                                    
06796  |''    '月末純資産(右側捺印欄　縦線)               ||06769  |''    '月末純資産(右側捺印欄　縦線)               
06797  |''    With xlSheet.Range("AH57:AH63").Borders(xlEd||06770  |''    With xlSheet.Range("AH57:AH63").Borders(xlEd
06798  |''        .LineStyle = xlContinuous               ||06771  |''        .LineStyle = xlContinuous               
06799  |''        .Weight = xlThin                        ||06772  |''        .Weight = xlThin                        
06800  |''    End With                                    ||06773  |''    End With                                    
06801  |'    '月末純資産(外枠)                            ||06774  |'    '月末純資産(外枠)                            
06802  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge||06775  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge
06803  |'        .LineStyle = xlContinuous                ||06776  |'        .LineStyle = xlContinuous                
06804  |'        .Weight = xlThin                         ||06777  |'        .Weight = xlThin                         
06805  |'    End With                                     ||06778  |'    End With                                     
06806  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge||06779  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge
06807  |'        .LineStyle = xlContinuous                ||06780  |'        .LineStyle = xlContinuous                
06808  |'        .Weight = xlThin                         ||06781  |'        .Weight = xlThin                         
06809  |'    End With                                     ||06782  |'    End With                                     
06810  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge||06783  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge
06811  |'        .LineStyle = xlContinuous                ||06784  |'        .LineStyle = xlContinuous                
06812  |'        .Weight = xlThin                         ||06785  |'        .Weight = xlThin                         
06813  |'    End With                                     ||06786  |'    End With                                     
06814  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge||06787  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge
06815  |'        .LineStyle = xlContinuous                ||06788  |'        .LineStyle = xlContinuous                
06816  |'        .Weight = xlThin                         ||06789  |'        .Weight = xlThin                         
06817  |'    End With                                     ||06790  |'    End With                                     
06818  |'    With xlSheet.Range("N19:AN33").Borders(xlInsi||06791  |'    With xlSheet.Range("N19:AN33").Borders(xlInsi
06819  |'        .LineStyle = xlContinuous                ||06792  |'        .LineStyle = xlContinuous                
06820  |'        .Weight = xlThin                         ||06793  |'        .Weight = xlThin                         
06821  |'    End With                                     ||06794  |'    End With                                     
06822  |'    '月末純資産(真中縦線)                        ||06795  |'    '月末純資産(真中縦線)                        
06823  |'    With xlSheet.Range("Y19:Y33").Borders(xlEdgeR||06796  |'    With xlSheet.Range("Y19:Y33").Borders(xlEdgeR
06824  |'        .LineStyle = xlContinuous                ||06797  |'        .LineStyle = xlContinuous                
06825  |'        .Weight = xlThin                         ||06798  |'        .Weight = xlThin                         
06826  |'    End With                                     ||06799  |'    End With                                     
06827  |'    '月末純資産(左側捺印欄　外枠)                ||06800  |'    '月末純資産(左側捺印欄　外枠)                
06828  |'    With xlSheet.Range("B56:S63").Borders(xlEdgeL||06801  |'    With xlSheet.Range("B56:S63").Borders(xlEdgeL
06829  |'        .LineStyle = xlContinuous                ||06802  |'        .LineStyle = xlContinuous                
06830  |'        .Weight = xlThin                         ||06803  |'        .Weight = xlThin                         
06831  |'    End With                                     ||06804  |'    End With                                     
06832  |'    With xlSheet.Range("B56:S63").Borders(xlEdgeT||06805  |'    With xlSheet.Range("B56:S63").Borders(xlEdgeT
06833  |'        .LineStyle = xlContinuous                ||06806  |'        .LineStyle = xlContinuous                
06834  |'        .Weight = xlThin                         ||06807  |'        .Weight = xlThin                         
06835  |'    End With                                     ||06808  |'    End With                                     
06836  |'    With xlSheet.Range("B56:S63").Borders(xlEdgeB||06809  |'    With xlSheet.Range("B56:S63").Borders(xlEdgeB
06837  |'        .LineStyle = xlContinuous                ||06810  |'        .LineStyle = xlContinuous                
06838  |'        .Weight = xlThin                         ||06811  |'        .Weight = xlThin                         
06839  |'    End With                                     ||06812  |'    End With                                     
06840  |'    With xlSheet.Range("B56:S63").Borders(xlEdgeR||06813  |'    With xlSheet.Range("B56:S63").Borders(xlEdgeR
06841  |'        .LineStyle = xlContinuous                ||06814  |'        .LineStyle = xlContinuous                
06842  |'        .Weight = xlThin                         ||06815  |'        .Weight = xlThin                         
06843  |'    End With                                     ||06816  |'    End With                                     
06844  |'    '月末純資産(左側捺印欄　上枠)                ||06817  |'    '月末純資産(左側捺印欄　上枠)                
06845  |'    With xlSheet.Range("B56:S57").Borders(xlEdgeB||06818  |'    With xlSheet.Range("B56:S57").Borders(xlEdgeB
06846  |'        .LineStyle = xlContinuous                ||06819  |'        .LineStyle = xlContinuous                
06847  |'        .Weight = xlThin                         ||06820  |'        .Weight = xlThin                         
06848  |'    End With                                     ||06821  |'    End With                                     
06849  |'    With xlSheet.Range("B56:S57").Borders(xlInsid||06822  |'    With xlSheet.Range("B56:S57").Borders(xlInsid
06850  |'        .LineStyle = xlContinuous                ||06823  |'        .LineStyle = xlContinuous                
06851  |'        .Weight = xlThin                         ||06824  |'        .Weight = xlThin                         
06852  |'    End With                                     ||06825  |'    End With                                     
06853  |'    '月末純資産(左側捺印欄　縦線)                ||06826  |'    '月末純資産(左側捺印欄　縦線)                
06854  |'    With xlSheet.Range("J57:J63").Borders(xlEdgeR||06827  |'    With xlSheet.Range("J57:J63").Borders(xlEdgeR
06855  |'        .LineStyle = xlContinuous                ||06828  |'        .LineStyle = xlContinuous                
06856  |'        .Weight = xlThin                         ||06829  |'        .Weight = xlThin                         
06857  |'    End With                                     ||06830  |'    End With                                     
06858  |'    '月末純資産(右側捺印欄　外枠)                ||06831  |'    '月末純資産(右側捺印欄　外枠)                
06859  |'    With xlSheet.Range("X56:AO63").Borders(xlEdge||06832  |'    With xlSheet.Range("X56:AO63").Borders(xlEdge
06860  |'        .LineStyle = xlContinuous                ||06833  |'        .LineStyle = xlContinuous                
06861  |'        .Weight = xlThin                         ||06834  |'        .Weight = xlThin                         
06862  |'    End With                                     ||06835  |'    End With                                     
06863  |'    With xlSheet.Range("X56:AO63").Borders(xlEdge||06836  |'    With xlSheet.Range("X56:AO63").Borders(xlEdge
06864  |'        .LineStyle = xlContinuous                ||06837  |'        .LineStyle = xlContinuous                
06865  |'        .Weight = xlThin                         ||06838  |'        .Weight = xlThin                         
06866  |'    End With                                     ||06839  |'    End With                                     
06867  |'    With xlSheet.Range("X56:AO63").Borders(xlEdge||06840  |'    With xlSheet.Range("X56:AO63").Borders(xlEdge
06868  |'        .LineStyle = xlContinuous                ||06841  |'        .LineStyle = xlContinuous                
06869  |'        .Weight = xlThin                         ||06842  |'        .Weight = xlThin                         
06870  |'    End With                                     ||06843  |'    End With                                     
06871  |'    With xlSheet.Range("X56:AO63").Borders(xlEdge||06844  |'    With xlSheet.Range("X56:AO63").Borders(xlEdge
06872  |'        .LineStyle = xlContinuous                ||06845  |'        .LineStyle = xlContinuous                
06873  |'        .Weight = xlThin                         ||06846  |'        .Weight = xlThin                         
06874  |'    End With                                     ||06847  |'    End With                                     
06875  |'    '月末純資産(右側捺印欄　上枠)                ||06848  |'    '月末純資産(右側捺印欄　上枠)                
06876  |'    With xlSheet.Range("X56:AO57").Borders(xlEdge||06849  |'    With xlSheet.Range("X56:AO57").Borders(xlEdge
06877  |'        .LineStyle = xlContinuous                ||06850  |'        .LineStyle = xlContinuous                
06878  |'        .Weight = xlThin                         ||06851  |'        .Weight = xlThin                         
06879  |'    End With                                     ||06852  |'    End With                                     
06880  |'    With xlSheet.Range("X56:AO57").Borders(xlEdge||06853  |'    With xlSheet.Range("X56:AO57").Borders(xlEdge
06881  |'        .LineStyle = xlContinuous                ||06854  |'        .LineStyle = xlContinuous                
06882  |'        .Weight = xlThin                         ||06855  |'        .Weight = xlThin                         
06883  |'    End With                                     ||06856  |'    End With                                     
06884  |'    With xlSheet.Range("X56:AO57").Borders(xlInsi||06857  |'    With xlSheet.Range("X56:AO57").Borders(xlInsi
06885  |'        .LineStyle = xlContinuous                ||06858  |'        .LineStyle = xlContinuous                
06886  |'        .Weight = xlThin                         ||06859  |'        .Weight = xlThin                         
06887  |'    End With                                     ||06860  |'    End With                                     
06888  |'    '月末純資産(右側捺印欄　縦線)                ||06861  |'    '月末純資産(右側捺印欄　縦線)                
06889  |'    With xlSheet.Range("AF57:AF63").Borders(xlEdg||06862  |'    With xlSheet.Range("AF57:AF63").Borders(xlEdg
06890  |'        .LineStyle = xlContinuous                ||06863  |'        .LineStyle = xlContinuous                
06891  |'        .Weight = xlThin                         ||06864  |'        .Weight = xlThin                         
06892  |'    End With                                     ||06865  |'    End With                                     
06893  |'                                                 ||06866  |'                                                 
06894  |''2005/01/17 Start                                ||06867  |''2005/01/17 Start                                
06895  |''    '換算(外枠)                                 ||06868  |''    '換算(外枠)                                 
06896  |'''    With xlSheet.Range("AN19:BF28").Borders(xlE||06869  |'''    With xlSheet.Range("AN19:BF28").Borders(xlE
06897  |'''        .LineStyle = xlContinuous              ||06870  |'''        .LineStyle = xlContinuous              
06898  |'''        .Weight = xlThin                       ||06871  |'''        .Weight = xlThin                       
06899  |'''    End With                                   ||06872  |'''    End With                                   
06900  |'''    With xlSheet.Range("AN19:BF28").Borders(xlE||06873  |'''    With xlSheet.Range("AN19:BF28").Borders(xlE
06901  |'''        .LineStyle = xlContinuous              ||06874  |'''        .LineStyle = xlContinuous              
06902  |'''        .Weight = xlThin                       ||06875  |'''        .Weight = xlThin                       
06903  |'''    End With                                   ||06876  |'''    End With                                   
06904  |'''    With xlSheet.Range("AN19:BF28").Borders(xlE||06877  |'''    With xlSheet.Range("AN19:BF28").Borders(xlE
06905  |'''        .LineStyle = xlContinuous              ||06878  |'''        .LineStyle = xlContinuous              
06906  |'''        .Weight = xlThin                       ||06879  |'''        .Weight = xlThin                       
06907  |'''    End With                                   ||06880  |'''    End With                                   
06908  |'''    With xlSheet.Range("AN19:BF28").Borders(xlE||06881  |'''    With xlSheet.Range("AN19:BF28").Borders(xlE
06909  |'''        .LineStyle = xlContinuous              ||06882  |'''        .LineStyle = xlContinuous              
06910  |'''        .Weight = xlThin                       ||06883  |'''        .Weight = xlThin                       
06911  |'''    End With                                   ||06884  |'''    End With                                   
06912  |'''    With xlSheet.Range("AN19:BF28").Borders(xlI||06885  |'''    With xlSheet.Range("AN19:BF28").Borders(xlI
06913  |'''        .LineStyle = xlContinuous              ||06886  |'''        .LineStyle = xlContinuous              
06914  |'''        .Weight = xlThin                       ||06887  |'''        .Weight = xlThin                       
06915  |'''    End With                                   ||06888  |'''    End With                                   
06916  |''    '換算(縦線)                                 ||06889  |''    '換算(縦線)                                 
06917  |''    With xlSheet.Range("AM19:AM28").Borders(xlEd||06890  |''    With xlSheet.Range("AM19:AM28").Borders(xlEd
06918  |''        .LineStyle = xlContinuous               ||06891  |''        .LineStyle = xlContinuous               
06919  |''        .Weight = xlThin                        ||06892  |''        .Weight = xlThin                        
06920  |''    End With                                    ||06893  |''    End With                                    
06921  |''    With xlSheet.Range("AT19:AT28").Borders(xlEd||06894  |''    With xlSheet.Range("AT19:AT28").Borders(xlEd
06922  |''        .LineStyle = xlContinuous               ||06895  |''        .LineStyle = xlContinuous               
06923  |''        .Weight = xlThin                        ||06896  |''        .Weight = xlThin                        
06924  |''    End With                                    ||06897  |''    End With                                    
06925  |''    With xlSheet.Range("BA19:BA28").Borders(xlEd||06898  |''    With xlSheet.Range("BA19:BA28").Borders(xlEd
06926  |''        .LineStyle = xlContinuous               ||06899  |''        .LineStyle = xlContinuous               
06927  |''        .Weight = xlThin                        ||06900  |''        .Weight = xlThin                        
06928  |''    End With                                    ||06901  |''    End With                                    
06929  |''    With xlSheet.Range("BF19:BF28").Borders(xlEd||06902  |''    With xlSheet.Range("BF19:BF28").Borders(xlEd
06930  |''        .LineStyle = xlContinuous               ||06903  |''        .LineStyle = xlContinuous               
06931  |''        .Weight = xlThin                        ||06904  |''        .Weight = xlThin                        
06932  |''    End With                                    ||06905  |''    End With                                    
06933  |''                                                ||06906  |''                                                
06934  |''    '換算(横線)                                 ||06907  |''    '換算(横線)                                 
06935  |''    With xlSheet.Range("AN18:BF18").Borders(xlEd||06908  |''    With xlSheet.Range("AN18:BF18").Borders(xlEd
06936  |''        .LineStyle = xlContinuous               ||06909  |''        .LineStyle = xlContinuous               
06937  |''        .Weight = xlThin                        ||06910  |''        .Weight = xlThin                        
06938  |''    End With                                    ||06911  |''    End With                                    
06939  |''    With xlSheet.Range("AN20:BF20").Borders(xlEd||06912  |''    With xlSheet.Range("AN20:BF20").Borders(xlEd
06940  |''        .LineStyle = xlContinuous               ||06913  |''        .LineStyle = xlContinuous               
06941  |''        .Weight = xlThin                        ||06914  |''        .Weight = xlThin                        
06942  |''    End With                                    ||06915  |''    End With                                    
06943  |''    With xlSheet.Range("AN22:BF22").Borders(xlEd||06916  |''    With xlSheet.Range("AN22:BF22").Borders(xlEd
06944  |''        .LineStyle = xlContinuous               ||06917  |''        .LineStyle = xlContinuous               
06945  |''        .Weight = xlThin                        ||06918  |''        .Weight = xlThin                        
06946  |''    End With                                    ||06919  |''    End With                                    
06947  |''    With xlSheet.Range("AN24:BF24").Borders(xlEd||06920  |''    With xlSheet.Range("AN24:BF24").Borders(xlEd
06948  |''        .LineStyle = xlContinuous               ||06921  |''        .LineStyle = xlContinuous               
06949  |''        .Weight = xlThin                        ||06922  |''        .Weight = xlThin                        
06950  |''    End With                                    ||06923  |''    End With                                    
06951  |''    With xlSheet.Range("AN26:BF26").Borders(xlEd||06924  |''    With xlSheet.Range("AN26:BF26").Borders(xlEd
06952  |''        .LineStyle = xlContinuous               ||06925  |''        .LineStyle = xlContinuous               
06953  |''        .Weight = xlThin                        ||06926  |''        .Weight = xlThin                        
06954  |''    End With                                    ||06927  |''    End With                                    
06955  |''    With xlSheet.Range("AN28:BF28").Borders(xlEd||06928  |''    With xlSheet.Range("AN28:BF28").Borders(xlEd
06956  |''        .LineStyle = xlContinuous               ||06929  |''        .LineStyle = xlContinuous               
06957  |''        .Weight = xlThin                        ||06930  |''        .Weight = xlThin                        
06958  |''    End With                                    ||06931  |''    End With                                    
06959  |''                                                ||06932  |''                                                
06960  |'''    '換算(横線)                                ||06933  |'''    '換算(横線)                                
06961  |'''    With xlSheet.Range("AN19:BF20").Borders(xlE||06934  |'''    With xlSheet.Range("AN19:BF20").Borders(xlE
06962  |'''        .LineStyle = xlContinuous              ||06935  |'''        .LineStyle = xlContinuous              
06963  |'''        .Weight = xlThin                       ||06936  |'''        .Weight = xlThin                       
06964  |'''    End With                                   ||06937  |'''    End With                                   
06965  |'''    With xlSheet.Range("AN21:BF22").Borders(xlE||06938  |'''    With xlSheet.Range("AN21:BF22").Borders(xlE
06966  |'''        .LineStyle = xlContinuous              ||06939  |'''        .LineStyle = xlContinuous              
06967  |'''        .Weight = xlThin                       ||06940  |'''        .Weight = xlThin                       
06968  |'''    End With                                   ||06941  |'''    End With                                   
06969  |'''    With xlSheet.Range("AN23:BF24").Borders(xlE||06942  |'''    With xlSheet.Range("AN23:BF24").Borders(xlE
06970  |'''        .LineStyle = xlContinuous              ||06943  |'''        .LineStyle = xlContinuous              
06971  |'''        .Weight = xlThin                       ||06944  |'''        .Weight = xlThin                       
06972  |'''    End With                                   ||06945  |'''    End With                                   
06973  |'''    With xlSheet.Range("AN25:BF26").Borders(xlE||06946  |'''    With xlSheet.Range("AN25:BF26").Borders(xlE
06974  |'''        .LineStyle = xlContinuous              ||06947  |'''        .LineStyle = xlContinuous              
06975  |'''        .Weight = xlThin                       ||06948  |'''        .Weight = xlThin                       
06976  |'''    End With                                   ||06949  |'''    End With                                   
06977  |'''2005/01/12 End                                 ||06950  |'''2005/01/12 End                                 
06978  |''2005/01/17 End                                  ||06951  |''2005/01/17 End                                  
06979  |'                                                 ||06952  |'                                                 
06980  |'    '月末純資産　下線                            ||06953  |'    '月末純資産　下線                            
06981  |''        xlSheet.Range("K36:Z36").Select         ||06954  |''        xlSheet.Range("K36:Z36").Select         
06982  |''        With Selection.Borders(xlEdgeBottom)    ||06955  |''        With Selection.Borders(xlEdgeBottom)    
06983  |''            .LineStyle = xlContinuous           ||06956  |''            .LineStyle = xlContinuous           
06984  |''            .Weight = xlThin                    ||06957  |''            .Weight = xlThin                    
06985  |''        End With                                ||06958  |''        End With                                
06986  |''                                                ||06959  |''                                                
06987  |''        xlSheet.Range("AL36:AZ36").Select       ||06960  |''        xlSheet.Range("AL36:AZ36").Select       
06988  |''        With Selection.Borders(xlEdgeBottom)    ||06961  |''        With Selection.Borders(xlEdgeBottom)    
06989  |''            .LineStyle = xlContinuous           ||06962  |''            .LineStyle = xlContinuous           
06990  |''            .Weight = xlThin                    ||06963  |''            .Weight = xlThin                    
06991  |''        End With                                ||06964  |''        End With                                
06992  |'                                                 ||06965  |'                                                 
06993  |''2005/03/09 Start                                ||06966  |''2005/03/09 Start                                
06994  |''2005/03/18 Start                                ||06967  |''2005/03/18 Start                                
06995  |''2005/03/25 Start                                ||06968  |''2005/03/25 Start                                
06996  |''                If gbuMGetUPDRec.N(lRecIdx).MGET||06969  |''                If gbuMGetUPDRec.N(lRecIdx).MGET
06997  |''                And gbuMGetUPDRec.N(lRecIdx).MGE||06970  |''                And gbuMGetUPDRec.N(lRecIdx).MGE
06998  |'                If Mid(gbuMGetUPDRec.N(lRecIdx).M||06971  |'                If Mid(gbuMGetUPDRec.N(lRecIdx).M
06999  |'                And gbuMGetUPDRec.N(lRecIdx).MGET||06972  |'                And gbuMGetUPDRec.N(lRecIdx).MGET
07000  |''2005/03/25 End                                  ||06973  |''2005/03/25 End                                  
07001  |'                    xlSheet.Cells(15, 13).Value =||06974  |'                    xlSheet.Cells(15, 13).Value =
07002  |'                        CStr(Format(dStart, "YYYY||06975  |'                        CStr(Format(dStart, "YYYY
07003  |'                Else                             ||06976  |'                Else                             
07004  |'                    xlSheet.Cells(15, 13).Value =||06977  |'                    xlSheet.Cells(15, 13).Value =
07005  |'                        CStr(Format(dStart, "YYYY||06978  |'                        CStr(Format(dStart, "YYYY
07006  |'                End If                           ||06979  |'                End If                           
07007  |''2005/03/18 End                                  ||06980  |''2005/03/18 End                                  
07008  |'    'A4印刷用に上2行を削除して、プレビュー範囲内 ||06981  |'    'A4印刷用に上2行を削除して、プレビュー範囲内 
07009  |'    xlSheet.Rows("1:2").Delete Shift:=xlUp       ||06982  |'    xlSheet.Rows("1:2").Delete Shift:=xlUp       
07010  |'                                                 ||06983  |'                                                 
07011  |''2005/03/15 Start                                ||06984  |''2005/03/15 Start                                
07012  |'''2005/03/09 Start                               ||06985  |'''2005/03/09 Start                               
07013  |''''契約区分：外部委託顧問料計算　＆　NAV取得区分 ||06986  |''''契約区分：外部委託顧問料計算　＆　NAV取得区分 
07014  |'''                                               ||06987  |'''                                               
07015  |'''    If gbuMGetUPDRec.N(lRecIdx).MGET_contract_f||06988  |'''    If gbuMGetUPDRec.N(lRecIdx).MGET_contract_f
07016  |'''    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||06989  |'''    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
07017  |'''契約区分：名称使用許諾料　＆　NAV取得区分：日次||06990  |'''契約区分：名称使用許諾料　＆　NAV取得区分：日次
07018  |'''　　　　　　　　　　　　　　　　　　　　　　日 ||06991  |'''　　　　　　　　　　　　　　　　　　　　　　日 
07019  |''    If gbuMGetUPDRec.N(lRecIdx).MGET_contract_fl||06992  |''    If gbuMGetUPDRec.N(lRecIdx).MGET_contract_fl
07020  |''    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_fl||06993  |''    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_fl
07021  |''        TotalNav = dstrAvgNav                   ||06994  |''        TotalNav = dstrAvgNav                   
07022  |''    Else                                        ||06995  |''    Else                                        
07023  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_contrac||06996  |''        If gbuMGetUPDRec.N(lRecIdx).MGET_contrac
07024  |''        And gbuMGetUPDRec.N(lRecIdx).MGET_nav_ge||06997  |''        And gbuMGetUPDRec.N(lRecIdx).MGET_nav_ge
07025  |''            TotalNav = dstrAvgNav               ||06998  |''            TotalNav = dstrAvgNav               
07026  |''            AvgNav = dstrAvgNav                 ||06999  |''            AvgNav = dstrAvgNav                 
07027  |''        End If                                  ||07000  |''        End If                                  
07028  |''    End If                                      ||07001  |''    End If                                      
07029  |''2005/03/15 End                                  ||07002  |''2005/03/15 End                                  
07030  |'                                                 ||07003  |'                                                 
07031  |''NAV取得区分：日次NAV平均(休日有)または日次NAV平 ||07004  |''NAV取得区分：日次NAV平均(休日有)または日次NAV平 
07032  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||07005  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
07033  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||07006  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
07034  |'                                                 ||07007  |'                                                 
07035  |''2005/03/09 End                                  ||07008  |''2005/03/09 End                                  
07036  |'                                                 ||07009  |'                                                 
07037  |'        J = 0                                    ||07010  |'        J = 0                                    
07038  |'        K = 0                                    ||07011  |'        K = 0                                    
07039  |'        '＋２は合計行と平均行                    ||07012  |'        '＋２は合計行と平均行                    
07040  |'        dintPage = (dlngCnt + 2) \ 108           ||07013  |'        dintPage = (dlngCnt + 2) \ 108           
07041  |'        dintAmari = (dlngCnt + 2) Mod 108        ||07014  |'        dintAmari = (dlngCnt + 2) Mod 108        
07042  |'        If dintAmari <> 0 Then                   ||07015  |'        If dintAmari <> 0 Then                   
07043  |'            dintPage = dintPage + 1              ||07016  |'            dintPage = dintPage + 1              
07044  |'        End If                                   ||07017  |'        End If                                   
07045  |'                                                 ||07018  |'                                                 
07046  |'        For L = 1 To dintPage                    ||07019  |'        For L = 1 To dintPage                    
07047  |'                                                 ||07020  |'                                                 
07048  |'            xlBook.Worksheets.Add after:=xlBook.S||07021  |'            xlBook.Worksheets.Add after:=xlBook.S
07049  |'            gProcessCnt = gProcessCnt + 1        ||07022  |'            gProcessCnt = gProcessCnt + 1        
07050  |'            Set xlSheet = xlBook.Sheets(gProcessC||07023  |'            Set xlSheet = xlBook.Sheets(gProcessC
07051  |'                                                 ||07024  |'                                                 
07052  |'            'Excelフォーマットを調整             ||07025  |'            'Excelフォーマットを調整             
07053  |'            xlSheet.Cells.ColumnWidth = 1        ||07026  |'            xlSheet.Cells.ColumnWidth = 1        
07054  |'            xlSheet.Cells.Font.Size = 11         ||07027  |'            xlSheet.Cells.Font.Size = 11         
07055  |'            'シート名を設定(日次NAV一覧**)       ||07028  |'            'シート名を設定(日次NAV一覧**)       
07056  |'                                                 ||07029  |'                                                 
07057  |''2005/03/09 Start                                ||07030  |''2005/03/09 Start                                
07058  |''            xlBook.Sheets(gProcessCnt).Name = sG||07031  |''            xlBook.Sheets(gProcessCnt).Name = sG
07059  |'            If dstrOldAccCode = sGetAccCode Then ||07032  |'            If dstrOldAccCode = sGetAccCode Then 
07060  |'                gTotalDnavCnt = gTotalDnavCnt + 1||07033  |'                gTotalDnavCnt = gTotalDnavCnt + 1
07061  |'            Else                                 ||07034  |'            Else                                 
07062  |'                gTotalDnavCnt = 1                ||07035  |'                gTotalDnavCnt = 1                
07063  |'                dstrOldAccCode = sGetAccCode     ||07036  |'                dstrOldAccCode = sGetAccCode     
07064  |'            End If                               ||07037  |'            End If                               
07065  |'            gTotalCnt = gTotalCnt + 1            ||07038  |'            gTotalCnt = gTotalCnt + 1            
07066  |'            xlBook.Sheets(gProcessCnt).Name = sGe||07039  |'            xlBook.Sheets(gProcessCnt).Name = sGe
07067  |''2005/03/09 End                                  ||07040  |''2005/03/09 End                                  
07068  |'            'シートの余白を設定                  ||07041  |'            'シートの余白を設定                  
07069  |'            xlSheet.PageSetup.TopMargin = Applica||07042  |'            xlSheet.PageSetup.TopMargin = Applica
07070  |'            xlSheet.PageSetup.BottomMargin = Appl||07043  |'            xlSheet.PageSetup.BottomMargin = Appl
07071  |'            xlSheet.PageSetup.LeftMargin = Applic||07044  |'            xlSheet.PageSetup.LeftMargin = Applic
07072  |'            xlSheet.PageSetup.RightMargin = Appli||07045  |'            xlSheet.PageSetup.RightMargin = Appli
07073  |'                                                 ||07046  |'                                                 
07074  |'            DoEvents                             ||07047  |'            DoEvents                             
07075  |'                                                 ||07048  |'                                                 
07076  |'            With xlSheet                         ||07049  |'            With xlSheet                         
07077  |'                '題目                            ||07050  |'                '題目                            
07078  |'                .Cells(5, 1).Value = sWord47     ||07051  |'                .Cells(5, 1).Value = sWord47     
07079  |'                .Cells(5, 1).Font.Size = 14      ||07052  |'                .Cells(5, 1).Font.Size = 14      
07080  |'                .Range("A5:BG5").HorizontalAlignm||07053  |'                .Range("A5:BG5").HorizontalAlignm
07081  |'                '出力日付                        ||07054  |'                '出力日付                        
07082  |'                If RTrim(txtSysOutDate.Text) = ""||07055  |'                If RTrim(txtSysOutDate.Text) = ""
07083  |'                    .Cells(3, 50).Value = sWord34||07056  |'                    .Cells(3, 50).Value = sWord34
07084  |'                    .Cells(3, 50).HorizontalAlign||07057  |'                    .Cells(3, 50).HorizontalAlign
07085  |'                Else                             ||07058  |'                Else                             
07086  |'                    .Cells(3, 43).Value = CStr(Fo||07059  |'                    .Cells(3, 43).Value = CStr(Fo
07087  |'                End If                           ||07060  |'                End If                           
07088  |'                'ファンド名                      ||07061  |'                'ファンド名                      
07089  |'                .Cells(6, 2).Value = sWord4      ||07062  |'                .Cells(6, 2).Value = sWord4      
07090  |'                .Cells(6, 11).Value = sWord19    ||07063  |'                .Cells(6, 11).Value = sWord19    
07091  |'                .Cells(6, 13).Value = gbuMGetUPDR||07064  |'                .Cells(6, 13).Value = gbuMGetUPDR
07092  |'                'ファンドコード                  ||07065  |'                'ファンドコード                  
07093  |'                .Cells(7, 2).Value = sWord4_2    ||07066  |'                .Cells(7, 2).Value = sWord4_2    
07094  |'                .Cells(7, 11).Value = sWord19    ||07067  |'                .Cells(7, 11).Value = sWord19    
07095  |'                .Cells(7, 13).NumberFormatLocal =||07068  |'                .Cells(7, 13).NumberFormatLocal =
07096  |'                .Cells(7, 13).Value = sGetAccCode||07069  |'                .Cells(7, 13).Value = sGetAccCode
07097  |'                '計算期間                        ||07070  |'                '計算期間                        
07098  |'                .Cells(8, 2).Value = sWord5      ||07071  |'                .Cells(8, 2).Value = sWord5      
07099  |'                .Cells(8, 11).Value = sWord19    ||07072  |'                .Cells(8, 11).Value = sWord19    
07100  |''2005/03/18 Start                                ||07073  |''2005/03/18 Start                                
07101  |''                .Cells(8, 13).Value = _         ||07074  |''                .Cells(8, 13).Value = _         
07102  |''                    CStr(Format(dStart, "YYYY年M||07075  |''                    CStr(Format(dStart, "YYYY年M
07103  |''                    CStr(Format(dEnd, "YYYY年M月||07076  |''                    CStr(Format(dEnd, "YYYY年M月
07104  |''                    (DateDiff("d", dStart, dEnd)||07077  |''                    (DateDiff("d", dStart, dEnd)
07105  |''2005/03/25 Start                                ||07078  |''2005/03/25 Start                                
07106  |''                If gbuMGetUPDRec.N(lRecIdx).MGET||07079  |''                If gbuMGetUPDRec.N(lRecIdx).MGET
07107  |''                And gbuMGetUPDRec.N(lRecIdx).MGE||07080  |''                And gbuMGetUPDRec.N(lRecIdx).MGE
07108  |'                If Mid(gbuMGetUPDRec.N(lRecIdx).M||07081  |'                If Mid(gbuMGetUPDRec.N(lRecIdx).M
07109  |'                And gbuMGetUPDRec.N(lRecIdx).MGET||07082  |'                And gbuMGetUPDRec.N(lRecIdx).MGET
07110  |''2005/03/25 End                                  ||07083  |''2005/03/25 End                                  
07111  |'                    .Cells(8, 13).Value = _      ||07084  |'                    .Cells(8, 13).Value = _      
07112  |'                        CStr(Format(dStart, "YYYY||07085  |'                        CStr(Format(dStart, "YYYY
07113  |'                Else                             ||07086  |'                Else                             
07114  |'                    .Cells(8, 13).Value = _      ||07087  |'                    .Cells(8, 13).Value = _      
07115  |'                        CStr(Format(dStart, "YYYY||07088  |'                        CStr(Format(dStart, "YYYY
07116  |'                End If                           ||07089  |'                End If                           
07117  |''2005/03/18 End                                  ||07090  |''2005/03/18 End                                  
07118  |'                '日付                            ||07091  |'                '日付                            
07119  |'                .Cells(10, 3).Value = sWord7     ||07092  |'                .Cells(10, 3).Value = sWord7     
07120  |'                .Range("C10:N10").HorizontalAlign||07093  |'                .Range("C10:N10").HorizontalAlign
07121  |'                '純資産                          ||07094  |'                '純資産                          
07122  |'                .Cells(10, 15).Value = sWord8    ||07095  |'                .Cells(10, 15).Value = sWord8    
07123  |'                .Range("O10:AC10").HorizontalAlig||07096  |'                .Range("O10:AC10").HorizontalAlig
07124  |'                '日付                            ||07097  |'                '日付                            
07125  |'                .Cells(10, 31).Value = sWord7    ||07098  |'                .Cells(10, 31).Value = sWord7    
07126  |'                .Range("AE10:AP10").HorizontalAli||07099  |'                .Range("AE10:AP10").HorizontalAli
07127  |'                '純資産                          ||07100  |'                '純資産                          
07128  |'                .Cells(10, 43).Value = sWord8    ||07101  |'                .Cells(10, 43).Value = sWord8    
07129  |'                .Range("AQ10:BE10").HorizontalAli||07102  |'                .Range("AQ10:BE10").HorizontalAli
07130  |'                '日付＆NAV                       ||07103  |'                '日付＆NAV                       
07131  |'                Select Case L                    ||07104  |'                Select Case L                    
07132  |'                    Case 1                       ||07105  |'                    Case 1                       
07133  |'                        dintPageIni = 1          ||07106  |'                        dintPageIni = 1          
07134  |'                    Case Else                    ||07107  |'                    Case Else                    
07135  |'                        dintPageIni = dintPageIni||07108  |'                        dintPageIni = dintPageIni
07136  |'                End Select                       ||07109  |'                End Select                       
07137  |'                For dintFor = dintPageIni To dlng||07110  |'                For dintFor = dintPageIni To dlng
07138  |'                    If J < 54 Then               ||07111  |'                    If J < 54 Then               
07139  |'                        If dintFor = dlngCnt + 1 ||07112  |'                        If dintFor = dlngCnt + 1 
07140  |'                            '合計                ||07113  |'                            '合計                
07141  |'                            .Cells(11 + J, 3).Val||07114  |'                            .Cells(11 + J, 3).Val
07142  |'                            'NAV                 ||07115  |'                            'NAV                 
07143  |'                            .Cells(11 + J, 28).Nu||07116  |'                            .Cells(11 + J, 28).Nu
07144  |'                            If gbuMGetUPDRec.N(lR||07117  |'                            If gbuMGetUPDRec.N(lR
07145  |'                                .Cells(11 + J, 28||07118  |'                                .Cells(11 + J, 28
07146  |'                            Else                 ||07119  |'                            Else                 
07147  |'                                .Cells(11 + J, 28||07120  |'                                .Cells(11 + J, 28
07148  |'                            End If               ||07121  |'                            End If               
07149  |'                            .Cells(11 + J, 28).Ho||07122  |'                            .Cells(11 + J, 28).Ho
07150  |'                        End If                   ||07123  |'                        End If                   
07151  |''2005/03/15 Start                                ||07124  |''2005/03/15 Start                                
07152  |''                        If gbuMGetUPDRec.N(lRecI||07125  |''                        If gbuMGetUPDRec.N(lRecI
07153  |''2005/03/15 End                                  ||07126  |''2005/03/15 End                                  
07154  |'                            If dintFor = dlngCnt ||07127  |'                            If dintFor = dlngCnt 
07155  |'                                '平均            ||07128  |'                                '平均            
07156  |'                                .Cells(11 + J, 3)||07129  |'                                .Cells(11 + J, 3)
07157  |'                                'NAV             ||07130  |'                                'NAV             
07158  |'                                .Cells(11 + J, 28||07131  |'                                .Cells(11 + J, 28
07159  |'                                If gbuMGetUPDRec.||07132  |'                                If gbuMGetUPDRec.
07160  |'                                    .Cells(11 + J||07133  |'                                    .Cells(11 + J
07161  |'                                Else             ||07134  |'                                Else             
07162  |'                                    .Cells(11 + J||07135  |'                                    .Cells(11 + J
07163  |'                                End If           ||07136  |'                                End If           
07164  |'                                .Cells(11 + J, 28||07137  |'                                .Cells(11 + J, 28
07165  |'                            End If               ||07138  |'                            End If               
07166  |''2005/03/15 Start                                ||07139  |''2005/03/15 Start                                
07167  |''                        End If                  ||07140  |''                        End If                  
07168  |''2005/03/15 End                                  ||07141  |''2005/03/15 End                                  
07169  |'                        If dintFor < dlngCnt + 1 ||07142  |'                        If dintFor < dlngCnt + 1 
07170  |'                            '日付                ||07143  |'                            '日付                
07171  |'                            dCalDate = CDate(gstr||07144  |'                            dCalDate = CDate(gstr
07172  |'                            .Cells(11 + J, 4).Val||07145  |'                            .Cells(11 + J, 4).Val
07173  |'                                CStr(Format(dCalD||07146  |'                                CStr(Format(dCalD
07174  |'                            'NAV                 ||07147  |'                            'NAV                 
07175  |'                            .Cells(11 + J, 28).Nu||07148  |'                            .Cells(11 + J, 28).Nu
07176  |'                            If gbuMGetUPDRec.N(lR||07149  |'                            If gbuMGetUPDRec.N(lR
07177  |'                                .Cells(11 + J, 28||07150  |'                                .Cells(11 + J, 28
07178  |'                            Else                 ||07151  |'                            Else                 
07179  |'                                .Cells(11 + J, 28||07152  |'                                .Cells(11 + J, 28
07180  |'                            End If               ||07153  |'                            End If               
07181  |'                            .Cells(11 + J, 28).Ho||07154  |'                            .Cells(11 + J, 28).Ho
07182  |'                        End If                   ||07155  |'                        End If                   
07183  |'                    Else                         ||07156  |'                    Else                         
07184  |'                        If dintFor = dlngCnt + 1 ||07157  |'                        If dintFor = dlngCnt + 1 
07185  |'                            '合計                ||07158  |'                            '合計                
07186  |'                            .Cells(11 + K, 31).Va||07159  |'                            .Cells(11 + K, 31).Va
07187  |'                            'NAV                 ||07160  |'                            'NAV                 
07188  |'                            .Cells(11 + K, 56).Nu||07161  |'                            .Cells(11 + K, 56).Nu
07189  |'                            If gbuMGetUPDRec.N(lR||07162  |'                            If gbuMGetUPDRec.N(lR
07190  |'                                .Cells(11 + K, 56||07163  |'                                .Cells(11 + K, 56
07191  |'                            Else                 ||07164  |'                            Else                 
07192  |'                                .Cells(11 + K, 56||07165  |'                                .Cells(11 + K, 56
07193  |'                            End If               ||07166  |'                            End If               
07194  |'                            .Cells(11 + K, 56).Ho||07167  |'                            .Cells(11 + K, 56).Ho
07195  |'                        End If                   ||07168  |'                        End If                   
07196  |''2005/03/15 Start                                ||07169  |''2005/03/15 Start                                
07197  |''                        If gbuMGetUPDRec.N(lRecI||07170  |''                        If gbuMGetUPDRec.N(lRecI
07198  |''2005/03/15 End                                  ||07171  |''2005/03/15 End                                  
07199  |'                            If dintFor = dlngCnt ||07172  |'                            If dintFor = dlngCnt 
07200  |'                                '平均            ||07173  |'                                '平均            
07201  |'                                .Cells(11 + K, 31||07174  |'                                .Cells(11 + K, 31
07202  |'                                'NAV             ||07175  |'                                'NAV             
07203  |'                                .Cells(11 + K, 56||07176  |'                                .Cells(11 + K, 56
07204  |'                                If gbuMGetUPDRec.||07177  |'                                If gbuMGetUPDRec.
07205  |'                                    .Cells(11 + K||07178  |'                                    .Cells(11 + K
07206  |'                                Else             ||07179  |'                                Else             
07207  |'                                    .Cells(11 + K||07180  |'                                    .Cells(11 + K
07208  |'                                End If           ||07181  |'                                End If           
07209  |'                                .Cells(11 + K, 56||07182  |'                                .Cells(11 + K, 56
07210  |'                            End If               ||07183  |'                            End If               
07211  |''2005/03/15 Start                                ||07184  |''2005/03/15 Start                                
07212  |''                        End If                  ||07185  |''                        End If                  
07213  |''2005/03/15 End                                  ||07186  |''2005/03/15 End                                  
07214  |'                        If dintFor < dlngCnt + 1 ||07187  |'                        If dintFor < dlngCnt + 1 
07215  |'                            '日付                ||07188  |'                            '日付                
07216  |'                            dCalDate = CDate(gstr||07189  |'                            dCalDate = CDate(gstr
07217  |'                            .Cells(11 + K, 32).Va||07190  |'                            .Cells(11 + K, 32).Va
07218  |'                                CStr(Format(dCalD||07191  |'                                CStr(Format(dCalD
07219  |'                            'NAV                 ||07192  |'                            'NAV                 
07220  |'                            .Cells(11 + K, 56).Nu||07193  |'                            .Cells(11 + K, 56).Nu
07221  |'                            If gbuMGetUPDRec.N(lR||07194  |'                            If gbuMGetUPDRec.N(lR
07222  |'                                .Cells(11 + K, 56||07195  |'                                .Cells(11 + K, 56
07223  |'                            Else                 ||07196  |'                            Else                 
07224  |'                                .Cells(11 + K, 56||07197  |'                                .Cells(11 + K, 56
07225  |'                            End If               ||07198  |'                            End If               
07226  |'                            .Cells(11 + K, 56).Ho||07199  |'                            .Cells(11 + K, 56).Ho
07227  |'                        End If                   ||07200  |'                        End If                   
07228  |'                        K = K + 1                ||07201  |'                        K = K + 1                
07229  |'                        If K > 53 Then           ||07202  |'                        If K > 53 Then           
07230  |'                            J = 0                ||07203  |'                            J = 0                
07231  |'                            K = 0                ||07204  |'                            K = 0                
07232  |'                            Exit For             ||07205  |'                            Exit For             
07233  |'                        End If                   ||07206  |'                        End If                   
07234  |'                    End If                       ||07207  |'                    End If                       
07235  |'                    J = J + 1                    ||07208  |'                    J = J + 1                    
07236  |'                Next dintFor                     ||07209  |'                Next dintFor                     
07237  |'                                                 ||07210  |'                                                 
07238  |'                '左側日付                        ||07211  |'                '左側日付                        
07239  |'                With xlSheet.Range("C10:N64").Bor||07212  |'                With xlSheet.Range("C10:N64").Bor
07240  |'                    .LineStyle = xlContinuous    ||07213  |'                    .LineStyle = xlContinuous    
07241  |'                    .Weight = xlThin             ||07214  |'                    .Weight = xlThin             
07242  |'                End With                         ||07215  |'                End With                         
07243  |'                With xlSheet.Range("C10:N64").Bor||07216  |'                With xlSheet.Range("C10:N64").Bor
07244  |'                    .LineStyle = xlContinuous    ||07217  |'                    .LineStyle = xlContinuous    
07245  |'                    .Weight = xlThin             ||07218  |'                    .Weight = xlThin             
07246  |'                End With                         ||07219  |'                End With                         
07247  |'                With xlSheet.Range("C10:N64").Bor||07220  |'                With xlSheet.Range("C10:N64").Bor
07248  |'                    .LineStyle = xlContinuous    ||07221  |'                    .LineStyle = xlContinuous    
07249  |'                    .Weight = xlThin             ||07222  |'                    .Weight = xlThin             
07250  |'                End With                         ||07223  |'                End With                         
07251  |'                With xlSheet.Range("C10:N64").Bor||07224  |'                With xlSheet.Range("C10:N64").Bor
07252  |'                    .LineStyle = xlContinuous    ||07225  |'                    .LineStyle = xlContinuous    
07253  |'                    .Weight = xlThin             ||07226  |'                    .Weight = xlThin             
07254  |'                End With                         ||07227  |'                End With                         
07255  |'                With xlSheet.Range("C10:N64").Bor||07228  |'                With xlSheet.Range("C10:N64").Bor
07256  |'                    .LineStyle = xlContinuous    ||07229  |'                    .LineStyle = xlContinuous    
07257  |'                    .Weight = xlThin             ||07230  |'                    .Weight = xlThin             
07258  |'                End With                         ||07231  |'                End With                         
07259  |'                                                 ||07232  |'                                                 
07260  |'                '左側純資産                      ||07233  |'                '左側純資産                      
07261  |'                With xlSheet.Range("O10:AC64").Bo||07234  |'                With xlSheet.Range("O10:AC64").Bo
07262  |'                    .LineStyle = xlContinuous    ||07235  |'                    .LineStyle = xlContinuous    
07263  |'                    .Weight = xlThin             ||07236  |'                    .Weight = xlThin             
07264  |'                End With                         ||07237  |'                End With                         
07265  |'                With xlSheet.Range("O10:AC64").Bo||07238  |'                With xlSheet.Range("O10:AC64").Bo
07266  |'                    .LineStyle = xlContinuous    ||07239  |'                    .LineStyle = xlContinuous    
07267  |'                    .Weight = xlThin             ||07240  |'                    .Weight = xlThin             
07268  |'                End With                         ||07241  |'                End With                         
07269  |'                With xlSheet.Range("O10:AC64").Bo||07242  |'                With xlSheet.Range("O10:AC64").Bo
07270  |'                    .LineStyle = xlContinuous    ||07243  |'                    .LineStyle = xlContinuous    
07271  |'                    .Weight = xlThin             ||07244  |'                    .Weight = xlThin             
07272  |'                End With                         ||07245  |'                End With                         
07273  |'                With xlSheet.Range("O10:AC64").Bo||07246  |'                With xlSheet.Range("O10:AC64").Bo
07274  |'                    .LineStyle = xlContinuous    ||07247  |'                    .LineStyle = xlContinuous    
07275  |'                    .Weight = xlThin             ||07248  |'                    .Weight = xlThin             
07276  |'                End With                         ||07249  |'                End With                         
07277  |'                With xlSheet.Range("O10:AC64").Bo||07250  |'                With xlSheet.Range("O10:AC64").Bo
07278  |'                    .LineStyle = xlContinuous    ||07251  |'                    .LineStyle = xlContinuous    
07279  |'                    .Weight = xlThin             ||07252  |'                    .Weight = xlThin             
07280  |'                End With                         ||07253  |'                End With                         
07281  |'                                                 ||07254  |'                                                 
07282  |'                '右側日付                        ||07255  |'                '右側日付                        
07283  |'                With xlSheet.Range("AE10:AP64").B||07256  |'                With xlSheet.Range("AE10:AP64").B
07284  |'                    .LineStyle = xlContinuous    ||07257  |'                    .LineStyle = xlContinuous    
07285  |'                    .Weight = xlThin             ||07258  |'                    .Weight = xlThin             
07286  |'                End With                         ||07259  |'                End With                         
07287  |'                With xlSheet.Range("AE10:AP64").B||07260  |'                With xlSheet.Range("AE10:AP64").B
07288  |'                    .LineStyle = xlContinuous    ||07261  |'                    .LineStyle = xlContinuous    
07289  |'                    .Weight = xlThin             ||07262  |'                    .Weight = xlThin             
07290  |'                End With                         ||07263  |'                End With                         
07291  |'                With xlSheet.Range("AE10:AP64").B||07264  |'                With xlSheet.Range("AE10:AP64").B
07292  |'                    .LineStyle = xlContinuous    ||07265  |'                    .LineStyle = xlContinuous    
07293  |'                    .Weight = xlThin             ||07266  |'                    .Weight = xlThin             
07294  |'                End With                         ||07267  |'                End With                         
07295  |'                With xlSheet.Range("AE10:AP64").B||07268  |'                With xlSheet.Range("AE10:AP64").B
07296  |'                    .LineStyle = xlContinuous    ||07269  |'                    .LineStyle = xlContinuous    
07297  |'                    .Weight = xlThin             ||07270  |'                    .Weight = xlThin             
07298  |'                End With                         ||07271  |'                End With                         
07299  |'                With xlSheet.Range("AE10:AP64").B||07272  |'                With xlSheet.Range("AE10:AP64").B
07300  |'                    .LineStyle = xlContinuous    ||07273  |'                    .LineStyle = xlContinuous    
07301  |'                    .Weight = xlThin             ||07274  |'                    .Weight = xlThin             
07302  |'                End With                         ||07275  |'                End With                         
07303  |'                                                 ||07276  |'                                                 
07304  |'                '右側純資産                      ||07277  |'                '右側純資産                      
07305  |'                With xlSheet.Range("AQ10:BE64").B||07278  |'                With xlSheet.Range("AQ10:BE64").B
07306  |'                    .LineStyle = xlContinuous    ||07279  |'                    .LineStyle = xlContinuous    
07307  |'                    .Weight = xlThin             ||07280  |'                    .Weight = xlThin             
07308  |'                End With                         ||07281  |'                End With                         
07309  |'                With xlSheet.Range("AQ10:BE64").B||07282  |'                With xlSheet.Range("AQ10:BE64").B
07310  |'                    .LineStyle = xlContinuous    ||07283  |'                    .LineStyle = xlContinuous    
07311  |'                    .Weight = xlThin             ||07284  |'                    .Weight = xlThin             
07312  |'                End With                         ||07285  |'                End With                         
07313  |'                With xlSheet.Range("AQ10:BE64").B||07286  |'                With xlSheet.Range("AQ10:BE64").B
07314  |'                    .LineStyle = xlContinuous    ||07287  |'                    .LineStyle = xlContinuous    
07315  |'                    .Weight = xlThin             ||07288  |'                    .Weight = xlThin             
07316  |'                End With                         ||07289  |'                End With                         
07317  |'                With xlSheet.Range("AQ10:BE64").B||07290  |'                With xlSheet.Range("AQ10:BE64").B
07318  |'                    .LineStyle = xlContinuous    ||07291  |'                    .LineStyle = xlContinuous    
07319  |'                    .Weight = xlThin             ||07292  |'                    .Weight = xlThin             
07320  |'                End With                         ||07293  |'                End With                         
07321  |'                With xlSheet.Range("AQ10:BE64").B||07294  |'                With xlSheet.Range("AQ10:BE64").B
07322  |'                    .LineStyle = xlContinuous    ||07295  |'                    .LineStyle = xlContinuous    
07323  |'                    .Weight = xlThin             ||07296  |'                    .Weight = xlThin             
07324  |'                End With                         ||07297  |'                End With                         
07325  |'                                                 ||07298  |'                                                 
07326  |'            End With                             ||07299  |'            End With                             
07327  |'            'A4印刷用に上2行を削除して、プレビュ ||07300  |'            'A4印刷用に上2行を削除して、プレビュ 
07328  |'            xlSheet.Rows("1:2").Delete Shift:=xlU||07301  |'            xlSheet.Rows("1:2").Delete Shift:=xlU
07329  |'        Next L                                   ||07302  |'        Next L                                   
07330  |'    End If                                       ||07303  |'    End If                                       
07331  |''2005/03/09 End                                  ||07304  |''2005/03/09 End                                  
07332  |'                                                 ||07305  |'                                                 
07333  |''2005/07/26 Start                                ||07306  |''2005/07/26 Start                                
07334  |'    'セル(A1)を選択する                          ||07307  |'    'セル(A1)を選択する                          
07335  |''    xlSheet.Cells(1, 1).Select                  ||07308  |''    xlSheet.Cells(1, 1).Select                  
07336  |''2005/07/26 End                                  ||07309  |''2005/07/26 End                                  
07337  |'                                                 ||07310  |'                                                 
07338  |''2005/03/09 Start                                ||07311  |''2005/03/09 Start                                
07339  |''    'A4印刷用に上2行を削除して、プレビュー範囲内||07312  |''    'A4印刷用に上2行を削除して、プレビュー範囲内
07340  |''    xlSheet.Rows("1:2").Delete Shift:=xlUp      ||07313  |''    xlSheet.Rows("1:2").Delete Shift:=xlUp      
07341  |''2005/03/09 End                                  ||07314  |''2005/03/09 End                                  
07342  |'                                                 ||07315  |'                                                 
07343  |''    '動的ファイル名部分を取得                   ||07316  |''    '動的ファイル名部分を取得                   
07344  |''    If gTotalProcessCnt = 1 Then                ||07317  |''    If gTotalProcessCnt = 1 Then                
07345  |''        Call sbFileNameChange                   ||07318  |''        Call sbFileNameChange                   
07346  |''    End If                                      ||07319  |''    End If                                      
07347  |''                                                ||07320  |''                                                
07348  |''    'Excel の Worksheet 削除用カウンタ初期化    ||07321  |''    'Excel の Worksheet 削除用カウンタ初期化    
07349  |''    Ws_Cnt = xlBook.Worksheets.Count            ||07322  |''    Ws_Cnt = xlBook.Worksheets.Count            
07350  |''    Ws_Del_Cnt2 = 0                             ||07323  |''    Ws_Del_Cnt2 = 0                             
07351  |''    '出力するデータ数のカウント(gSysoutDataCnt) ||07324  |''    '出力するデータ数のカウント(gSysoutDataCnt) 
07352  |''    If gTotalProcessCnt = gSysoutDataCnt Then   ||07325  |''    If gTotalProcessCnt = gSysoutDataCnt Then   
07353  |''        ' WorkBookが存在すれば削除              ||07326  |''        ' WorkBookが存在すれば削除              
07354  |''        If Dir(mstrFileName) <> "" Then         ||07327  |''        If Dir(mstrFileName) <> "" Then         
07355  |''            Kill (mstrFileName)                 ||07328  |''            Kill (mstrFileName)                 
07356  |''        End If                                  ||07329  |''        End If                                  
07357  |''                                                ||07330  |''                                                
07358  |''        'シート名を調査しシート削除             ||07331  |''        'シート名を調査しシート削除             
07359  |''        For Ws_Del_Cnt = 1 To Ws_Cnt            ||07332  |''        For Ws_Del_Cnt = 1 To Ws_Cnt            
07360  |''            If Left(xlBook.Worksheets(Ws_Del_Cnt||07333  |''            If Left(xlBook.Worksheets(Ws_Del_Cnt
07361  |''                'シートの削除                   ||07334  |''                'シートの削除                   
07362  |''                xlBook.Worksheets(Ws_Del_Cnt).De||07335  |''                xlBook.Worksheets(Ws_Del_Cnt).De
07363  |''                Ws_Del_Cnt = Ws_Del_Cnt - 1     ||07336  |''                Ws_Del_Cnt = Ws_Del_Cnt - 1     
07364  |''                Ws_Del_Cnt2 = Ws_Del_Cnt2 + 1   ||07337  |''                Ws_Del_Cnt2 = Ws_Del_Cnt2 + 1   
07365  |''                If Ws_Del_Cnt2 = 2 Then         ||07338  |''                If Ws_Del_Cnt2 = 2 Then         
07366  |''                    Exit For                    ||07339  |''                    Exit For                    
07367  |''                End If                          ||07340  |''                End If                          
07368  |''            End If                              ||07341  |''            End If                              
07369  |''        Next Ws_Del_Cnt                         ||07342  |''        Next Ws_Del_Cnt                         
07370  |''                                                ||07343  |''                                                
07371  |''        '見易いようにシートの1枚目を選択する    ||07344  |''        '見易いようにシートの1枚目を選択する    
07372  |''        xlBook.Worksheets(1).Select             ||07345  |''        xlBook.Worksheets(1).Select             
07373  |''                                                ||07346  |''                                                
07374  |''        xlBook.SaveAs mstrFileName              ||07347  |''        xlBook.SaveAs mstrFileName              
07375  |''        xlBook.Close                            ||07348  |''        xlBook.Close                            
07376  |''        xlApp.Quit                              ||07349  |''        xlApp.Quit                              
07377  |''                                                ||07350  |''                                                
07378  |''        Set xlApp = Nothing                     ||07351  |''        Set xlApp = Nothing                     
07379  |''        Set xlBook = Nothing                    ||07352  |''        Set xlBook = Nothing                    
07380  |''        Set xlSheet = Nothing                   ||07353  |''        Set xlSheet = Nothing                   
07381  |'                                                 ||07354  |'                                                 
07382  |''        '正常戻り値セット                       ||07355  |''        '正常戻り値セット                       
07383  |''        fnblExcelOut = True                     ||07356  |''        fnblExcelOut = True                     
07384  |''        GoTo EndProc                            ||07357  |''        GoTo EndProc                            
07385  |''    End If                                      ||07358  |''    End If                                      
07386  |''                                                ||07359  |''                                                
07387  |''    If gProcessCnt = conSheetLimit Then         ||07360  |''    If gProcessCnt = conSheetLimit Then         
07388  |''        ' WorkBookが存在すれば削除              ||07361  |''        ' WorkBookが存在すれば削除              
07389  |''        If Dir(mstrFileName) <> "" Then         ||07362  |''        If Dir(mstrFileName) <> "" Then         
07390  |''            Kill (mstrFileName)                 ||07363  |''            Kill (mstrFileName)                 
07391  |''        End If                                  ||07364  |''        End If                                  
07392  |''                                                ||07365  |''                                                
07393  |''        'シート名を調査しシート削除             ||07366  |''        'シート名を調査しシート削除             
07394  |''        For Ws_Del_Cnt = 1 To Ws_Cnt            ||07367  |''        For Ws_Del_Cnt = 1 To Ws_Cnt            
07395  |''            If Left(xlBook.Worksheets(Ws_Del_Cnt||07368  |''            If Left(xlBook.Worksheets(Ws_Del_Cnt
07396  |''                'シートの削除                   ||07369  |''                'シートの削除                   
07397  |''                xlBook.Worksheets(Ws_Del_Cnt).De||07370  |''                xlBook.Worksheets(Ws_Del_Cnt).De
07398  |''                Ws_Del_Cnt = Ws_Del_Cnt - 1     ||07371  |''                Ws_Del_Cnt = Ws_Del_Cnt - 1     
07399  |''                Ws_Del_Cnt2 = Ws_Del_Cnt2 + 1   ||07372  |''                Ws_Del_Cnt2 = Ws_Del_Cnt2 + 1   
07400  |''                If Ws_Del_Cnt2 = 2 Then         ||07373  |''                If Ws_Del_Cnt2 = 2 Then         
07401  |''                    Exit For                    ||07374  |''                    Exit For                    
07402  |''                End If                          ||07375  |''                End If                          
07403  |''            End If                              ||07376  |''            End If                              
07404  |''        Next Ws_Del_Cnt                         ||07377  |''        Next Ws_Del_Cnt                         
07405  |''                                                ||07378  |''                                                
07406  |''        '見易いようにシートの1枚目を選択する    ||07379  |''        '見易いようにシートの1枚目を選択する    
07407  |''        xlBook.Worksheets(1).Select             ||07380  |''        xlBook.Worksheets(1).Select             
07408  |''                                                ||07381  |''                                                
07409  |''        xlBook.SaveAs mstrFileName              ||07382  |''        xlBook.SaveAs mstrFileName              
07410  |''        xlBook.Close                            ||07383  |''        xlBook.Close                            
07411  |''        xlApp.Quit                              ||07384  |''        xlApp.Quit                              
07412  |''                                                ||07385  |''                                                
07413  |''        Set xlApp = Nothing                     ||07386  |''        Set xlApp = Nothing                     
07414  |''        Set xlBook = Nothing                    ||07387  |''        Set xlBook = Nothing                    
07415  |''        Set xlSheet = Nothing                   ||07388  |''        Set xlSheet = Nothing                   
07416  |''                                                ||07389  |''                                                
07417  |''        '処理回数カウンターの初期化             ||07390  |''        '処理回数カウンターの初期化             
07418  |''        gProcessCnt = 0                         ||07391  |''        gProcessCnt = 0                         
07419  |''        '保存ファイル名の修正                   ||07392  |''        '保存ファイル名の修正                   
07420  |''        gSaveFileCnt = gSaveFileCnt + 1         ||07393  |''        gSaveFileCnt = gSaveFileCnt + 1         
07421  |''        mstrFileName = mstrFileNameBK & " (" & g||07394  |''        mstrFileName = mstrFileNameBK & " (" & g
07422  |''    End If                                      ||07395  |''    End If                                      
07423  |'                                                 ||07396  |'                                                 
07424  |'    '2006/04/12 START K.Furuya 実払管理テーブル更||07397  |'    '2006/04/12 START K.Furuya 実払管理テーブル更
07425  |'    '実払管理テーブル更新処理実行                ||07398  |'    '実払管理テーブル更新処理実行                
07426  |'    If fncOtherRealComUpdateInsert(WkContractNo, ||07399  |'    If fncOtherRealComUpdateInsert(WkContractNo, 
07427  |'        intRtn = MsgBox("契約番号：" & WkContract||07400  |'        intRtn = MsgBox("契約番号：" & WkContract
07428  |'                    "の確定額の更新に失敗しました||07401  |'                    "の確定額の更新に失敗しました
07429  |'    End If                                       ||07402  |'    End If                                       
07430  |'    '2006/04/12 END   K.Furuya 実払管理テーブル更||07403  |'    '2006/04/12 END   K.Furuya 実払管理テーブル更
07431  |'                                                 ||07404  |'                                                 
07432  |'    '正常戻り値セット                            ||07405  |'    '正常戻り値セット                            
07433  |'    fnblExcelOut = True                          ||07406  |'    fnblExcelOut = True                          
07434  |'    GoTo EndProc                                 ||07407  |'    GoTo EndProc                                 
07435  |'                                                 ||07408  |'                                                 
07436  |'ErrorTrap:                                       ||07409  |'ErrorTrap:                                       
07437  |'    ' Excel を起動できない場合に発生するエラーを ||07410  |'    ' Excel を起動できない場合に発生するエラーを 
07438  |'    Select Case Err.Number                       ||07411  |'    Select Case Err.Number                       
07439  |'        Case 440               ' オートメーション||07412  |'        Case 440               ' オートメーション
07440  |'            iTries = iTries + 1                  ||07413  |'            iTries = iTries + 1                  
07441  |'            ' Excel の再起動を 5 回まで行います。||07414  |'            ' Excel の再起動を 5 回まで行います。
07442  |'            If iTries < 5 Then                   ||07415  |'            If iTries < 5 Then                   
07443  |'               Set xlApp = New Excel.Application ||07416  |'               Set xlApp = New Excel.Application 
07444  |'               Resume                            ||07417  |'               Resume                            
07445  |'            Else                                 ||07418  |'            Else                                 
07446  |'               Err.Raise Number:=vbObjectError + ||07419  |'               Err.Raise Number:=vbObjectError + 
07447  |'               Description:="Microsoft Excel を起||07420  |'               Description:="Microsoft Excel を起
07448  |'            End If                               ||07421  |'            End If                               
07449  |'        Case Else                                ||07422  |'        Case Else                                
07450  |'    End Select                                   ||07423  |'    End Select                                   
07451  |'                                                 ||07424  |'                                                 
07452  |'    'Workbookを閉じる                            ||07425  |'    'Workbookを閉じる                            
07453  |'    xlBook.Close                                 ||07426  |'    xlBook.Close                                 
07454  |'                                                 ||07427  |'                                                 
07455  |'    'Excel終了                                   ||07428  |'    'Excel終了                                   
07456  |'    xlApp.Quit                                   ||07429  |'    xlApp.Quit                                   
07457  |'                                                 ||07430  |'                                                 
07458  |'    'オブジェクトの解放                          ||07431  |'    'オブジェクトの解放                          
07459  |'    Set xlApp = Nothing                          ||07432  |'    Set xlApp = Nothing                          
07460  |'    Set xlBook = Nothing                         ||07433  |'    Set xlBook = Nothing                         
07461  |'    Set xlSheet = Nothing                        ||07434  |'    Set xlSheet = Nothing                        
07462  |'                                                 ||07435  |'                                                 
07463  |'OnErrorProc:                                     ||07436  |'OnErrorProc:                                     
07464  |'    Call subError("システムエラー", Str(Err.Numbe||07437  |'    Call subError("システムエラー", Str(Err.Numbe
07465  |'        Error, strErrCall, conTitle)             ||07438  |'        Error, strErrCall, conTitle)             
07466  |'    'マウスポインター元に戻す                    ||07439  |'    'マウスポインター元に戻す                    
07467  |'    Screen.MousePointer = vbDefault              ||07440  |'    Screen.MousePointer = vbDefault              
07468  |'    GoTo EndProc                                 ||07441  |'    GoTo EndProc                                 
07469  |'                                                 ||07442  |'                                                 
07470  |'EndProc:                                         ||07443  |'EndProc:                                         
07471  |                                                  ||07444  |                                                  
07472  |'#################################################||07445  |'#################################################
07473  |'2006/07/03 END   K.Furuya 期中料率変更契約/RAFI対||07446  |'2006/07/03 END   K.Furuya 期中料率変更契約/RAFI対
07474  |'#################################################||07447  |'#################################################
07475  |                                                  ||07448  |                                                  
07476  |                                                  ||07449  |                                                  
07477  |End Function                                      ||07450  |End Function                                      
07478  |'                                                 ||07451  |'                                                 
07479  |'=================================================||07452  |'=================================================
07480  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelEnglishOut          ||07453  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelEnglishOut          
07481  |'機能            :   確認書(英文)のExcel出力      ||07454  |'機能            :   確認書(英文)のExcel出力      
07482  |'                                                 ||07455  |'                                                 
07483  |'日付               担当　              修正内容  ||07456  |'日付               担当　              修正内容  
07484  |'-------------------------------------------------||07457  |'-------------------------------------------------
07485  |'2005/07/28         K.Nishihama<SRA>   新規作成   ||07458  |'2005/07/28         K.Nishihama<SRA>   新規作成   
07486  |'2006/08/18         K.Furuya <SRA>     期中料率変 ||07459  |'2006/08/18         K.Furuya <SRA>     期中料率変 
07487  |'                                      ソースが煩 ||07460  |'                                      ソースが煩 
07488  |'                                      作り変えの ||07461  |'                                      作り変えの 
07489  |'=================================================||07462  |'=================================================
07490  |Private Function fnblExcelEnglishOut( _           ||07463  |Private Function fnblExcelEnglishOut( _           
07491  |    ByVal lRecIdx As Long _                       ||07464  |    ByVal lRecIdx As Long _                       
07492  |) As Boolean                                      ||07465  |) As Boolean                                      
07493  |                                                  ||07466  |                                                  
07494  |'    Dim dStart      As Date     '計算期間　開始日||07467  |'    Dim dStart      As Date     '計算期間　開始日
07495  |'    Dim dEnd        As Date     '計算期間　終了日||07468  |'    Dim dEnd        As Date     '計算期間　終了日
07496  |'    Dim sSql        As String                    ||07469  |'    Dim sSql        As String                    
07497  |'    Dim sCurrencyCode As String '通貨コード(SQL文||07470  |'    Dim sCurrencyCode As String '通貨コード(SQL文
07498  |'    Dim AccCode     As String   '口座コード(SQL文||07471  |'    Dim AccCode     As String   '口座コード(SQL文
07499  |'    Dim sDate       As Date     '支払予定日      ||07472  |'    Dim sDate       As Date     '支払予定日      
07500  |'    Dim sName       As String   '担当者名        ||07473  |'    Dim sName       As String   '担当者名        
07501  |'    Dim i           As Integer  'カウンター      ||07474  |'    Dim i           As Integer  'カウンター      
07502  |'    Dim ColNum      As Integer  '部署名コンボボッ||07475  |'    Dim ColNum      As Integer  '部署名コンボボッ
07503  |'    Dim ColWord     As String   '部署名コンボボッ||07476  |'    Dim ColWord     As String   '部署名コンボボッ
07504  |'    Dim iSyouhizei  As Long     '消費税          ||07477  |'    Dim iSyouhizei  As Long     '消費税          
07505  |'    Dim iRowCnt     As Long     '月末純資産データ||07478  |'    Dim iRowCnt     As Long     '月末純資産データ
07506  |'    Dim TotalNav    As Currency '累積NAV         ||07479  |'    Dim TotalNav    As Currency '累積NAV         
07507  |'    Dim TotalRate   As Currency '累積閾値        ||07480  |'    Dim TotalRate   As Currency '累積閾値        
07508  |'    Dim cRate       As Currency '料率            ||07481  |'    Dim cRate       As Currency '料率            
07509  |'    Dim WorkRate    As Currency '一つ前の累積閾値||07482  |'    Dim WorkRate    As Currency '一つ前の累積閾値
07510  |'    Dim TotalCom    As Currency '累積投資顧問料  ||07483  |'    Dim TotalCom    As Currency '累積投資顧問料  
07511  |'    Dim lTaxNum     As Currency '消費税値        ||07484  |'    Dim lTaxNum     As Currency '消費税値        
07512  |'    Dim lMonthlyPayCom As Currency  '月別支払額  ||07485  |'    Dim lMonthlyPayCom As Currency  '月別支払額  
07513  |'    Dim lCalcNav    As Currency '計算対象NAV     ||07486  |'    Dim lCalcNav    As Currency '計算対象NAV     
07514  |'    Dim iCalcNum    As Integer  '計算期間日数    ||07487  |'    Dim iCalcNum    As Integer  '計算期間日数    
07515  |'    'Excel の Application 変数とエラーをトラップ ||07488  |'    'Excel の Application 変数とエラーをトラップ 
07516  |'    Dim iTries      As Integer                   ||07489  |'    Dim iTries      As Integer                   
07517  |'    Dim strErrCall      As String 'エラー呼出元  ||07490  |'    Dim strErrCall      As String 'エラー呼出元  
07518  |'    Const conMeModule   As String = "fnblExcelEng||07491  |'    Const conMeModule   As String = "fnblExcelEng
07519  |'    'Excel の Worksheet 削除用カウンタ変数       ||07492  |'    'Excel の Worksheet 削除用カウンタ変数       
07520  |'    Dim Ws_Cnt      As Integer                   ||07493  |'    Dim Ws_Cnt      As Integer                   
07521  |'    Dim Ws_Del_Cnt  As Integer                   ||07494  |'    Dim Ws_Del_Cnt  As Integer                   
07522  |'    Dim Ws_Del_Cnt2 As Integer                   ||07495  |'    Dim Ws_Del_Cnt2 As Integer                   
07523  |'    Dim ContNo      As String   '契約番号(SQL文作||07496  |'    Dim ContNo      As String   '契約番号(SQL文作
07524  |'    Dim NavGetCnt   As Long                      ||07497  |'    Dim NavGetCnt   As Long                      
07525  |'    Dim sGetAccCode As String                    ||07498  |'    Dim sGetAccCode As String                    
07526  |'    Dim Mnav_Flg    As String                    ||07499  |'    Dim Mnav_Flg    As String                    
07527  |'    Dim sStart As String            '計算対象　開||07500  |'    Dim sStart As String            '計算対象　開
07528  |'    Dim sEnd As String              '計算対象　終||07501  |'    Dim sEnd As String              '計算対象　終
07529  |'    Dim dstrBasedate As String      '基準日用ワー||07502  |'    Dim dstrBasedate As String      '基準日用ワー
07530  |'    Dim dstrCaldate() As String     'カレンダー日||07503  |'    Dim dstrCaldate() As String     'カレンダー日
07531  |'    Dim ddblDailynav() As Double    '日次NAV用格 ||07504  |'    Dim ddblDailynav() As Double    '日次NAV用格 
07532  |'    Dim dlngCnt As Long             '計算対象期間||07505  |'    Dim dlngCnt As Long             '計算対象期間
07533  |'    Dim dstrCaldate2 As String      'カレンダー日||07506  |'    Dim dstrCaldate2 As String      'カレンダー日
07534  |'    Dim dstrBasedate2 As String     '基準日(/編集||07507  |'    Dim dstrBasedate2 As String     '基準日(/編集
07535  |'    Dim dlngDiffdate As Long        'カレンダー日||07508  |'    Dim dlngDiffdate As Long        'カレンダー日
07536  |'    Dim dintFor As Integer          'For文用変数 ||07509  |'    Dim dintFor As Integer          'For文用変数 
07537  |'    Dim ddblTtalnav As Double       '日次NAV累積 ||07510  |'    Dim ddblTtalnav As Double       '日次NAV累積 
07538  |'    Dim dstrAvgNav As String                     ||07511  |'    Dim dstrAvgNav As String                     
07539  |'    Dim ddblNearNav As Double                    ||07512  |'    Dim ddblNearNav As Double                    
07540  |'    Dim dstrAccCd() As String                    ||07513  |'    Dim dstrAccCd() As String                    
07541  |'    Dim dstrBsCCd() As String                    ||07514  |'    Dim dstrBsCCd() As String                    
07542  |'    Dim intRtn      As Integer                   ||07515  |'    Dim intRtn      As Integer                   
07543  |'    Dim dstrDate         As String               ||07516  |'    Dim dstrDate         As String               
07544  |'    Dim dstrCurrencyCode As String               ||07517  |'    Dim dstrCurrencyCode As String               
07545  |'    Dim ddblExchangeRate As Double               ||07518  |'    Dim ddblExchangeRate As Double               
07546  |'    Dim dintPage    As Integer                   ||07519  |'    Dim dintPage    As Integer                   
07547  |'    Dim dintPageIni As Integer                   ||07520  |'    Dim dintPageIni As Integer                   
07548  |'    Dim dintAmari   As Integer                   ||07521  |'    Dim dintAmari   As Integer                   
07549  |'    Dim dCalDate    As Date                      ||07522  |'    Dim dCalDate    As Date                      
07550  |'    Dim J           As Integer                   ||07523  |'    Dim J           As Integer                   
07551  |'    Dim K           As Integer                   ||07524  |'    Dim K           As Integer                   
07552  |'    Dim L           As Integer                   ||07525  |'    Dim L           As Integer                   
07553  |'    Dim AvgNav      As Currency                  ||07526  |'    Dim AvgNav      As Currency                  
07554  |'    Dim dintFor2    As Integer                   ||07527  |'    Dim dintFor2    As Integer                   
07555  |'    Dim dlngMeisyoSu As Integer                  ||07528  |'    Dim dlngMeisyoSu As Integer                  
07556  |'    Dim dlngCntsv As Long                        ||07529  |'    Dim dlngCntsv As Long                        
07557  |'                                                 ||07530  |'                                                 
07558  |'    '戻り値初期化                                ||07531  |'    '戻り値初期化                                
07559  |'    fnblExcelEnglishOut = False                  ||07532  |'    fnblExcelEnglishOut = False                  
07560  |'    i = 0                                        ||07533  |'    i = 0                                        
07561  |'                                                 ||07534  |'                                                 
07562  |'On Error Resume Next                             ||07535  |'On Error Resume Next                             
07563  |'                                                 ||07536  |'                                                 
07564  |'    Set xlSheet = xlBook.Sheets(gProcessCnt)     ||07537  |'    Set xlSheet = xlBook.Sheets(gProcessCnt)     
07565  |'                                                 ||07538  |'                                                 
07566  |'    'Excelフォーマットを調整                     ||07539  |'    'Excelフォーマットを調整                     
07567  |'    xlSheet.Cells.ColumnWidth = 1                ||07540  |'    xlSheet.Cells.ColumnWidth = 1                
07568  |'    xlSheet.Cells.Font.Size = 11                 ||07541  |'    xlSheet.Cells.Font.Size = 11                 
07569  |'    'シート名を設定(確認書**)                    ||07542  |'    'シート名を設定(確認書**)                    
07570  |'    xlBook.Sheets(gProcessCnt).Name = sWord33a & ||07543  |'    xlBook.Sheets(gProcessCnt).Name = sWord33a & 
07571  |'    'シートの余白を設定                          ||07544  |'    'シートの余白を設定                          
07572  |'    xlSheet.PageSetup.TopMargin = Application.Inc||07545  |'    xlSheet.PageSetup.TopMargin = Application.Inc
07573  |'    xlSheet.PageSetup.BottomMargin = Application.||07546  |'    xlSheet.PageSetup.BottomMargin = Application.
07574  |'    xlSheet.PageSetup.LeftMargin = Application.In||07547  |'    xlSheet.PageSetup.LeftMargin = Application.In
07575  |'    xlSheet.PageSetup.RightMargin = Application.I||07548  |'    xlSheet.PageSetup.RightMargin = Application.I
07576  |'                                                 ||07549  |'                                                 
07577  |'    DoEvents                                     ||07550  |'    DoEvents                                     
07578  |'    With xlSheet                                 ||07551  |'    With xlSheet                                 
07579  |'        '題目                                    ||07552  |'        '題目                                    
07580  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).||07553  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).
07581  |'            Case Mid(mstrContractFlag(1), 1, 1)  ||07554  |'            Case Mid(mstrContractFlag(1), 1, 1)  
07582  |'                .Cells(5, 1).Value = sWord0d     ||07555  |'                .Cells(5, 1).Value = sWord0d     
07583  |'            Case Mid(mstrContractFlag(2), 1, 1)  ||07556  |'            Case Mid(mstrContractFlag(2), 1, 1)  
07584  |'                .Cells(5, 1).Value = sWord0e     ||07557  |'                .Cells(5, 1).Value = sWord0e     
07585  |'            Case Mid(mstrContractFlag(3), 1, 1)  ||07558  |'            Case Mid(mstrContractFlag(3), 1, 1)  
07586  |'                .Cells(5, 1).Value = sWord0f     ||07559  |'                .Cells(5, 1).Value = sWord0f     
07587  |'            Case Else                            ||07560  |'            Case Else                            
07588  |'                MsgBox "契約区分が不正です。", vb||07561  |'                MsgBox "契約区分が不正です。", vb
07589  |'        End Select                               ||07562  |'        End Select                               
07590  |'        .Cells(5, 1).Font.Size = 14              ||07563  |'        .Cells(5, 1).Font.Size = 14              
07591  |'        .Range("A5:BG5").HorizontalAlignment = xl||07564  |'        .Range("A5:BG5").HorizontalAlignment = xl
07592  |'                                                 ||07565  |'                                                 
07593  |'        '出力日付                                ||07566  |'        '出力日付                                
07594  |'        If RTrim(txtSysOutDate.Text) = "" Then   ||07567  |'        If RTrim(txtSysOutDate.Text) = "" Then   
07595  |'            .Cells(3, 50).Value = sWord34a       ||07568  |'            .Cells(3, 50).Value = sWord34a       
07596  |'            .Cells(3, 50).HorizontalAlignment = x||07569  |'            .Cells(3, 50).HorizontalAlignment = x
07597  |'        Else                                     ||07570  |'        Else                                     
07598  |'            .Cells(3, 43).NumberFormatLocal = "@"||07571  |'            .Cells(3, 43).NumberFormatLocal = "@"
07599  |'            .Cells(3, 43).Value = CStr(Format(txt||07572  |'            .Cells(3, 43).Value = CStr(Format(txt
07600  |'        End If                                   ||07573  |'        End If                                   
07601  |'                                                 ||07574  |'                                                 
07602  |'        '下記のとおり･･･                         ||07575  |'        '下記のとおり･･･                         
07603  |'        .Cells(7, 2).Value = "Dear Sirs,"        ||07576  |'        .Cells(7, 2).Value = "Dear Sirs,"        
07604  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).||07577  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).
07605  |'            Case Mid(mstrContractFlag(1), 1, 1)  ||07578  |'            Case Mid(mstrContractFlag(1), 1, 1)  
07606  |'                .Cells(8, 2).Value = sWord3d     ||07579  |'                .Cells(8, 2).Value = sWord3d     
07607  |'            Case Mid(mstrContractFlag(2), 1, 1)  ||07580  |'            Case Mid(mstrContractFlag(2), 1, 1)  
07608  |'                .Cells(8, 2).Value = sWord3e     ||07581  |'                .Cells(8, 2).Value = sWord3e     
07609  |'            Case Mid(mstrContractFlag(3), 1, 1)  ||07582  |'            Case Mid(mstrContractFlag(3), 1, 1)  
07610  |'                .Cells(8, 2).Value = sWord3f     ||07583  |'                .Cells(8, 2).Value = sWord3f     
07611  |'            Case Else                            ||07584  |'            Case Else                            
07612  |'        End Select                               ||07585  |'        End Select                               
07613  |'                                                 ||07586  |'                                                 
07614  |'        'ファンド名                              ||07587  |'        'ファンド名                              
07615  |'        .Cells(10, 2).Value = sWord4a            ||07588  |'        .Cells(10, 2).Value = sWord4a            
07616  |'        .Cells(10, 11).Value = sWord19           ||07589  |'        .Cells(10, 11).Value = sWord19           
07617  |'        .Cells(10, 13).Value = gbuMGetUPDRec.N(lR||07590  |'        .Cells(10, 13).Value = gbuMGetUPDRec.N(lR
07618  |'                                                 ||07591  |'                                                 
07619  |'        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_co||07592  |'        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_co
07620  |'        sSql = gstrEditSQLcfr_NavGetForSelectList||07593  |'        sSql = gstrEditSQLcfr_NavGetForSelectList
07621  |'        'ﾀﾞｲﾅｾｯﾄの作成                           ||07594  |'        'ﾀﾞｲﾅｾｯﾄの作成                           
07622  |'        If gintDyCreate(sSql) = False Then       ||07595  |'        If gintDyCreate(sSql) = False Then       
07623  |'            Exit Function                        ||07596  |'            Exit Function                        
07624  |'        End If                                   ||07597  |'        End If                                   
07625  |'        Do Until gblnDyEOF()                     ||07598  |'        Do Until gblnDyEOF()                     
07626  |'            '動的配列更新                        ||07599  |'            '動的配列更新                        
07627  |'            ReDim Preserve gtypcfr_navget_tbl(0 T||07600  |'            ReDim Preserve gtypcfr_navget_tbl(0 T
07628  |'            ReDim Preserve dstrAccCd(0 To NavGetC||07601  |'            ReDim Preserve dstrAccCd(0 To NavGetC
07629  |'                                                 ||07602  |'                                                 
07630  |'            'NAV取得抽出                         ||07603  |'            'NAV取得抽出                         
07631  |'            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT||07604  |'            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT
07632  |'            If NavGetCnt > 0 Then                ||07605  |'            If NavGetCnt > 0 Then                
07633  |'                sGetAccCode = sGetAccCode & " , "||07606  |'                sGetAccCode = sGetAccCode & " , "
07634  |'            Else                                 ||07607  |'            Else                                 
07635  |'                sGetAccCode = sGetAccCode & gtypc||07608  |'                sGetAccCode = sGetAccCode & gtypc
07636  |'            End If                               ||07609  |'            End If                               
07637  |'                                                 ||07610  |'                                                 
07638  |'            '口座コードの格納(１契約複数口座の場 ||07611  |'            '口座コードの格納(１契約複数口座の場 
07639  |'            dstrAccCd(NavGetCnt) = gtypcfr_navget||07612  |'            dstrAccCd(NavGetCnt) = gtypcfr_navget
07640  |'            NavGetCnt = NavGetCnt + 1            ||07613  |'            NavGetCnt = NavGetCnt + 1            
07641  |'            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                    ||07614  |'            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                    
07642  |'            Call gDyNext                         ||07615  |'            Call gDyNext                         
07643  |'        Loop                                     ||07616  |'        Loop                                     
07644  |'        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                        ||07617  |'        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                        
07645  |'        Call gblnDyClose                         ||07618  |'        Call gblnDyClose                         
07646  |'                                                 ||07619  |'                                                 
07647  |'        '１契約複数口座の場合に口座のベース通貨に||07620  |'        '１契約複数口座の場合に口座のベース通貨に
07648  |'        ReDim dstrBsCCd(0 To NavGetCnt - 1)      ||07621  |'        ReDim dstrBsCCd(0 To NavGetCnt - 1)      
07649  |'        If NavGetCnt - 1 > 0 Then                ||07622  |'        If NavGetCnt - 1 > 0 Then                
07650  |'            For dintFor = 0 To NavGetCnt - 1     ||07623  |'            For dintFor = 0 To NavGetCnt - 1     
07651  |'                sSql = ""                        ||07624  |'                sSql = ""                        
07652  |'                sSql = sSql & "SELECT ACCOUNT_COD||07625  |'                sSql = sSql & "SELECT ACCOUNT_COD
07653  |'                sSql = sSql & "WHERE ACCOUNT_CODE||07626  |'                sSql = sSql & "WHERE ACCOUNT_CODE
07654  |'                'ﾀﾞｲﾅｾｯﾄの作成                   ||07627  |'                'ﾀﾞｲﾅｾｯﾄの作成                   
07655  |'                If gintDyCreate(sSql) = False The||07628  |'                If gintDyCreate(sSql) = False The
07656  |'                    Exit Function                ||07629  |'                    Exit Function                
07657  |'                Else                             ||07630  |'                Else                             
07658  |'                    dstrBsCCd(dintFor) = gvlnDyDa||07631  |'                    dstrBsCCd(dintFor) = gvlnDyDa
07659  |'                End If                           ||07632  |'                End If                           
07660  |'                If dintFor > 0 Then              ||07633  |'                If dintFor > 0 Then              
07661  |'                    If dstrBsCCd(dintFor) <> dstr||07634  |'                    If dstrBsCCd(dintFor) <> dstr
07662  |'                        intRtn = MsgBox("ファンド||07635  |'                        intRtn = MsgBox("ファンド
07663  |'                        Exit Function            ||07636  |'                        Exit Function            
07664  |'                    End If                       ||07637  |'                    End If                       
07665  |'                End If                           ||07638  |'                End If                           
07666  |'            Next dintFor                         ||07639  |'            Next dintFor                         
07667  |'                                                 ||07640  |'                                                 
07668  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    ||07641  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    
07669  |'            Call gblnDyClose                     ||07642  |'            Call gblnDyClose                     
07670  |'                                                 ||07643  |'                                                 
07671  |'        End If                                   ||07644  |'        End If                                   
07672  |'                                                 ||07645  |'                                                 
07673  |'        'ファンドコード                          ||07646  |'        'ファンドコード                          
07674  |'        .Cells(11, 2).Value = sWord4_2a          ||07647  |'        .Cells(11, 2).Value = sWord4_2a          
07675  |'        .Cells(11, 11).Value = sWord19           ||07648  |'        .Cells(11, 11).Value = sWord19           
07676  |'        .Cells(11, 13).NumberFormatLocal = "@"   ||07649  |'        .Cells(11, 13).NumberFormatLocal = "@"   
07677  |'        .Cells(11, 13).Value = sGetAccCode       ||07650  |'        .Cells(11, 13).Value = sGetAccCode       
07678  |'                                                 ||07651  |'                                                 
07679  |'        '計算期間                                ||07652  |'        '計算期間                                
07680  |'        .Cells(13, 2).Value = sWord5a            ||07653  |'        .Cells(13, 2).Value = sWord5a            
07681  |'        .Cells(13, 11).Value = sWord19           ||07654  |'        .Cells(13, 11).Value = sWord19           
07682  |'                                                 ||07655  |'                                                 
07683  |'        '前回締日・直近締日セット                ||07656  |'        '前回締日・直近締日セット                
07684  |'        dStart = CDate(gstrDateFormat(mstrSettlem||07657  |'        dStart = CDate(gstrDateFormat(mstrSettlem
07685  |'        dEnd = CDate(gstrDateFormat(mstrNearSettl||07658  |'        dEnd = CDate(gstrDateFormat(mstrNearSettl
07686  |'        dstrDate = Replace(CStr(dEnd), "/", "")  ||07659  |'        dstrDate = Replace(CStr(dEnd), "/", "")  
07687  |'        iCalcNum = DateDiff("d", dStart, dEnd) + ||07660  |'        iCalcNum = DateDiff("d", dStart, dEnd) + 
07688  |'                                                 ||07661  |'                                                 
07689  |'        '年率                                    ||07662  |'        '年率                                    
07690  |'        .Cells(15, 2).Value = sWord10a           ||07663  |'        .Cells(15, 2).Value = sWord10a           
07691  |'        .Cells(15, 11).Value = sWord19           ||07664  |'        .Cells(15, 11).Value = sWord19           
07692  |'                                                 ||07665  |'                                                 
07693  |'        '月末純資産                              ||07666  |'        '月末純資産                              
07694  |'        .Cells(27, 2).Value = sWord6a            ||07667  |'        .Cells(27, 2).Value = sWord6a            
07695  |'        .Cells(27, 21).Value = sWord19           ||07668  |'        .Cells(27, 21).Value = sWord19           
07696  |'                                                 ||07669  |'                                                 
07697  |'        '@@@@@ 合計行を出力しないならここをコメン||07670  |'        '@@@@@ 合計行を出力しないならここをコメン
07698  |'        '合計(純資産)                            ||07671  |'        '合計(純資産)                            
07699  |'        .Cells(40, 25).Value = sWord9a           ||07672  |'        .Cells(40, 25).Value = sWord9a           
07700  |'        .Range("X40:AI40").HorizontalAlignment = ||07673  |'        .Range("X40:AI40").HorizontalAlignment = 
07701  |'                                                 ||07674  |'                                                 
07702  |''        '契約区分「1」or「2」                   ||07675  |''        '契約区分「1」or「2」                   
07703  |''        '契約区分「1」or「2」or (「3」and 取得NA||07676  |''        '契約区分「1」or「2」or (「3」and 取得NA
07704  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||07677  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
07705  |'        Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||07678  |'        Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
07706  |'        Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_con||07679  |'        Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_con
07707  |'                                                 ||07680  |'                                                 
07708  |'            '月末NAV取得                         ||07681  |'            '月末NAV取得                         
07709  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_||07682  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_
07710  |'                '月次NAVを累積                   ||07683  |'                '月次NAVを累積                   
07711  |'                For i = LBound(gtypcfr_mnav_tbl) ||07684  |'                For i = LBound(gtypcfr_mnav_tbl) 
07712  |'                    If Len(gtypcfr_mnav_tbl(i).BA||07685  |'                    If Len(gtypcfr_mnav_tbl(i).BA
07713  |'                        '日付                    ||07686  |'                        '日付                    
07714  |'                         gtypcfr_mnav_tbl(i).BASE||07687  |'                         gtypcfr_mnav_tbl(i).BASE
07715  |'                        .Cells(27 + i, 25).Value ||07688  |'                        .Cells(27 + i, 25).Value 
07716  |'                        '純資産                  ||07689  |'                        '純資産                  
07717  |'                        .Cells(27 + i, 49).Number||07690  |'                        .Cells(27 + i, 49).Number
07718  |'                                                 ||07691  |'                                                 
07719  |'                        If gbuMGetUPDRec.N(lRecId||07692  |'                        If gbuMGetUPDRec.N(lRecId
07720  |'                            .Cells(27 + i, 49).Va||07693  |'                            .Cells(27 + i, 49).Va
07721  |'                        Else                     ||07694  |'                        Else                     
07722  |'                            .Cells(27 + i, 49).Va||07695  |'                            .Cells(27 + i, 49).Va
07723  |'                        End If                   ||07696  |'                        End If                   
07724  |'                        .Cells(27 + i, 49).Horizo||07697  |'                        .Cells(27 + i, 49).Horizo
07725  |'                                                 ||07698  |'                                                 
07726  |'                        TotalNav = TotalNav + CCu||07699  |'                        TotalNav = TotalNav + CCu
07727  |'                        iRowCnt = iRowCnt + 1    ||07700  |'                        iRowCnt = iRowCnt + 1    
07728  |'                    Else                         ||07701  |'                    Else                         
07729  |'                        Mnav_Flg = 1             ||07702  |'                        Mnav_Flg = 1             
07730  |'                    End If                       ||07703  |'                    End If                       
07731  |'                                                 ||07704  |'                                                 
07732  |'                Next i                           ||07705  |'                Next i                           
07733  |'                                                 ||07706  |'                                                 
07734  |'                '保留★★（1を引く意味がわからな ||07707  |'                '保留★★（1を引く意味がわからな 
07735  |'                '日次NAVを算出                   ||07708  |'                '日次NAVを算出                   
07736  |''                If Mnav_Flg = 1 Then            ||07709  |''                If Mnav_Flg = 1 Then            
07737  |''                    i = i - 1                   ||07710  |''                    i = i - 1                   
07738  |''                End If                          ||07711  |''                End If                          
07739  |'                                                 ||07712  |'                                                 
07740  |'                If mstrDailyNav <> "" Then       ||07713  |'                If mstrDailyNav <> "" Then       
07741  |'                    '日付                        ||07714  |'                    '日付                        
07742  |'                    .Cells(27 + i, 25).NumberForm||07715  |'                    .Cells(27 + i, 25).NumberForm
07743  |'                    .Cells(27 + i, 25).Value = CS||07716  |'                    .Cells(27 + i, 25).Value = CS
07744  |'                    .Cells(27 + i, 25).Horizontal||07717  |'                    .Cells(27 + i, 25).Horizontal
07745  |'                    '純資産                      ||07718  |'                    '純資産                      
07746  |'                    .Cells(27 + i, 49).NumberForm||07719  |'                    .Cells(27 + i, 49).NumberForm
07747  |'                                                 ||07720  |'                                                 
07748  |'                    If gbuMGetUPDRec.N(lRecIdx).M||07721  |'                    If gbuMGetUPDRec.N(lRecIdx).M
07749  |'                        .Cells(27 + i, 49).Value ||07722  |'                        .Cells(27 + i, 49).Value 
07750  |'                    Else                         ||07723  |'                    Else                         
07751  |'                        .Cells(27 + i, 49).Value ||07724  |'                        .Cells(27 + i, 49).Value 
07752  |'                    End If                       ||07725  |'                    End If                       
07753  |'                                                 ||07726  |'                                                 
07754  |'                    .Cells(27 + i, 49).Horizontal||07727  |'                    .Cells(27 + i, 49).Horizontal
07755  |'                    TotalNav = TotalNav + CCur(ms||07728  |'                    TotalNav = TotalNav + CCur(ms
07756  |'                    iRowCnt = iRowCnt + 1        ||07729  |'                    iRowCnt = iRowCnt + 1        
07757  |'                                                 ||07730  |'                                                 
07758  |'                End If                           ||07731  |'                End If                           
07759  |'                                                 ||07732  |'                                                 
07760  |'                '@@@@@ 合計行を出力しないならここ||07733  |'                '@@@@@ 合計行を出力しないならここ
07761  |'                .Cells(40, 49).NumberFormatLocal ||07734  |'                .Cells(40, 49).NumberFormatLocal 
07762  |'                .Cells(40, 49).Value = CStr(Forma||07735  |'                .Cells(40, 49).Value = CStr(Forma
07763  |'                                                 ||07736  |'                                                 
07764  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET||07737  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET
07765  |'                    '@@@@@ 合計行を出力しないなら||07738  |'                    '@@@@@ 合計行を出力しないなら
07766  |'                    .Cells(40, 49).Value = CStr(F||07739  |'                    .Cells(40, 49).Value = CStr(F
07767  |'                 Else                            ||07740  |'                 Else                            
07768  |'                    '合計行を出力しないならここを||07741  |'                    '合計行を出力しないならここを
07769  |'                    .Cells(40, 49).Value = CStr(F||07742  |'                    .Cells(40, 49).Value = CStr(F
07770  |'                 End If                          ||07743  |'                 End If                          
07771  |'                 .Cells(40, 49).HorizontalAlignme||07744  |'                 .Cells(40, 49).HorizontalAlignme
07772  |'                                                 ||07745  |'                                                 
07773  |'                 '平均純資産総額                 ||07746  |'                 '平均純資産総額                 
07774  |'                 .Cells(43, 2).Value = sWord51a  ||07747  |'                 .Cells(43, 2).Value = sWord51a  
07775  |'                 .Cells(43, 16).Value = sWord19  ||07748  |'                 .Cells(43, 16).Value = sWord19  
07776  |'                                                 ||07749  |'                                                 
07777  |'                 '計算期間の純資産総額の合計(月末||07750  |'                 '計算期間の純資産総額の合計(月末
07778  |'                 .Cells(43, 28).NumberFormatLocal||07751  |'                 .Cells(43, 28).NumberFormatLocal
07779  |'                                                 ||07752  |'                                                 
07780  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET||07753  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET
07781  |'                     .Cells(43, 28).Value = CStr(||07754  |'                     .Cells(43, 28).Value = CStr(
07782  |'                 Else                            ||07755  |'                 Else                            
07783  |'                     .Cells(43, 28).Value = CStr(||07756  |'                     .Cells(43, 28).Value = CStr(
07784  |'                 End If                          ||07757  |'                 End If                          
07785  |'                                                 ||07758  |'                                                 
07786  |'                 .Cells(43, 28).HorizontalAlignme||07759  |'                 .Cells(43, 28).HorizontalAlignme
07787  |'                                                 ||07760  |'                                                 
07788  |'                 '計算期間の純資産総額の合計÷計 ||07761  |'                 '計算期間の純資産総額の合計÷計 
07789  |'                 .Cells(43, 40).NumberFormatLocal||07762  |'                 .Cells(43, 40).NumberFormatLocal
07790  |'                 dblValueIn = TotalNav / iRowCnt ||07763  |'                 dblValueIn = TotalNav / iRowCnt 
07791  |'                                                 ||07764  |'                                                 
07792  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET||07765  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET
07793  |'                     Call sbGetRoundValue2(dblVal||07766  |'                     Call sbGetRoundValue2(dblVal
07794  |'                 Else                            ||07767  |'                 Else                            
07795  |'                     Call sbGetRoundValue(dblValu||07768  |'                     Call sbGetRoundValue(dblValu
07796  |'                 End If                          ||07769  |'                 End If                          
07797  |'                                                 ||07770  |'                                                 
07798  |'                '平均NAV(計算対象NAV)            ||07771  |'                '平均NAV(計算対象NAV)            
07799  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||07772  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
07800  |'                    .Cells(43, 40).Value = CStr(F||07773  |'                    .Cells(43, 40).Value = CStr(F
07801  |'                Else                             ||07774  |'                Else                             
07802  |'                    .Cells(43, 40).Value = CStr(F||07775  |'                    .Cells(43, 40).Value = CStr(F
07803  |'                End If                           ||07776  |'                End If                           
07804  |'                                                 ||07777  |'                                                 
07805  |'                '÷??＝                          ||07778  |'                '÷??＝                          
07806  |'                          .Cells(43, 31).Value = ||07779  |'                          .Cells(43, 31).Value = 
07807  |'                                                 ||07780  |'                                                 
07808  |'            Else                                 ||07781  |'            Else                                 
07809  |'                ddblTtalnav = 0                  ||07782  |'                ddblTtalnav = 0                  
07810  |'                For dintFor = 0 To NavGetCnt - 1 ||07783  |'                For dintFor = 0 To NavGetCnt - 1 
07811  |'                                                 ||07784  |'                                                 
07812  |'                    '日次NAV平均取得             ||07785  |'                    '日次NAV平均取得             
07813  |'                    sStart = gstrDateFormat2(CStr||07786  |'                    sStart = gstrDateFormat2(CStr
07814  |'                    sEnd = gstrDateFormat2(CStr(d||07787  |'                    sEnd = gstrDateFormat2(CStr(d
07815  |'                                                 ||07788  |'                                                 
07816  |'                    '計算開始日と外部委託顧問料計||07789  |'                    '計算開始日と外部委託顧問料計
07817  |'                    If sStart = gbuMGetUPDRec.N(l||07790  |'                    If sStart = gbuMGetUPDRec.N(l
07818  |'                        sSql = ""                ||07791  |'                        sSql = ""                
07819  |'                        sSql = sSql & "SELECT EIG||07792  |'                        sSql = sSql & "SELECT EIG
07820  |'                                                 ||07793  |'                                                 
07821  |'                        'ﾀﾞｲﾅｾｯﾄの作成           ||07794  |'                        'ﾀﾞｲﾅｾｯﾄの作成           
07822  |'                        If gintDyCreate(sSql) = F||07795  |'                        If gintDyCreate(sSql) = F
07823  |'                            Exit Function        ||07796  |'                            Exit Function        
07824  |'                         Else                    ||07797  |'                         Else                    
07825  |'                            '休日の場合、翌営業日||07798  |'                            '休日の場合、翌営業日
07826  |'                            If gvlnDyDataS("EIGYO||07799  |'                            If gvlnDyDataS("EIGYO
07827  |'                                sSql = ""        ||07800  |'                                sSql = ""        
07828  |'                                sSql = sSql & "SE||07801  |'                                sSql = sSql & "SE
07829  |'                                sSql = sSql & "FR||07802  |'                                sSql = sSql & "FR
07830  |'                                sSql = sSql & "(S||07803  |'                                sSql = sSql & "(S
07831  |'                                sSql = sSql & "WH||07804  |'                                sSql = sSql & "WH
07832  |'                                                 ||07805  |'                                                 
07833  |'                                'ﾀﾞｲﾅｾｯﾄの作成   ||07806  |'                                'ﾀﾞｲﾅｾｯﾄの作成   
07834  |'                                If gintDyCreate(s||07807  |'                                If gintDyCreate(s
07835  |'                                    Exit Function||07808  |'                                    Exit Function
07836  |'                                Else             ||07809  |'                                Else             
07837  |'                                    ddblNearNav =||07810  |'                                    ddblNearNav =
07838  |'                                    sSql = ""    ||07811  |'                                    sSql = ""    
07839  |'                                    sSql = sSql &||07812  |'                                    sSql = sSql &
07840  |'                                    sSql = sSql &||07813  |'                                    sSql = sSql &
07841  |'                                    sSql = sSql &||07814  |'                                    sSql = sSql &
07842  |'                                    sSql = sSql &||07815  |'                                    sSql = sSql &
07843  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||07816  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
07844  |'                                    If gintDyCrea||07817  |'                                    If gintDyCrea
07845  |'                                        Exit Func||07818  |'                                        Exit Func
07846  |'                                     Else        ||07819  |'                                     Else        
07847  |'                                        sStart = ||07820  |'                                        sStart = 
07848  |'                                        dStart = ||07821  |'                                        dStart = 
07849  |'                                        .Cells(16||07822  |'                                        .Cells(16
07850  |'                                            CStr(||07823  |'                                            CStr(
07851  |'                                        iCalcNum ||07824  |'                                        iCalcNum 
07852  |'                                    End If       ||07825  |'                                    End If       
07853  |'                                End If           ||07826  |'                                End If           
07854  |'                            End If               ||07827  |'                            End If               
07855  |'                        End If                   ||07828  |'                        End If                   
07856  |'                    End If                       ||07829  |'                    End If                       
07857  |'                        sSql = ""                ||07830  |'                        sSql = ""                
07858  |'                        sSql = sSql & "SELECT CAL||07831  |'                        sSql = sSql & "SELECT CAL
07859  |'                        sSql = sSql & "WHERE CAL_||07832  |'                        sSql = sSql & "WHERE CAL_
07860  |'                                                 ||07833  |'                                                 
07861  |'                        'ﾀﾞｲﾅｾｯﾄの作成           ||07834  |'                        'ﾀﾞｲﾅｾｯﾄの作成           
07862  |'                        If gintDyCreate(sSql) = F||07835  |'                        If gintDyCreate(sSql) = F
07863  |'                            Exit Function        ||07836  |'                            Exit Function        
07864  |'                        End If                   ||07837  |'                        End If                   
07865  |'                                                 ||07838  |'                                                 
07866  |'                        If dlngCnt = 0 Then      ||07839  |'                        If dlngCnt = 0 Then      
07867  |'                            ReDim dstrCaldate(gbx||07840  |'                            ReDim dstrCaldate(gbx
07868  |'                            ReDim ddblDailynav(gb||07841  |'                            ReDim ddblDailynav(gb
07869  |'                        End If                   ||07842  |'                        End If                   
07870  |'                                                 ||07843  |'                                                 
07871  |'                        'EOF判定処理             ||07844  |'                        'EOF判定処理             
07872  |'                        dlngCnt = 0              ||07845  |'                        dlngCnt = 0              
07873  |'                                                 ||07846  |'                                                 
07874  |'                        Do Until gblnDyEOF()     ||07847  |'                        Do Until gblnDyEOF()     
07875  |'                            dlngCnt = dlngCnt + 1||07848  |'                            dlngCnt = dlngCnt + 1
07876  |'                            '抽出データセット    ||07849  |'                            '抽出データセット    
07877  |'                            dstrCaldate(dlngCnt) ||07850  |'                            dstrCaldate(dlngCnt) 
07878  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    ||07851  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    
07879  |'                            Call gDyNext         ||07852  |'                            Call gDyNext         
07880  |'                        Loop                     ||07853  |'                        Loop                     
07881  |'                                                 ||07854  |'                                                 
07882  |'                        '2005/08/26　START       ||07855  |'                        '2005/08/26　START       
07883  |'                        '変数sStartに格納されてい||07856  |'                        '変数sStartに格納されてい
07884  |'                        '変数sStartの直近の営業日||07857  |'                        '変数sStartの直近の営業日
07885  |'                        '（変数sStartに格納されて||07858  |'                        '（変数sStartに格納されて
07886  |'                        '　直近日付が存在しない場||07859  |'                        '　直近日付が存在しない場
07887  |'                                                 ||07860  |'                                                 
07888  |'                        sSql = ""                ||07861  |'                        sSql = ""                
07889  |'                        sSql = sSql & "SELECT MAX||07862  |'                        sSql = sSql & "SELECT MAX
07890  |'                        sSql = sSql & "FROM   CFR||07863  |'                        sSql = sSql & "FROM   CFR
07891  |'                        sSql = sSql & "WHERE  BAS||07864  |'                        sSql = sSql & "WHERE  BAS
07892  |'                        sSql = sSql & "AND    ACC||07865  |'                        sSql = sSql & "AND    ACC
07893  |'                                                 ||07866  |'                                                 
07894  |'                        'ﾀﾞｲﾅｾｯﾄの作成           ||07867  |'                        'ﾀﾞｲﾅｾｯﾄの作成           
07895  |'                        If gintDyCreate(sSql) = F||07868  |'                        If gintDyCreate(sSql) = F
07896  |'                            Exit Function        ||07869  |'                            Exit Function        
07897  |'                        End If                   ||07870  |'                        End If                   
07898  |'                                                 ||07871  |'                                                 
07899  |'                        Do Until gblnDyEOF()     ||07872  |'                        Do Until gblnDyEOF()     
07900  |'                           '抽出データセット     ||07873  |'                           '抽出データセット     
07901  |'                            sStart = gvlnDyDataS(||07874  |'                            sStart = gvlnDyDataS(
07902  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    ||07875  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    
07903  |'                            Call gDyNext         ||07876  |'                            Call gDyNext         
07904  |'                        Loop                     ||07877  |'                        Loop                     
07905  |'                                                 ||07878  |'                                                 
07906  |'                        '2005/08/26　END         ||07879  |'                        '2005/08/26　END         
07907  |'                                                 ||07880  |'                                                 
07908  |'                        sSql = ""                ||07881  |'                        sSql = ""                
07909  |'                        sSql = sSql & "SELECT ACC||07882  |'                        sSql = sSql & "SELECT ACC
07910  |'                        sSql = sSql & "WHERE (((C||07883  |'                        sSql = sSql & "WHERE (((C
07911  |'                        sSql = sSql & "AND ((CFR_||07884  |'                        sSql = sSql & "AND ((CFR_
07912  |'                        sSql = sSql & "AND ((CFR_||07885  |'                        sSql = sSql & "AND ((CFR_
07913  |'                        sSql = sSql & "ORDER BY C||07886  |'                        sSql = sSql & "ORDER BY C
07914  |'                                                 ||07887  |'                                                 
07915  |'                        If gintDyCreate(sSql) = F||07888  |'                        If gintDyCreate(sSql) = F
07916  |'                            Exit Function        ||07889  |'                            Exit Function        
07917  |'                        End If                   ||07890  |'                        End If                   
07918  |'                                                 ||07891  |'                                                 
07919  |'                        dlngCntsv = dlngCnt      ||07892  |'                        dlngCntsv = dlngCnt      
07920  |'                        dlngCnt = 0              ||07893  |'                        dlngCnt = 0              
07921  |'                                                 ||07894  |'                                                 
07922  |'                        Do Until gblnDyEOF()     ||07895  |'                        Do Until gblnDyEOF()     
07923  |'                            dlngCnt = dlngCnt + 1||07896  |'                            dlngCnt = dlngCnt + 1
07924  |'                            '抽出データセット    ||07897  |'                            '抽出データセット    
07925  |'                            dstrBasedate = gvlnDy||07898  |'                            dstrBasedate = gvlnDy
07926  |'                            If Mid(dstrCaldate(dl||07899  |'                            If Mid(dstrCaldate(dl
07927  |'                                ddblDailynav(dlng||07900  |'                                ddblDailynav(dlng
07928  |'                            Else                 ||07901  |'                            Else                 
07929  |'                                '計算開始日が外部||07902  |'                                '計算開始日が外部
07930  |'                                If ddblNearNav <>||07903  |'                                If ddblNearNav <>
07931  |'                                And dlngCnt = 1 T||07904  |'                                And dlngCnt = 1 T
07932  |'                                    dstrCaldate2 ||07905  |'                                    dstrCaldate2 
07933  |'                                    dstrBasedate2||07906  |'                                    dstrBasedate2
07934  |'                                    dlngDiffdate ||07907  |'                                    dlngDiffdate 
07935  |'                                                 ||07908  |'                                                 
07936  |'                                    For dintFor2 ||07909  |'                                    For dintFor2 
07937  |'                                        ddblDaily||07910  |'                                        ddblDaily
07938  |'                                        dlngCnt =||07911  |'                                        dlngCnt =
07939  |'                                    Next dintFor2||07912  |'                                    Next dintFor2
07940  |'                                    ddblDailynav(||07913  |'                                    ddblDailynav(
07941  |'                                Else             ||07914  |'                                Else             
07942  |'                                    '日次NAVにデ ||07915  |'                                    '日次NAVにデ 
07943  |'                                    dstrCaldate2 ||07916  |'                                    dstrCaldate2 
07944  |'                                    dstrBasedate2||07917  |'                                    dstrBasedate2
07945  |'                                    dlngDiffdate ||07918  |'                                    dlngDiffdate 
07946  |'                                                 ||07919  |'                                                 
07947  |'                                    For dintFor2 ||07920  |'                                    For dintFor2 
07948  |'                                        If ddblDa||07921  |'                                        If ddblDa
07949  |'                                            ddblD||07922  |'                                            ddblD
07950  |'                                        Else     ||07923  |'                                        Else     
07951  |'                                            '日次||07924  |'                                            '日次
07952  |'                                            intRt||07925  |'                                            intRt
07953  |'                                            vbLf ||07926  |'                                            vbLf 
07954  |'                                            vbLf ||07927  |'                                            vbLf 
07955  |'                                                v||07928  |'                                                v
07956  |'                                            Exit ||07929  |'                                            Exit 
07957  |'                                        End If   ||07930  |'                                        End If   
07958  |'                                        dlngCnt =||07931  |'                                        dlngCnt =
07959  |'                                    Next dintFor2||07932  |'                                    Next dintFor2
07960  |'                                    ddblDailynav(||07933  |'                                    ddblDailynav(
07961  |'                                End If           ||07934  |'                                End If           
07962  |'                                                 ||07935  |'                                                 
07963  |'                            End If               ||07936  |'                            End If               
07964  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    ||07937  |'                            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ    
07965  |'                            Call gDyNext         ||07938  |'                            Call gDyNext         
07966  |'                        Loop                     ||07939  |'                        Loop                     
07967  |'                                                 ||07940  |'                                                 
07968  |'                    Next dintFor                 ||07941  |'                    Next dintFor                 
07969  |'                                                 ||07942  |'                                                 
07970  |'                    If dlngCntsv <> dlngCnt Then ||07943  |'                    If dlngCntsv <> dlngCnt Then 
07971  |'                        For dintFor2 = dlngCnt + ||07944  |'                        For dintFor2 = dlngCnt + 
07972  |'                            ddblDailynav(dintFor2||07945  |'                            ddblDailynav(dintFor2
07973  |'                        Next dintFor2            ||07946  |'                        Next dintFor2            
07974  |'                        dlngCnt = dlngCntsv      ||07947  |'                        dlngCnt = dlngCntsv      
07975  |'                    End If                       ||07948  |'                    End If                       
07976  |'                                                 ||07949  |'                                                 
07977  |'                    ddblTtalnav = 0              ||07950  |'                    ddblTtalnav = 0              
07978  |'                                                 ||07951  |'                                                 
07979  |'                    For dintFor2 = 1 To dlngCnt  ||07952  |'                    For dintFor2 = 1 To dlngCnt  
07980  |'                        ddblTtalnav = ddblTtalnav||07953  |'                        ddblTtalnav = ddblTtalnav
07981  |'                    Next dintFor2                ||07954  |'                    Next dintFor2                
07982  |'                                                 ||07955  |'                                                 
07983  |'                    iRowCnt = dlngCnt            ||07956  |'                    iRowCnt = dlngCnt            
07984  |'                    TotalNav = ddblTtalnav       ||07957  |'                    TotalNav = ddblTtalnav       
07985  |'                    dblValueIn = TotalNav        ||07958  |'                    dblValueIn = TotalNav        
07986  |'                    Call sbGetRoundValue2(dblValu||07959  |'                    Call sbGetRoundValue2(dblValu
07987  |'                    TotalNav = dblValueOut       ||07960  |'                    TotalNav = dblValueOut       
07988  |'                                                 ||07961  |'                                                 
07989  |'                    '平均純資産総額              ||07962  |'                    '平均純資産総額              
07990  |'                    .Cells(43, 2).Value = sWord51||07963  |'                    .Cells(43, 2).Value = sWord51
07991  |'                    .Cells(43, 16).Value = sWord1||07964  |'                    .Cells(43, 16).Value = sWord1
07992  |'                                                 ||07965  |'                                                 
07993  |'                    '計算期間の純資産総額の合計( ||07966  |'                    '計算期間の純資産総額の合計( 
07994  |'                    .Cells(43, 28).NumberFormatLo||07967  |'                    .Cells(43, 28).NumberFormatLo
07995  |'                    If gbuMGetUPDRec.N(lRecIdx).M||07968  |'                    If gbuMGetUPDRec.N(lRecIdx).M
07996  |'                        .Cells(43, 28).Value = CS||07969  |'                        .Cells(43, 28).Value = CS
07997  |'                    Else                         ||07970  |'                    Else                         
07998  |'                        .Cells(43, 28).Value = CS||07971  |'                        .Cells(43, 28).Value = CS
07999  |'                    End If                       ||07972  |'                    End If                       
08000  |'                    .Cells(43, 28).HorizontalAlig||07973  |'                    .Cells(43, 28).HorizontalAlig
08001  |'                                                 ||07974  |'                                                 
08002  |'                    '計算期間の純資産総額の合計÷||07975  |'                    '計算期間の純資産総額の合計÷
08003  |'                    .Cells(43, 40).NumberFormatLo||07976  |'                    .Cells(43, 40).NumberFormatLo
08004  |'                    dblValueIn = TotalNav / iRowC||07977  |'                    dblValueIn = TotalNav / iRowC
08005  |'                    If gbuMGetUPDRec.N(lRecIdx).M||07978  |'                    If gbuMGetUPDRec.N(lRecIdx).M
08006  |'                        Call sbGetRoundValue2(dbl||07979  |'                        Call sbGetRoundValue2(dbl
08007  |'                    Else                         ||07980  |'                    Else                         
08008  |'                        Call sbGetRoundValue(dblV||07981  |'                        Call sbGetRoundValue(dblV
08009  |'                    End If                       ||07982  |'                    End If                       
08010  |'                                                 ||07983  |'                                                 
08011  |'                    If gbuMGetUPDRec.N(lRecIdx).M||07984  |'                    If gbuMGetUPDRec.N(lRecIdx).M
08012  |'                        .Cells(43, 40).Value = CS||07985  |'                        .Cells(43, 40).Value = CS
08013  |'                    Else                         ||07986  |'                    Else                         
08014  |'                        .Cells(43, 40).Value = CS||07987  |'                        .Cells(43, 40).Value = CS
08015  |'                    End If                       ||07988  |'                    End If                       
08016  |'                    AvgNav = dblValueOut         ||07989  |'                    AvgNav = dblValueOut         
08017  |'                                                 ||07990  |'                                                 
08018  |'                    '÷??＝                      ||07991  |'                    '÷??＝                      
08019  |'                    .Cells(43, 31).Value = sWord1||07992  |'                    .Cells(43, 31).Value = sWord1
08020  |'        End If                                   ||07993  |'        End If                                   
08021  |'    Else                                         ||07994  |'    Else                                         
08022  |'On Error GoTo OnErrorProc                        ||07995  |'On Error GoTo OnErrorProc                        
08023  |'                                                 ||07996  |'                                                 
08024  |'            '契約区分「3」の場合                 ||07997  |'            '契約区分「3」の場合                 
08025  |'            ddblTtalnav = 0                      ||07998  |'            ddblTtalnav = 0                      
08026  |'            For dintFor = 0 To NavGetCnt - 1     ||07999  |'            For dintFor = 0 To NavGetCnt - 1     
08027  |'                                                 ||08000  |'                                                 
08028  |'                '日次NAV平均取得                 ||08001  |'                '日次NAV平均取得                 
08029  |'                sStart = gstrDateFormat2(CStr(dSt||08002  |'                sStart = gstrDateFormat2(CStr(dSt
08030  |'                sEnd = gstrDateFormat2(CStr(dEnd)||08003  |'                sEnd = gstrDateFormat2(CStr(dEnd)
08031  |'                                                 ||08004  |'                                                 
08032  |'                sSql = ""                        ||08005  |'                sSql = ""                        
08033  |'                sSql = sSql & "SELECT ACCOUNT_COD||08006  |'                sSql = sSql & "SELECT ACCOUNT_COD
08034  |'                sSql = sSql & "WHERE (((CFR_DAILY||08007  |'                sSql = sSql & "WHERE (((CFR_DAILY
08035  |'                sSql = sSql & "AND ((CFR_DAILY_NA||08008  |'                sSql = sSql & "AND ((CFR_DAILY_NA
08036  |'                sSql = sSql & "AND ((CFR_DAILY_NA||08009  |'                sSql = sSql & "AND ((CFR_DAILY_NA
08037  |'                sSql = sSql & "ORDER BY CFR_DAILY||08010  |'                sSql = sSql & "ORDER BY CFR_DAILY
08038  |'                                                 ||08011  |'                                                 
08039  |'                If gintDyCreate(sSql) = False The||08012  |'                If gintDyCreate(sSql) = False The
08040  |'                    Exit Function                ||08013  |'                    Exit Function                
08041  |'                End If                           ||08014  |'                End If                           
08042  |'                                                 ||08015  |'                                                 
08043  |'                If dlngCnt = 0 Then              ||08016  |'                If dlngCnt = 0 Then              
08044  |'                    ReDim dstrCaldate(gbxOraDynas||08017  |'                    ReDim dstrCaldate(gbxOraDynas
08045  |'                    ReDim ddblDailynav(gbxOraDyna||08018  |'                    ReDim ddblDailynav(gbxOraDyna
08046  |'                End If                           ||08019  |'                End If                           
08047  |'                                                 ||08020  |'                                                 
08048  |'                dlngCnt = 0                      ||08021  |'                dlngCnt = 0                      
08049  |'                                                 ||08022  |'                                                 
08050  |'                Do Until gblnDyEOF()             ||08023  |'                Do Until gblnDyEOF()             
08051  |'                    dlngCnt = dlngCnt + 1        ||08024  |'                    dlngCnt = dlngCnt + 1        
08052  |'                    '抽出データセット            ||08025  |'                    '抽出データセット            
08053  |'                    dstrCaldate(dlngCnt) = gvlnDy||08026  |'                    dstrCaldate(dlngCnt) = gvlnDy
08054  |'                    ddblDailynav(dlngCnt) = ddblD||08027  |'                    ddblDailynav(dlngCnt) = ddblD
08055  |'                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ            ||08028  |'                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ            
08056  |'                    Call gDyNext                 ||08029  |'                    Call gDyNext                 
08057  |'                Loop                             ||08030  |'                Loop                             
08058  |'                                                 ||08031  |'                                                 
08059  |'            Next dintFor                         ||08032  |'            Next dintFor                         
08060  |'                                                 ||08033  |'                                                 
08061  |'            ddblTtalnav = 0                      ||08034  |'            ddblTtalnav = 0                      
08062  |'                                                 ||08035  |'                                                 
08063  |'            For dintFor2 = 1 To dlngCnt          ||08036  |'            For dintFor2 = 1 To dlngCnt          
08064  |'                ddblTtalnav = ddblTtalnav + ddblD||08037  |'                ddblTtalnav = ddblTtalnav + ddblD
08065  |'            Next dintFor2                        ||08038  |'            Next dintFor2                        
08066  |'                                                 ||08039  |'                                                 
08067  |'            iRowCnt = dlngCnt                    ||08040  |'            iRowCnt = dlngCnt                    
08068  |'            dlngMeisyoSu = dlngCnt               ||08041  |'            dlngMeisyoSu = dlngCnt               
08069  |'                                                 ||08042  |'                                                 
08070  |'            TotalNav = ddblTtalnav               ||08043  |'            TotalNav = ddblTtalnav               
08071  |'            dblValueIn = TotalNav                ||08044  |'            dblValueIn = TotalNav                
08072  |'            Call sbGetRoundValue2(dblValueIn)    ||08045  |'            Call sbGetRoundValue2(dblValueIn)    
08073  |'            TotalNav = dblValueOut               ||08046  |'            TotalNav = dblValueOut               
08074  |'                                                 ||08047  |'                                                 
08075  |'            '計算期間の純資産総額の合計÷計算期間||08048  |'            '計算期間の純資産総額の合計÷計算期間
08076  |'            dblValueIn = TotalNav / iRowCnt      ||08049  |'            dblValueIn = TotalNav / iRowCnt      
08077  |'            iCalcNum = iRowCnt                   ||08050  |'            iCalcNum = iRowCnt                   
08078  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base||08051  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base
08079  |'                  Call sbGetRoundValue2(dblValueI||08052  |'                  Call sbGetRoundValue2(dblValueI
08080  |'            Else                                 ||08053  |'            Else                                 
08081  |'                  Call sbGetRoundValue(dblValueIn||08054  |'                  Call sbGetRoundValue(dblValueIn
08082  |'            End If                               ||08055  |'            End If                               
08083  |'            dstrAvgNav = dblValueOut             ||08056  |'            dstrAvgNav = dblValueOut             
08084  |'            AvgNav = dstrAvgNav                  ||08057  |'            AvgNav = dstrAvgNav                  
08085  |'                                                 ||08058  |'                                                 
08086  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    ||08059  |'            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                    
08087  |'            Call gblnDyClose                     ||08060  |'            Call gblnDyClose                     
08088  |'                                                 ||08061  |'                                                 
08089  |'            '平均純資産総額                      ||08062  |'            '平均純資産総額                      
08090  |'            .Cells(43, 2).Value = sWord51a       ||08063  |'            .Cells(43, 2).Value = sWord51a       
08091  |'            .Cells(43, 16).Value = sWord19       ||08064  |'            .Cells(43, 16).Value = sWord19       
08092  |'            '計算期間の純資産総額の合計(月末純資 ||08065  |'            '計算期間の純資産総額の合計(月末純資 
08093  |'            .Cells(43, 28).NumberFormatLocal = "@||08066  |'            .Cells(43, 28).NumberFormatLocal = "@
08094  |'              If gbuMGetUPDRec.N(lRecIdx).MGET_ba||08067  |'              If gbuMGetUPDRec.N(lRecIdx).MGET_ba
08095  |'                  .Cells(43, 28).Value = CStr(For||08068  |'                  .Cells(43, 28).Value = CStr(For
08096  |'              Else                               ||08069  |'              Else                               
08097  |'                  .Cells(43, 28).Value = CStr(For||08070  |'                  .Cells(43, 28).Value = CStr(For
08098  |'              End If                             ||08071  |'              End If                             
08099  |'            .Cells(43, 28).HorizontalAlignment = ||08072  |'            .Cells(43, 28).HorizontalAlignment = 
08100  |'            '÷??＝                              ||08073  |'            '÷??＝                              
08101  |'            .Cells(43, 31).Value = sWord18 & "   ||08074  |'            .Cells(43, 31).Value = sWord18 & "   
08102  |'            '計算期間の純資産総額の合計÷計算期間||08075  |'            '計算期間の純資産総額の合計÷計算期間
08103  |'            .Cells(43, 40).NumberFormatLocal = "@||08076  |'            .Cells(43, 40).NumberFormatLocal = "@
08104  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base||08077  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base
08105  |'                .Cells(43, 40).Value = CStr(Forma||08078  |'                .Cells(43, 40).Value = CStr(Forma
08106  |'            Else                                 ||08079  |'            Else                                 
08107  |'                .Cells(43, 40).Value = CStr(Forma||08080  |'                .Cells(43, 40).Value = CStr(Forma
08108  |'            End If                               ||08081  |'            End If                               
08109  |'                                                 ||08082  |'                                                 
08110  |'            ddblExchangeRate = 0                 ||08083  |'            ddblExchangeRate = 0                 
08111  |'                                                 ||08084  |'                                                 
08112  |'            '投資顧問料計算用計算対象NAVに日次平 ||08085  |'            '投資顧問料計算用計算対象NAVに日次平 
08113  |'            If dstrAvgNav = "" Then              ||08086  |'            If dstrAvgNav = "" Then              
08114  |'                lCalcNav = 0                     ||08087  |'                lCalcNav = 0                     
08115  |'            Else                                 ||08088  |'            Else                                 
08116  |'                                                 ||08089  |'                                                 
08117  |'                dblValueIn = CDbl(dstrAvgNav)    ||08090  |'                dblValueIn = CDbl(dstrAvgNav)    
08118  |'                                                 ||08091  |'                                                 
08119  |'                '@@@@@ NAV通貨から閾値通貨に換算 ||08092  |'                '@@@@@ NAV通貨から閾値通貨に換算 
08120  |'                Select Case gbuMGetUPDRec.N(lRecI||08093  |'                Select Case gbuMGetUPDRec.N(lRecI
08121  |'                  Case "1"    '固定料率          ||08094  |'                  Case "1"    '固定料率          
08122  |'                    If gbuMGetUPDRec.N(lRecIdx).M||08095  |'                    If gbuMGetUPDRec.N(lRecIdx).M
08123  |'                        'NAV通貨→JPYの為替レート||08096  |'                        'NAV通貨→JPYの為替レート
08124  |'                        dstrCurrencyCode = gbuMGe||08097  |'                        dstrCurrencyCode = gbuMGe
08125  |'                        ddblExchangeRate = fnstrE||08098  |'                        ddblExchangeRate = fnstrE
08126  |'                        If ddblExchangeRate = 0 T||08099  |'                        If ddblExchangeRate = 0 T
08127  |'                          intRtn = MsgBox("ＴＴＭ||08100  |'                          intRtn = MsgBox("ＴＴＭ
08128  |'                          vbLf & "対象通貨コード ||08101  |'                          vbLf & "対象通貨コード 
08129  |'                          vbLf & "基準日 ： [ " &||08102  |'                          vbLf & "基準日 ： [ " &
08130  |'                              vbCritical, "ＴＴＭ||08103  |'                              vbCritical, "ＴＴＭ
08131  |'                          Exit Function          ||08104  |'                          Exit Function          
08132  |'                        End If                   ||08105  |'                        End If                   
08133  |'                        'NAV通貨→JPYへレート換算||08106  |'                        'NAV通貨→JPYへレート換算
08134  |'                        dblValueIn = dblValueIn *||08107  |'                        dblValueIn = dblValueIn *
08135  |'                    End If                       ||08108  |'                    End If                       
08136  |'                                                 ||08109  |'                                                 
08137  |'                  Case "2"    '段階料率          ||08110  |'                  Case "2"    '段階料率          
08138  |'                                                 ||08111  |'                                                 
08139  |'                    If gbuMGetUPDRec.N(lRecIdx).M||08112  |'                    If gbuMGetUPDRec.N(lRecIdx).M
08140  |'                        If gbuMGetUPDRec.N(lRecId||08113  |'                        If gbuMGetUPDRec.N(lRecId
08141  |'                        Else                     ||08114  |'                        Else                     
08142  |'                            '閾値通貨→JPYの為替 ||08115  |'                            '閾値通貨→JPYの為替 
08143  |'                            dstrCurrencyCode = gb||08116  |'                            dstrCurrencyCode = gb
08144  |'                            ddblExchangeRate = fn||08117  |'                            ddblExchangeRate = fn
08145  |'                            If ddblExchangeRate =||08118  |'                            If ddblExchangeRate =
08146  |'                              intRtn = MsgBox("Ｔ||08119  |'                              intRtn = MsgBox("Ｔ
08147  |'                              vbLf & "対象通貨コ ||08120  |'                              vbLf & "対象通貨コ 
08148  |'                              vbLf & "基準日 ： [||08121  |'                              vbLf & "基準日 ： [
08149  |'                                  vbCritical, "Ｔ||08122  |'                                  vbCritical, "Ｔ
08150  |'                              Exit Function      ||08123  |'                              Exit Function      
08151  |'                            End If               ||08124  |'                            End If               
08152  |'                            'JPY→閾値通貨へレー ||08125  |'                            'JPY→閾値通貨へレー 
08153  |'                            dblValueIn = dblValue||08126  |'                            dblValueIn = dblValue
08154  |'                        End If                   ||08127  |'                        End If                   
08155  |'                    Else                         ||08128  |'                    Else                         
08156  |'                        'NAV通貨→JPYの為替レート||08129  |'                        'NAV通貨→JPYの為替レート
08157  |'                        dstrCurrencyCode = gbuMGe||08130  |'                        dstrCurrencyCode = gbuMGe
08158  |'                        ddblExchangeRate = fnstrE||08131  |'                        ddblExchangeRate = fnstrE
08159  |'                        If ddblExchangeRate = 0 T||08132  |'                        If ddblExchangeRate = 0 T
08160  |'                          intRtn = MsgBox("ＴＴＭ||08133  |'                          intRtn = MsgBox("ＴＴＭ
08161  |'                          vbLf & "対象通貨コード ||08134  |'                          vbLf & "対象通貨コード 
08162  |'                          vbLf & "基準日 ： [ " &||08135  |'                          vbLf & "基準日 ： [ " &
08163  |'                              vbCritical, "ＴＴＭ||08136  |'                              vbCritical, "ＴＴＭ
08164  |'                          Exit Function          ||08137  |'                          Exit Function          
08165  |'                        End If                   ||08138  |'                        End If                   
08166  |'                        'NAV通貨→JPYへレート換算||08139  |'                        'NAV通貨→JPYへレート換算
08167  |'                        dblValueIn = dblValueIn *||08140  |'                        dblValueIn = dblValueIn *
08168  |'                        If gbuMGetUPDRec.N(lRecId||08141  |'                        If gbuMGetUPDRec.N(lRecId
08169  |'                        Else                     ||08142  |'                        Else                     
08170  |'                            '閾値通貨→JPYの為替 ||08143  |'                            '閾値通貨→JPYの為替 
08171  |'                            dstrCurrencyCode = gb||08144  |'                            dstrCurrencyCode = gb
08172  |'                            ddblExchangeRate = fn||08145  |'                            ddblExchangeRate = fn
08173  |'                            If ddblExchangeRate =||08146  |'                            If ddblExchangeRate =
08174  |'                              intRtn = MsgBox("Ｔ||08147  |'                              intRtn = MsgBox("Ｔ
08175  |'                              vbLf & "対象通貨コ ||08148  |'                              vbLf & "対象通貨コ 
08176  |'                              vbLf & "基準日 ： [||08149  |'                              vbLf & "基準日 ： [
08177  |'                                  vbCritical, "Ｔ||08150  |'                                  vbCritical, "Ｔ
08178  |'                              Exit Function      ||08151  |'                              Exit Function      
08179  |'                            End If               ||08152  |'                            End If               
08180  |'                            'JPY→閾値通貨へ逆レ ||08153  |'                            'JPY→閾値通貨へ逆レ 
08181  |'                            dblValueIn = dblValue||08154  |'                            dblValueIn = dblValue
08182  |'                        End If                   ||08155  |'                        End If                   
08183  |'                    End If                       ||08156  |'                    End If                       
08184  |'                                                 ||08157  |'                                                 
08185  |'                End Select                       ||08158  |'                End Select                       
08186  |'                '@@@@@ NAV通貨から閾値通貨に換算 ||08159  |'                '@@@@@ NAV通貨から閾値通貨に換算 
08187  |'                Call sbGetRoundValue2(dblValueIn)||08160  |'                Call sbGetRoundValue2(dblValueIn)
08188  |'                                                 ||08161  |'                                                 
08189  |''閾値レート換算後平均NAV(計算対象NAV)            ||08162  |''閾値レート換算後平均NAV(計算対象NAV)            
08190  |'                lCalcNav = CStr(Format(dblValueOu||08163  |'                lCalcNav = CStr(Format(dblValueOu
08191  |'            End If                               ||08164  |'            End If                               
08192  |'                                                 ||08165  |'                                                 
08193  |'On Error Resume Next                             ||08166  |'On Error Resume Next                             
08194  |'        End If                                   ||08167  |'        End If                                   
08195  |'                                                 ||08168  |'                                                 
08196  |'        '投資顧問料                              ||08169  |'        '投資顧問料                              
08197  |'        Dim dRitsu As Double    '外部委託顧問料率||08170  |'        Dim dRitsu As Double    '外部委託顧問料率
08198  |'        dRitsu = 0                               ||08171  |'        dRitsu = 0                               
08199  |'        TotalRate = 0                            ||08172  |'        TotalRate = 0                            
08200  |'        ddblExchangeRate = 0                     ||08173  |'        ddblExchangeRate = 0                     
08201  |'        '計算対象NAVを変数にセット               ||08174  |'        '計算対象NAVを変数にセット               
08202  |'            lCalcNav = 0                         ||08175  |'            lCalcNav = 0                         
08203  |'            dblValueIn = TotalNav / iRowCnt      ||08176  |'            dblValueIn = TotalNav / iRowCnt      
08204  |'                                                 ||08177  |'                                                 
08205  |'            '@@@@@ NAV通貨から閾値通貨に換算 @@@@||08178  |'            '@@@@@ NAV通貨から閾値通貨に換算 @@@@
08206  |'            Select Case gbuMGetUPDRec.N(lRecIdx).||08179  |'            Select Case gbuMGetUPDRec.N(lRecIdx).
08207  |'              Case "1"    '固定料率(固定料率の場 ||08180  |'              Case "1"    '固定料率(固定料率の場 
08208  |'                                                 ||08181  |'                                                 
08209  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||08182  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
08210  |'                    'NAV通貨→JPYの為替レートを取||08183  |'                    'NAV通貨→JPYの為替レートを取
08211  |'                    dstrCurrencyCode = gbuMGetUPD||08184  |'                    dstrCurrencyCode = gbuMGetUPD
08212  |'                    ddblExchangeRate = fnstrExcha||08185  |'                    ddblExchangeRate = fnstrExcha
08213  |'                    If ddblExchangeRate = 0 Then ||08186  |'                    If ddblExchangeRate = 0 Then 
08214  |'                      intRtn = MsgBox("ＴＴＭが取||08187  |'                      intRtn = MsgBox("ＴＴＭが取
08215  |'                      vbLf & "対象通貨コード ： [||08188  |'                      vbLf & "対象通貨コード ： [
08216  |'                      vbLf & "基準日 ： [ " & Mid||08189  |'                      vbLf & "基準日 ： [ " & Mid
08217  |'                          vbCritical, "ＴＴＭ取得||08190  |'                          vbCritical, "ＴＴＭ取得
08218  |'                      Exit Function              ||08191  |'                      Exit Function              
08219  |'                    End If                       ||08192  |'                    End If                       
08220  |'                    'NAV通貨→JPYへレート換算    ||08193  |'                    'NAV通貨→JPYへレート換算    
08221  |'                    dblValueIn = dblValueIn * ddb||08194  |'                    dblValueIn = dblValueIn * ddb
08222  |'                End If                           ||08195  |'                End If                           
08223  |'                                                 ||08196  |'                                                 
08224  |'              Case "2"    '段階料率              ||08197  |'              Case "2"    '段階料率              
08225  |'                                                 ||08198  |'                                                 
08226  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||08199  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
08227  |'                    If gbuMGetUPDRec.N(lRecIdx).M||08200  |'                    If gbuMGetUPDRec.N(lRecIdx).M
08228  |'                    Else                         ||08201  |'                    Else                         
08229  |'                        '閾値通貨→JPYの為替レー ||08202  |'                        '閾値通貨→JPYの為替レー 
08230  |'                        dstrCurrencyCode = gbuMGe||08203  |'                        dstrCurrencyCode = gbuMGe
08231  |'                        ddblExchangeRate = fnstrE||08204  |'                        ddblExchangeRate = fnstrE
08232  |'                        If ddblExchangeRate = 0 T||08205  |'                        If ddblExchangeRate = 0 T
08233  |'                          intRtn = MsgBox("ＴＴＭ||08206  |'                          intRtn = MsgBox("ＴＴＭ
08234  |'                          vbLf & "対象通貨コード ||08207  |'                          vbLf & "対象通貨コード 
08235  |'                          vbLf & "基準日 ： [ " &||08208  |'                          vbLf & "基準日 ： [ " &
08236  |'                              vbCritical, "ＴＴＭ||08209  |'                              vbCritical, "ＴＴＭ
08237  |'                          Exit Function          ||08210  |'                          Exit Function          
08238  |'                        End If                   ||08211  |'                        End If                   
08239  |'                        'JPY→閾値通貨へレート換 ||08212  |'                        'JPY→閾値通貨へレート換 
08240  |'                        dblValueIn = dblValueIn *||08213  |'                        dblValueIn = dblValueIn *
08241  |'                    End If                       ||08214  |'                    End If                       
08242  |'                Else                             ||08215  |'                Else                             
08243  |'                    'NAV通貨→JPYの為替レートを取||08216  |'                    'NAV通貨→JPYの為替レートを取
08244  |'                    dstrCurrencyCode = gbuMGetUPD||08217  |'                    dstrCurrencyCode = gbuMGetUPD
08245  |'                    ddblExchangeRate = fnstrExcha||08218  |'                    ddblExchangeRate = fnstrExcha
08246  |'                    If ddblExchangeRate = 0 Then ||08219  |'                    If ddblExchangeRate = 0 Then 
08247  |'                      intRtn = MsgBox("ＴＴＭが取||08220  |'                      intRtn = MsgBox("ＴＴＭが取
08248  |'                      vbLf & "対象通貨コード ： [||08221  |'                      vbLf & "対象通貨コード ： [
08249  |'                      vbLf & "基準日 ： [ " & Mid||08222  |'                      vbLf & "基準日 ： [ " & Mid
08250  |'                          vbCritical, "ＴＴＭ取得||08223  |'                          vbCritical, "ＴＴＭ取得
08251  |'                      Exit Function              ||08224  |'                      Exit Function              
08252  |'                    End If                       ||08225  |'                    End If                       
08253  |'                    'NAV通貨→JPYへレート換算    ||08226  |'                    'NAV通貨→JPYへレート換算    
08254  |'                    dblValueIn = dblValueIn * ddb||08227  |'                    dblValueIn = dblValueIn * ddb
08255  |'                    If gbuMGetUPDRec.N(lRecIdx).M||08228  |'                    If gbuMGetUPDRec.N(lRecIdx).M
08256  |'                    Else                         ||08229  |'                    Else                         
08257  |'                        '閾値通貨→JPYの為替レー ||08230  |'                        '閾値通貨→JPYの為替レー 
08258  |'                        dstrCurrencyCode = gbuMGe||08231  |'                        dstrCurrencyCode = gbuMGe
08259  |'                        ddblExchangeRate = fnstrE||08232  |'                        ddblExchangeRate = fnstrE
08260  |'                        If ddblExchangeRate = 0 T||08233  |'                        If ddblExchangeRate = 0 T
08261  |'                          intRtn = MsgBox("ＴＴＭ||08234  |'                          intRtn = MsgBox("ＴＴＭ
08262  |'                          vbLf & "対象通貨コード ||08235  |'                          vbLf & "対象通貨コード 
08263  |'                          vbLf & "基準日 ： [ " &||08236  |'                          vbLf & "基準日 ： [ " &
08264  |'                              vbCritical, "ＴＴＭ||08237  |'                              vbCritical, "ＴＴＭ
08265  |'                          Exit Function          ||08238  |'                          Exit Function          
08266  |'                        End If                   ||08239  |'                        End If                   
08267  |'                        'JPY→閾値通貨へ逆レート ||08240  |'                        'JPY→閾値通貨へ逆レート 
08268  |'                        dblValueIn = dblValueIn /||08241  |'                        dblValueIn = dblValueIn /
08269  |'                    End If                       ||08242  |'                    End If                       
08270  |'                End If                           ||08243  |'                End If                           
08271  |'            End Select                           ||08244  |'            End Select                           
08272  |'            '@@@@@ NAV通貨から閾値通貨に換算 @@@@||08245  |'            '@@@@@ NAV通貨から閾値通貨に換算 @@@@
08273  |'            Call sbGetRoundValue2(dblValueIn)    ||08246  |'            Call sbGetRoundValue2(dblValueIn)    
08274  |'            lCalcNav = CStr(Format(dblValueOut, "||08247  |'            lCalcNav = CStr(Format(dblValueOut, "
08275  |'                                                 ||08248  |'                                                 
08276  |'        '固定料率                                ||08249  |'        '固定料率                                
08277  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_ra||08250  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_ra
08278  |'            '計算対称NAV × 外部委託顧問料率 ÷ 1||08251  |'            '計算対称NAV × 外部委託顧問料率 ÷ 1
08279  |'            dRitsu = CDbl(gbuOtherComRateGetUPDRe||08252  |'            dRitsu = CDbl(gbuOtherComRateGetUPDRe
08280  |'                                                 ||08253  |'                                                 
08281  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days||08254  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days
08282  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days||08255  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days
08283  |'                '一年間の日数：365日またはカレン ||08256  |'                '一年間の日数：365日またはカレン 
08284  |'                dblValueIn = lCalcNav * dRitsu / ||08257  |'                dblValueIn = lCalcNav * dRitsu / 
08285  |'            Else                                 ||08258  |'            Else                                 
08286  |'                '一年間の日数：360日             ||08259  |'                '一年間の日数：360日             
08287  |'                dblValueIn = lCalcNav * dRitsu / ||08260  |'                dblValueIn = lCalcNav * dRitsu / 
08288  |'            End If                               ||08261  |'            End If                               
08289  |'                                                 ||08262  |'                                                 
08290  |'        '段階料率                                ||08263  |'        '段階料率                                
08291  |'        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_othe||08264  |'        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_othe
08292  |'            '料率分ループ処理                    ||08265  |'            '料率分ループ処理                    
08293  |'            For i = LBound(gbuOtherComRateGetUPDR||08266  |'            For i = LBound(gbuOtherComRateGetUPDR
08294  |'                TotalRate = TotalRate + CCur(gbuO||08267  |'                TotalRate = TotalRate + CCur(gbuO
08295  |'                cRate = CCur(gbuOtherComRateGetUP||08268  |'                cRate = CCur(gbuOtherComRateGetUP
08296  |'                dRitsu = CDbl(gbuOtherComRateGetU||08269  |'                dRitsu = CDbl(gbuOtherComRateGetU
08297  |'                If i = UBound(gbuOtherComRateGetU||08270  |'                If i = UBound(gbuOtherComRateGetU
08298  |'                    '(前回閾値)：累積閾値 = WORK ||08271  |'                    '(前回閾値)：累積閾値 = WORK 
08299  |'                    TotalRate = WorkRate         ||08272  |'                    TotalRate = WorkRate         
08300  |'                ElseIf TotalRate <= lCalcNav Then||08273  |'                ElseIf TotalRate <= lCalcNav Then
08301  |'                    '累積投資顧問料 = 累積投資顧 ||08274  |'                    '累積投資顧問料 = 累積投資顧 
08302  |'                    dblValueIn = cRate * dRitsu /||08275  |'                    dblValueIn = cRate * dRitsu /
08303  |'                    Call sbGetRoundValue2(dblValu||08276  |'                    Call sbGetRoundValue2(dblValu
08304  |'                    TotalCom = TotalCom + dblValu||08277  |'                    TotalCom = TotalCom + dblValu
08305  |'                Else                             ||08278  |'                Else                             
08306  |'                    '(前回閾値)：累積閾値 = WORK ||08279  |'                    '(前回閾値)：累積閾値 = WORK 
08307  |'                    TotalRate = WorkRate         ||08280  |'                    TotalRate = WorkRate         
08308  |'                    Exit For                     ||08281  |'                    Exit For                     
08309  |'                End If                           ||08282  |'                End If                           
08310  |'                '累積閾値をWORKに格納(一つ前の閾 ||08283  |'                '累積閾値をWORKに格納(一つ前の閾 
08311  |'                WorkRate = TotalRate             ||08284  |'                WorkRate = TotalRate             
08312  |'            Next i                               ||08285  |'            Next i                               
08313  |'            '累積投資顧問料 = 累積投資顧問料 + ( ||08286  |'            '累積投資顧問料 = 累積投資顧問料 + ( 
08314  |'            dblValueIn = (lCalcNav - TotalRate) *||08287  |'            dblValueIn = (lCalcNav - TotalRate) *
08315  |'            TotalCom = TotalCom + dblValueIn     ||08288  |'            TotalCom = TotalCom + dblValueIn     
08316  |'                                                 ||08289  |'                                                 
08317  |'            '投資顧問料 = 累積投資顧問料 × 計算 ||08290  |'            '投資顧問料 = 累積投資顧問料 × 計算 
08318  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days||08291  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days
08319  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days||08292  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days
08320  |'                '一年間の日数：365日またはカレン ||08293  |'                '一年間の日数：365日またはカレン 
08321  |'                dblValueIn = TotalCom * iCalcNum ||08294  |'                dblValueIn = TotalCom * iCalcNum 
08322  |'            Else                                 ||08295  |'            Else                                 
08323  |'                '一年間の日数：360日             ||08296  |'                '一年間の日数：360日             
08324  |'                dblValueIn = TotalCom * iCalcNum ||08297  |'                dblValueIn = TotalCom * iCalcNum 
08325  |'            End If                               ||08298  |'            End If                               
08326  |'        End If                                   ||08299  |'        End If                                   
08327  |'                                                 ||08300  |'                                                 
08328  |'        ddblExchangeRate = 0                     ||08301  |'        ddblExchangeRate = 0                     
08329  |'                                                 ||08302  |'                                                 
08330  |'        '@@@@@ 外部委託顧問料に換算 @@@@@        ||08303  |'        '@@@@@ 外部委託顧問料に換算 @@@@@        
08331  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET||08304  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET
08332  |'          Case "1"    '固定料率                  ||08305  |'          Case "1"    '固定料率                  
08333  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||08306  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
08334  |'                Else                             ||08307  |'                Else                             
08335  |'                  '外部委託顧問料通貨→JPYの為替 ||08308  |'                  '外部委託顧問料通貨→JPYの為替 
08336  |'                  dstrCurrencyCode = gbuMGetUPDRe||08309  |'                  dstrCurrencyCode = gbuMGetUPDRe
08337  |'                  ddblExchangeRate = fnstrExchang||08310  |'                  ddblExchangeRate = fnstrExchang
08338  |'                  If ddblExchangeRate = 0 Then   ||08311  |'                  If ddblExchangeRate = 0 Then   
08339  |'                    intRtn = MsgBox("ＴＴＭが取得||08312  |'                    intRtn = MsgBox("ＴＴＭが取得
08340  |'                    vbLf & "対象通貨コード ： [ "||08313  |'                    vbLf & "対象通貨コード ： [ "
08341  |'                    vbLf & "基準日 ： [ " & Mid(d||08314  |'                    vbLf & "基準日 ： [ " & Mid(d
08342  |'                        vbCritical, "ＴＴＭ取得エ||08315  |'                        vbCritical, "ＴＴＭ取得エ
08343  |'                    Exit Function                ||08316  |'                    Exit Function                
08344  |'                  End If                         ||08317  |'                  End If                         
08345  |'                  'JPY→閾値通貨へ逆レート換算   ||08318  |'                  'JPY→閾値通貨へ逆レート換算   
08346  |'                  dblValueIn = dblValueIn / ddblE||08319  |'                  dblValueIn = dblValueIn / ddblE
08347  |'                End If                           ||08320  |'                End If                           
08348  |'                                                 ||08321  |'                                                 
08349  |'          Case "2"    '段階料率                  ||08322  |'          Case "2"    '段階料率                  
08350  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe||08323  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe
08351  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||08324  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
08352  |'                Else                             ||08325  |'                Else                             
08353  |'                    '閾値通貨→JPYの為替レートを ||08326  |'                    '閾値通貨→JPYの為替レートを 
08354  |'                    dstrCurrencyCode = gbuMGetUPD||08327  |'                    dstrCurrencyCode = gbuMGetUPD
08355  |'                    ddblExchangeRate = fnstrExcha||08328  |'                    ddblExchangeRate = fnstrExcha
08356  |'                    'JPY→閾値通貨へ逆レート換算 ||08329  |'                    'JPY→閾値通貨へ逆レート換算 
08357  |'                    dblValueIn = dblValueIn / ddb||08330  |'                    dblValueIn = dblValueIn / ddb
08358  |'                End If                           ||08331  |'                End If                           
08359  |'            Else                                 ||08332  |'            Else                                 
08360  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||08333  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
08361  |'                    '外部委託顧問料通貨→JPYの為 ||08334  |'                    '外部委託顧問料通貨→JPYの為 
08362  |'                    dstrCurrencyCode = gbuMGetUPD||08335  |'                    dstrCurrencyCode = gbuMGetUPD
08363  |'                    ddblExchangeRate = fnstrExcha||08336  |'                    ddblExchangeRate = fnstrExcha
08364  |'                    'JPY→閾値通貨へレート換算   ||08337  |'                    'JPY→閾値通貨へレート換算   
08365  |'                    dblValueIn = dblValueIn / ddb||08338  |'                    dblValueIn = dblValueIn / ddb
08366  |'                Else                             ||08339  |'                Else                             
08367  |'                    '閾値通貨→JPYの為替レートを ||08340  |'                    '閾値通貨→JPYの為替レートを 
08368  |'                    dstrCurrencyCode = gbuMGetUPD||08341  |'                    dstrCurrencyCode = gbuMGetUPD
08369  |'                    ddblExchangeRate = fnstrExcha||08342  |'                    ddblExchangeRate = fnstrExcha
08370  |'                    'JPY→閾値通貨へ逆レート換算 ||08343  |'                    'JPY→閾値通貨へ逆レート換算 
08371  |'                    dblValueIn = dblValueIn * ddb||08344  |'                    dblValueIn = dblValueIn * ddb
08372  |'                    '外部委託顧問料通貨→JPYの為 ||08345  |'                    '外部委託顧問料通貨→JPYの為 
08373  |'                    dstrCurrencyCode = gbuMGetUPD||08346  |'                    dstrCurrencyCode = gbuMGetUPD
08374  |'                    ddblExchangeRate = fnstrExcha||08347  |'                    ddblExchangeRate = fnstrExcha
08375  |'                    'JPY→閾値通貨へ逆レート換算 ||08348  |'                    'JPY→閾値通貨へ逆レート換算 
08376  |'                    dblValueIn = dblValueIn / ddb||08349  |'                    dblValueIn = dblValueIn / ddb
08377  |'                End If                           ||08350  |'                End If                           
08378  |'            End If                               ||08351  |'            End If                               
08379  |'                                                 ||08352  |'                                                 
08380  |'        End Select                               ||08353  |'        End Select                               
08381  |'        '@@@@@ 外部委託顧問料に換算 @@@@@        ||08354  |'        '@@@@@ 外部委託顧問料に換算 @@@@@        
08382  |'        Call sbGetRoundValue2(dblValueIn)        ||08355  |'        Call sbGetRoundValue2(dblValueIn)        
08383  |'        mstrMonthlyPayCom = dblValueOut          ||08356  |'        mstrMonthlyPayCom = dblValueOut          
08384  |'                                                 ||08357  |'                                                 
08385  |'        TotalRate = 0                            ||08358  |'        TotalRate = 0                            
08386  |'        '固定料率                                ||08359  |'        '固定料率                                
08387  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_ra||08360  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_ra
08388  |'            '年率1行固定                         ||08361  |'            '年率1行固定                         
08389  |'            .Cells(15, 13).Value = _             ||08362  |'            .Cells(15, 13).Value = _             
08390  |'                Format(gbuOtherComRateGetUPDRec.N||08363  |'                Format(gbuOtherComRateGetUPDRec.N
08391  |'        '段階料率                                ||08364  |'        '段階料率                                
08392  |'        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_othe||08365  |'        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_othe
08393  |'            '料率順位のデータ数により処理を分岐  ||08366  |'            '料率順位のデータ数により処理を分岐  
08394  |'            iRowCnt = 0                          ||08367  |'            iRowCnt = 0                          
08395  |'                                                 ||08368  |'                                                 
08396  |'                For i = LBound(gbuOtherComRateGet||08369  |'                For i = LBound(gbuOtherComRateGet
08397  |'                    If i = 0 Then                ||08370  |'                    If i = 0 Then                
08398  |'                        '年率1行目               ||08371  |'                        '年率1行目               
08399  |'                                                 ||08372  |'                                                 
08400  |'                        Select Case gbuMGetUPDRec||08373  |'                        Select Case gbuMGetUPDRec
08401  |'                            Case cAud            ||08374  |'                            Case cAud            
08402  |'                                .Cells(15, 13).Va||08375  |'                                .Cells(15, 13).Va
08403  |'                                    sWord26a & CS||08376  |'                                    sWord26a & CS
08404  |'                                    sAuda & sWord||08377  |'                                    sAuda & sWord
08405  |'                            Case cCad            ||08378  |'                            Case cCad            
08406  |'                                .Cells(15, 13).Va||08379  |'                                .Cells(15, 13).Va
08407  |'                                    sWord26a & CS||08380  |'                                    sWord26a & CS
08408  |'                                    sCada & sWord||08381  |'                                    sCada & sWord
08409  |'                            Case cChf            ||08382  |'                            Case cChf            
08410  |'                                .Cells(15, 13).Va||08383  |'                                .Cells(15, 13).Va
08411  |'                                    sWord26a & CS||08384  |'                                    sWord26a & CS
08412  |'                                    sChfa & sWord||08385  |'                                    sChfa & sWord
08413  |'                            Case cEur            ||08386  |'                            Case cEur            
08414  |'                                .Cells(15, 13).Va||08387  |'                                .Cells(15, 13).Va
08415  |'                                    sWord26a & CS||08388  |'                                    sWord26a & CS
08416  |'                                    sEura & sWord||08389  |'                                    sEura & sWord
08417  |'                            Case cGbp            ||08390  |'                            Case cGbp            
08418  |'                                .Cells(15, 13).Va||08391  |'                                .Cells(15, 13).Va
08419  |'                                    sWord26a & CS||08392  |'                                    sWord26a & CS
08420  |'                                    sGbpa & sWord||08393  |'                                    sGbpa & sWord
08421  |'                            Case cHkd            ||08394  |'                            Case cHkd            
08422  |'                                .Cells(15, 13).Va||08395  |'                                .Cells(15, 13).Va
08423  |'                                    sWord26a & CS||08396  |'                                    sWord26a & CS
08424  |'                                    sHkda & sWord||08397  |'                                    sHkda & sWord
08425  |'                            Case cJpy            ||08398  |'                            Case cJpy            
08426  |'                                .Cells(15, 13).Va||08399  |'                                .Cells(15, 13).Va
08427  |'                                    sWord26a & CS||08400  |'                                    sWord26a & CS
08428  |'                                    sYena & sWord||08401  |'                                    sYena & sWord
08429  |'                            Case cMyr            ||08402  |'                            Case cMyr            
08430  |'                                .Cells(15, 13).Va||08403  |'                                .Cells(15, 13).Va
08431  |'                                    sWord26a & CS||08404  |'                                    sWord26a & CS
08432  |'                                    sMyra & sWord||08405  |'                                    sMyra & sWord
08433  |'                            Case cNzd            ||08406  |'                            Case cNzd            
08434  |'                                .Cells(15, 13).Va||08407  |'                                .Cells(15, 13).Va
08435  |'                                    sWord26a & CS||08408  |'                                    sWord26a & CS
08436  |'                                    sNzda & sWord||08409  |'                                    sNzda & sWord
08437  |'                            Case cSek            ||08410  |'                            Case cSek            
08438  |'                                .Cells(15, 13).Va||08411  |'                                .Cells(15, 13).Va
08439  |'                                    sWord26a & CS||08412  |'                                    sWord26a & CS
08440  |'                                    sSeka & sWord||08413  |'                                    sSeka & sWord
08441  |'                            Case cSgd            ||08414  |'                            Case cSgd            
08442  |'                                .Cells(15, 13).Va||08415  |'                                .Cells(15, 13).Va
08443  |'                                    sWord26a & CS||08416  |'                                    sWord26a & CS
08444  |'                                    sSgda & sWord||08417  |'                                    sSgda & sWord
08445  |'                            Case cUsd            ||08418  |'                            Case cUsd            
08446  |'                                .Cells(15, 13).Va||08419  |'                                .Cells(15, 13).Va
08447  |'                                    sWord26a & CS||08420  |'                                    sWord26a & CS
08448  |'                                    sUsda & sWord||08421  |'                                    sUsda & sWord
08449  |'                            Case cNok            ||08422  |'                            Case cNok            
08450  |'                                .Cells(15, 13).Va||08423  |'                                .Cells(15, 13).Va
08451  |'                                    sWord26a & CS||08424  |'                                    sWord26a & CS
08452  |'                                    sNoka & sWord||08425  |'                                    sNoka & sWord
08453  |'                        End Select               ||08426  |'                        End Select               
08454  |'                                                 ||08427  |'                                                 
08455  |'                        '年率　累積値セット      ||08428  |'                        '年率　累積値セット      
08456  |'                        TotalRate = CCur(gbuOther||08429  |'                        TotalRate = CCur(gbuOther
08457  |'                    ElseIf i = UBound(gbuOtherCom||08430  |'                    ElseIf i = UBound(gbuOtherCom
08458  |'                        If UBound(gbuOtherComRate||08431  |'                        If UBound(gbuOtherComRate
08459  |'                            '年率最終行          ||08432  |'                            '年率最終行          
08460  |'                                                 ||08433  |'                                                 
08461  |'                            '前半金額部分        ||08434  |'                            '前半金額部分        
08462  |'                            .Cells(15 + i + UBoun||08435  |'                            .Cells(15 + i + UBoun
08463  |'                                                 ||08436  |'                                                 
08464  |'                            If gbuMGetUPDRec.N(lR||08437  |'                            If gbuMGetUPDRec.N(lR
08465  |'                                .Cells(15 + i + U||08438  |'                                .Cells(15 + i + U
08466  |'                            Else                 ||08439  |'                            Else                 
08467  |'                                .Cells(15 + i + U||08440  |'                                .Cells(15 + i + U
08468  |'                            End If               ||08441  |'                            End If               
08469  |'                                                 ||08442  |'                                                 
08470  |'                            '後半の文言          ||08443  |'                            '後半の文言          
08471  |'                            Select Case gbuMGetUP||08444  |'                            Select Case gbuMGetUP
08472  |'                                Case cAud        ||08445  |'                                Case cAud        
08473  |'                                    .Cells(15 + i||08446  |'                                    .Cells(15 + i
08474  |'                                         sAuda & ||08447  |'                                         sAuda & 
08475  |'                                Case cCad        ||08448  |'                                Case cCad        
08476  |'                                    .Cells(15 + i||08449  |'                                    .Cells(15 + i
08477  |'                                         sCada & ||08450  |'                                         sCada & 
08478  |'                                Case cChf        ||08451  |'                                Case cChf        
08479  |'                                    .Cells(15 + i||08452  |'                                    .Cells(15 + i
08480  |'                                         sChfa & ||08453  |'                                         sChfa & 
08481  |'                                Case cEur        ||08454  |'                                Case cEur        
08482  |'                                    .Cells(15 + i||08455  |'                                    .Cells(15 + i
08483  |'                                         sEura & ||08456  |'                                         sEura & 
08484  |'                                Case cGbp        ||08457  |'                                Case cGbp        
08485  |'                                    .Cells(15 + i||08458  |'                                    .Cells(15 + i
08486  |'                                         sGbpa & ||08459  |'                                         sGbpa & 
08487  |'                                Case cHkd        ||08460  |'                                Case cHkd        
08488  |'                                    .Cells(15 + i||08461  |'                                    .Cells(15 + i
08489  |'                                         sHkda & ||08462  |'                                         sHkda & 
08490  |'                                Case cJpy        ||08463  |'                                Case cJpy        
08491  |'                                    .Cells(15 + i||08464  |'                                    .Cells(15 + i
08492  |'                                         sYena & ||08465  |'                                         sYena & 
08493  |'                                Case cMyr        ||08466  |'                                Case cMyr        
08494  |'                                    .Cells(15 + i||08467  |'                                    .Cells(15 + i
08495  |'                                         sMyra & ||08468  |'                                         sMyra & 
08496  |'                                Case cNzd        ||08469  |'                                Case cNzd        
08497  |'                                    .Cells(15 + i||08470  |'                                    .Cells(15 + i
08498  |'                                         sNzda & ||08471  |'                                         sNzda & 
08499  |'                                Case cSek        ||08472  |'                                Case cSek        
08500  |'                                    .Cells(15 + i||08473  |'                                    .Cells(15 + i
08501  |'                                         sSeka & ||08474  |'                                         sSeka & 
08502  |'                                Case cSgd        ||08475  |'                                Case cSgd        
08503  |'                                    .Cells(15 + i||08476  |'                                    .Cells(15 + i
08504  |'                                         sSgda & ||08477  |'                                         sSgda & 
08505  |'                                Case cUsd        ||08478  |'                                Case cUsd        
08506  |'                                    .Cells(15 + i||08479  |'                                    .Cells(15 + i
08507  |'                                         sUsda & ||08480  |'                                         sUsda & 
08508  |'                                Case cNok        ||08481  |'                                Case cNok        
08509  |'                                    .Cells(15 + i||08482  |'                                    .Cells(15 + i
08510  |'                                         sNoka & ||08483  |'                                         sNoka & 
08511  |'                            End Select           ||08484  |'                            End Select           
08512  |'                        Else                     ||08485  |'                        Else                     
08513  |'                            '年率最終行          ||08486  |'                            '年率最終行          
08514  |'                            '前半金額部分        ||08487  |'                            '前半金額部分        
08515  |'                            .Cells(15 + i + UBoun||08488  |'                            .Cells(15 + i + UBoun
08516  |'                            If gbuMGetUPDRec.N(lR||08489  |'                            If gbuMGetUPDRec.N(lR
08517  |'                                .Cells(15 + i + U||08490  |'                                .Cells(15 + i + U
08518  |'                            Else                 ||08491  |'                            Else                 
08519  |'                                .Cells(15 + i + U||08492  |'                                .Cells(15 + i + U
08520  |'                            End If               ||08493  |'                            End If               
08521  |'                                                 ||08494  |'                                                 
08522  |'                            '後半の文言          ||08495  |'                            '後半の文言          
08523  |'                            .Cells(15 + i + UBoun||08496  |'                            .Cells(15 + i + UBoun
08524  |'                                                 ||08497  |'                                                 
08525  |'                            Select Case gbuMGetUP||08498  |'                            Select Case gbuMGetUP
08526  |'                                Case cAud        ||08499  |'                                Case cAud        
08527  |'                                    .Cells(15 + i||08500  |'                                    .Cells(15 + i
08528  |'                                         sAuda & ||08501  |'                                         sAuda & 
08529  |'                                Case cCad        ||08502  |'                                Case cCad        
08530  |'                                    .Cells(15 + i||08503  |'                                    .Cells(15 + i
08531  |'                                         sCada & ||08504  |'                                         sCada & 
08532  |'                                Case cChf        ||08505  |'                                Case cChf        
08533  |'                                    .Cells(15 + i||08506  |'                                    .Cells(15 + i
08534  |'                                         sChfa & ||08507  |'                                         sChfa & 
08535  |'                                Case cEur        ||08508  |'                                Case cEur        
08536  |'                                    .Cells(15 + i||08509  |'                                    .Cells(15 + i
08537  |'                                         sEura & ||08510  |'                                         sEura & 
08538  |'                                Case cGbp        ||08511  |'                                Case cGbp        
08539  |'                                    .Cells(15 + i||08512  |'                                    .Cells(15 + i
08540  |'                                         sGbpa & ||08513  |'                                         sGbpa & 
08541  |'                                Case cHkd        ||08514  |'                                Case cHkd        
08542  |'                                    .Cells(15 + i||08515  |'                                    .Cells(15 + i
08543  |'                                         sHkda & ||08516  |'                                         sHkda & 
08544  |'                                Case cJpy        ||08517  |'                                Case cJpy        
08545  |'                                    .Cells(15 + i||08518  |'                                    .Cells(15 + i
08546  |'                                         sYena & ||08519  |'                                         sYena & 
08547  |'                                Case cMyr        ||08520  |'                                Case cMyr        
08548  |'                                    .Cells(15 + i||08521  |'                                    .Cells(15 + i
08549  |'                                         sMyra & ||08522  |'                                         sMyra & 
08550  |'                                Case cNzd        ||08523  |'                                Case cNzd        
08551  |'                                    .Cells(15 + i||08524  |'                                    .Cells(15 + i
08552  |'                                         sNzda & ||08525  |'                                         sNzda & 
08553  |'                                Case cSek        ||08526  |'                                Case cSek        
08554  |'                                    .Cells(15 + i||08527  |'                                    .Cells(15 + i
08555  |'                                         sSeka & ||08528  |'                                         sSeka & 
08556  |'                                Case cSgd        ||08529  |'                                Case cSgd        
08557  |'                                    .Cells(15 + i||08530  |'                                    .Cells(15 + i
08558  |'                                         sSgda & ||08531  |'                                         sSgda & 
08559  |'                                Case cUsd        ||08532  |'                                Case cUsd        
08560  |'                                    .Cells(15 + i||08533  |'                                    .Cells(15 + i
08561  |'                                         sUsda & ||08534  |'                                         sUsda & 
08562  |'                                Case cNok        ||08535  |'                                Case cNok        
08563  |'                                    .Cells(15 + i||08536  |'                                    .Cells(15 + i
08564  |'                                         sNoka & ||08537  |'                                         sNoka & 
08565  |'                            End Select           ||08538  |'                            End Select           
08566  |'                        End If                   ||08539  |'                        End If                   
08567  |'                    Else                         ||08540  |'                    Else                         
08568  |'                                                 ||08541  |'                                                 
08569  |'                        '年率2行目以降           ||08542  |'                        '年率2行目以降           
08570  |'                        '前半金額部分            ||08543  |'                        '前半金額部分            
08571  |'                        .Cells(15 + i + (i - 1), ||08544  |'                        .Cells(15 + i + (i - 1), 
08572  |'                                                 ||08545  |'                                                 
08573  |'                        If gbuMGetUPDRec.N(lRecId||08546  |'                        If gbuMGetUPDRec.N(lRecId
08574  |'                            .Cells(15 + i + (i - ||08547  |'                            .Cells(15 + i + (i - 
08575  |'                              sWord28a & CStr(For||08548  |'                              sWord28a & CStr(For
08576  |'                        Else                     ||08549  |'                        Else                     
08577  |'                            .Cells(15 + i + (i - ||08550  |'                            .Cells(15 + i + (i - 
08578  |'                              sWord28a & CStr(For||08551  |'                              sWord28a & CStr(For
08579  |'                        End If                   ||08552  |'                        End If                   
08580  |'                                                 ||08553  |'                                                 
08581  |'                        '年率　累積値セット      ||08554  |'                        '年率　累積値セット      
08582  |'                        TotalRate = TotalRate + C||08555  |'                        TotalRate = TotalRate + C
08583  |'                        '後半の文言              ||08556  |'                        '後半の文言              
08584  |'                        .Cells(15 + i + i, 13).Nu||08557  |'                        .Cells(15 + i + i, 13).Nu
08585  |'                        Select Case gbuMGetUPDRec||08558  |'                        Select Case gbuMGetUPDRec
08586  |'                            Case cAud            ||08559  |'                            Case cAud            
08587  |'                                .Cells(15 + i + i||08560  |'                                .Cells(15 + i + i
08588  |'                                    sAuda & sWord||08561  |'                                    sAuda & sWord
08589  |'                                    Format(gbuOth||08562  |'                                    Format(gbuOth
08590  |'                            Case cCad            ||08563  |'                            Case cCad            
08591  |'                                .Cells(15 + i + i||08564  |'                                .Cells(15 + i + i
08592  |'                                    sCada & sWord||08565  |'                                    sCada & sWord
08593  |'                                    Format(gbuOth||08566  |'                                    Format(gbuOth
08594  |'                            Case cChf            ||08567  |'                            Case cChf            
08595  |'                                .Cells(15 + i + i||08568  |'                                .Cells(15 + i + i
08596  |'                                    sChfa & sWord||08569  |'                                    sChfa & sWord
08597  |'                                    Format(gbuOth||08570  |'                                    Format(gbuOth
08598  |'                            Case cEur            ||08571  |'                            Case cEur            
08599  |'                                .Cells(15 + i + i||08572  |'                                .Cells(15 + i + i
08600  |'                                    sEura & sWord||08573  |'                                    sEura & sWord
08601  |'                                    Format(gbuOth||08574  |'                                    Format(gbuOth
08602  |'                            Case cGbp            ||08575  |'                            Case cGbp            
08603  |'                                .Cells(15 + i + i||08576  |'                                .Cells(15 + i + i
08604  |'                                    sGbpa & sWord||08577  |'                                    sGbpa & sWord
08605  |'                                    Format(gbuOth||08578  |'                                    Format(gbuOth
08606  |'                            Case cHkd            ||08579  |'                            Case cHkd            
08607  |'                                .Cells(15 + i + i||08580  |'                                .Cells(15 + i + i
08608  |'                                    sHkda & sWord||08581  |'                                    sHkda & sWord
08609  |'                                    Format(gbuOth||08582  |'                                    Format(gbuOth
08610  |'                            Case cJpy            ||08583  |'                            Case cJpy            
08611  |'                                .Cells(15 + i + i||08584  |'                                .Cells(15 + i + i
08612  |'                                    sYena & sWord||08585  |'                                    sYena & sWord
08613  |'                                    Format(gbuOth||08586  |'                                    Format(gbuOth
08614  |'                            Case cMyr            ||08587  |'                            Case cMyr            
08615  |'                                .Cells(15 + i + i||08588  |'                                .Cells(15 + i + i
08616  |'                                    sMyra & sWord||08589  |'                                    sMyra & sWord
08617  |'                                    Format(gbuOth||08590  |'                                    Format(gbuOth
08618  |'                            Case cNzd            ||08591  |'                            Case cNzd            
08619  |'                                .Cells(15 + i + i||08592  |'                                .Cells(15 + i + i
08620  |'                                    sNzda & sWord||08593  |'                                    sNzda & sWord
08621  |'                                    Format(gbuOth||08594  |'                                    Format(gbuOth
08622  |'                            Case cSek            ||08595  |'                            Case cSek            
08623  |'                                .Cells(15 + i + i||08596  |'                                .Cells(15 + i + i
08624  |'                                    sSeka & sWord||08597  |'                                    sSeka & sWord
08625  |'                                    Format(gbuOth||08598  |'                                    Format(gbuOth
08626  |'                            Case cSgd            ||08599  |'                            Case cSgd            
08627  |'                                .Cells(15 + i + i||08600  |'                                .Cells(15 + i + i
08628  |'                                    sSgda & sWord||08601  |'                                    sSgda & sWord
08629  |'                                    Format(gbuOth||08602  |'                                    Format(gbuOth
08630  |'                            Case cUsd            ||08603  |'                            Case cUsd            
08631  |'                                .Cells(15 + i + i||08604  |'                                .Cells(15 + i + i
08632  |'                                    sUsda & sWord||08605  |'                                    sUsda & sWord
08633  |'                                    Format(gbuOth||08606  |'                                    Format(gbuOth
08634  |'                            Case cNok            ||08607  |'                            Case cNok            
08635  |'                                .Cells(15 + i + i||08608  |'                                .Cells(15 + i + i
08636  |'                                    sNoka & sWord||08609  |'                                    sNoka & sWord
08637  |'                                    Format(gbuOth||08610  |'                                    Format(gbuOth
08638  |'                        End Select               ||08611  |'                        End Select               
08639  |'                    End If                       ||08612  |'                    End If                       
08640  |'                Next i                           ||08613  |'                Next i                           
08641  |'            End If                               ||08614  |'            End If                               
08642  |'                                                 ||08615  |'                                                 
08643  |'        '投資顧問料                              ||08616  |'        '投資顧問料                              
08644  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).||08617  |'        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).
08645  |'            Case Mid(mstrContractFlag(1), 1, 1)  ||08618  |'            Case Mid(mstrContractFlag(1), 1, 1)  
08646  |'                .Cells(46, 2).Value = sWord11d   ||08619  |'                .Cells(46, 2).Value = sWord11d   
08647  |'            Case Mid(mstrContractFlag(2), 1, 1)  ||08620  |'            Case Mid(mstrContractFlag(2), 1, 1)  
08648  |'                .Cells(46, 2).Value = sWord11e   ||08621  |'                .Cells(46, 2).Value = sWord11e   
08649  |'            Case Mid(mstrContractFlag(3), 1, 1)  ||08622  |'            Case Mid(mstrContractFlag(3), 1, 1)  
08650  |'                .Cells(46, 2).Value = sWord11f   ||08623  |'                .Cells(46, 2).Value = sWord11f   
08651  |'            Case Else                            ||08624  |'            Case Else                            
08652  |'                MsgBox "契約区分が不正です。", vb||08625  |'                MsgBox "契約区分が不正です。", vb
08653  |'        End Select                               ||08626  |'        End Select                               
08654  |'        .Cells(46, 11).Value = sWord19           ||08627  |'        .Cells(46, 11).Value = sWord19           
08655  |'                                                 ||08628  |'                                                 
08656  |'        '外部委託顧問料                          ||08629  |'        '外部委託顧問料                          
08657  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||08630  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
08658  |'            .Cells(46, 31).NumberFormatLocal = "@||08631  |'            .Cells(46, 31).NumberFormatLocal = "@
08659  |'        Else                                     ||08632  |'        Else                                     
08660  |'            .Cells(46, 29).NumberFormatLocal = "@||08633  |'            .Cells(46, 29).NumberFormatLocal = "@
08661  |'        End If                                   ||08634  |'        End If                                   
08662  |'                                                 ||08635  |'                                                 
08663  |'        '契約区分が名称使用許諾料の場合上限・下限||08636  |'        '契約区分が名称使用許諾料の場合上限・下限
08664  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||08637  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
08665  |'            '下限金額より換算した金額が小さい場合||08638  |'            '下限金額より換算した金額が小さい場合
08666  |'            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_||08639  |'            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_
08667  |'                If mstrMonthlyPayCom < CDbl(gbuMG||08640  |'                If mstrMonthlyPayCom < CDbl(gbuMG
08668  |'                    mstrMonthlyPayCom = CDbl(gbuM||08641  |'                    mstrMonthlyPayCom = CDbl(gbuM
08669  |'                End If                           ||08642  |'                End If                           
08670  |'            End If                               ||08643  |'            End If                               
08671  |'            '上限金額より換算した金額が大きい場合||08644  |'            '上限金額より換算した金額が大きい場合
08672  |'            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_||08645  |'            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_
08673  |'                If mstrMonthlyPayCom > CDbl(gbuMG||08646  |'                If mstrMonthlyPayCom > CDbl(gbuMG
08674  |'                    mstrMonthlyPayCom = CDbl(gbuM||08647  |'                    mstrMonthlyPayCom = CDbl(gbuM
08675  |'                End If                           ||08648  |'                End If                           
08676  |'            End If                               ||08649  |'            End If                               
08677  |'                                                 ||08650  |'                                                 
08678  |'            dblValueIn = CDbl(mstrMonthlyPayCom) ||08651  |'            dblValueIn = CDbl(mstrMonthlyPayCom) 
08679  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou||08652  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou
08680  |'                Call sbGetRoundValue2(dblValueIn)||08653  |'                Call sbGetRoundValue2(dblValueIn)
08681  |'            Else                                 ||08654  |'            Else                                 
08682  |'                Call sbGetRoundValue(dblValueIn) ||08655  |'                Call sbGetRoundValue(dblValueIn) 
08683  |'            End If                               ||08656  |'            End If                               
08684  |'            mstrMonthlyPayCom = dblValueOut      ||08657  |'            mstrMonthlyPayCom = dblValueOut      
08685  |'                                                 ||08658  |'                                                 
08686  |'        End If                                   ||08659  |'        End If                                   
08687  |'                                                 ||08660  |'                                                 
08688  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET||08661  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET
08689  |'            Case cAud                            ||08662  |'            Case cAud                            
08690  |'                .Cells(46, 31).Value = CStr(Forma||08663  |'                .Cells(46, 31).Value = CStr(Forma
08691  |'                .Cells(46, 32).Value = sAuda     ||08664  |'                .Cells(46, 32).Value = sAuda     
08692  |'            Case cCad                            ||08665  |'            Case cCad                            
08693  |'                .Cells(46, 31).Value = CStr(Forma||08666  |'                .Cells(46, 31).Value = CStr(Forma
08694  |'                .Cells(46, 32).Value = sCada     ||08667  |'                .Cells(46, 32).Value = sCada     
08695  |'            Case cChf                            ||08668  |'            Case cChf                            
08696  |'                .Cells(46, 31).Value = CStr(Forma||08669  |'                .Cells(46, 31).Value = CStr(Forma
08697  |'                .Cells(46, 32).Value = sChfa     ||08670  |'                .Cells(46, 32).Value = sChfa     
08698  |'            Case cEur                            ||08671  |'            Case cEur                            
08699  |'                .Cells(46, 31).Value = CStr(Forma||08672  |'                .Cells(46, 31).Value = CStr(Forma
08700  |'                .Cells(46, 32).Value = sEura     ||08673  |'                .Cells(46, 32).Value = sEura     
08701  |'            Case cGbp                            ||08674  |'            Case cGbp                            
08702  |'                .Cells(46, 31).Value = CStr(Forma||08675  |'                .Cells(46, 31).Value = CStr(Forma
08703  |'                .Cells(46, 32).Value = sGbpa     ||08676  |'                .Cells(46, 32).Value = sGbpa     
08704  |'            Case cHkd                            ||08677  |'            Case cHkd                            
08705  |'                .Cells(46, 31).Value = CStr(Forma||08678  |'                .Cells(46, 31).Value = CStr(Forma
08706  |'                .Cells(46, 32).Value = sHkda     ||08679  |'                .Cells(46, 32).Value = sHkda     
08707  |'            Case cJpy                            ||08680  |'            Case cJpy                            
08708  |'                .Cells(46, 29).Value = CStr(Forma||08681  |'                .Cells(46, 29).Value = CStr(Forma
08709  |'                .Cells(46, 32).Value = sYena     ||08682  |'                .Cells(46, 32).Value = sYena     
08710  |'            Case cMyr                            ||08683  |'            Case cMyr                            
08711  |'                .Cells(46, 31).Value = CStr(Forma||08684  |'                .Cells(46, 31).Value = CStr(Forma
08712  |'                .Cells(46, 32).Value = sMyra     ||08685  |'                .Cells(46, 32).Value = sMyra     
08713  |'            Case cNzd                            ||08686  |'            Case cNzd                            
08714  |'                .Cells(46, 31).Value = CStr(Forma||08687  |'                .Cells(46, 31).Value = CStr(Forma
08715  |'                .Cells(46, 32).Value = sNzda     ||08688  |'                .Cells(46, 32).Value = sNzda     
08716  |'            Case cSek                            ||08689  |'            Case cSek                            
08717  |'                .Cells(46, 31).Value = CStr(Forma||08690  |'                .Cells(46, 31).Value = CStr(Forma
08718  |'                .Cells(46, 32).Value = sSeka     ||08691  |'                .Cells(46, 32).Value = sSeka     
08719  |'            Case cSgd                            ||08692  |'            Case cSgd                            
08720  |'                .Cells(46, 31).Value = CStr(Forma||08693  |'                .Cells(46, 31).Value = CStr(Forma
08721  |'                .Cells(46, 32).Value = sSgda     ||08694  |'                .Cells(46, 32).Value = sSgda     
08722  |'            Case cUsd                            ||08695  |'            Case cUsd                            
08723  |'                .Cells(46, 31).Value = CStr(Forma||08696  |'                .Cells(46, 31).Value = CStr(Forma
08724  |'                .Cells(46, 32).Value = sUsda     ||08697  |'                .Cells(46, 32).Value = sUsda     
08725  |'            Case cNok                            ||08698  |'            Case cNok                            
08726  |'                .Cells(46, 31).Value = CStr(Forma||08699  |'                .Cells(46, 31).Value = CStr(Forma
08727  |'                .Cells(46, 32).Value = sNoka     ||08700  |'                .Cells(46, 32).Value = sNoka     
08728  |'        End Select                               ||08701  |'        End Select                               
08729  |'                                                 ||08702  |'                                                 
08730  |'        '顧問料                                  ||08703  |'        '顧問料                                  
08731  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||08704  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
08732  |'            .Cells(46, 31).HorizontalAlignment = ||08705  |'            .Cells(46, 31).HorizontalAlignment = 
08733  |'        Else                                     ||08706  |'        Else                                     
08734  |'            .Cells(46, 29).HorizontalAlignment = ||08707  |'            .Cells(46, 29).HorizontalAlignment = 
08735  |'        End If                                   ||08708  |'        End If                                   
08736  |'                                                 ||08709  |'                                                 
08737  |'        '契約区分が名称使用許諾料の場合上限・下限||08710  |'        '契約区分が名称使用許諾料の場合上限・下限
08738  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||08711  |'        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
08739  |'            '上限金額                            ||08712  |'            '上限金額                            
08740  |'            .Cells(46, 45).Value = sWordCapa     ||08713  |'            .Cells(46, 45).Value = sWordCapa     
08741  |'            .Cells(46, 57).NumberFormatLocal = "@||08714  |'            .Cells(46, 57).NumberFormatLocal = "@
08742  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou||08715  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou
08743  |'                .Cells(46, 57).Value = Format(gbu||08716  |'                .Cells(46, 57).Value = Format(gbu
08744  |'            Else                                 ||08717  |'            Else                                 
08745  |'                .Cells(46, 57).Value = Format(gbu||08718  |'                .Cells(46, 57).Value = Format(gbu
08746  |'            End If                               ||08719  |'            End If                               
08747  |'                                                 ||08720  |'                                                 
08748  |'            .Cells(46, 57).HorizontalAlignment = ||08721  |'            .Cells(46, 57).HorizontalAlignment = 
08749  |'                                                 ||08722  |'                                                 
08750  |'            '下限金額                            ||08723  |'            '下限金額                            
08751  |'            .Cells(47, 45).Value = sWordFloora   ||08724  |'            .Cells(47, 45).Value = sWordFloora   
08752  |'            .Cells(47, 57).NumberFormatLocal = "@||08725  |'            .Cells(47, 57).NumberFormatLocal = "@
08753  |'                                                 ||08726  |'                                                 
08754  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou||08727  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou
08755  |'                .Cells(47, 57).Value = Format(gbu||08728  |'                .Cells(47, 57).Value = Format(gbu
08756  |'            Else                                 ||08729  |'            Else                                 
08757  |'                .Cells(47, 57).Value = Format(gbu||08730  |'                .Cells(47, 57).Value = Format(gbu
08758  |'            End If                               ||08731  |'            End If                               
08759  |'            .Cells(47, 57).HorizontalAlignment = ||08732  |'            .Cells(47, 57).HorizontalAlignment = 
08760  |'        End If                                   ||08733  |'        End If                                   
08761  |'                                                 ||08734  |'                                                 
08762  |'        ddblExchangeRate = 0                     ||08735  |'        ddblExchangeRate = 0                     
08763  |'                                                 ||08736  |'                                                 
08764  |'        dblValueIn = mstrMonthlyPayCom           ||08737  |'        dblValueIn = mstrMonthlyPayCom           
08765  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET||08738  |'        Select Case gbuMGetUPDRec.N(lRecIdx).MGET
08766  |'          Case "1"    '固定料率                  ||08739  |'          Case "1"    '固定料率                  
08767  |'                                                 ||08740  |'                                                 
08768  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||08741  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
08769  |'                Else                             ||08742  |'                Else                             
08770  |'                  '外部委託顧問料通貨→JPYの為替 ||08743  |'                  '外部委託顧問料通貨→JPYの為替 
08771  |'                  dstrCurrencyCode = gbuMGetUPDRe||08744  |'                  dstrCurrencyCode = gbuMGetUPDRe
08772  |'                  ddblExchangeRate = fnstrExchang||08745  |'                  ddblExchangeRate = fnstrExchang
08773  |'                  If ddblExchangeRate = 0 Then   ||08746  |'                  If ddblExchangeRate = 0 Then   
08774  |'                    intRtn = MsgBox("ＴＴＭが取得||08747  |'                    intRtn = MsgBox("ＴＴＭが取得
08775  |'                    vbLf & "対象通貨コード ： [ "||08748  |'                    vbLf & "対象通貨コード ： [ "
08776  |'                    vbLf & "基準日 ： [ " & Mid(d||08749  |'                    vbLf & "基準日 ： [ " & Mid(d
08777  |'                        vbCritical, "ＴＴＭ取得エ||08750  |'                        vbCritical, "ＴＴＭ取得エ
08778  |'                    Exit Function                ||08751  |'                    Exit Function                
08779  |'                  End If                         ||08752  |'                  End If                         
08780  |'                  'JPY→支払通貨へレート換算     ||08753  |'                  'JPY→支払通貨へレート換算     
08781  |'                  dblValueIn = dblValueIn * ddblE||08754  |'                  dblValueIn = dblValueIn * ddblE
08782  |'                End If                           ||08755  |'                End If                           
08783  |'                                                 ||08756  |'                                                 
08784  |'          Case "2"    '段階料率                  ||08757  |'          Case "2"    '段階料率                  
08785  |'                                                 ||08758  |'                                                 
08786  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe||08759  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe
08787  |'            Else                                 ||08760  |'            Else                                 
08788  |'                '外部委託顧問料通貨→JPYの為替レ ||08761  |'                '外部委託顧問料通貨→JPYの為替レ 
08789  |'                dstrCurrencyCode = gbuMGetUPDRec.||08762  |'                dstrCurrencyCode = gbuMGetUPDRec.
08790  |'                ddblExchangeRate = fnstrExchangeR||08763  |'                ddblExchangeRate = fnstrExchangeR
08791  |'                If ddblExchangeRate = 0 Then     ||08764  |'                If ddblExchangeRate = 0 Then     
08792  |'                  intRtn = MsgBox("ＴＴＭが取得で||08765  |'                  intRtn = MsgBox("ＴＴＭが取得で
08793  |'                  vbLf & "対象通貨コード ： [ " &||08766  |'                  vbLf & "対象通貨コード ： [ " &
08794  |'                  vbLf & "基準日 ： [ " & Mid(dst||08767  |'                  vbLf & "基準日 ： [ " & Mid(dst
08795  |'                      vbCritical, "ＴＴＭ取得エラ||08768  |'                      vbCritical, "ＴＴＭ取得エラ
08796  |'                  Exit Function                  ||08769  |'                  Exit Function                  
08797  |'                End If                           ||08770  |'                End If                           
08798  |'                '外部委託顧問料通貨→JPYへレート ||08771  |'                '外部委託顧問料通貨→JPYへレート 
08799  |'                dblValueIn = dblValueIn * ddblExc||08772  |'                dblValueIn = dblValueIn * ddblExc
08800  |'            End If                               ||08773  |'            End If                               
08801  |'                                                 ||08774  |'                                                 
08802  |'        End Select                               ||08775  |'        End Select                               
08803  |'        '@@@@@ 支払に換算 @@@@@                  ||08776  |'        '@@@@@ 支払に換算 @@@@@                  
08804  |'        Call sbGetRoundValue(dblValueIn)         ||08777  |'        Call sbGetRoundValue(dblValueIn)         
08805  |'        mstrMonthlyPayCom = dblValueOut          ||08778  |'        mstrMonthlyPayCom = dblValueOut          
08806  |'                                                 ||08779  |'                                                 
08807  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe||08780  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_othe
08808  |'                'TTMレート                       ||08781  |'                'TTMレート                       
08809  |'                .Cells(47, 19).Value = sWord43   ||08782  |'                .Cells(47, 19).Value = sWord43   
08810  |'                .Cells(47, 33).NumberFormatLocal ||08783  |'                .Cells(47, 33).NumberFormatLocal 
08811  |'                .Cells(47, 33).Value = Format(ddb||08784  |'                .Cells(47, 33).Value = Format(ddb
08812  |'                .Cells(47, 33).HorizontalAlignmen||08785  |'                .Cells(47, 33).HorizontalAlignmen
08813  |'                .Cells(47, 34).Value = sWord44   ||08786  |'                .Cells(47, 34).Value = sWord44   
08814  |'            End If                               ||08787  |'            End If                               
08815  |'                                                 ||08788  |'                                                 
08816  |'            '支払額                              ||08789  |'            '支払額                              
08817  |'            .Cells(48, 2).Value = sWord46a       ||08790  |'            .Cells(48, 2).Value = sWord46a       
08818  |'            .Cells(48, 11).Value = sWord19       ||08791  |'            .Cells(48, 11).Value = sWord19       
08819  |'                                                 ||08792  |'                                                 
08820  |'            '税抜金額(月別支払顧問料の累計)      ||08793  |'            '税抜金額(月別支払顧問料の累計)      
08821  |'            .Cells(48, 29).NumberFormatLocal = "@||08794  |'            .Cells(48, 29).NumberFormatLocal = "@
08822  |'            .Cells(48, 29).Value = CStr(Format(ms||08795  |'            .Cells(48, 29).Value = CStr(Format(ms
08823  |'            .Cells(48, 29).HorizontalAlignment = ||08796  |'            .Cells(48, 29).HorizontalAlignment = 
08824  |'            .Cells(48, 32).Value = sYena         ||08797  |'            .Cells(48, 32).Value = sYena         
08825  |'                                                 ||08798  |'                                                 
08826  |'        '消費税計算有無：「有り」の場合のみ、消費||08799  |'        '消費税計算有無：「有り」の場合のみ、消費
08827  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc||08800  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc
08828  |'            '(消費税XX%)                         ||08801  |'            '(消費税XX%)                         
08829  |'            iSyouhizei = ddblconsumption_tax     ||08802  |'            iSyouhizei = ddblconsumption_tax     
08830  |'            .Cells(49, 32).Value = sWord22a & iSy||08803  |'            .Cells(49, 32).Value = sWord22a & iSy
08831  |'            dblValueIn = mstrMonthlyPayCom * iSyo||08804  |'            dblValueIn = mstrMonthlyPayCom * iSyo
08832  |'            Call sbGetRoundValueTax(dblValueIn)  ||08805  |'            Call sbGetRoundValueTax(dblValueIn)  
08833  |'            lTaxNum = dblValueOut                ||08806  |'            lTaxNum = dblValueOut                
08834  |'            .Cells(49, 29).NumberFormatLocal = "@||08807  |'            .Cells(49, 29).NumberFormatLocal = "@
08835  |'            .Cells(49, 29).Value = CStr(Format((l||08808  |'            .Cells(49, 29).Value = CStr(Format((l
08836  |'            .Cells(49, 29).HorizontalAlignment = ||08809  |'            .Cells(49, 29).HorizontalAlignment = 
08837  |'            '合計(消費税＋月別支払顧問料の累計)  ||08810  |'            '合計(消費税＋月別支払顧問料の累計)  
08838  |'            .Cells(50, 13).Value = sWord24a      ||08811  |'            .Cells(50, 13).Value = sWord24a      
08839  |'            dblValueIn = lTaxNum + CCur(mstrMonth||08812  |'            dblValueIn = lTaxNum + CCur(mstrMonth
08840  |'            Call sbGetRoundValue(dblValueIn)     ||08813  |'            Call sbGetRoundValue(dblValueIn)     
08841  |'            lMonthlyPayCom = dblValueOut         ||08814  |'            lMonthlyPayCom = dblValueOut         
08842  |'            .Cells(50, 29).NumberFormatLocal = "@||08815  |'            .Cells(50, 29).NumberFormatLocal = "@
08843  |'            .Cells(50, 29).Value = CStr(Format(lM||08816  |'            .Cells(50, 29).Value = CStr(Format(lM
08844  |'            .Cells(50, 29).HorizontalAlignment = ||08817  |'            .Cells(50, 29).HorizontalAlignment = 
08845  |'            '円                                  ||08818  |'            '円                                  
08846  |'            .Cells(50, 32).Value = sYena         ||08819  |'            .Cells(50, 32).Value = sYena         
08847  |'            '下線                                ||08820  |'            '下線                                
08848  |'            With xlSheet.Range("M49:AL49").Border||08821  |'            With xlSheet.Range("M49:AL49").Border
08849  |'                .LineStyle = xlContinuous        ||08822  |'                .LineStyle = xlContinuous        
08850  |'                .Weight = xlThin                 ||08823  |'                .Weight = xlThin                 
08851  |'            End With                             ||08824  |'            End With                             
08852  |'        Else                                     ||08825  |'        Else                                     
08853  |'        End If                                   ||08826  |'        End If                                   
08854  |'                                                 ||08827  |'                                                 
08855  |'        '支払予定日                              ||08828  |'        '支払予定日                              
08856  |'        .Cells(52, 2).Value = sWord13a           ||08829  |'        .Cells(52, 2).Value = sWord13a           
08857  |'        .Cells(52, 11).Value = sWord19           ||08830  |'        .Cells(52, 11).Value = sWord19           
08858  |'        .Cells(52, 13).NumberFormatLocal = "@"   ||08831  |'        .Cells(52, 13).NumberFormatLocal = "@"   
08859  |'        .Cells(52, 13).Value = CStr(Format(Trim(m||08832  |'        .Cells(52, 13).Value = CStr(Format(Trim(m
08860  |'                                                 ||08833  |'                                                 
08861  |'        '支払先                                  ||08834  |'        '支払先                                  
08862  |'        .Cells(54, 2).Value = sWord12a           ||08835  |'        .Cells(54, 2).Value = sWord12a           
08863  |'        .Cells(54, 11).Value = sWord19           ||08836  |'        .Cells(54, 11).Value = sWord19           
08864  |'        .Cells(54, 13).Value = gbuMGetUPDRec.N(lR||08837  |'        .Cells(54, 13).Value = gbuMGetUPDRec.N(lR
08865  |'                                                 ||08838  |'                                                 
08866  |'        '財務部                                  ||08839  |'        '財務部                                  
08867  |'        .Cells(60, 2).Value = sWord1a            ||08840  |'        .Cells(60, 2).Value = sWord1a            
08868  |'        .Cells(61, 2).Value = sWord2a            ||08841  |'        .Cells(61, 2).Value = sWord2a            
08869  |'                                                 ||08842  |'                                                 
08870  |'    End With                                     ||08843  |'    End With                                     
08871  |'                                                 ||08844  |'                                                 
08872  |'    '月末純資産(合計 上のライン)                 ||08845  |'    '月末純資産(合計 上のライン)                 
08873  |'    With xlSheet.Range("X39:AX40").Borders(xlInsi||08846  |'    With xlSheet.Range("X39:AX40").Borders(xlInsi
08874  |'        .LineStyle = xlContinuous                ||08847  |'        .LineStyle = xlContinuous                
08875  |'        .Weight = xlThin                         ||08848  |'        .Weight = xlThin                         
08876  |'    End With                                     ||08849  |'    End With                                     
08877  |'                                                 ||08850  |'                                                 
08878  |'    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract||08851  |'    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract
08879  |'    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_fla||08852  |'    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_fla
08880  |'                                                 ||08853  |'                                                 
08881  |'        xlSheet.Cells(13, 13).Value = _          ||08854  |'        xlSheet.Cells(13, 13).Value = _          
08882  |'            CStr(Format(dStart, "mmmm d , yyyy"))||08855  |'            CStr(Format(dStart, "mmmm d , yyyy"))
08883  |'    Else                                         ||08856  |'    Else                                         
08884  |'        xlSheet.Cells(13, 13).Value = _          ||08857  |'        xlSheet.Cells(13, 13).Value = _          
08885  |'            CStr(Format(dStart, "mmmm d , yyyy"))||08858  |'            CStr(Format(dStart, "mmmm d , yyyy"))
08886  |'    End If                                       ||08859  |'    End If                                       
08887  |'                                                 ||08860  |'                                                 
08888  |'    'A4印刷用に上2行を削除して、プレビュー範囲内 ||08861  |'    'A4印刷用に上2行を削除して、プレビュー範囲内 
08889  |'    xlSheet.Rows("1:2").Delete Shift:=xlUp       ||08862  |'    xlSheet.Rows("1:2").Delete Shift:=xlUp       
08890  |'                                                 ||08863  |'                                                 
08891  |''NAV取得区分：日次NAV平均(休日有)または日次NAV平 ||08864  |''NAV取得区分：日次NAV平均(休日有)または日次NAV平 
08892  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||08865  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
08893  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||08866  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
08894  |'                                                 ||08867  |'                                                 
08895  |'        J = 0                                    ||08868  |'        J = 0                                    
08896  |'        K = 0                                    ||08869  |'        K = 0                                    
08897  |'        '＋２は合計行と平均行                    ||08870  |'        '＋２は合計行と平均行                    
08898  |'        dintPage = (dlngCnt + 2) \ 108           ||08871  |'        dintPage = (dlngCnt + 2) \ 108           
08899  |'        dintAmari = (dlngCnt + 2) Mod 108        ||08872  |'        dintAmari = (dlngCnt + 2) Mod 108        
08900  |'        If dintAmari <> 0 Then                   ||08873  |'        If dintAmari <> 0 Then                   
08901  |'            dintPage = dintPage + 1              ||08874  |'            dintPage = dintPage + 1              
08902  |'        End If                                   ||08875  |'        End If                                   
08903  |'                                                 ||08876  |'                                                 
08904  |'        For L = 1 To dintPage                    ||08877  |'        For L = 1 To dintPage                    
08905  |'                                                 ||08878  |'                                                 
08906  |'            xlBook.Worksheets.Add after:=xlBook.S||08879  |'            xlBook.Worksheets.Add after:=xlBook.S
08907  |'            gProcessCnt = gProcessCnt + 1        ||08880  |'            gProcessCnt = gProcessCnt + 1        
08908  |'            Set xlSheet = xlBook.Sheets(gProcessC||08881  |'            Set xlSheet = xlBook.Sheets(gProcessC
08909  |'                                                 ||08882  |'                                                 
08910  |'            'Excelフォーマットを調整             ||08883  |'            'Excelフォーマットを調整             
08911  |'            xlSheet.Cells.ColumnWidth = 1        ||08884  |'            xlSheet.Cells.ColumnWidth = 1        
08912  |'            xlSheet.Cells.Font.Size = 11         ||08885  |'            xlSheet.Cells.Font.Size = 11         
08913  |'            'シート名を設定(日次NAV一覧**)       ||08886  |'            'シート名を設定(日次NAV一覧**)       
08914  |'                                                 ||08887  |'                                                 
08915  |'            If dstrOldAccCode = sGetAccCode Then ||08888  |'            If dstrOldAccCode = sGetAccCode Then 
08916  |'                gTotalDnavCnt = gTotalDnavCnt + 1||08889  |'                gTotalDnavCnt = gTotalDnavCnt + 1
08917  |'            Else                                 ||08890  |'            Else                                 
08918  |'                gTotalDnavCnt = 1                ||08891  |'                gTotalDnavCnt = 1                
08919  |'                dstrOldAccCode = sGetAccCode     ||08892  |'                dstrOldAccCode = sGetAccCode     
08920  |'            End If                               ||08893  |'            End If                               
08921  |'            gTotalCnt = gTotalCnt + 1            ||08894  |'            gTotalCnt = gTotalCnt + 1            
08922  |'            xlBook.Sheets(gProcessCnt).Name = sGe||08895  |'            xlBook.Sheets(gProcessCnt).Name = sGe
08923  |'                                                 ||08896  |'                                                 
08924  |'            'シートの余白を設定                  ||08897  |'            'シートの余白を設定                  
08925  |'            xlSheet.PageSetup.TopMargin = Applica||08898  |'            xlSheet.PageSetup.TopMargin = Applica
08926  |'            xlSheet.PageSetup.BottomMargin = Appl||08899  |'            xlSheet.PageSetup.BottomMargin = Appl
08927  |'            xlSheet.PageSetup.LeftMargin = Applic||08900  |'            xlSheet.PageSetup.LeftMargin = Applic
08928  |'            xlSheet.PageSetup.RightMargin = Appli||08901  |'            xlSheet.PageSetup.RightMargin = Appli
08929  |'                                                 ||08902  |'                                                 
08930  |'            DoEvents                             ||08903  |'            DoEvents                             
08931  |'                                                 ||08904  |'                                                 
08932  |'            With xlSheet                         ||08905  |'            With xlSheet                         
08933  |'                '題目                            ||08906  |'                '題目                            
08934  |'                .Cells(5, 1).Value = sWord47a    ||08907  |'                .Cells(5, 1).Value = sWord47a    
08935  |'                .Cells(5, 1).Font.Size = 14      ||08908  |'                .Cells(5, 1).Font.Size = 14      
08936  |'                .Range("A5:BG5").HorizontalAlignm||08909  |'                .Range("A5:BG5").HorizontalAlignm
08937  |'                '出力日付                        ||08910  |'                '出力日付                        
08938  |'                If RTrim(txtSysOutDate.Text) = ""||08911  |'                If RTrim(txtSysOutDate.Text) = ""
08939  |'                    .Cells(3, 50).NumberFormatLoc||08912  |'                    .Cells(3, 50).NumberFormatLoc
08940  |'                    .Cells(3, 50).Value = sWord34||08913  |'                    .Cells(3, 50).Value = sWord34
08941  |'                    .Cells(3, 50).HorizontalAlign||08914  |'                    .Cells(3, 50).HorizontalAlign
08942  |'                Else                             ||08915  |'                Else                             
08943  |'                    .Cells(3, 43).NumberFormatLoc||08916  |'                    .Cells(3, 43).NumberFormatLoc
08944  |'                    .Cells(3, 43).Value = CStr(Fo||08917  |'                    .Cells(3, 43).Value = CStr(Fo
08945  |'                End If                           ||08918  |'                End If                           
08946  |'                'ファンド名                      ||08919  |'                'ファンド名                      
08947  |'                .Cells(6, 2).Value = sWord4a     ||08920  |'                .Cells(6, 2).Value = sWord4a     
08948  |'                .Cells(6, 11).Value = sWord19    ||08921  |'                .Cells(6, 11).Value = sWord19    
08949  |'                .Cells(6, 13).Value = gbuMGetUPDR||08922  |'                .Cells(6, 13).Value = gbuMGetUPDR
08950  |'                'ファンドコード                  ||08923  |'                'ファンドコード                  
08951  |'                .Cells(7, 2).Value = sWord4_2a   ||08924  |'                .Cells(7, 2).Value = sWord4_2a   
08952  |'                .Cells(7, 11).Value = sWord19    ||08925  |'                .Cells(7, 11).Value = sWord19    
08953  |'                .Cells(7, 13).NumberFormatLocal =||08926  |'                .Cells(7, 13).NumberFormatLocal =
08954  |'                .Cells(7, 13).Value = sGetAccCode||08927  |'                .Cells(7, 13).Value = sGetAccCode
08955  |'                '計算期間                        ||08928  |'                '計算期間                        
08956  |'                .Cells(8, 2).Value = sWord5a     ||08929  |'                .Cells(8, 2).Value = sWord5a     
08957  |'                .Cells(8, 11).Value = sWord19    ||08930  |'                .Cells(8, 11).Value = sWord19    
08958  |'                                                 ||08931  |'                                                 
08959  |'                If Mid(gbuMGetUPDRec.N(lRecIdx).M||08932  |'                If Mid(gbuMGetUPDRec.N(lRecIdx).M
08960  |'                And gbuMGetUPDRec.N(lRecIdx).MGET||08933  |'                And gbuMGetUPDRec.N(lRecIdx).MGET
08961  |'                    .Cells(8, 13).Value = _      ||08934  |'                    .Cells(8, 13).Value = _      
08962  |'                        CStr(Format(dStart, "mmmm||08935  |'                        CStr(Format(dStart, "mmmm
08963  |'                Else                             ||08936  |'                Else                             
08964  |'                    .Cells(8, 13).Value = _      ||08937  |'                    .Cells(8, 13).Value = _      
08965  |'                        CStr(Format(dStart, "mmmm||08938  |'                        CStr(Format(dStart, "mmmm
08966  |'                End If                           ||08939  |'                End If                           
08967  |'                                                 ||08940  |'                                                 
08968  |'                '日付                            ||08941  |'                '日付                            
08969  |'                .Cells(10, 3).Value = sWord7a    ||08942  |'                .Cells(10, 3).Value = sWord7a    
08970  |'                .Range("C10:N10").HorizontalAlign||08943  |'                .Range("C10:N10").HorizontalAlign
08971  |'                '純資産                          ||08944  |'                '純資産                          
08972  |'                .Cells(10, 15).Value = sWord8a   ||08945  |'                .Cells(10, 15).Value = sWord8a   
08973  |'                .Range("O10:AC10").HorizontalAlig||08946  |'                .Range("O10:AC10").HorizontalAlig
08974  |'                '日付                            ||08947  |'                '日付                            
08975  |'                .Cells(10, 31).Value = sWord7a   ||08948  |'                .Cells(10, 31).Value = sWord7a   
08976  |'                .Range("AE10:AP10").HorizontalAli||08949  |'                .Range("AE10:AP10").HorizontalAli
08977  |'                '純資産                          ||08950  |'                '純資産                          
08978  |'                .Cells(10, 43).Value = sWord8a   ||08951  |'                .Cells(10, 43).Value = sWord8a   
08979  |'                .Range("AQ10:BE10").HorizontalAli||08952  |'                .Range("AQ10:BE10").HorizontalAli
08980  |'                '日付＆NAV                       ||08953  |'                '日付＆NAV                       
08981  |'                Select Case L                    ||08954  |'                Select Case L                    
08982  |'                    Case 1                       ||08955  |'                    Case 1                       
08983  |'                        dintPageIni = 1          ||08956  |'                        dintPageIni = 1          
08984  |'                    Case Else                    ||08957  |'                    Case Else                    
08985  |'                        dintPageIni = dintPageIni||08958  |'                        dintPageIni = dintPageIni
08986  |'                End Select                       ||08959  |'                End Select                       
08987  |'                For dintFor = dintPageIni To dlng||08960  |'                For dintFor = dintPageIni To dlng
08988  |'                    If J < 54 Then               ||08961  |'                    If J < 54 Then               
08989  |'                        If dintFor = dlngCnt + 1 ||08962  |'                        If dintFor = dlngCnt + 1 
08990  |'                            '合計                ||08963  |'                            '合計                
08991  |'                            .Cells(11 + J, 3).Val||08964  |'                            .Cells(11 + J, 3).Val
08992  |'                            'NAV                 ||08965  |'                            'NAV                 
08993  |'                            .Cells(11 + J, 28).Nu||08966  |'                            .Cells(11 + J, 28).Nu
08994  |'                            If gbuMGetUPDRec.N(lR||08967  |'                            If gbuMGetUPDRec.N(lR
08995  |'                                .Cells(11 + J, 28||08968  |'                                .Cells(11 + J, 28
08996  |'                            Else                 ||08969  |'                            Else                 
08997  |'                                .Cells(11 + J, 28||08970  |'                                .Cells(11 + J, 28
08998  |'                            End If               ||08971  |'                            End If               
08999  |'                            .Cells(11 + J, 28).Ho||08972  |'                            .Cells(11 + J, 28).Ho
09000  |'                        End If                   ||08973  |'                        End If                   
09001  |'                                                 ||08974  |'                                                 
09002  |'                            If dintFor = dlngCnt ||08975  |'                            If dintFor = dlngCnt 
09003  |'                                '平均            ||08976  |'                                '平均            
09004  |'                                .Cells(11 + J, 3)||08977  |'                                .Cells(11 + J, 3)
09005  |'                                'NAV             ||08978  |'                                'NAV             
09006  |'                                .Cells(11 + J, 28||08979  |'                                .Cells(11 + J, 28
09007  |'                                If gbuMGetUPDRec.||08980  |'                                If gbuMGetUPDRec.
09008  |'                                    .Cells(11 + J||08981  |'                                    .Cells(11 + J
09009  |'                                Else             ||08982  |'                                Else             
09010  |'                                    .Cells(11 + J||08983  |'                                    .Cells(11 + J
09011  |'                                End If           ||08984  |'                                End If           
09012  |'                                .Cells(11 + J, 28||08985  |'                                .Cells(11 + J, 28
09013  |'                            End If               ||08986  |'                            End If               
09014  |'                                                 ||08987  |'                                                 
09015  |'                        If dintFor < dlngCnt + 1 ||08988  |'                        If dintFor < dlngCnt + 1 
09016  |'                            '日付                ||08989  |'                            '日付                
09017  |'                            .Cells(11 + J, 4).Num||08990  |'                            .Cells(11 + J, 4).Num
09018  |'                            .Cells(11 + J, 4).Val||08991  |'                            .Cells(11 + J, 4).Val
09019  |'                                        CDate(gst||08992  |'                                        CDate(gst
09020  |'                            'NAV                 ||08993  |'                            'NAV                 
09021  |'                            .Cells(11 + J, 28).Nu||08994  |'                            .Cells(11 + J, 28).Nu
09022  |'                            If gbuMGetUPDRec.N(lR||08995  |'                            If gbuMGetUPDRec.N(lR
09023  |'                                .Cells(11 + J, 28||08996  |'                                .Cells(11 + J, 28
09024  |'                            Else                 ||08997  |'                            Else                 
09025  |'                                .Cells(11 + J, 28||08998  |'                                .Cells(11 + J, 28
09026  |'                            End If               ||08999  |'                            End If               
09027  |'                            .Cells(11 + J, 28).Ho||09000  |'                            .Cells(11 + J, 28).Ho
09028  |'                        End If                   ||09001  |'                        End If                   
09029  |'                    Else                         ||09002  |'                    Else                         
09030  |'                        If dintFor = dlngCnt + 1 ||09003  |'                        If dintFor = dlngCnt + 1 
09031  |'                            '合計                ||09004  |'                            '合計                
09032  |'                            .Cells(11 + K, 31).Va||09005  |'                            .Cells(11 + K, 31).Va
09033  |'                            'NAV                 ||09006  |'                            'NAV                 
09034  |'                            .Cells(11 + K, 56).Nu||09007  |'                            .Cells(11 + K, 56).Nu
09035  |'                            If gbuMGetUPDRec.N(lR||09008  |'                            If gbuMGetUPDRec.N(lR
09036  |'                                .Cells(11 + K, 56||09009  |'                                .Cells(11 + K, 56
09037  |'                            Else                 ||09010  |'                            Else                 
09038  |'                                .Cells(11 + K, 56||09011  |'                                .Cells(11 + K, 56
09039  |'                            End If               ||09012  |'                            End If               
09040  |'                            .Cells(11 + K, 56).Ho||09013  |'                            .Cells(11 + K, 56).Ho
09041  |'                        End If                   ||09014  |'                        End If                   
09042  |'                                                 ||09015  |'                                                 
09043  |'                            If dintFor = dlngCnt ||09016  |'                            If dintFor = dlngCnt 
09044  |'                                '平均            ||09017  |'                                '平均            
09045  |'                                .Cells(11 + K, 31||09018  |'                                .Cells(11 + K, 31
09046  |'                                'NAV             ||09019  |'                                'NAV             
09047  |'                                .Cells(11 + K, 56||09020  |'                                .Cells(11 + K, 56
09048  |'                                If gbuMGetUPDRec.||09021  |'                                If gbuMGetUPDRec.
09049  |'                                    .Cells(11 + K||09022  |'                                    .Cells(11 + K
09050  |'                                Else             ||09023  |'                                Else             
09051  |'                                    .Cells(11 + K||09024  |'                                    .Cells(11 + K
09052  |'                                End If           ||09025  |'                                End If           
09053  |'                                .Cells(11 + K, 56||09026  |'                                .Cells(11 + K, 56
09054  |'                            End If               ||09027  |'                            End If               
09055  |'                                                 ||09028  |'                                                 
09056  |'                        If dintFor < dlngCnt + 1 ||09029  |'                        If dintFor < dlngCnt + 1 
09057  |'                            '日付                ||09030  |'                            '日付                
09058  |'                                                 ||09031  |'                                                 
09059  |'                            .Cells(11 + K, 32).Nu||09032  |'                            .Cells(11 + K, 32).Nu
09060  |'                            .Cells(11 + K, 32).Va||09033  |'                            .Cells(11 + K, 32).Va
09061  |'                                        CDate(gst||09034  |'                                        CDate(gst
09062  |'                            'NAV                 ||09035  |'                            'NAV                 
09063  |'                            .Cells(11 + K, 56).Nu||09036  |'                            .Cells(11 + K, 56).Nu
09064  |'                            If gbuMGetUPDRec.N(lR||09037  |'                            If gbuMGetUPDRec.N(lR
09065  |'                                .Cells(11 + K, 56||09038  |'                                .Cells(11 + K, 56
09066  |'                            Else                 ||09039  |'                            Else                 
09067  |'                                .Cells(11 + K, 56||09040  |'                                .Cells(11 + K, 56
09068  |'                            End If               ||09041  |'                            End If               
09069  |'                            .Cells(11 + K, 56).Ho||09042  |'                            .Cells(11 + K, 56).Ho
09070  |'                        End If                   ||09043  |'                        End If                   
09071  |'                        K = K + 1                ||09044  |'                        K = K + 1                
09072  |'                        If K > 53 Then           ||09045  |'                        If K > 53 Then           
09073  |'                            J = 0                ||09046  |'                            J = 0                
09074  |'                            K = 0                ||09047  |'                            K = 0                
09075  |'                            Exit For             ||09048  |'                            Exit For             
09076  |'                        End If                   ||09049  |'                        End If                   
09077  |'                    End If                       ||09050  |'                    End If                       
09078  |'                    J = J + 1                    ||09051  |'                    J = J + 1                    
09079  |'                Next dintFor                     ||09052  |'                Next dintFor                     
09080  |'                                                 ||09053  |'                                                 
09081  |'                '左側日付                        ||09054  |'                '左側日付                        
09082  |''                With xlSheet.Range("C10:N64").Bo||09055  |''                With xlSheet.Range("C10:N64").Bo
09083  |''                    .LineStyle = xlContinuous   ||09056  |''                    .LineStyle = xlContinuous   
09084  |''                    .Weight = xlThin            ||09057  |''                    .Weight = xlThin            
09085  |''                End With                        ||09058  |''                End With                        
09086  |''                With xlSheet.Range("C10:N64").Bo||09059  |''                With xlSheet.Range("C10:N64").Bo
09087  |''                    .LineStyle = xlContinuous   ||09060  |''                    .LineStyle = xlContinuous   
09088  |''                    .Weight = xlThin            ||09061  |''                    .Weight = xlThin            
09089  |''                End With                        ||09062  |''                End With                        
09090  |''                With xlSheet.Range("C10:N64").Bo||09063  |''                With xlSheet.Range("C10:N64").Bo
09091  |''                    .LineStyle = xlContinuous   ||09064  |''                    .LineStyle = xlContinuous   
09092  |''                    .Weight = xlThin            ||09065  |''                    .Weight = xlThin            
09093  |''                End With                        ||09066  |''                End With                        
09094  |''                With xlSheet.Range("C10:N64").Bo||09067  |''                With xlSheet.Range("C10:N64").Bo
09095  |''                    .LineStyle = xlContinuous   ||09068  |''                    .LineStyle = xlContinuous   
09096  |''                    .Weight = xlThin            ||09069  |''                    .Weight = xlThin            
09097  |''                End With                        ||09070  |''                End With                        
09098  |''                With xlSheet.Range("C10:N64").Bo||09071  |''                With xlSheet.Range("C10:N64").Bo
09099  |''                    .LineStyle = xlContinuous   ||09072  |''                    .LineStyle = xlContinuous   
09100  |''                    .Weight = xlThin            ||09073  |''                    .Weight = xlThin            
09101  |''                End With                        ||09074  |''                End With                        
09102  |''                                                ||09075  |''                                                
09103  |''                '左側純資産                     ||09076  |''                '左側純資産                     
09104  |''                With xlSheet.Range("O10:AC64").B||09077  |''                With xlSheet.Range("O10:AC64").B
09105  |''                    .LineStyle = xlContinuous   ||09078  |''                    .LineStyle = xlContinuous   
09106  |''                    .Weight = xlThin            ||09079  |''                    .Weight = xlThin            
09107  |''                End With                        ||09080  |''                End With                        
09108  |''                With xlSheet.Range("O10:AC64").B||09081  |''                With xlSheet.Range("O10:AC64").B
09109  |''                    .LineStyle = xlContinuous   ||09082  |''                    .LineStyle = xlContinuous   
09110  |''                    .Weight = xlThin            ||09083  |''                    .Weight = xlThin            
09111  |''                End With                        ||09084  |''                End With                        
09112  |''                With xlSheet.Range("O10:AC64").B||09085  |''                With xlSheet.Range("O10:AC64").B
09113  |''                    .LineStyle = xlContinuous   ||09086  |''                    .LineStyle = xlContinuous   
09114  |''                    .Weight = xlThin            ||09087  |''                    .Weight = xlThin            
09115  |''                End With                        ||09088  |''                End With                        
09116  |''                With xlSheet.Range("O10:AC64").B||09089  |''                With xlSheet.Range("O10:AC64").B
09117  |''                    .LineStyle = xlContinuous   ||09090  |''                    .LineStyle = xlContinuous   
09118  |''                    .Weight = xlThin            ||09091  |''                    .Weight = xlThin            
09119  |''                End With                        ||09092  |''                End With                        
09120  |''                With xlSheet.Range("O10:AC64").B||09093  |''                With xlSheet.Range("O10:AC64").B
09121  |''                    .LineStyle = xlContinuous   ||09094  |''                    .LineStyle = xlContinuous   
09122  |''                    .Weight = xlThin            ||09095  |''                    .Weight = xlThin            
09123  |''                End With                        ||09096  |''                End With                        
09124  |''                                                ||09097  |''                                                
09125  |''                '右側日付                       ||09098  |''                '右側日付                       
09126  |''                With xlSheet.Range("AE10:AP64").||09099  |''                With xlSheet.Range("AE10:AP64").
09127  |''                    .LineStyle = xlContinuous   ||09100  |''                    .LineStyle = xlContinuous   
09128  |''                    .Weight = xlThin            ||09101  |''                    .Weight = xlThin            
09129  |''                End With                        ||09102  |''                End With                        
09130  |''                With xlSheet.Range("AE10:AP64").||09103  |''                With xlSheet.Range("AE10:AP64").
09131  |''                    .LineStyle = xlContinuous   ||09104  |''                    .LineStyle = xlContinuous   
09132  |''                    .Weight = xlThin            ||09105  |''                    .Weight = xlThin            
09133  |''                End With                        ||09106  |''                End With                        
09134  |''                With xlSheet.Range("AE10:AP64").||09107  |''                With xlSheet.Range("AE10:AP64").
09135  |''                    .LineStyle = xlContinuous   ||09108  |''                    .LineStyle = xlContinuous   
09136  |''                    .Weight = xlThin            ||09109  |''                    .Weight = xlThin            
09137  |''                End With                        ||09110  |''                End With                        
09138  |''                With xlSheet.Range("AE10:AP64").||09111  |''                With xlSheet.Range("AE10:AP64").
09139  |''                    .LineStyle = xlContinuous   ||09112  |''                    .LineStyle = xlContinuous   
09140  |''                    .Weight = xlThin            ||09113  |''                    .Weight = xlThin            
09141  |''                End With                        ||09114  |''                End With                        
09142  |''                With xlSheet.Range("AE10:AP64").||09115  |''                With xlSheet.Range("AE10:AP64").
09143  |''                    .LineStyle = xlContinuous   ||09116  |''                    .LineStyle = xlContinuous   
09144  |''                    .Weight = xlThin            ||09117  |''                    .Weight = xlThin            
09145  |''                End With                        ||09118  |''                End With                        
09146  |''                                                ||09119  |''                                                
09147  |''                '右側純資産                     ||09120  |''                '右側純資産                     
09148  |''                With xlSheet.Range("AQ10:BE64").||09121  |''                With xlSheet.Range("AQ10:BE64").
09149  |''                    .LineStyle = xlContinuous   ||09122  |''                    .LineStyle = xlContinuous   
09150  |''                    .Weight = xlThin            ||09123  |''                    .Weight = xlThin            
09151  |''                End With                        ||09124  |''                End With                        
09152  |''                With xlSheet.Range("AQ10:BE64").||09125  |''                With xlSheet.Range("AQ10:BE64").
09153  |''                    .LineStyle = xlContinuous   ||09126  |''                    .LineStyle = xlContinuous   
09154  |''                    .Weight = xlThin            ||09127  |''                    .Weight = xlThin            
09155  |''                End With                        ||09128  |''                End With                        
09156  |''                With xlSheet.Range("AQ10:BE64").||09129  |''                With xlSheet.Range("AQ10:BE64").
09157  |''                    .LineStyle = xlContinuous   ||09130  |''                    .LineStyle = xlContinuous   
09158  |''                    .Weight = xlThin            ||09131  |''                    .Weight = xlThin            
09159  |''                End With                        ||09132  |''                End With                        
09160  |''                With xlSheet.Range("AQ10:BE64").||09133  |''                With xlSheet.Range("AQ10:BE64").
09161  |''                    .LineStyle = xlContinuous   ||09134  |''                    .LineStyle = xlContinuous   
09162  |''                    .Weight = xlThin            ||09135  |''                    .Weight = xlThin            
09163  |''                End With                        ||09136  |''                End With                        
09164  |''                With xlSheet.Range("AQ10:BE64").||09137  |''                With xlSheet.Range("AQ10:BE64").
09165  |''                    .LineStyle = xlContinuous   ||09138  |''                    .LineStyle = xlContinuous   
09166  |''                    .Weight = xlThin            ||09139  |''                    .Weight = xlThin            
09167  |''                End With                        ||09140  |''                End With                        
09168  |'                                                 ||09141  |'                                                 
09169  |'            End With                             ||09142  |'            End With                             
09170  |'            'A4印刷用に上2行を削除して、プレビュ ||09143  |'            'A4印刷用に上2行を削除して、プレビュ 
09171  |'            xlSheet.Rows("1:2").Delete Shift:=xlU||09144  |'            xlSheet.Rows("1:2").Delete Shift:=xlU
09172  |'        Next L                                   ||09145  |'        Next L                                   
09173  |'    End If                                       ||09146  |'    End If                                       
09174  |'                                                 ||09147  |'                                                 
09175  |'    '正常戻り値セット                            ||09148  |'    '正常戻り値セット                            
09176  |'    fnblExcelEnglishOut = True                   ||09149  |'    fnblExcelEnglishOut = True                   
09177  |'    GoTo EndProc                                 ||09150  |'    GoTo EndProc                                 
09178  |'                                                 ||09151  |'                                                 
09179  |'ErrorTrap:                                       ||09152  |'ErrorTrap:                                       
09180  |'    ' Excel を起動できない場合に発生するエラーを ||09153  |'    ' Excel を起動できない場合に発生するエラーを 
09181  |'    Select Case Err.Number                       ||09154  |'    Select Case Err.Number                       
09182  |'        Case 440               ' オートメーション||09155  |'        Case 440               ' オートメーション
09183  |'            iTries = iTries + 1                  ||09156  |'            iTries = iTries + 1                  
09184  |'            ' Excel の再起動を 5 回まで行います。||09157  |'            ' Excel の再起動を 5 回まで行います。
09185  |'            If iTries < 5 Then                   ||09158  |'            If iTries < 5 Then                   
09186  |'               Set xlApp = New Excel.Application ||09159  |'               Set xlApp = New Excel.Application 
09187  |'               Resume                            ||09160  |'               Resume                            
09188  |'            Else                                 ||09161  |'            Else                                 
09189  |'               Err.Raise Number:=vbObjectError + ||09162  |'               Err.Raise Number:=vbObjectError + 
09190  |'               Description:="Microsoft Excel を起||09163  |'               Description:="Microsoft Excel を起
09191  |'            End If                               ||09164  |'            End If                               
09192  |'        Case Else                                ||09165  |'        Case Else                                
09193  |'    End Select                                   ||09166  |'    End Select                                   
09194  |'                                                 ||09167  |'                                                 
09195  |'    'Workbookを閉じる                            ||09168  |'    'Workbookを閉じる                            
09196  |'    xlBook.Close                                 ||09169  |'    xlBook.Close                                 
09197  |'                                                 ||09170  |'                                                 
09198  |'    'Excel終了                                   ||09171  |'    'Excel終了                                   
09199  |'    xlApp.Quit                                   ||09172  |'    xlApp.Quit                                   
09200  |'                                                 ||09173  |'                                                 
09201  |'    'オブジェクトの解放                          ||09174  |'    'オブジェクトの解放                          
09202  |'    Set xlApp = Nothing                          ||09175  |'    Set xlApp = Nothing                          
09203  |'    Set xlBook = Nothing                         ||09176  |'    Set xlBook = Nothing                         
09204  |'    Set xlSheet = Nothing                        ||09177  |'    Set xlSheet = Nothing                        
09205  |'                                                 ||09178  |'                                                 
09206  |'OnErrorProc:                                     ||09179  |'OnErrorProc:                                     
09207  |'    Call subError("システムエラー", Str(Err.Numbe||09180  |'    Call subError("システムエラー", Str(Err.Numbe
09208  |'        Error, strErrCall, conTitle)             ||09181  |'        Error, strErrCall, conTitle)             
09209  |'    'マウスポインター元に戻す                    ||09182  |'    'マウスポインター元に戻す                    
09210  |'    Screen.MousePointer = vbDefault              ||09183  |'    Screen.MousePointer = vbDefault              
09211  |'    GoTo EndProc                                 ||09184  |'    GoTo EndProc                                 
09212  |'                                                 ||09185  |'                                                 
09213  |'EndProc:                                         ||09186  |'EndProc:                                         
09214  |                                                  ||09187  |                                                  
09215  |End Function                                      ||09188  |End Function                                      
09216  |                                                  ||09189  |                                                  
09217  |'=================================================||09190  |'=================================================
09218  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbFileNameChange             ||09191  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbFileNameChange             
09219  |'機能            :   保存するファイル名部分を抽出 ||09192  |'機能            :   保存するファイル名部分を抽出 
09220  |'                                                 ||09193  |'                                                 
09221  |'日付               担当　              修正内容  ||09194  |'日付               担当　              修正内容  
09222  |'-------------------------------------------------||09195  |'-------------------------------------------------
09223  |'2004/08/11         M.Katoh<SRA>       新規作成   ||09196  |'2004/08/11         M.Katoh<SRA>       新規作成   
09224  |'=================================================||09197  |'=================================================
09225  |Private Sub sbFileNameChange()                    ||09198  |Private Sub sbFileNameChange()                    
09226  |                                                  ||09199  |                                                  
09227  |    Dim NumLen As Integer                         ||09200  |    Dim NumLen As Integer                         
09228  |    Dim FName As String                           ||09201  |    Dim FName As String                           
09229  |                                                  ||09202  |                                                  
09230  |    'ファイル名格納変数の「.xls」前部分を取り出す ||09203  |    'ファイル名格納変数の「.xls」前部分を取り出す 
09231  |    NumLen = InStr(mstrFileNameBK, ".xls")        ||09204  |    NumLen = InStr(mstrFileNameBK, ".xls")        
09232  |    mstrFileNameBK = Left(mstrFileNameBK, NumLen -||09205  |    mstrFileNameBK = Left(mstrFileNameBK, NumLen -
09233  |                                                  ||09206  |                                                  
09234  |End Sub                                           ||09207  |End Sub                                           
09235  |                                                  ||09208  |                                                  
09236  |'=================================================||09209  |'=================================================
09237  |'処理内容  システムエラー処理                     ||09210  |'処理内容  システムエラー処理                     
09238  |'備考                                             ||09211  |'備考                                             
09239  |'概要       ：msgbox(システムエラー／DBエラー)表示||09212  |'概要       ：msgbox(システムエラー／DBエラー)表示
09240  |'ﾌﾟﾛｼｼﾞｬ-名 ：subError                            ||09213  |'ﾌﾟﾛｼｼﾞｬ-名 ：subError                            
09241  |'ｲﾝﾀ-ﾌｪ-ｽ   ：call subError(ErrMsg As String, ErrN||09214  |'ｲﾝﾀ-ﾌｪ-ｽ   ：call subError(ErrMsg As String, ErrN
09242  |'ﾊﾟﾗﾒ-ﾀ     ：(IN)ErrMsg   :エラーメッセージ      ||09215  |'ﾊﾟﾗﾒ-ﾀ     ：(IN)ErrMsg   :エラーメッセージ      
09243  |'           ：(IN)ErrNumber:"str(Err.Number)":On E||09216  |'           ：(IN)ErrNumber:"str(Err.Number)":On E
09244  |'           ：             :その他:str(制御系／共 ||09217  |'           ：             :その他:str(制御系／共 
09245  |'           ：(IN)ErrSource:Err.Source:On Error Go||09218  |'           ：(IN)ErrSource:Err.Source:On Error Go
09246  |'           ：             :その他:エラー発生元の ||09219  |'           ：             :その他:エラー発生元の 
09247  |'           ：(IN)ErrDescription:"Err.Description"||09220  |'           ：(IN)ErrDescription:"Err.Description"
09248  |'           ：             :その他:エラーメッセー ||09221  |'           ：             :その他:エラーメッセー 
09249  |'           ：(IN)ErrCall:エラー呼出元            ||09222  |'           ：(IN)ErrCall:エラー呼出元            
09250  |'           ：(IN)ErrTitle:メッセージBOXに出すタイ||09223  |'           ：(IN)ErrTitle:メッセージBOXに出すタイ
09251  |'                                                 ||09224  |'                                                 
09252  |'日付         担当               内容             ||09225  |'日付         担当               内容             
09253  |'------------ ----------------- ------------------||09226  |'------------ ----------------- ------------------
09254  |'2004/03/03   H.Yonehara <SRA>  新規作成          ||09227  |'2004/03/03   H.Yonehara <SRA>  新規作成          
09255  |'=================================================||09228  |'=================================================
09256  |Private Sub subError(ErrMsg As String, ErrNumber A||09229  |Private Sub subError(ErrMsg As String, ErrNumber A
09257  |    On Error GoTo OnErrorProc                     ||09230  |    On Error GoTo OnErrorProc                     
09258  |                                                  ||09231  |                                                  
09259  |    Const conMeModule As String = "subError" '当モ||09232  |    Const conMeModule As String = "subError" '当モ
09260  |    Dim strErrCall As String        'エラー呼出元 ||09233  |    Dim strErrCall As String        'エラー呼出元 
09261  |    Dim intRtn As Integer           '関数戻り値(in||09234  |    Dim intRtn As Integer           '関数戻り値(in
09262  |                                                  ||09235  |                                                  
09263  |    'エラー呼出元設定                             ||09236  |    'エラー呼出元設定                             
09264  |    strErrCall = conMeForm & ":" & conMeModule    ||09237  |    strErrCall = conMeForm & ":" & conMeModule    
09265  |                                                  ||09238  |                                                  
09266  |    mblnFinishStatus = False    ' 異常終了        ||09239  |    mblnFinishStatus = False    ' 異常終了        
09267  |                                                  ||09240  |                                                  
09268  |    intRtn = MsgBox(ErrMsg & vbCrLf & "[ErrNumber=||09241  |    intRtn = MsgBox(ErrMsg & vbCrLf & "[ErrNumber=
09269  |            ErrNumber & "]" & vbCrLf & "[ErrSource||09242  |            ErrNumber & "]" & vbCrLf & "[ErrSource
09270  |            ErrSource & "]" & vbCrLf & "[ErrCall="||09243  |            ErrSource & "]" & vbCrLf & "[ErrCall="
09271  |            ErrCall & "]" & vbCrLf & "[ErrDescript||09244  |            ErrCall & "]" & vbCrLf & "[ErrDescript
09272  |            ErrDescription & "]", _               ||09245  |            ErrDescription & "]", _               
09273  |            (vbOKOnly + vbCritical), ErrTitle)    ||09246  |            (vbOKOnly + vbCritical), ErrTitle)    
09274  |    If (mblnFlgUnload = True) Then                ||09247  |    If (mblnFlgUnload = True) Then                
09275  |        Unload Me                                 ||09248  |        Unload Me                                 
09276  |    End If                                        ||09249  |    End If                                        
09277  |                                                  ||09250  |                                                  
09278  |    GoTo EndProc                                  ||09251  |    GoTo EndProc                                  
09279  |                                                  ||09252  |                                                  
09280  |OnErrorProc:                                      ||09253  |OnErrorProc:                                      
09281  |    intRtn = MsgBox("システムエラー" & vbCrLf & "[||09254  |    intRtn = MsgBox("システムエラー" & vbCrLf & "[
09282  |                Str(Err.Number) & "]" & vbCrLf & "||09255  |                Str(Err.Number) & "]" & vbCrLf & "
09283  |                Err.Source & "]" & vbCrLf & "[ErrC||09256  |                Err.Source & "]" & vbCrLf & "[ErrC
09284  |                "subErr" & "]" & vbCrLf & "[ErrDes||09257  |                "subErr" & "]" & vbCrLf & "[ErrDes
09285  |                Error & "]", _                    ||09258  |                Error & "]", _                    
09286  |                (vbOKOnly + vbCritical), ErrTitle)||09259  |                (vbOKOnly + vbCritical), ErrTitle)
09287  |    If (mblnFlgUnload = True) Then                ||09260  |    If (mblnFlgUnload = True) Then                
09288  |        Unload Me                                 ||09261  |        Unload Me                                 
09289  |    End If                                        ||09262  |    End If                                        
09290  |    Exit Sub                                      ||09263  |    Exit Sub                                      
09291  |                                                  ||09264  |                                                  
09292  |ErrorProc:                                        ||09265  |ErrorProc:                                        
09293  |    If (mblnFlgUnload = True) Then                ||09266  |    If (mblnFlgUnload = True) Then                
09294  |        Unload Me                                 ||09267  |        Unload Me                                 
09295  |    End If                                        ||09268  |    End If                                        
09296  |    Exit Sub                                      ||09269  |    Exit Sub                                      
09297  |                                                  ||09270  |                                                  
09298  |EndProc:                                          ||09271  |EndProc:                                          
09299  |    If (mblnFlgUnload = True) Then                ||09272  |    If (mblnFlgUnload = True) Then                
09300  |        Unload Me                                 ||09273  |        Unload Me                                 
09301  |    End If                                        ||09274  |    End If                                        
09302  |                                                  ||09275  |                                                  
09303  |End Sub                                           ||09276  |End Sub                                           
09304  |                                                  ||09277  |                                                  
09305  |'2005/07/26 Start                                 ||09278  |'2005/07/26 Start                                 
09306  |'出力対象チェックボックス動作は「チェックボックス ||09279  |'出力対象チェックボックス動作は「チェックボックス 
09307  |'となった為、全てコメント                         ||09280  |'となった為、全てコメント                         
09308  |''================================================||09281  |''================================================
09309  |''処理内容     chkAllSelect_Click時モジュール     ||09282  |''処理内容     chkAllSelect_Click時モジュール     
09310  |''備考                                            ||09283  |''備考                                            
09311  |''                                                ||09284  |''                                                
09312  |''日付         担当               内容            ||09285  |''日付         担当               内容            
09313  |''------------ ----------------- -----------------||09286  |''------------ ----------------- -----------------
09314  |''2004/08/26   M.Katoh <SRA>     新規作成         ||09287  |''2004/08/26   M.Katoh <SRA>     新規作成         
09315  |''================================================||09288  |''================================================
09316  |'Private Sub chkAllSelect_Click()                 ||09289  |'Private Sub chkAllSelect_Click()                 
09317  |'    Dim lCnt As Long                             ||09290  |'    Dim lCnt As Long                             
09318  |'    With fgridMakePrint                          ||09291  |'    With fgridMakePrint                          
09319  |'        '出力列を選択する                        ||09292  |'        '出力列を選択する                        
09320  |'        .Col = conColSysOutbln                   ||09293  |'        .Col = conColSysOutbln                   
09321  |'        If chkAllSelect.Value <> False Then      ||09294  |'        If chkAllSelect.Value <> False Then      
09322  |'            For lCnt = 0 To .Rows - 2            ||09295  |'            For lCnt = 0 To .Rows - 2            
09323  |'                .Row = lCnt + 1                  ||09296  |'                .Row = lCnt + 1                  
09324  |'                'チェックボックスをONする        ||09297  |'                'チェックボックスをONする        
09325  |'                .Text = 1                        ||09298  |'                .Text = 1                        
09326  |'            Next lCnt                            ||09299  |'            Next lCnt                            
09327  |'        Else                                     ||09300  |'        Else                                     
09328  |'            For lCnt = 0 To .Rows - 2            ||09301  |'            For lCnt = 0 To .Rows - 2            
09329  |'                .Row = lCnt + 1                  ||09302  |'                .Row = lCnt + 1                  
09330  |'                'チェックボックスをOFFする       ||09303  |'                'チェックボックスをOFFする       
09331  |'                .Text = 0                        ||09304  |'                .Text = 0                        
09332  |'            Next lCnt                            ||09305  |'            Next lCnt                            
09333  |'        End If                                   ||09306  |'        End If                                   
09334  |'    End With                                     ||09307  |'    End With                                     
09335  |'End Sub                                          ||09308  |'End Sub                                          
09336  |'2005/07/26　End                                  ||09309  |'2005/07/26　End                                  
09337  |                                                  ||09310  |                                                  
09338  |Private Sub txtInputName_GotFocus()               ||09311  |Private Sub txtInputName_GotFocus()               
09339  |    '反転表示                                     ||09312  |    '反転表示                                     
09340  |    Call gTextHanten(txtInputName)                ||09313  |    Call gTextHanten(txtInputName)                
09341  |End Sub                                           ||09314  |End Sub                                           
09342  |                                                  ||09315  |                                                  
09343  |Private Sub txtInputName_LostFocus()              ||09316  |Private Sub txtInputName_LostFocus()              
09344  |    'バイト数チェック                             ||09317  |    'バイト数チェック                             
09345  |    Call gTextByteChk(txtInputName, 128)          ||09318  |    Call gTextByteChk(txtInputName, 128)          
09346  |End Sub                                           ||09319  |End Sub                                           
09347  |                                                  ||09320  |                                                  
09348  |Private Sub txtSysOutDate_GotFocus()              ||09321  |Private Sub txtSysOutDate_GotFocus()              
09349  |    '反転表示                                     ||09322  |    '反転表示                                     
09350  |    Call gTextHanten(txtSysOutDate)               ||09323  |    Call gTextHanten(txtSysOutDate)               
09351  |End Sub                                           ||09324  |End Sub                                           
09352  |                                                  ||09325  |                                                  
09353  |Private Sub txtSysOutDate_KeyPress(KeyAscii As Int||09326  |Private Sub txtSysOutDate_KeyPress(KeyAscii As Int
09354  |    '半角数字のみ入力可                           ||09327  |    '半角数字のみ入力可                           
09355  |    Call gChkInputChar(KeyAscii, "0001010")       ||09328  |    Call gChkInputChar(KeyAscii, "0001010")       
09356  |End Sub                                           ||09329  |End Sub                                           
09357  |                                                  ||09330  |                                                  
09358  |Private Sub txtSysOutDate_LostFocus()             ||09331  |Private Sub txtSysOutDate_LostFocus()             
09359  |    '日付変換処理                                 ||09332  |    '日付変換処理                                 
09360  |    Call gTextDate_Lostfocus(txtSysOutDate, 1)    ||09333  |    Call gTextDate_Lostfocus(txtSysOutDate, 1)    
09361  |    If txtSysOutDate.BackColor = COLOR_ERR Then   ||09334  |    If txtSysOutDate.BackColor = COLOR_ERR Then   
09362  |        MsgSend "出力日付：暦日エラー　　　　", vb||09335  |        MsgSend "出力日付：暦日エラー　　　　", vb
09363  |        txtSysOutDate.SetFocus                    ||09336  |        txtSysOutDate.SetFocus                    
09364  |    End If                                        ||09337  |    End If                                        
09365  |End Sub                                           ||09338  |End Sub                                           
09366  |                                                  ||09339  |                                                  
09367  |Private Sub txtInputTax_GotFocus()                ||09340  |Private Sub txtInputTax_GotFocus()                
09368  |    '反転表示                                     ||09341  |    '反転表示                                     
09369  |    Call gTextHanten(txtInputTax)                 ||09342  |    Call gTextHanten(txtInputTax)                 
09370  |End Sub                                           ||09343  |End Sub                                           
09371  |                                                  ||09344  |                                                  
09372  |Private Sub txtInputTax_KeyPress(KeyAscii As Integ||09345  |Private Sub txtInputTax_KeyPress(KeyAscii As Integ
09373  |    '半角数字のみ入力可                           ||09346  |    '半角数字のみ入力可                           
09374  |    Call gChkInputChar(KeyAscii, "0001010")       ||09347  |    Call gChkInputChar(KeyAscii, "0001010")       
09375  |End Sub                                           ||09348  |End Sub                                           
09376  |                                                  ||09349  |                                                  
09377  |Private Sub txtInputTax_LostFocus()               ||09350  |Private Sub txtInputTax_LostFocus()               
09378  |    If txtInputTax.Text <> "" Then                ||09351  |    If txtInputTax.Text <> "" Then                
09379  |        If IsNumeric(txtInputTax.Text) = False The||09352  |        If IsNumeric(txtInputTax.Text) = False The
09380  |            MsgBox "数値を入力してください", vbInf||09353  |            MsgBox "数値を入力してください", vbInf
09381  |            txtInputTax.SetFocus                  ||09354  |            txtInputTax.SetFocus                  
09382  |        End If                                    ||09355  |        End If                                    
09383  |    End If                                        ||09356  |    End If                                        
09384  |End Sub                                           ||09357  |End Sub                                           
09385  |                                                  ||09358  |                                                  
09386  |'=================================================||09359  |'=================================================
09387  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMakePrintFlexGridIni       ||09360  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMakePrintFlexGridIni       
09388  |'機能            :   確認書作成VSFlexGrid初期設定 ||09361  |'機能            :   確認書作成VSFlexGrid初期設定 
09389  |'                                                 ||09362  |'                                                 
09390  |'日付               担当　              修正内容  ||09363  |'日付               担当　              修正内容  
09391  |'-------------------------------------------------||09364  |'-------------------------------------------------
09392  |'2004/05/14         M.Katoh<SRA>       新規作成   ||09365  |'2004/05/14         M.Katoh<SRA>       新規作成   
09393  |'2004/12/29         M.Yamazaki<SRA>    NAV取得区分||09366  |'2004/12/29         M.Yamazaki<SRA>    NAV取得区分
09394  |'2005/01/11         M.Yamazaki<SRA>    列追加     ||09367  |'2005/01/11         M.Yamazaki<SRA>    列追加     
09395  |'2005/01/17         M.Yamazaki<SRA>    列追加をせ ||09368  |'2005/01/17         M.Yamazaki<SRA>    列追加をせ 
09396  |'2005/02/02         M.Yamazaki<SRA>    前回締日営 ||09369  |'2005/02/02         M.Yamazaki<SRA>    前回締日営 
09397  |'2005/03/09         M.Yamazaki<SRA>    消費税計算 ||09370  |'2005/03/09         M.Yamazaki<SRA>    消費税計算 
09398  |'2005/07/25         K.Nishihama<SRA>   英文チェッ ||09371  |'2005/07/25         K.Nishihama<SRA>   英文チェッ 
09399  |'2008/03/12         K.Furuya<SRA>      ファンド決 ||09372  |'2008/03/12         K.Furuya<SRA>      ファンド決 
09400  |'=================================================||09373  |'=================================================
09401  |Private Sub sbMakePrintFlexGridIni()              ||09374  |Private Sub sbMakePrintFlexGridIni()              
09402  |                                                  ||09375  |                                                  
09403  |    Dim iIdx As Integer                           ||09376  |    Dim iIdx As Integer                           
09404  |                                                  ||09377  |                                                  
09405  |    With fgridMakePrint                           ||09378  |    With fgridMakePrint                           
09406  |        'VSFlexGrid初期設定                       ||09379  |        'VSFlexGrid初期設定                       
09407  |        .Height = 3855                            ||09380  |        .Height = 3855                            
09408  |'2008/03/12 START ファンド決算期間での外部委託顧問||09381  |'2008/03/12 START ファンド決算期間での外部委託顧問
09409  |'        .Width = 9375                            ||09382  |'        .Width = 9375                            
09410  |        .Width = 13000                            ||09383  |        .Width = 13000                            
09411  |'2008/03/12 END   ファンド決算期間での外部委託顧問||09384  |'2008/03/12 END   ファンド決算期間での外部委託顧問
09412  |        .Left = 120                               ||09385  |        .Left = 120                               
09413  |        .Top = 1560                               ||09386  |        .Top = 1560                               
09414  |        .Col = -1                                 ||09387  |        .Col = -1                                 
09415  |'2005/01/11 Start                                 ||09388  |'2005/01/11 Start                                 
09416  |''2004/12/29 Start                                ||09389  |''2004/12/29 Start                                
09417  |''        .Cols = 17                              ||09390  |''        .Cols = 17                              
09418  |'        .Cols = 20                               ||09391  |'        .Cols = 20                               
09419  |''2004/12/29 End                                  ||09392  |''2004/12/29 End                                  
09420  |'2005/03/09 Start                                 ||09393  |'2005/03/09 Start                                 
09421  |''2005/01/17 Start                                ||09394  |''2005/01/17 Start                                
09422  |''        .Cols = 28                              ||09395  |''        .Cols = 28                              
09423  |'''2005/01/11 End                                 ||09396  |'''2005/01/11 End                                 
09424  |''2005/02/02 Start                                ||09397  |''2005/02/02 Start                                
09425  |''        .Cols = 24                              ||09398  |''        .Cols = 24                              
09426  |'        .Cols = 25                               ||09399  |'        .Cols = 25                               
09427  |''2005/02/02 End                                  ||09400  |''2005/02/02 End                                  
09428  |''2005/01/17 End                                  ||09401  |''2005/01/17 End                                  
09429  |'        .Cols = 26                               ||09402  |'        .Cols = 26                               
09430  |'2005/03/09 End                                   ||09403  |'2005/03/09 End                                   
09431  |                                                  ||09404  |                                                  
09432  |'2005/07/25 Start                                 ||09405  |'2005/07/25 Start                                 
09433  |'        .Cols = 28                               ||09406  |'        .Cols = 28                               
09434  |'2005/07/25 End                                   ||09407  |'2005/07/25 End                                   
09435  |'2008/03/12 START ファンド決算期間での外部委託顧問||09408  |'2008/03/12 START ファンド決算期間での外部委託顧問
09436  |        .Cols = 30                                ||09409  |        .Cols = 30                                
09437  |'2008/03/12 END   ファンド決算期間での外部委託顧問||09410  |'2008/03/12 END   ファンド決算期間での外部委託顧問
09438  |                                                  ||09411  |                                                  
09439  |        .Row = -1                                 ||09412  |        .Row = -1                                 
09440  |        .Rows = 1                                 ||09413  |        .Rows = 1                                 
09441  |                                                  ||09414  |                                                  
09442  |        .Row = 0                                  ||09415  |        .Row = 0                                  
09443  |        '行単位選択                               ||09416  |        '行単位選択                               
09444  |        .Clear flexClearScrollable, flexClearText ||09417  |        .Clear flexClearScrollable, flexClearText 
09445  |        .Visible = False                          ||09418  |        .Visible = False                          
09446  |                                                  ||09419  |                                                  
09447  |        For iIdx = .LeftCol - 1 To .Cols - 1      ||09420  |        For iIdx = .LeftCol - 1 To .Cols - 1      
09448  |            .Col = iIdx                           ||09421  |            .Col = iIdx                           
09449  |            Select Case iIdx                      ||09422  |            Select Case iIdx                      
09450  |                Case 0                            ||09423  |                Case 0                            
09451  |                    .ColWidth(iIdx) = 200         ||09424  |                    .ColWidth(iIdx) = 200         
09452  |                    .Text = ""                    ||09425  |                    .Text = ""                    
09453  |                Case 1                            ||09426  |                Case 1                            
09454  |                    .ColWidth(iIdx) = 540         ||09427  |                    .ColWidth(iIdx) = 540         
09455  |                    .Text = "出力"                ||09428  |                    .Text = "出力"                
09456  |'2005/07/25 Start                                 ||09429  |'2005/07/25 Start                                 
09457  |                Case 2                            ||09430  |                Case 2                            
09458  |                    .ColWidth(iIdx) = 540         ||09431  |                    .ColWidth(iIdx) = 540         
09459  |                    .Text = "英文"                ||09432  |                    .Text = "英文"                
09460  |'2005/07/25 Start                                 ||09433  |'2005/07/25 Start                                 
09461  |                                                  ||09434  |                                                  
09462  |                Case 3                            ||09435  |                Case 3                            
09463  |'2005/03/09 Start                                 ||09436  |'2005/03/09 Start                                 
09464  |'                    .ColWidth(iIdx) = 1000       ||09437  |'                    .ColWidth(iIdx) = 1000       
09465  |                    .ColWidth(iIdx) = 1605        ||09438  |                    .ColWidth(iIdx) = 1605        
09466  |'2005/03/09 End                                   ||09439  |'2005/03/09 End                                   
09467  |                    .Text = "契約番号"            ||09440  |                    .Text = "契約番号"            
09468  |                Case 4                            ||09441  |                Case 4                            
09469  |                    .ColWidth(iIdx) = 1800        ||09442  |                    .ColWidth(iIdx) = 1800        
09470  |                    .Text = "契約名"              ||09443  |                    .Text = "契約名"              
09471  |'2005/08/04 Start                                 ||09444  |'2005/08/04 Start                                 
09472  |                Case 5                            ||09445  |                Case 5                            
09473  |                    .ColWidth(iIdx) = 1700        ||09446  |                    .ColWidth(iIdx) = 1700        
09474  |                    .Text = "契約名[英]"          ||09447  |                    .Text = "契約名[英]"          
09475  |'2005/08/04 End                                   ||09448  |'2005/08/04 End                                   
09476  |                Case 6                            ||09449  |                Case 6                            
09477  |                    .ColWidth(iIdx) = 1700        ||09450  |                    .ColWidth(iIdx) = 1700        
09478  |                    .Text = "契約区分"            ||09451  |                    .Text = "契約区分"            
09479  |                Case 7                            ||09452  |                Case 7                            
09480  |                    .ColWidth(iIdx) = 1100        ||09453  |                    .ColWidth(iIdx) = 1100        
09481  |                    .Text = "締日営業日翌日"      ||09454  |                    .Text = "締日営業日翌日"      
09482  |                Case 8                            ||09455  |                Case 8                            
09483  |                    .ColWidth(iIdx) = 1100        ||09456  |                    .ColWidth(iIdx) = 1100        
09484  |                    .Text = "締日"                ||09457  |                    .Text = "締日"                
09485  |                Case 9                            ||09458  |                Case 9                            
09486  |                    .ColWidth(iIdx) = 1000        ||09459  |                    .ColWidth(iIdx) = 1000        
09487  |                    .Text = "口座コード"          ||09460  |                    .Text = "口座コード"          
09488  |                Case 10                           ||09461  |                Case 10                           
09489  |                    .ColWidth(iIdx) = 1600        ||09462  |                    .ColWidth(iIdx) = 1600        
09490  |                    .Text = "口座名"              ||09463  |                    .Text = "口座名"              
09491  |                Case 11                           ||09464  |                Case 11                           
09492  |                    .ColWidth(iIdx) = 1000        ||09465  |                    .ColWidth(iIdx) = 1000        
09493  |                    .Text = "通貨コード"          ||09466  |                    .Text = "通貨コード"          
09494  |                Case 12                           ||09467  |                Case 12                           
09495  |                    .ColWidth(iIdx) = 1080        ||09468  |                    .ColWidth(iIdx) = 1080        
09496  |                    .Text = "適用開始日"          ||09469  |                    .Text = "適用開始日"          
09497  |                Case 13                           ||09470  |                Case 13                           
09498  |                    .ColWidth(iIdx) = 1080        ||09471  |                    .ColWidth(iIdx) = 1080        
09499  |                    .Text = "適用終了日"          ||09472  |                    .Text = "適用終了日"          
09500  |                Case 14                           ||09473  |                Case 14                           
09501  |                    .ColWidth(iIdx) = 1350        ||09474  |                    .ColWidth(iIdx) = 1350        
09502  |                    .Text = "運用会社コード"      ||09475  |                    .Text = "運用会社コード"      
09503  |                Case 15                           ||09476  |                Case 15                           
09504  |                    .ColWidth(iIdx) = 1840        ||09477  |                    .ColWidth(iIdx) = 1840        
09505  |                    .Text = "運用会社名"          ||09478  |                    .Text = "運用会社名"          
09506  |                Case 16                           ||09479  |                Case 16                           
09507  |                    .ColWidth(iIdx) = 1840        ||09480  |                    .ColWidth(iIdx) = 1840        
09508  |                    .Text = "運用会社名[英]"      ||09481  |                    .Text = "運用会社名[英]"      
09509  |                Case 17                           ||09482  |                Case 17                           
09510  |                    .ColWidth(iIdx) = 900         ||09483  |                    .ColWidth(iIdx) = 900         
09511  |                    .Text = "ルールNo"            ||09484  |                    .Text = "ルールNo"            
09512  |                Case 18                           ||09485  |                Case 18                           
09513  |                    .ColWidth(iIdx) = 900         ||09486  |                    .ColWidth(iIdx) = 900         
09514  |                    .Text = "料率区分"            ||09487  |                    .Text = "料率区分"            
09515  |'2004/12/29 Start                                 ||09488  |'2004/12/29 Start                                 
09516  |'                Case 16                          ||09489  |'                Case 16                          
09517  |'                    .ColWidth(iIdx) = 1080       ||09490  |'                    .ColWidth(iIdx) = 1080       
09518  |'                    .Text = "支払予定日"         ||09491  |'                    .Text = "支払予定日"         
09519  |                Case 19                           ||09492  |                Case 19                           
09520  |                    .ColWidth(iIdx) = 900         ||09493  |                    .ColWidth(iIdx) = 900         
09521  |                    .Text = "NAV取得区分"         ||09494  |                    .Text = "NAV取得区分"         
09522  |                Case 20                           ||09495  |                Case 20                           
09523  |                    .ColWidth(iIdx) = 900         ||09496  |                    .ColWidth(iIdx) = 900         
09524  |                    .Text = "上限金額"            ||09497  |                    .Text = "上限金額"            
09525  |                Case 21                           ||09498  |                Case 21                           
09526  |                    .ColWidth(iIdx) = 900         ||09499  |                    .ColWidth(iIdx) = 900         
09527  |                    .Text = "下限金額"            ||09500  |                    .Text = "下限金額"            
09528  |                Case 22                           ||09501  |                Case 22                           
09529  |                    .ColWidth(iIdx) = 1080        ||09502  |                    .ColWidth(iIdx) = 1080        
09530  |                    .Text = "支払予定日"          ||09503  |                    .Text = "支払予定日"          
09531  |'2004/12/29 End                                   ||09504  |'2004/12/29 End                                   
09532  |'2005/01/11 Start                                 ||09505  |'2005/01/11 Start                                 
09533  |                Case 23                           ||09506  |                Case 23                           
09534  |                    .ColWidth(iIdx) = 1080        ||09507  |                    .ColWidth(iIdx) = 1080        
09535  |                    .Text = "NAV通貨"             ||09508  |                    .Text = "NAV通貨"             
09536  |                Case 24                           ||09509  |                Case 24                           
09537  |                    .ColWidth(iIdx) = 1080        ||09510  |                    .ColWidth(iIdx) = 1080        
09538  |                    .Text = "閾値通貨"            ||09511  |                    .Text = "閾値通貨"            
09539  |                Case 25                           ||09512  |                Case 25                           
09540  |                    .ColWidth(iIdx) = 1080        ||09513  |                    .ColWidth(iIdx) = 1080        
09541  |                    .Text = "顧問料通貨"          ||09514  |                    .Text = "顧問料通貨"          
09542  |'2005/01/17 Start                                 ||09515  |'2005/01/17 Start                                 
09543  |'                Case 23                          ||09516  |'                Case 23                          
09544  |'                    .ColWidth(iIdx) = 1560       ||09517  |'                    .ColWidth(iIdx) = 1560       
09545  |'                    .Text = "NAV→閾値"          ||09518  |'                    .Text = "NAV→閾値"          
09546  |'                Case 24                          ||09519  |'                Case 24                          
09547  |'                    .ColWidth(iIdx) = 1560       ||09520  |'                    .ColWidth(iIdx) = 1560       
09548  |'                    .Text = "NAV→顧問料"        ||09521  |'                    .Text = "NAV→顧問料"        
09549  |'                Case 25                          ||09522  |'                Case 25                          
09550  |'                    .ColWidth(iIdx) = 1560       ||09523  |'                    .ColWidth(iIdx) = 1560       
09551  |'                    .Text = "閾値→顧問料"       ||09524  |'                    .Text = "閾値→顧問料"       
09552  |'                Case 26                          ||09525  |'                Case 26                          
09553  |'                    .ColWidth(iIdx) = 1560       ||09526  |'                    .ColWidth(iIdx) = 1560       
09554  |'                    .Text = "顧問料→支払(円)"   ||09527  |'                    .Text = "顧問料→支払(円)"   
09555  |'                Case 27                          ||09528  |'                Case 27                          
09556  |'                    .ColWidth(iIdx) = 900        ||09529  |'                    .ColWidth(iIdx) = 900        
09557  |'                    .Text = "一年間の日数"       ||09530  |'                    .Text = "一年間の日数"       
09558  |''2005/01/11 End                                  ||09531  |''2005/01/11 End                                  
09559  |                Case 26                           ||09532  |                Case 26                           
09560  |                    .ColWidth(iIdx) = 900         ||09533  |                    .ColWidth(iIdx) = 900         
09561  |                    .Text = "一年間の日数"        ||09534  |                    .Text = "一年間の日数"        
09562  |'2005/01/17 End                                   ||09535  |'2005/01/17 End                                   
09563  |'2005/02/02 Start                                 ||09536  |'2005/02/02 Start                                 
09564  |                Case 27                           ||09537  |                Case 27                           
09565  |                    .ColWidth(iIdx) = 900         ||09538  |                    .ColWidth(iIdx) = 900         
09566  |                    .Text = "消費税計算有無"      ||09539  |                    .Text = "消費税計算有無"      
09567  |'2005/02/02 End                                   ||09540  |'2005/02/02 End                                   
09568  |'2008/03/12 START ファンド決算期間での外部委託顧問||09541  |'2008/03/12 START ファンド決算期間での外部委託顧問
09569  |                Case 28                           ||09542  |                Case 28                           
09570  |                    .ColWidth(iIdx) = 1500        ||09543  |                    .ColWidth(iIdx) = 1500        
09571  |                    .Text = "ファンド計算FROM"    ||09544  |                    .Text = "ファンド計算FROM"    
09572  |                Case 29                           ||09545  |                Case 29                           
09573  |                    .ColWidth(iIdx) = 1500        ||09546  |                    .ColWidth(iIdx) = 1500        
09574  |                    .Text = "ファンド計算TO"      ||09547  |                    .Text = "ファンド計算TO"      
09575  |'2008/03/12 END   ファンド決算期間での外部委託顧問||09548  |'2008/03/12 END   ファンド決算期間での外部委託顧問
09576  |            End Select                            ||09549  |            End Select                            
09577  |        Next iIdx                                 ||09550  |        Next iIdx                                 
09578  |    End With                                      ||09551  |    End With                                      
09579  |                                                  ||09552  |                                                  
09580  |End Sub                                           ||09553  |End Sub                                           
09581  |                                                  ||09554  |                                                  
09582  |'=================================================||09555  |'=================================================
09583  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnMakePrintDataSet           ||09556  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnMakePrintDataSet           
09584  |'機能            :   確認書作成テーブルデータ抽出 ||09557  |'機能            :   確認書作成テーブルデータ抽出 
09585  |'                                                 ||09558  |'                                                 
09586  |'日付               担当　              修正内容  ||09559  |'日付               担当　              修正内容  
09587  |'-------------------------------------------------||09560  |'-------------------------------------------------
09588  |'2004/08/06         M.Katoh<SRA>       新規作成   ||09561  |'2004/08/06         M.Katoh<SRA>       新規作成   
09589  |'2005/01/18         M.Yamazaki<SRA>    無効フラグ ||09562  |'2005/01/18         M.Yamazaki<SRA>    無効フラグ 
09590  |'2005/02/02         M.Yamazaki<SRA>    ストアドを ||09563  |'2005/02/02         M.Yamazaki<SRA>    ストアドを 
09591  |'2005/02/03         M.Yamazaki<SRA>    ストアド名 ||09564  |'2005/02/03         M.Yamazaki<SRA>    ストアド名 
09592  |'2005/03/09         M.Yamazaki<SRA>    消費税テー ||09565  |'2005/03/09         M.Yamazaki<SRA>    消費税テー 
09593  |'2005/04/21         M.Yamazaki<SRA>    パフォーマ ||09566  |'2005/04/21         M.Yamazaki<SRA>    パフォーマ 
09594  |'2005/04/22         M.Yamazaki<SRA>    顧問料計算 ||09567  |'2005/04/22         M.Yamazaki<SRA>    顧問料計算 
09595  |'2005/04/22         M.Yamazaki<SRA>    重複データ ||09568  |'2005/04/22         M.Yamazaki<SRA>    重複データ 
09596  |'=================================================||09569  |'=================================================
09597  |Private Function fnMakePrintDataSet() As Boolean  ||09570  |Private Function fnMakePrintDataSet() As Boolean  
09598  |                                                  ||09571  |                                                  
09599  |    Const conMeModule   As String = "fnMakePrintDa||09572  |    Const conMeModule   As String = "fnMakePrintDa
09600  |    Dim strErrCall      As String        'エラー呼||09573  |    Dim strErrCall      As String        'エラー呼
09601  |    Dim sSql            As String                 ||09574  |    Dim sSql            As String                 
09602  |    Dim lRecCnt         As Long                   ||09575  |    Dim lRecCnt         As Long                   
09603  |    Dim sWorkWhere      As String                 ||09576  |    Dim sWorkWhere      As String                 
09604  |    Dim lActiveIdx      As Long                   ||09577  |    Dim lActiveIdx      As Long                   
09605  |    Dim iRet            As Integer                ||09578  |    Dim iRet            As Integer                
09606  |'2005/04/22 Start                                 ||09579  |'2005/04/22 Start                                 
09607  |'    Dim lRowCnt         As Long                  ||09580  |'    Dim lRowCnt         As Long                  
09608  |'2005/04/22 End                                   ||09581  |'2005/04/22 End                                   
09609  |    Dim SettleDate      As String                 ||09582  |    Dim SettleDate      As String                 
09610  |    Dim ComCalcStart    As String                 ||09583  |    Dim ComCalcStart    As String                 
09611  |'2005/01/18 Start                                 ||09584  |'2005/01/18 Start                                 
09612  |    Dim dintAccCnt      As Integer                ||09585  |    Dim dintAccCnt      As Integer                
09613  |'2005/01/18 End                                   ||09586  |'2005/01/18 End                                   
09614  |                                                  ||09587  |                                                  
09615  |'2005/04/21 Start                                 ||09588  |'2005/04/21 Start                                 
09616  |    Dim lRecCnt3 As Long                          ||09589  |    Dim lRecCnt3 As Long                          
09617  |    Dim strCONTRACTNo As String                   ||09590  |    Dim strCONTRACTNo As String                   
09618  |    Dim dstrSvDate As String                      ||09591  |    Dim dstrSvDate As String                      
09619  |    Dim dstrWkDate As String                      ||09592  |    Dim dstrWkDate As String                      
09620  |    Dim dblnEdit As Boolean                       ||09593  |    Dim dblnEdit As Boolean                       
09621  |    Dim lCnt As Long                              ||09594  |    Dim lCnt As Long                              
09622  |    Dim intRtn As Integer                         ||09595  |    Dim intRtn As Integer                         
09623  |    Dim dstrWkDateFlg As String                   ||09596  |    Dim dstrWkDateFlg As String                   
09624  |    Dim ComCalcEnd    As String                   ||09597  |    Dim ComCalcEnd    As String                   
09625  |    Dim J As Long                                 ||09598  |    Dim J As Long                                 
09626  |    Dim K As Long                                 ||09599  |    Dim K As Long                                 
09627  |    Dim L As Long                                 ||09600  |    Dim L As Long                                 
09628  |    Dim M As Long                                 ||09601  |    Dim M As Long                                 
09629  |    Dim N As Long                                 ||09602  |    Dim N As Long                                 
09630  |    Dim O As Long                                 ||09603  |    Dim O As Long                                 
09631  |    Dim P As Long                                 ||09604  |    Dim P As Long                                 
09632  |'2005/04/21 End                                   ||09605  |'2005/04/21 End                                   
09633  |'2005/04/26 Start                                 ||09606  |'2005/04/26 Start                                 
09634  |    Dim dstrUseEnd As String                      ||09607  |    Dim dstrUseEnd As String                      
09635  |'2005/04/26 End                                   ||09608  |'2005/04/26 End                                   
09636  |                                                  ||09609  |                                                  
09637  |    '初期処理                                     ||09610  |    '初期処理                                     
09638  |    fnMakePrintDataSet = False                    ||09611  |    fnMakePrintDataSet = False                    
09639  |                                                  ||09612  |                                                  
09640  |    'エラー呼出元設定                             ||09613  |    'エラー呼出元設定                             
09641  |    strErrCall = conMeForm & ":" & conMeModule    ||09614  |    strErrCall = conMeForm & ":" & conMeModule    
09642  |                                                  ||09615  |                                                  
09643  |    'ｲﾝﾃﾞｯｸｽ初期化                                ||09616  |    'ｲﾝﾃﾞｯｸｽ初期化                                
09644  |    lRecCnt = 0                                   ||09617  |    lRecCnt = 0                                   
09645  |    lRowCnt = 0                                   ||09618  |    lRowCnt = 0                                   
09646  |    lActiveIdx = 0                                ||09619  |    lActiveIdx = 0                                
09647  |    'DBオープン                                   ||09620  |    'DBオープン                                   
09648  |    If Not gintDbOpen() Then                      ||09621  |    If Not gintDbOpen() Then                      
09649  |        Exit Function                             ||09622  |        Exit Function                             
09650  |    End If                                        ||09623  |    End If                                        
09651  |                                                  ||09624  |                                                  
09652  |'2005/03/09 Start                                 ||09625  |'2005/03/09 Start                                 
09653  |    'SQL文作成                                    ||09626  |    'SQL文作成                                    
09654  |    sSql = "SELECT CONSUMPTION_TAX FROM CFR_CONSUM||09627  |    sSql = "SELECT CONSUMPTION_TAX FROM CFR_CONSUM
09655  |                                                  ||09628  |                                                  
09656  |    'ﾀﾞｲﾅｾｯﾄの作成                                ||09629  |    'ﾀﾞｲﾅｾｯﾄの作成                                
09657  |    If (gintDyCreate(sSql) = False) Then          ||09630  |    If (gintDyCreate(sSql) = False) Then          
09658  |        Call subError("DBエラー", Str(9999), "gint||09631  |        Call subError("DBエラー", Str(9999), "gint
09659  |            "DB関数エラー", strErrCall, conTitle) ||09632  |            "DB関数エラー", strErrCall, conTitle) 
09660  |        Exit Function                             ||09633  |        Exit Function                             
09661  |    End If                                        ||09634  |    End If                                        
09662  |                                                  ||09635  |                                                  
09663  |    '                                             ||09636  |    '                                             
09664  |    ddblconsumption_tax = gvlnDyDataN("CONSUMPTION||09637  |    ddblconsumption_tax = gvlnDyDataN("CONSUMPTION
09665  |'2005/03/09 End                                   ||09638  |'2005/03/09 End                                   
09666  |                                                  ||09639  |                                                  
09667  |    'SQL文作成                                    ||09640  |    'SQL文作成                                    
09668  |    sSql = gstrEditSQLcfr_MonthlyCalcNavForSelect(||09641  |    sSql = gstrEditSQLcfr_MonthlyCalcNavForSelect(
09669  |                                                  ||09642  |                                                  
09670  |    'ﾀﾞｲﾅｾｯﾄの作成                                ||09643  |    'ﾀﾞｲﾅｾｯﾄの作成                                
09671  |    If (gintDyCreate(sSql) = False) Then          ||09644  |    If (gintDyCreate(sSql) = False) Then          
09672  |        Call subError("DBエラー", Str(9999), "gint||09645  |        Call subError("DBエラー", Str(9999), "gint
09673  |            "DB関数エラー", strErrCall, conTitle) ||09646  |            "DB関数エラー", strErrCall, conTitle) 
09674  |        Exit Function                             ||09647  |        Exit Function                             
09675  |    End If                                        ||09648  |    End If                                        
09676  |                                                  ||09649  |                                                  
09677  |    '配列初期化                                   ||09650  |    '配列初期化                                   
09678  |    ReDim gbuMGetUPDRec.N(0)                      ||09651  |    ReDim gbuMGetUPDRec.N(0)                      
09679  |                                                  ||09652  |                                                  
09680  |    'EOF判定処理                                  ||09653  |    'EOF判定処理                                  
09681  |    Do Until gblnDyEOF()                          ||09654  |    Do Until gblnDyEOF()                          
09682  |        '対象データ抽出                           ||09655  |        '対象データ抽出                           
09683  |        '配列にセット                             ||09656  |        '配列にセット                             
09684  |        Call sbMGetDataGet(lRecCnt)               ||09657  |        Call sbMGetDataGet(lRecCnt)               
09685  |        lRecCnt = lRecCnt + 1                     ||09658  |        lRecCnt = lRecCnt + 1                     
09686  |        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                         ||09659  |        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                         
09687  |        Call gDyNext                              ||09660  |        Call gDyNext                              
09688  |    Loop                                          ||09661  |    Loop                                          
09689  |                                                  ||09662  |                                                  
09690  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             ||09663  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             
09691  |    Call gblnDyClose                              ||09664  |    Call gblnDyClose                              
09692  |                                                  ||09665  |                                                  
09693  |    'グリッドデータセット処理                     ||09666  |    'グリッドデータセット処理                     
09694  |    lRecCnt = 0                                   ||09667  |    lRecCnt = 0                                   
09695  |    For lRecCnt = LBound(gbuMGetUPDRec.N) To UBoun||09668  |    For lRecCnt = LBound(gbuMGetUPDRec.N) To UBoun
09696  |                                                  ||09669  |                                                  
09697  |'2005/04/22 Start                                 ||09670  |'2005/04/22 Start                                 
09698  |        If Len(gbuMGetUPDRec.N(lRecCnt).MGET_com_c||09671  |        If Len(gbuMGetUPDRec.N(lRecCnt).MGET_com_c
09699  |'            If Replace(DateAdd("yyyy", 1, CDate(M||09672  |'            If Replace(DateAdd("yyyy", 1, CDate(M
09700  |            If Replace(DateAdd("yyyy", 1, CDate(Mi||09673  |            If Replace(DateAdd("yyyy", 1, CDate(Mi
09701  |                GoTo NextData                     ||09674  |                GoTo NextData                     
09702  |            End If                                ||09675  |            End If                                
09703  |        End If                                    ||09676  |        End If                                    
09704  |'2005/04/22 End                                   ||09677  |'2005/04/22 End                                   
09705  |'2005/04/21 Start                                 ||09678  |'2005/04/21 Start                                 
09706  |        'SQL文作成                                ||09679  |        'SQL文作成                                
09707  |        strCONTRACTNo = gbuMGetUPDRec.N(lRecCnt).M||09680  |        strCONTRACTNo = gbuMGetUPDRec.N(lRecCnt).M
09708  |                                                  ||09681  |                                                  
09709  |        '外部委託顧問料締日テーブル取得用SQL作成  ||09682  |        '外部委託顧問料締日テーブル取得用SQL作成  
09710  |        sSql = gstrEditSQLcfr_Settlement_dateForSe||09683  |        sSql = gstrEditSQLcfr_Settlement_dateForSe
09711  |        'ﾀﾞｲﾅｾｯﾄの作成                            ||09684  |        'ﾀﾞｲﾅｾｯﾄの作成                            
09712  |        If (gintDyCreate(sSql) = False) Then      ||09685  |        If (gintDyCreate(sSql) = False) Then      
09713  |            Call subError("DBエラー", Str(9999), "||09686  |            Call subError("DBエラー", Str(9999), "
09714  |                "DB関数エラー", strErrCall, conTit||09687  |                "DB関数エラー", strErrCall, conTit
09715  |            Exit Function                         ||09688  |            Exit Function                         
09716  |        End If                                    ||09689  |        End If                                    
09717  |        '件数取得                                 ||09690  |        '件数取得                                 
09718  |        lCnt = gvlnDyDataN("REC_CNT")             ||09691  |        lCnt = gvlnDyDataN("REC_CNT")             
09719  |        '通常締日件数チェック                     ||09692  |        '通常締日件数チェック                     
09720  |        If lCnt = 0 Then                          ||09693  |        If lCnt = 0 Then                          
09721  |            intRtn = MsgBox("締日が正しく設定され ||09694  |            intRtn = MsgBox("締日が正しく設定され 
09722  |                        vbLf & "契約番号 ： [ " & ||09695  |                        vbLf & "契約番号 ： [ " & 
09723  |                        vbLf & "に通常締日を設定し||09696  |                        vbLf & "に通常締日を設定し
09724  |                        vbCritical, "外部委託顧問 ||09697  |                        vbCritical, "外部委託顧問 
09725  |            Exit Function                         ||09698  |            Exit Function                         
09726  |        End If                                    ||09699  |        End If                                    
09727  |'2005/04/21 End                                   ||09700  |'2005/04/21 End                                   
09728  |                                                  ||09701  |                                                  
09729  |        mstrSettlementDate = ""                   ||09702  |        mstrSettlementDate = ""                   
09730  |        SettleDate = gbuMGetUPDRec.N(lRecCnt).MGET||09703  |        SettleDate = gbuMGetUPDRec.N(lRecCnt).MGET
09731  |        '締日が閏年かどうか判定                   ||09704  |        '締日が閏年かどうか判定                   
09732  |        If Mid(SettleDate, 5, 4) = conUrudoshi The||09705  |        If Mid(SettleDate, 5, 4) = conUrudoshi The
09733  |            '閏年チェック                         ||09706  |            '閏年チェック                         
09734  |            If fnblnUrudoshiCheck(Mid(SettleDate, ||09707  |            If fnblnUrudoshiCheck(Mid(SettleDate, 
09735  |                mstrSettlementDate = Mid(SettleDat||09708  |                mstrSettlementDate = Mid(SettleDat
09736  |            Else                                  ||09709  |            Else                                  
09737  |                mstrSettlementDate = SettleDate   ||09710  |                mstrSettlementDate = SettleDate   
09738  |            End If                                ||09711  |            End If                                
09739  |        Else                                      ||09712  |        Else                                      
09740  |            mstrSettlementDate = gbuMGetUPDRec.N(l||09713  |            mstrSettlementDate = gbuMGetUPDRec.N(l
09741  |        End If                                    ||09714  |        End If                                    
09742  |'2005/04/21 Start                                 ||09715  |'2005/04/21 Start                                 
09743  |        dstrWkDate = mstrSettlementDate           ||09716  |        dstrWkDate = mstrSettlementDate           
09744  |        If fnChkSettlementDate(dstrWkDate, 1) <> F||09717  |        If fnChkSettlementDate(dstrWkDate, 1) <> F
09745  |            dstrSvSettlementDate = mstrNearSettleD||09718  |            dstrSvSettlementDate = mstrNearSettleD
09746  |        End If                                    ||09719  |        End If                                    
09747  |'2005/04/21 End                                   ||09720  |'2005/04/21 End                                   
09748  |                                                  ||09721  |                                                  
09749  |'2005/01/18 Start                                 ||09722  |'2005/01/18 Start                                 
09750  |'        '締日の営業日チェック                    ||09723  |'        '締日の営業日チェック                    
09751  |'        If fnChkSettlementDate(mstrSettlementDate||09724  |'        If fnChkSettlementDate(mstrSettlementDate
09752  |'            '顧問料計算開始日をチェック(顧問料計 ||09725  |'            '顧問料計算開始日をチェック(顧問料計 
09753  |'            ComCalcStart = gbuMGetUPDRec.N(lRecCn||09726  |'            ComCalcStart = gbuMGetUPDRec.N(lRecCn
09754  |'            If mstrSettlementDate >= ComCalcStart||09727  |'            If mstrSettlementDate >= ComCalcStart
09755  |'                If mstrSettlementDate <> "" Then ||09728  |'                If mstrSettlementDate <> "" Then 
09756  |'                    'グリッドの行カウンターアップ||09729  |'                    'グリッドの行カウンターアップ
09757  |'                    lRowCnt = lRowCnt + 1        ||09730  |'                    lRowCnt = lRowCnt + 1        
09758  |'                    'グリッドにセット            ||09731  |'                    'グリッドにセット            
09759  |'                    Call sbMakePrintFlexGridDataS||09732  |'                    Call sbMakePrintFlexGridDataS
09760  |'                End If                           ||09733  |'                End If                           
09761  |'            End If                               ||09734  |'            End If                               
09762  |'        End If                                   ||09735  |'        End If                                   
09763  |                                                  ||09736  |                                                  
09764  |        If gbuMGetUPDRec.N(lRecCnt).MGET_acc_inval||09737  |        If gbuMGetUPDRec.N(lRecCnt).MGET_acc_inval
09765  |            sSql = ""                             ||09738  |            sSql = ""                             
09766  |            sSql = sSql & "SELECT COUNT(*) ACC_CNT||09739  |            sSql = sSql & "SELECT COUNT(*) ACC_CNT
09767  |            sSql = sSql & "FROM CFR01.CFR_ACCOUNT_||09740  |            sSql = sSql & "FROM CFR01.CFR_ACCOUNT_
09768  |            sSql = sSql & "WHERE ACCOUNT_CODE = '"||09741  |            sSql = sSql & "WHERE ACCOUNT_CODE = '"
09769  |            'ﾀﾞｲﾅｾｯﾄの作成                        ||09742  |            'ﾀﾞｲﾅｾｯﾄの作成                        
09770  |            If gintDyCreate(sSql) = False Then    ||09743  |            If gintDyCreate(sSql) = False Then    
09771  |                Exit Function                     ||09744  |                Exit Function                     
09772  |            Else                                  ||09745  |            Else                                  
09773  |                dintAccCnt = gvlnDyDataN("ACC_CNT"||09746  |                dintAccCnt = gvlnDyDataN("ACC_CNT"
09774  |            End If                                ||09747  |            End If                                
09775  |            If dintAccCnt > 1 Then                ||09748  |            If dintAccCnt > 1 Then                
09776  |            Else                                  ||09749  |            Else                                  
09777  |                '締日の営業日チェック             ||09750  |                '締日の営業日チェック             
09778  |                If fnChkSettlementDate(mstrSettlem||09751  |                If fnChkSettlementDate(mstrSettlem
09779  |                    '顧問料計算開始日をチェック(顧||09752  |                    '顧問料計算開始日をチェック(顧
09780  |                    ComCalcStart = gbuMGetUPDRec.N||09753  |                    ComCalcStart = gbuMGetUPDRec.N
09781  |'2005/04/26 Start                                 ||09754  |'2005/04/26 Start                                 
09782  |                    ComCalcEnd = gbuMGetUPDRec.N(l||09755  |                    ComCalcEnd = gbuMGetUPDRec.N(l
09783  |'2005/04/26 End                                   ||09756  |'2005/04/26 End                                   
09784  |                    If mstrSettlementDate >= ComCa||09757  |                    If mstrSettlementDate >= ComCa
09785  |                        If mstrSettlementDate <> "||09758  |                        If mstrSettlementDate <> "
09786  |'2005/02/02 Start                                 ||09759  |'2005/02/02 Start                                 
09787  |'                            'グリッドの行カウンタ||09760  |'                            'グリッドの行カウンタ
09788  |'                            lRowCnt = lRowCnt + 1||09761  |'                            lRowCnt = lRowCnt + 1
09789  |'                            'グリッドにセット    ||09762  |'                            'グリッドにセット    
09790  |'                            Call sbMakePrintFlexG||09763  |'                            Call sbMakePrintFlexG
09791  |'2005/04/21 Start                                 ||09764  |'2005/04/21 Start                                 
09792  |'                            'ストアド呼び出し(有 ||09765  |'                            'ストアド呼び出し(有 
09793  |'                            sSql = ""            ||09766  |'                            sSql = ""            
09794  |''2005/02/03 Start                                ||09767  |''2005/02/03 Start                                
09795  |''                            sSql = sSql & "SELEC||09768  |''                            sSql = sSql & "SELEC
09796  |'                            sSql = sSql & "SELECT||09769  |'                            sSql = sSql & "SELECT
09797  |''2005/02/03 End                                  ||09770  |''2005/02/03 End                                  
09798  |'                            sSql = sSql & gbuMGet||09771  |'                            sSql = sSql & gbuMGet
09799  |''2005/02/07 Start                                ||09772  |''2005/02/07 Start                                
09800  |''                            sSql = sSql & gbuMGe||09773  |''                            sSql = sSql & gbuMGe
09801  |'                            sSql = sSql & mstrSet||09774  |'                            sSql = sSql & mstrSet
09802  |''2005/02/07 End                                  ||09775  |''2005/02/07 End                                  
09803  |'                            sSql = sSql & mstrbas||09776  |'                            sSql = sSql & mstrbas
09804  |'                            sSql = sSql & "FROM D||09777  |'                            sSql = sSql & "FROM D
09805  |'                            'ﾀﾞｲﾅｾｯﾄの作成       ||09778  |'                            'ﾀﾞｲﾅｾｯﾄの作成       
09806  |'                            If gintDyCreate(sSql)||09779  |'                            If gintDyCreate(sSql)
09807  |'                                Exit Function    ||09780  |'                                Exit Function    
09808  |'                            Else                 ||09781  |'                            Else                 
09809  |'                                If gvlnDyDataS("s||09782  |'                                If gvlnDyDataS("s
09810  |'                                And Len(gvlnDyDat||09783  |'                                And Len(gvlnDyDat
09811  |'                                '                ||09784  |'                                '                
09812  |'                                    dstrShimebi =||09785  |'                                    dstrShimebi =
09813  |''                                    'カレンダー ||09786  |''                                    'カレンダー 
09814  |''                                    sSql = gstrE||09787  |''                                    sSql = gstrE
09815  |''                                    'ﾀﾞｲﾅｾｯﾄの作||09788  |''                                    'ﾀﾞｲﾅｾｯﾄの作
09816  |''                                    If gintDyCre||09789  |''                                    If gintDyCre
09817  |''                                        Exit Fun||09790  |''                                        Exit Fun
09818  |''                                    End If      ||09791  |''                                    End If      
09819  |'                                    'グリッドの行||09792  |'                                    'グリッドの行
09820  |'                                    lRowCnt = lRo||09793  |'                                    lRowCnt = lRo
09821  |'                                    '前回締日営業||09794  |'                                    '前回締日営業
09822  |''                                    gbuMGetUPDRe||09795  |''                                    gbuMGetUPDRe
09823  |'                                    gbuMGetUPDRec||09796  |'                                    gbuMGetUPDRec
09824  |'                                    'グリッドにセ||09797  |'                                    'グリッドにセ
09825  |'                                    Call sbMakePr||09798  |'                                    Call sbMakePr
09826  |'                                Else             ||09799  |'                                Else             
09827  |'                                    '読み飛ばし  ||09800  |'                                    '読み飛ばし  
09828  |'                                End If           ||09801  |'                                End If           
09829  |'                            End If               ||09802  |'                            End If               
09830  |''2005/02/02 End                                  ||09803  |''2005/02/02 End                                  
09831  |                            'SQL文作成            ||09804  |                            'SQL文作成            
09832  |                            strCONTRACTNo = gbuMGe||09805  |                            strCONTRACTNo = gbuMGe
09833  |                                                  ||09806  |                                                  
09834  |'                            If strCONTRACTNo = "B||09807  |'                            If strCONTRACTNo = "B
09835  |'                            If strCONTRACTNo = "T||09808  |'                            If strCONTRACTNo = "T
09836  |'                            If strCONTRACTNo = "W||09809  |'                            If strCONTRACTNo = "W
09837  |'                                MsgBox strCONTRAC||09810  |'                                MsgBox strCONTRAC
09838  |'                            End If               ||09811  |'                            End If               
09839  |                                                  ||09812  |                                                  
09840  |                            If Mid(mstrSettlementD||09813  |                            If Mid(mstrSettlementD
09841  |                                mstrSettlementDate||09814  |                                mstrSettlementDate
09842  |                            End If                ||09815  |                            End If                
09843  |                            '外部委託顧問料締日テ ||09816  |                            '外部委託顧問料締日テ 
09844  |                            sSql = gstrEditSQLcfr_||09817  |                            sSql = gstrEditSQLcfr_
09845  |                                                  ||09818  |                                                  
09846  |                            'ﾀﾞｲﾅｾｯﾄの作成        ||09819  |                            'ﾀﾞｲﾅｾｯﾄの作成        
09847  |                            If (gintDyCreate(sSql)||09820  |                            If (gintDyCreate(sSql)
09848  |                                Call subError("DB ||09821  |                                Call subError("DB 
09849  |                                    "DB関数エラー"||09822  |                                    "DB関数エラー"
09850  |                                Exit Function     ||09823  |                                Exit Function     
09851  |                            End If                ||09824  |                            End If                
09852  |                                                  ||09825  |                                                  
09853  |                            '初期化               ||09826  |                            '初期化               
09854  |                            lRecCnt3 = 0          ||09827  |                            lRecCnt3 = 0          
09855  |                            lRecCnt2 = 0          ||09828  |                            lRecCnt2 = 0          
09856  |                            dstrSvDate = ""       ||09829  |                            dstrSvDate = ""       
09857  |                            dstrUseEnd = ""       ||09830  |                            dstrUseEnd = ""       
09858  |                            Call sbMgetSettlementD||09831  |                            Call sbMgetSettlementD
09859  |                                                  ||09832  |                                                  
09860  |                            'EOF判定処理          ||09833  |                            'EOF判定処理          
09861  |                            Do Until gblnDyEOF()  ||09834  |                            Do Until gblnDyEOF()  
09862  |                                '対象データ抽出し ||09835  |                                '対象データ抽出し 
09863  |                                Call sbMGetSettlem||09836  |                                Call sbMGetSettlem
09864  |                                Call sbMGetSettlem||09837  |                                Call sbMGetSettlem
09865  |                                If Len(gbuMGetSett||09838  |                                If Len(gbuMGetSett
09866  |                                    lRecCnt3 = lRe||09839  |                                    lRecCnt3 = lRe
09867  |                                End If            ||09840  |                                End If            
09868  |                                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ ||09841  |                                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ 
09869  |                                Call gDyNext      ||09842  |                                Call gDyNext      
09870  |                            Loop                  ||09843  |                            Loop                  
09871  |                                                  ||09844  |                                                  
09872  |                            '対象締日取得         ||09845  |                            '対象締日取得         
09873  |                            With gbuMGetSettlement||09846  |                            With gbuMGetSettlement
09874  |                                If lRecCnt3 > 1 _ ||09847  |                                If lRecCnt3 > 1 _ 
09875  |                                Or lRecCnt2 > 0 Th||09848  |                                Or lRecCnt2 > 0 Th
09876  |                                    For K = 0 To l||09849  |                                    For K = 0 To l
09877  |                                        If Mid(gbu||09850  |                                        If Mid(gbu
09878  |                                        Or Mid(Rep||09851  |                                        Or Mid(Rep
09879  |                                            If lRe||09852  |                                            If lRe
09880  |                                                Fo||09853  |                                                Fo
09881  |'2005/04/26 Start                                 ||09854  |'2005/04/26 Start                                 
09882  |                                                  ||09855  |                                                  
09883  |                                                  ||09856  |                                                  
09884  |                                                  ||09857  |                                                  
09885  |                                                  ||09858  |                                                  
09886  |                                                  ||09859  |                                                  
09887  |                                                  ||09860  |                                                  
09888  |                                                  ||09861  |                                                  
09889  |                                                  ||09862  |                                                  
09890  |                                                  ||09863  |                                                  
09891  |                                                  ||09864  |                                                  
09892  |'2005/04/26 End                                   ||09865  |'2005/04/26 End                                   
09893  |                                                  ||09866  |                                                  
09894  |                                                  ||09867  |                                                  
09895  |                                                  ||09868  |                                                  
09896  |                                                  ||09869  |                                                  
09897  |                                                  ||09870  |                                                  
09898  |                                                  ||09871  |                                                  
09899  |                                                  ||09872  |                                                  
09900  |                                                  ||09873  |                                                  
09901  |                                                  ||09874  |                                                  
09902  |                                                  ||09875  |                                                  
09903  |                                                  ||09876  |                                                  
09904  |                                                  ||09877  |                                                  
09905  |                                                  ||09878  |                                                  
09906  |                                                  ||09879  |                                                  
09907  |                                                  ||09880  |                                                  
09908  |                                                  ||09881  |                                                  
09909  |                                                  ||09882  |                                                  
09910  |                                                  ||09883  |                                                  
09911  |                                                  ||09884  |                                                  
09912  |                                                  ||09885  |                                                  
09913  |                                                  ||09886  |                                                  
09914  |                                                  ||09887  |                                                  
09915  |                                                  ||09888  |                                                  
09916  |                                                  ||09889  |                                                  
09917  |                                                  ||09890  |                                                  
09918  |                                                  ||09891  |                                                  
09919  |                                                  ||09892  |                                                  
09920  |                                                  ||09893  |                                                  
09921  |                                                  ||09894  |                                                  
09922  |                                                  ||09895  |                                                  
09923  |                                                Ne||09896  |                                                Ne
09924  |                                            Else  ||09897  |                                            Else  
09925  |                                            End If||09898  |                                            End If
09926  |                                            '前回 ||09899  |                                            '前回 
09927  |                                            For M ||09900  |                                            For M 
09928  |                                                If||09901  |                                                If
09929  |                                                An||09902  |                                                An
09930  |                                                El||09903  |                                                El
09931  |                                                  ||09904  |                                                  
09932  |                                                  ||09905  |                                                  
09933  |                                                  ||09906  |                                                  
09934  |                                                  ||09907  |                                                  
09935  |                                                  ||09908  |                                                  
09936  |                                                  ||09909  |                                                  
09937  |                                                  ||09910  |                                                  
09938  |                                                En||09911  |                                                En
09939  |                                                If||09912  |                                                If
09940  |                                                  ||09913  |                                                  
09941  |                                                  ||09914  |                                                  
09942  |                                                  ||09915  |                                                  
09943  |                                                  ||09916  |                                                  
09944  |                                                  ||09917  |                                                  
09945  |                                                  ||09918  |                                                  
09946  |                                                  ||09919  |                                                  
09947  |                                                  ||09920  |                                                  
09948  |                                                  ||09921  |                                                  
09949  |                                                  ||09922  |                                                  
09950  |                                                  ||09923  |                                                  
09951  |                                                  ||09924  |                                                  
09952  |                                                  ||09925  |                                                  
09953  |                                                  ||09926  |                                                  
09954  |                                                  ||09927  |                                                  
09955  |                                                  ||09928  |                                                  
09956  |                                                  ||09929  |                                                  
09957  |                                                  ||09930  |                                                  
09958  |                                                  ||09931  |                                                  
09959  |                                                  ||09932  |                                                  
09960  |                                                  ||09933  |                                                  
09961  |                                                  ||09934  |                                                  
09962  |                                                  ||09935  |                                                  
09963  |                                                  ||09936  |                                                  
09964  |                                                  ||09937  |                                                  
09965  |                                                  ||09938  |                                                  
09966  |                                                  ||09939  |                                                  
09967  |                                                  ||09940  |                                                  
09968  |                                                  ||09941  |                                                  
09969  |                                                  ||09942  |                                                  
09970  |                                                  ||09943  |                                                  
09971  |                                                  ||09944  |                                                  
09972  |                                                  ||09945  |                                                  
09973  |                                                  ||09946  |                                                  
09974  |                                                  ||09947  |                                                  
09975  |                                                  ||09948  |                                                  
09976  |                                                  ||09949  |                                                  
09977  |                                                  ||09950  |                                                  
09978  |                                                  ||09951  |                                                  
09979  |                                                  ||09952  |                                                  
09980  |                                                  ||09953  |                                                  
09981  |                                                  ||09954  |                                                  
09982  |                                                  ||09955  |                                                  
09983  |                                                  ||09956  |                                                  
09984  |                                                  ||09957  |                                                  
09985  |                                                  ||09958  |                                                  
09986  |                                                  ||09959  |                                                  
09987  |                                                  ||09960  |                                                  
09988  |                                                  ||09961  |                                                  
09989  |                                                  ||09962  |                                                  
09990  |                                                  ||09963  |                                                  
09991  |                                                  ||09964  |                                                  
09992  |                                                  ||09965  |                                                  
09993  |                                                  ||09966  |                                                  
09994  |                                                  ||09967  |                                                  
09995  |                                                  ||09968  |                                                  
09996  |                                                  ||09969  |                                                  
09997  |                                                  ||09970  |                                                  
09998  |                                                  ||09971  |                                                  
09999  |                                                  ||09972  |                                                  
10000  |                                                  ||09973  |                                                  
10001  |                                                  ||09974  |                                                  
10002  |                                                  ||09975  |                                                  
10003  |                                                  ||09976  |                                                  
10004  |                                                  ||09977  |                                                  
10005  |                                                  ||09978  |                                                  
10006  |                                                  ||09979  |                                                  
10007  |                                                  ||09980  |                                                  
10008  |                                                  ||09981  |                                                  
10009  |                                                  ||09982  |                                                  
10010  |                                                  ||09983  |                                                  
10011  |                                                  ||09984  |                                                  
10012  |                                                  ||09985  |                                                  
10013  |                                                  ||09986  |                                                  
10014  |                                                  ||09987  |                                                  
10015  |                                                  ||09988  |                                                  
10016  |                                                  ||09989  |                                                  
10017  |                                                  ||09990  |                                                  
10018  |                                                  ||09991  |                                                  
10019  |                                                  ||09992  |                                                  
10020  |                                                  ||09993  |                                                  
10021  |                                                  ||09994  |                                                  
10022  |                                                  ||09995  |                                                  
10023  |                                                  ||09996  |                                                  
10024  |                                                  ||09997  |                                                  
10025  |                                                  ||09998  |                                                  
10026  |                                                  ||09999  |                                                  
10027  |                                                  ||10000  |                                                  
10028  |                                                  ||10001  |                                                  
10029  |                                                  ||10002  |                                                  
10030  |                                                  ||10003  |                                                  
10031  |                                                  ||10004  |                                                  
10032  |                                                  ||10005  |                                                  
10033  |                                                  ||10006  |                                                  
10034  |                                                  ||10007  |                                                  
10035  |                                                  ||10008  |                                                  
10036  |                                                  ||10009  |                                                  
10037  |                                                  ||10010  |                                                  
10038  |                                                  ||10011  |                                                  
10039  |                                                  ||10012  |                                                  
10040  |                                                  ||10013  |                                                  
10041  |                                                  ||10014  |                                                  
10042  |                                                  ||10015  |                                                  
10043  |                                                  ||10016  |                                                  
10044  |                                                  ||10017  |                                                  
10045  |                                                  ||10018  |                                                  
10046  |                                                  ||10019  |                                                  
10047  |                                                  ||10020  |                                                  
10048  |                                                  ||10021  |                                                  
10049  |                                                  ||10022  |                                                  
10050  |                                                  ||10023  |                                                  
10051  |                                                  ||10024  |                                                  
10052  |                                                  ||10025  |                                                  
10053  |                                                  ||10026  |                                                  
10054  |                                                  ||10027  |                                                  
10055  |                                                  ||10028  |                                                  
10056  |                                                  ||10029  |                                                  
10057  |                                                  ||10030  |                                                  
10058  |                                                  ||10031  |                                                  
10059  |                                                  ||10032  |                                                  
10060  |                                                  ||10033  |                                                  
10061  |                                                  ||10034  |                                                  
10062  |                                                En||10035  |                                                En
10063  |                                            Next M||10036  |                                            Next M
10064  |                                            Exit F||10037  |                                            Exit F
10065  |                                        Else      ||10038  |                                        Else      
10066  |                                        End If    ||10039  |                                        End If    
10067  |                                    Next K        ||10040  |                                    Next K        
10068  |                                Else              ||10041  |                                Else              
10069  |                                    '締が年1回    ||10042  |                                    '締が年1回    
10070  |                                    If Mid(gbuMGet||10043  |                                    If Mid(gbuMGet
10071  |                                    Or Mid(Replace||10044  |                                    Or Mid(Replace
10072  |                                        If lRecCnt||10045  |                                        If lRecCnt
10073  |                                            If gbu||10046  |                                            If gbu
10074  |                                            And gb||10047  |                                            And gb
10075  |                                                If||10048  |                                                If
10076  |                                                  ||10049  |                                                  
10077  |                                                El||10050  |                                                El
10078  |                                                En||10051  |                                                En
10079  |                                            Else  ||10052  |                                            Else  
10080  |                                            End If||10053  |                                            End If
10081  |                                        Else      ||10054  |                                        Else      
10082  |                                        End If    ||10055  |                                        End If    
10083  |                                        '前回締日 ||10056  |                                        '前回締日 
10084  |                                        dstrWkDate||10057  |                                        dstrWkDate
10085  |                                        If fnChkSe||10058  |                                        If fnChkSe
10086  |                                            gbuMGe||10059  |                                            gbuMGe
10087  |                                        End If    ||10060  |                                        End If    
10088  |                                        If gbuMGet||10061  |                                        If gbuMGet
10089  |                                        Else      ||10062  |                                        Else      
10090  |                                            gbuMGe||10063  |                                            gbuMGe
10091  |                                        End If    ||10064  |                                        End If    
10092  |                                    End If        ||10065  |                                    End If        
10093  |                                End If            ||10066  |                                End If            
10094  |                            End With              ||10067  |                            End With              
10095  |'2005/04/26 Start                                 ||10068  |'2005/04/26 Start                                 
10096  |'                            gbuMGetUPDRec.N(lRecC||10069  |'                            gbuMGetUPDRec.N(lRecC
10097  |                            If ComCalcStart <> "" ||10070  |                            If ComCalcStart <> "" 
10098  |                                If ComCalcStart > ||10071  |                                If ComCalcStart > 
10099  |                                    gbuMGetUPDRec.||10072  |                                    gbuMGetUPDRec.
10100  |                                Else              ||10073  |                                Else              
10101  |                                    gbuMGetUPDRec.||10074  |                                    gbuMGetUPDRec.
10102  |                                End If            ||10075  |                                End If            
10103  |                                If dstrSvDate <> "||10076  |                                If dstrSvDate <> "
10104  |                                    If dstrSvDate ||10077  |                                    If dstrSvDate 
10105  |                                        gbuMGetUPD||10078  |                                        gbuMGetUPD
10106  |                                    End If        ||10079  |                                    End If        
10107  |                                End If            ||10080  |                                End If            
10108  |                                If dstrUseEnd <> "||10081  |                                If dstrUseEnd <> "
10109  |                                    If dstrUseEnd ||10082  |                                    If dstrUseEnd 
10110  |                                        gbuMGetUPD||10083  |                                        gbuMGetUPD
10111  |                                    End If        ||10084  |                                    End If        
10112  |                                End If            ||10085  |                                End If            
10113  |                            Else                  ||10086  |                            Else                  
10114  |                                gbuMGetUPDRec.N(lR||10087  |                                gbuMGetUPDRec.N(lR
10115  |                            End If                ||10088  |                            End If                
10116  |                            If ComCalcEnd <> "" Th||10089  |                            If ComCalcEnd <> "" Th
10117  |                                If ComCalcEnd < gb||10090  |                                If ComCalcEnd < gb
10118  |                                    gbuMGetUPDRec.||10091  |                                    gbuMGetUPDRec.
10119  |'2005/04/XX Start                                 ||10092  |'2005/04/XX Start                                 
10120  |                                Else              ||10093  |                                Else              
10121  |                                    If ComCalcEnd ||10094  |                                    If ComCalcEnd 
10122  |                                        dstrSvSett||10095  |                                        dstrSvSett
10123  |                                    End If        ||10096  |                                    End If        
10124  |'2005/04/XX End                                   ||10097  |'2005/04/XX End                                   
10125  |                                End If            ||10098  |                                End If            
10126  |                            End If                ||10099  |                            End If                
10127  |'2005/04/XX Start                                 ||10100  |'2005/04/XX Start                                 
10128  |                            If ComCalcStart <> "" ||10101  |                            If ComCalcStart <> "" 
10129  |                            And ComCalcEnd <> "" T||10102  |                            And ComCalcEnd <> "" T
10130  |                                If dstrSvSettlemen||10103  |                                If dstrSvSettlemen
10131  |                                And dstrSvSettleme||10104  |                                And dstrSvSettleme
10132  |                                Else              ||10105  |                                Else              
10133  |                                    GoTo NextData ||10106  |                                    GoTo NextData 
10134  |                                End If            ||10107  |                                End If            
10135  |                            End If                ||10108  |                            End If                
10136  |'2005/04/XX End                                   ||10109  |'2005/04/XX End                                   
10137  |'2005/04/26 End                                   ||10110  |'2005/04/26 End                                   
10138  |                            'グリッドの行カウンタ ||10111  |                            'グリッドの行カウンタ 
10139  |                            lRowCnt = lRowCnt + 1 ||10112  |                            lRowCnt = lRowCnt + 1 
10140  |                            'グリッドにセット     ||10113  |                            'グリッドにセット     
10141  |                            Call sbMakePrintFlexGr||10114  |                            Call sbMakePrintFlexGr
10142  |'2005/04/21 End                                   ||10115  |'2005/04/21 End                                   
10143  |                        End If                    ||10116  |                        End If                    
10144  |                    End If                        ||10117  |                    End If                        
10145  |                End If                            ||10118  |                End If                            
10146  |            End If                                ||10119  |            End If                                
10147  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||10120  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
10148  |            Call gblnDyClose                      ||10121  |            Call gblnDyClose                      
10149  |        Else                                      ||10122  |        Else                                      
10150  |                '締日の営業日チェック             ||10123  |                '締日の営業日チェック             
10151  |                If fnChkSettlementDate(mstrSettlem||10124  |                If fnChkSettlementDate(mstrSettlem
10152  |                    '顧問料計算開始日をチェック(顧||10125  |                    '顧問料計算開始日をチェック(顧
10153  |                    ComCalcStart = gbuMGetUPDRec.N||10126  |                    ComCalcStart = gbuMGetUPDRec.N
10154  |'2005/04/26 Start                                 ||10127  |'2005/04/26 Start                                 
10155  |                    ComCalcEnd = gbuMGetUPDRec.N(l||10128  |                    ComCalcEnd = gbuMGetUPDRec.N(l
10156  |'2005/04/26 End                                   ||10129  |'2005/04/26 End                                   
10157  |                    If mstrSettlementDate >= ComCa||10130  |                    If mstrSettlementDate >= ComCa
10158  |                        If mstrSettlementDate <> "||10131  |                        If mstrSettlementDate <> "
10159  |'2005/02/02 Start                                 ||10132  |'2005/02/02 Start                                 
10160  |'                            'グリッドの行カウンタ||10133  |'                            'グリッドの行カウンタ
10161  |'                            lRowCnt = lRowCnt + 1||10134  |'                            lRowCnt = lRowCnt + 1
10162  |'                            'グリッドにセット    ||10135  |'                            'グリッドにセット    
10163  |'                            Call sbMakePrintFlexG||10136  |'                            Call sbMakePrintFlexG
10164  |'2005/04/21 Start                                 ||10137  |'2005/04/21 Start                                 
10165  |'                            'ストアド呼び出し(有 ||10138  |'                            'ストアド呼び出し(有 
10166  |'                            sSql = ""            ||10139  |'                            sSql = ""            
10167  |''2005/02/03 Start                                ||10140  |''2005/02/03 Start                                
10168  |''                            sSql = sSql & "SELEC||10141  |''                            sSql = sSql & "SELEC
10169  |'                            sSql = sSql & "SELECT||10142  |'                            sSql = sSql & "SELECT
10170  |''2005/02/03 End                                  ||10143  |''2005/02/03 End                                  
10171  |'                            sSql = sSql & gbuMGet||10144  |'                            sSql = sSql & gbuMGet
10172  |''2005/02/07 Start                                ||10145  |''2005/02/07 Start                                
10173  |''                            sSql = sSql & gbuMGe||10146  |''                            sSql = sSql & gbuMGe
10174  |'                            sSql = sSql & mstrSet||10147  |'                            sSql = sSql & mstrSet
10175  |''2005/02/07 End                                  ||10148  |''2005/02/07 End                                  
10176  |'                            sSql = sSql & mstrbas||10149  |'                            sSql = sSql & mstrbas
10177  |'                            sSql = sSql & "FROM D||10150  |'                            sSql = sSql & "FROM D
10178  |'                            'ﾀﾞｲﾅｾｯﾄの作成       ||10151  |'                            'ﾀﾞｲﾅｾｯﾄの作成       
10179  |'                            If gintDyCreate(sSql)||10152  |'                            If gintDyCreate(sSql)
10180  |'                                Exit Function    ||10153  |'                                Exit Function    
10181  |'                            Else                 ||10154  |'                            Else                 
10182  |'                                If gvlnDyDataS("s||10155  |'                                If gvlnDyDataS("s
10183  |'                                And Len(gvlnDyDat||10156  |'                                And Len(gvlnDyDat
10184  |'                                '                ||10157  |'                                '                
10185  |'                                    dstrShimebi =||10158  |'                                    dstrShimebi =
10186  |''                                    'カレンダー ||10159  |''                                    'カレンダー 
10187  |''                                    sSql = gstrE||10160  |''                                    sSql = gstrE
10188  |''                                    'ﾀﾞｲﾅｾｯﾄの作||10161  |''                                    'ﾀﾞｲﾅｾｯﾄの作
10189  |''                                    If gintDyCre||10162  |''                                    If gintDyCre
10190  |''                                        Exit Fun||10163  |''                                        Exit Fun
10191  |''                                    End If      ||10164  |''                                    End If      
10192  |'                                    'グリッドの行||10165  |'                                    'グリッドの行
10193  |'                                    lRowCnt = lRo||10166  |'                                    lRowCnt = lRo
10194  |'                                    '前回締日営業||10167  |'                                    '前回締日営業
10195  |''                                    gbuMGetUPDRe||10168  |''                                    gbuMGetUPDRe
10196  |'                                    gbuMGetUPDRec||10169  |'                                    gbuMGetUPDRec
10197  |'                                    'グリッドにセ||10170  |'                                    'グリッドにセ
10198  |'                                    Call sbMakePr||10171  |'                                    Call sbMakePr
10199  |'                                Else             ||10172  |'                                Else             
10200  |'                                    '読み飛ばし  ||10173  |'                                    '読み飛ばし  
10201  |'                                End If           ||10174  |'                                End If           
10202  |'                            End If               ||10175  |'                            End If               
10203  |''2005/02/02 End                                  ||10176  |''2005/02/02 End                                  
10204  |                            'SQL文作成            ||10177  |                            'SQL文作成            
10205  |                            strCONTRACTNo = gbuMGe||10178  |                            strCONTRACTNo = gbuMGe
10206  |                                                  ||10179  |                                                  
10207  |'                            If strCONTRACTNo = "B||10180  |'                            If strCONTRACTNo = "B
10208  |'                            If strCONTRACTNo = "T||10181  |'                            If strCONTRACTNo = "T
10209  |'                            If strCONTRACTNo = "W||10182  |'                            If strCONTRACTNo = "W
10210  |'                                MsgBox strCONTRAC||10183  |'                                MsgBox strCONTRAC
10211  |'                            End If               ||10184  |'                            End If               
10212  |                                                  ||10185  |                                                  
10213  |                            If Mid(mstrSettlementD||10186  |                            If Mid(mstrSettlementD
10214  |                                mstrSettlementDate||10187  |                                mstrSettlementDate
10215  |                            End If                ||10188  |                            End If                
10216  |                            '外部委託顧問料締日テ ||10189  |                            '外部委託顧問料締日テ 
10217  |                            sSql = gstrEditSQLcfr_||10190  |                            sSql = gstrEditSQLcfr_
10218  |                                                  ||10191  |                                                  
10219  |                            'ﾀﾞｲﾅｾｯﾄの作成        ||10192  |                            'ﾀﾞｲﾅｾｯﾄの作成        
10220  |                            If (gintDyCreate(sSql)||10193  |                            If (gintDyCreate(sSql)
10221  |                                Call subError("DB ||10194  |                                Call subError("DB 
10222  |                                    "DB関数エラー"||10195  |                                    "DB関数エラー"
10223  |                                Exit Function     ||10196  |                                Exit Function     
10224  |                            End If                ||10197  |                            End If                
10225  |                                                  ||10198  |                                                  
10226  |                            '初期化               ||10199  |                            '初期化               
10227  |                            lRecCnt3 = 0          ||10200  |                            lRecCnt3 = 0          
10228  |                            lRecCnt2 = 0          ||10201  |                            lRecCnt2 = 0          
10229  |                            dstrSvDate = ""       ||10202  |                            dstrSvDate = ""       
10230  |                            dstrUseEnd = ""       ||10203  |                            dstrUseEnd = ""       
10231  |                            Call sbMgetSettlementD||10204  |                            Call sbMgetSettlementD
10232  |                                                  ||10205  |                                                  
10233  |                            'EOF判定処理          ||10206  |                            'EOF判定処理          
10234  |                            Do Until gblnDyEOF()  ||10207  |                            Do Until gblnDyEOF()  
10235  |                                '対象データ抽出し ||10208  |                                '対象データ抽出し 
10236  |                                Call sbMGetSettlem||10209  |                                Call sbMGetSettlem
10237  |                                Call sbMGetSettlem||10210  |                                Call sbMGetSettlem
10238  |                                If Len(gbuMGetSett||10211  |                                If Len(gbuMGetSett
10239  |                                    lRecCnt3 = lRe||10212  |                                    lRecCnt3 = lRe
10240  |                                End If            ||10213  |                                End If            
10241  |                                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ ||10214  |                                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ 
10242  |                                Call gDyNext      ||10215  |                                Call gDyNext      
10243  |                            Loop                  ||10216  |                            Loop                  
10244  |                                                  ||10217  |                                                  
10245  |                            '対象締日取得         ||10218  |                            '対象締日取得         
10246  |                            With gbuMGetSettlement||10219  |                            With gbuMGetSettlement
10247  |                                If lRecCnt3 > 1 _ ||10220  |                                If lRecCnt3 > 1 _ 
10248  |                                Or lRecCnt2 > 0 Th||10221  |                                Or lRecCnt2 > 0 Th
10249  |                                    For K = 0 To l||10222  |                                    For K = 0 To l
10250  |                                        If Mid(gbu||10223  |                                        If Mid(gbu
10251  |                                        Or Mid(Rep||10224  |                                        Or Mid(Rep
10252  |                                            If lRe||10225  |                                            If lRe
10253  |                                                Fo||10226  |                                                Fo
10254  |'2005/04/26 Start                                 ||10227  |'2005/04/26 Start                                 
10255  |                                                  ||10228  |                                                  
10256  |                                                  ||10229  |                                                  
10257  |                                                  ||10230  |                                                  
10258  |                                                  ||10231  |                                                  
10259  |                                                  ||10232  |                                                  
10260  |                                                  ||10233  |                                                  
10261  |                                                  ||10234  |                                                  
10262  |                                                  ||10235  |                                                  
10263  |                                                  ||10236  |                                                  
10264  |                                                  ||10237  |                                                  
10265  |'2005/04/26 End                                   ||10238  |'2005/04/26 End                                   
10266  |                                                  ||10239  |                                                  
10267  |                                                  ||10240  |                                                  
10268  |                                                  ||10241  |                                                  
10269  |                                                  ||10242  |                                                  
10270  |                                                  ||10243  |                                                  
10271  |                                                  ||10244  |                                                  
10272  |                                                  ||10245  |                                                  
10273  |                                                  ||10246  |                                                  
10274  |                                                  ||10247  |                                                  
10275  |                                                  ||10248  |                                                  
10276  |                                                  ||10249  |                                                  
10277  |                                                  ||10250  |                                                  
10278  |                                                  ||10251  |                                                  
10279  |                                                  ||10252  |                                                  
10280  |                                                  ||10253  |                                                  
10281  |                                                  ||10254  |                                                  
10282  |                                                  ||10255  |                                                  
10283  |                                                  ||10256  |                                                  
10284  |                                                  ||10257  |                                                  
10285  |                                                  ||10258  |                                                  
10286  |                                                  ||10259  |                                                  
10287  |                                                  ||10260  |                                                  
10288  |                                                  ||10261  |                                                  
10289  |                                                  ||10262  |                                                  
10290  |                                                  ||10263  |                                                  
10291  |                                                  ||10264  |                                                  
10292  |                                                  ||10265  |                                                  
10293  |                                                  ||10266  |                                                  
10294  |                                                  ||10267  |                                                  
10295  |                                                  ||10268  |                                                  
10296  |                                                Ne||10269  |                                                Ne
10297  |                                            Else  ||10270  |                                            Else  
10298  |                                            End If||10271  |                                            End If
10299  |                                            '前回 ||10272  |                                            '前回 
10300  |                                            For M ||10273  |                                            For M 
10301  |                                                If||10274  |                                                If
10302  |                                                An||10275  |                                                An
10303  |                                                El||10276  |                                                El
10304  |                                                  ||10277  |                                                  
10305  |                                                  ||10278  |                                                  
10306  |                                                  ||10279  |                                                  
10307  |                                                  ||10280  |                                                  
10308  |                                                  ||10281  |                                                  
10309  |                                                  ||10282  |                                                  
10310  |                                                  ||10283  |                                                  
10311  |                                                En||10284  |                                                En
10312  |                                                If||10285  |                                                If
10313  |                                                  ||10286  |                                                  
10314  |                                                  ||10287  |                                                  
10315  |                                                  ||10288  |                                                  
10316  |                                                  ||10289  |                                                  
10317  |                                                  ||10290  |                                                  
10318  |                                                  ||10291  |                                                  
10319  |                                                  ||10292  |                                                  
10320  |                                                  ||10293  |                                                  
10321  |                                                  ||10294  |                                                  
10322  |                                                  ||10295  |                                                  
10323  |                                                  ||10296  |                                                  
10324  |                                                  ||10297  |                                                  
10325  |                                                  ||10298  |                                                  
10326  |                                                  ||10299  |                                                  
10327  |                                                  ||10300  |                                                  
10328  |                                                  ||10301  |                                                  
10329  |                                                  ||10302  |                                                  
10330  |                                                  ||10303  |                                                  
10331  |                                                  ||10304  |                                                  
10332  |                                                  ||10305  |                                                  
10333  |                                                  ||10306  |                                                  
10334  |                                                  ||10307  |                                                  
10335  |                                                  ||10308  |                                                  
10336  |                                                  ||10309  |                                                  
10337  |                                                  ||10310  |                                                  
10338  |                                                  ||10311  |                                                  
10339  |                                                  ||10312  |                                                  
10340  |                                                  ||10313  |                                                  
10341  |                                                  ||10314  |                                                  
10342  |                                                  ||10315  |                                                  
10343  |                                                  ||10316  |                                                  
10344  |                                                  ||10317  |                                                  
10345  |                                                  ||10318  |                                                  
10346  |                                                  ||10319  |                                                  
10347  |                                                  ||10320  |                                                  
10348  |                                                  ||10321  |                                                  
10349  |                                                  ||10322  |                                                  
10350  |                                                  ||10323  |                                                  
10351  |                                                  ||10324  |                                                  
10352  |                                                  ||10325  |                                                  
10353  |                                                  ||10326  |                                                  
10354  |                                                  ||10327  |                                                  
10355  |                                                  ||10328  |                                                  
10356  |                                                  ||10329  |                                                  
10357  |                                                  ||10330  |                                                  
10358  |                                                  ||10331  |                                                  
10359  |                                                  ||10332  |                                                  
10360  |                                                  ||10333  |                                                  
10361  |                                                  ||10334  |                                                  
10362  |                                                  ||10335  |                                                  
10363  |                                                  ||10336  |                                                  
10364  |                                                  ||10337  |                                                  
10365  |                                                  ||10338  |                                                  
10366  |                                                  ||10339  |                                                  
10367  |                                                  ||10340  |                                                  
10368  |                                                  ||10341  |                                                  
10369  |                                                  ||10342  |                                                  
10370  |                                                  ||10343  |                                                  
10371  |                                                  ||10344  |                                                  
10372  |                                                  ||10345  |                                                  
10373  |                                                  ||10346  |                                                  
10374  |                                                  ||10347  |                                                  
10375  |                                                  ||10348  |                                                  
10376  |                                                  ||10349  |                                                  
10377  |                                                  ||10350  |                                                  
10378  |                                                  ||10351  |                                                  
10379  |                                                  ||10352  |                                                  
10380  |                                                  ||10353  |                                                  
10381  |                                                  ||10354  |                                                  
10382  |                                                  ||10355  |                                                  
10383  |                                                  ||10356  |                                                  
10384  |                                                  ||10357  |                                                  
10385  |                                                  ||10358  |                                                  
10386  |                                                  ||10359  |                                                  
10387  |                                                  ||10360  |                                                  
10388  |                                                  ||10361  |                                                  
10389  |                                                  ||10362  |                                                  
10390  |                                                  ||10363  |                                                  
10391  |                                                  ||10364  |                                                  
10392  |                                                  ||10365  |                                                  
10393  |                                                  ||10366  |                                                  
10394  |                                                  ||10367  |                                                  
10395  |                                                  ||10368  |                                                  
10396  |                                                  ||10369  |                                                  
10397  |                                                  ||10370  |                                                  
10398  |                                                  ||10371  |                                                  
10399  |                                                  ||10372  |                                                  
10400  |                                                  ||10373  |                                                  
10401  |                                                  ||10374  |                                                  
10402  |                                                  ||10375  |                                                  
10403  |                                                  ||10376  |                                                  
10404  |                                                  ||10377  |                                                  
10405  |                                                  ||10378  |                                                  
10406  |                                                  ||10379  |                                                  
10407  |                                                  ||10380  |                                                  
10408  |                                                  ||10381  |                                                  
10409  |                                                  ||10382  |                                                  
10410  |                                                  ||10383  |                                                  
10411  |                                                  ||10384  |                                                  
10412  |                                                  ||10385  |                                                  
10413  |                                                  ||10386  |                                                  
10414  |                                                  ||10387  |                                                  
10415  |                                                  ||10388  |                                                  
10416  |                                                  ||10389  |                                                  
10417  |                                                  ||10390  |                                                  
10418  |                                                  ||10391  |                                                  
10419  |                                                  ||10392  |                                                  
10420  |                                                  ||10393  |                                                  
10421  |                                                  ||10394  |                                                  
10422  |                                                  ||10395  |                                                  
10423  |                                                  ||10396  |                                                  
10424  |                                                  ||10397  |                                                  
10425  |                                                  ||10398  |                                                  
10426  |                                                  ||10399  |                                                  
10427  |                                                  ||10400  |                                                  
10428  |                                                  ||10401  |                                                  
10429  |                                                  ||10402  |                                                  
10430  |                                                  ||10403  |                                                  
10431  |                                                  ||10404  |                                                  
10432  |                                                  ||10405  |                                                  
10433  |                                                  ||10406  |                                                  
10434  |                                                  ||10407  |                                                  
10435  |                                                En||10408  |                                                En
10436  |                                            Next M||10409  |                                            Next M
10437  |                                            Exit F||10410  |                                            Exit F
10438  |                                        Else      ||10411  |                                        Else      
10439  |                                        End If    ||10412  |                                        End If    
10440  |                                    Next K        ||10413  |                                    Next K        
10441  |                                Else              ||10414  |                                Else              
10442  |                                    '締が年1回    ||10415  |                                    '締が年1回    
10443  |                                    If Mid(gbuMGet||10416  |                                    If Mid(gbuMGet
10444  |                                    Or Mid(Replace||10417  |                                    Or Mid(Replace
10445  |                                        If lRecCnt||10418  |                                        If lRecCnt
10446  |                                            If gbu||10419  |                                            If gbu
10447  |                                            And gb||10420  |                                            And gb
10448  |                                                If||10421  |                                                If
10449  |                                                  ||10422  |                                                  
10450  |                                                El||10423  |                                                El
10451  |                                                En||10424  |                                                En
10452  |                                            Else  ||10425  |                                            Else  
10453  |                                            End If||10426  |                                            End If
10454  |                                        Else      ||10427  |                                        Else      
10455  |                                        End If    ||10428  |                                        End If    
10456  |                                        '前回締日 ||10429  |                                        '前回締日 
10457  |                                        dstrWkDate||10430  |                                        dstrWkDate
10458  |                                        If fnChkSe||10431  |                                        If fnChkSe
10459  |                                            gbuMGe||10432  |                                            gbuMGe
10460  |                                        End If    ||10433  |                                        End If    
10461  |                                        If gbuMGet||10434  |                                        If gbuMGet
10462  |                                        Else      ||10435  |                                        Else      
10463  |                                            gbuMGe||10436  |                                            gbuMGe
10464  |                                        End If    ||10437  |                                        End If    
10465  |                                    End If        ||10438  |                                    End If        
10466  |                                End If            ||10439  |                                End If            
10467  |                            End With              ||10440  |                            End With              
10468  |'2005/04/26 Start                                 ||10441  |'2005/04/26 Start                                 
10469  |'                            gbuMGetUPDRec.N(lRecC||10442  |'                            gbuMGetUPDRec.N(lRecC
10470  |                            If ComCalcStart <> "" ||10443  |                            If ComCalcStart <> "" 
10471  |                                If ComCalcStart > ||10444  |                                If ComCalcStart > 
10472  |                                    gbuMGetUPDRec.||10445  |                                    gbuMGetUPDRec.
10473  |                                Else              ||10446  |                                Else              
10474  |                                    gbuMGetUPDRec.||10447  |                                    gbuMGetUPDRec.
10475  |                                End If            ||10448  |                                End If            
10476  |                                If dstrSvDate <> "||10449  |                                If dstrSvDate <> "
10477  |                                    If dstrSvDate ||10450  |                                    If dstrSvDate 
10478  |                                        gbuMGetUPD||10451  |                                        gbuMGetUPD
10479  |                                    End If        ||10452  |                                    End If        
10480  |                                End If            ||10453  |                                End If            
10481  |                                If dstrUseEnd <> "||10454  |                                If dstrUseEnd <> "
10482  |                                    If dstrUseEnd ||10455  |                                    If dstrUseEnd 
10483  |                                        gbuMGetUPD||10456  |                                        gbuMGetUPD
10484  |                                    End If        ||10457  |                                    End If        
10485  |                                End If            ||10458  |                                End If            
10486  |                            Else                  ||10459  |                            Else                  
10487  |                                gbuMGetUPDRec.N(lR||10460  |                                gbuMGetUPDRec.N(lR
10488  |                            End If                ||10461  |                            End If                
10489  |                            If ComCalcEnd <> "" Th||10462  |                            If ComCalcEnd <> "" Th
10490  |                                If ComCalcEnd < gb||10463  |                                If ComCalcEnd < gb
10491  |                                    gbuMGetUPDRec.||10464  |                                    gbuMGetUPDRec.
10492  |'2005/04/XX Start                                 ||10465  |'2005/04/XX Start                                 
10493  |                                Else              ||10466  |                                Else              
10494  |                                    If ComCalcEnd ||10467  |                                    If ComCalcEnd 
10495  |                                        dstrSvSett||10468  |                                        dstrSvSett
10496  |                                    End If        ||10469  |                                    End If        
10497  |'2005/04/XX End                                   ||10470  |'2005/04/XX End                                   
10498  |                                End If            ||10471  |                                End If            
10499  |                            End If                ||10472  |                            End If                
10500  |'2005/04/XX Start                                 ||10473  |'2005/04/XX Start                                 
10501  |                            If ComCalcStart <> "" ||10474  |                            If ComCalcStart <> "" 
10502  |                            And ComCalcEnd <> "" T||10475  |                            And ComCalcEnd <> "" T
10503  |                                If dstrSvSettlemen||10476  |                                If dstrSvSettlemen
10504  |                                And dstrSvSettleme||10477  |                                And dstrSvSettleme
10505  |                                Else              ||10478  |                                Else              
10506  |                                    GoTo NextData ||10479  |                                    GoTo NextData 
10507  |                                End If            ||10480  |                                End If            
10508  |                            End If                ||10481  |                            End If                
10509  |'2005/04/XX End                                   ||10482  |'2005/04/XX End                                   
10510  |'2005/04/26 End                                   ||10483  |'2005/04/26 End                                   
10511  |                            'グリッドの行カウンタ ||10484  |                            'グリッドの行カウンタ 
10512  |                            lRowCnt = lRowCnt + 1 ||10485  |                            lRowCnt = lRowCnt + 1 
10513  |                            'グリッドにセット     ||10486  |                            'グリッドにセット     
10514  |                            Call sbMakePrintFlexGr||10487  |                            Call sbMakePrintFlexGr
10515  |'2005/04/21 End                                   ||10488  |'2005/04/21 End                                   
10516  |                        End If                    ||10489  |                        End If                    
10517  |'2005/04/XX Start                                 ||10490  |'2005/04/XX Start                                 
10518  |                    Else                          ||10491  |                    Else                          
10519  |                        If ComCalcEnd <> "" Then  ||10492  |                        If ComCalcEnd <> "" Then  
10520  |'                            If strCONTRACTNo = "W||10493  |'                            If strCONTRACTNo = "W
10521  |'                                MsgBox strCONTRAC||10494  |'                                MsgBox strCONTRAC
10522  |'                            End If               ||10495  |'                            End If               
10523  |                            '通常締日件数チェック ||10496  |                            '通常締日件数チェック 
10524  |                            If lCnt > 1 Then      ||10497  |                            If lCnt > 1 Then      
10525  |                            Else                  ||10498  |                            Else                  
10526  |                                dstrSvSettlementDa||10499  |                                dstrSvSettlementDa
10527  |                                gbuMGetUPDRec.N(lR||10500  |                                gbuMGetUPDRec.N(lR
10528  |                                'グリッドの行カウ ||10501  |                                'グリッドの行カウ 
10529  |                                lRowCnt = lRowCnt ||10502  |                                lRowCnt = lRowCnt 
10530  |                                'グリッドにセット ||10503  |                                'グリッドにセット 
10531  |                                Call sbMakePrintFl||10504  |                                Call sbMakePrintFl
10532  |                            End If                ||10505  |                            End If                
10533  |                        End If                    ||10506  |                        End If                    
10534  |'2005/04/XX End                                   ||10507  |'2005/04/XX End                                   
10535  |                    End If                        ||10508  |                    End If                        
10536  |                End If                            ||10509  |                End If                            
10537  |        End If                                    ||10510  |        End If                                    
10538  |'2005/01/18 End                                   ||10511  |'2005/01/18 End                                   
10539  |'        End If                                   ||10512  |'        End If                                   
10540  |'2005/04/21 Start                                 ||10513  |'2005/04/21 Start                                 
10541  |NextData:                                         ||10514  |NextData:                                         
10542  |'2005/04/21 End                                   ||10515  |'2005/04/21 End                                   
10543  |    Next lRecCnt                                  ||10516  |    Next lRecCnt                                  
10544  |                                                  ||10517  |                                                  
10545  |    With fgridMakePrint                           ||10518  |    With fgridMakePrint                           
10546  |        '抽出０件の場合は出力ボタンを無効にする   ||10519  |        '抽出０件の場合は出力ボタンを無効にする   
10547  |        If lRowCnt = 0 Then                       ||10520  |        If lRowCnt = 0 Then                       
10548  |            cmdMake.Enabled = False               ||10521  |            cmdMake.Enabled = False               
10549  |            iRet = MsgBox("出力情報がありません。"||10522  |            iRet = MsgBox("出力情報がありません。"
10550  |            .Editable = flexEDNone        'グリッ ||10523  |            .Editable = flexEDNone        'グリッ 
10551  |        Else                                      ||10524  |        Else                                      
10552  |            cmdMake.Enabled = True                ||10525  |            cmdMake.Enabled = True                
10553  |            .Editable = flexEDKbdMouse    'グリッ ||10526  |            .Editable = flexEDKbdMouse    'グリッ 
10554  |            .Select 1, 0                          ||10527  |            .Select 1, 0                          
10555  |        End If                                    ||10528  |        End If                                    
10556  |                                                  ||10529  |                                                  
10557  |        'スクロールバー表示・非表示設定           ||10530  |        'スクロールバー表示・非表示設定           
10558  |        If lRowCnt < 16 Then                      ||10531  |        If lRowCnt < 16 Then                      
10559  |            .Left = .Left + 120                   ||10532  |            .Left = .Left + 120                   
10560  |            .Width = .Width - 240                 ||10533  |            .Width = .Width - 240                 
10561  |        End If                                    ||10534  |        End If                                    
10562  |                                                  ||10535  |                                                  
10563  |        If lRowCnt > 1 Then                       ||10536  |        If lRowCnt > 1 Then                       
10564  |            '表示行設定                           ||10537  |            '表示行設定                           
10565  |            .TopRow = lActiveIdx                  ||10538  |            .TopRow = lActiveIdx                  
10566  |            lActiveIdx = lActiveIdx + 1           ||10539  |            lActiveIdx = lActiveIdx + 1           
10567  |            .Row = lActiveIdx                     ||10540  |            .Row = lActiveIdx                     
10568  |        End If                                    ||10541  |        End If                                    
10569  |                                                  ||10542  |                                                  
10570  |        'グリッド表示                             ||10543  |        'グリッド表示                             
10571  |        .Visible = True                           ||10544  |        .Visible = True                           
10572  |    End With                                      ||10545  |    End With                                      
10573  |                                                  ||10546  |                                                  
10574  |    '戻り値セット                                 ||10547  |    '戻り値セット                                 
10575  |    fnMakePrintDataSet = True                     ||10548  |    fnMakePrintDataSet = True                     
10576  |                                                  ||10549  |                                                  
10577  |End Function                                      ||10550  |End Function                                      
10578  |                                                  ||10551  |                                                  
10579  |'=================================================||10552  |'=================================================
10580  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMakePrintFlexGridDataSet   ||10553  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMakePrintFlexGridDataSet   
10581  |'機能            :   オラクル抽出結果をMakePrintFl||10554  |'機能            :   オラクル抽出結果をMakePrintFl
10582  |'                                                 ||10555  |'                                                 
10583  |'日付               担当　              修正内容  ||10556  |'日付               担当　              修正内容  
10584  |'-------------------------------------------------||10557  |'-------------------------------------------------
10585  |'2004/08/06         M.Katoh<SRA>       新規作成   ||10558  |'2004/08/06         M.Katoh<SRA>       新規作成   
10586  |'2004/12/29         M.Yamazaki<SRA>    NAV取得区分||10559  |'2004/12/29         M.Yamazaki<SRA>    NAV取得区分
10587  |'2005/01/11         M.Yamazaki<SRA>    列追加     ||10560  |'2005/01/11         M.Yamazaki<SRA>    列追加     
10588  |'2005/01/14         M.Yamazaki<SRA>    各通貨(NAV ||10561  |'2005/01/14         M.Yamazaki<SRA>    各通貨(NAV 
10589  |'2005/01/17         M.Yamazaki<SRA>    列追加をせ ||10562  |'2005/01/17         M.Yamazaki<SRA>    列追加をせ 
10590  |'2005/02/02         M.Yamazaki<SRA>    前回締日営 ||10563  |'2005/02/02         M.Yamazaki<SRA>    前回締日営 
10591  |'2005/03/09         M.Yamazaki<SRA>    消費税計算 ||10564  |'2005/03/09         M.Yamazaki<SRA>    消費税計算 
10592  |'2005/04/22         M.Yamazaki<SRA>    重複データ ||10565  |'2005/04/22         M.Yamazaki<SRA>    重複データ 
10593  |'2005/07/25         K.Nishihama<SRA>   英文チェッ ||10566  |'2005/07/25         K.Nishihama<SRA>   英文チェッ 
10594  |'2005/08/04         K.Nishihama<SRA>   契約名[英],||10567  |'2005/08/04         K.Nishihama<SRA>   契約名[英],
10595  |'2006/05/29         K.Furuya<SRA>      外部委託顧 ||10568  |'2006/05/29         K.Furuya<SRA>      外部委託顧 
10596  |'2008/03/12         K.Furuya<SRA>      ファンド決 ||10569  |'2008/03/12         K.Furuya<SRA>      ファンド決 
10597  |'=================================================||10570  |'=================================================
10598  |Private Sub sbMakePrintFlexGridDataSet( _         ||10571  |Private Sub sbMakePrintFlexGridDataSet( _         
10599  |    ByVal lRow As Long, _                         ||10572  |    ByVal lRow As Long, _                         
10600  |    ByVal lArrayCnt As Long _                     ||10573  |    ByVal lArrayCnt As Long _                     
10601  |)                                                 ||10574  |)                                                 
10602  |                                                  ||10575  |                                                  
10603  |    Dim iIdx            As Integer                ||10576  |    Dim iIdx            As Integer                
10604  |    Dim sStr            As String                 ||10577  |    Dim sStr            As String                 
10605  |'2005/04/22 Start                                 ||10578  |'2005/04/22 Start                                 
10606  |    Dim dstrContno      As String                 ||10579  |    Dim dstrContno      As String                 
10607  |    Dim dstrSettdate    As String                 ||10580  |    Dim dstrSettdate    As String                 
10608  |    Dim dstrAccountcd   As String                 ||10581  |    Dim dstrAccountcd   As String                 
10609  |'2005/04/22 End                                   ||10582  |'2005/04/22 End                                   
10610  |'2006/05/29 START K.Furuya RAFI対応               ||10583  |'2006/05/29 START K.Furuya RAFI対応               
10611  |    Dim strCode         As String                 ||10584  |    Dim strCode         As String                 
10612  |'2006/05/29 END   K.Furuya RAFI対応               ||10585  |'2006/05/29 END   K.Furuya RAFI対応               
10613  |                                                  ||10586  |                                                  
10614  |                                                  ||10587  |                                                  
10615  |    '列ｲﾝﾃﾞｯｸｽ初期化                              ||10588  |    '列ｲﾝﾃﾞｯｸｽ初期化                              
10616  |    iIdx = 0                                      ||10589  |    iIdx = 0                                      
10617  |                                                  ||10590  |                                                  
10618  |    With fgridMakePrint                           ||10591  |    With fgridMakePrint                           
10619  |                                                  ||10592  |                                                  
10620  |'2005/04/22 Start                                 ||10593  |'2005/04/22 Start                                 
10621  |        If lRow > 1 Then                          ||10594  |        If lRow > 1 Then                          
10622  |            '前行を指定                           ||10595  |            '前行を指定                           
10623  |            lRow = lRow - 1                       ||10596  |            lRow = lRow - 1                       
10624  |            .Col = 2                              ||10597  |            .Col = 2                              
10625  |            dstrContno = .Text                    ||10598  |            dstrContno = .Text                    
10626  |            .Col = 6                              ||10599  |            .Col = 6                              
10627  |            dstrSettdate = Replace(.Text, "/", "")||10600  |            dstrSettdate = Replace(.Text, "/", "")
10628  |            .Col = 7                              ||10601  |            .Col = 7                              
10629  |            dstrAccountcd = .Text                 ||10602  |            dstrAccountcd = .Text                 
10630  |            If dstrContno = gbuMGetUPDRec.N(lArray||10603  |            If dstrContno = gbuMGetUPDRec.N(lArray
10631  |            And dstrSettdate = dstrSvSettlementDat||10604  |            And dstrSettdate = dstrSvSettlementDat
10632  |            And dstrAccountcd = gbuMGetUPDRec.N(lA||10605  |            And dstrAccountcd = gbuMGetUPDRec.N(lA
10633  |                lRowCnt = lRowCnt - 1             ||10606  |                lRowCnt = lRowCnt - 1             
10634  |                Exit Sub                          ||10607  |                Exit Sub                          
10635  |            End If                                ||10608  |            End If                                
10636  |            '行を戻す                             ||10609  |            '行を戻す                             
10637  |            lRow = lRow + 1                       ||10610  |            lRow = lRow + 1                       
10638  |        End If                                    ||10611  |        End If                                    
10639  |'2005/04/22 End                                   ||10612  |'2005/04/22 End                                   
10640  |                                                  ||10613  |                                                  
10641  |        '最終行を設定                             ||10614  |        '最終行を設定                             
10642  |        .Rows = lRow + 1                          ||10615  |        .Rows = lRow + 1                          
10643  |        '行を指定                                 ||10616  |        '行を指定                                 
10644  |        .Row = lRow                               ||10617  |        .Row = lRow                               
10645  |                                                  ||10618  |                                                  
10646  |        '出力                                     ||10619  |        '出力                                     
10647  |        iIdx = iIdx + 1                           ||10620  |        iIdx = iIdx + 1                           
10648  |        .Col = iIdx: .Text = 0                    ||10621  |        .Col = iIdx: .Text = 0                    
10649  |                                                  ||10622  |                                                  
10650  |'2005/07/25 Start                                 ||10623  |'2005/07/25 Start                                 
10651  |        '英文                                     ||10624  |        '英文                                     
10652  |        iIdx = iIdx + 1                           ||10625  |        iIdx = iIdx + 1                           
10653  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10626  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10654  |'2005/07/25 End                                   ||10627  |'2005/07/25 End                                   
10655  |                                                  ||10628  |                                                  
10656  |        '契約番号                                 ||10629  |        '契約番号                                 
10657  |        iIdx = iIdx + 1                           ||10630  |        iIdx = iIdx + 1                           
10658  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10631  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10659  |        '契約名                                   ||10632  |        '契約名                                   
10660  |        iIdx = iIdx + 1                           ||10633  |        iIdx = iIdx + 1                           
10661  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10634  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10662  |                                                  ||10635  |                                                  
10663  |'2005/08/04 Start                                 ||10636  |'2005/08/04 Start                                 
10664  |        '契約名[英]                               ||10637  |        '契約名[英]                               
10665  |        iIdx = iIdx + 1                           ||10638  |        iIdx = iIdx + 1                           
10666  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10639  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10667  |'2005/08/04 End                                   ||10640  |'2005/08/04 End                                   
10668  |                                                  ||10641  |                                                  
10669  |        '契約区分                                 ||10642  |        '契約区分                                 
10670  |        iIdx = iIdx + 1                           ||10643  |        iIdx = iIdx + 1                           
10671  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10644  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10672  |                                                  ||10645  |                                                  
10673  |'2006/05/29 START K.Furuya RAFI対応(INIファイル取 ||10646  |'2006/05/29 START K.Furuya RAFI対応(INIファイル取 
10674  |'        Select Case .Text                        ||10647  |'        Select Case .Text                        
10675  |'            Case 1  '投信外部委託顧問料計算      ||10648  |'            Case 1  '投信外部委託顧問料計算      
10676  |'                .Text = mstrContractFlag(1)      ||10649  |'                .Text = mstrContractFlag(1)      
10677  |'            Case 2  '業務サービス計算            ||10650  |'            Case 2  '業務サービス計算            
10678  |'                .Text = mstrContractFlag(2)      ||10651  |'                .Text = mstrContractFlag(2)      
10679  |'            Case 3  '名称使用許諾料計算          ||10652  |'            Case 3  '名称使用許諾料計算          
10680  |'                .Text = mstrContractFlag(3)      ||10653  |'                .Text = mstrContractFlag(3)      
10681  |'                                                 ||10654  |'                                                 
10682  |''2005/03/09 Start                                ||10655  |''2005/03/09 Start                                
10683  |''            Case 4  '業務サービス料(外貨)       ||10656  |''            Case 4  '業務サービス料(外貨)       
10684  |''                .Text = mstrContractFlag(4)     ||10657  |''                .Text = mstrContractFlag(4)     
10685  |''2005/03/09 End                                  ||10658  |''2005/03/09 End                                  
10686  |'        End Select                               ||10659  |'        End Select                               
10687  |        strCode = .Text                           ||10660  |        strCode = .Text                           
10688  |        .Text = gstrConstNameGet(CONTRACT_FLAG, st||10661  |        .Text = gstrConstNameGet(CONTRACT_FLAG, st
10689  |'2006/05/29 END   K.Furuya RAFI対応               ||10662  |'2006/05/29 END   K.Furuya RAFI対応               
10690  |                                                  ||10663  |                                                  
10691  |        '締日営業日翌日                           ||10664  |        '締日営業日翌日                           
10692  |        iIdx = iIdx + 1                           ||10665  |        iIdx = iIdx + 1                           
10693  |        sStr = gbuMGetUPDRec.N(lArrayCnt).MGET_set||10666  |        sStr = gbuMGetUPDRec.N(lArrayCnt).MGET_set
10694  |        If Len(sStr) = 4 Then                     ||10667  |        If Len(sStr) = 4 Then                     
10695  |            sStr = Mid(sStr, 1, 2) & "/" & Mid(sSt||10668  |            sStr = Mid(sStr, 1, 2) & "/" & Mid(sSt
10696  |        End If                                    ||10669  |        End If                                    
10697  |        .Col = iIdx: .Text = sStr                 ||10670  |        .Col = iIdx: .Text = sStr                 
10698  |        '締日                                     ||10671  |        '締日                                     
10699  |        iIdx = iIdx + 1                           ||10672  |        iIdx = iIdx + 1                           
10700  |        sStr = gbuMGetUPDRec.N(lArrayCnt).MGET_set||10673  |        sStr = gbuMGetUPDRec.N(lArrayCnt).MGET_set
10701  |        If Len(sStr) = 8 Then                     ||10674  |        If Len(sStr) = 8 Then                     
10702  |            sStr = Mid(sStr, 1, 4) & "/" & Mid(sSt||10675  |            sStr = Mid(sStr, 1, 4) & "/" & Mid(sSt
10703  |        End If                                    ||10676  |        End If                                    
10704  |        .Col = iIdx: .Text = sStr                 ||10677  |        .Col = iIdx: .Text = sStr                 
10705  |        '口座コード                               ||10678  |        '口座コード                               
10706  |        iIdx = iIdx + 1                           ||10679  |        iIdx = iIdx + 1                           
10707  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10680  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10708  |        '口座名                                   ||10681  |        '口座名                                   
10709  |        iIdx = iIdx + 1                           ||10682  |        iIdx = iIdx + 1                           
10710  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10683  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10711  |        '通貨コード                               ||10684  |        '通貨コード                               
10712  |        iIdx = iIdx + 1                           ||10685  |        iIdx = iIdx + 1                           
10713  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10686  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10714  |        '適用開始日                               ||10687  |        '適用開始日                               
10715  |        iIdx = iIdx + 1                           ||10688  |        iIdx = iIdx + 1                           
10716  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10689  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10717  |        '適用終了日                               ||10690  |        '適用終了日                               
10718  |        iIdx = iIdx + 1                           ||10691  |        iIdx = iIdx + 1                           
10719  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10692  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10720  |        '運用会社コード                           ||10693  |        '運用会社コード                           
10721  |        iIdx = iIdx + 1                           ||10694  |        iIdx = iIdx + 1                           
10722  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10695  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10723  |        '運用会社名                               ||10696  |        '運用会社名                               
10724  |        iIdx = iIdx + 1                           ||10697  |        iIdx = iIdx + 1                           
10725  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10698  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10726  |                                                  ||10699  |                                                  
10727  |'2005/08/04 Start                                 ||10700  |'2005/08/04 Start                                 
10728  |        '運用会社名[英]                           ||10701  |        '運用会社名[英]                           
10729  |        iIdx = iIdx + 1                           ||10702  |        iIdx = iIdx + 1                           
10730  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10703  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10731  |'2005/08/04 End                                   ||10704  |'2005/08/04 End                                   
10732  |                                                  ||10705  |                                                  
10733  |        'ルールNo                                 ||10706  |        'ルールNo                                 
10734  |        iIdx = iIdx + 1                           ||10707  |        iIdx = iIdx + 1                           
10735  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10708  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10736  |        '料率区分                                 ||10709  |        '料率区分                                 
10737  |        iIdx = iIdx + 1                           ||10710  |        iIdx = iIdx + 1                           
10738  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10711  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10739  |'2004/12/29 Start                                 ||10712  |'2004/12/29 Start                                 
10740  |        'NAV取得区分                              ||10713  |        'NAV取得区分                              
10741  |        iIdx = iIdx + 1                           ||10714  |        iIdx = iIdx + 1                           
10742  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10715  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10743  |        '上限金額                                 ||10716  |        '上限金額                                 
10744  |                                                  ||10717  |                                                  
10745  |        iIdx = iIdx + 1                           ||10718  |        iIdx = iIdx + 1                           
10746  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10719  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10747  |        '下限金額                                 ||10720  |        '下限金額                                 
10748  |        iIdx = iIdx + 1                           ||10721  |        iIdx = iIdx + 1                           
10749  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10722  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10750  |'2004/12/29 End                                   ||10723  |'2004/12/29 End                                   
10751  |        '支払予定日                               ||10724  |        '支払予定日                               
10752  |        iIdx = iIdx + 1                           ||10725  |        iIdx = iIdx + 1                           
10753  |        .Col = iIdx: .Text = ""                   ||10726  |        .Col = iIdx: .Text = ""                   
10754  |'2005/01/11 Start                                 ||10727  |'2005/01/11 Start                                 
10755  |        'NAV通貨                                  ||10728  |        'NAV通貨                                  
10756  |        iIdx = iIdx + 1                           ||10729  |        iIdx = iIdx + 1                           
10757  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10730  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10758  |        '閾値通貨                                 ||10731  |        '閾値通貨                                 
10759  |        iIdx = iIdx + 1                           ||10732  |        iIdx = iIdx + 1                           
10760  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10733  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10761  |        '顧問料通貨                               ||10734  |        '顧問料通貨                               
10762  |        iIdx = iIdx + 1                           ||10735  |        iIdx = iIdx + 1                           
10763  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10736  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10764  |'2005/01/17 Start                                 ||10737  |'2005/01/17 Start                                 
10765  |'        'NAV通貨→閾値通貨換算レート             ||10738  |'        'NAV通貨→閾値通貨換算レート             
10766  |'        iIdx = iIdx + 1                          ||10739  |'        iIdx = iIdx + 1                          
10767  |'        .Col = iIdx: .Text = ""                  ||10740  |'        .Col = iIdx: .Text = ""                  
10768  |'        'NAV通貨→顧問料通貨換算レート           ||10741  |'        'NAV通貨→顧問料通貨換算レート           
10769  |'        iIdx = iIdx + 1                          ||10742  |'        iIdx = iIdx + 1                          
10770  |'        .Col = iIdx: .Text = ""                  ||10743  |'        .Col = iIdx: .Text = ""                  
10771  |'        '閾値通貨→顧問料通貨換算レート          ||10744  |'        '閾値通貨→顧問料通貨換算レート          
10772  |'        iIdx = iIdx + 1                          ||10745  |'        iIdx = iIdx + 1                          
10773  |'        .Col = iIdx: .Text = ""                  ||10746  |'        .Col = iIdx: .Text = ""                  
10774  |'        '顧問料レート→支払(円)換算レート        ||10747  |'        '顧問料レート→支払(円)換算レート        
10775  |'        iIdx = iIdx + 1                          ||10748  |'        iIdx = iIdx + 1                          
10776  |'        .Col = iIdx: .Text = ""                  ||10749  |'        .Col = iIdx: .Text = ""                  
10777  |'2005/01/17 End                                   ||10750  |'2005/01/17 End                                   
10778  |        '一年間の日数                             ||10751  |        '一年間の日数                             
10779  |        iIdx = iIdx + 1                           ||10752  |        iIdx = iIdx + 1                           
10780  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10753  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10781  |'2005/01/11 End                                   ||10754  |'2005/01/11 End                                   
10782  |'2005/03/09 Start                                 ||10755  |'2005/03/09 Start                                 
10783  |        '消費税計算有無                           ||10756  |        '消費税計算有無                           
10784  |        iIdx = iIdx + 1                           ||10757  |        iIdx = iIdx + 1                           
10785  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra||10758  |        .Col = iIdx: .Text = gbuMGetUPDRec.N(lArra
10786  |'2005/03/09 End                                   ||10759  |'2005/03/09 End                                   
10787  |'2008/03/12 START ファンド決算期間での外部委託顧問||10760  |'2008/03/12 START ファンド決算期間での外部委託顧問
10788  |        'ファンド計算FROM                         ||10761  |        'ファンド計算FROM                         
10789  |        iIdx = iIdx + 1                           ||10762  |        iIdx = iIdx + 1                           
10790  |        .Col = iIdx: .Text = ""                   ||10763  |        .Col = iIdx: .Text = ""                   
10791  |        'ファンド計算TO                           ||10764  |        'ファンド計算TO                           
10792  |        iIdx = iIdx + 1                           ||10765  |        iIdx = iIdx + 1                           
10793  |        .Col = iIdx: .Text = ""                   ||10766  |        .Col = iIdx: .Text = ""                   
10794  |'2008/03/12 END   ファンド決算期間での外部委託顧問||10767  |'2008/03/12 END   ファンド決算期間での外部委託顧問
10795  |                                                  ||10768  |                                                  
10796  |                                                  ||10769  |                                                  
10797  |''debug                                           ||10770  |''debug                                           
10798  |'        .Col = iIdx: .Text = Date   '←リリース時||10771  |'        .Col = iIdx: .Text = Date   '←リリース時
10799  |                                                  ||10772  |                                                  
10800  |        If (lRow > 0) Then                        ||10773  |        If (lRow > 0) Then                        
10801  |            .Cell(flexcpBackColor, 1, conColSysOut||10774  |            .Cell(flexcpBackColor, 1, conColSysOut
10802  |            .Cell(flexcpBackColor, 1, conColPayMen||10775  |            .Cell(flexcpBackColor, 1, conColPayMen
10803  |'2008/03/12 START ファンド決算期間での外部委託顧問||10776  |'2008/03/12 START ファンド決算期間での外部委託顧問
10804  |            .Cell(flexcpBackColor, 1, conColFndCal||10777  |            .Cell(flexcpBackColor, 1, conColFndCal
10805  |            .Cell(flexcpBackColor, 1, conColFndCal||10778  |            .Cell(flexcpBackColor, 1, conColFndCal
10806  |'2008/03/12 END   ファンド決算期間での外部委託顧問||10779  |'2008/03/12 END   ファンド決算期間での外部委託顧問
10807  |                                                  ||10780  |                                                  
10808  |'2005/01/17 Start                                 ||10781  |'2005/01/17 Start                                 
10809  |''2005/01/11 Start                                ||10782  |''2005/01/11 Start                                
10810  |'            .Cell(flexcpBackColor, 1, conColNavAm||10783  |'            .Cell(flexcpBackColor, 1, conColNavAm
10811  |'            .Cell(flexcpBackColor, 1, conColNavCo||10784  |'            .Cell(flexcpBackColor, 1, conColNavCo
10812  |'            .Cell(flexcpBackColor, 1, conColAmoun||10785  |'            .Cell(flexcpBackColor, 1, conColAmoun
10813  |'            .Cell(flexcpBackColor, 1, conColComPa||10786  |'            .Cell(flexcpBackColor, 1, conColComPa
10814  |''2005/01/11 End                                  ||10787  |''2005/01/11 End                                  
10815  |''2005/01/14 Start                                ||10788  |''2005/01/14 Start                                
10816  |'            'NAV通貨 VS. 閾値通貨 初期値設定(NAV ||10789  |'            'NAV通貨 VS. 閾値通貨 初期値設定(NAV 
10817  |'            If fgridMakePrint.Cell(flexcpText, lR||10790  |'            If fgridMakePrint.Cell(flexcpText, lR
10818  |'                fgridMakePrint.Cell(flexcpText, l||10791  |'                fgridMakePrint.Cell(flexcpText, l
10819  |'            End If                               ||10792  |'            End If                               
10820  |'            'NAV通貨 VS. 外部委託顧問料通貨 初期 ||10793  |'            'NAV通貨 VS. 外部委託顧問料通貨 初期 
10821  |'            If fgridMakePrint.Cell(flexcpText, lR||10794  |'            If fgridMakePrint.Cell(flexcpText, lR
10822  |'                fgridMakePrint.Cell(flexcpText, l||10795  |'                fgridMakePrint.Cell(flexcpText, l
10823  |'            End If                               ||10796  |'            End If                               
10824  |'            '閾値通貨 VS. 外部委託顧問料通貨 初期||10797  |'            '閾値通貨 VS. 外部委託顧問料通貨 初期
10825  |'            If fgridMakePrint.Cell(flexcpText, lR||10798  |'            If fgridMakePrint.Cell(flexcpText, lR
10826  |'                fgridMakePrint.Cell(flexcpText, l||10799  |'                fgridMakePrint.Cell(flexcpText, l
10827  |'            End If                               ||10800  |'            End If                               
10828  |'            '外部委託顧問料通貨 VS. 支払通貨('JPY||10801  |'            '外部委託顧問料通貨 VS. 支払通貨('JPY
10829  |'            If fgridMakePrint.Cell(flexcpText, lR||10802  |'            If fgridMakePrint.Cell(flexcpText, lR
10830  |'                fgridMakePrint.Cell(flexcpText, l||10803  |'                fgridMakePrint.Cell(flexcpText, l
10831  |'            End If                               ||10804  |'            End If                               
10832  |''2005/01/14 End                                  ||10805  |''2005/01/14 End                                  
10833  |'2005/01/17 End                                   ||10806  |'2005/01/17 End                                   
10834  |        End If                                    ||10807  |        End If                                    
10835  |                                                  ||10808  |                                                  
10836  |    End With                                      ||10809  |    End With                                      
10837  |                                                  ||10810  |                                                  
10838  |End Sub                                           ||10811  |End Sub                                           
10839  |                                                  ||10812  |                                                  
10840  |'=================================================||10813  |'=================================================
10841  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnNyuryokuCheck              ||10814  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnNyuryokuCheck              
10842  |'機能            :   確認書作成画面入力データチェ ||10815  |'機能            :   確認書作成画面入力データチェ 
10843  |'                                                 ||10816  |'                                                 
10844  |'日付               担当　              修正内容  ||10817  |'日付               担当　              修正内容  
10845  |'-------------------------------------------------||10818  |'-------------------------------------------------
10846  |'2004/08/06         M.Katoh<SRA>       新規作成   ||10819  |'2004/08/06         M.Katoh<SRA>       新規作成   
10847  |'2005/01/11         M.Yamazaki<SRA>    変更可能列 ||10820  |'2005/01/11         M.Yamazaki<SRA>    変更可能列 
10848  |'2005/01/17         M.Yamazaki<SRA>    変更可能列 ||10821  |'2005/01/17         M.Yamazaki<SRA>    変更可能列 
10849  |'2008/03/12         K.Furuya<SRA>      ファンド決 ||10822  |'2008/03/12         K.Furuya<SRA>      ファンド決 
10850  |'=================================================||10823  |'=================================================
10851  |Private Function fnNyuryokuCheck() As Boolean     ||10824  |Private Function fnNyuryokuCheck() As Boolean     
10852  |                                                  ||10825  |                                                  
10853  |    Dim Cnt As Integer                            ||10826  |    Dim Cnt As Integer                            
10854  |'2008/03/12 START ファンド決算期間での外部委託顧問||10827  |'2008/03/12 START ファンド決算期間での外部委託顧問
10855  |    Dim strCalcFrom     As String  'ファンド計算FR||10828  |    Dim strCalcFrom     As String  'ファンド計算FR
10856  |    Dim strCalcTo       As String  'ファンド計算TO||10829  |    Dim strCalcTo       As String  'ファンド計算TO
10857  |'2008/03/12 END   ファンド決算期間での外部委託顧問||10830  |'2008/03/12 END   ファンド決算期間での外部委託顧問
10858  |                                                  ||10831  |                                                  
10859  |    '戻り値初期化                                 ||10832  |    '戻り値初期化                                 
10860  |    fnNyuryokuCheck = False                       ||10833  |    fnNyuryokuCheck = False                       
10861  |    gSysoutDataCnt = 0                            ||10834  |    gSysoutDataCnt = 0                            
10862  |                                                  ||10835  |                                                  
10863  |'2008/03/12 START ファンド決算期間での外部委託顧問||10836  |'2008/03/12 START ファンド決算期間での外部委託顧問
10864  |    '変数初期化                                   ||10837  |    '変数初期化                                   
10865  |    strCalcFrom = ""                              ||10838  |    strCalcFrom = ""                              
10866  |    strCalcTo = ""                                ||10839  |    strCalcTo = ""                                
10867  |'2008/03/12 END   ファンド決算期間での外部委託顧問||10840  |'2008/03/12 END   ファンド決算期間での外部委託顧問
10868  |                                                  ||10841  |                                                  
10869  |    '担当者                                       ||10842  |    '担当者                                       
10870  |    If gblnCheckNull(txtInputName) = False Then Ex||10843  |    If gblnCheckNull(txtInputName) = False Then Ex
10871  |    '部署名                                       ||10844  |    '部署名                                       
10872  |    If gblnCheckCombo(cboBumonFlag) = False Then E||10845  |    If gblnCheckCombo(cboBumonFlag) = False Then E
10873  |                                                  ||10846  |                                                  
10874  |    '支払予定日チェック                           ||10847  |    '支払予定日チェック                           
10875  |    With fgridMakePrint                           ||10848  |    With fgridMakePrint                           
10876  |'        For Cnt = LBound(gbuMGetUPDRec.N) To UBou||10849  |'        For Cnt = LBound(gbuMGetUPDRec.N) To UBou
10877  |        For Cnt = 1 To .Rows - 1                  ||10850  |        For Cnt = 1 To .Rows - 1                  
10878  |            .Col = conColSysOutbln                ||10851  |            .Col = conColSysOutbln                
10879  |            .Row = Cnt                            ||10852  |            .Row = Cnt                            
10880  |            If .Text = True Then                  ||10853  |            If .Text = True Then                  
10881  |                '出力データ数カウント             ||10854  |                '出力データ数カウント             
10882  |                gSysoutDataCnt = gSysoutDataCnt + ||10855  |                gSysoutDataCnt = gSysoutDataCnt + 
10883  |                '支払予定日をセット               ||10856  |                '支払予定日をセット               
10884  |                .Col = conColPayMentDate          ||10857  |                .Col = conColPayMentDate          
10885  |                If .Text = "" Then                ||10858  |                If .Text = "" Then                
10886  |                    .BackColorSel = COLOR_ERR     ||10859  |                    .BackColorSel = COLOR_ERR     
10887  |                    MsgBox "支払予定日を入力してく||10860  |                    MsgBox "支払予定日を入力してく
10888  |                    Exit Function                 ||10861  |                    Exit Function                 
10889  |                Else                              ||10862  |                Else                              
10890  |                    If IsDate(.Text) = False Then ||10863  |                    If IsDate(.Text) = False Then 
10891  |                        .BackColorSel = COLOR_ERR ||10864  |                        .BackColorSel = COLOR_ERR 
10892  |                        MsgBox "支払予定日の入力が||10865  |                        MsgBox "支払予定日の入力が
10893  |                        Exit Function             ||10866  |                        Exit Function             
10894  |                    Else                          ||10867  |                    Else                          
10895  |                        .BackColorSel = COLOR_CHG_||10868  |                        .BackColorSel = COLOR_CHG_
10896  |                    End If                        ||10869  |                    End If                        
10897  |                End If                            ||10870  |                End If                            
10898  |'2008/03/12 START ファンド決算期間での外部委託顧問||10871  |'2008/03/12 START ファンド決算期間での外部委託顧問
10899  |                'ファンド計算FROMをセット         ||10872  |                'ファンド計算FROMをセット         
10900  |                .Col = conColFndCalcFrom          ||10873  |                .Col = conColFndCalcFrom          
10901  |                strCalcFrom = .Text               ||10874  |                strCalcFrom = .Text               
10902  |                'ファンド計算TOをセット           ||10875  |                'ファンド計算TOをセット           
10903  |                .Col = conColFndCalcTo            ||10876  |                .Col = conColFndCalcTo            
10904  |                strCalcTo = .Text                 ||10877  |                strCalcTo = .Text                 
10905  |                'FROMとTOのどちらかに入力があれば ||10878  |                'FROMとTOのどちらかに入力があれば 
10906  |                If strCalcFrom <> "" Or strCalcTo ||10879  |                If strCalcFrom <> "" Or strCalcTo 
10907  |                    'FROMが未入力の場合キャンセル ||10880  |                    'FROMが未入力の場合キャンセル 
10908  |                    If strCalcFrom = "" Then      ||10881  |                    If strCalcFrom = "" Then      
10909  |                        .Col = conColFndCalcFrom  ||10882  |                        .Col = conColFndCalcFrom  
10910  |                        .BackColorSel = COLOR_ERR ||10883  |                        .BackColorSel = COLOR_ERR 
10911  |                        MsgBox "ファンド計算FROMを||10884  |                        MsgBox "ファンド計算FROMを
10912  |                        Exit Function             ||10885  |                        Exit Function             
10913  |                    ElseIf strCalcTo = "" Then    ||10886  |                    ElseIf strCalcTo = "" Then    
10914  |                        .Col = conColFndCalcTo    ||10887  |                        .Col = conColFndCalcTo    
10915  |                        .BackColorSel = COLOR_ERR ||10888  |                        .BackColorSel = COLOR_ERR 
10916  |                        MsgBox "ファンド計算TOを入||10889  |                        MsgBox "ファンド計算TOを入
10917  |                        Exit Function             ||10890  |                        Exit Function             
10918  |                    Else                          ||10891  |                    Else                          
10919  |                        'FROMの入力値の整合性をチ ||10892  |                        'FROMの入力値の整合性をチ 
10920  |                        If IsDate(strCalcFrom) = F||10893  |                        If IsDate(strCalcFrom) = F
10921  |                            .Col = conColFndCalcFr||10894  |                            .Col = conColFndCalcFr
10922  |                            .BackColorSel = COLOR_||10895  |                            .BackColorSel = COLOR_
10923  |                            MsgBox "ファンド計算FR||10896  |                            MsgBox "ファンド計算FR
10924  |                            Exit Function         ||10897  |                            Exit Function         
10925  |                        Else                      ||10898  |                        Else                      
10926  |                            .Col = conColFndCalcFr||10899  |                            .Col = conColFndCalcFr
10927  |                            .BackColorSel = COLOR_||10900  |                            .BackColorSel = COLOR_
10928  |                        End If                    ||10901  |                        End If                    
10929  |                        'TOの入力値の整合性をチェ ||10902  |                        'TOの入力値の整合性をチェ 
10930  |                        If IsDate(strCalcTo) = Fal||10903  |                        If IsDate(strCalcTo) = Fal
10931  |                            .Col = conColFndCalcTo||10904  |                            .Col = conColFndCalcTo
10932  |                            .BackColorSel = COLOR_||10905  |                            .BackColorSel = COLOR_
10933  |                            MsgBox "ファンド計算TO||10906  |                            MsgBox "ファンド計算TO
10934  |                            Exit Function         ||10907  |                            Exit Function         
10935  |                        Else                      ||10908  |                        Else                      
10936  |                            .Col = conColFndCalcTo||10909  |                            .Col = conColFndCalcTo
10937  |                            .BackColorSel = COLOR_||10910  |                            .BackColorSel = COLOR_
10938  |                        End If                    ||10911  |                        End If                    
10939  |                        'FROM > TO の入力チェック ||10912  |                        'FROM > TO の入力チェック 
10940  |                        If CDate(strCalcFrom) > CD||10913  |                        If CDate(strCalcFrom) > CD
10941  |                            .Col = conColFndCalcTo||10914  |                            .Col = conColFndCalcTo
10942  |                            .BackColorSel = COLOR_||10915  |                            .BackColorSel = COLOR_
10943  |                            MsgBox "ファンド計算TO||10916  |                            MsgBox "ファンド計算TO
10944  |                            Exit Function         ||10917  |                            Exit Function         
10945  |                        Else                      ||10918  |                        Else                      
10946  |                            .Col = conColFndCalcTo||10919  |                            .Col = conColFndCalcTo
10947  |                            .BackColorSel = COLOR_||10920  |                            .BackColorSel = COLOR_
10948  |                        End If                    ||10921  |                        End If                    
10949  |                    End If                        ||10922  |                    End If                        
10950  |                End If                            ||10923  |                End If                            
10951  |'2008/03/12 END   ファンド決算期間での外部委託顧問||10924  |'2008/03/12 END   ファンド決算期間での外部委託顧問
10952  |                                                  ||10925  |                                                  
10953  |'2005/01/17 Start                                 ||10926  |'2005/01/17 Start                                 
10954  |''2005/01/11 Start                                ||10927  |''2005/01/11 Start                                
10955  |'                'NAV通貨→閾値通貨換算レートをセ ||10928  |'                'NAV通貨→閾値通貨換算レートをセ 
10956  |'                .Col = conColOtherRateRuleFlag   ||10929  |'                .Col = conColOtherRateRuleFlag   
10957  |'                If .Text = "2" Then              ||10930  |'                If .Text = "2" Then              
10958  |'                    .Col = conColNavAmount       ||10931  |'                    .Col = conColNavAmount       
10959  |'                    If .Text = "" Then           ||10932  |'                    If .Text = "" Then           
10960  |'                        .BackColorSel = COLOR_ERR||10933  |'                        .BackColorSel = COLOR_ERR
10961  |'                        MsgBox "NAV通貨→閾値通貨||10934  |'                        MsgBox "NAV通貨→閾値通貨
10962  |'                        Exit Function            ||10935  |'                        Exit Function            
10963  |'                    Else                         ||10936  |'                    Else                         
10964  |'                        If IsNumeric(.Text) = Fal||10937  |'                        If IsNumeric(.Text) = Fal
10965  |'                            .BackColorSel = COLOR||10938  |'                            .BackColorSel = COLOR
10966  |'                            MsgBox "NAV通貨→閾値||10939  |'                            MsgBox "NAV通貨→閾値
10967  |'                            Exit Function        ||10940  |'                            Exit Function        
10968  |'                        Else                     ||10941  |'                        Else                     
10969  |'                            .BackColorSel = COLOR||10942  |'                            .BackColorSel = COLOR
10970  |'                        End If                   ||10943  |'                        End If                   
10971  |'                    End If                       ||10944  |'                    End If                       
10972  |'                End If                           ||10945  |'                End If                           
10973  |'                'NAV通貨→顧問料通貨換算レートを ||10946  |'                'NAV通貨→顧問料通貨換算レートを 
10974  |'                .Col = conColNavCom              ||10947  |'                .Col = conColNavCom              
10975  |'                If .Text = "" Then               ||10948  |'                If .Text = "" Then               
10976  |'                    .BackColorSel = COLOR_ERR    ||10949  |'                    .BackColorSel = COLOR_ERR    
10977  |'                    MsgBox "NAV通貨→顧問料通貨換||10950  |'                    MsgBox "NAV通貨→顧問料通貨換
10978  |'                    Exit Function                ||10951  |'                    Exit Function                
10979  |'                Else                             ||10952  |'                Else                             
10980  |'                    If IsNumeric(.Text) = False T||10953  |'                    If IsNumeric(.Text) = False T
10981  |'                        .BackColorSel = COLOR_ERR||10954  |'                        .BackColorSel = COLOR_ERR
10982  |'                        MsgBox "NAV通貨→顧問料通||10955  |'                        MsgBox "NAV通貨→顧問料通
10983  |'                        Exit Function            ||10956  |'                        Exit Function            
10984  |'                    Else                         ||10957  |'                    Else                         
10985  |'                        .BackColorSel = COLOR_CHG||10958  |'                        .BackColorSel = COLOR_CHG
10986  |'                    End If                       ||10959  |'                    End If                       
10987  |'                End If                           ||10960  |'                End If                           
10988  |'                '閾値通貨→顧問料通貨換算レートを||10961  |'                '閾値通貨→顧問料通貨換算レートを
10989  |'                .Col = conColOtherRateRuleFlag   ||10962  |'                .Col = conColOtherRateRuleFlag   
10990  |'                If .Text = "2" Then              ||10963  |'                If .Text = "2" Then              
10991  |'                    .Col = conColAmountCom       ||10964  |'                    .Col = conColAmountCom       
10992  |'                    If .Text = "" Then           ||10965  |'                    If .Text = "" Then           
10993  |'                        .BackColorSel = COLOR_ERR||10966  |'                        .BackColorSel = COLOR_ERR
10994  |'                        MsgBox "閾値通貨→顧問料 ||10967  |'                        MsgBox "閾値通貨→顧問料 
10995  |'                        Exit Function            ||10968  |'                        Exit Function            
10996  |'                    Else                         ||10969  |'                    Else                         
10997  |'                        If IsNumeric(.Text) = Fal||10970  |'                        If IsNumeric(.Text) = Fal
10998  |'                            .BackColorSel = COLOR||10971  |'                            .BackColorSel = COLOR
10999  |'                            MsgBox "閾値通貨→顧 ||10972  |'                            MsgBox "閾値通貨→顧 
11000  |'                            Exit Function        ||10973  |'                            Exit Function        
11001  |'                        Else                     ||10974  |'                        Else                     
11002  |'                            .BackColorSel = COLOR||10975  |'                            .BackColorSel = COLOR
11003  |'                        End If                   ||10976  |'                        End If                   
11004  |'                    End If                       ||10977  |'                    End If                       
11005  |'                End If                           ||10978  |'                End If                           
11006  |'                '顧問料レート→支払(円)換算レート||10979  |'                '顧問料レート→支払(円)換算レート
11007  |'                .Col = conColComPay              ||10980  |'                .Col = conColComPay              
11008  |'                If .Text = "" Then               ||10981  |'                If .Text = "" Then               
11009  |'                    .BackColorSel = COLOR_ERR    ||10982  |'                    .BackColorSel = COLOR_ERR    
11010  |'                    MsgBox "顧問料レート→支払(円||10983  |'                    MsgBox "顧問料レート→支払(円
11011  |'                    Exit Function                ||10984  |'                    Exit Function                
11012  |'                Else                             ||10985  |'                Else                             
11013  |'                    If IsNumeric(.Text) = False T||10986  |'                    If IsNumeric(.Text) = False T
11014  |'                        .BackColorSel = COLOR_ERR||10987  |'                        .BackColorSel = COLOR_ERR
11015  |'                        MsgBox "顧問料レート→支 ||10988  |'                        MsgBox "顧問料レート→支 
11016  |'                        Exit Function            ||10989  |'                        Exit Function            
11017  |'                    Else                         ||10990  |'                    Else                         
11018  |'                        .BackColorSel = COLOR_CHG||10991  |'                        .BackColorSel = COLOR_CHG
11019  |'                    End If                       ||10992  |'                    End If                       
11020  |'                End If                           ||10993  |'                End If                           
11021  |''2005/01/11 End                                  ||10994  |''2005/01/11 End                                  
11022  |'2005/01/17 End                                   ||10995  |'2005/01/17 End                                   
11023  |            End If                                ||10996  |            End If                                
11024  |        Next Cnt                                  ||10997  |        Next Cnt                                  
11025  |    End With                                      ||10998  |    End With                                      
11026  |                                                  ||10999  |                                                  
11027  |    '戻り値セット                                 ||11000  |    '戻り値セット                                 
11028  |    fnNyuryokuCheck = True                        ||11001  |    fnNyuryokuCheck = True                        
11029  |                                                  ||11002  |                                                  
11030  |End Function                                      ||11003  |End Function                                      
11031  |                                                  ||11004  |                                                  
11032  |'=================================================||11005  |'=================================================
11033  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbGridDataGet                ||11006  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbGridDataGet                
11034  |'機能            :   グリッドデータ取得処理       ||11007  |'機能            :   グリッドデータ取得処理       
11035  |'                                                 ||11008  |'                                                 
11036  |'日付               担当　              修正内容  ||11009  |'日付               担当　              修正内容  
11037  |'-------------------------------------------------||11010  |'-------------------------------------------------
11038  |'2004/08/10         M.Katoh<SRA>       新規作成   ||11011  |'2004/08/10         M.Katoh<SRA>       新規作成   
11039  |'2004/09/02         M.Yamazaki<SRA>    複数ページ ||11012  |'2004/09/02         M.Yamazaki<SRA>    複数ページ 
11040  |'2004/12/29         M.Yamazaki<SRA>    NAV取得区分||11013  |'2004/12/29         M.Yamazaki<SRA>    NAV取得区分
11041  |'2005/01/11         M.Yamazaki<SRA>    列追加     ||11014  |'2005/01/11         M.Yamazaki<SRA>    列追加     
11042  |'2005/01/17         M.Yamazaki<SRA>    列追加をせ ||11015  |'2005/01/17         M.Yamazaki<SRA>    列追加をせ 
11043  |'2005/02/02         M.Yamazaki<SRA>    前回締日営 ||11016  |'2005/02/02         M.Yamazaki<SRA>    前回締日営 
11044  |'2005/03/09         M.Yamazaki<SRA>    消費税計算 ||11017  |'2005/03/09         M.Yamazaki<SRA>    消費税計算 
11045  |'2008/03/12         K.Furuya<SRA>      ファンド決 ||11018  |'2008/03/12         K.Furuya<SRA>      ファンド決 
11046  |'=================================================||11019  |'=================================================
11047  |Private Sub sbGridDataGet( _                      ||11020  |Private Sub sbGridDataGet( _                      
11048  |    ByVal lRow As Long, _                         ||11021  |    ByVal lRow As Long, _                         
11049  |    ByVal lDimRow As Long _                       ||11022  |    ByVal lDimRow As Long _                       
11050  |)                                                 ||11023  |)                                                 
11051  |                                                  ||11024  |                                                  
11052  |'2008/03/12 START ファンド決算期間での外部委託顧問||11025  |'2008/03/12 START ファンド決算期間での外部委託顧問
11053  |    Dim strFndCalcFrom      As String  'ファンド計||11026  |    Dim strFndCalcFrom      As String  'ファンド計
11054  |    Dim strFndCalcTo        As String  'ファンド計||11027  |    Dim strFndCalcTo        As String  'ファンド計
11055  |'2008/03/12 END   ファンド決算期間での外部委託顧問||11028  |'2008/03/12 END   ファンド決算期間での外部委託顧問
11056  |                                                  ||11029  |                                                  
11057  |    '変数初期化                                   ||11030  |    '変数初期化                                   
11058  |    strFndCalcFrom = ""                           ||11031  |    strFndCalcFrom = ""                           
11059  |    strFndCalcTo = ""                             ||11032  |    strFndCalcTo = ""                             
11060  |                                                  ||11033  |                                                  
11061  |    '動的配列更新                                 ||11034  |    '動的配列更新                                 
11062  |    ReDim Preserve gbuMGetUPDRec.N(0 To lDimRow)  ||11035  |    ReDim Preserve gbuMGetUPDRec.N(0 To lDimRow)  
11063  |                                                  ||11036  |                                                  
11064  |                                                  ||11037  |                                                  
11065  |    With fgridMakePrint                           ||11038  |    With fgridMakePrint                           
11066  |        .Row = lRow + 1                           ||11039  |        .Row = lRow + 1                           
11067  |'2005/07/26 Start                                 ||11040  |'2005/07/26 Start                                 
11068  |        .Col = 2        '英文                     ||11041  |        .Col = 2        '英文                     
11069  |        gbuMGetUPDRec.N(lDimRow).MGET_company_flag||11042  |        gbuMGetUPDRec.N(lDimRow).MGET_company_flag
11070  |'2005/07/26 End                                   ||11043  |'2005/07/26 End                                   
11071  |        .Col = 3        '契約番号                 ||11044  |        .Col = 3        '契約番号                 
11072  |        gbuMGetUPDRec.N(lDimRow).MGET_contract_no ||11045  |        gbuMGetUPDRec.N(lDimRow).MGET_contract_no 
11073  |        .Col = 4        '契約名                   ||11046  |        .Col = 4        '契約名                   
11074  |        gbuMGetUPDRec.N(lDimRow).MGET_contract_nam||11047  |        gbuMGetUPDRec.N(lDimRow).MGET_contract_nam
11075  |'2005/08/04 Start                                 ||11048  |'2005/08/04 Start                                 
11076  |        .Col = 5        '契約名[英]               ||11049  |        .Col = 5        '契約名[英]               
11077  |        gbuMGetUPDRec.N(lDimRow).MGET_contract_nam||11050  |        gbuMGetUPDRec.N(lDimRow).MGET_contract_nam
11078  |'2005/08/04 End                                   ||11051  |'2005/08/04 End                                   
11079  |        .Col = 6        '契約区分                 ||11052  |        .Col = 6        '契約区分                 
11080  |        gbuMGetUPDRec.N(lDimRow).MGET_contract_fla||11053  |        gbuMGetUPDRec.N(lDimRow).MGET_contract_fla
11081  |'2008/03/12 START ファンド決算期間での外部委託顧問||11054  |'2008/03/12 START ファンド決算期間での外部委託顧問
11082  |'        .Col = 7        '締日営業日翌日          ||11055  |'        .Col = 7        '締日営業日翌日          
11083  |'        gbuMGetUPDRec.N(lDimRow).MGET_settlement_||11056  |'        gbuMGetUPDRec.N(lDimRow).MGET_settlement_
11084  |'        gbuMGetUPDRec.N(lDimRow).MGET_yokujitu = ||11057  |'        gbuMGetUPDRec.N(lDimRow).MGET_yokujitu = 
11085  |'        .Col = 8        '締日                    ||11058  |'        .Col = 8        '締日                    
11086  |'        gbuMGetUPDRec.N(lDimRow).MGET_settlement_||11059  |'        gbuMGetUPDRec.N(lDimRow).MGET_settlement_
11087  |        'ファンド計算FROM                         ||11060  |        'ファンド計算FROM                         
11088  |        .Col = conColFndCalcFrom                  ||11061  |        .Col = conColFndCalcFrom                  
11089  |        strFndCalcFrom = .Text                    ||11062  |        strFndCalcFrom = .Text                    
11090  |        'ファンド計算TO                           ||11063  |        'ファンド計算TO                           
11091  |        .Col = conColFndCalcTo                    ||11064  |        .Col = conColFndCalcTo                    
11092  |        strFndCalcTo = .Text                      ||11065  |        strFndCalcTo = .Text                      
11093  |        If Trim(strFndCalcFrom) <> "" And Trim(str||11066  |        If Trim(strFndCalcFrom) <> "" And Trim(str
11094  |            '締日営業日翌日                       ||11067  |            '締日営業日翌日                       
11095  |            gbuMGetUPDRec.N(lDimRow).MGET_settleme||11068  |            gbuMGetUPDRec.N(lDimRow).MGET_settleme
11096  |            gbuMGetUPDRec.N(lDimRow).MGET_yokujitu||11069  |            gbuMGetUPDRec.N(lDimRow).MGET_yokujitu
11097  |            '締日                                 ||11070  |            '締日                                 
11098  |            gbuMGetUPDRec.N(lDimRow).MGET_settleme||11071  |            gbuMGetUPDRec.N(lDimRow).MGET_settleme
11099  |        'ファンド決算期間計算の場合実払いテーブル ||11072  |        'ファンド決算期間計算の場合実払いテーブル 
11100  |            gbuMGetUPDRec.N(lDimRow).MGET_other_re||11073  |            gbuMGetUPDRec.N(lDimRow).MGET_other_re
11101  |        Else                                      ||11074  |        Else                                      
11102  |            .Col = 7        '締日営業日翌日       ||11075  |            .Col = 7        '締日営業日翌日       
11103  |            gbuMGetUPDRec.N(lDimRow).MGET_settleme||11076  |            gbuMGetUPDRec.N(lDimRow).MGET_settleme
11104  |            gbuMGetUPDRec.N(lDimRow).MGET_yokujitu||11077  |            gbuMGetUPDRec.N(lDimRow).MGET_yokujitu
11105  |            .Col = 8        '締日                 ||11078  |            .Col = 8        '締日                 
11106  |            gbuMGetUPDRec.N(lDimRow).MGET_settleme||11079  |            gbuMGetUPDRec.N(lDimRow).MGET_settleme
11107  |        'ファン決算期間ド計算の場合実払いテーブル ||11080  |        'ファン決算期間ド計算の場合実払いテーブル 
11108  |            gbuMGetUPDRec.N(lDimRow).MGET_other_re||11081  |            gbuMGetUPDRec.N(lDimRow).MGET_other_re
11109  |        End If                                    ||11082  |        End If                                    
11110  |'2008/03/12 START ファンド決算期間での外部委託顧問||11083  |'2008/03/12 START ファンド決算期間での外部委託顧問
11111  |        .Col = 9        '口座コード               ||11084  |        .Col = 9        '口座コード               
11112  |        gbuMGetUPDRec.N(lDimRow).MGET_account_code||11085  |        gbuMGetUPDRec.N(lDimRow).MGET_account_code
11113  |        .Col = 10        '口座名                  ||11086  |        .Col = 10        '口座名                  
11114  |        gbuMGetUPDRec.N(lDimRow).MGET_account_name||11087  |        gbuMGetUPDRec.N(lDimRow).MGET_account_name
11115  |        .Col = 11       '通貨コード               ||11088  |        .Col = 11       '通貨コード               
11116  |        gbuMGetUPDRec.N(lDimRow).MGET_base_currenc||11089  |        gbuMGetUPDRec.N(lDimRow).MGET_base_currenc
11117  |        .Col = 12       '適用開始日               ||11090  |        .Col = 12       '適用開始日               
11118  |        gbuMGetUPDRec.N(lDimRow).MGET_com_calc_sta||11091  |        gbuMGetUPDRec.N(lDimRow).MGET_com_calc_sta
11119  |        .Col = 13       '適用終了日               ||11092  |        .Col = 13       '適用終了日               
11120  |        gbuMGetUPDRec.N(lDimRow).MGET_com_calc_end||11093  |        gbuMGetUPDRec.N(lDimRow).MGET_com_calc_end
11121  |        .Col = 14       '運用会社コード           ||11094  |        .Col = 14       '運用会社コード           
11122  |        gbuMGetUPDRec.N(lDimRow).MGET_company_code||11095  |        gbuMGetUPDRec.N(lDimRow).MGET_company_code
11123  |        .Col = 15       '運用会社名               ||11096  |        .Col = 15       '運用会社名               
11124  |        gbuMGetUPDRec.N(lDimRow).MGET_company_name||11097  |        gbuMGetUPDRec.N(lDimRow).MGET_company_name
11125  |'2005/08/04 Start                                 ||11098  |'2005/08/04 Start                                 
11126  |        .Col = 16       '運用会社名[英]           ||11099  |        .Col = 16       '運用会社名[英]           
11127  |        gbuMGetUPDRec.N(lDimRow).MGET_company_name||11100  |        gbuMGetUPDRec.N(lDimRow).MGET_company_name
11128  |'2005/08/04 End                                   ||11101  |'2005/08/04 End                                   
11129  |        .Col = 17       'ルールNo                 ||11102  |        .Col = 17       'ルールNo                 
11130  |        gbuMGetUPDRec.N(lDimRow).MGET_OTHER_COM_RU||11103  |        gbuMGetUPDRec.N(lDimRow).MGET_OTHER_COM_RU
11131  |        .Col = 18       '料率区分                 ||11104  |        .Col = 18       '料率区分                 
11132  |        gbuMGetUPDRec.N(lDimRow).MGET_other_rate_r||11105  |        gbuMGetUPDRec.N(lDimRow).MGET_other_rate_r
11133  |'2004/12/29 Start                                 ||11106  |'2004/12/29 Start                                 
11134  |        .Col = 19       'NAV取得区分              ||11107  |        .Col = 19       'NAV取得区分              
11135  |        gbuMGetUPDRec.N(lDimRow).MGET_nav_get_flag||11108  |        gbuMGetUPDRec.N(lDimRow).MGET_nav_get_flag
11136  |        .Col = 20       '上限金額                 ||11109  |        .Col = 20       '上限金額                 
11137  |        gbuMGetUPDRec.N(lDimRow).MGET_cap = .Text ||11110  |        gbuMGetUPDRec.N(lDimRow).MGET_cap = .Text 
11138  |        .Col = 21       '下限金額                 ||11111  |        .Col = 21       '下限金額                 
11139  |        gbuMGetUPDRec.N(lDimRow).MGET_floor = .Tex||11112  |        gbuMGetUPDRec.N(lDimRow).MGET_floor = .Tex
11140  |'2004/12/29 End                                   ||11113  |'2004/12/29 End                                   
11141  |'2004/09/02 Start                                 ||11114  |'2004/09/02 Start                                 
11142  |        .Col = conColPayMentDate    '支払予定日   ||11115  |        .Col = conColPayMentDate    '支払予定日   
11143  |        gbuMGetUPDRec.N(lDimRow).MGET_payment_date||11116  |        gbuMGetUPDRec.N(lDimRow).MGET_payment_date
11144  |'2004/09/02 End                                   ||11117  |'2004/09/02 End                                   
11145  |'2005/01/11 Start                                 ||11118  |'2005/01/11 Start                                 
11146  |        .Col = 23       'NAV通貨                  ||11119  |        .Col = 23       'NAV通貨                  
11147  |        gbuMGetUPDRec.N(lDimRow).MGET_base_currenc||11120  |        gbuMGetUPDRec.N(lDimRow).MGET_base_currenc
11148  |        .Col = 24       '閾値通貨                 ||11121  |        .Col = 24       '閾値通貨                 
11149  |        gbuMGetUPDRec.N(lDimRow).MGET_amount_curre||11122  |        gbuMGetUPDRec.N(lDimRow).MGET_amount_curre
11150  |        .Col = 25       '顧問料通貨               ||11123  |        .Col = 25       '顧問料通貨               
11151  |        gbuMGetUPDRec.N(lDimRow).MGET_other_com_cu||11124  |        gbuMGetUPDRec.N(lDimRow).MGET_other_com_cu
11152  |'2005/01/17 Start                                 ||11125  |'2005/01/17 Start                                 
11153  |'        .Col = 23                                ||11126  |'        .Col = 23                                
11154  |'        gbuMGetUPDRec.N(lDimRow).MGET_NavAmount =||11127  |'        gbuMGetUPDRec.N(lDimRow).MGET_NavAmount =
11155  |'        .Col = 24                                ||11128  |'        .Col = 24                                
11156  |'        gbuMGetUPDRec.N(lDimRow).MGET_NavCom = .T||11129  |'        gbuMGetUPDRec.N(lDimRow).MGET_NavCom = .T
11157  |'        .Col = 25                                ||11130  |'        .Col = 25                                
11158  |'        gbuMGetUPDRec.N(lDimRow).MGET_AmountCom =||11131  |'        gbuMGetUPDRec.N(lDimRow).MGET_AmountCom =
11159  |'        .Col = 26                                ||11132  |'        .Col = 26                                
11160  |'        gbuMGetUPDRec.N(lDimRow).MGET_ComPay = .T||11133  |'        gbuMGetUPDRec.N(lDimRow).MGET_ComPay = .T
11161  |'        .Col = 27                                ||11134  |'        .Col = 27                                
11162  |'        gbuMGetUPDRec.N(lDimRow).MGET_days_in_a_y||11135  |'        gbuMGetUPDRec.N(lDimRow).MGET_days_in_a_y
11163  |''2005/01/11 End                                  ||11136  |''2005/01/11 End                                  
11164  |        .Col = 26       '一年間の日数             ||11137  |        .Col = 26       '一年間の日数             
11165  |        gbuMGetUPDRec.N(lDimRow).MGET_days_in_a_ye||11138  |        gbuMGetUPDRec.N(lDimRow).MGET_days_in_a_ye
11166  |'2005/01/17 End                                   ||11139  |'2005/01/17 End                                   
11167  |        .Col = 27 '       消費税計算有無          ||11140  |        .Col = 27 '       消費税計算有無          
11168  |        gbuMGetUPDRec.N(lDimRow).MGET_tax_calc_fla||11141  |        gbuMGetUPDRec.N(lDimRow).MGET_tax_calc_fla
11169  |    End With                                      ||11142  |    End With                                      
11170  |'2005/07/26 End                                   ||11143  |'2005/07/26 End                                   
11171  |                                                  ||11144  |                                                  
11172  |End Sub                                           ||11145  |End Sub                                           
11173  |                                                  ||11146  |                                                  
11174  |'=================================================||11147  |'=================================================
11175  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblnUrudoshiCheck           ||11148  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblnUrudoshiCheck           
11176  |'機能            :   閏年判定関数                 ||11149  |'機能            :   閏年判定関数                 
11177  |'概要            :   指定したYYYY年2月29日が存在す||11150  |'概要            :   指定したYYYY年2月29日が存在す
11178  |'                    指定したYYYY年2月29日が存在し||11151  |'                    指定したYYYY年2月29日が存在し
11179  |'                                                 ||11152  |'                                                 
11180  |'日付               担当　              修正内容  ||11153  |'日付               担当　              修正内容  
11181  |'-------------------------------------------------||11154  |'-------------------------------------------------
11182  |'2004/08/13         M.Katoh<SRA>       新規作成   ||11155  |'2004/08/13         M.Katoh<SRA>       新規作成   
11183  |'=================================================||11156  |'=================================================
11184  |Private Function fnblnUrudoshiCheck( _            ||11157  |Private Function fnblnUrudoshiCheck( _            
11185  |    ByVal sYear As String _                       ||11158  |    ByVal sYear As String _                       
11186  |) As Boolean                                      ||11159  |) As Boolean                                      
11187  |                                                  ||11160  |                                                  
11188  |    '戻り値初期化                                 ||11161  |    '戻り値初期化                                 
11189  |    fnblnUrudoshiCheck = False                    ||11162  |    fnblnUrudoshiCheck = False                    
11190  |                                                  ||11163  |                                                  
11191  |    '指定年の２月２９日があればうるう年           ||11164  |    '指定年の２月２９日があればうるう年           
11192  |    If IsDate(sYear & "/2/29") Then               ||11165  |    If IsDate(sYear & "/2/29") Then               
11193  |        '日付型データーと判断される（２月２９日が ||11166  |        '日付型データーと判断される（２月２９日が 
11194  |        fnblnUrudoshiCheck = True                 ||11167  |        fnblnUrudoshiCheck = True                 
11195  |'    Else                                         ||11168  |'    Else                                         
11196  |        '日付型データーで無いと判断される（２月２ ||11169  |        '日付型データーで無いと判断される（２月２ 
11197  |'        fnblnUrudoshiCheck = False               ||11170  |'        fnblnUrudoshiCheck = False               
11198  |    End If                                        ||11171  |    End If                                        
11199  |                                                  ||11172  |                                                  
11200  |End Function                                      ||11173  |End Function                                      
11201  |                                                  ||11174  |                                                  
11202  |'=================================================||11175  |'=================================================
11203  |'処理内容     四捨五入：sbGetRoundValue           ||11176  |'処理内容     四捨五入：sbGetRoundValue           
11204  |'備考         小数点第一位で四捨五入する          ||11177  |'備考         小数点第一位で四捨五入する          
11205  |'                                                 ||11178  |'                                                 
11206  |'引数         dblValueIn:四捨五入対象値           ||11179  |'引数         dblValueIn:四捨五入対象値           
11207  |'                                                 ||11180  |'                                                 
11208  |'日付         担当               内容             ||11181  |'日付         担当               内容             
11209  |'------------ ----------------- ------------------||11182  |'------------ ----------------- ------------------
11210  |'2004/11/17   M.Yamazaki<SRA>   新規作成          ||11183  |'2004/11/17   M.Yamazaki<SRA>   新規作成          
11211  |'=================================================||11184  |'=================================================
11212  |Private Function sbGetRoundValue( _               ||11185  |Private Function sbGetRoundValue( _               
11213  |    ByVal dblValueIn As Double _                  ||11186  |    ByVal dblValueIn As Double _                  
11214  |) As Double                                       ||11187  |) As Double                                       
11215  |                                                  ||11188  |                                                  
11216  |    Dim dblNum As Double                          ||11189  |    Dim dblNum As Double                          
11217  |    Dim iPos   As Integer                         ||11190  |    Dim iPos   As Integer                         
11218  |                                                  ||11191  |                                                  
11219  |    dblValueOut = 0                               ||11192  |    dblValueOut = 0                               
11220  |                                                  ||11193  |                                                  
11221  |    iPos = InStr(dblValueIn, ".")                 ||11194  |    iPos = InStr(dblValueIn, ".")                 
11222  |                                                  ||11195  |                                                  
11223  |    If iPos <> 0 Then                             ||11196  |    If iPos <> 0 Then                             
11224  |        If CInt(Mid(CStr(dblValueIn), iPos + 1, 1)||11197  |        If CInt(Mid(CStr(dblValueIn), iPos + 1, 1)
11225  |           dblNum = CDbl(Mid(CStr(dblValueIn), 1, ||11198  |           dblNum = CDbl(Mid(CStr(dblValueIn), 1, 
11226  |           dblNum = dblNum + 1                    ||11199  |           dblNum = dblNum + 1                    
11227  |        Else                                      ||11200  |        Else                                      
11228  |           dblNum = CDbl(Mid(CStr(dblValueIn), 1, ||11201  |           dblNum = CDbl(Mid(CStr(dblValueIn), 1, 
11229  |        End If                                    ||11202  |        End If                                    
11230  |    Else                                          ||11203  |    Else                                          
11231  |        dblNum = dblValueIn                       ||11204  |        dblNum = dblValueIn                       
11232  |    End If                                        ||11205  |    End If                                        
11233  |                                                  ||11206  |                                                  
11234  |    dblValueOut = dblNum                          ||11207  |    dblValueOut = dblNum                          
11235  |                                                  ||11208  |                                                  
11236  |End Function                                      ||11209  |End Function                                      
11237  |                                                  ||11210  |                                                  
11238  |'=================================================||11211  |'=================================================
11239  |'処理内容     四捨五入：sbGetRoundValue2          ||11212  |'処理内容     四捨五入：sbGetRoundValue2          
11240  |'備考         小数点第四位で四捨五入する          ||11213  |'備考         小数点第四位で四捨五入する          
11241  |'                                                 ||11214  |'                                                 
11242  |'引数         dblValueIn:四捨五入対象値           ||11215  |'引数         dblValueIn:四捨五入対象値           
11243  |'                                                 ||11216  |'                                                 
11244  |'日付         担当               内容             ||11217  |'日付         担当               内容             
11245  |'------------ ----------------- ------------------||11218  |'------------ ----------------- ------------------
11246  |'2005/01/13   M.Yamazaki<SRA>   新規作成          ||11219  |'2005/01/13   M.Yamazaki<SRA>   新規作成          
11247  |'=================================================||11220  |'=================================================
11248  |Private Function sbGetRoundValue2( _              ||11221  |Private Function sbGetRoundValue2( _              
11249  |    ByVal dblValueIn As Double _                  ||11222  |    ByVal dblValueIn As Double _                  
11250  |) As Double                                       ||11223  |) As Double                                       
11251  |                                                  ||11224  |                                                  
11252  |    Dim dblNum As Double                          ||11225  |    Dim dblNum As Double                          
11253  |    Dim iPos   As Integer                         ||11226  |    Dim iPos   As Integer                         
11254  |    Dim iLen   As Integer                         ||11227  |    Dim iLen   As Integer                         
11255  |                                                  ||11228  |                                                  
11256  |    dblValueOut = 0                               ||11229  |    dblValueOut = 0                               
11257  |                                                  ||11230  |                                                  
11258  |    iPos = InStr(dblValueIn, ".")                 ||11231  |    iPos = InStr(dblValueIn, ".")                 
11259  |    iLen = Len(CStr(dblValueIn))                  ||11232  |    iLen = Len(CStr(dblValueIn))                  
11260  |                                                  ||11233  |                                                  
11261  |    If iPos <> 0 Then                             ||11234  |    If iPos <> 0 Then                             
11262  |        If iLen - iPos > 3 Then                   ||11235  |        If iLen - iPos > 3 Then                   
11263  |            If CInt(Mid(CStr(dblValueIn), iPos + 4||11236  |            If CInt(Mid(CStr(dblValueIn), iPos + 4
11264  |               dblNum = CDbl(Mid(CStr(dblValueIn),||11237  |               dblNum = CDbl(Mid(CStr(dblValueIn),
11265  |               dblNum = dblNum + 0.001            ||11238  |               dblNum = dblNum + 0.001            
11266  |            Else                                  ||11239  |            Else                                  
11267  |               dblNum = CDbl(Mid(CStr(dblValueIn),||11240  |               dblNum = CDbl(Mid(CStr(dblValueIn),
11268  |            End If                                ||11241  |            End If                                
11269  |        Else                                      ||11242  |        Else                                      
11270  |            dblNum = dblValueIn                   ||11243  |            dblNum = dblValueIn                   
11271  |        End If                                    ||11244  |        End If                                    
11272  |    Else                                          ||11245  |    Else                                          
11273  |        dblNum = dblValueIn                       ||11246  |        dblNum = dblValueIn                       
11274  |    End If                                        ||11247  |    End If                                        
11275  |                                                  ||11248  |                                                  
11276  |    dblValueOut = dblNum                          ||11249  |    dblValueOut = dblNum                          
11277  |                                                  ||11250  |                                                  
11278  |End Function                                      ||11251  |End Function                                      
11279  |                                                  ||11252  |                                                  
11280  |'=================================================||11253  |'=================================================
11281  |'処理内容     四捨五入：sbGetRoundValueTax        ||11254  |'処理内容     四捨五入：sbGetRoundValueTax        
11282  |'備考         小数点第一位以降を切り捨てる        ||11255  |'備考         小数点第一位以降を切り捨てる        
11283  |'                                                 ||11256  |'                                                 
11284  |'引数         dblValueIn:切捨て対象値             ||11257  |'引数         dblValueIn:切捨て対象値             
11285  |'                                                 ||11258  |'                                                 
11286  |'日付         担当               内容             ||11259  |'日付         担当               内容             
11287  |'------------ ----------------- ------------------||11260  |'------------ ----------------- ------------------
11288  |'2004/11/17   M.Yamazaki<SRA>   新規作成          ||11261  |'2004/11/17   M.Yamazaki<SRA>   新規作成          
11289  |'=================================================||11262  |'=================================================
11290  |Private Function sbGetRoundValueTax( _            ||11263  |Private Function sbGetRoundValueTax( _            
11291  |    ByVal dblValueIn As Double _                  ||11264  |    ByVal dblValueIn As Double _                  
11292  |) As Double                                       ||11265  |) As Double                                       
11293  |                                                  ||11266  |                                                  
11294  |    Dim dblNum As Double                          ||11267  |    Dim dblNum As Double                          
11295  |    Dim iPos   As Integer                         ||11268  |    Dim iPos   As Integer                         
11296  |                                                  ||11269  |                                                  
11297  |    dblValueOut = 0                               ||11270  |    dblValueOut = 0                               
11298  |                                                  ||11271  |                                                  
11299  |    iPos = InStr(dblValueIn, ".")                 ||11272  |    iPos = InStr(dblValueIn, ".")                 
11300  |                                                  ||11273  |                                                  
11301  |    If iPos <> 0 Then                             ||11274  |    If iPos <> 0 Then                             
11302  |        dblNum = CDbl(Mid(CStr(dblValueIn), 1, iPo||11275  |        dblNum = CDbl(Mid(CStr(dblValueIn), 1, iPo
11303  |    Else                                          ||11276  |    Else                                          
11304  |        dblNum = dblValueIn                       ||11277  |        dblNum = dblValueIn                       
11305  |    End If                                        ||11278  |    End If                                        
11306  |                                                  ||11279  |                                                  
11307  |    dblValueOut = dblNum                          ||11280  |    dblValueOut = dblNum                          
11308  |                                                  ||11281  |                                                  
11309  |End Function                                      ||11282  |End Function                                      
11310  |                                                  ||11283  |                                                  
11311  |'=================================================||11284  |'=================================================
11312  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnRateChk                    ||11285  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnRateChk                    
11313  |'機能            :   レート入力チェック           ||11286  |'機能            :   レート入力チェック           
11314  |'                                                 ||11287  |'                                                 
11315  |'日付               担当　              修正内容  ||11288  |'日付               担当　              修正内容  
11316  |'-------------------------------------------------||11289  |'-------------------------------------------------
11317  |'2005/01/11         M.Yamazaki<SRA>     新規作成  ||11290  |'2005/01/11         M.Yamazaki<SRA>     新規作成  
11318  |'=================================================||11291  |'=================================================
11319  |Private Function fnRateChk(Rate As String) As Bool||11292  |Private Function fnRateChk(Rate As String) As Bool
11320  |    Dim dBuf         As Double                    ||11293  |    Dim dBuf         As Double                    
11321  |    Dim bErrFlg      As Boolean                   ||11294  |    Dim bErrFlg      As Boolean                   
11322  |    Dim iPos         As Integer                   ||11295  |    Dim iPos         As Integer                   
11323  |    Dim iLen         As Integer                   ||11296  |    Dim iLen         As Integer                   
11324  |    Dim sBuf         As String                    ||11297  |    Dim sBuf         As String                    
11325  |                                                  ||11298  |                                                  
11326  |    '入力数値チェック                             ||11299  |    '入力数値チェック                             
11327  |    'フラグ初期化                                 ||11300  |    'フラグ初期化                                 
11328  |    fnRateChk = False                             ||11301  |    fnRateChk = False                             
11329  |    '                                             ||11302  |    '                                             
11330  |    If IsNumeric(Rate) = False Then               ||11303  |    If IsNumeric(Rate) = False Then               
11331  |        fnRateChk = True                          ||11304  |        fnRateChk = True                          
11332  |        Exit Function                             ||11305  |        Exit Function                             
11333  |    End If                                        ||11306  |    End If                                        
11334  |    'データ抽出                                   ||11307  |    'データ抽出                                   
11335  |    dBuf = CDbl(gDelChar(Rate, ","))              ||11308  |    dBuf = CDbl(gDelChar(Rate, ","))              
11336  |    sBuf = gDelChar(Rate, ",")                    ||11309  |    sBuf = gDelChar(Rate, ",")                    
11337  |    iPos = InStr(sBuf, ".")                       ||11310  |    iPos = InStr(sBuf, ".")                       
11338  |    iLen = Len(sBuf)                              ||11311  |    iLen = Len(sBuf)                              
11339  |'''''    '１１桁以上はエラー                      ||11312  |'''''    '１１桁以上はエラー                      
11340  |'''''    If iPos > 12 _                           ||11313  |'''''    If iPos > 12 _                           
11341  |'''''    Or (iPos = 0 _                           ||11314  |'''''    Or (iPos = 0 _                           
11342  |'''''    And iLen >= 12) Then                     ||11315  |'''''    And iLen >= 12) Then                     
11343  |'''''        fnRateChk = True                     ||11316  |'''''        fnRateChk = True                     
11344  |'''''    End If                                   ||11317  |'''''    End If                                   
11345  |'''''    '小数１０桁以上はエラー                  ||11318  |'''''    '小数１０桁以上はエラー                  
11346  |'''''    If iLen - iPos > 10 _                    ||11319  |'''''    If iLen - iPos > 10 _                    
11347  |'''''    And iPos > 0 Then                        ||11320  |'''''    And iPos > 0 Then                        
11348  |'''''        fnRateChk = True                     ||11321  |'''''        fnRateChk = True                     
11349  |'''''    End If                                   ||11322  |'''''    End If                                   
11350  |    '４桁以上はエラー                             ||11323  |    '４桁以上はエラー                             
11351  |    If iPos > 4 _                                 ||11324  |    If iPos > 4 _                                 
11352  |    Or (iPos = 0 _                                ||11325  |    Or (iPos = 0 _                                
11353  |    And iLen >= 4) Then                           ||11326  |    And iLen >= 4) Then                           
11354  |        fnRateChk = True                          ||11327  |        fnRateChk = True                          
11355  |    End If                                        ||11328  |    End If                                        
11356  |    '小数４桁以上はエラー                         ||11329  |    '小数４桁以上はエラー                         
11357  |    If iLen - iPos > 3 _                          ||11330  |    If iLen - iPos > 3 _                          
11358  |    And iPos > 0 Then                             ||11331  |    And iPos > 0 Then                             
11359  |        fnRateChk = True                          ||11332  |        fnRateChk = True                          
11360  |    End If                                        ||11333  |    End If                                        
11361  |                                                  ||11334  |                                                  
11362  |End Function                                      ||11335  |End Function                                      
11363  |                                                  ||11336  |                                                  
11364  |'=================================================||11337  |'=================================================
11365  |'処理内容     為替レート取得：fnstrExchangeRate   ||11338  |'処理内容     為替レート取得：fnstrExchangeRate   
11366  |'備考         TTMの直近為替レートを取得する       ||11339  |'備考         TTMの直近為替レートを取得する       
11367  |'                                                 ||11340  |'                                                 
11368  |'日付         担当               内容             ||11341  |'日付         担当               内容             
11369  |'------------ ----------------- ------------------||11342  |'------------ ----------------- ------------------
11370  |'2005/01/17   M.Yamazaki <SRA>     新規作成       ||11343  |'2005/01/17   M.Yamazaki <SRA>     新規作成       
11371  |'=================================================||11344  |'=================================================
11372  |Private Function fnstrExchangeRate( _             ||11345  |Private Function fnstrExchangeRate( _             
11373  |    dstrDate As String, _                         ||11346  |    dstrDate As String, _                         
11374  |    dstrCurrencyCode As String _                  ||11347  |    dstrCurrencyCode As String _                  
11375  |) As Double                                       ||11348  |) As Double                                       
11376  |                                                  ||11349  |                                                  
11377  |On Error GoTo OnErrorProc                         ||11350  |On Error GoTo OnErrorProc                         
11378  |                                                  ||11351  |                                                  
11379  |    Dim sSql        As String                     ||11352  |    Dim sSql        As String                     
11380  |    Dim strErrCall  As String        'エラー呼出元||11353  |    Dim strErrCall  As String        'エラー呼出元
11381  |                                                  ||11354  |                                                  
11382  |    sSql = ""                                     ||11355  |    sSql = ""                                     
11383  |    sSql = sSql & "SELECT  "                      ||11356  |    sSql = sSql & "SELECT  "                      
11384  |    sSql = sSql & "TBL_TTM1.currency_code TBL_TTM1||11357  |    sSql = sSql & "TBL_TTM1.currency_code TBL_TTM1
11385  |    sSql = sSql & "TBL_TTM1.base_date TBL_TTM1_bas||11358  |    sSql = sSql & "TBL_TTM1.base_date TBL_TTM1_bas
11386  |    sSql = sSql & "TBL_TTM1.base_currency_code TBL||11359  |    sSql = sSql & "TBL_TTM1.base_currency_code TBL
11387  |    sSql = sSql & "TBL_TTM1.exchange_rate TBL_TTM1||11360  |    sSql = sSql & "TBL_TTM1.exchange_rate TBL_TTM1
11388  |    sSql = sSql & "FROM (SELECT "                 ||11361  |    sSql = sSql & "FROM (SELECT "                 
11389  |    sSql = sSql & "WK_TTM.currency_code, "        ||11362  |    sSql = sSql & "WK_TTM.currency_code, "        
11390  |    sSql = sSql & "TO_CHAR(TO_DATE(WK_TTM.base_dat||11363  |    sSql = sSql & "TO_CHAR(TO_DATE(WK_TTM.base_dat
11391  |    sSql = sSql & "NVL(WK_TTM.base_currency_code,'||11364  |    sSql = sSql & "NVL(WK_TTM.base_currency_code,'
11392  |    sSql = sSql & "TO_CHAR(WK_TTM.exchange_rate,'f||11365  |    sSql = sSql & "TO_CHAR(WK_TTM.exchange_rate,'f
11393  |    sSql = sSql & "FROM cfr_ttm_tbl WK_TTM "      ||11366  |    sSql = sSql & "FROM cfr_ttm_tbl WK_TTM "      
11394  |    sSql = sSql & "WHERE "                        ||11367  |    sSql = sSql & "WHERE "                        
11395  |    sSql = sSql & "(WK_TTM.base_date,WK_TTM.base_c||11368  |    sSql = sSql & "(WK_TTM.base_date,WK_TTM.base_c
11396  |    sSql = sSql & "FROM cfr_ttm_tbl TTM1 "        ||11369  |    sSql = sSql & "FROM cfr_ttm_tbl TTM1 "        
11397  |    sSql = sSql & "WHERE TTM1.base_currency_code =||11370  |    sSql = sSql & "WHERE TTM1.base_currency_code =
11398  |    sSql = sSql & "AND TTM1.base_date <= '"       ||11371  |    sSql = sSql & "AND TTM1.base_date <= '"       
11399  |    sSql = sSql & dstrDate                        ||11372  |    sSql = sSql & dstrDate                        
11400  |    sSql = sSql & "' "                            ||11373  |    sSql = sSql & "' "                            
11401  |    sSql = sSql & "GROUP BY TTM1.base_currency_cod||11374  |    sSql = sSql & "GROUP BY TTM1.base_currency_cod
11402  |    sSql = sSql & "AND WK_TTM.currency_code = '"  ||11375  |    sSql = sSql & "AND WK_TTM.currency_code = '"  
11403  |    sSql = sSql & dstrCurrencyCode                ||11376  |    sSql = sSql & dstrCurrencyCode                
11404  |    sSql = sSql & "') TBL_TTM1"                   ||11377  |    sSql = sSql & "') TBL_TTM1"                   
11405  |    'ﾀﾞｲﾅｾｯﾄの作成                                ||11378  |    'ﾀﾞｲﾅｾｯﾄの作成                                
11406  |    If gintDyCreate(sSql) = False Then            ||11379  |    If gintDyCreate(sSql) = False Then            
11407  |        Exit Function                             ||11380  |        Exit Function                             
11408  |    Else                                          ||11381  |    Else                                          
11409  |        fnstrExchangeRate = gvlnDyDataN("TBL_TTM1_||11382  |        fnstrExchangeRate = gvlnDyDataN("TBL_TTM1_
11410  |    End If                                        ||11383  |    End If                                        
11411  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             ||11384  |    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             
11412  |    Call gblnDyClose                              ||11385  |    Call gblnDyClose                              
11413  |                                                  ||11386  |                                                  
11414  |    Exit Function                                 ||11387  |    Exit Function                                 
11415  |                                                  ||11388  |                                                  
11416  |OnErrorProc:                                      ||11389  |OnErrorProc:                                      
11417  |    Call subError("システムエラー", Str(Err.Number||11390  |    Call subError("システムエラー", Str(Err.Number
11418  |        Error, strErrCall, conTitle)              ||11391  |        Error, strErrCall, conTitle)              
11419  |    Exit Function                                 ||11392  |    Exit Function                                 
11420  |                                                  ||11393  |                                                  
11421  |EndProc:                                          ||11394  |EndProc:                                          
11422  |    Exit Function                                 ||11395  |    Exit Function                                 
11423  |                                                  ||11396  |                                                  
11424  |End Function                                      ||11397  |End Function                                      
11425  |                                                  ||11398  |                                                  
11426  |'=================================================||11399  |'=================================================
11427  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMgetSettlementDataIni      ||11400  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMgetSettlementDataIni      
11428  |'機能            :   対象外部委託顧問料締日取得テ ||11401  |'機能            :   対象外部委託顧問料締日取得テ 
11429  |'                                                 ||11402  |'                                                 
11430  |'日付               担当                修正内容  ||11403  |'日付               担当                修正内容  
11431  |'-------------------------------------------------||11404  |'-------------------------------------------------
11432  |'2005/04/21         M.Yamazaki<SRA>     新規作成  ||11405  |'2005/04/21         M.Yamazaki<SRA>     新規作成  
11433  |'=================================================||11406  |'=================================================
11434  |Private Sub sbMgetSettlementDataIni()             ||11407  |Private Sub sbMgetSettlementDataIni()             
11435  |                                                  ||11408  |                                                  
11436  |    Dim i As Integer                              ||11409  |    Dim i As Integer                              
11437  |                                                  ||11410  |                                                  
11438  |    For i = 0 To 999                              ||11411  |    For i = 0 To 999                              
11439  |        With gbuMGetSettlementUPDRec.N(i)         ||11412  |        With gbuMGetSettlementUPDRec.N(i)         
11440  |            .MGET_contract_no = ""                ||11413  |            .MGET_contract_no = ""                
11441  |            .MGET_settlement_date = ""            ||11414  |            .MGET_settlement_date = ""            
11442  |            .MGET_use_date_start = ""             ||11415  |            .MGET_use_date_start = ""             
11443  |            .MGET_use_date_end = ""               ||11416  |            .MGET_use_date_end = ""               
11444  |            .MGET_yyyy_settlement_date = ""       ||11417  |            .MGET_yyyy_settlement_date = ""       
11445  |            .MGET_flag = ""                       ||11418  |            .MGET_flag = ""                       
11446  |        End With                                  ||11419  |        End With                                  
11447  |        With gbuMGetSettlementUPDRec.O(i)         ||11420  |        With gbuMGetSettlementUPDRec.O(i)         
11448  |            .MGET_contract_no = ""                ||11421  |            .MGET_contract_no = ""                
11449  |            .MGET_settlement_date = ""            ||11422  |            .MGET_settlement_date = ""            
11450  |            .MGET_use_date_start = ""             ||11423  |            .MGET_use_date_start = ""             
11451  |            .MGET_use_date_end = ""               ||11424  |            .MGET_use_date_end = ""               
11452  |            .MGET_yyyy_settlement_date = ""       ||11425  |            .MGET_yyyy_settlement_date = ""       
11453  |            .MGET_flag = ""                       ||11426  |            .MGET_flag = ""                       
11454  |        End With                                  ||11427  |        End With                                  
11455  |    Next i                                        ||11428  |    Next i                                        
11456  |                                                  ||11429  |                                                  
11457  |End Sub                                           ||11430  |End Sub                                           
11458  |                                                  ||11431  |                                                  
11459  |'=================================================||11432  |'=================================================
11460  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMGetSettlementDataGet      ||11433  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMGetSettlementDataGet      
11461  |'機能            :   対象外部委託顧問料締日取得テ ||11434  |'機能            :   対象外部委託顧問料締日取得テ 
11462  |'                                                 ||11435  |'                                                 
11463  |'日付               担当                修正内容  ||11436  |'日付               担当                修正内容  
11464  |'-------------------------------------------------||11437  |'-------------------------------------------------
11465  |'2005/04/21         M.Yamazaki<SRA>     新規作成  ||11438  |'2005/04/21         M.Yamazaki<SRA>     新規作成  
11466  |'=================================================||11439  |'=================================================
11467  |Private Sub sbMGetSettlementDataGet( _            ||11440  |Private Sub sbMGetSettlementDataGet( _            
11468  |    ByVal lRecIdx As Long _                       ||11441  |    ByVal lRecIdx As Long _                       
11469  |)                                                 ||11442  |)                                                 
11470  |                                                  ||11443  |                                                  
11471  |    Dim dstr_Settlement_date As String            ||11444  |    Dim dstr_Settlement_date As String            
11472  |                                                  ||11445  |                                                  
11473  |    With gbuMGetSettlementUPDRec.N(lRecIdx)       ||11446  |    With gbuMGetSettlementUPDRec.N(lRecIdx)       
11474  |        If lRecIdx <> 0 Then                      ||11447  |        If lRecIdx <> 0 Then                      
11475  |            If Mid(gbuMGetSettlementUPDRec.N(lRecI||11448  |            If Mid(gbuMGetSettlementUPDRec.N(lRecI
11476  |'2005/04/26 Start                                 ||11449  |'2005/04/26 Start                                 
11477  |'                gbuMGetSettlementUPDRec.N(lRecIdx||11450  |'                gbuMGetSettlementUPDRec.N(lRecIdx
11478  |'                gbuMGetSettlementUPDRec.N(lRecIdx||11451  |'                gbuMGetSettlementUPDRec.N(lRecIdx
11479  |'                Exit Sub                         ||11452  |'                Exit Sub                         
11480  |                If gbuMGetSettlementUPDRec.N(lRecI||11453  |                If gbuMGetSettlementUPDRec.N(lRecI
11481  |                And gbuMGetSettlementUPDRec.N(lRec||11454  |                And gbuMGetSettlementUPDRec.N(lRec
11482  |                Else                              ||11455  |                Else                              
11483  |                    gbuMGetSettlementUPDRec.N(lRec||11456  |                    gbuMGetSettlementUPDRec.N(lRec
11484  |                    gbuMGetSettlementUPDRec.N(lRec||11457  |                    gbuMGetSettlementUPDRec.N(lRec
11485  |                    Exit Sub                      ||11458  |                    Exit Sub                      
11486  |                End If                            ||11459  |                End If                            
11487  |'2005/04/26 End                                   ||11460  |'2005/04/26 End                                   
11488  |            End If                                ||11461  |            End If                                
11489  |        End If                                    ||11462  |        End If                                    
11490  |        .MGET_contract_no = gvlnDyDataS("contract_||11463  |        .MGET_contract_no = gvlnDyDataS("contract_
11491  |        .MGET_settlement_date = gvlnDyDataS("Settl||11464  |        .MGET_settlement_date = gvlnDyDataS("Settl
11492  |        .MGET_use_date_start = gvlnDyDataS("Use_Da||11465  |        .MGET_use_date_start = gvlnDyDataS("Use_Da
11493  |        .MGET_use_date_end = gvlnDyDataS("Use_Date||11466  |        .MGET_use_date_end = gvlnDyDataS("Use_Date
11494  |        '締日が閏年かどうか判定                   ||11467  |        '締日が閏年かどうか判定                   
11495  |        dstr_Settlement_date = gvlnDyDataS("yyyy_s||11468  |        dstr_Settlement_date = gvlnDyDataS("yyyy_s
11496  |        If Mid(dstr_Settlement_date, 5, 4) = conUr||11469  |        If Mid(dstr_Settlement_date, 5, 4) = conUr
11497  |            '閏年チェック                         ||11470  |            '閏年チェック                         
11498  |            If fnblnUrudoshiCheck(Mid(dstr_Settlem||11471  |            If fnblnUrudoshiCheck(Mid(dstr_Settlem
11499  |                dstr_Settlement_date = Mid(dstr_Se||11472  |                dstr_Settlement_date = Mid(dstr_Se
11500  |            End If                                ||11473  |            End If                                
11501  |        Else                                      ||11474  |        Else                                      
11502  |            dstr_Settlement_date = gvlnDyDataS("yy||11475  |            dstr_Settlement_date = gvlnDyDataS("yy
11503  |        End If                                    ||11476  |        End If                                    
11504  |        .MGET_yyyy_settlement_date = dstr_Settleme||11477  |        .MGET_yyyy_settlement_date = dstr_Settleme
11505  |    End With                                      ||11478  |    End With                                      
11506  |                                                  ||11479  |                                                  
11507  |End Sub                                           ||11480  |End Sub                                           
11508  |                                                  ||11481  |                                                  
11509  |'=================================================||11482  |'=================================================
11510  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMGetSettlementDataGet2     ||11483  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMGetSettlementDataGet2     
11511  |'機能            :   対象外部委託顧問料締日取得テ ||11484  |'機能            :   対象外部委託顧問料締日取得テ 
11512  |'                                                 ||11485  |'                                                 
11513  |'日付               担当                修正内容  ||11486  |'日付               担当                修正内容  
11514  |'-------------------------------------------------||11487  |'-------------------------------------------------
11515  |'2005/04/21         M.Yamazaki<SRA>     新規作成  ||11488  |'2005/04/21         M.Yamazaki<SRA>     新規作成  
11516  |'=================================================||11489  |'=================================================
11517  |Private Sub sbMGetSettlementDataGet2( _           ||11490  |Private Sub sbMGetSettlementDataGet2( _           
11518  |    ByVal lRecIdx As Long _                       ||11491  |    ByVal lRecIdx As Long _                       
11519  |)                                                 ||11492  |)                                                 
11520  |                                                  ||11493  |                                                  
11521  |    Dim dstr_Settlement_date As String            ||11494  |    Dim dstr_Settlement_date As String            
11522  |                                                  ||11495  |                                                  
11523  |    If lRecIdx <> 0 Then                          ||11496  |    If lRecIdx <> 0 Then                          
11524  |        If Mid(gbuMGetSettlementUPDRec.N(lRecIdx -||11497  |        If Mid(gbuMGetSettlementUPDRec.N(lRecIdx -
11525  |'2005/04/26 Start                                 ||11498  |'2005/04/26 Start                                 
11526  |'            gbuMGetSettlementUPDRec.O(lRecIdx - 1||11499  |'            gbuMGetSettlementUPDRec.O(lRecIdx - 1
11527  |'            gbuMGetSettlementUPDRec.N(lRecIdx - 1||11500  |'            gbuMGetSettlementUPDRec.N(lRecIdx - 1
11528  |'            Exit Sub                             ||11501  |'            Exit Sub                             
11529  |                If gbuMGetSettlementUPDRec.N(lRecI||11502  |                If gbuMGetSettlementUPDRec.N(lRecI
11530  |                And gbuMGetSettlementUPDRec.N(lRec||11503  |                And gbuMGetSettlementUPDRec.N(lRec
11531  |                Else                              ||11504  |                Else                              
11532  |                    gbuMGetSettlementUPDRec.O(lRec||11505  |                    gbuMGetSettlementUPDRec.O(lRec
11533  |                    gbuMGetSettlementUPDRec.N(lRec||11506  |                    gbuMGetSettlementUPDRec.N(lRec
11534  |                    If gvlnDyDataS("Use_Date_start||11507  |                    If gvlnDyDataS("Use_Date_start
11535  |                    And gvlnDyDataS("Use_Date_End"||11508  |                    And gvlnDyDataS("Use_Date_End"
11536  |                        gbuMGetSettlementUPDRec.N(||11509  |                        gbuMGetSettlementUPDRec.N(
11537  |                        gbuMGetSettlementUPDRec.N(||11510  |                        gbuMGetSettlementUPDRec.N(
11538  |                        gbuMGetSettlementUPDRec.O(||11511  |                        gbuMGetSettlementUPDRec.O(
11539  |                        gbuMGetSettlementUPDRec.O(||11512  |                        gbuMGetSettlementUPDRec.O(
11540  |                        lRecCnt2 = lRecCnt2 + 1   ||11513  |                        lRecCnt2 = lRecCnt2 + 1   
11541  |                    End If                        ||11514  |                    End If                        
11542  |                    Exit Sub                      ||11515  |                    Exit Sub                      
11543  |                End If                            ||11516  |                End If                            
11544  |'2005/04/26 End                                   ||11517  |'2005/04/26 End                                   
11545  |        End If                                    ||11518  |        End If                                    
11546  |    End If                                        ||11519  |    End If                                        
11547  |                                                  ||11520  |                                                  
11548  |    If gbuMGetSettlementUPDRec.N(lRecIdx).MGET_use||11521  |    If gbuMGetSettlementUPDRec.N(lRecIdx).MGET_use
11549  |                                                  ||11522  |                                                  
11550  |        With gbuMGetSettlementUPDRec.O(lRecCnt2)  ||11523  |        With gbuMGetSettlementUPDRec.O(lRecCnt2)  
11551  |            .MGET_contract_no = gbuMGetSettlementU||11524  |            .MGET_contract_no = gbuMGetSettlementU
11552  |            .MGET_settlement_date = gbuMGetSettlem||11525  |            .MGET_settlement_date = gbuMGetSettlem
11553  |            .MGET_use_date_start = gbuMGetSettleme||11526  |            .MGET_use_date_start = gbuMGetSettleme
11554  |            .MGET_use_date_end = gbuMGetSettlement||11527  |            .MGET_use_date_end = gbuMGetSettlement
11555  |            '締日が閏年かどうか判定               ||11528  |            '締日が閏年かどうか判定               
11556  |            dstr_Settlement_date = gbuMGetSettleme||11529  |            dstr_Settlement_date = gbuMGetSettleme
11557  |            If Mid(dstr_Settlement_date, 5, 4) = c||11530  |            If Mid(dstr_Settlement_date, 5, 4) = c
11558  |                '閏年チェック                     ||11531  |                '閏年チェック                     
11559  |                If fnblnUrudoshiCheck(Mid(dstr_Set||11532  |                If fnblnUrudoshiCheck(Mid(dstr_Set
11560  |                    dstr_Settlement_date = Mid(dst||11533  |                    dstr_Settlement_date = Mid(dst
11561  |                End If                            ||11534  |                End If                            
11562  |            Else                                  ||11535  |            Else                                  
11563  |                dstr_Settlement_date = gbuMGetSett||11536  |                dstr_Settlement_date = gbuMGetSett
11564  |            End If                                ||11537  |            End If                                
11565  |            .MGET_yyyy_settlement_date = dstr_Sett||11538  |            .MGET_yyyy_settlement_date = dstr_Sett
11566  |        End With                                  ||11539  |        End With                                  
11567  |                                                  ||11540  |                                                  
11568  |        lRecCnt2 = lRecCnt2 + 1                   ||11541  |        lRecCnt2 = lRecCnt2 + 1                   
11569  |    End If                                        ||11542  |    End If                                        
11570  |                                                  ||11543  |                                                  
11571  |End Sub                                           ||11544  |End Sub                                           
11572  |                                                  ||11545  |                                                  
11573  |'=================================================||11546  |'=================================================
11574  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMGetSettlementDataGet_1    ||11547  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMGetSettlementDataGet_1    
11575  |'機能            :   対象外部委託顧問料締日取得テ ||11548  |'機能            :   対象外部委託顧問料締日取得テ 
11576  |'                                                 ||11549  |'                                                 
11577  |'日付               担当                修正内容  ||11550  |'日付               担当                修正内容  
11578  |'-------------------------------------------------||11551  |'-------------------------------------------------
11579  |'2005/04/21         M.Yamazaki<SRA>     新規作成  ||11552  |'2005/04/21         M.Yamazaki<SRA>     新規作成  
11580  |'=================================================||11553  |'=================================================
11581  |Private Sub sbMGetSettlementDataGet_1( _          ||11554  |Private Sub sbMGetSettlementDataGet_1( _          
11582  |    ByVal lRecIdx As Long _                       ||11555  |    ByVal lRecIdx As Long _                       
11583  |)                                                 ||11556  |)                                                 
11584  |                                                  ||11557  |                                                  
11585  |    With gbuMGetSettlementUPDRec.N(lRecIdx)       ||11558  |    With gbuMGetSettlementUPDRec.N(lRecIdx)       
11586  |        .MGET_yyyy_settlement_date = Replace(CStr(||11559  |        .MGET_yyyy_settlement_date = Replace(CStr(
11587  |    End With                                      ||11560  |    End With                                      
11588  |                                                  ||11561  |                                                  
11589  |End Sub                                           ||11562  |End Sub                                           
11590  |                                                  ||11563  |                                                  
11591  |                                                  ||11564  |                                                  
11592  |                                                  ||11565  |                                                  
11593  |                                                  ||11566  |                                                  
11594  |                                                  ||11567  |                                                  
11595  |                                                  ||11568  |                                                  
11596  |                                                  ||11569  |                                                  
11597  |                                                  ||11570  |                                                  
11598  |                                                  ||11571  |                                                  
11599  |                                                  ||11572  |                                                  
11600  |                                                  ||11573  |                                                  
11601  |                                                  ||11574  |                                                  
11602  |                                                  ||11575  |                                                  
11603  |                                                  ||11576  |                                                  
11604  |                                                  ||11577  |                                                  
11605  |                                                  ||11578  |                                                  
11606  |                                                  ||11579  |                                                  
11607  |                                                  ||11580  |                                                  
11608  |                                                  ||11581  |                                                  
11609  |                                                  ||11582  |                                                  
11610  |                                                  ||11583  |                                                  
11611  |                                                  ||11584  |                                                  
11612  |                                                  ||11585  |                                                  
11613  |                                                  ||11586  |                                                  
11614  |                                                  ||11587  |                                                  
11615  |'=================================================||11588  |'=================================================
11616  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblMakePrint_New            ||11589  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblMakePrint_New            
11617  |'機能            :   確認書のExcel出力            ||11590  |'機能            :   確認書のExcel出力            
11618  |'                                                 ||11591  |'                                                 
11619  |'日付               担当　              修正内容  ||11592  |'日付               担当　              修正内容  
11620  |'-------------------------------------------------||11593  |'-------------------------------------------------
11621  |'2006/07/03         K.Furuya <SRA>     期中料率変 ||11594  |'2006/07/03         K.Furuya <SRA>     期中料率変 
11622  |'                                      fnblMakePri||11595  |'                                      fnblMakePri
11623  |'=================================================||11596  |'=================================================
11624  |Private Function fnblMakePrint_New() As Boolean   ||11597  |Private Function fnblMakePrint_New() As Boolean   
11625  |                                                  ||11598  |                                                  
11626  |    Dim sSql            As String                 ||11599  |    Dim sSql            As String                 
11627  |    Dim lRecCnt         As Long                   ||11600  |    Dim lRecCnt         As Long                   
11628  |    Dim lRecDayCnt      As Long                   ||11601  |    Dim lRecDayCnt      As Long                   
11629  |    Dim lGridCnt        As Long                   ||11602  |    Dim lGridCnt        As Long                   
11630  |    Dim Cnt             As Long                   ||11603  |    Dim Cnt             As Long                   
11631  |    Dim MonthlyCnt      As Long                   ||11604  |    Dim MonthlyCnt      As Long                   
11632  |    Dim sStart          As String                 ||11605  |    Dim sStart          As String                 
11633  |    Dim sEnd            As String                 ||11606  |    Dim sEnd            As String                 
11634  |    Dim sContractNo     As String                 ||11607  |    Dim sContractNo     As String                 
11635  |    Dim sCurrencyCode   As String                 ||11608  |    Dim sCurrencyCode   As String                 
11636  |    Dim sBaseDate       As String                 ||11609  |    Dim sBaseDate       As String                 
11637  |    Dim sSettleDate     As String                 ||11610  |    Dim sSettleDate     As String                 
11638  |    Dim sRuleNo         As String                 ||11611  |    Dim sRuleNo         As String                 
11639  |    Dim sPayDate        As String                 ||11612  |    Dim sPayDate        As String                 
11640  |    Dim ParaYear        As String                 ||11613  |    Dim ParaYear        As String                 
11641  |    Dim ParaMonth       As String                 ||11614  |    Dim ParaMonth       As String                 
11642  |    Dim ParaDay         As String                 ||11615  |    Dim ParaDay         As String                 
11643  |    Dim sZenkai         As String                 ||11616  |    Dim sZenkai         As String                 
11644  |    Dim sNearMonth      As String                 ||11617  |    Dim sNearMonth      As String                 
11645  |    Dim LastYearFlag    As Boolean                ||11618  |    Dim LastYearFlag    As Boolean                
11646  |    Dim strErrCall      As String                 ||11619  |    Dim strErrCall      As String                 
11647  |    Const conMeModule   As String = "fnblMakePrint||11620  |    Const conMeModule   As String = "fnblMakePrint
11648  |    Dim sContNo         As String                 ||11621  |    Dim sContNo         As String                 
11649  |    Dim ddblNav As Double                         ||11622  |    Dim ddblNav As Double                         
11650  |    Dim ddblCnt As Double                         ||11623  |    Dim ddblCnt As Double                         
11651  |    Dim ddblNavTotal                              ||11624  |    Dim ddblNavTotal                              
11652  |    Dim ddblBabyMotherRate As Double              ||11625  |    Dim ddblBabyMotherRate As Double              
11653  |    Dim dstrMonthOld As String                    ||11626  |    Dim dstrMonthOld As String                    
11654  |    Dim dstrMonthNew As String                    ||11627  |    Dim dstrMonthNew As String                    
11655  |    Dim i As Integer                              ||11628  |    Dim i As Integer                              
11656  |    Dim RuleNoCnt                   As Integer  ' ||11629  |    Dim RuleNoCnt                   As Integer  ' 
11657  |    Dim KityuFlg                    As Boolean  ' ||11630  |    Dim KityuFlg                    As Boolean  ' 
11658  |                                                  ||11631  |                                                  
11659  |On Error GoTo OnErrorProc                         ||11632  |On Error GoTo OnErrorProc                         
11660  |                                                  ||11633  |                                                  
11661  |    '戻り値初期化                                 ||11634  |    '戻り値初期化                                 
11662  |    fnblMakePrint_New = False                     ||11635  |    fnblMakePrint_New = False                     
11663  |                                                  ||11636  |                                                  
11664  |    'エラー呼出元設定                             ||11637  |    'エラー呼出元設定                             
11665  |    strErrCall = conMeForm & ":" & conMeModule    ||11638  |    strErrCall = conMeForm & ":" & conMeModule    
11666  |                                                  ||11639  |                                                  
11667  |    '初期化                                       ||11640  |    '初期化                                       
11668  |    lRecCnt = 0                                   ||11641  |    lRecCnt = 0                                   
11669  |    lRecDayCnt = 0                                ||11642  |    lRecDayCnt = 0                                
11670  |    gProcessCnt = 0                               ||11643  |    gProcessCnt = 0                               
11671  |    lGridCnt = 0                                  ||11644  |    lGridCnt = 0                                  
11672  |    ddblNav = 0                                   ||11645  |    ddblNav = 0                                   
11673  |    ddblCnt = 0                                   ||11646  |    ddblCnt = 0                                   
11674  |                                                  ||11647  |                                                  
11675  |    'DBオープン                                   ||11648  |    'DBオープン                                   
11676  |    If Not gintDbOpen() Then                      ||11649  |    If Not gintDbOpen() Then                      
11677  |        Exit Function                             ||11650  |        Exit Function                             
11678  |    End If                                        ||11651  |    End If                                        
11679  |                                                  ||11652  |                                                  
11680  |    'グリッドデータを配列に格納する               ||11653  |    'グリッドデータを配列に格納する               
11681  |    '配列初期化                                   ||11654  |    '配列初期化                                   
11682  |    ReDim gbuMGetUPDRec.N(0)                      ||11655  |    ReDim gbuMGetUPDRec.N(0)                      
11683  |    'スプレット表示件数が１件以上の場合のみ       ||11656  |    'スプレット表示件数が１件以上の場合のみ       
11684  |    With fgridMakePrint                           ||11657  |    With fgridMakePrint                           
11685  |        If .Rows > 1 Then                         ||11658  |        If .Rows > 1 Then                         
11686  |            'グリッドデータセット処理             ||11659  |            'グリッドデータセット処理             
11687  |            For lGridCnt = 0 To .Rows - 2         ||11660  |            For lGridCnt = 0 To .Rows - 2         
11688  |                '出力列を選択する                 ||11661  |                '出力列を選択する                 
11689  |                .Col = conColSysOutbln            ||11662  |                .Col = conColSysOutbln            
11690  |                .Row = lGridCnt + 1               ||11663  |                .Row = lGridCnt + 1               
11691  |                If .Text = True Then              ||11664  |                If .Text = True Then              
11692  |                    '対象データ抽出               ||11665  |                    '対象データ抽出               
11693  |                    Call sbGridDataGet(lGridCnt, l||11666  |                    Call sbGridDataGet(lGridCnt, l
11694  |                    '配列の要素数設定カウンターア ||11667  |                    '配列の要素数設定カウンターア 
11695  |                    lRecCnt = lRecCnt + 1         ||11668  |                    lRecCnt = lRecCnt + 1         
11696  |                End If                            ||11669  |                End If                            
11697  |            Next lGridCnt                         ||11670  |            Next lGridCnt                         
11698  |        Else                                      ||11671  |        Else                                      
11699  |            MsgBox "グリッドデータがないですよ！",||11672  |            MsgBox "グリッドデータがないですよ！",
11700  |            Exit Function                         ||11673  |            Exit Function                         
11701  |        End If                                    ||11674  |        End If                                    
11702  |        '後で使うので、カウンター変数を初期化     ||11675  |        '後で使うので、カウンター変数を初期化     
11703  |        lRecCnt = 0                               ||11676  |        lRecCnt = 0                               
11704  |    End With                                      ||11677  |    End With                                      
11705  |                                                  ||11678  |                                                  
11706  |    '取得した契約番号分ループする                 ||11679  |    '取得した契約番号分ループする                 
11707  |    For Cnt = LBound(gbuMGetUPDRec.N) To UBound(gb||11680  |    For Cnt = LBound(gbuMGetUPDRec.N) To UBound(gb
11708  |        '変数の初期化                             ||11681  |        '変数の初期化                             
11709  |        mstrPaymentDate = ""                      ||11682  |        mstrPaymentDate = ""                      
11710  |        mstrNearSettleDate = ""                   ||11683  |        mstrNearSettleDate = ""                   
11711  |        mstrSettlementDate = ""                   ||11684  |        mstrSettlementDate = ""                   
11712  |        msAccCode = ""                            ||11685  |        msAccCode = ""                            
11713  |        msMotherAccCode = ""                      ||11686  |        msMotherAccCode = ""                      
11714  |        msAssetFlg = ""                           ||11687  |        msAssetFlg = ""                           
11715  |        msContNo = ""                             ||11688  |        msContNo = ""                             
11716  |        MonthlyCnt = 0                            ||11689  |        MonthlyCnt = 0                            
11717  |        LastYearFlag = False                      ||11690  |        LastYearFlag = False                      
11718  |                                                  ||11691  |                                                  
11719  |        '契約毎のシート番号を付番する             ||11692  |        '契約毎のシート番号を付番する             
11720  |        gTotalCnt = gTotalCnt + 1                 ||11693  |        gTotalCnt = gTotalCnt + 1                 
11721  |                                                  ||11694  |                                                  
11722  |        '支払予定日をセット                       ||11695  |        '支払予定日をセット                       
11723  |        sPayDate = gbuMGetUPDRec.N(Cnt).MGET_payme||11696  |        sPayDate = gbuMGetUPDRec.N(Cnt).MGET_payme
11724  |        mstrPaymentDate = gbuMGetUPDRec.N(Cnt).MGE||11697  |        mstrPaymentDate = gbuMGetUPDRec.N(Cnt).MGE
11725  |        '処理回数をカウントアップ                 ||11698  |        '処理回数をカウントアップ                 
11726  |        gProcessCnt = gProcessCnt + 1             ||11699  |        gProcessCnt = gProcessCnt + 1             
11727  |        '外部委託顧問料締日取得                   ||11700  |        '外部委託顧問料締日取得                   
11728  |        sContractNo = gbuMGetUPDRec.N(Cnt).MGET_co||11701  |        sContractNo = gbuMGetUPDRec.N(Cnt).MGET_co
11729  |        sSettleDate = gbuMGetUPDRec.N(Cnt).MGET_se||11702  |        sSettleDate = gbuMGetUPDRec.N(Cnt).MGET_se
11730  |        '基準年をセット                           ||11703  |        '基準年をセット                           
11731  |        mstrbaseYear = Mid(sSettleDate, 1, 4)     ||11704  |        mstrbaseYear = Mid(sSettleDate, 1, 4)     
11732  |        '直近締日を設定                           ||11705  |        '直近締日を設定                           
11733  |        mstrNearSettleDate = sSettleDate          ||11706  |        mstrNearSettleDate = sSettleDate          
11734  |                                                  ||11707  |                                                  
11735  |        '前回締日営業日翌日の設定                 ||11708  |        '前回締日営業日翌日の設定                 
11736  |        mstrSettlementDate = gbuMGetUPDRec.N(Cnt).||11709  |        mstrSettlementDate = gbuMGetUPDRec.N(Cnt).
11737  |        '顧問料計算開始日・終了日との整合性をチェ ||11710  |        '顧問料計算開始日・終了日との整合性をチェ 
11738  |        sStart = gbuMGetUPDRec.N(Cnt).MGET_com_cal||11711  |        sStart = gbuMGetUPDRec.N(Cnt).MGET_com_cal
11739  |        sEnd = gbuMGetUPDRec.N(Cnt).MGET_com_calc_||11712  |        sEnd = gbuMGetUPDRec.N(Cnt).MGET_com_calc_
11740  |        '前回締日 < 顧問料計算開始日 の場合、顧問 ||11713  |        '前回締日 < 顧問料計算開始日 の場合、顧問 
11741  |        If sStart <> "" Then                      ||11714  |        If sStart <> "" Then                      
11742  |            If mstrSettlementDate < sStart Then   ||11715  |            If mstrSettlementDate < sStart Then   
11743  |                mstrSettlementDate = sStart       ||11716  |                mstrSettlementDate = sStart       
11744  |            End If                                ||11717  |            End If                                
11745  |        End If                                    ||11718  |        End If                                    
11746  |                                                  ||11719  |                                                  
11747  |        '直近締日 < 顧問料計算終了日 の場合、顧問 ||11720  |        '直近締日 < 顧問料計算終了日 の場合、顧問 
11748  |        If sEnd <> "" Then                        ||11721  |        If sEnd <> "" Then                        
11749  |            If mstrNearSettleDate > sEnd Then     ||11722  |            If mstrNearSettleDate > sEnd Then     
11750  |                mstrNearSettleDate = sEnd         ||11723  |                mstrNearSettleDate = sEnd         
11751  |            End If                                ||11724  |            End If                                
11752  |        End If                                    ||11725  |        End If                                    
11753  |                                                  ||11726  |                                                  
11754  |'SQL文の作成(外部委託顧問料資産種別取得)          ||11727  |'SQL文の作成(外部委託顧問料資産種別取得)          
11755  |        msContNo = gbuMGetUPDRec.N(Cnt).MGET_contr||11728  |        msContNo = gbuMGetUPDRec.N(Cnt).MGET_contr
11756  |        sSql = gstrEditSQLcfr_OtherComRuleAssetFlg||11729  |        sSql = gstrEditSQLcfr_OtherComRuleAssetFlg
11757  |        'ﾀﾞｲﾅｾｯﾄの作成                            ||11730  |        'ﾀﾞｲﾅｾｯﾄの作成                            
11758  |        If gintDyCreate(sSql) = False Then        ||11731  |        If gintDyCreate(sSql) = False Then        
11759  |            Exit Function                         ||11732  |            Exit Function                         
11760  |        End If                                    ||11733  |        End If                                    
11761  |        'EOF判定処理                              ||11734  |        'EOF判定処理                              
11762  |        If Not gblnDyEOF() Then                   ||11735  |        If Not gblnDyEOF() Then                   
11763  |            msAccCode = Trim(gvlnDyDataS("ACCOUNT_||11736  |            msAccCode = Trim(gvlnDyDataS("ACCOUNT_
11764  |            msMotherAccCode = Trim(gvlnDyDataS("MO||11737  |            msMotherAccCode = Trim(gvlnDyDataS("MO
11765  |            msAssetFlg = gvlnDyDataN("ASSET_FLAG")||11738  |            msAssetFlg = gvlnDyDataN("ASSET_FLAG")
11766  |        'マザーファンドが存在しない場合は資産種類 ||11739  |        'マザーファンドが存在しない場合は資産種類 
11767  |        Else                                      ||11740  |        Else                                      
11768  |            msAssetFlg = "0"                      ||11741  |            msAssetFlg = "0"                      
11769  |        End If                                    ||11742  |        End If                                    
11770  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         ||11743  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         
11771  |        Call gblnDyClose                          ||11744  |        Call gblnDyClose                          
11772  |                                                  ||11745  |                                                  
11773  |        '資産種類がマザー組入資産の場合、マザーフ ||11746  |        '資産種類がマザー組入資産の場合、マザーフ 
11774  |        If msAssetFlg = "1" Then                  ||11747  |        If msAssetFlg = "1" Then                  
11775  |            sSql = gstrEditSQLcfr_BaseCurrencyCode||11748  |            sSql = gstrEditSQLcfr_BaseCurrencyCode
11776  |            'ﾀﾞｲﾅｾｯﾄの作成                        ||11749  |            'ﾀﾞｲﾅｾｯﾄの作成                        
11777  |            If gintDyCreate(sSql) = False Then    ||11750  |            If gintDyCreate(sSql) = False Then    
11778  |                Exit Function                     ||11751  |                Exit Function                     
11779  |            End If                                ||11752  |            End If                                
11780  |            'EOF判定処理                          ||11753  |            'EOF判定処理                          
11781  |            If Not gblnDyEOF() Then               ||11754  |            If Not gblnDyEOF() Then               
11782  |                'マザーファンドコードの口座ベース ||11755  |                'マザーファンドコードの口座ベース 
11783  |                gbuMGetUPDRec.N(Cnt).MGET_base_cur||11756  |                gbuMGetUPDRec.N(Cnt).MGET_base_cur
11784  |            End If                                ||11757  |            End If                                
11785  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||11758  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
11786  |            Call gblnDyClose                      ||11759  |            Call gblnDyClose                      
11787  |        End If                                    ||11760  |        End If                                    
11788  |                                                  ||11761  |                                                  
11789  |'SQL文の作成(外部委託顧問料率取得)                ||11762  |'SQL文の作成(外部委託顧問料率取得)                
11790  |        '計算期間の開始日と終了日に含まれる適用期 ||11763  |        '計算期間の開始日と終了日に含まれる適用期 
11791  |        'ルールNoの期中料率を全て取得する｡        ||11764  |        'ルールNoの期中料率を全て取得する｡        
11792  |        sSql = gstrEditSQLcfr_OtherComRateForSelec||11765  |        sSql = gstrEditSQLcfr_OtherComRateForSelec
11793  |            sContractNo, mstrSettlementDate, mstrN||11766  |            sContractNo, mstrSettlementDate, mstrN
11794  |'        sSql = gstrEditSQLcfr_OtherComRateForSele||11767  |'        sSql = gstrEditSQLcfr_OtherComRateForSele
11795  |            sContractNo, 1)                       ||11768  |            sContractNo, 1)                       
11796  |                                                  ||11769  |                                                  
11797  |        'ﾀﾞｲﾅｾｯﾄの作成                            ||11770  |        'ﾀﾞｲﾅｾｯﾄの作成                            
11798  |        If gintDyCreate(sSql) = False Then        ||11771  |        If gintDyCreate(sSql) = False Then        
11799  |            Exit Function                         ||11772  |            Exit Function                         
11800  |        End If                                    ||11773  |        End If                                    
11801  |        '配列初期化                               ||11774  |        '配列初期化                               
11802  |        ReDim gbuOtherComRateGetUPDRec.N(0)       ||11775  |        ReDim gbuOtherComRateGetUPDRec.N(0)       
11803  |        MonthlyCnt = 0                            ||11776  |        MonthlyCnt = 0                            
11804  |        'EOF判定処理                              ||11777  |        'EOF判定処理                              
11805  |        Do Until gblnDyEOF()                      ||11778  |        Do Until gblnDyEOF()                      
11806  |            '対象データ抽出                       ||11779  |            '対象データ抽出                       
11807  |            Call sbOtherComDataGet(MonthlyCnt)    ||11780  |            Call sbOtherComDataGet(MonthlyCnt)    
11808  |            MonthlyCnt = MonthlyCnt + 1           ||11781  |            MonthlyCnt = MonthlyCnt + 1           
11809  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     ||11782  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     
11810  |            Call gDyNext                          ||11783  |            Call gDyNext                          
11811  |        Loop                                      ||11784  |        Loop                                      
11812  |                                                  ||11785  |                                                  
11813  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         ||11786  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         
11814  |        Call gblnDyClose                          ||11787  |        Call gblnDyClose                          
11815  |                                                  ||11788  |                                                  
11816  |        '外部委託顧問料ルールNoの数を取得         ||11789  |        '外部委託顧問料ルールNoの数を取得         
11817  |        RuleNoCnt = 0                             ||11790  |        RuleNoCnt = 0                             
11818  |        RuleNoCnt = gbuOtherComRateGetUPDRec.N(0).||11791  |        RuleNoCnt = gbuOtherComRateGetUPDRec.N(0).
11819  |                                                  ||11792  |                                                  
11820  |        '期中料率変更契約か識別する               ||11793  |        '期中料率変更契約か識別する               
11821  |        If RuleNoCnt > 1 Then                     ||11794  |        If RuleNoCnt > 1 Then                     
11822  |            KityuFlg = True  '期中変更有り        ||11795  |            KityuFlg = True  '期中変更有り        
11823  |        Else                                      ||11796  |        Else                                      
11824  |            KityuFlg = False '期中変更無し        ||11797  |            KityuFlg = False '期中変更無し        
11825  |        End If                                    ||11798  |        End If                                    
11826  |                                                  ||11799  |                                                  
11827  |'確認書の作成                                     ||11800  |'確認書の作成                                     
11828  |                                                  ||11801  |                                                  
11829  |        If gProcessCnt <> 1 Then                  ||11802  |        If gProcessCnt <> 1 Then                  
11830  |            '2回目以降はシートの追加              ||11803  |            '2回目以降はシートの追加              
11831  |            xlBook.Worksheets.Add after:=xlBook.Sh||11804  |            xlBook.Worksheets.Add after:=xlBook.Sh
11832  |        Else                                      ||11805  |        Else                                      
11833  |            '1回目はオブジェクトの設定            ||11806  |            '1回目はオブジェクトの設定            
11834  |            Set xlApp = CreateObject("Excel.Applic||11807  |            Set xlApp = CreateObject("Excel.Applic
11835  |            Set xlBook = xlApp.Workbooks.Add      ||11808  |            Set xlBook = xlApp.Workbooks.Add      
11836  |        End If                                    ||11809  |        End If                                    
11837  |        Set xlSheet = xlBook.Sheets(gProcessCnt)  ||11810  |        Set xlSheet = xlBook.Sheets(gProcessCnt)  
11838  |                                                  ||11811  |                                                  
11839  |        '期中料率変更無し                         ||11812  |        '期中料率変更無し                         
11840  |        If KityuFlg = False Then                  ||11813  |        If KityuFlg = False Then                  
11841  |            If fnblExcelOut_NotChgRate(Cnt) = Fals||11814  |            If fnblExcelOut_NotChgRate(Cnt) = Fals
11842  |                MsgBox "確認書の作成でエラーが発生||11815  |                MsgBox "確認書の作成でエラーが発生
11843  |                Exit Function                     ||11816  |                Exit Function                     
11844  |            End If                                ||11817  |            End If                                
11845  |                                                  ||11818  |                                                  
11846  |            If gbuMGetUPDRec.N(Cnt).MGET_company_f||11819  |            If gbuMGetUPDRec.N(Cnt).MGET_company_f
11847  |                xlBook.Worksheets.Add after:=xlBoo||11820  |                xlBook.Worksheets.Add after:=xlBoo
11848  |                gProcessCnt = gProcessCnt + 1     ||11821  |                gProcessCnt = gProcessCnt + 1     
11849  |                                                  ||11822  |                                                  
11850  |                If fnblExcelEnglishOut_NotChgRate(||11823  |                If fnblExcelEnglishOut_NotChgRate(
11851  |                    MsgBox "英文確認書の作成でエラ||11824  |                    MsgBox "英文確認書の作成でエラ
11852  |                    Exit Function                 ||11825  |                    Exit Function                 
11853  |                End If                            ||11826  |                End If                            
11854  |            End If                                ||11827  |            End If                                
11855  |        '期中料率変更有り                         ||11828  |        '期中料率変更有り                         
11856  |        Else                                      ||11829  |        Else                                      
11857  |            If fnblExcelOut_ChangeRate(Cnt) = Fals||11830  |            If fnblExcelOut_ChangeRate(Cnt) = Fals
11858  |                MsgBox "確認書の作成でエラーが発生||11831  |                MsgBox "確認書の作成でエラーが発生
11859  |                Exit Function                     ||11832  |                Exit Function                     
11860  |            End If                                ||11833  |            End If                                
11861  |                                                  ||11834  |                                                  
11862  |            If gbuMGetUPDRec.N(Cnt).MGET_company_f||11835  |            If gbuMGetUPDRec.N(Cnt).MGET_company_f
11863  |                xlBook.Worksheets.Add after:=xlBoo||11836  |                xlBook.Worksheets.Add after:=xlBoo
11864  |                gProcessCnt = gProcessCnt + 1     ||11837  |                gProcessCnt = gProcessCnt + 1     
11865  |                                                  ||11838  |                                                  
11866  |                If fnblExcelEnglishOut_ChangeRate(||11839  |                If fnblExcelEnglishOut_ChangeRate(
11867  |                    MsgBox "英文確認書の作成でエラ||11840  |                    MsgBox "英文確認書の作成でエラ
11868  |                    Exit Function                 ||11841  |                    Exit Function                 
11869  |                End If                            ||11842  |                End If                            
11870  |            End If                                ||11843  |            End If                                
11871  |        End If                                    ||11844  |        End If                                    
11872  |                                                  ||11845  |                                                  
11873  |        'Excel の Worksheet 削除用カウンタ変数    ||11846  |        'Excel の Worksheet 削除用カウンタ変数    
11874  |        Dim Ws_Cnt      As Integer                ||11847  |        Dim Ws_Cnt      As Integer                
11875  |        Dim Ws_Del_Cnt  As Integer                ||11848  |        Dim Ws_Del_Cnt  As Integer                
11876  |        Dim Ws_Del_Cnt2 As Integer                ||11849  |        Dim Ws_Del_Cnt2 As Integer                
11877  |                                                  ||11850  |                                                  
11878  |                                                  ||11851  |                                                  
11879  |        '動的ファイル名部分を取得                 ||11852  |        '動的ファイル名部分を取得                 
11880  |        If gTotalProcessCnt = 1 Then              ||11853  |        If gTotalProcessCnt = 1 Then              
11881  |            Call sbFileNameChange                 ||11854  |            Call sbFileNameChange                 
11882  |        End If                                    ||11855  |        End If                                    
11883  |                                                  ||11856  |                                                  
11884  |        'Excel の Worksheet 削除用カウンタ初期化  ||11857  |        'Excel の Worksheet 削除用カウンタ初期化  
11885  |        Ws_Cnt = xlBook.Worksheets.Count          ||11858  |        Ws_Cnt = xlBook.Worksheets.Count          
11886  |        Ws_Del_Cnt2 = 0                           ||11859  |        Ws_Del_Cnt2 = 0                           
11887  |        '出力するデータ数のカウント(gSysoutDataCnt||11860  |        '出力するデータ数のカウント(gSysoutDataCnt
11888  |        If gTotalProcessCnt = gSysoutDataCnt Then ||11861  |        If gTotalProcessCnt = gSysoutDataCnt Then 
11889  |            ' WorkBookが存在すれば削除            ||11862  |            ' WorkBookが存在すれば削除            
11890  |            If Dir(mstrFileName) <> "" Then       ||11863  |            If Dir(mstrFileName) <> "" Then       
11891  |                Kill (mstrFileName)               ||11864  |                Kill (mstrFileName)               
11892  |            End If                                ||11865  |            End If                                
11893  |                                                  ||11866  |                                                  
11894  |            'シート名を調査しシート削除           ||11867  |            'シート名を調査しシート削除           
11895  |            For Ws_Del_Cnt = 1 To Ws_Cnt          ||11868  |            For Ws_Del_Cnt = 1 To Ws_Cnt          
11896  |                If Left(xlBook.Worksheets(Ws_Del_C||11869  |                If Left(xlBook.Worksheets(Ws_Del_C
11897  |                    'シートの削除                 ||11870  |                    'シートの削除                 
11898  |                    Application.DisplayAlerts = Fa||11871  |                    Application.DisplayAlerts = Fa
11899  |                    xlBook.Worksheets(Ws_Del_Cnt).||11872  |                    xlBook.Worksheets(Ws_Del_Cnt).
11900  |                    Application.DisplayAlerts = Tr||11873  |                    Application.DisplayAlerts = Tr
11901  |                    Ws_Del_Cnt = Ws_Del_Cnt - 1   ||11874  |                    Ws_Del_Cnt = Ws_Del_Cnt - 1   
11902  |                    Ws_Del_Cnt2 = Ws_Del_Cnt2 + 1 ||11875  |                    Ws_Del_Cnt2 = Ws_Del_Cnt2 + 1 
11903  |                    If Ws_Del_Cnt2 = 2 Then       ||11876  |                    If Ws_Del_Cnt2 = 2 Then       
11904  |                        Exit For                  ||11877  |                        Exit For                  
11905  |                    End If                        ||11878  |                    End If                        
11906  |                End If                            ||11879  |                End If                            
11907  |            Next Ws_Del_Cnt                       ||11880  |            Next Ws_Del_Cnt                       
11908  |                                                  ||11881  |                                                  
11909  |            '見易いようにシートの1枚目を選択する  ||11882  |            '見易いようにシートの1枚目を選択する  
11910  |            xlBook.Worksheets(1).Select           ||11883  |            xlBook.Worksheets(1).Select           
11911  |                                                  ||11884  |                                                  
11912  |            xlBook.SaveAs mstrFileName            ||11885  |            xlBook.SaveAs mstrFileName            
11913  |            xlBook.Close                          ||11886  |            xlBook.Close                          
11914  |            xlApp.Quit                            ||11887  |            xlApp.Quit                            
11915  |                                                  ||11888  |                                                  
11916  |            Set xlApp = Nothing                   ||11889  |            Set xlApp = Nothing                   
11917  |            Set xlBook = Nothing                  ||11890  |            Set xlBook = Nothing                  
11918  |            Set xlSheet = Nothing                 ||11891  |            Set xlSheet = Nothing                 
11919  |                                                  ||11892  |                                                  
11920  |            '処理回数カウンターの初期化           ||11893  |            '処理回数カウンターの初期化           
11921  |            gProcessCnt = 0                       ||11894  |            gProcessCnt = 0                       
11922  |            '保存ファイル名の修正                 ||11895  |            '保存ファイル名の修正                 
11923  |            gSaveFileCnt = gSaveFileCnt + 1       ||11896  |            gSaveFileCnt = gSaveFileCnt + 1       
11924  |            mstrFileName = mstrFileNameBK & " (" &||11897  |            mstrFileName = mstrFileNameBK & " (" &
11925  |        End If                                    ||11898  |        End If                                    
11926  |        '料率格納配列を消去する                   ||11899  |        '料率格納配列を消去する                   
11927  |        Erase gtypOtherComRec                     ||11900  |        Erase gtypOtherComRec                     
11928  |    Next Cnt                                      ||11901  |    Next Cnt                                      
11929  |                                                  ||11902  |                                                  
11930  |    '正常戻り値セット                             ||11903  |    '正常戻り値セット                             
11931  |    fnblMakePrint_New = True                      ||11904  |    fnblMakePrint_New = True                      
11932  |    GoTo EndProc                                  ||11905  |    GoTo EndProc                                  
11933  |                                                  ||11906  |                                                  
11934  |OnErrorProc:                                      ||11907  |OnErrorProc:                                      
11935  |    Call subError("システムエラー", Str(Err.Number||11908  |    Call subError("システムエラー", Str(Err.Number
11936  |        Error, strErrCall, conTitle)              ||11909  |        Error, strErrCall, conTitle)              
11937  |    'マウスポインター元に戻す                     ||11910  |    'マウスポインター元に戻す                     
11938  |    Screen.MousePointer = vbDefault               ||11911  |    Screen.MousePointer = vbDefault               
11939  |                                                  ||11912  |                                                  
11940  |EndProc:                                          ||11913  |EndProc:                                          
11941  |                                                  ||11914  |                                                  
11942  |End Function                                      ||11915  |End Function                                      
11943  |                                                  ||11916  |                                                  
11944  |'=================================================||11917  |'=================================================
11945  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelOut_NotChgRate      ||11918  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelOut_NotChgRate      
11946  |'機能            :   確認書のExcel出力(料率変更無 ||11919  |'機能            :   確認書のExcel出力(料率変更無 
11947  |'                                                 ||11920  |'                                                 
11948  |'日付               担当　              修正内容  ||11921  |'日付               担当　              修正内容  
11949  |'-------------------------------------------------||11922  |'-------------------------------------------------
11950  |'2006/07/03         K.Furuya <SRA>     RAFI対応   ||11923  |'2006/07/03         K.Furuya <SRA>     RAFI対応   
11951  |'                                      fnblExcelOu||11924  |'                                      fnblExcelOu
11952  |'2008/02/20         K.Furuya <SRA>     時価総額基 ||11925  |'2008/02/20         K.Furuya <SRA>     時価総額基 
11953  |'2008/03/26         K.Furuya<SRA>      ファンド決 ||11926  |'2008/03/26         K.Furuya<SRA>      ファンド決 
11954 L|'2014/02/19         M.Takada   <SRA>   【管理会計 ||       |                                                  
11955  |'=================================================||11927  |'=================================================
11956  |Private Function fnblExcelOut_NotChgRate( _       ||11928  |Private Function fnblExcelOut_NotChgRate( _       
11957  |    ByVal lRecIdx As Long _                       ||11929  |    ByVal lRecIdx As Long _                       
11958  |) As Boolean                                      ||11930  |) As Boolean                                      
11959 L|                                                  ||11931 R|                                                  
11960  |                                                  ||11932  |                                                  
11961  |    Dim dStart      As Date     '計算期間　開始日 ||11933  |    Dim dStart      As Date     '計算期間　開始日 
11962  |    Dim dEnd        As Date     '計算期間　終了日 ||11934  |    Dim dEnd        As Date     '計算期間　終了日 
11963  |    Dim sSql        As String                     ||11935  |    Dim sSql        As String                     
11964  |    Dim sCurrencyCode As String '通貨コード(SQL文 ||11936  |    Dim sCurrencyCode As String '通貨コード(SQL文 
11965  |    Dim AccCode     As String   '口座コード(SQL文 ||11937  |    Dim AccCode     As String   '口座コード(SQL文 
11966  |    Dim sDate       As Date     '支払予定日       ||11938  |    Dim sDate       As Date     '支払予定日       
11967  |    Dim sName       As String   '担当者名         ||11939  |    Dim sName       As String   '担当者名         
11968  |    Dim i           As Integer  'カウンター       ||11940  |    Dim i           As Integer  'カウンター       
11969  |    Dim ColNum      As Integer  '部署名コンボボッ ||11941  |    Dim ColNum      As Integer  '部署名コンボボッ 
11970  |    Dim ColWord     As String   '部署名コンボボッ ||11942  |    Dim ColWord     As String   '部署名コンボボッ 
11971  |    Dim iSyouhizei  As Long     '消費税           ||11943  |    Dim iSyouhizei  As Long     '消費税           
11972  |    Dim iRowCnt     As Long     '月末純資産データ ||11944  |    Dim iRowCnt     As Long     '月末純資産データ 
11973  |    Dim TotalNav    As Currency '累積NAV          ||11945  |    Dim TotalNav    As Currency '累積NAV          
11974  |    Dim TotalRate   As Currency '累積閾値         ||11946  |    Dim TotalRate   As Currency '累積閾値         
11975  |    Dim cRate       As Currency '料率             ||11947  |    Dim cRate       As Currency '料率             
11976  |    Dim WorkRate    As Currency '一つ前の累積閾値 ||11948  |    Dim WorkRate    As Currency '一つ前の累積閾値 
11977  |    Dim TotalCom    As Currency '累積投資顧問料   ||11949  |    Dim TotalCom    As Currency '累積投資顧問料   
11978  |    Dim lTaxNum     As Currency '消費税値         ||11950  |    Dim lTaxNum     As Currency '消費税値         
11979  |    Dim lMonthlyPayCom As Currency  '月別支払額   ||11951  |    Dim lMonthlyPayCom As Currency  '月別支払額   
11980  |    Dim lCalcNav    As Currency '計算対象NAV      ||11952  |    Dim lCalcNav    As Currency '計算対象NAV      
11981  |    Dim iCalcNum    As Integer  '計算期間日数     ||11953  |    Dim iCalcNum    As Integer  '計算期間日数     
11982  |    'Excel の Application 変数とエラーをトラップす||11954  |    'Excel の Application 変数とエラーをトラップす
11983  |    Dim iTries      As Integer                    ||11955  |    Dim iTries      As Integer                    
11984  |    Dim strErrCall      As String 'エラー呼出元   ||11956  |    Dim strErrCall      As String 'エラー呼出元   
11985  |    Const conMeModule   As String = "fnblExcelOut_||11957  |    Const conMeModule   As String = "fnblExcelOut_
11986  |    'Excel の Worksheet 削除用カウンタ変数        ||11958  |    'Excel の Worksheet 削除用カウンタ変数        
11987  |    Dim Ws_Cnt      As Integer                    ||11959  |    Dim Ws_Cnt      As Integer                    
11988  |    Dim Ws_Del_Cnt  As Integer                    ||11960  |    Dim Ws_Del_Cnt  As Integer                    
11989  |    Dim Ws_Del_Cnt2 As Integer                    ||11961  |    Dim Ws_Del_Cnt2 As Integer                    
11990  |    Dim ContNo      As String   '契約番号(SQL文作 ||11962  |    Dim ContNo      As String   '契約番号(SQL文作 
11991  |    Dim NavGetCnt   As Long                       ||11963  |    Dim NavGetCnt   As Long                       
11992  |    Dim sGetAccCode As String                     ||11964  |    Dim sGetAccCode As String                     
11993  |    Dim Mnav_Flg    As String                     ||11965  |    Dim Mnav_Flg    As String                     
11994  |    Dim sStart As String            '計算対象　開 ||11966  |    Dim sStart As String            '計算対象　開 
11995  |    Dim sEnd As String              '計算対象　終 ||11967  |    Dim sEnd As String              '計算対象　終 
11996  |    Dim dstrBasedate As String      '基準日用ワー ||11968  |    Dim dstrBasedate As String      '基準日用ワー 
11997  |    Dim dstrCaldate() As String     'カレンダー日 ||11969  |    Dim dstrCaldate() As String     'カレンダー日 
11998  |    Dim ddblDailynav() As Double    '日次NAV用格納||11970  |    Dim ddblDailynav() As Double    '日次NAV用格納
11999  |    Dim dlngCnt As Long             '計算対象期間 ||11971  |    Dim dlngCnt As Long             '計算対象期間 
12000  |    Dim dstrCaldate2 As String      'カレンダー日 ||11972  |    Dim dstrCaldate2 As String      'カレンダー日 
12001  |    Dim dstrBasedate2 As String     '基準日(/編集)||11973  |    Dim dstrBasedate2 As String     '基準日(/編集)
12002  |    Dim dlngDiffdate As Long        'カレンダー日 ||11974  |    Dim dlngDiffdate As Long        'カレンダー日 
12003  |    Dim dintFor As Integer          'For文用変数  ||11975  |    Dim dintFor As Integer          'For文用変数  
12004  |    Dim ddblTtalnav As Double       '日次NAV累積用||11976  |    Dim ddblTtalnav As Double       '日次NAV累積用
12005  |    Dim dstrAvgNav As String                      ||11977  |    Dim dstrAvgNav As String                      
12006  |    Dim ddblNearNav As Double                     ||11978  |    Dim ddblNearNav As Double                     
12007  |    Dim dstrAccCd() As String                     ||11979  |    Dim dstrAccCd() As String                     
12008  |    Dim dstrBsCCd() As String                     ||11980  |    Dim dstrBsCCd() As String                     
12009  |    Dim intRtn      As Integer                    ||11981  |    Dim intRtn      As Integer                    
12010  |    Dim dstrDate         As String                ||11982  |    Dim dstrDate         As String                
12011  |    Dim dstrCurrencyCode As String                ||11983  |    Dim dstrCurrencyCode As String                
12012  |    Dim ddblExchangeRate As Double                ||11984  |    Dim ddblExchangeRate As Double                
12013  |    Dim dintPage    As Integer                    ||11985  |    Dim dintPage    As Integer                    
12014  |    Dim dintPageIni As Integer                    ||11986  |    Dim dintPageIni As Integer                    
12015  |    Dim dintAmari   As Integer                    ||11987  |    Dim dintAmari   As Integer                    
12016  |    Dim dCalDate    As Date                       ||11988  |    Dim dCalDate    As Date                       
12017  |    Dim J           As Integer                    ||11989  |    Dim J           As Integer                    
12018  |    Dim K           As Integer                    ||11990  |    Dim K           As Integer                    
12019  |    Dim L           As Integer                    ||11991  |    Dim L           As Integer                    
12020  |    Dim AvgNav      As Currency                   ||11992  |    Dim AvgNav      As Currency                   
12021  |    Dim dintFor2    As Integer                    ||11993  |    Dim dintFor2    As Integer                    
12022  |    Dim dlngMeisyoSu As Integer                   ||11994  |    Dim dlngMeisyoSu As Integer                   
12023  |    Dim dlngCntsv As Long                         ||11995  |    Dim dlngCntsv As Long                         
12024  |                                                  ||11996  |                                                  
12025  |    '2006/04/12 START K.Furuya 実払管理テーブル更 ||11997  |    '2006/04/12 START K.Furuya 実払管理テーブル更 
12026  |    Dim WkContractNo        As String             ||11998  |    Dim WkContractNo        As String             
12027  |    Dim WkCurCode           As String             ||11999  |    Dim WkCurCode           As String             
12028  |    Dim WkSettlementDate    As String             ||12000  |    Dim WkSettlementDate    As String             
12029  |    Dim WkFixComC           As String             ||12001  |    Dim WkFixComC           As String             
12030  |    Dim WkFixComJ           As String             ||12002  |    Dim WkFixComJ           As String             
12031  |    Dim WkRealComC          As String             ||12003  |    Dim WkRealComC          As String             
12032  |    Dim WkRealComJ          As String             ||12004  |    Dim WkRealComJ          As String             
12033  |    '2006/04/12 END   K.Furuya 実払管理テーブル更 ||12005  |    '2006/04/12 END   K.Furuya 実払管理テーブル更 
12034  |    '2006/07/08 START K.Furuya RAFI対応           ||12006  |    '2006/07/08 START K.Furuya RAFI対応           
12035  |    Dim ddblNearBabyMotherRate      As Double   ' ||12007  |    Dim ddblNearBabyMotherRate      As Double   ' 
12036  |    Dim MonthlyCnt                  As Long       ||12008  |    Dim MonthlyCnt                  As Long       
12037  |    Dim dblNavTotal                 As Double   ' ||12009  |    Dim dblNavTotal                 As Double   ' 
12038  |    '2006/07/08 END   K.Furuya RAFI対応           ||12010  |    '2006/07/08 END   K.Furuya RAFI対応           
12039  |                                                  ||12011  |                                                  
12040  |    '戻り値初期化                                 ||12012  |    '戻り値初期化                                 
12041  |    fnblExcelOut_NotChgRate = False               ||12013  |    fnblExcelOut_NotChgRate = False               
12042  |    i = 0                                         ||12014  |    i = 0                                         
12043  |                                                  ||12015  |                                                  
12044  |On Error Resume Next                              ||12016  |On Error Resume Next                              
12045  |                                                  ||12017  |                                                  
12046  |    'Excelフォーマットを調整                      ||12018  |    'Excelフォーマットを調整                      
12047  |    xlSheet.Cells.ColumnWidth = 1                 ||12019  |    xlSheet.Cells.ColumnWidth = 1                 
12048  |    xlSheet.Cells.Font.Size = 11                  ||12020  |    xlSheet.Cells.Font.Size = 11                  
12049  |                                                  ||12021  |                                                  
12050  |    'シート名を設定(確認書**)                     ||12022  |    'シート名を設定(確認書**)                     
12051  |    '契約毎のシート番号を付番する                 ||12023  |    '契約毎のシート番号を付番する                 
12052  |    'xlBook.Sheets(gProcessCnt).Name = sWord33 & (||12024  |    'xlBook.Sheets(gProcessCnt).Name = sWord33 & (
12053  |    xlBook.Sheets(gProcessCnt).Name = sWord33 & gT||12025  |    xlBook.Sheets(gProcessCnt).Name = sWord33 & gT
12054  |                                                  ||12026  |                                                  
12055  |    'シートの余白を設定                           ||12027  |    'シートの余白を設定                           
12056  |    xlSheet.PageSetup.TopMargin = Application.Inch||12028  |    xlSheet.PageSetup.TopMargin = Application.Inch
12057  |    xlSheet.PageSetup.BottomMargin = Application.I||12029  |    xlSheet.PageSetup.BottomMargin = Application.I
12058  |    xlSheet.PageSetup.LeftMargin = Application.Inc||12030  |    xlSheet.PageSetup.LeftMargin = Application.Inc
12059  |    xlSheet.PageSetup.RightMargin = Application.In||12031  |    xlSheet.PageSetup.RightMargin = Application.In
12060  |                                                  ||12032  |                                                  
12061  |    '総計の出力処理カウンターアップ               ||12033  |    '総計の出力処理カウンターアップ               
12062  |    gTotalProcessCnt = gTotalProcessCnt + 1       ||12034  |    gTotalProcessCnt = gTotalProcessCnt + 1       
12063  |                                                  ||12035  |                                                  
12064  |    DoEvents                                      ||12036  |    DoEvents                                      
12065  |    With xlSheet                                  ||12037  |    With xlSheet                                  
12066  |        '題目                                     ||12038  |        '題目                                     
12067  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||12039  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
12068  |            Case Mid(mstrContractFlag(1), 1, 1)   ||12040  |            Case Mid(mstrContractFlag(1), 1, 1)   
12069  |                .Cells(5, 1).Value = sWord0a      ||12041  |                .Cells(5, 1).Value = sWord0a      
12070  |            Case Mid(mstrContractFlag(2), 1, 1)   ||12042  |            Case Mid(mstrContractFlag(2), 1, 1)   
12071  |                .Cells(5, 1).Value = sWord0b      ||12043  |                .Cells(5, 1).Value = sWord0b      
12072  |            Case Mid(mstrContractFlag(3), 1, 1)   ||12044  |            Case Mid(mstrContractFlag(3), 1, 1)   
12073  |                .Cells(5, 1).Value = sWord0c      ||12045  |                .Cells(5, 1).Value = sWord0c      
12074  |            Case Else                             ||12046  |            Case Else                             
12075  |                MsgBox "契約区分が不正です。", vbC||12047  |                MsgBox "契約区分が不正です。", vbC
12076  |        End Select                                ||12048  |        End Select                                
12077  |        'フォントサイズ                           ||12049  |        'フォントサイズ                           
12078  |        .Cells(5, 1).Font.Size = 14               ||12050  |        .Cells(5, 1).Font.Size = 14               
12079  |        'フォント位置                             ||12051  |        'フォント位置                             
12080  |        .Range("A5:BG5").HorizontalAlignment = xlC||12052  |        .Range("A5:BG5").HorizontalAlignment = xlC
12081  |        '出力日付文字                             ||12053  |        '出力日付文字                             
12082  |        If RTrim(txtSysOutDate.Text) = "" Then    ||12054  |        If RTrim(txtSysOutDate.Text) = "" Then    
12083  |            .Cells(3, 50).Value = sWord34         ||12055  |            .Cells(3, 50).Value = sWord34         
12084  |            .Cells(3, 50).HorizontalAlignment = xl||12056  |            .Cells(3, 50).HorizontalAlignment = xl
12085  |        Else                                      ||12057  |        Else                                      
12086  |            .Cells(3, 43).Value = CStr(Format(txtS||12058  |            .Cells(3, 43).Value = CStr(Format(txtS
12087  |        End If                                    ||12059  |        End If                                    
12088  |        '財務部　担当者                           ||12060  |        '財務部　担当者                           
12089  |        sName = RTrim(txtInputName.Text)          ||12061  |        sName = RTrim(txtInputName.Text)          
12090  |        '財務部                                   ||12062  |        '財務部                                   
12091  |        .Cells(7, 37).Value = sWord1              ||12063  |        .Cells(7, 37).Value = sWord1              
12092  |        .Cells(8, 39).Value = sWord2 & sName      ||12064  |        .Cells(8, 39).Value = sWord2 & sName      
12093  |        '下記のとおり･･･ ,文言                    ||12065  |        '下記のとおり･･･ ,文言                    
12094  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||12066  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
12095  |            Case Mid(mstrContractFlag(1), 1, 1)   ||12067  |            Case Mid(mstrContractFlag(1), 1, 1)   
12096  |                .Cells(10, 2).Value = sWord3a     ||12068  |                .Cells(10, 2).Value = sWord3a     
12097  |            Case Mid(mstrContractFlag(2), 1, 1)   ||12069  |            Case Mid(mstrContractFlag(2), 1, 1)   
12098  |                .Cells(10, 2).Value = sWord3b     ||12070  |                .Cells(10, 2).Value = sWord3b     
12099  |            Case Mid(mstrContractFlag(3), 1, 1)   ||12071  |            Case Mid(mstrContractFlag(3), 1, 1)   
12100  |                .Cells(10, 2).Value = sWord3c     ||12072  |                .Cells(10, 2).Value = sWord3c     
12101  |            Case Else                             ||12073  |            Case Else                             
12102  |        End Select                                ||12074  |        End Select                                
12103  |        'ファンド名: ,文言                        ||12075  |        'ファンド名: ,文言                        
12104  |        .Cells(12, 2).Value = sWord4              ||12076  |        .Cells(12, 2).Value = sWord4              
12105  |        .Cells(12, 11).Value = sWord19            ||12077  |        .Cells(12, 11).Value = sWord19            
12106  |        .Cells(12, 13).Value = gbuMGetUPDRec.N(lRe||12078  |        .Cells(12, 13).Value = gbuMGetUPDRec.N(lRe
12107  |        'ファンドコード: ,文言                    ||12079  |        'ファンドコード: ,文言                    
12108  |        .Cells(13, 2).Value = sWord4_2            ||12080  |        .Cells(13, 2).Value = sWord4_2            
12109  |        .Cells(13, 11).Value = sWord19            ||12081  |        .Cells(13, 11).Value = sWord19            
12110  |        .Cells(13, 13).NumberFormatLocal = "@"    ||12082  |        .Cells(13, 13).NumberFormatLocal = "@"    
12111  |        '契約番号                                 ||12083  |        '契約番号                                 
12112  |        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_con||12084  |        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_con
12113  |                                                  ||12085  |                                                  
12114  |        'RAFI対応 START                           ||12086  |        'RAFI対応 START                           
12115  |        'NAV取得SQL                               ||12087  |        'NAV取得SQL                               
12116  |        '外部委託顧問料ルールの資産種類によって取 ||12088  |        '外部委託顧問料ルールの資産種類によって取 
12117  |        '純資産                                   ||12089  |        '純資産                                   
12118  |        If msAssetFlg = "0" Then                  ||12090  |        If msAssetFlg = "0" Then                  
12119  |            sSql = gstrEditSQLcfr_NavGetForSelectL||12091  |            sSql = gstrEditSQLcfr_NavGetForSelectL
12120  |        'マザー組入資産                           ||12092  |        'マザー組入資産                           
12121  |        Else                                      ||12093  |        Else                                      
12122  |            sSql = gstrEditSQLcfr_MotherAccGetForS||12094  |            sSql = gstrEditSQLcfr_MotherAccGetForS
12123  |        End If                                    ||12095  |        End If                                    
12124  |                                                  ||12096  |                                                  
12125  |        'ﾀﾞｲﾅｾｯﾄの作成                            ||12097  |        'ﾀﾞｲﾅｾｯﾄの作成                            
12126  |        If gintDyCreate(sSql) = False Then        ||12098  |        If gintDyCreate(sSql) = False Then        
12127  |            Exit Function                         ||12099  |            Exit Function                         
12128  |        End If                                    ||12100  |        End If                                    
12129  |                                                  ||12101  |                                                  
12130  |        '2006/04/12 START K.Furuya 実払管理テーブ ||12102  |        '2006/04/12 START K.Furuya 実払管理テーブ 
12131  |        '契約番号を取得                           ||12103  |        '契約番号を取得                           
12132  |        WkContractNo = ""                         ||12104  |        WkContractNo = ""                         
12133  |        WkContractNo = ContNo                     ||12105  |        WkContractNo = ContNo                     
12134  |        '2006/04/12 END   K.Furuya 実払管理テーブ ||12106  |        '2006/04/12 END   K.Furuya 実払管理テーブ 
12135  |                                                  ||12107  |                                                  
12136  |        Do Until gblnDyEOF()                      ||12108  |        Do Until gblnDyEOF()                      
12137  |            '動的配列更新                         ||12109  |            '動的配列更新                         
12138  |            ReDim Preserve gtypcfr_navget_tbl(0 To||12110  |            ReDim Preserve gtypcfr_navget_tbl(0 To
12139  |            ReDim Preserve dstrAccCd(0 To NavGetCn||12111  |            ReDim Preserve dstrAccCd(0 To NavGetCn
12140  |            'NAV取得抽出                          ||12112  |            'NAV取得抽出                          
12141  |            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT_||12113  |            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT_
12142  |            If NavGetCnt > 0 Then                 ||12114  |            If NavGetCnt > 0 Then                 
12143  |                sGetAccCode = sGetAccCode & " , " ||12115  |                sGetAccCode = sGetAccCode & " , " 
12144  |            Else                                  ||12116  |            Else                                  
12145  |                sGetAccCode = sGetAccCode & gtypcf||12117  |                sGetAccCode = sGetAccCode & gtypcf
12146  |            End If                                ||12118  |            End If                                
12147  |            '口座コードの格納(１契約複数口座の場合||12119  |            '口座コードの格納(１契約複数口座の場合
12148  |            dstrAccCd(NavGetCnt) = gtypcfr_navget_||12120  |            dstrAccCd(NavGetCnt) = gtypcfr_navget_
12149  |            NavGetCnt = NavGetCnt + 1             ||12121  |            NavGetCnt = NavGetCnt + 1             
12150  |            'マザー組入資産の場合ベビーファンドコ ||12122  |            'マザー組入資産の場合ベビーファンドコ 
12151  |            If msAssetFlg = "1" Then              ||12123  |            If msAssetFlg = "1" Then              
12152  |                msBabyAccountCode = ""            ||12124  |                msBabyAccountCode = ""            
12153  |                msBabyAccountCode = Trim(gvlnDyDat||12125  |                msBabyAccountCode = Trim(gvlnDyDat
12154  |            End If                                ||12126  |            End If                                
12155  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     ||12127  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     
12156  |            Call gDyNext                          ||12128  |            Call gDyNext                          
12157  |         Loop                                     ||12129  |         Loop                                     
12158  |        'RAFI対応 END                             ||12130  |        'RAFI対応 END                             
12159  |                                                  ||12131  |                                                  
12160  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         ||12132  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         
12161  |        Call gblnDyClose                          ||12133  |        Call gblnDyClose                          
12162  |                                                  ||12134  |                                                  
12163  |        '１契約複数口座の場合に口座のベース通貨に ||12135  |        '１契約複数口座の場合に口座のベース通貨に 
12164  |        ReDim dstrBsCCd(0 To NavGetCnt - 1)       ||12136  |        ReDim dstrBsCCd(0 To NavGetCnt - 1)       
12165  |        If NavGetCnt - 1 > 0 Then                 ||12137  |        If NavGetCnt - 1 > 0 Then                 
12166  |            For dintFor = 0 To NavGetCnt - 1      ||12138  |            For dintFor = 0 To NavGetCnt - 1      
12167  |                sSql = ""                         ||12139  |                sSql = ""                         
12168  |                sSql = sSql & "SELECT ACCOUNT_CODE||12140  |                sSql = sSql & "SELECT ACCOUNT_CODE
12169  |                sSql = sSql & "WHERE ACCOUNT_CODE ||12141  |                sSql = sSql & "WHERE ACCOUNT_CODE 
12170  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||12142  |                'ﾀﾞｲﾅｾｯﾄの作成                    
12171  |                If gintDyCreate(sSql) = False Then||12143  |                If gintDyCreate(sSql) = False Then
12172  |                    Exit Function                 ||12144  |                    Exit Function                 
12173  |                Else                              ||12145  |                Else                              
12174  |                    dstrBsCCd(dintFor) = gvlnDyDat||12146  |                    dstrBsCCd(dintFor) = gvlnDyDat
12175  |                End If                            ||12147  |                End If                            
12176  |                If dintFor > 0 Then               ||12148  |                If dintFor > 0 Then               
12177  |                    If dstrBsCCd(dintFor) <> dstrB||12149  |                    If dstrBsCCd(dintFor) <> dstrB
12178  |                        intRtn = MsgBox("ファンド ||12150  |                        intRtn = MsgBox("ファンド 
12179  |                        Exit Function             ||12151  |                        Exit Function             
12180  |                    End If                        ||12152  |                    End If                        
12181  |                End If                            ||12153  |                End If                            
12182  |            Next dintFor                          ||12154  |            Next dintFor                          
12183  |                                                  ||12155  |                                                  
12184  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||12156  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
12185  |            Call gblnDyClose                      ||12157  |            Call gblnDyClose                      
12186  |                                                  ||12158  |                                                  
12187  |        End If                                    ||12159  |        End If                                    
12188  |                                                  ||12160  |                                                  
12189  |        '口座コードをセルに配置                   ||12161  |        '口座コードをセルに配置                   
12190  |        'RAFI対応 START                           ||12162  |        'RAFI対応 START                           
12191  |        '純資産の場合                             ||12163  |        '純資産の場合                             
12192  |        If msAssetFlg = "0" Then                  ||12164  |        If msAssetFlg = "0" Then                  
12193  |            .Cells(13, 13).Value = sGetAccCode    ||12165  |            .Cells(13, 13).Value = sGetAccCode    
12194  |        'マザー組入資産の場合                     ||12166  |        'マザー組入資産の場合                     
12195  |        Else                                      ||12167  |        Else                                      
12196  |            .Cells(13, 13).Value = msBabyAccountCo||12168  |            .Cells(13, 13).Value = msBabyAccountCo
12197  |        End If                                    ||12169  |        End If                                    
12198  |        'RAFI対応 END                             ||12170  |        'RAFI対応 END                             
12199  |        '計算期間: ,文言                          ||12171  |        '計算期間: ,文言                          
12200  |        .Cells(15, 2).Value = sWord5              ||12172  |        .Cells(15, 2).Value = sWord5              
12201  |        .Cells(15, 11).Value = sWord19            ||12173  |        .Cells(15, 11).Value = sWord19            
12202  |        '前回締日・直近締日セット                 ||12174  |        '前回締日・直近締日セット                 
12203  |        dStart = CDate(gstrDateFormat(mstrSettleme||12175  |        dStart = CDate(gstrDateFormat(mstrSettleme
12204  |        dEnd = CDate(gstrDateFormat(mstrNearSettle||12176  |        dEnd = CDate(gstrDateFormat(mstrNearSettle
12205  |        dstrDate = Replace(CStr(dEnd), "/", "")   ||12177  |        dstrDate = Replace(CStr(dEnd), "/", "")   
12206  |                                                  ||12178  |                                                  
12207  |        '2006/04/12 START K.Furuya 実払管理テーブ ||12179  |        '2006/04/12 START K.Furuya 実払管理テーブ 
12208  |        '締日を取得                               ||12180  |        '締日を取得                               
12209  |        WkSettlementDate = ""                     ||12181  |        WkSettlementDate = ""                     
12210  |        WkSettlementDate = dstrDate               ||12182  |        WkSettlementDate = dstrDate               
12211  |        '2006/04/12 END   K.Furuya 実払管理テーブ ||12183  |        '2006/04/12 END   K.Furuya 実払管理テーブ 
12212  |                                                  ||12184  |                                                  
12213  |        '前回締日から直近締日の(日数 +1)を取得    ||12185  |        '前回締日から直近締日の(日数 +1)を取得    
12214  |        iCalcNum = DateDiff("d", dStart, dEnd) + 1||12186  |        iCalcNum = DateDiff("d", dStart, dEnd) + 1
12215  |                                                  ||12187  |                                                  
12216  |                                                  ||12188  |                                                  
12217  |                                                  ||12189  |                                                  
12218  |        '純資産総額: ,文言                        ||12190  |        '純資産総額: ,文言                        
12219  |        .Cells(17, 2).Value = sWord50             ||12191  |        .Cells(17, 2).Value = sWord50             
12220  |        .Cells(17, 11).Value = sWord19            ||12192  |        .Cells(17, 11).Value = sWord19            
12221  |                                                  ||12193  |                                                  
12222  |        '月末純資産: ,文言                        ||12194  |        '月末純資産: ,文言                        
12223  |        .Cells(19, 2).Value = sWord6              ||12195  |        .Cells(19, 2).Value = sWord6              
12224  |        .Cells(19, 11).Value = sWord19            ||12196  |        .Cells(19, 11).Value = sWord19            
12225  |                                                  ||12197  |                                                  
12226  |        '純資産 ,表中の文言                       ||12198  |        '純資産 ,表中の文言                       
12227  |        .Cells(19, 26).Value = sWord8             ||12199  |        .Cells(19, 26).Value = sWord8             
12228  |        .Range("Z19:AN19").HorizontalAlignment = x||12200  |        .Range("Z19:AN19").HorizontalAlignment = x
12229  |'2005/03/09 Start @@@@@ 合計行を出力しないならここ||12201  |'2005/03/09 Start @@@@@ 合計行を出力しないならここ
12230  |        '合計(純資産) ,表中の文言                 ||12202  |        '合計(純資産) ,表中の文言                 
12231  |        .Cells(33, 14).Value = sWord9             ||12203  |        .Cells(33, 14).Value = sWord9             
12232  |        .Range("N33:Y33").HorizontalAlignment = xl||12204  |        .Range("N33:Y33").HorizontalAlignment = xl
12233  |'2005/03/09 End @@@@@ 合計行を出力しないならここを||12205  |'2005/03/09 End @@@@@ 合計行を出力しないならここを
12234  |        '日付 ,表中の文言                         ||12206  |        '日付 ,表中の文言                         
12235  |        .Cells(19, 14).Value = sWord7             ||12207  |        .Cells(19, 14).Value = sWord7             
12236  |        .Range("N19:Y19").HorizontalAlignment = xl||12208  |        .Range("N19:Y19").HorizontalAlignment = xl
12237  |                                                  ||12209  |                                                  
12238  |        iRowCnt = 0                               ||12210  |        iRowCnt = 0                               
12239  |        TotalNav = 0                              ||12211  |        TotalNav = 0                              
12240  |        Mnav_Flg = 0                              ||12212  |        Mnav_Flg = 0                              
12241  |                                                  ||12213  |                                                  
12242  |'契約区分を判断する                               ||12214  |'契約区分を判断する                               
12243  |'        '契約区分「1」or「2」or (「3」and 取得NAV||12215  |'        '契約区分「1」or「2」or (「3」and 取得NAV
12244  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||12216  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
12245  |            Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c||12217  |            Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c
12246  |            Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_||12218  |            Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_
12247  |            And gbuMGetUPDRec.N(lRecIdx).MGET_nav_||12219  |            And gbuMGetUPDRec.N(lRecIdx).MGET_nav_
12248  |'取得NAV区分[1]                                   ||12220  |'取得NAV区分[1]                                   
12249  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g||12221  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g
12250  |                '月次NAVを取得する                ||12222  |                '月次NAVを取得する                
12251  |                Call sbMonthlyNAV_GetNotChgRate(lR||12223  |                Call sbMonthlyNAV_GetNotChgRate(lR
12252  |                                                  ||12224  |                                                  
12253  |                '月次NAVを累積                    ||12225  |                '月次NAVを累積                    
12254  |                For i = LBound(gtypcfr_mnav_tbl) T||12226  |                For i = LBound(gtypcfr_mnav_tbl) T
12255  |                    If Len(gtypcfr_mnav_tbl(i).BAS||12227  |                    If Len(gtypcfr_mnav_tbl(i).BAS
12256  |                        '日付                     ||12228  |                        '日付                     
12257  |                        .Cells(20 + i, 15).Value =||12229  |                        .Cells(20 + i, 15).Value =
12258  |                                WordYear & CInt(Mi||12230  |                                WordYear & CInt(Mi
12259  |                        '純資産                   ||12231  |                        '純資産                   
12260  |                        .Cells(20 + i, 39).NumberF||12232  |                        .Cells(20 + i, 39).NumberF
12261  |                        If gbuMGetUPDRec.N(lRecIdx||12233  |                        If gbuMGetUPDRec.N(lRecIdx
12262  |                            .Cells(20 + i, 39).Val||12234  |                            .Cells(20 + i, 39).Val
12263  |                        Else                      ||12235  |                        Else                      
12264  |                            .Cells(20 + i, 39).Val||12236  |                            .Cells(20 + i, 39).Val
12265  |                        End If                    ||12237  |                        End If                    
12266  |                        .Cells(20 + i, 39).Horizon||12238  |                        .Cells(20 + i, 39).Horizon
12267  |                        TotalNav = TotalNav + CCur||12239  |                        TotalNav = TotalNav + CCur
12268  |                        iRowCnt = iRowCnt + 1     ||12240  |                        iRowCnt = iRowCnt + 1     
12269  |                    Else                          ||12241  |                    Else                          
12270  |                        Mnav_Flg = 1              ||12242  |                        Mnav_Flg = 1              
12271  |                    End If                        ||12243  |                    End If                        
12272  |                Next i                            ||12244  |                Next i                            
12273  |                '日次NAVを算出                    ||12245  |                '日次NAVを算出                    
12274  |                If Mnav_Flg = 1 Then              ||12246  |                If Mnav_Flg = 1 Then              
12275  |                    i = i - 1                     ||12247  |                    i = i - 1                     
12276  |                End If                            ||12248  |                End If                            
12277  |                If mstrDailyNav <> "" Then        ||12249  |                If mstrDailyNav <> "" Then        
12278  |                    '日付                         ||12250  |                    '日付                         
12279  |                    .Cells(20 + i, 15).Value = CSt||12251  |                    .Cells(20 + i, 15).Value = CSt
12280  |                    '純資産                       ||12252  |                    '純資産                       
12281  |                    .Cells(20 + i, 39).NumberForma||12253  |                    .Cells(20 + i, 39).NumberForma
12282  |                    If gbuMGetUPDRec.N(lRecIdx).MG||12254  |                    If gbuMGetUPDRec.N(lRecIdx).MG
12283  |                        .Cells(20 + i, 39).Value =||12255  |                        .Cells(20 + i, 39).Value =
12284  |                    Else                          ||12256  |                    Else                          
12285  |                        .Cells(20 + i, 39).Value =||12257  |                        .Cells(20 + i, 39).Value =
12286  |                    End If                        ||12258  |                    End If                        
12287  |                    .Cells(20 + i, 39).HorizontalA||12259  |                    .Cells(20 + i, 39).HorizontalA
12288  |                    TotalNav = TotalNav + CCur(mst||12260  |                    TotalNav = TotalNav + CCur(mst
12289  |                    iRowCnt = iRowCnt + 1         ||12261  |                    iRowCnt = iRowCnt + 1         
12290  |                End If                            ||12262  |                End If                            
12291  |                  '合計(月末純資産)               ||12263  |                  '合計(月末純資産)               
12292  |                '合計行を出力しないならここをコメ ||12264  |                '合計行を出力しないならここをコメ 
12293  |                .Cells(33, 39).NumberFormatLocal =||12265  |                .Cells(33, 39).NumberFormatLocal =
12294  |                .Cells(17, 23).NumberFormatLocal =||12266  |                .Cells(17, 23).NumberFormatLocal =
12295  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||12267  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
12296  |                    '合計行を出力しないならここを ||12268  |                    '合計行を出力しないならここを 
12297  |                    .Cells(33, 39).Value = CStr(Fo||12269  |                    .Cells(33, 39).Value = CStr(Fo
12298  |                    .Cells(17, 23).Value = CStr(Fo||12270  |                    .Cells(17, 23).Value = CStr(Fo
12299  |                Else                              ||12271  |                Else                              
12300  |                    '合計行を出力しないならここを ||12272  |                    '合計行を出力しないならここを 
12301  |                    .Cells(33, 39).Value = CStr(Fo||12273  |                    .Cells(33, 39).Value = CStr(Fo
12302  |                    .Cells(17, 23).Value = CStr(Fo||12274  |                    .Cells(17, 23).Value = CStr(Fo
12303  |                End If                            ||12275  |                End If                            
12304  |                '合計行を出力しないならここをコメ ||12276  |                '合計行を出力しないならここをコメ 
12305  |                .Cells(33, 39).HorizontalAlignment||12277  |                .Cells(33, 39).HorizontalAlignment
12306  |                .Cells(17, 23).HorizontalAlignment||12278  |                .Cells(17, 23).HorizontalAlignment
12307  |                '平均純資産総額                   ||12279  |                '平均純資産総額                   
12308  |                .Cells(36, 2).Value = sWord51     ||12280  |                .Cells(36, 2).Value = sWord51     
12309  |                .Cells(36, 11).Value = sWord19    ||12281  |                .Cells(36, 11).Value = sWord19    
12310  |                  '計算期間の純資産総額の合計(月末||12282  |                  '計算期間の純資産総額の合計(月末
12311  |                .Cells(36, 23).NumberFormatLocal =||12283  |                .Cells(36, 23).NumberFormatLocal =
12312  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||12284  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
12313  |                    .Cells(36, 23).Value = CStr(Fo||12285  |                    .Cells(36, 23).Value = CStr(Fo
12314  |                Else                              ||12286  |                Else                              
12315  |                    .Cells(36, 23).Value = CStr(Fo||12287  |                    .Cells(36, 23).Value = CStr(Fo
12316  |                End If                            ||12288  |                End If                            
12317  |                .Cells(36, 23).HorizontalAlignment||12289  |                .Cells(36, 23).HorizontalAlignment
12318  |                  '計算期間の純資産総額の合計÷計 ||12290  |                  '計算期間の純資産総額の合計÷計 
12319  |                .Cells(36, 35).NumberFormatLocal =||12291  |                .Cells(36, 35).NumberFormatLocal =
12320  |                dblValueIn = TotalNav / iRowCnt   ||12292  |                dblValueIn = TotalNav / iRowCnt   
12321  |                                                  ||12293  |                                                  
12322  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||12294  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
12323  |                      Call sbGetRoundValue2(dblVal||12295  |                      Call sbGetRoundValue2(dblVal
12324  |                Else                              ||12296  |                Else                              
12325  |                      Call sbGetRoundValue(dblValu||12297  |                      Call sbGetRoundValue(dblValu
12326  |                End If                            ||12298  |                End If                            
12327  |                '平均NAV(計算対象NAV)             ||12299  |                '平均NAV(計算対象NAV)             
12328  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||12300  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
12329  |                    .Cells(36, 35).Value = CStr(Fo||12301  |                    .Cells(36, 35).Value = CStr(Fo
12330  |                Else                              ||12302  |                Else                              
12331  |                    .Cells(36, 35).Value = CStr(Fo||12303  |                    .Cells(36, 35).Value = CStr(Fo
12332  |                End If                            ||12304  |                End If                            
12333  |                '÷??＝ ,文言                     ||12305  |                '÷??＝ ,文言                     
12334  |                .Cells(36, 26).Value = sWord18 & "||12306  |                .Cells(36, 26).Value = sWord18 & "
12335  |                                                  ||12307  |                                                  
12336  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||12308  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
12337  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_n||12309  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_n
12338  |            '=====================================||12310  |            '=====================================
12339  |            '==                                   ||12311  |            '==                                   
12340  |            '==  '4':日次時価総額平均(休日込)の計 ||12312  |            '==  '4':日次時価総額平均(休日込)の計 
12341  |            '==                                   ||12313  |            '==                                   
12342  |            '=====================================||12314  |            '=====================================
12343  |                ddblTtalnav = 0                   ||12315  |                ddblTtalnav = 0                   
12344  |                For dintFor = 0 To NavGetCnt - 1  ||12316  |                For dintFor = 0 To NavGetCnt - 1  
12345  |                                                  ||12317  |                                                  
12346  |                    '日次時価総額平均取得         ||12318  |                    '日次時価総額平均取得         
12347  |                    sStart = gstrDateFormat2(CStr(||12319  |                    sStart = gstrDateFormat2(CStr(
12348  |                    sEnd = gstrDateFormat2(CStr(dE||12320  |                    sEnd = gstrDateFormat2(CStr(dE
12349  |                                                  ||12321  |                                                  
12350  |                    '計算開始日と外部委託顧問料計 ||12322  |                    '計算開始日と外部委託顧問料計 
12351  |                    If sStart = gbuMGetUPDRec.N(lR||12323  |                    If sStart = gbuMGetUPDRec.N(lR
12352  |                        '== SQL1 ==               ||12324  |                        '== SQL1 ==               
12353  |                        sSql = ""                 ||12325  |                        sSql = ""                 
12354  |                        sSql = sSql & "SELECT EIGY||12326  |                        sSql = sSql & "SELECT EIGY
12355  |                                                  ||12327  |                                                  
12356  |                        'ﾀﾞｲﾅｾｯﾄの作成            ||12328  |                        'ﾀﾞｲﾅｾｯﾄの作成            
12357  |                        If gintDyCreate(sSql) = Fa||12329  |                        If gintDyCreate(sSql) = Fa
12358  |                            Exit Function         ||12330  |                            Exit Function         
12359  |                        Else                      ||12331  |                        Else                      
12360  |                            '計算開始日が休日の場 ||12332  |                            '計算開始日が休日の場 
12361  |                            If gvlnDyDataS("EIGYO_||12333  |                            If gvlnDyDataS("EIGYO_
12362  |                                '翌営業日の時価総 ||12334  |                                '翌営業日の時価総 
12363  |                                '== SQL2 ==       ||12335  |                                '== SQL2 ==       
12364  |                                sSql = ""         ||12336  |                                sSql = ""         
12365  |                                sSql = sSql & "SEL||12337  |                                sSql = sSql & "SEL
12366  |                                sSql = sSql & "FRO||12338  |                                sSql = sSql & "FRO
12367  |                                sSql = sSql & "(SE||12339  |                                sSql = sSql & "(SE
12368  |                                sSql = sSql & "WHE||12340  |                                sSql = sSql & "WHE
12369  |                                                  ||12341  |                                                  
12370  |                                'ﾀﾞｲﾅｾｯﾄの作成    ||12342  |                                'ﾀﾞｲﾅｾｯﾄの作成    
12371  |                                If gintDyCreate(sS||12343  |                                If gintDyCreate(sS
12372  |                                    Exit Function ||12344  |                                    Exit Function 
12373  |                                Else              ||12345  |                                Else              
12374  |                                    ddblNearNav = ||12346  |                                    ddblNearNav = 
12375  |'2008/03/06 START 時価総額基準の外部委託顧問料対応||12347  |'2008/03/06 START 時価総額基準の外部委託顧問料対応
12376  |'                                    '翌営業日の計||12348  |'                                    '翌営業日の計
12377  |'                                    '== SQL3 ==  ||12349  |'                                    '== SQL3 ==  
12378  |'                                    sSql = ""    ||12350  |'                                    sSql = ""    
12379  |'                                    sSql = sSql &||12351  |'                                    sSql = sSql &
12380  |'                                    sSql = sSql &||12352  |'                                    sSql = sSql &
12381  |'                                    sSql = sSql &||12353  |'                                    sSql = sSql &
12382  |'                                    sSql = sSql &||12354  |'                                    sSql = sSql &
12383  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||12355  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
12384  |'                                    If gintDyCrea||12356  |'                                    If gintDyCrea
12385  |'                                        Exit Func||12357  |'                                        Exit Func
12386  |'                                    Else         ||12358  |'                                    Else         
12387  |'                                        '計算開始||12359  |'                                        '計算開始
12388  |'                                        sStart = ||12360  |'                                        sStart = 
12389  |'                                        dStart = ||12361  |'                                        dStart = 
12390  |'                                        .Cells(15||12362  |'                                        .Cells(15
12391  |'                                            CStr(||12363  |'                                            CStr(
12392  |'                                        iCalcNum ||12364  |'                                        iCalcNum 
12393  |'                                    End If       ||12365  |'                                    End If       
12394  |'2008/03/06 END   時価総額基準の外部委託顧問料対応||12366  |'2008/03/06 END   時価総額基準の外部委託顧問料対応
12395  |                                End If            ||12367  |                                End If            
12396  |                                'RAFI対応 START   ||12368  |                                'RAFI対応 START   
12397  |                                '翌営業日のマザー ||12369  |                                '翌営業日のマザー 
12398  |                                If msAssetFlg = "1||12370  |                                If msAssetFlg = "1
12399  |                                    '== SQL4 ==   ||12371  |                                    '== SQL4 ==   
12400  |                                    sSql = ""     ||12372  |                                    sSql = ""     
12401  |                                    sSql = sSql & ||12373  |                                    sSql = sSql & 
12402  |                                    sSql = sSql & ||12374  |                                    sSql = sSql & 
12403  |                                    sSql = sSql & ||12375  |                                    sSql = sSql & 
12404  |                                    sSql = sSql & ||12376  |                                    sSql = sSql & 
12405  |                                    sSql = sSql & ||12377  |                                    sSql = sSql & 
12406  |                                    sSql = sSql & ||12378  |                                    sSql = sSql & 
12407  |                                    sSql = sSql & ||12379  |                                    sSql = sSql & 
12408  |                                    sSql = sSql & ||12380  |                                    sSql = sSql & 
12409  |                                    sSql = sSql & ||12381  |                                    sSql = sSql & 
12410  |                                    sSql = sSql & ||12382  |                                    sSql = sSql & 
12411  |                                    sSql = sSql & ||12383  |                                    sSql = sSql & 
12412  |                                    sSql = sSql & ||12384  |                                    sSql = sSql & 
12413  |                                    sSql = sSql & ||12385  |                                    sSql = sSql & 
12414  |                                    sSql = sSql & ||12386  |                                    sSql = sSql & 
12415  |                                    sSql = sSql & ||12387  |                                    sSql = sSql & 
12416  |                                    sSql = sSql & ||12388  |                                    sSql = sSql & 
12417  |                                    sSql = sSql & ||12389  |                                    sSql = sSql & 
12418  |                                    sSql = sSql & ||12390  |                                    sSql = sSql & 
12419  |                                    sSql = sSql & ||12391  |                                    sSql = sSql & 
12420  |                                    sSql = sSql & ||12392  |                                    sSql = sSql & 
12421  |                                    sSql = sSql & ||12393  |                                    sSql = sSql & 
12422  |                                    sSql = sSql & ||12394  |                                    sSql = sSql & 
12423  |                                    sSql = sSql & ||12395  |                                    sSql = sSql & 
12424  |                                    sSql = sSql & ||12396  |                                    sSql = sSql & 
12425  |                                                  ||12397  |                                                  
12426  |                                    'ﾀﾞｲﾅｾｯﾄの作成||12398  |                                    'ﾀﾞｲﾅｾｯﾄの作成
12427  |                                                  ||12399  |                                                  
12428  |                                    If gintDyCreat||12400  |                                    If gintDyCreat
12429  |                                        Exit Funct||12401  |                                        Exit Funct
12430  |                                    Else          ||12402  |                                    Else          
12431  |                                        ddblNearBa||12403  |                                        ddblNearBa
12432  |                                    End If        ||12404  |                                    End If        
12433  |                                End If            ||12405  |                                End If            
12434  |                                'RAFI対応 END     ||12406  |                                'RAFI対応 END     
12435  |                            End If                ||12407  |                            End If                
12436  |                        End If                    ||12408  |                        End If                    
12437  |                    End If                        ||12409  |                    End If                        
12438  |                    '計算開始日から計算終了日まで ||12410  |                    '計算開始日から計算終了日まで 
12439  |                    '== SQL5 ==                   ||12411  |                    '== SQL5 ==                   
12440  |                    sSql = ""                     ||12412  |                    sSql = ""                     
12441  |                    sSql = sSql & "SELECT CAL_YYYY||12413  |                    sSql = sSql & "SELECT CAL_YYYY
12442  |                    sSql = sSql & "WHERE CAL_YYYY ||12414  |                    sSql = sSql & "WHERE CAL_YYYY 
12443  |                                                  ||12415  |                                                  
12444  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||12416  |                    'ﾀﾞｲﾅｾｯﾄの作成                
12445  |                    If gintDyCreate(sSql) = False ||12417  |                    If gintDyCreate(sSql) = False 
12446  |                        Exit Function             ||12418  |                        Exit Function             
12447  |                    End If                        ||12419  |                    End If                        
12448  |                                                  ||12420  |                                                  
12449  |                    If dlngCnt = 0 Then           ||12421  |                    If dlngCnt = 0 Then           
12450  |                        ReDim dstrCaldate(gbxOraDy||12422  |                        ReDim dstrCaldate(gbxOraDy
12451  |                        ReDim ddblDailynav(gbxOraD||12423  |                        ReDim ddblDailynav(gbxOraD
12452  |                    End If                        ||12424  |                    End If                        
12453  |                                                  ||12425  |                                                  
12454  |                    'EOF判定処理                  ||12426  |                    'EOF判定処理                  
12455  |                    dlngCnt = 0                   ||12427  |                    dlngCnt = 0                   
12456  |                                                  ||12428  |                                                  
12457  |                    Do Until gblnDyEOF()          ||12429  |                    Do Until gblnDyEOF()          
12458  |                        dlngCnt = dlngCnt + 1     ||12430  |                        dlngCnt = dlngCnt + 1     
12459  |                        '抽出データセット         ||12431  |                        '抽出データセット         
12460  |                        dstrCaldate(dlngCnt) = gvl||12432  |                        dstrCaldate(dlngCnt) = gvl
12461  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||12433  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
12462  |                        Call gDyNext              ||12434  |                        Call gDyNext              
12463  |                    Loop                          ||12435  |                    Loop                          
12464  |                                                  ||12436  |                                                  
12465  |                                                  ||12437  |                                                  
12466  |                    '2005/08/26　START            ||12438  |                    '2005/08/26　START            
12467  |                    '変数sStartに格納されている日 ||12439  |                    '変数sStartに格納されている日 
12468  |                    '変数sStartの直近の営業日の日 ||12440  |                    '変数sStartの直近の営業日の日 
12469  |                    '（変数sStartに格納されている ||12441  |                    '（変数sStartに格納されている 
12470  |                    '　直近日付が存在しない場合は ||12442  |                    '　直近日付が存在しない場合は 
12471  |                                                  ||12443  |                                                  
12472  |                    '計算開始日の日次時価総額基準 ||12444  |                    '計算開始日の日次時価総額基準 
12473  |                    '== SQL6 ==                   ||12445  |                    '== SQL6 ==                   
12474  |                    sSql = ""                     ||12446  |                    sSql = ""                     
12475  |                    sSql = sSql & "SELECT MAX(BASE||12447  |                    sSql = sSql & "SELECT MAX(BASE
12476  |                    sSql = sSql & "FROM   CFR_DAIL||12448  |                    sSql = sSql & "FROM   CFR_DAIL
12477  |                    sSql = sSql & "WHERE  BASE_DAT||12449  |                    sSql = sSql & "WHERE  BASE_DAT
12478  |                    sSql = sSql & "AND    ACCOUNT_||12450  |                    sSql = sSql & "AND    ACCOUNT_
12479  |                                                  ||12451  |                                                  
12480  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||12452  |                    'ﾀﾞｲﾅｾｯﾄの作成                
12481  |                    If gintDyCreate(sSql) = False ||12453  |                    If gintDyCreate(sSql) = False 
12482  |                        Exit Function             ||12454  |                        Exit Function             
12483  |                    End If                        ||12455  |                    End If                        
12484  |                                                  ||12456  |                                                  
12485  |                    Do Until gblnDyEOF()          ||12457  |                    Do Until gblnDyEOF()          
12486  |                       '抽出データセット          ||12458  |                       '抽出データセット          
12487  |                        sStart = gvlnDyDataS("BASE||12459  |                        sStart = gvlnDyDataS("BASE
12488  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||12460  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
12489  |                        Call gDyNext              ||12461  |                        Call gDyNext              
12490  |                    Loop                          ||12462  |                    Loop                          
12491  |                                                  ||12463  |                                                  
12492  |                    'RAFI対応 START               ||12464  |                    'RAFI対応 START               
12493  |                    '純資産の場合                 ||12465  |                    '純資産の場合                 
12494  |                    If msAssetFlg = "0" Then      ||12466  |                    If msAssetFlg = "0" Then      
12495  |                        '計算開始日から計算終了日 ||12467  |                        '計算開始日から計算終了日 
12496  |                        '== SQL7 ==               ||12468  |                        '== SQL7 ==               
12497  |                        sSql = ""                 ||12469  |                        sSql = ""                 
12498  |                        sSql = sSql & "SELECT ACCO||12470  |                        sSql = sSql & "SELECT ACCO
12499  |                        sSql = sSql & "WHERE CFR_D||12471  |                        sSql = sSql & "WHERE CFR_D
12500  |                        sSql = sSql & "AND   (CFR_||12472  |                        sSql = sSql & "AND   (CFR_
12501  |                        sSql = sSql & "ORDER BY CF||12473  |                        sSql = sSql & "ORDER BY CF
12502  |                    'マザー組入資産の場合         ||12474  |                    'マザー組入資産の場合         
12503  |                    Else                          ||12475  |                    Else                          
12504  |                        '計算開始日から計算終了日 ||12476  |                        '計算開始日から計算終了日 
12505  |                        '== SQL8 ==               ||12477  |                        '== SQL8 ==               
12506  |                        sSql = ""                 ||12478  |                        sSql = ""                 
12507  |                        sSql = sSql & "SELECT"    ||12479  |                        sSql = sSql & "SELECT"    
12508  |                        sSql = sSql & "    a.ACCOU||12480  |                        sSql = sSql & "    a.ACCOU
12509  |                        sSql = sSql & "    a.BASE_||12481  |                        sSql = sSql & "    a.BASE_
12510  |                        sSql = sSql & "    a.MARKE||12482  |                        sSql = sSql & "    a.MARKE
12511  |                        sSql = sSql & "    b.BABY_||12483  |                        sSql = sSql & "    b.BABY_
12512  |                        sSql = sSql & "    b.BABY_||12484  |                        sSql = sSql & "    b.BABY_
12513  |                        sSql = sSql & " FROM"     ||12485  |                        sSql = sSql & " FROM"     
12514  |                        sSql = sSql & "    CFR_DAI||12486  |                        sSql = sSql & "    CFR_DAI
12515  |                        sSql = sSql & " WHERE"    ||12487  |                        sSql = sSql & " WHERE"    
12516  |                        sSql = sSql & "    b.BABY_||12488  |                        sSql = sSql & "    b.BABY_
12517  |                        sSql = sSql & "    b.MOTHE||12489  |                        sSql = sSql & "    b.MOTHE
12518  |                        sSql = sSql & "    b.BASE_||12490  |                        sSql = sSql & "    b.BASE_
12519  |                        sSql = sSql & "    a.ACCOU||12491  |                        sSql = sSql & "    a.ACCOU
12520  |                        sSql = sSql & "    (a.BASE||12492  |                        sSql = sSql & "    (a.BASE
12521  |                        sSql = sSql & "    a.BASE_||12493  |                        sSql = sSql & "    a.BASE_
12522  |                        sSql = sSql & " ORDER BY" ||12494  |                        sSql = sSql & " ORDER BY" 
12523  |                        sSql = sSql & "    a.BASE_||12495  |                        sSql = sSql & "    a.BASE_
12524  |                    End If                        ||12496  |                    End If                        
12525  |                    'RAFI対応 END                 ||12497  |                    'RAFI対応 END                 
12526  |                                                  ||12498  |                                                  
12527  |                    If gintDyCreate(sSql) = False ||12499  |                    If gintDyCreate(sSql) = False 
12528  |                        Exit Function             ||12500  |                        Exit Function             
12529  |                    End If                        ||12501  |                    End If                        
12530  |                                                  ||12502  |                                                  
12531  |                    dlngCntsv = dlngCnt           ||12503  |                    dlngCntsv = dlngCnt           
12532  |                    dlngCnt = 0                   ||12504  |                    dlngCnt = 0                   
12533  |                                                  ||12505  |                                                  
12534  |                    Do Until gblnDyEOF()          ||12506  |                    Do Until gblnDyEOF()          
12535  |                        dlngCnt = dlngCnt + 1     ||12507  |                        dlngCnt = dlngCnt + 1     
12536  |                        '抽出データセット         ||12508  |                        '抽出データセット         
12537  |                        dstrBasedate = gvlnDyDataS||12509  |                        dstrBasedate = gvlnDyDataS
12538  |                        If Mid(dstrCaldate(dlngCnt||12510  |                        If Mid(dstrCaldate(dlngCnt
12539  |                            'RAFI対応 START       ||12511  |                            'RAFI対応 START       
12540  |                            '純資産の場合         ||12512  |                            '純資産の場合         
12541  |                            If msAssetFlg = "0" Th||12513  |                            If msAssetFlg = "0" Th
12542  |                                ddblDailynav(dlngC||12514  |                                ddblDailynav(dlngC
12543  |                            'マザー組入資産の場合 ||12515  |                            'マザー組入資産の場合 
12544  |                            Else                  ||12516  |                            Else                  
12545  |                                ddblDailynav(dlngC||12517  |                                ddblDailynav(dlngC
12546  |                            End If                ||12518  |                            End If                
12547  |                            'RAFI対応 END         ||12519  |                            'RAFI対応 END         
12548  |                        Else                      ||12520  |                        Else                      
12549  |                            '計算開始日が外部委託 ||12521  |                            '計算開始日が外部委託 
12550  |                            If ddblNearNav <> 0 An||12522  |                            If ddblNearNav <> 0 An
12551  |                                dstrCaldate2 = Mid||12523  |                                dstrCaldate2 = Mid
12552  |                                dstrBasedate2 = Mi||12524  |                                dstrBasedate2 = Mi
12553  |                                dlngDiffdate = Dat||12525  |                                dlngDiffdate = Dat
12554  |                                                  ||12526  |                                                  
12555  |                                For dintFor2 = 1 T||12527  |                                For dintFor2 = 1 T
12556  |                                    'RAFI対応 STAR||12528  |                                    'RAFI対応 STAR
12557  |                                    '純資産の場合 ||12529  |                                    '純資産の場合 
12558  |                                    If msAssetFlg ||12530  |                                    If msAssetFlg 
12559  |                                        ddblDailyn||12531  |                                        ddblDailyn
12560  |                                    'マザー組入資 ||12532  |                                    'マザー組入資 
12561  |                                    Else          ||12533  |                                    Else          
12562  |                                        ddblDailyn||12534  |                                        ddblDailyn
12563  |                                    End If        ||12535  |                                    End If        
12564  |                                    'RAFI対応 END ||12536  |                                    'RAFI対応 END 
12565  |                                    dlngCnt = dlng||12537  |                                    dlngCnt = dlng
12566  |                                Next dintFor2     ||12538  |                                Next dintFor2     
12567  |                                'RAFI対応 START   ||12539  |                                'RAFI対応 START   
12568  |                                '純資産の場合     ||12540  |                                '純資産の場合     
12569  |                                If msAssetFlg = "0||12541  |                                If msAssetFlg = "0
12570  |                                    ddblDailynav(d||12542  |                                    ddblDailynav(d
12571  |                                'マザー組入資産の ||12543  |                                'マザー組入資産の 
12572  |                                Else              ||12544  |                                Else              
12573  |                                    ddblDailynav(d||12545  |                                    ddblDailynav(d
12574  |                                End If            ||12546  |                                End If            
12575  |                                'RAFI対応 END     ||12547  |                                'RAFI対応 END     
12576  |                            Else                  ||12548  |                            Else                  
12577  |                                '日次NAVにデータが||12549  |                                '日次NAVにデータが
12578  |                                dstrCaldate2 = Mid||12550  |                                dstrCaldate2 = Mid
12579  |                                dstrBasedate2 = Mi||12551  |                                dstrBasedate2 = Mi
12580  |                                dlngDiffdate = Dat||12552  |                                dlngDiffdate = Dat
12581  |                                                  ||12553  |                                                  
12582  |                                For dintFor2 = 1 T||12554  |                                For dintFor2 = 1 T
12583  |                                    If ddblDailyna||12555  |                                    If ddblDailyna
12584  |                                        ddblDailyn||12556  |                                        ddblDailyn
12585  |                                    Else          ||12557  |                                    Else          
12586  |                                        '日次NAVに||12558  |                                        '日次NAVに
12587  |                                        intRtn = M||12559  |                                        intRtn = M
12588  |                                        vbLf & "対||12560  |                                        vbLf & "対
12589  |                                        vbLf & "基||12561  |                                        vbLf & "基
12590  |                                            vbCrit||12562  |                                            vbCrit
12591  |                                        Exit Funct||12563  |                                        Exit Funct
12592  |                                    End If        ||12564  |                                    End If        
12593  |                                    dlngCnt = dlng||12565  |                                    dlngCnt = dlng
12594  |                                Next dintFor2     ||12566  |                                Next dintFor2     
12595  |                                'RAFI対応 START   ||12567  |                                'RAFI対応 START   
12596  |                                '純資産の場合     ||12568  |                                '純資産の場合     
12597  |                                If msAssetFlg = "0||12569  |                                If msAssetFlg = "0
12598  |                                    ddblDailynav(d||12570  |                                    ddblDailynav(d
12599  |                                'マザー組入資産の ||12571  |                                'マザー組入資産の 
12600  |                                Else              ||12572  |                                Else              
12601  |                                    ddblDailynav(d||12573  |                                    ddblDailynav(d
12602  |                                End If            ||12574  |                                End If            
12603  |                                'RAFI対応 END     ||12575  |                                'RAFI対応 END     
12604  |                            End If                ||12576  |                            End If                
12605  |                                                  ||12577  |                                                  
12606  |                        End If                    ||12578  |                        End If                    
12607  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||12579  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
12608  |                        Call gDyNext              ||12580  |                        Call gDyNext              
12609  |                    Loop                          ||12581  |                    Loop                          
12610  |                                                  ||12582  |                                                  
12611  |                Next dintFor                      ||12583  |                Next dintFor                      
12612  |                                                  ||12584  |                                                  
12613  |                If dlngCntsv <> dlngCnt Then      ||12585  |                If dlngCntsv <> dlngCnt Then      
12614  |                    For dintFor2 = dlngCnt + 1 To ||12586  |                    For dintFor2 = dlngCnt + 1 To 
12615  |                        ddblDailynav(dintFor2) = d||12587  |                        ddblDailynav(dintFor2) = d
12616  |                    Next dintFor2                 ||12588  |                    Next dintFor2                 
12617  |                    dlngCnt = dlngCntsv           ||12589  |                    dlngCnt = dlngCntsv           
12618  |                End If                            ||12590  |                End If                            
12619  |                                                  ||12591  |                                                  
12620  |                ddblTtalnav = 0                   ||12592  |                ddblTtalnav = 0                   
12621  |                                                  ||12593  |                                                  
12622  |                For dintFor2 = 1 To dlngCnt       ||12594  |                For dintFor2 = 1 To dlngCnt       
12623  |                    ddblTtalnav = ddblTtalnav + dd||12595  |                    ddblTtalnav = ddblTtalnav + dd
12624  |                Next dintFor2                     ||12596  |                Next dintFor2                     
12625  |                                                  ||12597  |                                                  
12626  |                iRowCnt = dlngCnt                 ||12598  |                iRowCnt = dlngCnt                 
12627  |                TotalNav = ddblTtalnav            ||12599  |                TotalNav = ddblTtalnav            
12628  |                dblValueIn = TotalNav             ||12600  |                dblValueIn = TotalNav             
12629  |                Call sbGetRoundValue2(dblValueIn) ||12601  |                Call sbGetRoundValue2(dblValueIn) 
12630  |                TotalNav = dblValueOut            ||12602  |                TotalNav = dblValueOut            
12631  |                '合計(月末純資産)                 ||12603  |                '合計(月末純資産)                 
12632  |                .Cells(17, 23).NumberFormatLocal =||12604  |                .Cells(17, 23).NumberFormatLocal =
12633  |                .Cells(17, 23).Value = CStr(Format||12605  |                .Cells(17, 23).Value = CStr(Format
12634  |                .Cells(17, 23).HorizontalAlignment||12606  |                .Cells(17, 23).HorizontalAlignment
12635  |                '平均純資産総額                   ||12607  |                '平均純資産総額                   
12636  |                .Cells(36, 2).Value = sWord51     ||12608  |                .Cells(36, 2).Value = sWord51     
12637  |                .Cells(36, 11).Value = sWord19    ||12609  |                .Cells(36, 11).Value = sWord19    
12638  |                '計算期間の純資産総額の合計(月末純||12610  |                '計算期間の純資産総額の合計(月末純
12639  |                .Cells(36, 23).NumberFormatLocal =||12611  |                .Cells(36, 23).NumberFormatLocal =
12640  |                .Cells(36, 23).Value = CStr(Format||12612  |                .Cells(36, 23).Value = CStr(Format
12641  |                .Cells(36, 23).HorizontalAlignment||12613  |                .Cells(36, 23).HorizontalAlignment
12642  |                '計算期間の純資産総額の合計÷計算 ||12614  |                '計算期間の純資産総額の合計÷計算 
12643  |                .Cells(36, 35).NumberFormatLocal =||12615  |                .Cells(36, 35).NumberFormatLocal =
12644  |                dblValueIn = TotalNav / iRowCnt   ||12616  |                dblValueIn = TotalNav / iRowCnt   
12645  |                Call sbGetRoundValue(dblValueIn)  ||12617  |                Call sbGetRoundValue(dblValueIn)  
12646  |                .Cells(36, 35).Value = CStr(Format||12618  |                .Cells(36, 35).Value = CStr(Format
12647  |                AvgNav = dblValueOut              ||12619  |                AvgNav = dblValueOut              
12648  |                '÷??＝ ,文言                     ||12620  |                '÷??＝ ,文言                     
12649  |                .Cells(36, 26).Value = sWord18 & "||12621  |                .Cells(36, 26).Value = sWord18 & "
12650  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||12622  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
12651  |                                                  ||12623  |                                                  
12652  |            Else                                  ||12624  |            Else                                  
12653  |'取得NAV区分[1]以外(取得NAV区分='2')              ||12625  |'取得NAV区分[1]以外(取得NAV区分='2')              
12654  |                ddblTtalnav = 0                   ||12626  |                ddblTtalnav = 0                   
12655  |                For dintFor = 0 To NavGetCnt - 1  ||12627  |                For dintFor = 0 To NavGetCnt - 1  
12656  |                                                  ||12628  |                                                  
12657  |                    '日次NAV平均取得              ||12629  |                    '日次NAV平均取得              
12658  |                    sStart = gstrDateFormat2(CStr(||12630  |                    sStart = gstrDateFormat2(CStr(
12659  |                    sEnd = gstrDateFormat2(CStr(dE||12631  |                    sEnd = gstrDateFormat2(CStr(dE
12660  |                                                  ||12632  |                                                  
12661  |                    '計算開始日と外部委託顧問料計 ||12633  |                    '計算開始日と外部委託顧問料計 
12662  |                    If sStart = gbuMGetUPDRec.N(lR||12634  |                    If sStart = gbuMGetUPDRec.N(lR
12663  |                        '== SQL1 ==               ||12635  |                        '== SQL1 ==               
12664  |                        sSql = ""                 ||12636  |                        sSql = ""                 
12665  |                        sSql = sSql & "SELECT EIGY||12637  |                        sSql = sSql & "SELECT EIGY
12666  |                                                  ||12638  |                                                  
12667  |                        'ﾀﾞｲﾅｾｯﾄの作成            ||12639  |                        'ﾀﾞｲﾅｾｯﾄの作成            
12668  |                        If gintDyCreate(sSql) = Fa||12640  |                        If gintDyCreate(sSql) = Fa
12669  |                            Exit Function         ||12641  |                            Exit Function         
12670  |                        Else                      ||12642  |                        Else                      
12671  |                            '計算開始日が休日の場 ||12643  |                            '計算開始日が休日の場 
12672  |                            If gvlnDyDataS("EIGYO_||12644  |                            If gvlnDyDataS("EIGYO_
12673  |                                '翌営業日のNAVを取||12645  |                                '翌営業日のNAVを取
12674  |                                '== SQL2 ==       ||12646  |                                '== SQL2 ==       
12675  |                                sSql = ""         ||12647  |                                sSql = ""         
12676  |                                sSql = sSql & "SEL||12648  |                                sSql = sSql & "SEL
12677  |                                sSql = sSql & "FRO||12649  |                                sSql = sSql & "FRO
12678  |                                sSql = sSql & "(SE||12650  |                                sSql = sSql & "(SE
12679  |                                sSql = sSql & "WHE||12651  |                                sSql = sSql & "WHE
12680  |                                                  ||12652  |                                                  
12681  |                                'ﾀﾞｲﾅｾｯﾄの作成    ||12653  |                                'ﾀﾞｲﾅｾｯﾄの作成    
12682  |                                If gintDyCreate(sS||12654  |                                If gintDyCreate(sS
12683  |                                    Exit Function ||12655  |                                    Exit Function 
12684  |                                Else              ||12656  |                                Else              
12685  |                                    ddblNearNav = ||12657  |                                    ddblNearNav = 
12686  |'2008/03/06 START 時価総額基準の外部委託顧問料対応||12658  |'2008/03/06 START 時価総額基準の外部委託顧問料対応
12687  |'                                    '翌営業日の計||12659  |'                                    '翌営業日の計
12688  |'                                    '== SQL3 ==  ||12660  |'                                    '== SQL3 ==  
12689  |'                                    sSql = ""    ||12661  |'                                    sSql = ""    
12690  |'                                    sSql = sSql &||12662  |'                                    sSql = sSql &
12691  |'                                    sSql = sSql &||12663  |'                                    sSql = sSql &
12692  |'                                    sSql = sSql &||12664  |'                                    sSql = sSql &
12693  |'                                    sSql = sSql &||12665  |'                                    sSql = sSql &
12694  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||12666  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
12695  |'                                    If gintDyCrea||12667  |'                                    If gintDyCrea
12696  |'                                        Exit Func||12668  |'                                        Exit Func
12697  |'                                    Else         ||12669  |'                                    Else         
12698  |'                                        '計算開始||12670  |'                                        '計算開始
12699  |'                                        sStart = ||12671  |'                                        sStart = 
12700  |'                                        dStart = ||12672  |'                                        dStart = 
12701  |'                                        .Cells(15||12673  |'                                        .Cells(15
12702  |'                                            CStr(||12674  |'                                            CStr(
12703  |'                                        iCalcNum ||12675  |'                                        iCalcNum 
12704  |'                                    End If       ||12676  |'                                    End If       
12705  |'2008/03/06 END   時価総額基準の外部委託顧問料対応||12677  |'2008/03/06 END   時価総額基準の外部委託顧問料対応
12706  |                                End If            ||12678  |                                End If            
12707  |                                'RAFI対応 START   ||12679  |                                'RAFI対応 START   
12708  |                                '翌営業日のマザー ||12680  |                                '翌営業日のマザー 
12709  |                                If msAssetFlg = "1||12681  |                                If msAssetFlg = "1
12710  |                                    '== SQL4 ==   ||12682  |                                    '== SQL4 ==   
12711  |                                    sSql = ""     ||12683  |                                    sSql = ""     
12712  |                                    sSql = sSql & ||12684  |                                    sSql = sSql & 
12713  |                                    sSql = sSql & ||12685  |                                    sSql = sSql & 
12714  |                                    sSql = sSql & ||12686  |                                    sSql = sSql & 
12715  |                                    sSql = sSql & ||12687  |                                    sSql = sSql & 
12716  |                                    sSql = sSql & ||12688  |                                    sSql = sSql & 
12717  |                                    sSql = sSql & ||12689  |                                    sSql = sSql & 
12718  |                                    sSql = sSql & ||12690  |                                    sSql = sSql & 
12719  |                                    sSql = sSql & ||12691  |                                    sSql = sSql & 
12720  |                                    sSql = sSql & ||12692  |                                    sSql = sSql & 
12721  |                                    sSql = sSql & ||12693  |                                    sSql = sSql & 
12722  |                                    sSql = sSql & ||12694  |                                    sSql = sSql & 
12723  |                                    sSql = sSql & ||12695  |                                    sSql = sSql & 
12724  |                                    sSql = sSql & ||12696  |                                    sSql = sSql & 
12725  |                                    sSql = sSql & ||12697  |                                    sSql = sSql & 
12726  |                                    sSql = sSql & ||12698  |                                    sSql = sSql & 
12727  |                                    sSql = sSql & ||12699  |                                    sSql = sSql & 
12728  |                                    sSql = sSql & ||12700  |                                    sSql = sSql & 
12729  |                                    sSql = sSql & ||12701  |                                    sSql = sSql & 
12730  |                                    sSql = sSql & ||12702  |                                    sSql = sSql & 
12731  |                                    sSql = sSql & ||12703  |                                    sSql = sSql & 
12732  |                                    sSql = sSql & ||12704  |                                    sSql = sSql & 
12733  |                                    sSql = sSql & ||12705  |                                    sSql = sSql & 
12734  |                                    sSql = sSql & ||12706  |                                    sSql = sSql & 
12735  |                                    sSql = sSql & ||12707  |                                    sSql = sSql & 
12736  |                                    'ﾀﾞｲﾅｾｯﾄの作成||12708  |                                    'ﾀﾞｲﾅｾｯﾄの作成
12737  |                                                  ||12709  |                                                  
12738  |                                    If gintDyCreat||12710  |                                    If gintDyCreat
12739  |                                        Exit Funct||12711  |                                        Exit Funct
12740  |                                    Else          ||12712  |                                    Else          
12741  |                                        ddblNearBa||12713  |                                        ddblNearBa
12742  |                                    End If        ||12714  |                                    End If        
12743  |                                End If            ||12715  |                                End If            
12744  |                                'RAFI対応 END     ||12716  |                                'RAFI対応 END     
12745  |                            End If                ||12717  |                            End If                
12746  |                        End If                    ||12718  |                        End If                    
12747  |                    End If                        ||12719  |                    End If                        
12748  |                    '計算開始日から計算終了日まで ||12720  |                    '計算開始日から計算終了日まで 
12749  |                    '== SQL5 ==                   ||12721  |                    '== SQL5 ==                   
12750  |                    sSql = ""                     ||12722  |                    sSql = ""                     
12751  |                    sSql = sSql & "SELECT CAL_YYYY||12723  |                    sSql = sSql & "SELECT CAL_YYYY
12752  |                    sSql = sSql & "WHERE CAL_YYYY ||12724  |                    sSql = sSql & "WHERE CAL_YYYY 
12753  |                                                  ||12725  |                                                  
12754  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||12726  |                    'ﾀﾞｲﾅｾｯﾄの作成                
12755  |                    If gintDyCreate(sSql) = False ||12727  |                    If gintDyCreate(sSql) = False 
12756  |                        Exit Function             ||12728  |                        Exit Function             
12757  |                    End If                        ||12729  |                    End If                        
12758  |                                                  ||12730  |                                                  
12759  |                    If dlngCnt = 0 Then           ||12731  |                    If dlngCnt = 0 Then           
12760  |                        ReDim dstrCaldate(gbxOraDy||12732  |                        ReDim dstrCaldate(gbxOraDy
12761  |                        ReDim ddblDailynav(gbxOraD||12733  |                        ReDim ddblDailynav(gbxOraD
12762  |                    End If                        ||12734  |                    End If                        
12763  |                                                  ||12735  |                                                  
12764  |                    'EOF判定処理                  ||12736  |                    'EOF判定処理                  
12765  |                    dlngCnt = 0                   ||12737  |                    dlngCnt = 0                   
12766  |                                                  ||12738  |                                                  
12767  |                    Do Until gblnDyEOF()          ||12739  |                    Do Until gblnDyEOF()          
12768  |                        dlngCnt = dlngCnt + 1     ||12740  |                        dlngCnt = dlngCnt + 1     
12769  |                        '抽出データセット         ||12741  |                        '抽出データセット         
12770  |                        dstrCaldate(dlngCnt) = gvl||12742  |                        dstrCaldate(dlngCnt) = gvl
12771  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||12743  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
12772  |                        Call gDyNext              ||12744  |                        Call gDyNext              
12773  |                    Loop                          ||12745  |                    Loop                          
12774  |                                                  ||12746  |                                                  
12775  |                                                  ||12747  |                                                  
12776  |                    '2005/08/26　START            ||12748  |                    '2005/08/26　START            
12777  |                    '変数sStartに格納されている日 ||12749  |                    '変数sStartに格納されている日 
12778  |                    '変数sStartの直近の営業日の日 ||12750  |                    '変数sStartの直近の営業日の日 
12779  |                    '（変数sStartに格納されている ||12751  |                    '（変数sStartに格納されている 
12780  |                    '　直近日付が存在しない場合は ||12752  |                    '　直近日付が存在しない場合は 
12781  |                                                  ||12753  |                                                  
12782  |                    '計算開始日の日次NAV基準日を取||12754  |                    '計算開始日の日次NAV基準日を取
12783  |                    '== SQL6 ==                   ||12755  |                    '== SQL6 ==                   
12784  |                    sSql = ""                     ||12756  |                    sSql = ""                     
12785  |                    sSql = sSql & "SELECT MAX(BASE||12757  |                    sSql = sSql & "SELECT MAX(BASE
12786  |                    sSql = sSql & "FROM   CFR_DAIL||12758  |                    sSql = sSql & "FROM   CFR_DAIL
12787  |                    sSql = sSql & "WHERE  BASE_DAT||12759  |                    sSql = sSql & "WHERE  BASE_DAT
12788  |                    sSql = sSql & "AND    ACCOUNT_||12760  |                    sSql = sSql & "AND    ACCOUNT_
12789  |                                                  ||12761  |                                                  
12790  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||12762  |                    'ﾀﾞｲﾅｾｯﾄの作成                
12791  |                    If gintDyCreate(sSql) = False ||12763  |                    If gintDyCreate(sSql) = False 
12792  |                        Exit Function             ||12764  |                        Exit Function             
12793  |                    End If                        ||12765  |                    End If                        
12794  |                                                  ||12766  |                                                  
12795  |                    Do Until gblnDyEOF()          ||12767  |                    Do Until gblnDyEOF()          
12796  |                       '抽出データセット          ||12768  |                       '抽出データセット          
12797  |                        sStart = gvlnDyDataS("BASE||12769  |                        sStart = gvlnDyDataS("BASE
12798  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||12770  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
12799  |                        Call gDyNext              ||12771  |                        Call gDyNext              
12800  |                    Loop                          ||12772  |                    Loop                          
12801  |                                                  ||12773  |                                                  
12802  |                    'RAFI対応 START               ||12774  |                    'RAFI対応 START               
12803  |                    '純資産の場合                 ||12775  |                    '純資産の場合                 
12804  |                    If msAssetFlg = "0" Then      ||12776  |                    If msAssetFlg = "0" Then      
12805  |                        '計算開始日から計算終了日 ||12777  |                        '計算開始日から計算終了日 
12806  |                        '== SQL7 ==               ||12778  |                        '== SQL7 ==               
12807  |                        sSql = ""                 ||12779  |                        sSql = ""                 
12808  |                        sSql = sSql & "SELECT ACCO||12780  |                        sSql = sSql & "SELECT ACCO
12809  |                        sSql = sSql & "WHERE (((CF||12781  |                        sSql = sSql & "WHERE (((CF
12810  |                        sSql = sSql & "AND ((CFR_D||12782  |                        sSql = sSql & "AND ((CFR_D
12811  |                        sSql = sSql & "AND ((CFR_D||12783  |                        sSql = sSql & "AND ((CFR_D
12812  |                        sSql = sSql & "ORDER BY CF||12784  |                        sSql = sSql & "ORDER BY CF
12813  |                    'マザー組入資産の場合         ||12785  |                    'マザー組入資産の場合         
12814  |                    Else                          ||12786  |                    Else                          
12815  |                        '計算開始日から計算終了日 ||12787  |                        '計算開始日から計算終了日 
12816  |                        '== SQL8 ==               ||12788  |                        '== SQL8 ==               
12817  |                        sSql = ""                 ||12789  |                        sSql = ""                 
12818  |                        sSql = sSql & "SELECT"    ||12790  |                        sSql = sSql & "SELECT"    
12819  |                        sSql = sSql & "    a.ACCOU||12791  |                        sSql = sSql & "    a.ACCOU
12820  |                        sSql = sSql & "    a.BASE_||12792  |                        sSql = sSql & "    a.BASE_
12821  |                        sSql = sSql & "    a.NET_A||12793  |                        sSql = sSql & "    a.NET_A
12822  |                        sSql = sSql & "    b.BABY_||12794  |                        sSql = sSql & "    b.BABY_
12823  |                        sSql = sSql & "    b.BABY_||12795  |                        sSql = sSql & "    b.BABY_
12824  |                        sSql = sSql & " FROM"     ||12796  |                        sSql = sSql & " FROM"     
12825  |                        sSql = sSql & "    CFR_DAI||12797  |                        sSql = sSql & "    CFR_DAI
12826  |                        sSql = sSql & " WHERE"    ||12798  |                        sSql = sSql & " WHERE"    
12827  |                        sSql = sSql & "    b.BABY_||12799  |                        sSql = sSql & "    b.BABY_
12828  |                        sSql = sSql & "    b.MOTHE||12800  |                        sSql = sSql & "    b.MOTHE
12829  |                        sSql = sSql & "    b.BASE_||12801  |                        sSql = sSql & "    b.BASE_
12830  |                        sSql = sSql & "    a.ACCOU||12802  |                        sSql = sSql & "    a.ACCOU
12831  |                        sSql = sSql & "    (a.BASE||12803  |                        sSql = sSql & "    (a.BASE
12832  |                        sSql = sSql & "    a.BASE_||12804  |                        sSql = sSql & "    a.BASE_
12833  |                        sSql = sSql & "    a.CURRE||12805  |                        sSql = sSql & "    a.CURRE
12834  |                        sSql = sSql & "    a.ASSET||12806  |                        sSql = sSql & "    a.ASSET
12835  |                        sSql = sSql & " ORDER BY" ||12807  |                        sSql = sSql & " ORDER BY" 
12836  |                        sSql = sSql & "    a.BASE_||12808  |                        sSql = sSql & "    a.BASE_
12837  |                    End If                        ||12809  |                    End If                        
12838  |                    'RAFI対応 END                 ||12810  |                    'RAFI対応 END                 
12839  |                                                  ||12811  |                                                  
12840  |                    If gintDyCreate(sSql) = False ||12812  |                    If gintDyCreate(sSql) = False 
12841  |                        Exit Function             ||12813  |                        Exit Function             
12842  |                    End If                        ||12814  |                    End If                        
12843  |                                                  ||12815  |                                                  
12844  |                    dlngCntsv = dlngCnt           ||12816  |                    dlngCntsv = dlngCnt           
12845  |                    dlngCnt = 0                   ||12817  |                    dlngCnt = 0                   
12846  |                                                  ||12818  |                                                  
12847  |                    Do Until gblnDyEOF()          ||12819  |                    Do Until gblnDyEOF()          
12848  |                        dlngCnt = dlngCnt + 1     ||12820  |                        dlngCnt = dlngCnt + 1     
12849  |                        '抽出データセット         ||12821  |                        '抽出データセット         
12850  |                        dstrBasedate = gvlnDyDataS||12822  |                        dstrBasedate = gvlnDyDataS
12851  |                        If Mid(dstrCaldate(dlngCnt||12823  |                        If Mid(dstrCaldate(dlngCnt
12852  |                            'RAFI対応 START       ||12824  |                            'RAFI対応 START       
12853  |                            '純資産の場合         ||12825  |                            '純資産の場合         
12854  |                            If msAssetFlg = "0" Th||12826  |                            If msAssetFlg = "0" Th
12855  |                                ddblDailynav(dlngC||12827  |                                ddblDailynav(dlngC
12856  |                            'マザー組入資産の場合 ||12828  |                            'マザー組入資産の場合 
12857  |                            Else                  ||12829  |                            Else                  
12858  |                                ddblDailynav(dlngC||12830  |                                ddblDailynav(dlngC
12859  |                            End If                ||12831  |                            End If                
12860  |                            'RAFI対応 END         ||12832  |                            'RAFI対応 END         
12861  |                        Else                      ||12833  |                        Else                      
12862  |                            '計算開始日が外部委託 ||12834  |                            '計算開始日が外部委託 
12863  |                            If ddblNearNav <> 0 An||12835  |                            If ddblNearNav <> 0 An
12864  |                                dstrCaldate2 = Mid||12836  |                                dstrCaldate2 = Mid
12865  |                                dstrBasedate2 = Mi||12837  |                                dstrBasedate2 = Mi
12866  |                                dlngDiffdate = Dat||12838  |                                dlngDiffdate = Dat
12867  |                                                  ||12839  |                                                  
12868  |                                For dintFor2 = 1 T||12840  |                                For dintFor2 = 1 T
12869  |                                    'RAFI対応 STAR||12841  |                                    'RAFI対応 STAR
12870  |                                    '純資産の場合 ||12842  |                                    '純資産の場合 
12871  |                                    If msAssetFlg ||12843  |                                    If msAssetFlg 
12872  |                                        ddblDailyn||12844  |                                        ddblDailyn
12873  |                                    'マザー組入資 ||12845  |                                    'マザー組入資 
12874  |                                    Else          ||12846  |                                    Else          
12875  |                                        ddblDailyn||12847  |                                        ddblDailyn
12876  |                                    End If        ||12848  |                                    End If        
12877  |                                    'RAFI対応 END ||12849  |                                    'RAFI対応 END 
12878  |                                    dlngCnt = dlng||12850  |                                    dlngCnt = dlng
12879  |                                Next dintFor2     ||12851  |                                Next dintFor2     
12880  |                                'RAFI対応 START   ||12852  |                                'RAFI対応 START   
12881  |                                '純資産の場合     ||12853  |                                '純資産の場合     
12882  |                                If msAssetFlg = "0||12854  |                                If msAssetFlg = "0
12883  |                                    ddblDailynav(d||12855  |                                    ddblDailynav(d
12884  |                                'マザー組入資産の ||12856  |                                'マザー組入資産の 
12885  |                                Else              ||12857  |                                Else              
12886  |                                    ddblDailynav(d||12858  |                                    ddblDailynav(d
12887  |                                End If            ||12859  |                                End If            
12888  |                                'RAFI対応 END     ||12860  |                                'RAFI対応 END     
12889  |                            Else                  ||12861  |                            Else                  
12890  |                                '日次NAVにデータが||12862  |                                '日次NAVにデータが
12891  |                                dstrCaldate2 = Mid||12863  |                                dstrCaldate2 = Mid
12892  |                                dstrBasedate2 = Mi||12864  |                                dstrBasedate2 = Mi
12893  |                                dlngDiffdate = Dat||12865  |                                dlngDiffdate = Dat
12894  |                                                  ||12866  |                                                  
12895  |                                For dintFor2 = 1 T||12867  |                                For dintFor2 = 1 T
12896  |                                    If ddblDailyna||12868  |                                    If ddblDailyna
12897  |                                        ddblDailyn||12869  |                                        ddblDailyn
12898  |                                    Else          ||12870  |                                    Else          
12899  |                                        '日次NAVに||12871  |                                        '日次NAVに
12900  |                                        intRtn = M||12872  |                                        intRtn = M
12901  |                                        vbLf & "対||12873  |                                        vbLf & "対
12902  |                                        vbLf & "基||12874  |                                        vbLf & "基
12903  |                                            vbCrit||12875  |                                            vbCrit
12904  |                                        Exit Funct||12876  |                                        Exit Funct
12905  |                                    End If        ||12877  |                                    End If        
12906  |                                    dlngCnt = dlng||12878  |                                    dlngCnt = dlng
12907  |                                Next dintFor2     ||12879  |                                Next dintFor2     
12908  |                                'RAFI対応 START   ||12880  |                                'RAFI対応 START   
12909  |                                '純資産の場合     ||12881  |                                '純資産の場合     
12910  |                                If msAssetFlg = "0||12882  |                                If msAssetFlg = "0
12911  |                                    ddblDailynav(d||12883  |                                    ddblDailynav(d
12912  |                                'マザー組入資産の ||12884  |                                'マザー組入資産の 
12913  |                                Else              ||12885  |                                Else              
12914  |                                    ddblDailynav(d||12886  |                                    ddblDailynav(d
12915  |                                End If            ||12887  |                                End If            
12916  |                                'RAFI対応 END     ||12888  |                                'RAFI対応 END     
12917  |                            End If                ||12889  |                            End If                
12918  |                                                  ||12890  |                                                  
12919  |                        End If                    ||12891  |                        End If                    
12920  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||12892  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
12921  |                        Call gDyNext              ||12893  |                        Call gDyNext              
12922  |                    Loop                          ||12894  |                    Loop                          
12923  |                                                  ||12895  |                                                  
12924  |                Next dintFor                      ||12896  |                Next dintFor                      
12925  |                                                  ||12897  |                                                  
12926  |                If dlngCntsv <> dlngCnt Then      ||12898  |                If dlngCntsv <> dlngCnt Then      
12927  |                    For dintFor2 = dlngCnt + 1 To ||12899  |                    For dintFor2 = dlngCnt + 1 To 
12928  |                        ddblDailynav(dintFor2) = d||12900  |                        ddblDailynav(dintFor2) = d
12929  |                    Next dintFor2                 ||12901  |                    Next dintFor2                 
12930  |                    dlngCnt = dlngCntsv           ||12902  |                    dlngCnt = dlngCntsv           
12931  |                End If                            ||12903  |                End If                            
12932  |                                                  ||12904  |                                                  
12933  |                ddblTtalnav = 0                   ||12905  |                ddblTtalnav = 0                   
12934  |                                                  ||12906  |                                                  
12935  |                For dintFor2 = 1 To dlngCnt       ||12907  |                For dintFor2 = 1 To dlngCnt       
12936  |                    ddblTtalnav = ddblTtalnav + dd||12908  |                    ddblTtalnav = ddblTtalnav + dd
12937  |                Next dintFor2                     ||12909  |                Next dintFor2                     
12938  |                                                  ||12910  |                                                  
12939  |                iRowCnt = dlngCnt                 ||12911  |                iRowCnt = dlngCnt                 
12940  |                TotalNav = ddblTtalnav            ||12912  |                TotalNav = ddblTtalnav            
12941  |                dblValueIn = TotalNav             ||12913  |                dblValueIn = TotalNav             
12942  |                Call sbGetRoundValue2(dblValueIn) ||12914  |                Call sbGetRoundValue2(dblValueIn) 
12943  |                TotalNav = dblValueOut            ||12915  |                TotalNav = dblValueOut            
12944  |                '合計(月末純資産)                 ||12916  |                '合計(月末純資産)                 
12945  |                .Cells(17, 23).NumberFormatLocal =||12917  |                .Cells(17, 23).NumberFormatLocal =
12946  |                    If gbuMGetUPDRec.N(lRecIdx).MG||12918  |                    If gbuMGetUPDRec.N(lRecIdx).MG
12947  |                        .Cells(17, 23).Value = CSt||12919  |                        .Cells(17, 23).Value = CSt
12948  |                    Else                          ||12920  |                    Else                          
12949  |                        .Cells(17, 23).Value = CSt||12921  |                        .Cells(17, 23).Value = CSt
12950  |                    End If                        ||12922  |                    End If                        
12951  |                .Cells(17, 23).HorizontalAlignment||12923  |                .Cells(17, 23).HorizontalAlignment
12952  |                '平均純資産総額                   ||12924  |                '平均純資産総額                   
12953  |                .Cells(36, 2).Value = sWord51     ||12925  |                .Cells(36, 2).Value = sWord51     
12954  |                .Cells(36, 11).Value = sWord19    ||12926  |                .Cells(36, 11).Value = sWord19    
12955  |                '計算期間の純資産総額の合計(月末純||12927  |                '計算期間の純資産総額の合計(月末純
12956  |                .Cells(36, 23).NumberFormatLocal =||12928  |                .Cells(36, 23).NumberFormatLocal =
12957  |                    If gbuMGetUPDRec.N(lRecIdx).MG||12929  |                    If gbuMGetUPDRec.N(lRecIdx).MG
12958  |                        .Cells(36, 23).Value = CSt||12930  |                        .Cells(36, 23).Value = CSt
12959  |                    Else                          ||12931  |                    Else                          
12960  |                        .Cells(36, 23).Value = CSt||12932  |                        .Cells(36, 23).Value = CSt
12961  |                    End If                        ||12933  |                    End If                        
12962  |                .Cells(36, 23).HorizontalAlignment||12934  |                .Cells(36, 23).HorizontalAlignment
12963  |                '計算期間の純資産総額の合計÷計算 ||12935  |                '計算期間の純資産総額の合計÷計算 
12964  |                .Cells(36, 35).NumberFormatLocal =||12936  |                .Cells(36, 35).NumberFormatLocal =
12965  |                dblValueIn = TotalNav / iRowCnt   ||12937  |                dblValueIn = TotalNav / iRowCnt   
12966  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||12938  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
12967  |                    Call sbGetRoundValue2(dblValue||12939  |                    Call sbGetRoundValue2(dblValue
12968  |                Else                              ||12940  |                Else                              
12969  |                    Call sbGetRoundValue(dblValueI||12941  |                    Call sbGetRoundValue(dblValueI
12970  |                End If                            ||12942  |                End If                            
12971  |                    If gbuMGetUPDRec.N(lRecIdx).MG||12943  |                    If gbuMGetUPDRec.N(lRecIdx).MG
12972  |                        .Cells(36, 35).Value = CSt||12944  |                        .Cells(36, 35).Value = CSt
12973  |                    Else                          ||12945  |                    Else                          
12974  |                        .Cells(36, 35).Value = CSt||12946  |                        .Cells(36, 35).Value = CSt
12975  |                    End If                        ||12947  |                    End If                        
12976  |                AvgNav = dblValueOut              ||12948  |                AvgNav = dblValueOut              
12977  |                '÷??＝ ,文言                     ||12949  |                '÷??＝ ,文言                     
12978  |                .Cells(36, 26).Value = sWord18 & "||12950  |                .Cells(36, 26).Value = sWord18 & "
12979  |            End If                                ||12951  |            End If                                
12980  |'契約区分：名称使用許諾料計算　かつ　日次NAV(休日 ||12952  |'契約区分：名称使用許諾料計算　かつ　日次NAV(休日 
12981  |        Else                                      ||12953  |        Else                                      
12982  |                                                  ||12954  |                                                  
12983  |On Error GoTo OnErrorProc                         ||12955  |On Error GoTo OnErrorProc                         
12984  |                                                  ||12956  |                                                  
12985  |            '契約区分「3」の場合                  ||12957  |            '契約区分「3」の場合                  
12986  |            ddblTtalnav = 0                       ||12958  |            ddblTtalnav = 0                       
12987  |            For dintFor = 0 To NavGetCnt - 1      ||12959  |            For dintFor = 0 To NavGetCnt - 1      
12988  |                '日次NAV平均取得                  ||12960  |                '日次NAV平均取得                  
12989  |                sStart = gstrDateFormat2(CStr(dSta||12961  |                sStart = gstrDateFormat2(CStr(dSta
12990  |                sEnd = gstrDateFormat2(CStr(dEnd),||12962  |                sEnd = gstrDateFormat2(CStr(dEnd),
12991  |                                                  ||12963  |                                                  
12992  |                'RAFI対応 START                   ||12964  |                'RAFI対応 START                   
12993  |                '純資産の場合                     ||12965  |                '純資産の場合                     
12994  |                If msAssetFlg = "0" Then          ||12966  |                If msAssetFlg = "0" Then          
12995  |                    '計算開始日から計算終了日まで ||12967  |                    '計算開始日から計算終了日まで 
12996  |                    sSql = ""                     ||12968  |                    sSql = ""                     
12997  |                    sSql = sSql & "SELECT ACCOUNT_||12969  |                    sSql = sSql & "SELECT ACCOUNT_
12998  |                    sSql = sSql & "WHERE (((CFR_DA||12970  |                    sSql = sSql & "WHERE (((CFR_DA
12999  |                    sSql = sSql & "AND ((CFR_DAILY||12971  |                    sSql = sSql & "AND ((CFR_DAILY
13000  |                    sSql = sSql & "AND ((CFR_DAILY||12972  |                    sSql = sSql & "AND ((CFR_DAILY
13001  |                    sSql = sSql & "ORDER BY CFR_DA||12973  |                    sSql = sSql & "ORDER BY CFR_DA
13002  |                'マザー組入資産の場合             ||12974  |                'マザー組入資産の場合             
13003  |                Else                              ||12975  |                Else                              
13004  |                    '計算開始日から計算終了日まで ||12976  |                    '計算開始日から計算終了日まで 
13005  |                    sSql = ""                     ||12977  |                    sSql = ""                     
13006  |                    sSql = sSql & "SELECT"        ||12978  |                    sSql = sSql & "SELECT"        
13007  |                    sSql = sSql & "    a.ACCOUNT_C||12979  |                    sSql = sSql & "    a.ACCOUNT_C
13008  |                    sSql = sSql & "    a.BASE_DATE||12980  |                    sSql = sSql & "    a.BASE_DATE
13009  |                    sSql = sSql & "    a.NET_ASSET||12981  |                    sSql = sSql & "    a.NET_ASSET
13010  |                    sSql = sSql & "    b.BABY_MOTH||12982  |                    sSql = sSql & "    b.BABY_MOTH
13011  |                    sSql = sSql & "    b.BABY_MOTH||12983  |                    sSql = sSql & "    b.BABY_MOTH
13012  |                    sSql = sSql & " FROM"         ||12984  |                    sSql = sSql & " FROM"         
13013  |                    sSql = sSql & "    CFR_DAILY_N||12985  |                    sSql = sSql & "    CFR_DAILY_N
13014  |                    sSql = sSql & " WHERE"        ||12986  |                    sSql = sSql & " WHERE"        
13015  |                    sSql = sSql & "    b.BABY_ACCO||12987  |                    sSql = sSql & "    b.BABY_ACCO
13016  |                    sSql = sSql & "    b.MOTHER_AC||12988  |                    sSql = sSql & "    b.MOTHER_AC
13017  |                    sSql = sSql & "    b.BASE_DATE||12989  |                    sSql = sSql & "    b.BASE_DATE
13018  |                    sSql = sSql & "    a.ACCOUNT_C||12990  |                    sSql = sSql & "    a.ACCOUNT_C
13019  |                    sSql = sSql & "    (a.BASE_DAT||12991  |                    sSql = sSql & "    (a.BASE_DAT
13020  |                    sSql = sSql & "    a.BASE_DATE||12992  |                    sSql = sSql & "    a.BASE_DATE
13021  |                    sSql = sSql & "    a.CURRENCY_||12993  |                    sSql = sSql & "    a.CURRENCY_
13022  |                    sSql = sSql & "    a.ASSET_TYP||12994  |                    sSql = sSql & "    a.ASSET_TYP
13023  |                    sSql = sSql & " ORDER BY"     ||12995  |                    sSql = sSql & " ORDER BY"     
13024  |                    sSql = sSql & "    a.BASE_DATE||12996  |                    sSql = sSql & "    a.BASE_DATE
13025  |                End If                            ||12997  |                End If                            
13026  |                'RAFI対応 END                     ||12998  |                'RAFI対応 END                     
13027  |                                                  ||12999  |                                                  
13028  |                If gintDyCreate(sSql) = False Then||13000  |                If gintDyCreate(sSql) = False Then
13029  |                    Exit Function                 ||13001  |                    Exit Function                 
13030  |                End If                            ||13002  |                End If                            
13031  |                                                  ||13003  |                                                  
13032  |                If dlngCnt = 0 Then               ||13004  |                If dlngCnt = 0 Then               
13033  |                    ReDim dstrCaldate(gbxOraDynase||13005  |                    ReDim dstrCaldate(gbxOraDynase
13034  |                    ReDim ddblDailynav(gbxOraDynas||13006  |                    ReDim ddblDailynav(gbxOraDynas
13035  |                End If                            ||13007  |                End If                            
13036  |                                                  ||13008  |                                                  
13037  |                dlngCnt = 0                       ||13009  |                dlngCnt = 0                       
13038  |                                                  ||13010  |                                                  
13039  |                Do Until gblnDyEOF()              ||13011  |                Do Until gblnDyEOF()              
13040  |                    dlngCnt = dlngCnt + 1         ||13012  |                    dlngCnt = dlngCnt + 1         
13041  |                    'RAFI対応 START               ||13013  |                    'RAFI対応 START               
13042  |                    '純資産の場合                 ||13014  |                    '純資産の場合                 
13043  |                    If msAssetFlg = "0" Then      ||13015  |                    If msAssetFlg = "0" Then      
13044  |                        '抽出データセット         ||13016  |                        '抽出データセット         
13045  |                        dstrCaldate(dlngCnt) = gvl||13017  |                        dstrCaldate(dlngCnt) = gvl
13046  |                        ddblDailynav(dlngCnt) = dd||13018  |                        ddblDailynav(dlngCnt) = dd
13047  |                    'マザー組入資産の場合         ||13019  |                    'マザー組入資産の場合         
13048  |                    Else                          ||13020  |                    Else                          
13049  |                        dstrCaldate(dlngCnt) = gvl||13021  |                        dstrCaldate(dlngCnt) = gvl
13050  |                        ddblDailynav(dlngCnt) = dd||13022  |                        ddblDailynav(dlngCnt) = dd
13051  |                    End If                        ||13023  |                    End If                        
13052  |                    'RAFI対応 END                 ||13024  |                    'RAFI対応 END                 
13053  |                                                  ||13025  |                                                  
13054  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             ||13026  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             
13055  |                    Call gDyNext                  ||13027  |                    Call gDyNext                  
13056  |                Loop                              ||13028  |                Loop                              
13057  |                                                  ||13029  |                                                  
13058  |            Next dintFor                          ||13030  |            Next dintFor                          
13059  |                                                  ||13031  |                                                  
13060  |            ddblTtalnav = 0                       ||13032  |            ddblTtalnav = 0                       
13061  |                                                  ||13033  |                                                  
13062  |            For dintFor2 = 1 To dlngCnt           ||13034  |            For dintFor2 = 1 To dlngCnt           
13063  |                ddblTtalnav = ddblTtalnav + ddblDa||13035  |                ddblTtalnav = ddblTtalnav + ddblDa
13064  |            Next dintFor2                         ||13036  |            Next dintFor2                         
13065  |                                                  ||13037  |                                                  
13066  |            iRowCnt = dlngCnt                     ||13038  |            iRowCnt = dlngCnt                     
13067  |            dlngMeisyoSu = dlngCnt                ||13039  |            dlngMeisyoSu = dlngCnt                
13068  |            TotalNav = ddblTtalnav                ||13040  |            TotalNav = ddblTtalnav                
13069  |            dblValueIn = TotalNav                 ||13041  |            dblValueIn = TotalNav                 
13070  |            Call sbGetRoundValue2(dblValueIn)     ||13042  |            Call sbGetRoundValue2(dblValueIn)     
13071  |            TotalNav = dblValueOut                ||13043  |            TotalNav = dblValueOut                
13072  |                                                  ||13044  |                                                  
13073  |            '計算期間の純資産総額の合計÷計算期間 ||13045  |            '計算期間の純資産総額の合計÷計算期間 
13074  |            dblValueIn = TotalNav / iRowCnt       ||13046  |            dblValueIn = TotalNav / iRowCnt       
13075  |            iCalcNum = iRowCnt                    ||13047  |            iCalcNum = iRowCnt                    
13076  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||13048  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
13077  |                  Call sbGetRoundValue2(dblValueIn||13049  |                  Call sbGetRoundValue2(dblValueIn
13078  |            Else                                  ||13050  |            Else                                  
13079  |                  Call sbGetRoundValue(dblValueIn)||13051  |                  Call sbGetRoundValue(dblValueIn)
13080  |            End If                                ||13052  |            End If                                
13081  |            dstrAvgNav = dblValueOut              ||13053  |            dstrAvgNav = dblValueOut              
13082  |            AvgNav = dstrAvgNav                   ||13054  |            AvgNav = dstrAvgNav                   
13083  |                                                  ||13055  |                                                  
13084  |                                                  ||13056  |                                                  
13085  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||13057  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
13086  |            Call gblnDyClose                      ||13058  |            Call gblnDyClose                      
13087  |            .Cells(17, 23).NumberFormatLocal = "@"||13059  |            .Cells(17, 23).NumberFormatLocal = "@"
13088  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||13060  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
13089  |                .Cells(17, 23).Value = CStr(Format||13061  |                .Cells(17, 23).Value = CStr(Format
13090  |            Else                                  ||13062  |            Else                                  
13091  |                .Cells(17, 23).Value = CStr(Format||13063  |                .Cells(17, 23).Value = CStr(Format
13092  |            End If                                ||13064  |            End If                                
13093  |            .Cells(17, 23).HorizontalAlignment = x||13065  |            .Cells(17, 23).HorizontalAlignment = x
13094  |            '平均純資産総額                       ||13066  |            '平均純資産総額                       
13095  |            .Cells(36, 2).Value = sWord51         ||13067  |            .Cells(36, 2).Value = sWord51         
13096  |            .Cells(36, 11).Value = sWord19        ||13068  |            .Cells(36, 11).Value = sWord19        
13097  |            '計算期間の純資産総額の合計(月末純資産||13069  |            '計算期間の純資産総額の合計(月末純資産
13098  |            .Cells(36, 23).NumberFormatLocal = "@"||13070  |            .Cells(36, 23).NumberFormatLocal = "@"
13099  |              If gbuMGetUPDRec.N(lRecIdx).MGET_bas||13071  |              If gbuMGetUPDRec.N(lRecIdx).MGET_bas
13100  |                  .Cells(36, 23).Value = CStr(Form||13072  |                  .Cells(36, 23).Value = CStr(Form
13101  |              Else                                ||13073  |              Else                                
13102  |                  .Cells(36, 23).Value = CStr(Form||13074  |                  .Cells(36, 23).Value = CStr(Form
13103  |              End If                              ||13075  |              End If                              
13104  |            .Cells(36, 23).HorizontalAlignment = x||13076  |            .Cells(36, 23).HorizontalAlignment = x
13105  |            '÷??＝                               ||13077  |            '÷??＝                               
13106  |            .Cells(36, 26).Value = sWord18 & "   "||13078  |            .Cells(36, 26).Value = sWord18 & "   "
13107  |            '計算期間の純資産総額の合計÷計算期間 ||13079  |            '計算期間の純資産総額の合計÷計算期間 
13108  |            .Cells(36, 35).NumberFormatLocal = "@"||13080  |            .Cells(36, 35).NumberFormatLocal = "@"
13109  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||13081  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
13110  |                .Cells(36, 35).Value = CStr(Format||13082  |                .Cells(36, 35).Value = CStr(Format
13111  |            Else                                  ||13083  |            Else                                  
13112  |                .Cells(36, 35).Value = CStr(Format||13084  |                .Cells(36, 35).Value = CStr(Format
13113  |            End If                                ||13085  |            End If                                
13114  |            ddblExchangeRate = 0                  ||13086  |            ddblExchangeRate = 0                  
13115  |            '投資顧問料計算用計算対象NAVに日次平均||13087  |            '投資顧問料計算用計算対象NAVに日次平均
13116  |            If dstrAvgNav = "" Then               ||13088  |            If dstrAvgNav = "" Then               
13117  |                lCalcNav = 0                      ||13089  |                lCalcNav = 0                      
13118  |            Else                                  ||13090  |            Else                                  
13119  |                dblValueIn = CDbl(dstrAvgNav)     ||13091  |                dblValueIn = CDbl(dstrAvgNav)     
13120  |                '@@@@@ NAV通貨から閾値通貨に換算 @||13092  |                '@@@@@ NAV通貨から閾値通貨に換算 @
13121  |                Select Case gbuMGetUPDRec.N(lRecId||13093  |                Select Case gbuMGetUPDRec.N(lRecId
13122  |                  Case "1"    '固定料率           ||13094  |                  Case "1"    '固定料率           
13123  |                    If gbuMGetUPDRec.N(lRecIdx).MG||13095  |                    If gbuMGetUPDRec.N(lRecIdx).MG
13124  |                        'NAV通貨→JPYの為替レート ||13096  |                        'NAV通貨→JPYの為替レート 
13125  |                        dstrCurrencyCode = gbuMGet||13097  |                        dstrCurrencyCode = gbuMGet
13126  |                        ddblExchangeRate = fnstrEx||13098  |                        ddblExchangeRate = fnstrEx
13127  |                        If ddblExchangeRate = 0 Th||13099  |                        If ddblExchangeRate = 0 Th
13128  |                          intRtn = MsgBox("ＴＴＭ ||13100  |                          intRtn = MsgBox("ＴＴＭ 
13129  |                          vbLf & "対象通貨コード  ||13101  |                          vbLf & "対象通貨コード  
13130  |                          vbLf & "基準日 ： [ " & ||13102  |                          vbLf & "基準日 ： [ " & 
13131  |                              vbCritical, "ＴＴＭ ||13103  |                              vbCritical, "ＴＴＭ 
13132  |                          Exit Function           ||13104  |                          Exit Function           
13133  |                        End If                    ||13105  |                        End If                    
13134  |                        'NAV通貨→JPYへレート換算 ||13106  |                        'NAV通貨→JPYへレート換算 
13135  |                        dblValueIn = dblValueIn * ||13107  |                        dblValueIn = dblValueIn * 
13136  |                    End If                        ||13108  |                    End If                        
13137  |                  Case "2"    '段階料率           ||13109  |                  Case "2"    '段階料率           
13138  |                    If gbuMGetUPDRec.N(lRecIdx).MG||13110  |                    If gbuMGetUPDRec.N(lRecIdx).MG
13139  |                        If gbuMGetUPDRec.N(lRecIdx||13111  |                        If gbuMGetUPDRec.N(lRecIdx
13140  |                        Else                      ||13112  |                        Else                      
13141  |                            '閾値通貨→JPYの為替レ||13113  |                            '閾値通貨→JPYの為替レ
13142  |                            dstrCurrencyCode = gbu||13114  |                            dstrCurrencyCode = gbu
13143  |                            ddblExchangeRate = fns||13115  |                            ddblExchangeRate = fns
13144  |                            If ddblExchangeRate = ||13116  |                            If ddblExchangeRate = 
13145  |                              intRtn = MsgBox("Ｔ ||13117  |                              intRtn = MsgBox("Ｔ 
13146  |                              vbLf & "対象通貨コー||13118  |                              vbLf & "対象通貨コー
13147  |                              vbLf & "基準日 ： [ ||13119  |                              vbLf & "基準日 ： [ 
13148  |                                  vbCritical, "Ｔ ||13120  |                                  vbCritical, "Ｔ 
13149  |                              Exit Function       ||13121  |                              Exit Function       
13150  |                            End If                ||13122  |                            End If                
13151  |                            'JPY→閾値通貨へレート||13123  |                            'JPY→閾値通貨へレート
13152  |                            dblValueIn = dblValueI||13124  |                            dblValueIn = dblValueI
13153  |                        End If                    ||13125  |                        End If                    
13154  |                    Else                          ||13126  |                    Else                          
13155  |                        'NAV通貨→JPYの為替レート ||13127  |                        'NAV通貨→JPYの為替レート 
13156  |                        dstrCurrencyCode = gbuMGet||13128  |                        dstrCurrencyCode = gbuMGet
13157  |                        ddblExchangeRate = fnstrEx||13129  |                        ddblExchangeRate = fnstrEx
13158  |                        If ddblExchangeRate = 0 Th||13130  |                        If ddblExchangeRate = 0 Th
13159  |                          intRtn = MsgBox("ＴＴＭ ||13131  |                          intRtn = MsgBox("ＴＴＭ 
13160  |                          vbLf & "対象通貨コード  ||13132  |                          vbLf & "対象通貨コード  
13161  |                          vbLf & "基準日 ： [ " & ||13133  |                          vbLf & "基準日 ： [ " & 
13162  |                              vbCritical, "ＴＴＭ ||13134  |                              vbCritical, "ＴＴＭ 
13163  |                          Exit Function           ||13135  |                          Exit Function           
13164  |                        End If                    ||13136  |                        End If                    
13165  |                        'NAV通貨→JPYへレート換算 ||13137  |                        'NAV通貨→JPYへレート換算 
13166  |                        dblValueIn = dblValueIn * ||13138  |                        dblValueIn = dblValueIn * 
13167  |                        If gbuMGetUPDRec.N(lRecIdx||13139  |                        If gbuMGetUPDRec.N(lRecIdx
13168  |                        Else                      ||13140  |                        Else                      
13169  |                            '閾値通貨→JPYの為替レ||13141  |                            '閾値通貨→JPYの為替レ
13170  |                            dstrCurrencyCode = gbu||13142  |                            dstrCurrencyCode = gbu
13171  |                            ddblExchangeRate = fns||13143  |                            ddblExchangeRate = fns
13172  |                            If ddblExchangeRate = ||13144  |                            If ddblExchangeRate = 
13173  |                              intRtn = MsgBox("Ｔ ||13145  |                              intRtn = MsgBox("Ｔ 
13174  |                              vbLf & "対象通貨コー||13146  |                              vbLf & "対象通貨コー
13175  |                              vbLf & "基準日 ： [ ||13147  |                              vbLf & "基準日 ： [ 
13176  |                                  vbCritical, "Ｔ ||13148  |                                  vbCritical, "Ｔ 
13177  |                              Exit Function       ||13149  |                              Exit Function       
13178  |                            End If                ||13150  |                            End If                
13179  |                            'JPY→閾値通貨へ逆レー||13151  |                            'JPY→閾値通貨へ逆レー
13180  |                            dblValueIn = dblValueI||13152  |                            dblValueIn = dblValueI
13181  |                        End If                    ||13153  |                        End If                    
13182  |                    End If                        ||13154  |                    End If                        
13183  |                End Select                        ||13155  |                End Select                        
13184  |                '@@@@@ NAV通貨から閾値通貨に換算 @||13156  |                '@@@@@ NAV通貨から閾値通貨に換算 @
13185  |                Call sbGetRoundValue2(dblValueIn) ||13157  |                Call sbGetRoundValue2(dblValueIn) 
13186  |                '閾値レート換算後平均NAV(計算対象N||13158  |                '閾値レート換算後平均NAV(計算対象N
13187  |                lCalcNav = CStr(Format(dblValueOut||13159  |                lCalcNav = CStr(Format(dblValueOut
13188  |            End If                                ||13160  |            End If                                
13189  |                                                  ||13161  |                                                  
13190  |On Error Resume Next                              ||13162  |On Error Resume Next                              
13191  |        End If                                    ||13163  |        End If                                    
13192  |                                                  ||13164  |                                                  
13193  |        '投資顧問料                               ||13165  |        '投資顧問料                               
13194  |        Dim dRitsu As Double    '外部委託顧問料率 ||13166  |        Dim dRitsu As Double    '外部委託顧問料率 
13195  |        dRitsu = 0                                ||13167  |        dRitsu = 0                                
13196  |        TotalRate = 0                             ||13168  |        TotalRate = 0                             
13197  |        ddblExchangeRate = 0                      ||13169  |        ddblExchangeRate = 0                      
13198  |        '計算対象NAVを変数にセット                ||13170  |        '計算対象NAVを変数にセット                
13199  |        lCalcNav = 0                              ||13171  |        lCalcNav = 0                              
13200  |        dblValueIn = TotalNav / iRowCnt           ||13172  |        dblValueIn = TotalNav / iRowCnt           
13201  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    ||13173  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    
13202  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||13174  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
13203  |          Case "1"    '固定料率(固定料率の場合は、||13175  |          Case "1"    '固定料率(固定料率の場合は、
13204  |              'NAV通貨と外部委託顧問料通貨が相違  ||13176  |              'NAV通貨と外部委託顧問料通貨が相違  
13205  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||13177  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
13206  |                'NAV通貨→JPYの為替レートを取得   ||13178  |                'NAV通貨→JPYの為替レートを取得   
13207  |                dstrCurrencyCode = gbuMGetUPDRec.N||13179  |                dstrCurrencyCode = gbuMGetUPDRec.N
13208  |                ddblExchangeRate = fnstrExchangeRa||13180  |                ddblExchangeRate = fnstrExchangeRa
13209  |                If ddblExchangeRate = 0 Then      ||13181  |                If ddblExchangeRate = 0 Then      
13210  |                  intRtn = MsgBox("ＴＴＭが取得で ||13182  |                  intRtn = MsgBox("ＴＴＭが取得で 
13211  |                  vbLf & "対象通貨コード ： [ " & ||13183  |                  vbLf & "対象通貨コード ： [ " & 
13212  |                  vbLf & "基準日 ： [ " & Mid(dstr||13184  |                  vbLf & "基準日 ： [ " & Mid(dstr
13213  |                      vbCritical, "ＴＴＭ取得エラ ||13185  |                      vbCritical, "ＴＴＭ取得エラ 
13214  |                  Exit Function                   ||13186  |                  Exit Function                   
13215  |                End If                            ||13187  |                End If                            
13216  |                'NAV通貨→JPYへレート換算         ||13188  |                'NAV通貨→JPYへレート換算         
13217  |                dblValueIn = dblValueIn * ddblExch||13189  |                dblValueIn = dblValueIn * ddblExch
13218  |            End If                                ||13190  |            End If                                
13219  |          Case "2"    '段階料率                   ||13191  |          Case "2"    '段階料率                   
13220  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||13192  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
13221  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||13193  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
13222  |                Else                              ||13194  |                Else                              
13223  |                    '閾値通貨→JPYの為替レートを取||13195  |                    '閾値通貨→JPYの為替レートを取
13224  |                    dstrCurrencyCode = gbuMGetUPDR||13196  |                    dstrCurrencyCode = gbuMGetUPDR
13225  |                    ddblExchangeRate = fnstrExchan||13197  |                    ddblExchangeRate = fnstrExchan
13226  |                    If ddblExchangeRate = 0 Then  ||13198  |                    If ddblExchangeRate = 0 Then  
13227  |                      intRtn = MsgBox("ＴＴＭが取 ||13199  |                      intRtn = MsgBox("ＴＴＭが取 
13228  |                      vbLf & "対象通貨コード ： [ ||13200  |                      vbLf & "対象通貨コード ： [ 
13229  |                      vbLf & "基準日 ： [ " & Mid(||13201  |                      vbLf & "基準日 ： [ " & Mid(
13230  |                          vbCritical, "ＴＴＭ取得 ||13202  |                          vbCritical, "ＴＴＭ取得 
13231  |                      Exit Function               ||13203  |                      Exit Function               
13232  |                    End If                        ||13204  |                    End If                        
13233  |                    'JPY→閾値通貨へレート換算    ||13205  |                    'JPY→閾値通貨へレート換算    
13234  |                    dblValueIn = dblValueIn * ddbl||13206  |                    dblValueIn = dblValueIn * ddbl
13235  |                End If                            ||13207  |                End If                            
13236  |            Else                                  ||13208  |            Else                                  
13237  |                'NAV通貨→JPYの為替レートを取得   ||13209  |                'NAV通貨→JPYの為替レートを取得   
13238  |                dstrCurrencyCode = gbuMGetUPDRec.N||13210  |                dstrCurrencyCode = gbuMGetUPDRec.N
13239  |                ddblExchangeRate = fnstrExchangeRa||13211  |                ddblExchangeRate = fnstrExchangeRa
13240  |                If ddblExchangeRate = 0 Then      ||13212  |                If ddblExchangeRate = 0 Then      
13241  |                  intRtn = MsgBox("ＴＴＭが取得で ||13213  |                  intRtn = MsgBox("ＴＴＭが取得で 
13242  |                  vbLf & "対象通貨コード ： [ " & ||13214  |                  vbLf & "対象通貨コード ： [ " & 
13243  |                  vbLf & "基準日 ： [ " & Mid(dstr||13215  |                  vbLf & "基準日 ： [ " & Mid(dstr
13244  |                      vbCritical, "ＴＴＭ取得エラ ||13216  |                      vbCritical, "ＴＴＭ取得エラ 
13245  |                  Exit Function                   ||13217  |                  Exit Function                   
13246  |                End If                            ||13218  |                End If                            
13247  |                'NAV通貨→JPYへレート換算         ||13219  |                'NAV通貨→JPYへレート換算         
13248  |                dblValueIn = dblValueIn * ddblExch||13220  |                dblValueIn = dblValueIn * ddblExch
13249  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||13221  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
13250  |                Else                              ||13222  |                Else                              
13251  |                    '閾値通貨→JPYの為替レートを取||13223  |                    '閾値通貨→JPYの為替レートを取
13252  |                    dstrCurrencyCode = gbuMGetUPDR||13224  |                    dstrCurrencyCode = gbuMGetUPDR
13253  |                    ddblExchangeRate = fnstrExchan||13225  |                    ddblExchangeRate = fnstrExchan
13254  |                    If ddblExchangeRate = 0 Then  ||13226  |                    If ddblExchangeRate = 0 Then  
13255  |                      intRtn = MsgBox("ＴＴＭが取 ||13227  |                      intRtn = MsgBox("ＴＴＭが取 
13256  |                      vbLf & "対象通貨コード ： [ ||13228  |                      vbLf & "対象通貨コード ： [ 
13257  |                      vbLf & "基準日 ： [ " & Mid(||13229  |                      vbLf & "基準日 ： [ " & Mid(
13258  |                          vbCritical, "ＴＴＭ取得 ||13230  |                          vbCritical, "ＴＴＭ取得 
13259  |                      Exit Function               ||13231  |                      Exit Function               
13260  |                    End If                        ||13232  |                    End If                        
13261  |                    'JPY→閾値通貨へ逆レート換算  ||13233  |                    'JPY→閾値通貨へ逆レート換算  
13262  |                    dblValueIn = dblValueIn / ddbl||13234  |                    dblValueIn = dblValueIn / ddbl
13263  |                End If                            ||13235  |                End If                            
13264  |            End If                                ||13236  |            End If                                
13265  |        End Select                                ||13237  |        End Select                                
13266  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    ||13238  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    
13267  |        Call sbGetRoundValue2(dblValueIn)         ||13239  |        Call sbGetRoundValue2(dblValueIn)         
13268  |        lCalcNav = CStr(Format(dblValueOut, "#,##0||13240  |        lCalcNav = CStr(Format(dblValueOut, "#,##0
13269  |        '固定料率                                 ||13241  |        '固定料率                                 
13270  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat||13242  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat
13271  |            '計算対称NAV × 外部委託顧問料率 ÷ 10||13243  |            '計算対称NAV × 外部委託顧問料率 ÷ 10
13272  |            dRitsu = CDbl(gbuOtherComRateGetUPDRec||13244  |            dRitsu = CDbl(gbuOtherComRateGetUPDRec
13273  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_||13245  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_
13274  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_||13246  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_
13275  |                '一年間の日数：365日またはカレンダ||13247  |                '一年間の日数：365日またはカレンダ
13276  |                dblValueIn = lCalcNav * dRitsu / 1||13248  |                dblValueIn = lCalcNav * dRitsu / 1
13277  |            Else                                  ||13249  |            Else                                  
13278  |                '一年間の日数：360日              ||13250  |                '一年間の日数：360日              
13279  |                dblValueIn = lCalcNav * dRitsu / 1||13251  |                dblValueIn = lCalcNav * dRitsu / 1
13280  |            End If                                ||13252  |            End If                                
13281  |                                                  ||13253  |                                                  
13282  |        '段階料率                                 ||13254  |        '段階料率                                 
13283  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other||13255  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other
13284  |            '料率分ループ処理                     ||13256  |            '料率分ループ処理                     
13285  |            For i = LBound(gbuOtherComRateGetUPDRe||13257  |            For i = LBound(gbuOtherComRateGetUPDRe
13286  |                TotalRate = TotalRate + CCur(gbuOt||13258  |                TotalRate = TotalRate + CCur(gbuOt
13287  |                cRate = CCur(gbuOtherComRateGetUPD||13259  |                cRate = CCur(gbuOtherComRateGetUPD
13288  |                dRitsu = CDbl(gbuOtherComRateGetUP||13260  |                dRitsu = CDbl(gbuOtherComRateGetUP
13289  |                If i = UBound(gbuOtherComRateGetUP||13261  |                If i = UBound(gbuOtherComRateGetUP
13290  |                    '(前回閾値)：累積閾値 = WORK閾||13262  |                    '(前回閾値)：累積閾値 = WORK閾
13291  |                    TotalRate = WorkRate          ||13263  |                    TotalRate = WorkRate          
13292  |                ElseIf TotalRate <= lCalcNav Then ||13264  |                ElseIf TotalRate <= lCalcNav Then 
13293  |                    '累積投資顧問料 = 累積投資顧問||13265  |                    '累積投資顧問料 = 累積投資顧問
13294  |                    dblValueIn = cRate * dRitsu / ||13266  |                    dblValueIn = cRate * dRitsu / 
13295  |                    Call sbGetRoundValue2(dblValue||13267  |                    Call sbGetRoundValue2(dblValue
13296  |                    TotalCom = TotalCom + dblValue||13268  |                    TotalCom = TotalCom + dblValue
13297  |                Else                              ||13269  |                Else                              
13298  |                    '(前回閾値)：累積閾値 = WORK閾||13270  |                    '(前回閾値)：累積閾値 = WORK閾
13299  |                    TotalRate = WorkRate          ||13271  |                    TotalRate = WorkRate          
13300  |                    Exit For                      ||13272  |                    Exit For                      
13301  |                End If                            ||13273  |                End If                            
13302  |                '累積閾値をWORKに格納(一つ前の閾値||13274  |                '累積閾値をWORKに格納(一つ前の閾値
13303  |                WorkRate = TotalRate              ||13275  |                WorkRate = TotalRate              
13304  |            Next i                                ||13276  |            Next i                                
13305  |            '累積投資顧問料 = 累積投資顧問料 + (計||13277  |            '累積投資顧問料 = 累積投資顧問料 + (計
13306  |            dblValueIn = (lCalcNav - TotalRate) * ||13278  |            dblValueIn = (lCalcNav - TotalRate) * 
13307  |            TotalCom = TotalCom + dblValueIn      ||13279  |            TotalCom = TotalCom + dblValueIn      
13308  |            '投資顧問料 = 累積投資顧問料 × 計算期||13280  |            '投資顧問料 = 累積投資顧問料 × 計算期
13309  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_||13281  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_
13310  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_||13282  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_
13311  |                '一年間の日数：365日またはカレンダ||13283  |                '一年間の日数：365日またはカレンダ
13312  |                dblValueIn = TotalCom * iCalcNum /||13284  |                dblValueIn = TotalCom * iCalcNum /
13313  |            Else                                  ||13285  |            Else                                  
13314  |                '一年間の日数：360日              ||13286  |                '一年間の日数：360日              
13315  |                dblValueIn = TotalCom * iCalcNum /||13287  |                dblValueIn = TotalCom * iCalcNum /
13316  |            End If                                ||13288  |            End If                                
13317  |        End If                                    ||13289  |        End If                                    
13318  |        ddblExchangeRate = 0                      ||13290  |        ddblExchangeRate = 0                      
13319  |        '@@@@@ 外部委託顧問料に換算 @@@@@         ||13291  |        '@@@@@ 外部委託顧問料に換算 @@@@@         
13320  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||13292  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
13321  |          Case "1"    '固定料率                   ||13293  |          Case "1"    '固定料率                   
13322  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o||13294  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o
13323  |                Else                              ||13295  |                Else                              
13324  |                  '外部委託顧問料通貨→JPYの為替レ||13296  |                  '外部委託顧問料通貨→JPYの為替レ
13325  |                  dstrCurrencyCode = gbuMGetUPDRec||13297  |                  dstrCurrencyCode = gbuMGetUPDRec
13326  |                  ddblExchangeRate = fnstrExchange||13298  |                  ddblExchangeRate = fnstrExchange
13327  |                  If ddblExchangeRate = 0 Then    ||13299  |                  If ddblExchangeRate = 0 Then    
13328  |                    intRtn = MsgBox("ＴＴＭが取得 ||13300  |                    intRtn = MsgBox("ＴＴＭが取得 
13329  |                    vbLf & "対象通貨コード ： [ " ||13301  |                    vbLf & "対象通貨コード ： [ " 
13330  |                    vbLf & "基準日 ： [ " & Mid(ds||13302  |                    vbLf & "基準日 ： [ " & Mid(ds
13331  |                        vbCritical, "ＴＴＭ取得エ ||13303  |                        vbCritical, "ＴＴＭ取得エ 
13332  |                    Exit Function                 ||13304  |                    Exit Function                 
13333  |                  End If                          ||13305  |                  End If                          
13334  |                  'JPY→閾値通貨へ逆レート換算    ||13306  |                  'JPY→閾値通貨へ逆レート換算    
13335  |                  dblValueIn = dblValueIn / ddblEx||13307  |                  dblValueIn = dblValueIn / ddblEx
13336  |                End If                            ||13308  |                End If                            
13337  |          Case "2"    '段階料率                   ||13309  |          Case "2"    '段階料率                   
13338  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||13310  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
13339  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||13311  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
13340  |                Else                              ||13312  |                Else                              
13341  |                    '閾値通貨→JPYの為替レートを取||13313  |                    '閾値通貨→JPYの為替レートを取
13342  |                    dstrCurrencyCode = gbuMGetUPDR||13314  |                    dstrCurrencyCode = gbuMGetUPDR
13343  |                    ddblExchangeRate = fnstrExchan||13315  |                    ddblExchangeRate = fnstrExchan
13344  |                    'JPY→閾値通貨へ逆レート換算  ||13316  |                    'JPY→閾値通貨へ逆レート換算  
13345  |                    dblValueIn = dblValueIn / ddbl||13317  |                    dblValueIn = dblValueIn / ddbl
13346  |                End If                            ||13318  |                End If                            
13347  |            Else                                  ||13319  |            Else                                  
13348  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||13320  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
13349  |                    '外部委託顧問料通貨→JPYの為替||13321  |                    '外部委託顧問料通貨→JPYの為替
13350  |                    dstrCurrencyCode = gbuMGetUPDR||13322  |                    dstrCurrencyCode = gbuMGetUPDR
13351  |                    ddblExchangeRate = fnstrExchan||13323  |                    ddblExchangeRate = fnstrExchan
13352  |                    'JPY→閾値通貨へレート換算    ||13324  |                    'JPY→閾値通貨へレート換算    
13353  |                    dblValueIn = dblValueIn / ddbl||13325  |                    dblValueIn = dblValueIn / ddbl
13354  |                Else                              ||13326  |                Else                              
13355  |                    '閾値通貨→JPYの為替レートを取||13327  |                    '閾値通貨→JPYの為替レートを取
13356  |                    dstrCurrencyCode = gbuMGetUPDR||13328  |                    dstrCurrencyCode = gbuMGetUPDR
13357  |                    ddblExchangeRate = fnstrExchan||13329  |                    ddblExchangeRate = fnstrExchan
13358  |                    'JPY→閾値通貨へ逆レート換算  ||13330  |                    'JPY→閾値通貨へ逆レート換算  
13359  |                    dblValueIn = dblValueIn * ddbl||13331  |                    dblValueIn = dblValueIn * ddbl
13360  |                    '外部委託顧問料通貨→JPYの為替||13332  |                    '外部委託顧問料通貨→JPYの為替
13361  |                    dstrCurrencyCode = gbuMGetUPDR||13333  |                    dstrCurrencyCode = gbuMGetUPDR
13362  |                    ddblExchangeRate = fnstrExchan||13334  |                    ddblExchangeRate = fnstrExchan
13363  |                    'JPY→閾値通貨へ逆レート換算  ||13335  |                    'JPY→閾値通貨へ逆レート換算  
13364  |                    dblValueIn = dblValueIn / ddbl||13336  |                    dblValueIn = dblValueIn / ddbl
13365  |                End If                            ||13337  |                End If                            
13366  |            End If                                ||13338  |            End If                                
13367  |        End Select                                ||13339  |        End Select                                
13368  |        '@@@@@ 外部委託顧問料に換算 @@@@@         ||13340  |        '@@@@@ 外部委託顧問料に換算 @@@@@         
13369  |        Call sbGetRoundValue2(dblValueIn)         ||13341  |        Call sbGetRoundValue2(dblValueIn)         
13370  |        mstrMonthlyPayCom = dblValueOut           ||13342  |        mstrMonthlyPayCom = dblValueOut           
13371  |        ': ,文言                                  ||13343  |        ': ,文言                                  
13372  |        .Cells(39, 11).Value = sWord19            ||13344  |        .Cells(39, 11).Value = sWord19            
13373  |        '年率 ,文言                               ||13345  |        '年率 ,文言                               
13374  |        .Cells(39, 2).Value = sWord10             ||13346  |        .Cells(39, 2).Value = sWord10             
13375  |        TotalRate = 0                             ||13347  |        TotalRate = 0                             
13376  |                                                  ||13348  |                                                  
13377  |        '年率の設定                               ||13349  |        '年率の設定                               
13378  |        Call sbExcelNetAssetValue(TotalRate, lRecI||13350  |        Call sbExcelNetAssetValue(TotalRate, lRecI
13379  |                                                  ||13351  |                                                  
13380  |        '投資顧問料                               ||13352  |        '投資顧問料                               
13381  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||13353  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
13382  |            Case Mid(mstrContractFlag(1), 1, 1)   ||13354  |            Case Mid(mstrContractFlag(1), 1, 1)   
13383  |                .Cells(46, 2).Value = sWord11a    ||13355  |                .Cells(46, 2).Value = sWord11a    
13384  |            Case Mid(mstrContractFlag(2), 1, 1)   ||13356  |            Case Mid(mstrContractFlag(2), 1, 1)   
13385  |                .Cells(46, 2).Value = sWord11b    ||13357  |                .Cells(46, 2).Value = sWord11b    
13386  |            Case Mid(mstrContractFlag(3), 1, 1)   ||13358  |            Case Mid(mstrContractFlag(3), 1, 1)   
13387  |                .Cells(46, 2).Value = sWord11c    ||13359  |                .Cells(46, 2).Value = sWord11c    
13388  |            Case Else                             ||13360  |            Case Else                             
13389  |                MsgBox "契約区分が不正です。", vbC||13361  |                MsgBox "契約区分が不正です。", vbC
13390  |        End Select                                ||13362  |        End Select                                
13391  |        .Cells(46, 11).Value = sWord19            ||13363  |        .Cells(46, 11).Value = sWord19            
13392  |        '外部委託顧問料                           ||13364  |        '外部委託顧問料                           
13393  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||13365  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
13394  |            .Cells(46, 31).NumberFormatLocal = "@"||13366  |            .Cells(46, 31).NumberFormatLocal = "@"
13395  |        Else                                      ||13367  |        Else                                      
13396  |            .Cells(46, 29).NumberFormatLocal = "@"||13368  |            .Cells(46, 29).NumberFormatLocal = "@"
13397  |        End If                                    ||13369  |        End If                                    
13398  |        '契約区分が名称使用許諾料の場合上限・下限 ||13370  |        '契約区分が名称使用許諾料の場合上限・下限 
13399  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||13371  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
13400  |            '下限金額より換算した金額が小さい場合 ||13372  |            '下限金額より換算した金額が小さい場合 
13401  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_f||13373  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_f
13402  |                If mstrMonthlyPayCom < CDbl(gbuMGe||13374  |                If mstrMonthlyPayCom < CDbl(gbuMGe
13403  |                    mstrMonthlyPayCom = CDbl(gbuMG||13375  |                    mstrMonthlyPayCom = CDbl(gbuMG
13404  |                End If                            ||13376  |                End If                            
13405  |            End If                                ||13377  |            End If                                
13406  |            '上限金額より換算した金額が大きい場合 ||13378  |            '上限金額より換算した金額が大きい場合 
13407  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_c||13379  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_c
13408  |                If mstrMonthlyPayCom > CDbl(gbuMGe||13380  |                If mstrMonthlyPayCom > CDbl(gbuMGe
13409  |                    mstrMonthlyPayCom = CDbl(gbuMG||13381  |                    mstrMonthlyPayCom = CDbl(gbuMG
13410  |                End If                            ||13382  |                End If                            
13411  |            End If                                ||13383  |            End If                                
13412  |            dblValueIn = CDbl(mstrMonthlyPayCom)  ||13384  |            dblValueIn = CDbl(mstrMonthlyPayCom)  
13413  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||13385  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
13414  |                Call sbGetRoundValue2(dblValueIn) ||13386  |                Call sbGetRoundValue2(dblValueIn) 
13415  |            Else                                  ||13387  |            Else                                  
13416  |                Call sbGetRoundValue(dblValueIn)  ||13388  |                Call sbGetRoundValue(dblValueIn)  
13417  |            End If                                ||13389  |            End If                                
13418  |            mstrMonthlyPayCom = dblValueOut       ||13390  |            mstrMonthlyPayCom = dblValueOut       
13419  |        End If                                    ||13391  |        End If                                    
13420  |        '外部委託顧問料通貨                       ||13392  |        '外部委託顧問料通貨                       
13421  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||13393  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
13422  |            Case cAud                             ||13394  |            Case cAud                             
13423  |                .Cells(46, 31).Value = CStr(Format||13395  |                .Cells(46, 31).Value = CStr(Format
13424  |                .Cells(46, 32).Value = sAud       ||13396  |                .Cells(46, 32).Value = sAud       
13425  |            Case cCad                             ||13397  |            Case cCad                             
13426  |                .Cells(46, 31).Value = CStr(Format||13398  |                .Cells(46, 31).Value = CStr(Format
13427  |                .Cells(46, 32).Value = sCad       ||13399  |                .Cells(46, 32).Value = sCad       
13428  |            Case cChf                             ||13400  |            Case cChf                             
13429  |                .Cells(46, 31).Value = CStr(Format||13401  |                .Cells(46, 31).Value = CStr(Format
13430  |                .Cells(46, 32).Value = sChf       ||13402  |                .Cells(46, 32).Value = sChf       
13431  |            Case cEur                             ||13403  |            Case cEur                             
13432  |                .Cells(46, 31).Value = CStr(Format||13404  |                .Cells(46, 31).Value = CStr(Format
13433  |                .Cells(46, 32).Value = sEur       ||13405  |                .Cells(46, 32).Value = sEur       
13434  |            Case cGbp                             ||13406  |            Case cGbp                             
13435  |                .Cells(46, 31).Value = CStr(Format||13407  |                .Cells(46, 31).Value = CStr(Format
13436  |                .Cells(46, 32).Value = sGbp       ||13408  |                .Cells(46, 32).Value = sGbp       
13437  |            Case cHkd                             ||13409  |            Case cHkd                             
13438  |                .Cells(46, 31).Value = CStr(Format||13410  |                .Cells(46, 31).Value = CStr(Format
13439  |                .Cells(46, 32).Value = sHkd       ||13411  |                .Cells(46, 32).Value = sHkd       
13440  |            Case cJpy                             ||13412  |            Case cJpy                             
13441  |                .Cells(46, 29).Value = CStr(Format||13413  |                .Cells(46, 29).Value = CStr(Format
13442  |                .Cells(46, 32).Value = sYen       ||13414  |                .Cells(46, 32).Value = sYen       
13443  |            Case cMyr                             ||13415  |            Case cMyr                             
13444  |                .Cells(46, 31).Value = CStr(Format||13416  |                .Cells(46, 31).Value = CStr(Format
13445  |                .Cells(46, 32).Value = sMyr       ||13417  |                .Cells(46, 32).Value = sMyr       
13446  |            Case cNzd                             ||13418  |            Case cNzd                             
13447  |                .Cells(46, 31).Value = CStr(Format||13419  |                .Cells(46, 31).Value = CStr(Format
13448  |                .Cells(46, 32).Value = sNzd       ||13420  |                .Cells(46, 32).Value = sNzd       
13449  |            Case cSek                             ||13421  |            Case cSek                             
13450  |                .Cells(46, 31).Value = CStr(Format||13422  |                .Cells(46, 31).Value = CStr(Format
13451  |                .Cells(46, 32).Value = sSek       ||13423  |                .Cells(46, 32).Value = sSek       
13452  |            Case cSgd                             ||13424  |            Case cSgd                             
13453  |                .Cells(46, 31).Value = CStr(Format||13425  |                .Cells(46, 31).Value = CStr(Format
13454  |                .Cells(46, 32).Value = sSgd       ||13426  |                .Cells(46, 32).Value = sSgd       
13455  |            Case cUsd                             ||13427  |            Case cUsd                             
13456  |                .Cells(46, 31).Value = CStr(Format||13428  |                .Cells(46, 31).Value = CStr(Format
13457  |                .Cells(46, 32).Value = sUsd       ||13429  |                .Cells(46, 32).Value = sUsd       
13458  |            Case cNok                             ||13430  |            Case cNok                             
13459  |                .Cells(46, 31).Value = CStr(Format||13431  |                .Cells(46, 31).Value = CStr(Format
13460  |                .Cells(46, 32).Value = sNok       ||13432  |                .Cells(46, 32).Value = sNok       
13461  |        End Select                                ||13433  |        End Select                                
13462  |                                                  ||13434  |                                                  
13463  |        '顧問料                                   ||13435  |        '顧問料                                   
13464  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||13436  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
13465  |            .Cells(46, 31).HorizontalAlignment = x||13437  |            .Cells(46, 31).HorizontalAlignment = x
13466  |        Else                                      ||13438  |        Else                                      
13467  |            .Cells(46, 29).HorizontalAlignment = x||13439  |            .Cells(46, 29).HorizontalAlignment = x
13468  |        End If                                    ||13440  |        End If                                    
13469  |                                                  ||13441  |                                                  
13470  |        '契約区分が名称使用許諾料の場合上限・下限 ||13442  |        '契約区分が名称使用許諾料の場合上限・下限 
13471  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||13443  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
13472  |            '上限金額                             ||13444  |            '上限金額                             
13473  |            .Cells(46, 39).Value = sWordCap       ||13445  |            .Cells(46, 39).Value = sWordCap       
13474  |            .Cells(46, 57).NumberFormatLocal = "@"||13446  |            .Cells(46, 57).NumberFormatLocal = "@"
13475  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||13447  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
13476  |                .Cells(46, 57).Value = Format(gbuM||13448  |                .Cells(46, 57).Value = Format(gbuM
13477  |            Else                                  ||13449  |            Else                                  
13478  |                .Cells(46, 57).Value = Format(gbuM||13450  |                .Cells(46, 57).Value = Format(gbuM
13479  |            End If                                ||13451  |            End If                                
13480  |            .Cells(46, 57).HorizontalAlignment = x||13452  |            .Cells(46, 57).HorizontalAlignment = x
13481  |            '下限金額                             ||13453  |            '下限金額                             
13482  |            .Cells(47, 39).Value = sWordFloor     ||13454  |            .Cells(47, 39).Value = sWordFloor     
13483  |            .Cells(47, 57).NumberFormatLocal = "@"||13455  |            .Cells(47, 57).NumberFormatLocal = "@"
13484  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||13456  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
13485  |                .Cells(47, 57).Value = Format(gbuM||13457  |                .Cells(47, 57).Value = Format(gbuM
13486  |            Else                                  ||13458  |            Else                                  
13487  |                .Cells(47, 57).Value = Format(gbuM||13459  |                .Cells(47, 57).Value = Format(gbuM
13488  |            End If                                ||13460  |            End If                                
13489  |            .Cells(47, 57).HorizontalAlignment = x||13461  |            .Cells(47, 57).HorizontalAlignment = x
13490  |        End If                                    ||13462  |        End If                                    
13491  |                                                  ||13463  |                                                  
13492  |        ddblExchangeRate = 0                      ||13464  |        ddblExchangeRate = 0                      
13493  |        '@@@@@ 支払に換算 @@@@@                   ||13465  |        '@@@@@ 支払に換算 @@@@@                   
13494  |        dblValueIn = mstrMonthlyPayCom            ||13466  |        dblValueIn = mstrMonthlyPayCom            
13495  |                                                  ||13467  |                                                  
13496  |        '2006/04/12 START K.Furuya 実払管理テーブ ||13468  |        '2006/04/12 START K.Furuya 実払管理テーブ 
13497  |        '通貨円以外の場合確定顧問料通貨を取得     ||13469  |        '通貨円以外の場合確定顧問料通貨を取得     
13498  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||13470  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
13499  |            WkFixComC = ""                        ||13471  |            WkFixComC = ""                        
13500  |            WkRealComC = ""                       ||13472  |            WkRealComC = ""                       
13501  |            WkFixComC = mstrMonthlyPayCom         ||13473  |            WkFixComC = mstrMonthlyPayCom         
13502  |            WkRealComC = mstrMonthlyPayCom        ||13474  |            WkRealComC = mstrMonthlyPayCom        
13503  |        End If                                    ||13475  |        End If                                    
13504  |        '通貨を取得                               ||13476  |        '通貨を取得                               
13505  |        WkCurCode = ""                            ||13477  |        WkCurCode = ""                            
13506  |        WkCurCode = Trim(gbuMGetUPDRec.N(lRecIdx).||13478  |        WkCurCode = Trim(gbuMGetUPDRec.N(lRecIdx).
13507  |        '2006/04/12 END   K.Furuya 実払管理テーブ ||13479  |        '2006/04/12 END   K.Furuya 実払管理テーブ 
13508  |                                                  ||13480  |                                                  
13509  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||13481  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
13510  |          Case "1"    '固定料率                   ||13482  |          Case "1"    '固定料率                   
13511  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o||13483  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o
13512  |                Else                              ||13484  |                Else                              
13513  |                  '外部委託顧問料通貨→JPYの為替レ||13485  |                  '外部委託顧問料通貨→JPYの為替レ
13514  |                  dstrCurrencyCode = gbuMGetUPDRec||13486  |                  dstrCurrencyCode = gbuMGetUPDRec
13515  |                  ddblExchangeRate = fnstrExchange||13487  |                  ddblExchangeRate = fnstrExchange
13516  |                  If ddblExchangeRate = 0 Then    ||13488  |                  If ddblExchangeRate = 0 Then    
13517  |                    intRtn = MsgBox("ＴＴＭが取得 ||13489  |                    intRtn = MsgBox("ＴＴＭが取得 
13518  |                    vbLf & "対象通貨コード ： [ " ||13490  |                    vbLf & "対象通貨コード ： [ " 
13519  |                    vbLf & "基準日 ： [ " & Mid(ds||13491  |                    vbLf & "基準日 ： [ " & Mid(ds
13520  |                        vbCritical, "ＴＴＭ取得エ ||13492  |                        vbCritical, "ＴＴＭ取得エ 
13521  |                    Exit Function                 ||13493  |                    Exit Function                 
13522  |                  End If                          ||13494  |                  End If                          
13523  |                  'JPY→支払通貨へレート換算      ||13495  |                  'JPY→支払通貨へレート換算      
13524  |                  dblValueIn = dblValueIn * ddblEx||13496  |                  dblValueIn = dblValueIn * ddblEx
13525  |                End If                            ||13497  |                End If                            
13526  |          Case "2"    '段階料率                   ||13498  |          Case "2"    '段階料率                   
13527  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||13499  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
13528  |            Else                                  ||13500  |            Else                                  
13529  |                '外部委託顧問料通貨→JPYの為替レー||13501  |                '外部委託顧問料通貨→JPYの為替レー
13530  |                dstrCurrencyCode = gbuMGetUPDRec.N||13502  |                dstrCurrencyCode = gbuMGetUPDRec.N
13531  |                ddblExchangeRate = fnstrExchangeRa||13503  |                ddblExchangeRate = fnstrExchangeRa
13532  |                If ddblExchangeRate = 0 Then      ||13504  |                If ddblExchangeRate = 0 Then      
13533  |                  intRtn = MsgBox("ＴＴＭが取得で ||13505  |                  intRtn = MsgBox("ＴＴＭが取得で 
13534  |                  vbLf & "対象通貨コード ： [ " & ||13506  |                  vbLf & "対象通貨コード ： [ " & 
13535  |                  vbLf & "基準日 ： [ " & Mid(dstr||13507  |                  vbLf & "基準日 ： [ " & Mid(dstr
13536  |                      vbCritical, "ＴＴＭ取得エラ ||13508  |                      vbCritical, "ＴＴＭ取得エラ 
13537  |                  Exit Function                   ||13509  |                  Exit Function                   
13538  |                End If                            ||13510  |                End If                            
13539  |                '外部委託顧問料通貨→JPYへレート換||13511  |                '外部委託顧問料通貨→JPYへレート換
13540  |                dblValueIn = dblValueIn * ddblExch||13512  |                dblValueIn = dblValueIn * ddblExch
13541  |            End If                                ||13513  |            End If                                
13542  |        End Select                                ||13514  |        End Select                                
13543  |        '@@@@@ 支払に換算 @@@@@                   ||13515  |        '@@@@@ 支払に換算 @@@@@                   
13544  |        Call sbGetRoundValue(dblValueIn)          ||13516  |        Call sbGetRoundValue(dblValueIn)          
13545  |        mstrMonthlyPayCom = dblValueOut           ||13517  |        mstrMonthlyPayCom = dblValueOut           
13546  |                                                  ||13518  |                                                  
13547  |        '2006/04/12 START K.Furuya 実払管理テーブ ||13519  |        '2006/04/12 START K.Furuya 実払管理テーブ 
13548  |        '確定額と実払額を取得                     ||13520  |        '確定額と実払額を取得                     
13549  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||13521  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
13550  |            WkFixComC = ""                        ||13522  |            WkFixComC = ""                        
13551  |            WkFixComJ = ""                        ||13523  |            WkFixComJ = ""                        
13552  |            WkRealComC = ""                       ||13524  |            WkRealComC = ""                       
13553  |            WkRealComJ = ""                       ||13525  |            WkRealComJ = ""                       
13554  |            WkFixComC = mstrMonthlyPayCom         ||13526  |            WkFixComC = mstrMonthlyPayCom         
13555  |            WkFixComJ = mstrMonthlyPayCom         ||13527  |            WkFixComJ = mstrMonthlyPayCom         
13556  |            WkRealComC = mstrMonthlyPayCom        ||13528  |            WkRealComC = mstrMonthlyPayCom        
13557  |            WkRealComJ = mstrMonthlyPayCom        ||13529  |            WkRealComJ = mstrMonthlyPayCom        
13558  |        Else                                      ||13530  |        Else                                      
13559  |            WkFixComJ = ""                        ||13531  |            WkFixComJ = ""                        
13560  |            WkRealComJ = ""                       ||13532  |            WkRealComJ = ""                       
13561  |            WkFixComJ = mstrMonthlyPayCom         ||13533  |            WkFixComJ = mstrMonthlyPayCom         
13562  |            WkRealComJ = mstrMonthlyPayCom        ||13534  |            WkRealComJ = mstrMonthlyPayCom        
13563  |        End If                                    ||13535  |        End If                                    
13564  |        '2006/04/12 END   K.Furuya 実払管理テーブ ||13536  |        '2006/04/12 END   K.Furuya 実払管理テーブ 
13565  |                                                  ||13537  |                                                  
13566  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||13538  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
13567  |            'TTMレート                            ||13539  |            'TTMレート                            
13568  |            .Cells(47, 19).Value = sWord43        ||13540  |            .Cells(47, 19).Value = sWord43        
13569  |            .Cells(47, 33).NumberFormatLocal = "@"||13541  |            .Cells(47, 33).NumberFormatLocal = "@"
13570  |            .Cells(47, 33).Value = Format(ddblExch||13542  |            .Cells(47, 33).Value = Format(ddblExch
13571  |            .Cells(47, 33).HorizontalAlignment = x||13543  |            .Cells(47, 33).HorizontalAlignment = x
13572  |            .Cells(47, 34).Value = sWord44        ||13544  |            .Cells(47, 34).Value = sWord44        
13573  |        End If                                    ||13545  |        End If                                    
13574  |        '支払額                                   ||13546  |        '支払額                                   
13575  |        .Cells(48, 2).Value = sWord46             ||13547  |        .Cells(48, 2).Value = sWord46             
13576  |        .Cells(48, 11).Value = sWord19            ||13548  |        .Cells(48, 11).Value = sWord19            
13577  |        '税抜金額(月別支払顧問料の累計)           ||13549  |        '税抜金額(月別支払顧問料の累計)           
13578  |        .Cells(48, 29).NumberFormatLocal = "@"    ||13550  |        .Cells(48, 29).NumberFormatLocal = "@"    
13579  |        .Cells(48, 29).Value = CStr(Format(mstrMon||13551  |        .Cells(48, 29).Value = CStr(Format(mstrMon
13580  |        .Cells(48, 29).HorizontalAlignment = xlRig||13552  |        .Cells(48, 29).HorizontalAlignment = xlRig
13581  |        .Cells(48, 32).Value = sYen               ||13553  |        .Cells(48, 32).Value = sYen               
13582  |                                                  ||13554  |                                                  
13583  |        '消費税計算有無：「有り」の場合のみ、消費 ||13555  |        '消費税計算有無：「有り」の場合のみ、消費 
13584  |        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc_||13556  |        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc_
13585 L|'2014/02/19 START M.Takada 【管理会計】消費税率変 ||       |                                                  
13586  |            '(消費税XX%)                          ||13557  |            '(消費税XX%)                          
13587 L|            'iSyouhizei = ddblconsumption_tax     ||13558 R|            iSyouhizei = ddblconsumption_tax      
13588 L|            '.Cells(49, 32).Value = sWord22 & iSyo||13559 R|            .Cells(49, 32).Value = sWord22 & iSyou
13589 L|            'dblValueIn = mstrMonthlyPayCom * iSyo||13560 R|            dblValueIn = mstrMonthlyPayCom * iSyou
13590 L|            'Call sbGetRoundValueTax(dblValueIn)  ||13561 R|            Call sbGetRoundValueTax(dblValueIn)   
13591 L|            'lTaxNum = dblValueOut                ||13562 R|            lTaxNum = dblValueOut                 
13592 L|            '.Cells(49, 29).NumberFormatLocal = "@||13563 R|            .Cells(49, 29).NumberFormatLocal = "@"
13593 L|            '.Cells(49, 29).Value = CStr(Format((l||13564 R|            .Cells(49, 29).Value = CStr(Format((lT
13594 L|            '.Cells(49, 29).HorizontalAlignment = ||13565 R|            .Cells(49, 29).HorizontalAlignment = x
13595 L|            '合計(消費税＋月別支払顧問料の累計)   ||       |                                                  
13596 L|            '.Cells(50, 13).Value = sWord24       ||       |                                                  
13597 L|            'dblValueIn = lTaxNum + CCur(mstrMonth||       |                                                  
13598 L|            'Call sbGetRoundValue(dblValueIn)     ||       |                                                  
13599 L|            'lMonthlyPayCom = dblValueOut         ||       |                                                  
13600 L|            '.Cells(50, 29).NumberFormatLocal = "@||       |                                                  
13601 L|            '.Cells(50, 29).Value = CStr(Format(lM||       |                                                  
13602 L|            '.Cells(50, 29).HorizontalAlignment = ||       |                                                  
13603 L|            '円                                   ||       |                                                  
13604 L|            '.Cells(50, 32).Value = sYen          ||       |                                                  
13605 L|            '下線                                 ||       |                                                  
13606 L|            'With xlSheet.Range("M49:AL49").Border||       |                                                  
13607 L|            '    .LineStyle = xlContinuous        ||       |                                                  
13608 L|            '    .Weight = xlThin                 ||       |                                                  
13609 L|            'End With                             ||       |                                                  
13610 L|                                                  ||       |                                                  
13611 L|            Call Tax_calc(dStart, dEnd)     '消費 ||       |                                                  
13612 L|            If Tax_Flg = True Then                ||       |                                                  
13613 L|                '計算期間中に消費税率が変更となる ||       |                                                  
13614 L|                .Cells(49, 32).Value = sWord71    ||       |                                                  
13615 L|                .Cells(49, 29).NumberFormatLocal =||       |                                                  
13616 L|                '算出した税額を該当セルに設定する ||       |                                                  
13617 L|                .Cells(49, 29).Value = CStr(Format||       |                                                  
13618 L|                .Cells(49, 29).HorizontalAlignment||       |                                                  
13619 L|                '下線                             ||       |                                                  
13620 L|                .Range("M49:AH49").Borders (xlEdge||       |                                                  
13621 L|                .LineStyle = xlContinuous         ||       |                                                  
13622 L|                .Weight = xlThin                  ||       |                                                  
13623 L|                                                  ||       |                                                  
13624 L|                '注釈文言を出力する               ||       |                                                  
13625 L|                .Cells(48, 36).Value = sWord64    ||       |                                                  
13626 L|                .Cells(48, 36).FontSize = 10      ||       |                                                  
13627 L|                .Cells(49, 36).Value = sWord65    ||       |                                                  
13628 L|                .Cells(49, 36).FontSize = 10      ||       |                                                  
13629 L|                                                  ||       |                                                  
13630 L|            Else                                  ||       |                                                  
13631 L|                '計算期間中に消費税率が変更となら ||       |                                                  
13632 L|                '.Cells(49, 32).Value = sWord22 & ||       |                                                  
13633 L|                .Cells(49, 32).Value = sWord22 & s||       |                                                  
13634 L|                'dblValueIn = mstrMonthlyPayCom * ||       |                                                  
13635 L|                .Cells(49, 29).NumberFormatLocal =||       |                                                  
13636 L|                '算出した税額を該当セルに設定する ||       |                                                  
13637 L|                .Cells(49, 29).Value = CStr(Format||       |                                                  
13638 L|                .Cells(49, 29).HorizontalAlignment||       |                                                  
13639 L|                '下線                             ||       |                                                  
13640 L|                .Range("M49:AL49").Borders (xlEdge||       |                                                  
13644 M|            '合計(消費税＋月別支払顧問料の累計)   ||13566 R|            '合計(消費税＋月別支払顧問料の累計)   
13645 M|            .Cells(50, 13).Value = sWord24        ||13567 R|            .Cells(50, 13).Value = sWord24        
       |                                                  ||13568 R|            dblValueIn = lTaxNum + CCur(mstrMonthl
       |                                                  ||13569 R|            Call sbGetRoundValue(dblValueIn)      
       |                                                  ||13570 R|            lMonthlyPayCom = dblValueOut          
13646 M|            .Cells(50, 29).NumberFormatLocal = "@"||13571 R|            .Cells(50, 29).NumberFormatLocal = "@"
       |                                                  ||13572 R|            .Cells(50, 29).Value = CStr(Format(lMo
13641 L|                .LineStyle = xlContinuous         ||13578 M|                .LineStyle = xlContinuous         
13642 L|                .Weight = xlThin                  ||13579 M|                .Weight = xlThin                  
13643 L|            End If                                ||       |                                                  
13644 L|            '合計(消費税＋月別支払顧問料の累計)   ||13566 M|            '合計(消費税＋月別支払顧問料の累計)   
13645 L|            .Cells(50, 13).Value = sWord24        ||13567 M|            .Cells(50, 13).Value = sWord24        
13646 L|            .Cells(50, 29).NumberFormatLocal = "@"||13571 M|            .Cells(50, 29).NumberFormatLocal = "@"
13647 L|            .Cells(50, 29).Value = CStr(Format((.C||       |                                                  
13648  |            .Cells(50, 29).HorizontalAlignment = x||13573  |            .Cells(50, 29).HorizontalAlignment = x
13649  |            '円                                   ||13574  |            '円                                   
13650  |            .Cells(50, 32).Value = sYen           ||13575  |            .Cells(50, 32).Value = sYen           
13651 L|                                                  ||       |                                                  
13652  |            '下線                                 ||13576  |            '下線                                 
13653 L|            'With xlSheet.Range("M49:AL49").Border||13577 R|            With xlSheet.Range("M49:AL49").Borders
13654 L|            '    .LineStyle = xlContinuous        ||       |                                                  
13655 L|            '    .Weight = xlThin                 ||       |                                                  
13656 L|            'End With                             ||       |                                                  
13657 L|                                                  ||       |                                                  
13658 L|'2014/02/19 End M.Takada 【管理会計】消費税率変更 ||       |                                                  
13641 M|                .LineStyle = xlContinuous         ||13578 R|                .LineStyle = xlContinuous         
13642 M|                .Weight = xlThin                  ||13579 R|                .Weight = xlThin                  
       |                                                  ||13580 R|            End With                              
17790 M|        Else                                      ||13581 R|        Else                                      
17791 M|        End If                                    ||13582 R|        End If                                    
13659 L|        Else                                      ||17511 M|        Else                                      
13660 L|        End If                                    ||17512 M|        End If                                    
13661 L|                                                  ||       |                                                  
13662  |        '支払先                                   ||13583  |        '支払先                                   
13663  |        .Cells(52, 2).Value = sWord12             ||13584  |        .Cells(52, 2).Value = sWord12             
13664  |        .Cells(52, 11).Value = sWord19            ||13585  |        .Cells(52, 11).Value = sWord19            
13665  |        .Cells(52, 13).Value = gbuMGetUPDRec.N(lRe||13586  |        .Cells(52, 13).Value = gbuMGetUPDRec.N(lRe
13666  |        '支払予定日                               ||13587  |        '支払予定日                               
13667  |        .Cells(54, 2).Value = sWord13             ||13588  |        .Cells(54, 2).Value = sWord13             
13668  |        .Cells(54, 11).Value = sWord19            ||13589  |        .Cells(54, 11).Value = sWord19            
13669  |        '支払予定日                               ||13590  |        '支払予定日                               
13670  |        sDate = Trim(mstrPaymentDate)             ||13591  |        sDate = Trim(mstrPaymentDate)             
13671  |        .Cells(54, 13).Value = _                  ||13592  |        .Cells(54, 13).Value = _                  
13672  |            Format(sDate, "YYYY") & WordYear & _  ||13593  |            Format(sDate, "YYYY") & WordYear & _  
13673  |            Format(sDate, "M") & WordMonth & _    ||13594  |            Format(sDate, "M") & WordMonth & _    
13674  |            Format(sDate, "D") & WordDay          ||13595  |            Format(sDate, "D") & WordDay          
13675  |        '部署名                                   ||13596  |        '部署名                                   
13676  |        'コンボ左の数字取得                       ||13597  |        'コンボ左の数字取得                       
13677  |        ColNum = Trim(gstrComboCodeGet(cboBumonFla||13598  |        ColNum = Trim(gstrComboCodeGet(cboBumonFla
13678  |        'コンボ「：」以下の文字列                 ||13599  |        'コンボ「：」以下の文字列                 
13679  |        ColWord = Trim(gstrComboDataGet(cboBumonFl||13600  |        ColWord = Trim(gstrComboDataGet(cboBumonFl
13680  |        .Cells(56, 2).Value = ColWord             ||13601  |        .Cells(56, 2).Value = ColWord             
13681  |        .Range("B56:S56").HorizontalAlignment = xl||13602  |        .Range("B56:S56").HorizontalAlignment = xl
13682  |        '担当者印                                 ||13603  |        '担当者印                                 
13683  |        .Cells(57, 2).Value = sWord15             ||13604  |        .Cells(57, 2).Value = sWord15             
13684  |        .Range("B57:J57").HorizontalAlignment = xl||13605  |        .Range("B57:J57").HorizontalAlignment = xl
13685  |        '検印                                     ||13606  |        '検印                                     
13686  |        .Cells(57, 11).Value = sWord16            ||13607  |        .Cells(57, 11).Value = sWord16            
13687  |        .Range("K57:S57").HorizontalAlignment = xl||13608  |        .Range("K57:S57").HorizontalAlignment = xl
13688  |        '財務部                                   ||13609  |        '財務部                                   
13689  |        .Cells(56, 24).Value = sWord35            ||13610  |        .Cells(56, 24).Value = sWord35            
13690  |        .Range("X56:AO56").HorizontalAlignment = x||13611  |        .Range("X56:AO56").HorizontalAlignment = x
13691  |        '精査印                                   ||13612  |        '精査印                                   
13692  |        .Cells(57, 24).Value = sWord17            ||13613  |        .Cells(57, 24).Value = sWord17            
13693  |        .Range("X57:AF57").HorizontalAlignment = x||13614  |        .Range("X57:AF57").HorizontalAlignment = x
13694  |        '検印                                     ||13615  |        '検印                                     
13695  |        .Cells(57, 33).Value = sWord16            ||13616  |        .Cells(57, 33).Value = sWord16            
13696  |        .Range("AG57:AO57").HorizontalAlignment = ||13617  |        .Range("AG57:AO57").HorizontalAlignment = 
13697  |                                                  ||13618  |                                                  
13698  |    End With                                      ||13619  |    End With                                      
13699  |                                                  ||13620  |                                                  
13700  |    '月末純資産(外枠)                             ||13621  |    '月末純資産(外枠)                             
13701  |    With xlSheet.Range("N19:AN33").Borders(xlEdgeL||13622  |    With xlSheet.Range("N19:AN33").Borders(xlEdgeL
13702  |        .LineStyle = xlContinuous                 ||13623  |        .LineStyle = xlContinuous                 
13703  |        .Weight = xlThin                          ||13624  |        .Weight = xlThin                          
13704  |    End With                                      ||13625  |    End With                                      
13705  |    With xlSheet.Range("N19:AN33").Borders(xlEdgeT||13626  |    With xlSheet.Range("N19:AN33").Borders(xlEdgeT
13706  |        .LineStyle = xlContinuous                 ||13627  |        .LineStyle = xlContinuous                 
13707  |        .Weight = xlThin                          ||13628  |        .Weight = xlThin                          
13708  |    End With                                      ||13629  |    End With                                      
13709  |    With xlSheet.Range("N19:AN33").Borders(xlEdgeB||13630  |    With xlSheet.Range("N19:AN33").Borders(xlEdgeB
13710  |        .LineStyle = xlContinuous                 ||13631  |        .LineStyle = xlContinuous                 
13711  |        .Weight = xlThin                          ||13632  |        .Weight = xlThin                          
13712  |    End With                                      ||13633  |    End With                                      
13713  |    With xlSheet.Range("N19:AN33").Borders(xlEdgeR||13634  |    With xlSheet.Range("N19:AN33").Borders(xlEdgeR
13714  |        .LineStyle = xlContinuous                 ||13635  |        .LineStyle = xlContinuous                 
13715  |        .Weight = xlThin                          ||13636  |        .Weight = xlThin                          
13716  |    End With                                      ||13637  |    End With                                      
13717  |    With xlSheet.Range("N19:AN33").Borders(xlInsid||13638  |    With xlSheet.Range("N19:AN33").Borders(xlInsid
13718  |        .LineStyle = xlContinuous                 ||13639  |        .LineStyle = xlContinuous                 
13719  |        .Weight = xlThin                          ||13640  |        .Weight = xlThin                          
13720  |    End With                                      ||13641  |    End With                                      
13721  |    '月末純資産(真中縦線)                         ||13642  |    '月末純資産(真中縦線)                         
13722  |    With xlSheet.Range("Y19:Y33").Borders(xlEdgeRi||13643  |    With xlSheet.Range("Y19:Y33").Borders(xlEdgeRi
13723  |        .LineStyle = xlContinuous                 ||13644  |        .LineStyle = xlContinuous                 
13724  |        .Weight = xlThin                          ||13645  |        .Weight = xlThin                          
13725  |    End With                                      ||13646  |    End With                                      
13726  |    '月末純資産(左側捺印欄　外枠)                 ||13647  |    '月末純資産(左側捺印欄　外枠)                 
13727  |    With xlSheet.Range("B56:S63").Borders(xlEdgeLe||13648  |    With xlSheet.Range("B56:S63").Borders(xlEdgeLe
13728  |        .LineStyle = xlContinuous                 ||13649  |        .LineStyle = xlContinuous                 
13729  |        .Weight = xlThin                          ||13650  |        .Weight = xlThin                          
13730  |    End With                                      ||13651  |    End With                                      
13731  |    With xlSheet.Range("B56:S63").Borders(xlEdgeTo||13652  |    With xlSheet.Range("B56:S63").Borders(xlEdgeTo
13732  |        .LineStyle = xlContinuous                 ||13653  |        .LineStyle = xlContinuous                 
13733  |        .Weight = xlThin                          ||13654  |        .Weight = xlThin                          
13734  |    End With                                      ||13655  |    End With                                      
13735  |    With xlSheet.Range("B56:S63").Borders(xlEdgeBo||13656  |    With xlSheet.Range("B56:S63").Borders(xlEdgeBo
13736  |        .LineStyle = xlContinuous                 ||13657  |        .LineStyle = xlContinuous                 
13737  |        .Weight = xlThin                          ||13658  |        .Weight = xlThin                          
13738  |    End With                                      ||13659  |    End With                                      
13739  |    With xlSheet.Range("B56:S63").Borders(xlEdgeRi||13660  |    With xlSheet.Range("B56:S63").Borders(xlEdgeRi
13740  |        .LineStyle = xlContinuous                 ||13661  |        .LineStyle = xlContinuous                 
13741  |        .Weight = xlThin                          ||13662  |        .Weight = xlThin                          
13742  |    End With                                      ||13663  |    End With                                      
13743  |    '月末純資産(左側捺印欄　上枠)                 ||13664  |    '月末純資産(左側捺印欄　上枠)                 
13744  |    With xlSheet.Range("B56:S57").Borders(xlEdgeBo||13665  |    With xlSheet.Range("B56:S57").Borders(xlEdgeBo
13745  |        .LineStyle = xlContinuous                 ||13666  |        .LineStyle = xlContinuous                 
13746  |        .Weight = xlThin                          ||13667  |        .Weight = xlThin                          
13747  |    End With                                      ||13668  |    End With                                      
13748  |    With xlSheet.Range("B56:S57").Borders(xlInside||13669  |    With xlSheet.Range("B56:S57").Borders(xlInside
13749  |        .LineStyle = xlContinuous                 ||13670  |        .LineStyle = xlContinuous                 
13750  |        .Weight = xlThin                          ||13671  |        .Weight = xlThin                          
13751  |    End With                                      ||13672  |    End With                                      
13752  |    '月末純資産(左側捺印欄　縦線)                 ||13673  |    '月末純資産(左側捺印欄　縦線)                 
13753  |    With xlSheet.Range("J57:J63").Borders(xlEdgeRi||13674  |    With xlSheet.Range("J57:J63").Borders(xlEdgeRi
13754  |        .LineStyle = xlContinuous                 ||13675  |        .LineStyle = xlContinuous                 
13755  |        .Weight = xlThin                          ||13676  |        .Weight = xlThin                          
13756  |    End With                                      ||13677  |    End With                                      
13757  |    '月末純資産(右側捺印欄　外枠)                 ||13678  |    '月末純資産(右側捺印欄　外枠)                 
13758  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeL||13679  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeL
13759  |        .LineStyle = xlContinuous                 ||13680  |        .LineStyle = xlContinuous                 
13760  |        .Weight = xlThin                          ||13681  |        .Weight = xlThin                          
13761  |    End With                                      ||13682  |    End With                                      
13762  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeT||13683  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeT
13763  |        .LineStyle = xlContinuous                 ||13684  |        .LineStyle = xlContinuous                 
13764  |        .Weight = xlThin                          ||13685  |        .Weight = xlThin                          
13765  |    End With                                      ||13686  |    End With                                      
13766  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeB||13687  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeB
13767  |        .LineStyle = xlContinuous                 ||13688  |        .LineStyle = xlContinuous                 
13768  |        .Weight = xlThin                          ||13689  |        .Weight = xlThin                          
13769  |    End With                                      ||13690  |    End With                                      
13770  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeR||13691  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeR
13771  |        .LineStyle = xlContinuous                 ||13692  |        .LineStyle = xlContinuous                 
13772  |        .Weight = xlThin                          ||13693  |        .Weight = xlThin                          
13773  |    End With                                      ||13694  |    End With                                      
13774  |    '月末純資産(右側捺印欄　上枠)                 ||13695  |    '月末純資産(右側捺印欄　上枠)                 
13775  |    With xlSheet.Range("X56:AO57").Borders(xlEdgeT||13696  |    With xlSheet.Range("X56:AO57").Borders(xlEdgeT
13776  |        .LineStyle = xlContinuous                 ||13697  |        .LineStyle = xlContinuous                 
13777  |        .Weight = xlThin                          ||13698  |        .Weight = xlThin                          
13778  |    End With                                      ||13699  |    End With                                      
13779  |    With xlSheet.Range("X56:AO57").Borders(xlEdgeB||13700  |    With xlSheet.Range("X56:AO57").Borders(xlEdgeB
13780  |        .LineStyle = xlContinuous                 ||13701  |        .LineStyle = xlContinuous                 
13781  |        .Weight = xlThin                          ||13702  |        .Weight = xlThin                          
13782  |    End With                                      ||13703  |    End With                                      
13783  |    With xlSheet.Range("X56:AO57").Borders(xlInsid||13704  |    With xlSheet.Range("X56:AO57").Borders(xlInsid
13784  |        .LineStyle = xlContinuous                 ||13705  |        .LineStyle = xlContinuous                 
13785  |        .Weight = xlThin                          ||13706  |        .Weight = xlThin                          
13786  |    End With                                      ||13707  |    End With                                      
13787  |    '月末純資産(右側捺印欄　縦線)                 ||13708  |    '月末純資産(右側捺印欄　縦線)                 
13788  |    With xlSheet.Range("AF57:AF63").Borders(xlEdge||13709  |    With xlSheet.Range("AF57:AF63").Borders(xlEdge
13789  |        .LineStyle = xlContinuous                 ||13710  |        .LineStyle = xlContinuous                 
13790  |        .Weight = xlThin                          ||13711  |        .Weight = xlThin                          
13791  |    End With                                      ||13712  |    End With                                      
13792  |                                                  ||13713  |                                                  
13793  |                                                  ||13714  |                                                  
13794  |    '月末純資産　下線                             ||13715  |    '月末純資産　下線                             
13795  |    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract_||13716  |    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract_
13796  |    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||13717  |    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
13797  |        xlSheet.Cells(15, 13).Value = _           ||13718  |        xlSheet.Cells(15, 13).Value = _           
13798  |            CStr(Format(dStart, "YYYY年M月D日")) &||13719  |            CStr(Format(dStart, "YYYY年M月D日")) &
13799  |    Else                                          ||13720  |    Else                                          
13800  |        xlSheet.Cells(15, 13).Value = _           ||13721  |        xlSheet.Cells(15, 13).Value = _           
13801  |            CStr(Format(dStart, "YYYY年M月D日")) &||13722  |            CStr(Format(dStart, "YYYY年M月D日")) &
13802  |    End If                                        ||13723  |    End If                                        
13803  |    'A4印刷用に上2行を削除して、プレビュー範囲内に||13724  |    'A4印刷用に上2行を削除して、プレビュー範囲内に
13804  |    xlSheet.Rows("1:2").Delete Shift:=xlUp        ||13725  |    xlSheet.Rows("1:2").Delete Shift:=xlUp        
13805  |                                                  ||13726  |                                                  
13806  |'=================================================||13727  |'=================================================
13807  |'== 　　　　日次NAV/日時時価総額の別表作成エリア  ||13728  |'== 　　　　日次NAV/日時時価総額の別表作成エリア  
13808  |'=================================================||13729  |'=================================================
13809  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||13730  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
13810  |'    'NAV取得区分：日次NAV平均(休日有)または日次NA||13731  |'    'NAV取得区分：日次NAV平均(休日有)または日次NA
13811  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||13732  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
13812  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||13733  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
13813  |                                                  ||13734  |                                                  
13814  |    'NAV取得区分：日次NAV平均(休日有)、日次NAV平均||13735  |    'NAV取得区分：日次NAV平均(休日有)、日次NAV平均
13815  |    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag ||13736  |    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag 
13816  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||13737  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
13817  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||13738  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
13818  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||13739  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
13819  |                                                  ||13740  |                                                  
13820  |        gTotalDnavCnt = 0                         ||13741  |        gTotalDnavCnt = 0                         
13821  |        J = 0                                     ||13742  |        J = 0                                     
13822  |        K = 0                                     ||13743  |        K = 0                                     
13823  |        '＋２は合計行と平均行                     ||13744  |        '＋２は合計行と平均行                     
13824  |        dintPage = (dlngCnt + 2) \ 108            ||13745  |        dintPage = (dlngCnt + 2) \ 108            
13825  |        dintAmari = (dlngCnt + 2) Mod 108         ||13746  |        dintAmari = (dlngCnt + 2) Mod 108         
13826  |        If dintAmari <> 0 Then                    ||13747  |        If dintAmari <> 0 Then                    
13827  |            dintPage = dintPage + 1               ||13748  |            dintPage = dintPage + 1               
13828  |        End If                                    ||13749  |        End If                                    
13829  |                                                  ||13750  |                                                  
13830  |        For L = 1 To dintPage                     ||13751  |        For L = 1 To dintPage                     
13831  |                                                  ||13752  |                                                  
13832  |            xlBook.Worksheets.Add after:=xlBook.Sh||13753  |            xlBook.Worksheets.Add after:=xlBook.Sh
13833  |            gProcessCnt = gProcessCnt + 1         ||13754  |            gProcessCnt = gProcessCnt + 1         
13834  |            Set xlSheet = xlBook.Sheets(gProcessCn||13755  |            Set xlSheet = xlBook.Sheets(gProcessCn
13835  |                                                  ||13756  |                                                  
13836  |            'Excelフォーマットを調整              ||13757  |            'Excelフォーマットを調整              
13837  |            xlSheet.Cells.ColumnWidth = 1         ||13758  |            xlSheet.Cells.ColumnWidth = 1         
13838  |            xlSheet.Cells.Font.Size = 11          ||13759  |            xlSheet.Cells.Font.Size = 11          
13839  |            'シート名を設定(日次NAV一覧**)        ||13760  |            'シート名を設定(日次NAV一覧**)        
13840  |            'RAFI対応 START                       ||13761  |            'RAFI対応 START                       
13841  |            '純資産の場合                         ||13762  |            '純資産の場合                         
13842  |            If msAssetFlg = "0" Then              ||13763  |            If msAssetFlg = "0" Then              
13843  |                If dstrOldAccCode = sGetAccCode Th||13764  |                If dstrOldAccCode = sGetAccCode Th
13844  |                    gTotalDnavCnt = gTotalDnavCnt ||13765  |                    gTotalDnavCnt = gTotalDnavCnt 
13845  |                Else                              ||13766  |                Else                              
13846  |                    gTotalDnavCnt = 1             ||13767  |                    gTotalDnavCnt = 1             
13847  |                    dstrOldAccCode = sGetAccCode  ||13768  |                    dstrOldAccCode = sGetAccCode  
13848  |                End If                            ||13769  |                End If                            
13849  |            'マザー組入資産の場合                 ||13770  |            'マザー組入資産の場合                 
13850  |            Else                                  ||13771  |            Else                                  
13851  |                If dstrOldAccCode = msBabyAccountC||13772  |                If dstrOldAccCode = msBabyAccountC
13852  |                    gTotalDnavCnt = gTotalDnavCnt ||13773  |                    gTotalDnavCnt = gTotalDnavCnt 
13853  |                Else                              ||13774  |                Else                              
13854  |                    gTotalDnavCnt = 1             ||13775  |                    gTotalDnavCnt = 1             
13855  |                    dstrOldAccCode = msBabyAccount||13776  |                    dstrOldAccCode = msBabyAccount
13856  |                End If                            ||13777  |                End If                            
13857  |            End If                                ||13778  |            End If                                
13858  |            'RAFI対応 END                         ||13779  |            'RAFI対応 END                         
13859  |                                                  ||13780  |                                                  
13860  |            'gTotalCnt = gTotalCnt + 1            ||13781  |            'gTotalCnt = gTotalCnt + 1            
13861  |            'RAFI対応 START                       ||13782  |            'RAFI対応 START                       
13862  |            '純資産の場合                         ||13783  |            '純資産の場合                         
13863  |            If msAssetFlg = "0" Then              ||13784  |            If msAssetFlg = "0" Then              
13864  |                '複数ページの場合                 ||13785  |                '複数ページの場合                 
13865  |                If dintPage > 1 Then              ||13786  |                If dintPage > 1 Then              
13866  |                    xlBook.Sheets(gProcessCnt).Nam||13787  |                    xlBook.Sheets(gProcessCnt).Nam
13867  |                Else                              ||13788  |                Else                              
13868  |                    xlBook.Sheets(gProcessCnt).Nam||13789  |                    xlBook.Sheets(gProcessCnt).Nam
13869  |                End If                            ||13790  |                End If                            
13870  |            'マザー組入資産の場合                 ||13791  |            'マザー組入資産の場合                 
13871  |            Else                                  ||13792  |            Else                                  
13872  |                '複数ページの場合                 ||13793  |                '複数ページの場合                 
13873  |                If dintPage > 1 Then              ||13794  |                If dintPage > 1 Then              
13874  |                    xlBook.Sheets(gProcessCnt).Nam||13795  |                    xlBook.Sheets(gProcessCnt).Nam
13875  |                Else                              ||13796  |                Else                              
13876  |                    xlBook.Sheets(gProcessCnt).Nam||13797  |                    xlBook.Sheets(gProcessCnt).Nam
13877  |                End If                            ||13798  |                End If                            
13878  |            End If                                ||13799  |            End If                                
13879  |            'RAFI対応 END                         ||13800  |            'RAFI対応 END                         
13880  |            'シートの余白を設定                   ||13801  |            'シートの余白を設定                   
13881  |            xlSheet.PageSetup.TopMargin = Applicat||13802  |            xlSheet.PageSetup.TopMargin = Applicat
13882  |            xlSheet.PageSetup.BottomMargin = Appli||13803  |            xlSheet.PageSetup.BottomMargin = Appli
13883  |            xlSheet.PageSetup.LeftMargin = Applica||13804  |            xlSheet.PageSetup.LeftMargin = Applica
13884  |            xlSheet.PageSetup.RightMargin = Applic||13805  |            xlSheet.PageSetup.RightMargin = Applic
13885  |                                                  ||13806  |                                                  
13886  |            DoEvents                              ||13807  |            DoEvents                              
13887  |                                                  ||13808  |                                                  
13888  |            With xlSheet                          ||13809  |            With xlSheet                          
13889  |                '題目                             ||13810  |                '題目                             
13890  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||13811  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
13891  |                '取得NAV区分が4:日次時価総額平均の||13812  |                '取得NAV区分が4:日次時価総額平均の
13892  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||13813  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
13893  |                    .Cells(5, 1).Value = sWord63  ||13814  |                    .Cells(5, 1).Value = sWord63  
13894  |                Else                              ||13815  |                Else                              
13895  |                    .Cells(5, 1).Value = sWord47  ||13816  |                    .Cells(5, 1).Value = sWord47  
13896  |                End If                            ||13817  |                End If                            
13897  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||13818  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
13898  |                .Cells(5, 1).Font.Size = 14       ||13819  |                .Cells(5, 1).Font.Size = 14       
13899  |                .Range("A5:BG5").HorizontalAlignme||13820  |                .Range("A5:BG5").HorizontalAlignme
13900  |                '出力日付                         ||13821  |                '出力日付                         
13901  |                If RTrim(txtSysOutDate.Text) = "" ||13822  |                If RTrim(txtSysOutDate.Text) = "" 
13902  |                    .Cells(3, 50).Value = sWord34 ||13823  |                    .Cells(3, 50).Value = sWord34 
13903  |                    .Cells(3, 50).HorizontalAlignm||13824  |                    .Cells(3, 50).HorizontalAlignm
13904  |                Else                              ||13825  |                Else                              
13905  |                    .Cells(3, 43).Value = CStr(For||13826  |                    .Cells(3, 43).Value = CStr(For
13906  |                End If                            ||13827  |                End If                            
13907  |                'ファンド名                       ||13828  |                'ファンド名                       
13908  |                .Cells(6, 2).Value = sWord4       ||13829  |                .Cells(6, 2).Value = sWord4       
13909  |                .Cells(6, 11).Value = sWord19     ||13830  |                .Cells(6, 11).Value = sWord19     
13910  |                .Cells(6, 13).Value = gbuMGetUPDRe||13831  |                .Cells(6, 13).Value = gbuMGetUPDRe
13911  |                'ファンドコード                   ||13832  |                'ファンドコード                   
13912  |                .Cells(7, 2).Value = sWord4_2     ||13833  |                .Cells(7, 2).Value = sWord4_2     
13913  |                .Cells(7, 11).Value = sWord19     ||13834  |                .Cells(7, 11).Value = sWord19     
13914  |                .Cells(7, 13).NumberFormatLocal = ||13835  |                .Cells(7, 13).NumberFormatLocal = 
13915  |                'RAFI対応 START                   ||13836  |                'RAFI対応 START                   
13916  |                '純資産の場合                     ||13837  |                '純資産の場合                     
13917  |                If msAssetFlg = "0" Then          ||13838  |                If msAssetFlg = "0" Then          
13918  |                    .Cells(7, 13).Value = sGetAccC||13839  |                    .Cells(7, 13).Value = sGetAccC
13919  |                'マザー組入資産の場合             ||13840  |                'マザー組入資産の場合             
13920  |                Else                              ||13841  |                Else                              
13921  |                    .Cells(7, 13).Value = msBabyAc||13842  |                    .Cells(7, 13).Value = msBabyAc
13922  |                End If                            ||13843  |                End If                            
13923  |                'RAFI対応 END                     ||13844  |                'RAFI対応 END                     
13924  |                                                  ||13845  |                                                  
13925  |                '計算期間                         ||13846  |                '計算期間                         
13926  |                .Cells(8, 2).Value = sWord5       ||13847  |                .Cells(8, 2).Value = sWord5       
13927  |                .Cells(8, 11).Value = sWord19     ||13848  |                .Cells(8, 11).Value = sWord19     
13928  |                If Mid(gbuMGetUPDRec.N(lRecIdx).MG||13849  |                If Mid(gbuMGetUPDRec.N(lRecIdx).MG
13929  |                And gbuMGetUPDRec.N(lRecIdx).MGET_||13850  |                And gbuMGetUPDRec.N(lRecIdx).MGET_
13930  |                    .Cells(8, 13).Value = _       ||13851  |                    .Cells(8, 13).Value = _       
13931  |                        CStr(Format(dStart, "YYYY ||13852  |                        CStr(Format(dStart, "YYYY 
13932  |                Else                              ||13853  |                Else                              
13933  |                    .Cells(8, 13).Value = _       ||13854  |                    .Cells(8, 13).Value = _       
13934  |                        CStr(Format(dStart, "YYYY ||13855  |                        CStr(Format(dStart, "YYYY 
13935  |                End If                            ||13856  |                End If                            
13936  |                '日付                             ||13857  |                '日付                             
13937  |                .Cells(10, 3).Value = sWord7      ||13858  |                .Cells(10, 3).Value = sWord7      
13938  |                .Range("C10:N10").HorizontalAlignm||13859  |                .Range("C10:N10").HorizontalAlignm
13939  |                '純資産                           ||13860  |                '純資産                           
13940  |                .Cells(10, 15).Value = sWord8     ||13861  |                .Cells(10, 15).Value = sWord8     
13941  |                .Range("O10:AC10").HorizontalAlign||13862  |                .Range("O10:AC10").HorizontalAlign
13942  |                '日付                             ||13863  |                '日付                             
13943  |                .Cells(10, 31).Value = sWord7     ||13864  |                .Cells(10, 31).Value = sWord7     
13944  |                .Range("AE10:AP10").HorizontalAlig||13865  |                .Range("AE10:AP10").HorizontalAlig
13945  |                '純資産                           ||13866  |                '純資産                           
13946  |                .Cells(10, 43).Value = sWord8     ||13867  |                .Cells(10, 43).Value = sWord8     
13947  |                .Range("AQ10:BE10").HorizontalAlig||13868  |                .Range("AQ10:BE10").HorizontalAlig
13948  |                '日付＆NAV                        ||13869  |                '日付＆NAV                        
13949  |                Select Case L                     ||13870  |                Select Case L                     
13950  |                    Case 1                        ||13871  |                    Case 1                        
13951  |                        dintPageIni = 1           ||13872  |                        dintPageIni = 1           
13952  |                    Case Else                     ||13873  |                    Case Else                     
13953  |                        dintPageIni = dintPageIni ||13874  |                        dintPageIni = dintPageIni 
13954  |                End Select                        ||13875  |                End Select                        
13955  |                For dintFor = dintPageIni To dlngC||13876  |                For dintFor = dintPageIni To dlngC
13956  |                    If J < 54 Then                ||13877  |                    If J < 54 Then                
13957  |                        If dintFor = dlngCnt + 1 T||13878  |                        If dintFor = dlngCnt + 1 T
13958  |                            '合計                 ||13879  |                            '合計                 
13959  |                            .Cells(11 + J, 3).Valu||13880  |                            .Cells(11 + J, 3).Valu
13960  |                            'NAV                  ||13881  |                            'NAV                  
13961  |                            .Cells(11 + J, 28).Num||13882  |                            .Cells(11 + J, 28).Num
13962  |                            If gbuMGetUPDRec.N(lRe||13883  |                            If gbuMGetUPDRec.N(lRe
13963  |                                .Cells(11 + J, 28)||13884  |                                .Cells(11 + J, 28)
13964  |                            Else                  ||13885  |                            Else                  
13965  |                                .Cells(11 + J, 28)||13886  |                                .Cells(11 + J, 28)
13966  |                            End If                ||13887  |                            End If                
13967  |                            .Cells(11 + J, 28).Hor||13888  |                            .Cells(11 + J, 28).Hor
13968  |                        End If                    ||13889  |                        End If                    
13969  |                        If dintFor = dlngCnt + 2 T||13890  |                        If dintFor = dlngCnt + 2 T
13970  |                            '平均                 ||13891  |                            '平均                 
13971  |                            .Cells(11 + J, 3).Valu||13892  |                            .Cells(11 + J, 3).Valu
13972  |                            'NAV                  ||13893  |                            'NAV                  
13973  |                            .Cells(11 + J, 28).Num||13894  |                            .Cells(11 + J, 28).Num
13974  |                            If gbuMGetUPDRec.N(lRe||13895  |                            If gbuMGetUPDRec.N(lRe
13975  |                                .Cells(11 + J, 28)||13896  |                                .Cells(11 + J, 28)
13976  |                            Else                  ||13897  |                            Else                  
13977  |                                .Cells(11 + J, 28)||13898  |                                .Cells(11 + J, 28)
13978  |                            End If                ||13899  |                            End If                
13979  |                            .Cells(11 + J, 28).Hor||13900  |                            .Cells(11 + J, 28).Hor
13980  |                        End If                    ||13901  |                        End If                    
13981  |                        If dintFor < dlngCnt + 1 T||13902  |                        If dintFor < dlngCnt + 1 T
13982  |                            '日付                 ||13903  |                            '日付                 
13983  |                            dCalDate = CDate(gstrD||13904  |                            dCalDate = CDate(gstrD
13984  |                            .Cells(11 + J, 4).Valu||13905  |                            .Cells(11 + J, 4).Valu
13985  |                                CStr(Format(dCalDa||13906  |                                CStr(Format(dCalDa
13986  |                            'NAV                  ||13907  |                            'NAV                  
13987  |                            .Cells(11 + J, 28).Num||13908  |                            .Cells(11 + J, 28).Num
13988  |                            If gbuMGetUPDRec.N(lRe||13909  |                            If gbuMGetUPDRec.N(lRe
13989  |                                .Cells(11 + J, 28)||13910  |                                .Cells(11 + J, 28)
13990  |                            Else                  ||13911  |                            Else                  
13991  |                                .Cells(11 + J, 28)||13912  |                                .Cells(11 + J, 28)
13992  |                            End If                ||13913  |                            End If                
13993  |                            .Cells(11 + J, 28).Hor||13914  |                            .Cells(11 + J, 28).Hor
13994  |                        End If                    ||13915  |                        End If                    
13995  |                    Else                          ||13916  |                    Else                          
13996  |                        If dintFor = dlngCnt + 1 T||13917  |                        If dintFor = dlngCnt + 1 T
13997  |                            '合計                 ||13918  |                            '合計                 
13998  |                            .Cells(11 + K, 31).Val||13919  |                            .Cells(11 + K, 31).Val
13999  |                            'NAV                  ||13920  |                            'NAV                  
14000  |                            .Cells(11 + K, 56).Num||13921  |                            .Cells(11 + K, 56).Num
14001  |                            If gbuMGetUPDRec.N(lRe||13922  |                            If gbuMGetUPDRec.N(lRe
14002  |                                .Cells(11 + K, 56)||13923  |                                .Cells(11 + K, 56)
14003  |                            Else                  ||13924  |                            Else                  
14004  |                                .Cells(11 + K, 56)||13925  |                                .Cells(11 + K, 56)
14005  |                            End If                ||13926  |                            End If                
14006  |                            .Cells(11 + K, 56).Hor||13927  |                            .Cells(11 + K, 56).Hor
14007  |                        End If                    ||13928  |                        End If                    
14008  |                        If dintFor = dlngCnt + 2 T||13929  |                        If dintFor = dlngCnt + 2 T
14009  |                            '平均                 ||13930  |                            '平均                 
14010  |                            .Cells(11 + K, 31).Val||13931  |                            .Cells(11 + K, 31).Val
14011  |                            'NAV                  ||13932  |                            'NAV                  
14012  |                            .Cells(11 + K, 56).Num||13933  |                            .Cells(11 + K, 56).Num
14013  |                            If gbuMGetUPDRec.N(lRe||13934  |                            If gbuMGetUPDRec.N(lRe
14014  |                                .Cells(11 + K, 56)||13935  |                                .Cells(11 + K, 56)
14015  |                            Else                  ||13936  |                            Else                  
14016  |                                .Cells(11 + K, 56)||13937  |                                .Cells(11 + K, 56)
14017  |                            End If                ||13938  |                            End If                
14018  |                            .Cells(11 + K, 56).Hor||13939  |                            .Cells(11 + K, 56).Hor
14019  |                        End If                    ||13940  |                        End If                    
14020  |                        If dintFor < dlngCnt + 1 T||13941  |                        If dintFor < dlngCnt + 1 T
14021  |                            '日付                 ||13942  |                            '日付                 
14022  |                            dCalDate = CDate(gstrD||13943  |                            dCalDate = CDate(gstrD
14023  |                            .Cells(11 + K, 32).Val||13944  |                            .Cells(11 + K, 32).Val
14024  |                                CStr(Format(dCalDa||13945  |                                CStr(Format(dCalDa
14025  |                            'NAV                  ||13946  |                            'NAV                  
14026  |                            .Cells(11 + K, 56).Num||13947  |                            .Cells(11 + K, 56).Num
14027  |                            If gbuMGetUPDRec.N(lRe||13948  |                            If gbuMGetUPDRec.N(lRe
14028  |                                .Cells(11 + K, 56)||13949  |                                .Cells(11 + K, 56)
14029  |                            Else                  ||13950  |                            Else                  
14030  |                                .Cells(11 + K, 56)||13951  |                                .Cells(11 + K, 56)
14031  |                            End If                ||13952  |                            End If                
14032  |                            .Cells(11 + K, 56).Hor||13953  |                            .Cells(11 + K, 56).Hor
14033  |                        End If                    ||13954  |                        End If                    
14034  |                        K = K + 1                 ||13955  |                        K = K + 1                 
14035  |                        If K > 53 Then            ||13956  |                        If K > 53 Then            
14036  |                            J = 0                 ||13957  |                            J = 0                 
14037  |                            K = 0                 ||13958  |                            K = 0                 
14038  |                            Exit For              ||13959  |                            Exit For              
14039  |                        End If                    ||13960  |                        End If                    
14040  |                    End If                        ||13961  |                    End If                        
14041  |                    J = J + 1                     ||13962  |                    J = J + 1                     
14042  |                Next dintFor                      ||13963  |                Next dintFor                      
14043  |                                                  ||13964  |                                                  
14044  |                '左側日付                         ||13965  |                '左側日付                         
14045  |                With xlSheet.Range("C10:N64").Bord||13966  |                With xlSheet.Range("C10:N64").Bord
14046  |                    .LineStyle = xlContinuous     ||13967  |                    .LineStyle = xlContinuous     
14047  |                    .Weight = xlThin              ||13968  |                    .Weight = xlThin              
14048  |                End With                          ||13969  |                End With                          
14049  |                With xlSheet.Range("C10:N64").Bord||13970  |                With xlSheet.Range("C10:N64").Bord
14050  |                    .LineStyle = xlContinuous     ||13971  |                    .LineStyle = xlContinuous     
14051  |                    .Weight = xlThin              ||13972  |                    .Weight = xlThin              
14052  |                End With                          ||13973  |                End With                          
14053  |                With xlSheet.Range("C10:N64").Bord||13974  |                With xlSheet.Range("C10:N64").Bord
14054  |                    .LineStyle = xlContinuous     ||13975  |                    .LineStyle = xlContinuous     
14055  |                    .Weight = xlThin              ||13976  |                    .Weight = xlThin              
14056  |                End With                          ||13977  |                End With                          
14057  |                With xlSheet.Range("C10:N64").Bord||13978  |                With xlSheet.Range("C10:N64").Bord
14058  |                    .LineStyle = xlContinuous     ||13979  |                    .LineStyle = xlContinuous     
14059  |                    .Weight = xlThin              ||13980  |                    .Weight = xlThin              
14060  |                End With                          ||13981  |                End With                          
14061  |                With xlSheet.Range("C10:N64").Bord||13982  |                With xlSheet.Range("C10:N64").Bord
14062  |                    .LineStyle = xlContinuous     ||13983  |                    .LineStyle = xlContinuous     
14063  |                    .Weight = xlThin              ||13984  |                    .Weight = xlThin              
14064  |                End With                          ||13985  |                End With                          
14065  |                                                  ||13986  |                                                  
14066  |                '左側純資産                       ||13987  |                '左側純資産                       
14067  |                With xlSheet.Range("O10:AC64").Bor||13988  |                With xlSheet.Range("O10:AC64").Bor
14068  |                    .LineStyle = xlContinuous     ||13989  |                    .LineStyle = xlContinuous     
14069  |                    .Weight = xlThin              ||13990  |                    .Weight = xlThin              
14070  |                End With                          ||13991  |                End With                          
14071  |                With xlSheet.Range("O10:AC64").Bor||13992  |                With xlSheet.Range("O10:AC64").Bor
14072  |                    .LineStyle = xlContinuous     ||13993  |                    .LineStyle = xlContinuous     
14073  |                    .Weight = xlThin              ||13994  |                    .Weight = xlThin              
14074  |                End With                          ||13995  |                End With                          
14075  |                With xlSheet.Range("O10:AC64").Bor||13996  |                With xlSheet.Range("O10:AC64").Bor
14076  |                    .LineStyle = xlContinuous     ||13997  |                    .LineStyle = xlContinuous     
14077  |                    .Weight = xlThin              ||13998  |                    .Weight = xlThin              
14078  |                End With                          ||13999  |                End With                          
14079  |                With xlSheet.Range("O10:AC64").Bor||14000  |                With xlSheet.Range("O10:AC64").Bor
14080  |                    .LineStyle = xlContinuous     ||14001  |                    .LineStyle = xlContinuous     
14081  |                    .Weight = xlThin              ||14002  |                    .Weight = xlThin              
14082  |                End With                          ||14003  |                End With                          
14083  |                With xlSheet.Range("O10:AC64").Bor||14004  |                With xlSheet.Range("O10:AC64").Bor
14084  |                    .LineStyle = xlContinuous     ||14005  |                    .LineStyle = xlContinuous     
14085  |                    .Weight = xlThin              ||14006  |                    .Weight = xlThin              
14086  |                End With                          ||14007  |                End With                          
14087  |                                                  ||14008  |                                                  
14088  |                '右側日付                         ||14009  |                '右側日付                         
14089  |                With xlSheet.Range("AE10:AP64").Bo||14010  |                With xlSheet.Range("AE10:AP64").Bo
14090  |                    .LineStyle = xlContinuous     ||14011  |                    .LineStyle = xlContinuous     
14091  |                    .Weight = xlThin              ||14012  |                    .Weight = xlThin              
14092  |                End With                          ||14013  |                End With                          
14093  |                With xlSheet.Range("AE10:AP64").Bo||14014  |                With xlSheet.Range("AE10:AP64").Bo
14094  |                    .LineStyle = xlContinuous     ||14015  |                    .LineStyle = xlContinuous     
14095  |                    .Weight = xlThin              ||14016  |                    .Weight = xlThin              
14096  |                End With                          ||14017  |                End With                          
14097  |                With xlSheet.Range("AE10:AP64").Bo||14018  |                With xlSheet.Range("AE10:AP64").Bo
14098  |                    .LineStyle = xlContinuous     ||14019  |                    .LineStyle = xlContinuous     
14099  |                    .Weight = xlThin              ||14020  |                    .Weight = xlThin              
14100  |                End With                          ||14021  |                End With                          
14101  |                With xlSheet.Range("AE10:AP64").Bo||14022  |                With xlSheet.Range("AE10:AP64").Bo
14102  |                    .LineStyle = xlContinuous     ||14023  |                    .LineStyle = xlContinuous     
14103  |                    .Weight = xlThin              ||14024  |                    .Weight = xlThin              
14104  |                End With                          ||14025  |                End With                          
14105  |                With xlSheet.Range("AE10:AP64").Bo||14026  |                With xlSheet.Range("AE10:AP64").Bo
14106  |                    .LineStyle = xlContinuous     ||14027  |                    .LineStyle = xlContinuous     
14107  |                    .Weight = xlThin              ||14028  |                    .Weight = xlThin              
14108  |                End With                          ||14029  |                End With                          
14109  |                                                  ||14030  |                                                  
14110  |                '右側純資産                       ||14031  |                '右側純資産                       
14111  |                With xlSheet.Range("AQ10:BE64").Bo||14032  |                With xlSheet.Range("AQ10:BE64").Bo
14112  |                    .LineStyle = xlContinuous     ||14033  |                    .LineStyle = xlContinuous     
14113  |                    .Weight = xlThin              ||14034  |                    .Weight = xlThin              
14114  |                End With                          ||14035  |                End With                          
14115  |                With xlSheet.Range("AQ10:BE64").Bo||14036  |                With xlSheet.Range("AQ10:BE64").Bo
14116  |                    .LineStyle = xlContinuous     ||14037  |                    .LineStyle = xlContinuous     
14117  |                    .Weight = xlThin              ||14038  |                    .Weight = xlThin              
14118  |                End With                          ||14039  |                End With                          
14119  |                With xlSheet.Range("AQ10:BE64").Bo||14040  |                With xlSheet.Range("AQ10:BE64").Bo
14120  |                    .LineStyle = xlContinuous     ||14041  |                    .LineStyle = xlContinuous     
14121  |                    .Weight = xlThin              ||14042  |                    .Weight = xlThin              
14122  |                End With                          ||14043  |                End With                          
14123  |                With xlSheet.Range("AQ10:BE64").Bo||14044  |                With xlSheet.Range("AQ10:BE64").Bo
14124  |                    .LineStyle = xlContinuous     ||14045  |                    .LineStyle = xlContinuous     
14125  |                    .Weight = xlThin              ||14046  |                    .Weight = xlThin              
14126  |                End With                          ||14047  |                End With                          
14127  |                With xlSheet.Range("AQ10:BE64").Bo||14048  |                With xlSheet.Range("AQ10:BE64").Bo
14128  |                    .LineStyle = xlContinuous     ||14049  |                    .LineStyle = xlContinuous     
14129  |                    .Weight = xlThin              ||14050  |                    .Weight = xlThin              
14130  |                End With                          ||14051  |                End With                          
14131  |                                                  ||14052  |                                                  
14132  |            End With                              ||14053  |            End With                              
14133  |            'A4印刷用に上2行を削除して、プレビュー||14054  |            'A4印刷用に上2行を削除して、プレビュー
14134  |            xlSheet.Rows("1:2").Delete Shift:=xlUp||14055  |            xlSheet.Rows("1:2").Delete Shift:=xlUp
14135  |        Next L                                    ||14056  |        Next L                                    
14136  |    End If                                        ||14057  |    End If                                        
14137  |    'セル(A1)を選択する                           ||14058  |    'セル(A1)を選択する                           
14138  |                                                  ||14059  |                                                  
14139  |                                                  ||14060  |                                                  
14140  |                                                  ||14061  |                                                  
14141  |                                                  ||14062  |                                                  
14142  |'2006/04/12 START K.Furuya 実払管理テーブル更新対 ||14063  |'2006/04/12 START K.Furuya 実払管理テーブル更新対 
14143  |    '実払管理テーブル更新処理実行                 ||14064  |    '実払管理テーブル更新処理実行                 
14144  |'2008/03/26 START ファンド決算期間での外部委託顧問||14065  |'2008/03/26 START ファンド決算期間での外部委託顧問
14145  |    'ファンド決算期間計算の場合実払いテーブル更新 ||14066  |    'ファンド決算期間計算の場合実払いテーブル更新 
14146  |    If gbuMGetUPDRec.N(lRecIdx).MGET_other_real_fl||14067  |    If gbuMGetUPDRec.N(lRecIdx).MGET_other_real_fl
14147  |        If fncOtherRealComUpdateInsert(WkContractN||14068  |        If fncOtherRealComUpdateInsert(WkContractN
14148  |                WkFixComC, WkFixComJ, WkRealComC, ||14069  |                WkFixComC, WkFixComJ, WkRealComC, 
14149  |            intRtn = MsgBox("契約番号：" & WkContr||14070  |            intRtn = MsgBox("契約番号：" & WkContr
14150  |                        "の確定額の更新に失敗しま ||14071  |                        "の確定額の更新に失敗しま 
14151  |        End If                                    ||14072  |        End If                                    
14152  |    End If                                        ||14073  |    End If                                        
14153  |'2008/03/26 END   ファンド決算期間での外部委託顧問||14074  |'2008/03/26 END   ファンド決算期間での外部委託顧問
14154  |'2006/04/12 END   K.Furuya 実払管理テーブル更新対 ||14075  |'2006/04/12 END   K.Furuya 実払管理テーブル更新対 
14155  |                                                  ||14076  |                                                  
14156 L|'2014/02/19 START M.Takada 【管理会計】消費税率変 ||       |                                                  
14157 L|  '消費税率変更がある場合、{消費税額内訳書｣を出力 ||       |                                                  
14158 L|  '消費税額の分割算出用フラグで出力判定を実施(Fals||       |                                                  
14159 L|    If Tax_Flg = True Then                        ||       |                                                  
14160 L|                                                  ||       |                                                  
14161 L|        '計算期間が消費税変更適用日を跨ぐ場合、消 ||       |                                                  
14162 L|        xlBook.Worksheets.Add after:=xlBook.Sheets||       |                                                  
14163 L|        'Excelフォーマットを調整                  ||       |                                                  
14164 L|        ActiveSheet.Cells.ColumnWidth = 1         ||       |                                                  
14165 L|        ActiveSheet.Cells.Font.Size = 11          ||       |                                                  
14166 L|                                                  ||       |                                                  
14167 L|    With xlSheet                                  ||       |                                                  
14168 L|        '作成日                                   ||       |                                                  
14169 L|        If RTrim(txtSysOutDate.Text) = "" Then    ||       |                                                  
14170 L|            .Cells(3, 50).Value = sWord34         ||       |                                                  
14171 L|            .Cells(3, 50).HorizontalAlignment = xl||       |                                                  
14172 L|        Else                                      ||       |                                                  
14173 L|            .Cells(3, 43).Value = CStr(Format(txtS||       |                                                  
14174 L|        End If                                    ||       |                                                  
14175 L|        'タイトル                                 ||       |                                                  
14176 L|        .Cells(5, 1).Value = sWord0d              ||       |                                                  
14177 L|        .Range("A5:BG5").HorizontalAlignment = xlC||       |                                                  
14178 L|        '財務部　担当者                           ||       |                                                  
14179 L|        sName = RTrim(txtInputName.Text)          ||       |                                                  
14180 L|        '財務部                                   ||       |                                                  
14181 L|        .Cells(7, 37).Value = sWord1              ||       |                                                  
14182 L|        .Cells(8, 39).Value = sWord2 & sName      ||       |                                                  
14183 L|                                                  ||       |                                                  
14184 L|        '下記のとおり･･･ ,文言                    ||       |                                                  
14185 L|        .Cells(10, 2).Value = sWordComment        ||       |                                                  
14186 L|                                                  ||       |                                                  
14187 L|        'ファンド名: ,文言                        ||       |                                                  
14188 L|        .Cells(12, 2).Value = sWord4              ||       |                                                  
14189 L|        .Cells(12, 11).Value = sWord19            ||       |                                                  
14190 L|        .Cells(12, 13).Value = gbuMGetUPDRec.N(lRe||       |                                                  
14191 L|                                                  ||       |                                                  
14192 L|        'ファンドコード: ,文言                    ||       |                                                  
14193 L|        .Cells(13, 2).Value = sWord4_2            ||       |                                                  
14194 L|        .Cells(13, 11).Value = sWord19            ||       |                                                  
14195 L|        If msAssetFlg = "0" Then                  ||       |                                                  
14196 L|            .Cells(13, 13).Value = sGetAccCode    ||       |                                                  
14197 L|        'マザー組入資産の場合                     ||       |                                                  
14198 L|        Else                                      ||       |                                                  
14199 L|            .Cells(13, 13).Value = msBabyAccountCo||       |                                                  
14200 L|        End If                                    ||       |                                                  
14201 L|                                                  ||       |                                                  
14202 L|        '計算期間: ,文言                          ||       |                                                  
14203 L|        .Cells(15, 2).Value = sWord5              ||       |                                                  
14204 L|        .Cells(15, 11).Value = sWord19            ||       |                                                  
14205 L|        .Cells(15, 13).Value = _                  ||       |                                                  
14206 L|        CStr(Format(dStart, "YYYY年M月D日")) & sWo||       |                                                  
14207 L|                                                  ||       |                                                  
14208 L|        '投資顧問料                               ||       |                                                  
14209 L|        .Cells(17, 2).Value = sWord11a            ||       |                                                  
14210 L|        .Cells(17, 11).Value = sWord19            ||       |                                                  
14211 L|        .Cells(17, 29).NumberFormatLocal = "@"    ||       |                                                  
14212 L|        .Cells(17, 29).Value = CStr(Format(mstrMon||       |                                                  
14213 L|        .Cells(17, 29).HorizontalAlignment = xlRig||       |                                                  
14214 L|        .Cells(17, 32).Value = sYen               ||       |                                                  
14215 L|                                                  ||       |                                                  
14216 L|                                                  ||       |                                                  
14217 L|        '(適用前)消費税率                         ||       |                                                  
14218 L|        .Cells(21, 2).Value = sWord66             ||       |                                                  
14219 L|        .Cells(21, 11).Value = sWord19            ||       |                                                  
14220 L|        .Cells(21, 13).Value = strTaxRate(2) & sWo||       |                                                  
14221 L|                                                  ||       |                                                  
14222 L|        '(適用前)税率適用期間                     ||       |                                                  
14223 L|        .Cells(22, 2).Value = sWord67             ||       |                                                  
14224 L|        .Cells(22, 11).Value = sWord19            ||       |                                                  
14225 L|        .Cells(22, 13).Value = _                  ||       |                                                  
14226 L|        CStr(Format(dStart, "YYYY年M月D日")) & sWo||       |                                                  
14227 L|                                                  ||       |                                                  
14228 L|        '(適用前)支払額                           ||       |                                                  
14229 L|        .Cells(23, 2).Value = sWord68             ||       |                                                  
14230 L|        .Cells(23, 11).Value = sWord19            ||       |                                                  
14231 L|        .Cells(23, 29).NumberFormatLocal = "@"    ||       |                                                  
14232 L|        .Cells(23, 29).Value = CStr(Format(strPayN||       |                                                  
14233 L|        .Cells(23, 29).HorizontalAlignment = xlRig||       |                                                  
14234 L|        .Cells(23, 32).Value = sYen               ||       |                                                  
14235 L|                                                  ||       |                                                  
14236 L|        '(適用前)消費税額                         ||       |                                                  
14237 L|        .Cells(24, 2).Value = sWord69             ||       |                                                  
14238 L|        .Cells(24, 11).Value = sWord19            ||       |                                                  
14239 L|        .Cells(24, 29).NumberFormatLocal = "@"    ||       |                                                  
14240 L|        .Cells(24, 29).Value = CStr(Format(strTaxN||       |                                                  
14241 L|        .Cells(24, 29).HorizontalAlignment = xlRig||       |                                                  
14242 L|        .Cells(24, 32).Value = sYen               ||       |                                                  
14243 L|                                                  ||       |                                                  
14244 L|                                                  ||       |                                                  
14245 L|        '(適用後)消費税率                         ||       |                                                  
14246 L|        .Cells(28, 2).Value = sWord66             ||       |                                                  
14247 L|        .Cells(28, 11).Value = sWord19            ||       |                                                  
14248 L|        .Cells(28, 13).Value = strTaxRate(1) & sWo||       |                                                  
14249 L|                                                  ||       |                                                  
14250 L|        '(適用後)税率適用期間                     ||       |                                                  
14251 L|        .Cells(29, 2).Value = sWord67             ||       |                                                  
14252 L|        .Cells(29, 11).Value = sWord19            ||       |                                                  
14253 L|        .Cells(29, 13).Value = _                  ||       |                                                  
14254 L|        CStr(Format(strUse_Date, "YYYY年M月D日")) ||       |                                                  
14255 L|                                                  ||       |                                                  
14256 L|        '(適用後)支払額                           ||       |                                                  
14257 L|        .Cells(30, 2).Value = sWord68             ||       |                                                  
14258 L|        .Cells(30, 11).Value = sWord19            ||       |                                                  
14259 L|        .Cells(30, 29).NumberFormatLocal = "@"    ||       |                                                  
14260 L|        .Cells(30, 29).Value = CStr(Format(strPayN||       |                                                  
14261 L|        .Cells(30, 29).HorizontalAlignment = xlRig||       |                                                  
14262 L|        .Cells(30, 32).Value = sYen               ||       |                                                  
14263 L|                                                  ||       |                                                  
14264 L|        '(適用後)消費税額                         ||       |                                                  
14265 L|        .Cells(31, 2).Value = sWord69             ||       |                                                  
14266 L|        .Cells(31, 11).Value = sWord19            ||       |                                                  
14267 L|        .Cells(31, 29).NumberFormatLocal = "@"    ||       |                                                  
14268 L|        .Cells(31, 29).Value = CStr(Format(strTaxN||       |                                                  
14269 L|        .Cells(31, 29).HorizontalAlignment = xlRig||       |                                                  
14270 L|        .Cells(31, 32).Value = sYen               ||       |                                                  
14271 L|                                                  ||       |                                                  
14272 L|                                                  ||       |                                                  
14273 L|        '合計                                     ||       |                                                  
14274 L|        .Cells(35, 2).Value = sWord70             ||       |                                                  
14275 L|                                                  ||       |                                                  
14276 L|        '支払額                                   ||       |                                                  
14277 L|        .Cells(36, 2).Value = sWord68             ||       |                                                  
14278 L|        .Cells(36, 11).Value = sWord19            ||       |                                                  
14279 L|        .Cells(36, 29).NumberFormatLocal = "@"    ||       |                                                  
14280 L|        .Cells(36, 29).Value = CStr(Format(.Cells(||       |                                                  
14281 L|        .Cells(36, 29).HorizontalAlignment = xlRig||       |                                                  
14282 L|        .Cells(36, 32).Value = sYen               ||       |                                                  
14283 L|                                                  ||       |                                                  
14284 L|        '消費税額                                 ||       |                                                  
14285 L|        .Cells(37, 2).Value = sWord69             ||       |                                                  
14286 L|        .Cells(37, 11).Value = sWord19            ||       |                                                  
14287 L|        .Cells(37, 29).NumberFormatLocal = "@"    ||       |                                                  
14288 L|        .Cells(37, 29).Value = CStr(Format(.Cells(||       |                                                  
14289 L|        .Cells(37, 29).HorizontalAlignment = xlRig||       |                                                  
14290 L|        .Cells(37, 32).Value = sYen               ||       |                                                  
14291 L|                                                  ||       |                                                  
14292 L|        '合計額                                   ||       |                                                  
14293 L|        .Cells(37, 13).Value = sWord24            ||       |                                                  
14294 L|        .Cells(37, 29).NumberFormatLocal = "@"    ||       |                                                  
14295 L|        .Cells(37, 29).Value = CStr(Format(.Cells(||       |                                                  
14296 L|        .Cells(37, 29).HorizontalAlignment = xlRig||       |                                                  
14297 L|        .Cells(37, 32).Value = sYen               ||       |                                                  
14298 L|                                                  ||       |                                                  
14299 L|                                                  ||       |                                                  
14300 L|    Else                                          ||       |                                                  
14301 L|        '跨がない場合｢消費税額内訳書｣は出力しない ||       |                                                  
14302 L|    End If                                        ||       |                                                  
14303 L|'2014/02/19 END   M.Takada 【管理会計】消費税率変 ||       |                                                  
14304 L|                                                  ||       |                                                  
14305  |    '正常戻り値セット                             ||14077  |    '正常戻り値セット                             
14306  |    fnblExcelOut_NotChgRate = True                ||14078  |    fnblExcelOut_NotChgRate = True                
14307  |    GoTo EndProc                                  ||14079  |    GoTo EndProc                                  
14308  |                                                  ||14080  |                                                  
14309  |ErrorTrap:                                        ||14081  |ErrorTrap:                                        
14310  |    ' Excel を起動できない場合に発生するエラーをト||14082  |    ' Excel を起動できない場合に発生するエラーをト
14311  |    Select Case Err.Number                        ||14083  |    Select Case Err.Number                        
14312  |        Case 440               ' オートメーション ||14084  |        Case 440               ' オートメーション 
14313  |            iTries = iTries + 1                   ||14085  |            iTries = iTries + 1                   
14314  |            ' Excel の再起動を 5 回まで行います。 ||14086  |            ' Excel の再起動を 5 回まで行います。 
14315  |            If iTries < 5 Then                    ||14087  |            If iTries < 5 Then                    
14316  |               Set xlApp = New Excel.Application  ||14088  |               Set xlApp = New Excel.Application  
14317  |               Resume                             ||14089  |               Resume                             
14318  |            Else                                  ||14090  |            Else                                  
14319  |               Err.Raise Number:=vbObjectError + 2||14091  |               Err.Raise Number:=vbObjectError + 2
14320  |               Description:="Microsoft Excel を起 ||14092  |               Description:="Microsoft Excel を起 
14321  |            End If                                ||14093  |            End If                                
14322  |        Case Else                                 ||14094  |        Case Else                                 
14323  |    End Select                                    ||14095  |    End Select                                    
14324  |                                                  ||14096  |                                                  
14325  |    'Workbookを閉じる                             ||14097  |    'Workbookを閉じる                             
14326  |    xlBook.Close                                  ||14098  |    xlBook.Close                                  
14327  |                                                  ||14099  |                                                  
14328  |    'Excel終了                                    ||14100  |    'Excel終了                                    
14329  |    xlApp.Quit                                    ||14101  |    xlApp.Quit                                    
14330  |                                                  ||14102  |                                                  
14331  |    'オブジェクトの解放                           ||14103  |    'オブジェクトの解放                           
14332  |    Set xlApp = Nothing                           ||14104  |    Set xlApp = Nothing                           
14333  |    Set xlBook = Nothing                          ||14105  |    Set xlBook = Nothing                          
14334  |    Set xlSheet = Nothing                         ||14106  |    Set xlSheet = Nothing                         
14335  |                                                  ||14107  |                                                  
14336  |OnErrorProc:                                      ||14108  |OnErrorProc:                                      
14337  |    Call subError("システムエラー", Str(Err.Number||14109  |    Call subError("システムエラー", Str(Err.Number
14338  |        Error, strErrCall, conTitle)              ||14110  |        Error, strErrCall, conTitle)              
14339  |    'マウスポインター元に戻す                     ||14111  |    'マウスポインター元に戻す                     
14340  |    Screen.MousePointer = vbDefault               ||14112  |    Screen.MousePointer = vbDefault               
14341  |    GoTo EndProc                                  ||14113  |    GoTo EndProc                                  
14342  |                                                  ||14114  |                                                  
14343  |EndProc:                                          ||14115  |EndProc:                                          
14344  |                                                  ||14116  |                                                  
14345  |End Function                                      ||14117  |End Function                                      
14346  |                                                  ||14118  |                                                  
14347  |'=================================================||14119  |'=================================================
14348  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnSetOtherComRate            ||14120  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnSetOtherComRate            
14349  |'機能            :   料率変更有りの外部委託顧問料 ||14121  |'機能            :   料率変更有りの外部委託顧問料 
14350  |'                                                 ||14122  |'                                                 
14351  |'パラメータ 　   :    NavKbn = 取得NAV区分(1:月末N||14123  |'パラメータ 　   :    NavKbn = 取得NAV区分(1:月末N
14352  |'                     AssetKbn = 資産種類(0:純資産||14124  |'                     AssetKbn = 資産種類(0:純資産
14353  |'                     BabyAccCd = マザー組入資産の||14125  |'                     BabyAccCd = マザー組入資産の
14354  |'                     AccCD = マザー組入資産の場合||14126  |'                     AccCD = マザー組入資産の場合
14355  |'                             NAV区分が3の場合の口||14127  |'                             NAV区分が3の場合の口
14356  |'                     CurrencyCd = ベース通貨コー ||14128  |'                     CurrencyCd = ベース通貨コー 
14357  |'                     AsstType = 資産コード(省略可||14129  |'                     AsstType = 資産コード(省略可
14358  |'                     StrDate = 計算開始日(省略不 ||14130  |'                     StrDate = 計算開始日(省略不 
14359  |'                     strFlg = 計算開始日選択フラ ||14131  |'                     strFlg = 計算開始日選択フラ 
14360  |'                                                 ||14132  |'                                                 
14361  |'日付               担当　              修正内容  ||14133  |'日付               担当　              修正内容  
14362  |'-------------------------------------------------||14134  |'-------------------------------------------------
14363  |'2006/07/18         K.Furuya <SRA>     新規作成　 ||14135  |'2006/07/18         K.Furuya <SRA>     新規作成　 
14364  |'2008/03/03         K.Furuya <SRA>     時価総額基 ||14136  |'2008/03/03         K.Furuya <SRA>     時価総額基 
14365  |'=================================================||14137  |'=================================================
14366  |Private Function fnSetOtherComRate( _             ||14138  |Private Function fnSetOtherComRate( _             
14367  |    ByVal NavKbn As String, _                     ||14139  |    ByVal NavKbn As String, _                     
14368  |    ByVal AssetKbn As String, _                   ||14140  |    ByVal AssetKbn As String, _                   
14369  |    Optional BabyAccCd As String = " ", _         ||14141  |    Optional BabyAccCd As String = " ", _         
14370  |    Optional AccCD As String = " ", _             ||14142  |    Optional AccCD As String = " ", _             
14371  |    Optional CurrencyCode As String = " ", _      ||14143  |    Optional CurrencyCode As String = " ", _      
14372  |    Optional AssetType As String = " ", _         ||14144  |    Optional AssetType As String = " ", _         
14373  |    Optional strDate As String = " ", _           ||14145  |    Optional strDate As String = " ", _           
14374  |    Optional strFlg As String = " ") As Boolean   ||14146  |    Optional strFlg As String = " ") As Boolean   
14375  |                                                  ||14147  |                                                  
14376  |    Dim strRuleNo                   As Integer  ' ||14148  |    Dim strRuleNo                   As Integer  ' 
14377  |    Dim endRuleNo                   As Integer  ' ||14149  |    Dim endRuleNo                   As Integer  ' 
14378  |    Dim i                           As Integer    ||14150  |    Dim i                           As Integer    
14379  |    Dim J                           As Integer    ||14151  |    Dim J                           As Integer    
14380  |    Dim K                           As Integer    ||14152  |    Dim K                           As Integer    
14381  |    Dim N                           As Integer    ||14153  |    Dim N                           As Integer    
14382  |                                                  ||14154  |                                                  
14383  |    Dim strSQL                      As String     ||14155  |    Dim strSQL                      As String     
14384  |    Dim RecCnt                      As Integer  ' ||14156  |    Dim RecCnt                      As Integer  ' 
14385  |                                                  ||14157  |                                                  
14386  |    fnSetOtherComRate = False                     ||14158  |    fnSetOtherComRate = False                     
14387  |                                                  ||14159  |                                                  
14388  |    '比較ルールNo変数の初期化                     ||14160  |    '比較ルールNo変数の初期化                     
14389  |    strRuleNo = 0                                 ||14161  |    strRuleNo = 0                                 
14390  |    endRuleNo = 0                                 ||14162  |    endRuleNo = 0                                 
14391  |    'ルールNoのループ変数を初期化                 ||14163  |    'ルールNoのループ変数を初期化                 
14392  |    J = 0                                         ||14164  |    J = 0                                         
14393  |    '定義体配列の初期化                           ||14165  |    '定義体配列の初期化                           
14394  |    ReDim gtypOtherComRec(0)                      ||14166  |    ReDim gtypOtherComRec(0)                      
14395  |    ReDim gtypOtherComRec(0).APPLY_OTHER_COM_RATE(||14167  |    ReDim gtypOtherComRec(0).APPLY_OTHER_COM_RATE(
14396  |                                                  ||14168  |                                                  
14397  |    '料率変更毎の計算期間日数、順位、料率、レート ||14169  |    '料率変更毎の計算期間日数、順位、料率、レート 
14398  |    For i = LBound(gbuOtherComRateGetUPDRec.N) To ||14170  |    For i = LBound(gbuOtherComRateGetUPDRec.N) To 
14399  |        'ルールNoを取得                           ||14171  |        'ルールNoを取得                           
14400  |        strRuleNo = gbuOtherComRateGetUPDRec.N(i).||14172  |        strRuleNo = gbuOtherComRateGetUPDRec.N(i).
14401  |        '最初のレコードの場合は必ず入る           ||14173  |        '最初のレコードの場合は必ず入る           
14402  |        If i = 0 Then                             ||14174  |        If i = 0 Then                             
14403  |            '利率順位のループ変数を初期化         ||14175  |            '利率順位のループ変数を初期化         
14404  |            K = 0                                 ||14176  |            K = 0                                 
14405  |            ReDim Preserve gtypOtherComRec(J)     ||14177  |            ReDim Preserve gtypOtherComRec(J)     
14406  |            ReDim Preserve gtypOtherComRec(J).APPL||14178  |            ReDim Preserve gtypOtherComRec(J).APPL
14407  |            gtypOtherComRec(J).APPLY_CONTRACT_NO =||14179  |            gtypOtherComRec(J).APPLY_CONTRACT_NO =
14408  |            'レコードの最初の場合計算開始日を適用 ||14180  |            'レコードの最初の場合計算開始日を適用 
14409  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||14181  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
14410  |            If strFlg = "0" Then                  ||14182  |            If strFlg = "0" Then                  
14411  |                gtypOtherComRec(J).APPLY_START_DAT||14183  |                gtypOtherComRec(J).APPLY_START_DAT
14412  |            Else                                  ||14184  |            Else                                  
14413  |                gtypOtherComRec(J).APPLY_START_DAT||14185  |                gtypOtherComRec(J).APPLY_START_DAT
14414  |            End If                                ||14186  |            End If                                
14415  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||14187  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
14416  |            'レコードの最後の場合計算終了日を適用 ||14188  |            'レコードの最後の場合計算終了日を適用 
14417  |                                                  ||14189  |                                                  
14418  |            If gbuOtherComRateGetUPDRec.N(J).RGET_||14190  |            If gbuOtherComRateGetUPDRec.N(J).RGET_
14419  |                gtypOtherComRec(J).APPLY_END_DATE ||14191  |                gtypOtherComRec(J).APPLY_END_DATE 
14420  |            'レコードの途中の場合ルールNoの適用終 ||14192  |            'レコードの途中の場合ルールNoの適用終 
14421  |            Else                                  ||14193  |            Else                                  
14422  |                gtypOtherComRec(J).APPLY_END_DATE ||14194  |                gtypOtherComRec(J).APPLY_END_DATE 
14423  |            End If                                ||14195  |            End If                                
14424  |            gtypOtherComRec(J).APPLY_OTHER_COM_RUL||14196  |            gtypOtherComRec(J).APPLY_OTHER_COM_RUL
14425  |            '通貨コードをセット                   ||14197  |            '通貨コードをセット                   
14426  |            gtypOtherComRec(J).APPLY_BASE_CURRENCY||14198  |            gtypOtherComRec(J).APPLY_BASE_CURRENCY
14427  |            '計算日数を取得                       ||14199  |            '計算日数を取得                       
14428  |            '取得NAV区分が"3"の場合               ||14200  |            '取得NAV区分が"3"の場合               
14429  |            If NavKbn = "3" Then                  ||14201  |            If NavKbn = "3" Then                  
14430  |                '資産種類が純資産の場合           ||14202  |                '資産種類が純資産の場合           
14431  |                If AssetKbn = "0" Then            ||14203  |                If AssetKbn = "0" Then            
14432  |                    'SQL文生成(変更料率期間取得)  ||14204  |                    'SQL文生成(変更料率期間取得)  
14433  |                    strSQL = ""                   ||14205  |                    strSQL = ""                   
14434  |                    strSQL = strSQL & "SELECT"    ||14206  |                    strSQL = strSQL & "SELECT"    
14435  |                    strSQL = strSQL & "    BASE_DA||14207  |                    strSQL = strSQL & "    BASE_DA
14436  |                    strSQL = strSQL & " FROM"     ||14208  |                    strSQL = strSQL & " FROM"     
14437  |                    strSQL = strSQL & "    CFR_DAI||14209  |                    strSQL = strSQL & "    CFR_DAI
14438  |                    strSQL = strSQL & " WHERE"    ||14210  |                    strSQL = strSQL & " WHERE"    
14439  |                    strSQL = strSQL & "    CFR_DAI||14211  |                    strSQL = strSQL & "    CFR_DAI
14440  |                    strSQL = strSQL & "    (CFR_DA||14212  |                    strSQL = strSQL & "    (CFR_DA
14441  |                    strSQL = strSQL & "    CFR_DAI||14213  |                    strSQL = strSQL & "    CFR_DAI
14442  |                    strSQL = strSQL & "    CFR_DAI||14214  |                    strSQL = strSQL & "    CFR_DAI
14443  |                    strSQL = strSQL & "    CFR_DAI||14215  |                    strSQL = strSQL & "    CFR_DAI
14444  |                'マザー組入資産の場合             ||14216  |                'マザー組入資産の場合             
14445  |                ElseIf AssetKbn = "1" Then        ||14217  |                ElseIf AssetKbn = "1" Then        
14446  |                    strSQL = ""                   ||14218  |                    strSQL = ""                   
14447  |                    strSQL = strSQL & "SELECT"    ||14219  |                    strSQL = strSQL & "SELECT"    
14448  |                    strSQL = strSQL & "    a.BASE_||14220  |                    strSQL = strSQL & "    a.BASE_
14449  |                    strSQL = strSQL & " FROM"     ||14221  |                    strSQL = strSQL & " FROM"     
14450  |                    strSQL = strSQL & "    CFR_DAI||14222  |                    strSQL = strSQL & "    CFR_DAI
14451  |                    strSQL = strSQL & " WHERE"    ||14223  |                    strSQL = strSQL & " WHERE"    
14452  |                    strSQL = strSQL & "    b.BABY_||14224  |                    strSQL = strSQL & "    b.BABY_
14453  |                    strSQL = strSQL & "    b.BASE_||14225  |                    strSQL = strSQL & "    b.BASE_
14454  |                    strSQL = strSQL & "    a.ACCOU||14226  |                    strSQL = strSQL & "    a.ACCOU
14455  |                    strSQL = strSQL & "    (a.BASE||14227  |                    strSQL = strSQL & "    (a.BASE
14456  |                    strSQL = strSQL & "    a.BASE_||14228  |                    strSQL = strSQL & "    a.BASE_
14457  |                    strSQL = strSQL & "    a.CURRE||14229  |                    strSQL = strSQL & "    a.CURRE
14458  |                    strSQL = strSQL & "    a.ASSET||14230  |                    strSQL = strSQL & "    a.ASSET
14459  |                End If                            ||14231  |                End If                            
14460  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||14232  |                'ﾀﾞｲﾅｾｯﾄの作成                    
14461  |                If gintDyCreate(strSQL) = False Th||14233  |                If gintDyCreate(strSQL) = False Th
14462  |                    Exit Function                 ||14234  |                    Exit Function                 
14463  |                End If                            ||14235  |                End If                            
14464  |                If gbxOraDynaset.RecordCount = 0 T||14236  |                If gbxOraDynaset.RecordCount = 0 T
14465  |                    Exit Function                 ||14237  |                    Exit Function                 
14466  |                End If                            ||14238  |                End If                            
14467  |                '計算期間の日数を取得する         ||14239  |                '計算期間の日数を取得する         
14468  |                RecCnt = 0                        ||14240  |                RecCnt = 0                        
14469  |                RecCnt = gbxOraDynaset.RecordCount||14241  |                RecCnt = gbxOraDynaset.RecordCount
14470  |                '計算期間の日数をセット           ||14242  |                '計算期間の日数をセット           
14471  |                gtypOtherComRec(J).APPLY_CALC_DAYS||14243  |                gtypOtherComRec(J).APPLY_CALC_DAYS
14472  |                '適用開始日と適用終了日を再設定す ||14244  |                '適用開始日と適用終了日を再設定す 
14473  |                For N = 1 To RecCnt               ||14245  |                For N = 1 To RecCnt               
14474  |                    '平日適用開始日を再設定する   ||14246  |                    '平日適用開始日を再設定する   
14475  |                    If N = 1 Then                 ||14247  |                    If N = 1 Then                 
14476  |                        gtypOtherComRec(J).APPLY_D||14248  |                        gtypOtherComRec(J).APPLY_D
14477  |                    '平日適用終了日を再設定する   ||14249  |                    '平日適用終了日を再設定する   
14478  |                    ElseIf N = RecCnt Then        ||14250  |                    ElseIf N = RecCnt Then        
14479  |                        gtypOtherComRec(J).APPLY_D||14251  |                        gtypOtherComRec(J).APPLY_D
14480  |                    End If                        ||14252  |                    End If                        
14481  |                                                  ||14253  |                                                  
14482  |                    '次レコードへ                 ||14254  |                    '次レコードへ                 
14483  |                    Call gDyNext                  ||14255  |                    Call gDyNext                  
14484  |                Next N                            ||14256  |                Next N                            
14485  |            '取得NAV区分が"3"以外の場合           ||14257  |            '取得NAV区分が"3"以外の場合           
14486  |            Else                                  ||14258  |            Else                                  
14487  |                gtypOtherComRec(J).APPLY_CALC_DAYS||14259  |                gtypOtherComRec(J).APPLY_CALC_DAYS
14488  |                                    DateDiff("d", ||14260  |                                    DateDiff("d", 
14489  |                                                  ||14261  |                                                  
14490  |            End If                                ||14262  |            End If                                
14491  |                                                  ||14263  |                                                  
14492  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14264  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14493  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14265  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14494  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14266  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14495  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14267  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14496  |        '前レコードのルールNoと現ルールNoが異なる ||14268  |        '前レコードのルールNoと現ルールNoが異なる 
14497  |        ElseIf strRuleNo <> endRuleNo Then        ||14269  |        ElseIf strRuleNo <> endRuleNo Then        
14498  |            'ルールNoのループ変数をインクリメント ||14270  |            'ルールNoのループ変数をインクリメント 
14499  |            J = J + 1                             ||14271  |            J = J + 1                             
14500  |            '利率順位のループ変数を初期化         ||14272  |            '利率順位のループ変数を初期化         
14501  |            K = 0                                 ||14273  |            K = 0                                 
14502  |            ReDim Preserve gtypOtherComRec(J)     ||14274  |            ReDim Preserve gtypOtherComRec(J)     
14503  |            ReDim Preserve gtypOtherComRec(J).APPL||14275  |            ReDim Preserve gtypOtherComRec(J).APPL
14504  |            gtypOtherComRec(J).APPLY_CONTRACT_NO =||14276  |            gtypOtherComRec(J).APPLY_CONTRACT_NO =
14505  |            'レコードの適用開始日を代入           ||14277  |            'レコードの適用開始日を代入           
14506  |            gtypOtherComRec(J).APPLY_START_DATE = ||14278  |            gtypOtherComRec(J).APPLY_START_DATE = 
14507  |            'レコードの最後の場合計算終了日を適用 ||14279  |            'レコードの最後の場合計算終了日を適用 
14508  |            If gbuOtherComRateGetUPDRec.N(J).RGET_||14280  |            If gbuOtherComRateGetUPDRec.N(J).RGET_
14509  |                gtypOtherComRec(J).APPLY_END_DATE ||14281  |                gtypOtherComRec(J).APPLY_END_DATE 
14510  |            'レコードの途中の場合ルールNoの適用終 ||14282  |            'レコードの途中の場合ルールNoの適用終 
14511  |            Else                                  ||14283  |            Else                                  
14512  |                gtypOtherComRec(J).APPLY_END_DATE ||14284  |                gtypOtherComRec(J).APPLY_END_DATE 
14513  |            End If                                ||14285  |            End If                                
14514  |            gtypOtherComRec(J).APPLY_OTHER_COM_RUL||14286  |            gtypOtherComRec(J).APPLY_OTHER_COM_RUL
14515  |            '通貨コードをセット                   ||14287  |            '通貨コードをセット                   
14516  |            gtypOtherComRec(J).APPLY_BASE_CURRENCY||14288  |            gtypOtherComRec(J).APPLY_BASE_CURRENCY
14517  |            '計算日数を取得                       ||14289  |            '計算日数を取得                       
14518  |            '取得NAV区分が"3"の場合               ||14290  |            '取得NAV区分が"3"の場合               
14519  |            If NavKbn = "3" Then                  ||14291  |            If NavKbn = "3" Then                  
14520  |                '資産種類が純資産の場合           ||14292  |                '資産種類が純資産の場合           
14521  |                If AssetKbn = "0" Then            ||14293  |                If AssetKbn = "0" Then            
14522  |                    'SQL文生成(変更料率期間取得)  ||14294  |                    'SQL文生成(変更料率期間取得)  
14523  |                    strSQL = ""                   ||14295  |                    strSQL = ""                   
14524  |                    strSQL = strSQL & "SELECT"    ||14296  |                    strSQL = strSQL & "SELECT"    
14525  |                    strSQL = strSQL & "    BASE_DA||14297  |                    strSQL = strSQL & "    BASE_DA
14526  |                    strSQL = strSQL & " FROM"     ||14298  |                    strSQL = strSQL & " FROM"     
14527  |                    strSQL = strSQL & "    CFR_DAI||14299  |                    strSQL = strSQL & "    CFR_DAI
14528  |                    strSQL = strSQL & " WHERE"    ||14300  |                    strSQL = strSQL & " WHERE"    
14529  |                    strSQL = strSQL & "    CFR_DAI||14301  |                    strSQL = strSQL & "    CFR_DAI
14530  |                    strSQL = strSQL & "    (CFR_DA||14302  |                    strSQL = strSQL & "    (CFR_DA
14531  |                    strSQL = strSQL & "    CFR_DAI||14303  |                    strSQL = strSQL & "    CFR_DAI
14532  |                    strSQL = strSQL & "    CFR_DAI||14304  |                    strSQL = strSQL & "    CFR_DAI
14533  |                    strSQL = strSQL & "    CFR_DAI||14305  |                    strSQL = strSQL & "    CFR_DAI
14534  |                'マザー組入資産の場合             ||14306  |                'マザー組入資産の場合             
14535  |                ElseIf AssetKbn = "1" Then        ||14307  |                ElseIf AssetKbn = "1" Then        
14536  |                    strSQL = ""                   ||14308  |                    strSQL = ""                   
14537  |                    strSQL = strSQL & "SELECT"    ||14309  |                    strSQL = strSQL & "SELECT"    
14538  |                    strSQL = strSQL & "    a.BASE_||14310  |                    strSQL = strSQL & "    a.BASE_
14539  |                    strSQL = strSQL & " FROM"     ||14311  |                    strSQL = strSQL & " FROM"     
14540  |                    strSQL = strSQL & "    CFR_DAI||14312  |                    strSQL = strSQL & "    CFR_DAI
14541  |                    strSQL = strSQL & " WHERE"    ||14313  |                    strSQL = strSQL & " WHERE"    
14542  |                    strSQL = strSQL & "    b.BABY_||14314  |                    strSQL = strSQL & "    b.BABY_
14543  |                    strSQL = strSQL & "    b.BASE_||14315  |                    strSQL = strSQL & "    b.BASE_
14544  |                    strSQL = strSQL & "    a.ACCOU||14316  |                    strSQL = strSQL & "    a.ACCOU
14545  |                    strSQL = strSQL & "    (a.BASE||14317  |                    strSQL = strSQL & "    (a.BASE
14546  |                    strSQL = strSQL & "    a.BASE_||14318  |                    strSQL = strSQL & "    a.BASE_
14547  |                    strSQL = strSQL & "    a.CURRE||14319  |                    strSQL = strSQL & "    a.CURRE
14548  |                    strSQL = strSQL & "    a.ASSET||14320  |                    strSQL = strSQL & "    a.ASSET
14549  |                End If                            ||14321  |                End If                            
14550  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||14322  |                'ﾀﾞｲﾅｾｯﾄの作成                    
14551  |                If gintDyCreate(strSQL) = False Th||14323  |                If gintDyCreate(strSQL) = False Th
14552  |                    Exit Function                 ||14324  |                    Exit Function                 
14553  |                End If                            ||14325  |                End If                            
14554  |                If gbxOraDynaset.RecordCount = 0 T||14326  |                If gbxOraDynaset.RecordCount = 0 T
14555  |                    Exit Function                 ||14327  |                    Exit Function                 
14556  |                End If                            ||14328  |                End If                            
14557  |                '計算期間の日数を取得する         ||14329  |                '計算期間の日数を取得する         
14558  |                RecCnt = 0                        ||14330  |                RecCnt = 0                        
14559  |                RecCnt = gbxOraDynaset.RecordCount||14331  |                RecCnt = gbxOraDynaset.RecordCount
14560  |                '計算期間の日数をセット           ||14332  |                '計算期間の日数をセット           
14561  |                gtypOtherComRec(J).APPLY_CALC_DAYS||14333  |                gtypOtherComRec(J).APPLY_CALC_DAYS
14562  |                '適用開始日と適用終了日を再設定す ||14334  |                '適用開始日と適用終了日を再設定す 
14563  |                For N = 1 To RecCnt               ||14335  |                For N = 1 To RecCnt               
14564  |                    '平日適用開始日を再設定する   ||14336  |                    '平日適用開始日を再設定する   
14565  |                    If N = 1 Then                 ||14337  |                    If N = 1 Then                 
14566  |                        gtypOtherComRec(J).APPLY_D||14338  |                        gtypOtherComRec(J).APPLY_D
14567  |                    '平日適用終了日を再設定する   ||14339  |                    '平日適用終了日を再設定する   
14568  |                    ElseIf N = RecCnt Then        ||14340  |                    ElseIf N = RecCnt Then        
14569  |                        gtypOtherComRec(J).APPLY_D||14341  |                        gtypOtherComRec(J).APPLY_D
14570  |                    End If                        ||14342  |                    End If                        
14571  |                                                  ||14343  |                                                  
14572  |                    '次レコードへ                 ||14344  |                    '次レコードへ                 
14573  |                    Call gDyNext                  ||14345  |                    Call gDyNext                  
14574  |                Next N                            ||14346  |                Next N                            
14575  |            '取得NAV区分が"3"以外の場合           ||14347  |            '取得NAV区分が"3"以外の場合           
14576  |            Else                                  ||14348  |            Else                                  
14577  |                gtypOtherComRec(J).APPLY_CALC_DAYS||14349  |                gtypOtherComRec(J).APPLY_CALC_DAYS
14578  |                                    DateDiff("d", ||14350  |                                    DateDiff("d", 
14579  |                                                  ||14351  |                                                  
14580  |            End If                                ||14352  |            End If                                
14581  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14353  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14582  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14354  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14583  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14355  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14584  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14356  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14585  |        Else                                      ||14357  |        Else                                      
14586  |            '利率順位のループ変数をインクリメント ||14358  |            '利率順位のループ変数をインクリメント 
14587  |            K = K + 1                             ||14359  |            K = K + 1                             
14588  |            ReDim Preserve gtypOtherComRec(J).APPL||14360  |            ReDim Preserve gtypOtherComRec(J).APPL
14589  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14361  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14590  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14362  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14591  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14363  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14592  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT||14364  |            gtypOtherComRec(J).APPLY_OTHER_COM_RAT
14593  |        End If                                    ||14365  |        End If                                    
14594  |        '現ルールNoを前ルールNo変数に代入         ||14366  |        '現ルールNoを前ルールNo変数に代入         
14595  |        endRuleNo = strRuleNo                     ||14367  |        endRuleNo = strRuleNo                     
14596  |    Next i                                        ||14368  |    Next i                                        
14597  |                                                  ||14369  |                                                  
14598  |    fnSetOtherComRate = True                      ||14370  |    fnSetOtherComRate = True                      
14599  |                                                  ||14371  |                                                  
14600  |End Function                                      ||14372  |End Function                                      
14601  |                                                  ||14373  |                                                  
14602  |                                                  ||14374  |                                                  
14603  |'=================================================||14375  |'=================================================
14604  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbExcelNetAssetValue         ||14376  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbExcelNetAssetValue         
14605  |'機能            :   確認書の年率出力             ||14377  |'機能            :   確認書の年率出力             
14606  |'                                                 ||14378  |'                                                 
14607  |'日付               担当　              修正内容  ||14379  |'日付               担当　              修正内容  
14608  |'-------------------------------------------------||14380  |'-------------------------------------------------
14609  |'2006/07/19         K.Furuya <SRA>     新規作成(期||14381  |'2006/07/19         K.Furuya <SRA>     新規作成(期
14610  |'=================================================||14382  |'=================================================
14611  |Private Sub sbExcelNetAssetValue(ByVal TotalRate A||14383  |Private Sub sbExcelNetAssetValue(ByVal TotalRate A
14612  |    Dim i       As Integer                        ||14384  |    Dim i       As Integer                        
14613  |    Dim iRowCnt As Long                           ||14385  |    Dim iRowCnt As Long                           
14614  |                                                  ||14386  |                                                  
14615  |    With xlSheet                                  ||14387  |    With xlSheet                                  
14616  |        '固定料率                                 ||14388  |        '固定料率                                 
14617  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat||14389  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat
14618  |            '年率1行固定                          ||14390  |            '年率1行固定                          
14619  |            .Cells(39, 13).Value = _              ||14391  |            .Cells(39, 13).Value = _              
14620  |                sWord30 & Format(gbuOtherComRateGe||14392  |                sWord30 & Format(gbuOtherComRateGe
14621  |        '段階料率                                 ||14393  |        '段階料率                                 
14622  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other||14394  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other
14623  |            '料率順位のデータ数により処理を分岐   ||14395  |            '料率順位のデータ数により処理を分岐   
14624  |            iRowCnt = 0                           ||14396  |            iRowCnt = 0                           
14625  |            If UBound(gbuOtherComRateGetUPDRec.N) ||14397  |            If UBound(gbuOtherComRateGetUPDRec.N) 
14626  |                '料率データが4件以上のときは行間な||14398  |                '料率データが4件以上のときは行間な
14627  |                For i = LBound(gbuOtherComRateGetU||14399  |                For i = LBound(gbuOtherComRateGetU
14628  |                    If i = 0 Then                 ||14400  |                    If i = 0 Then                 
14629  |                        '年率1行目                ||14401  |                        '年率1行目                
14630  |                        Select Case gbuMGetUPDRec.||14402  |                        Select Case gbuMGetUPDRec.
14631  |                            Case cAud             ||14403  |                            Case cAud             
14632  |                                .Cells(39, 13).Val||14404  |                                .Cells(39, 13).Val
14633  |                                    sWord26 & CStr||14405  |                                    sWord26 & CStr
14634  |                                    sAud & sWord27||14406  |                                    sAud & sWord27
14635  |                            Case cCad             ||14407  |                            Case cCad             
14636  |                                .Cells(39, 13).Val||14408  |                                .Cells(39, 13).Val
14637  |                                    sWord26 & CStr||14409  |                                    sWord26 & CStr
14638  |                                    sCad & sWord27||14410  |                                    sCad & sWord27
14639  |                            Case cChf             ||14411  |                            Case cChf             
14640  |                                .Cells(39, 13).Val||14412  |                                .Cells(39, 13).Val
14641  |                                    sWord26 & CStr||14413  |                                    sWord26 & CStr
14642  |                                    sChf & sWord27||14414  |                                    sChf & sWord27
14643  |                            Case cEur             ||14415  |                            Case cEur             
14644  |                                .Cells(39, 13).Val||14416  |                                .Cells(39, 13).Val
14645  |                                    sWord26 & CStr||14417  |                                    sWord26 & CStr
14646  |                                    sEur & sWord27||14418  |                                    sEur & sWord27
14647  |                            Case cGbp             ||14419  |                            Case cGbp             
14648  |                                .Cells(39, 13).Val||14420  |                                .Cells(39, 13).Val
14649  |                                    sWord26 & CStr||14421  |                                    sWord26 & CStr
14650  |                                    sGbp & sWord27||14422  |                                    sGbp & sWord27
14651  |                            Case cHkd             ||14423  |                            Case cHkd             
14652  |                                .Cells(39, 13).Val||14424  |                                .Cells(39, 13).Val
14653  |                                    sWord26 & CStr||14425  |                                    sWord26 & CStr
14654  |                                    sHkd & sWord27||14426  |                                    sHkd & sWord27
14655  |                            Case cJpy             ||14427  |                            Case cJpy             
14656  |                                .Cells(39, 13).Val||14428  |                                .Cells(39, 13).Val
14657  |                                    sWord26 & CStr||14429  |                                    sWord26 & CStr
14658  |                                    sYen & sWord27||14430  |                                    sYen & sWord27
14659  |                            Case cMyr             ||14431  |                            Case cMyr             
14660  |                                .Cells(39, 13).Val||14432  |                                .Cells(39, 13).Val
14661  |                                    sWord26 & CStr||14433  |                                    sWord26 & CStr
14662  |                                    sMyr & sWord27||14434  |                                    sMyr & sWord27
14663  |                            Case cNzd             ||14435  |                            Case cNzd             
14664  |                                .Cells(39, 13).Val||14436  |                                .Cells(39, 13).Val
14665  |                                    sWord26 & CStr||14437  |                                    sWord26 & CStr
14666  |                                    sNzd & sWord27||14438  |                                    sNzd & sWord27
14667  |                            Case cSek             ||14439  |                            Case cSek             
14668  |                                .Cells(39, 13).Val||14440  |                                .Cells(39, 13).Val
14669  |                                    sWord26 & CStr||14441  |                                    sWord26 & CStr
14670  |                                    sSek & sWord27||14442  |                                    sSek & sWord27
14671  |                            Case cSgd             ||14443  |                            Case cSgd             
14672  |                                .Cells(39, 13).Val||14444  |                                .Cells(39, 13).Val
14673  |                                    sWord26 & CStr||14445  |                                    sWord26 & CStr
14674  |                                    sSgd & sWord27||14446  |                                    sSgd & sWord27
14675  |                            Case cUsd             ||14447  |                            Case cUsd             
14676  |                                .Cells(39, 13).Val||14448  |                                .Cells(39, 13).Val
14677  |                                    sWord26 & CStr||14449  |                                    sWord26 & CStr
14678  |                                    sUsd & sWord27||14450  |                                    sUsd & sWord27
14679  |                            Case cNok             ||14451  |                            Case cNok             
14680  |                                .Cells(39, 13).Val||14452  |                                .Cells(39, 13).Val
14681  |                                    sWord26 & CStr||14453  |                                    sWord26 & CStr
14682  |                                    sNok & sWord27||14454  |                                    sNok & sWord27
14683  |                        End Select                ||14455  |                        End Select                
14684  |                        '年率　累積値セット       ||14456  |                        '年率　累積値セット       
14685  |                        TotalRate = CCur(gbuOtherC||14457  |                        TotalRate = CCur(gbuOtherC
14686  |                    ElseIf i = UBound(gbuOtherComR||14458  |                    ElseIf i = UBound(gbuOtherComR
14687  |                        '年率最終行               ||14459  |                        '年率最終行               
14688  |                        '前半金額部分             ||14460  |                        '前半金額部分             
14689  |                        .Cells(39 + i, 23).NumberF||14461  |                        .Cells(39 + i, 23).NumberF
14690  |                        If gbuMGetUPDRec.N(lRecIdx||14462  |                        If gbuMGetUPDRec.N(lRecIdx
14691  |                            .Cells(39 + i, 23).Val||14463  |                            .Cells(39 + i, 23).Val
14692  |                        Else                      ||14464  |                        Else                      
14693  |                            .Cells(39 + i, 23).Val||14465  |                            .Cells(39 + i, 23).Val
14694  |                        End If                    ||14466  |                        End If                    
14695  |                        .Cells(39 + i, 23).Horizon||14467  |                        .Cells(39 + i, 23).Horizon
14696  |                        '後半の文言               ||14468  |                        '後半の文言               
14697  |                        Select Case gbuMGetUPDRec.||14469  |                        Select Case gbuMGetUPDRec.
14698  |                            Case cAud             ||14470  |                            Case cAud             
14699  |                                .Cells(39 + i, 24)||14471  |                                .Cells(39 + i, 24)
14700  |                                    sAud & sWord31||14472  |                                    sAud & sWord31
14701  |                            Case cCad             ||14473  |                            Case cCad             
14702  |                                .Cells(39 + i, 24)||14474  |                                .Cells(39 + i, 24)
14703  |                                    sCad & sWord31||14475  |                                    sCad & sWord31
14704  |                            Case cChf             ||14476  |                            Case cChf             
14705  |                                .Cells(39 + i, 24)||14477  |                                .Cells(39 + i, 24)
14706  |                                    sChf & sWord31||14478  |                                    sChf & sWord31
14707  |                            Case cEur             ||14479  |                            Case cEur             
14708  |                                .Cells(39 + i, 24)||14480  |                                .Cells(39 + i, 24)
14709  |                                    sEur & sWord31||14481  |                                    sEur & sWord31
14710  |                            Case cGbp             ||14482  |                            Case cGbp             
14711  |                                .Cells(39 + i, 24)||14483  |                                .Cells(39 + i, 24)
14712  |                                    sGbp & sWord31||14484  |                                    sGbp & sWord31
14713  |                            Case cHkd             ||14485  |                            Case cHkd             
14714  |                                .Cells(39 + i, 24)||14486  |                                .Cells(39 + i, 24)
14715  |                                    sHkd & sWord31||14487  |                                    sHkd & sWord31
14716  |                            Case cJpy             ||14488  |                            Case cJpy             
14717  |                                .Cells(39 + i, 24)||14489  |                                .Cells(39 + i, 24)
14718  |                                    sYen & sWord31||14490  |                                    sYen & sWord31
14719  |                            Case cMyr             ||14491  |                            Case cMyr             
14720  |                                .Cells(39 + i, 24)||14492  |                                .Cells(39 + i, 24)
14721  |                                    sMyr & sWord31||14493  |                                    sMyr & sWord31
14722  |                            Case cNzd             ||14494  |                            Case cNzd             
14723  |                                .Cells(39 + i, 24)||14495  |                                .Cells(39 + i, 24)
14724  |                                    sNzd & sWord31||14496  |                                    sNzd & sWord31
14725  |                            Case cSek             ||14497  |                            Case cSek             
14726  |                                .Cells(39 + i, 24)||14498  |                                .Cells(39 + i, 24)
14727  |                                    sSek & sWord31||14499  |                                    sSek & sWord31
14728  |                            Case cSgd             ||14500  |                            Case cSgd             
14729  |                                .Cells(39 + i, 24)||14501  |                                .Cells(39 + i, 24)
14730  |                                    sSgd & sWord31||14502  |                                    sSgd & sWord31
14731  |                            Case cUsd             ||14503  |                            Case cUsd             
14732  |                                .Cells(39 + i, 24)||14504  |                                .Cells(39 + i, 24)
14733  |                                    sUsd & sWord31||14505  |                                    sUsd & sWord31
14734  |                            Case cNok             ||14506  |                            Case cNok             
14735  |                                .Cells(39 + i, 24)||14507  |                                .Cells(39 + i, 24)
14736  |                                    sNok & sWord31||14508  |                                    sNok & sWord31
14737  |                        End Select                ||14509  |                        End Select                
14738  |                    Else                          ||14510  |                    Else                          
14739  |                        '年率2行目以降            ||14511  |                        '年率2行目以降            
14740  |                        '前半金額部分             ||14512  |                        '前半金額部分             
14741  |                        .Cells(39 + i, 23).NumberF||14513  |                        .Cells(39 + i, 23).NumberF
14742  |                        If gbuMGetUPDRec.N(lRecIdx||14514  |                        If gbuMGetUPDRec.N(lRecIdx
14743  |                            .Cells(39 + i, 23).Val||14515  |                            .Cells(39 + i, 23).Val
14744  |                        Else                      ||14516  |                        Else                      
14745  |                            .Cells(39 + i, 23).Val||14517  |                            .Cells(39 + i, 23).Val
14746  |                        End If                    ||14518  |                        End If                    
14747  |                        .Cells(39 + i, 23).Horizon||14519  |                        .Cells(39 + i, 23).Horizon
14748  |                        '年率　累積値セット       ||14520  |                        '年率　累積値セット       
14749  |                        TotalRate = TotalRate + CC||14521  |                        TotalRate = TotalRate + CC
14750  |                        '後半の文言               ||14522  |                        '後半の文言               
14751  |                        Select Case gbuMGetUPDRec.||14523  |                        Select Case gbuMGetUPDRec.
14752  |                            Case cAud             ||14524  |                            Case cAud             
14753  |                                .Cells(39 + i, 24)||14525  |                                .Cells(39 + i, 24)
14754  |                                    sAud & sWord29||14526  |                                    sAud & sWord29
14755  |                                    Format(gbuOthe||14527  |                                    Format(gbuOthe
14756  |                            Case cCad             ||14528  |                            Case cCad             
14757  |                                .Cells(39 + i, 24)||14529  |                                .Cells(39 + i, 24)
14758  |                                    sCad & sWord29||14530  |                                    sCad & sWord29
14759  |                                    Format(gbuOthe||14531  |                                    Format(gbuOthe
14760  |                            Case cChf             ||14532  |                            Case cChf             
14761  |                                .Cells(39 + i, 24)||14533  |                                .Cells(39 + i, 24)
14762  |                                    sChf & sWord29||14534  |                                    sChf & sWord29
14763  |                                    Format(gbuOthe||14535  |                                    Format(gbuOthe
14764  |                            Case cEur             ||14536  |                            Case cEur             
14765  |                                .Cells(39 + i, 24)||14537  |                                .Cells(39 + i, 24)
14766  |                                    sEur & sWord29||14538  |                                    sEur & sWord29
14767  |                                    Format(gbuOthe||14539  |                                    Format(gbuOthe
14768  |                            Case cGbp             ||14540  |                            Case cGbp             
14769  |                                .Cells(39 + i, 24)||14541  |                                .Cells(39 + i, 24)
14770  |                                    sGbp & sWord29||14542  |                                    sGbp & sWord29
14771  |                                    Format(gbuOthe||14543  |                                    Format(gbuOthe
14772  |                            Case cHkd             ||14544  |                            Case cHkd             
14773  |                                .Cells(39 + i, 24)||14545  |                                .Cells(39 + i, 24)
14774  |                                    sHkd & sWord29||14546  |                                    sHkd & sWord29
14775  |                                    Format(gbuOthe||14547  |                                    Format(gbuOthe
14776  |                            Case cJpy             ||14548  |                            Case cJpy             
14777  |                                .Cells(39 + i, 24)||14549  |                                .Cells(39 + i, 24)
14778  |                                    sYen & sWord29||14550  |                                    sYen & sWord29
14779  |                                    Format(gbuOthe||14551  |                                    Format(gbuOthe
14780  |                            Case cMyr             ||14552  |                            Case cMyr             
14781  |                                .Cells(39 + i, 24)||14553  |                                .Cells(39 + i, 24)
14782  |                                    sMyr & sWord29||14554  |                                    sMyr & sWord29
14783  |                                    Format(gbuOthe||14555  |                                    Format(gbuOthe
14784  |                            Case cNzd             ||14556  |                            Case cNzd             
14785  |                                .Cells(39 + i, 24)||14557  |                                .Cells(39 + i, 24)
14786  |                                    sNzd & sWord29||14558  |                                    sNzd & sWord29
14787  |                                    Format(gbuOthe||14559  |                                    Format(gbuOthe
14788  |                            Case cSek             ||14560  |                            Case cSek             
14789  |                                .Cells(39 + i, 24)||14561  |                                .Cells(39 + i, 24)
14790  |                                    sSek & sWord29||14562  |                                    sSek & sWord29
14791  |                                    Format(gbuOthe||14563  |                                    Format(gbuOthe
14792  |                            Case cSgd             ||14564  |                            Case cSgd             
14793  |                                .Cells(39 + i, 24)||14565  |                                .Cells(39 + i, 24)
14794  |                                    sSgd & sWord29||14566  |                                    sSgd & sWord29
14795  |                                    Format(gbuOthe||14567  |                                    Format(gbuOthe
14796  |                            Case cUsd             ||14568  |                            Case cUsd             
14797  |                                .Cells(39 + i, 24)||14569  |                                .Cells(39 + i, 24)
14798  |                                    sUsd & sWord29||14570  |                                    sUsd & sWord29
14799  |                                    Format(gbuOthe||14571  |                                    Format(gbuOthe
14800  |                            Case cNok             ||14572  |                            Case cNok             
14801  |                                .Cells(39 + i, 24)||14573  |                                .Cells(39 + i, 24)
14802  |                                    sNok & sWord29||14574  |                                    sNok & sWord29
14803  |                                    Format(gbuOthe||14575  |                                    Format(gbuOthe
14804  |                        End Select                ||14576  |                        End Select                
14805  |                    End If                        ||14577  |                    End If                        
14806  |                Next i                            ||14578  |                Next i                            
14807  |            Else                                  ||14579  |            Else                                  
14808  |                '料率データが3件以下のときは行間あ||14580  |                '料率データが3件以下のときは行間あ
14809  |                For i = LBound(gbuOtherComRateGetU||14581  |                For i = LBound(gbuOtherComRateGetU
14810  |                    If i = 0 Then                 ||14582  |                    If i = 0 Then                 
14811  |                        '年率1行目                ||14583  |                        '年率1行目                
14812  |                        Select Case gbuMGetUPDRec.||14584  |                        Select Case gbuMGetUPDRec.
14813  |                            Case cAud             ||14585  |                            Case cAud             
14814  |                                .Cells(39, 13).Val||14586  |                                .Cells(39, 13).Val
14815  |                                    sWord26 & CStr||14587  |                                    sWord26 & CStr
14816  |                                    sAud & sWord27||14588  |                                    sAud & sWord27
14817  |                            Case cCad             ||14589  |                            Case cCad             
14818  |                                .Cells(39, 13).Val||14590  |                                .Cells(39, 13).Val
14819  |                                    sWord26 & CStr||14591  |                                    sWord26 & CStr
14820  |                                    sCad & sWord27||14592  |                                    sCad & sWord27
14821  |                            Case cChf             ||14593  |                            Case cChf             
14822  |                                .Cells(39, 13).Val||14594  |                                .Cells(39, 13).Val
14823  |                                    sWord26 & CStr||14595  |                                    sWord26 & CStr
14824  |                                    sChf & sWord27||14596  |                                    sChf & sWord27
14825  |                            Case cEur             ||14597  |                            Case cEur             
14826  |                                .Cells(39, 13).Val||14598  |                                .Cells(39, 13).Val
14827  |                                    sWord26 & CStr||14599  |                                    sWord26 & CStr
14828  |                                    sEur & sWord27||14600  |                                    sEur & sWord27
14829  |                            Case cGbp             ||14601  |                            Case cGbp             
14830  |                                .Cells(39, 13).Val||14602  |                                .Cells(39, 13).Val
14831  |                                    sWord26 & CStr||14603  |                                    sWord26 & CStr
14832  |                                    sGbp & sWord27||14604  |                                    sGbp & sWord27
14833  |                            Case cHkd             ||14605  |                            Case cHkd             
14834  |                                .Cells(39, 13).Val||14606  |                                .Cells(39, 13).Val
14835  |                                    sWord26 & CStr||14607  |                                    sWord26 & CStr
14836  |                                    sHkd & sWord27||14608  |                                    sHkd & sWord27
14837  |                            Case cJpy             ||14609  |                            Case cJpy             
14838  |                                .Cells(39, 13).Val||14610  |                                .Cells(39, 13).Val
14839  |                                    sWord26 & CStr||14611  |                                    sWord26 & CStr
14840  |                                    sYen & sWord27||14612  |                                    sYen & sWord27
14841  |                            Case cMyr             ||14613  |                            Case cMyr             
14842  |                                .Cells(39, 13).Val||14614  |                                .Cells(39, 13).Val
14843  |                                    sWord26 & CStr||14615  |                                    sWord26 & CStr
14844  |                                    sMyr & sWord27||14616  |                                    sMyr & sWord27
14845  |                            Case cNzd             ||14617  |                            Case cNzd             
14846  |                                .Cells(39, 13).Val||14618  |                                .Cells(39, 13).Val
14847  |                                    sWord26 & CStr||14619  |                                    sWord26 & CStr
14848  |                                    sNzd & sWord27||14620  |                                    sNzd & sWord27
14849  |                            Case cSek             ||14621  |                            Case cSek             
14850  |                                .Cells(39, 13).Val||14622  |                                .Cells(39, 13).Val
14851  |                                    sWord26 & CStr||14623  |                                    sWord26 & CStr
14852  |                                    sSek & sWord27||14624  |                                    sSek & sWord27
14853  |                            Case cSgd             ||14625  |                            Case cSgd             
14854  |                                .Cells(39, 13).Val||14626  |                                .Cells(39, 13).Val
14855  |                                    sWord26 & CStr||14627  |                                    sWord26 & CStr
14856  |                                    sSgd & sWord27||14628  |                                    sSgd & sWord27
14857  |                            Case cUsd             ||14629  |                            Case cUsd             
14858  |                                .Cells(39, 13).Val||14630  |                                .Cells(39, 13).Val
14859  |                                    sWord26 & CStr||14631  |                                    sWord26 & CStr
14860  |                                    sUsd & sWord27||14632  |                                    sUsd & sWord27
14861  |                            Case cNok             ||14633  |                            Case cNok             
14862  |                                .Cells(39, 13).Val||14634  |                                .Cells(39, 13).Val
14863  |                                    sWord26 & CStr||14635  |                                    sWord26 & CStr
14864  |                                    sNok & sWord27||14636  |                                    sNok & sWord27
14865  |                        End Select                ||14637  |                        End Select                
14866  |                        '年率　累積値セット       ||14638  |                        '年率　累積値セット       
14867  |                        TotalRate = CCur(gbuOtherC||14639  |                        TotalRate = CCur(gbuOtherC
14868  |                    ElseIf i = UBound(gbuOtherComR||14640  |                    ElseIf i = UBound(gbuOtherComR
14869  |                        If UBound(gbuOtherComRateG||14641  |                        If UBound(gbuOtherComRateG
14870  |                            '年率最終行           ||14642  |                            '年率最終行           
14871  |                            '前半金額部分         ||14643  |                            '前半金額部分         
14872  |                            .Cells(39 + i + 2, 23)||14644  |                            .Cells(39 + i + 2, 23)
14873  |                            If gbuMGetUPDRec.N(lRe||14645  |                            If gbuMGetUPDRec.N(lRe
14874  |                                .Cells(39 + i + 2,||14646  |                                .Cells(39 + i + 2,
14875  |                            Else                  ||14647  |                            Else                  
14876  |                                .Cells(39 + i + 2,||14648  |                                .Cells(39 + i + 2,
14877  |                            End If                ||14649  |                            End If                
14878  |                            .Cells(39 + i + 2, 23)||14650  |                            .Cells(39 + i + 2, 23)
14879  |                            '後半の文言           ||14651  |                            '後半の文言           
14880  |                            Select Case gbuMGetUPD||14652  |                            Select Case gbuMGetUPD
14881  |                                Case cAud         ||14653  |                                Case cAud         
14882  |                                    .Cells(39 + i ||14654  |                                    .Cells(39 + i 
14883  |                                        sAud & sWo||14655  |                                        sAud & sWo
14884  |                                Case cCad         ||14656  |                                Case cCad         
14885  |                                    .Cells(39 + i ||14657  |                                    .Cells(39 + i 
14886  |                                        sCad & sWo||14658  |                                        sCad & sWo
14887  |                                Case cChf         ||14659  |                                Case cChf         
14888  |                                    .Cells(39 + i ||14660  |                                    .Cells(39 + i 
14889  |                                        sChf & sWo||14661  |                                        sChf & sWo
14890  |                                Case cEur         ||14662  |                                Case cEur         
14891  |                                    .Cells(39 + i ||14663  |                                    .Cells(39 + i 
14892  |                                        sEur & sWo||14664  |                                        sEur & sWo
14893  |                                Case cGbp         ||14665  |                                Case cGbp         
14894  |                                    .Cells(39 + i ||14666  |                                    .Cells(39 + i 
14895  |                                        sGbp & sWo||14667  |                                        sGbp & sWo
14896  |                                Case cHkd         ||14668  |                                Case cHkd         
14897  |                                    .Cells(39 + i ||14669  |                                    .Cells(39 + i 
14898  |                                        sHkd & sWo||14670  |                                        sHkd & sWo
14899  |                                Case cJpy         ||14671  |                                Case cJpy         
14900  |                                    .Cells(39 + i ||14672  |                                    .Cells(39 + i 
14901  |                                        sYen & sWo||14673  |                                        sYen & sWo
14902  |                                Case cMyr         ||14674  |                                Case cMyr         
14903  |                                    .Cells(39 + i ||14675  |                                    .Cells(39 + i 
14904  |                                        sMyr & sWo||14676  |                                        sMyr & sWo
14905  |                                Case cNzd         ||14677  |                                Case cNzd         
14906  |                                    .Cells(39 + i ||14678  |                                    .Cells(39 + i 
14907  |                                        sNzd & sWo||14679  |                                        sNzd & sWo
14908  |                                Case cSek         ||14680  |                                Case cSek         
14909  |                                    .Cells(39 + i ||14681  |                                    .Cells(39 + i 
14910  |                                        sSek & sWo||14682  |                                        sSek & sWo
14911  |                                Case cSgd         ||14683  |                                Case cSgd         
14912  |                                    .Cells(39 + i ||14684  |                                    .Cells(39 + i 
14913  |                                        sSgd & sWo||14685  |                                        sSgd & sWo
14914  |                                Case cUsd         ||14686  |                                Case cUsd         
14915  |                                    .Cells(39 + i ||14687  |                                    .Cells(39 + i 
14916  |                                        sUsd & sWo||14688  |                                        sUsd & sWo
14917  |                                Case cNok         ||14689  |                                Case cNok         
14918  |                                    .Cells(39 + i ||14690  |                                    .Cells(39 + i 
14919  |                                        sNok & sWo||14691  |                                        sNok & sWo
14920  |                            End Select            ||14692  |                            End Select            
14921  |                        Else                      ||14693  |                        Else                      
14922  |                            '年率最終行           ||14694  |                            '年率最終行           
14923  |                            '前半金額部分         ||14695  |                            '前半金額部分         
14924  |                            .Cells(39 + i + 1, 23)||14696  |                            .Cells(39 + i + 1, 23)
14925  |                            If gbuMGetUPDRec.N(lRe||14697  |                            If gbuMGetUPDRec.N(lRe
14926  |                                .Cells(39 + i + 1,||14698  |                                .Cells(39 + i + 1,
14927  |                            Else                  ||14699  |                            Else                  
14928  |                                .Cells(39 + i + 1,||14700  |                                .Cells(39 + i + 1,
14929  |                            End If                ||14701  |                            End If                
14930  |                            .Cells(39 + i + 1, 23)||14702  |                            .Cells(39 + i + 1, 23)
14931  |                            '後半の文言           ||14703  |                            '後半の文言           
14932  |                            Select Case gbuMGetUPD||14704  |                            Select Case gbuMGetUPD
14933  |                                Case cAud         ||14705  |                                Case cAud         
14934  |                                    .Cells(39 + i ||14706  |                                    .Cells(39 + i 
14935  |                                        sAud & sWo||14707  |                                        sAud & sWo
14936  |                                Case cCad         ||14708  |                                Case cCad         
14937  |                                    .Cells(39 + i ||14709  |                                    .Cells(39 + i 
14938  |                                        sCad & sWo||14710  |                                        sCad & sWo
14939  |                                Case cChf         ||14711  |                                Case cChf         
14940  |                                    .Cells(39 + i ||14712  |                                    .Cells(39 + i 
14941  |                                        sChf & sWo||14713  |                                        sChf & sWo
14942  |                                Case cEur         ||14714  |                                Case cEur         
14943  |                                    .Cells(39 + i ||14715  |                                    .Cells(39 + i 
14944  |                                        sEur & sWo||14716  |                                        sEur & sWo
14945  |                                Case cGbp         ||14717  |                                Case cGbp         
14946  |                                    .Cells(39 + i ||14718  |                                    .Cells(39 + i 
14947  |                                        sGbp & sWo||14719  |                                        sGbp & sWo
14948  |                                Case cHkd         ||14720  |                                Case cHkd         
14949  |                                    .Cells(39 + i ||14721  |                                    .Cells(39 + i 
14950  |                                        sHkd & sWo||14722  |                                        sHkd & sWo
14951  |                                Case cJpy         ||14723  |                                Case cJpy         
14952  |                                    .Cells(39 + i ||14724  |                                    .Cells(39 + i 
14953  |                                        sYen & sWo||14725  |                                        sYen & sWo
14954  |                                Case cMyr         ||14726  |                                Case cMyr         
14955  |                                    .Cells(39 + i ||14727  |                                    .Cells(39 + i 
14956  |                                        sMyr & sWo||14728  |                                        sMyr & sWo
14957  |                                Case cNzd         ||14729  |                                Case cNzd         
14958  |                                    .Cells(39 + i ||14730  |                                    .Cells(39 + i 
14959  |                                        sNzd & sWo||14731  |                                        sNzd & sWo
14960  |                                Case cSek         ||14732  |                                Case cSek         
14961  |                                    .Cells(39 + i ||14733  |                                    .Cells(39 + i 
14962  |                                        sSek & sWo||14734  |                                        sSek & sWo
14963  |                                Case cSgd         ||14735  |                                Case cSgd         
14964  |                                    .Cells(39 + i ||14736  |                                    .Cells(39 + i 
14965  |                                        sSgd & sWo||14737  |                                        sSgd & sWo
14966  |                                Case cUsd         ||14738  |                                Case cUsd         
14967  |                                    .Cells(39 + i ||14739  |                                    .Cells(39 + i 
14968  |                                        sUsd & sWo||14740  |                                        sUsd & sWo
14969  |                                Case cNok         ||14741  |                                Case cNok         
14970  |                                    .Cells(39 + i ||14742  |                                    .Cells(39 + i 
14971  |                                        sNok & sWo||14743  |                                        sNok & sWo
14972  |                            End Select            ||14744  |                            End Select            
14973  |                        End If                    ||14745  |                        End If                    
14974  |                    Else                          ||14746  |                    Else                          
14975  |                        '年率2行目以降            ||14747  |                        '年率2行目以降            
14976  |                        '前半金額部分             ||14748  |                        '前半金額部分             
14977  |                        .Cells(39 + i + 1, 23).Num||14749  |                        .Cells(39 + i + 1, 23).Num
14978  |                        If gbuMGetUPDRec.N(lRecIdx||14750  |                        If gbuMGetUPDRec.N(lRecIdx
14979  |                            .Cells(39 + i + 1, 23)||14751  |                            .Cells(39 + i + 1, 23)
14980  |                        Else                      ||14752  |                        Else                      
14981  |                            .Cells(39 + i + 1, 23)||14753  |                            .Cells(39 + i + 1, 23)
14982  |                        End If                    ||14754  |                        End If                    
14983  |                        .Cells(39 + i + 1, 23).Hor||14755  |                        .Cells(39 + i + 1, 23).Hor
14984  |                        '年率　累積値セット       ||14756  |                        '年率　累積値セット       
14985  |                        TotalRate = TotalRate + CC||14757  |                        TotalRate = TotalRate + CC
14986  |                        '後半の文言               ||14758  |                        '後半の文言               
14987  |                        Select Case gbuMGetUPDRec.||14759  |                        Select Case gbuMGetUPDRec.
14988  |                            Case cAud             ||14760  |                            Case cAud             
14989  |                                .Cells(39 + i + 1,||14761  |                                .Cells(39 + i + 1,
14990  |                                    sAud & sWord29||14762  |                                    sAud & sWord29
14991  |                                    Format(gbuOthe||14763  |                                    Format(gbuOthe
14992  |                            Case cCad             ||14764  |                            Case cCad             
14993  |                                .Cells(39 + i + 1,||14765  |                                .Cells(39 + i + 1,
14994  |                                    sCad & sWord29||14766  |                                    sCad & sWord29
14995  |                                    Format(gbuOthe||14767  |                                    Format(gbuOthe
14996  |                            Case cChf             ||14768  |                            Case cChf             
14997  |                                .Cells(39 + i + 1,||14769  |                                .Cells(39 + i + 1,
14998  |                                    sChf & sWord29||14770  |                                    sChf & sWord29
14999  |                                    Format(gbuOthe||14771  |                                    Format(gbuOthe
15000  |                            Case cEur             ||14772  |                            Case cEur             
15001  |                                .Cells(39 + i + 1,||14773  |                                .Cells(39 + i + 1,
15002  |                                    sEur & sWord29||14774  |                                    sEur & sWord29
15003  |                                    Format(gbuOthe||14775  |                                    Format(gbuOthe
15004  |                            Case cGbp             ||14776  |                            Case cGbp             
15005  |                                .Cells(39 + i + 1,||14777  |                                .Cells(39 + i + 1,
15006  |                                    sGbp & sWord29||14778  |                                    sGbp & sWord29
15007  |                                    Format(gbuOthe||14779  |                                    Format(gbuOthe
15008  |                            Case cHkd             ||14780  |                            Case cHkd             
15009  |                                .Cells(39 + i + 1,||14781  |                                .Cells(39 + i + 1,
15010  |                                    sHkd & sWord29||14782  |                                    sHkd & sWord29
15011  |                                    Format(gbuOthe||14783  |                                    Format(gbuOthe
15012  |                            Case cJpy             ||14784  |                            Case cJpy             
15013  |                                .Cells(39 + i + 1,||14785  |                                .Cells(39 + i + 1,
15014  |                                    sYen & sWord29||14786  |                                    sYen & sWord29
15015  |                                    Format(gbuOthe||14787  |                                    Format(gbuOthe
15016  |                            Case cMyr             ||14788  |                            Case cMyr             
15017  |                                .Cells(39 + i + 1,||14789  |                                .Cells(39 + i + 1,
15018  |                                    sMyr & sWord29||14790  |                                    sMyr & sWord29
15019  |                                    Format(gbuOthe||14791  |                                    Format(gbuOthe
15020  |                            Case cNzd             ||14792  |                            Case cNzd             
15021  |                                .Cells(39 + i + 1,||14793  |                                .Cells(39 + i + 1,
15022  |                                    sNzd & sWord29||14794  |                                    sNzd & sWord29
15023  |                                    Format(gbuOthe||14795  |                                    Format(gbuOthe
15024  |                            Case cSek             ||14796  |                            Case cSek             
15025  |                                .Cells(39 + i + 1,||14797  |                                .Cells(39 + i + 1,
15026  |                                    sSek & sWord29||14798  |                                    sSek & sWord29
15027  |                                    Format(gbuOthe||14799  |                                    Format(gbuOthe
15028  |                            Case cSgd             ||14800  |                            Case cSgd             
15029  |                                .Cells(39 + i + 1,||14801  |                                .Cells(39 + i + 1,
15030  |                                    sSgd & sWord29||14802  |                                    sSgd & sWord29
15031  |                                    Format(gbuOthe||14803  |                                    Format(gbuOthe
15032  |                            Case cUsd             ||14804  |                            Case cUsd             
15033  |                                .Cells(39 + i + 1,||14805  |                                .Cells(39 + i + 1,
15034  |                                    sUsd & sWord29||14806  |                                    sUsd & sWord29
15035  |                                    Format(gbuOthe||14807  |                                    Format(gbuOthe
15036  |                            Case cNok             ||14808  |                            Case cNok             
15037  |                                .Cells(39 + i + 1,||14809  |                                .Cells(39 + i + 1,
15038  |                                    sNok & sWord29||14810  |                                    sNok & sWord29
15039  |                                    Format(gbuOthe||14811  |                                    Format(gbuOthe
15040  |                        End Select                ||14812  |                        End Select                
15041  |                    End If                        ||14813  |                    End If                        
15042  |                Next i                            ||14814  |                Next i                            
15043  |            End If                                ||14815  |            End If                                
15044  |        End If                                    ||14816  |        End If                                    
15045  |    End With                                      ||14817  |    End With                                      
15046  |End Sub                                           ||14818  |End Sub                                           
15047  |                                                  ||14819  |                                                  
15048  |'=================================================||14820  |'=================================================
15049  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbExcelChgRateSheetOut       ||14821  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbExcelChgRateSheetOut       
15050  |'機能            :   確認書の料率変更履歴出力     ||14822  |'機能            :   確認書の料率変更履歴出力     
15051  |'                                                 ||14823  |'                                                 
15052  |'日付               担当　              修正内容  ||14824  |'日付               担当　              修正内容  
15053  |'-------------------------------------------------||14825  |'-------------------------------------------------
15054  |'2006/07/19         K.Furuya <SRA>     新規作成(期||14826  |'2006/07/19         K.Furuya <SRA>     新規作成(期
15055  |'=================================================||14827  |'=================================================
15056  |Private Sub sbExcelChgRateSheetOut( _             ||14828  |Private Sub sbExcelChgRateSheetOut( _             
15057  |    ByVal sGetAccCode As String, _                ||14829  |    ByVal sGetAccCode As String, _                
15058  |    ByVal TotalRate As Currency, _                ||14830  |    ByVal TotalRate As Currency, _                
15059  |    ByVal lRecIdx As Long, _                      ||14831  |    ByVal lRecIdx As Long, _                      
15060  |    ByVal StartDate As Date, _                    ||14832  |    ByVal StartDate As Date, _                    
15061  |    ByVal EndDate As Date, _                      ||14833  |    ByVal EndDate As Date, _                      
15062  |    ByVal dlngMeisyoSu As Integer, _              ||14834  |    ByVal dlngMeisyoSu As Integer, _              
15063  |    ByVal NavGetFlg As String _                   ||14835  |    ByVal NavGetFlg As String _                   
15064  |    )                                             ||14836  |    )                                             
15065  |    Dim i       As Integer                        ||14837  |    Dim i       As Integer                        
15066  |    Dim J       As Integer                        ||14838  |    Dim J       As Integer                        
15067  |    Dim Idx_i   As Integer                        ||14839  |    Dim Idx_i   As Integer                        
15068  |    Dim Idx_j   As Integer                        ||14840  |    Dim Idx_j   As Integer                        
15069  |    Dim Add_i   As Integer                        ||14841  |    Dim Add_i   As Integer                        
15070  |    Dim PgIndx  As Integer                        ||14842  |    Dim PgIndx  As Integer                        
15071  |    Dim RateCnt As Integer                        ||14843  |    Dim RateCnt As Integer                        
15072  |    Dim AddRateCnt As Integer                     ||14844  |    Dim AddRateCnt As Integer                     
15073  |    Dim iPage   As Integer                        ||14845  |    Dim iPage   As Integer                        
15074  |    Dim GenPage As Integer                        ||14846  |    Dim GenPage As Integer                        
15075  |    Dim iAmari  As Integer                        ||14847  |    Dim iAmari  As Integer                        
15076  |    Dim SetPoint As Integer                       ||14848  |    Dim SetPoint As Integer                       
15077  |    Dim StartLine As Integer                      ||14849  |    Dim StartLine As Integer                      
15078  |    Const StartPoint As Integer = 12              ||14850  |    Const StartPoint As Integer = 12              
15079  |    Const FixedLine As Integer = 6                ||14851  |    Const FixedLine As Integer = 6                
15080  |    Const DivideLine As Integer = 4               ||14852  |    Const DivideLine As Integer = 4               
15081  |    Const KikanLine As Integer = 1                ||14853  |    Const KikanLine As Integer = 1                
15082  |    Const AddLine As Integer = 2                  ||14854  |    Const AddLine As Integer = 2                  
15083  |                                                  ||14855  |                                                  
15084  |                                                  ||14856  |                                                  
15085  |    RateCnt = 0                                   ||14857  |    RateCnt = 0                                   
15086  |                                                  ||14858  |                                                  
15087  |    If gbuMGetUPDRec.N(lRecIdx).MGET_other_rate_ru||14859  |    If gbuMGetUPDRec.N(lRecIdx).MGET_other_rate_ru
15088  |        For i = LBound(gtypOtherComRec) To UBound(||14860  |        For i = LBound(gtypOtherComRec) To UBound(
15089  |            For J = LBound(gtypOtherComRec(i).APPL||14861  |            For J = LBound(gtypOtherComRec(i).APPL
15090  |                '料率の数を積算                   ||14862  |                '料率の数を積算                   
15091  |                RateCnt = RateCnt + 1             ||14863  |                RateCnt = RateCnt + 1             
15092  |            Next J                                ||14864  |            Next J                                
15093  |            If i = UBound(gtypOtherComRec) Then   ||14865  |            If i = UBound(gtypOtherComRec) Then   
15094  |                RateCnt = RateCnt + AddLine       ||14866  |                RateCnt = RateCnt + AddLine       
15095  |            Else                                  ||14867  |            Else                                  
15096  |                RateCnt = RateCnt + FixedLine + Ad||14868  |                RateCnt = RateCnt + FixedLine + Ad
15097  |            End If                                ||14869  |            End If                                
15098  |        Next i                                    ||14870  |        Next i                                    
15099  |    Else                                          ||14871  |    Else                                          
15100  |        For i = LBound(gtypOtherComRec) To UBound(||14872  |        For i = LBound(gtypOtherComRec) To UBound(
15101  |            For J = LBound(gtypOtherComRec(i).APPL||14873  |            For J = LBound(gtypOtherComRec(i).APPL
15102  |                '料率の数を積算                   ||14874  |                '料率の数を積算                   
15103  |                RateCnt = RateCnt + 1             ||14875  |                RateCnt = RateCnt + 1             
15104  |            Next J                                ||14876  |            Next J                                
15105  |            If i = UBound(gtypOtherComRec) Then   ||14877  |            If i = UBound(gtypOtherComRec) Then   
15106  |                RateCnt = RateCnt + AddLine       ||14878  |                RateCnt = RateCnt + AddLine       
15107  |            Else                                  ||14879  |            Else                                  
15108  |                RateCnt = RateCnt + DivideLine + A||14880  |                RateCnt = RateCnt + DivideLine + A
15109  |            End If                                ||14881  |            End If                                
15110  |        Next i                                    ||14882  |        Next i                                    
15111  |    End If                                        ||14883  |    End If                                        
15112  |                                                  ||14884  |                                                  
15113  |    '頁数を計算する                               ||14885  |    '頁数を計算する                               
15114  |    iPage = RateCnt \ 51 '51は有効行数            ||14886  |    iPage = RateCnt \ 51 '51は有効行数            
15115  |    '頁が割切れるか計算する                       ||14887  |    '頁が割切れるか計算する                       
15116  |    iAmari = RateCnt Mod 51                       ||14888  |    iAmari = RateCnt Mod 51                       
15117  |    '頁が割切れない場合は一頁増やす               ||14889  |    '頁が割切れない場合は一頁増やす               
15118  |    If iAmari <> 0 Then                           ||14890  |    If iAmari <> 0 Then                           
15119  |        iPage = iPage + 1                         ||14891  |        iPage = iPage + 1                         
15120  |    End If                                        ||14892  |    End If                                        
15121  |                                                  ||14893  |                                                  
15122  |    'ループの開始ポジション変数を初期化           ||14894  |    'ループの開始ポジション変数を初期化           
15123  |    SetPoint = 0                                  ||14895  |    SetPoint = 0                                  
15124  |    'ループ変数のインクリメント変数を初期化       ||14896  |    'ループ変数のインクリメント変数を初期化       
15125  |    Add_i = 0                                     ||14897  |    Add_i = 0                                     
15126  |    'シート番号を初期化                           ||14898  |    'シート番号を初期化                           
15127  |    gTotalDnavCnt = 0                             ||14899  |    gTotalDnavCnt = 0                             
15128  |                                                  ||14900  |                                                  
15129  |    For PgIndx = 1 To iPage                       ||14901  |    For PgIndx = 1 To iPage                       
15130  |        'ルール単位の料率文言の行数取得変数の初期 ||14902  |        'ルール単位の料率文言の行数取得変数の初期 
15131  |        RateCnt = StartPoint                      ||14903  |        RateCnt = StartPoint                      
15132  |        AddRateCnt = 0                            ||14904  |        AddRateCnt = 0                            
15133  |                                                  ||14905  |                                                  
15134  |                                                  ||14906  |                                                  
15135  |        'スタート行をセット                       ||14907  |        'スタート行をセット                       
15136  |        StartLine = StartPoint                    ||14908  |        StartLine = StartPoint                    
15137  |                                                  ||14909  |                                                  
15138  |        xlBook.Worksheets.Add after:=xlBook.Sheets||14910  |        xlBook.Worksheets.Add after:=xlBook.Sheets
15139  |        gProcessCnt = gProcessCnt + 1             ||14911  |        gProcessCnt = gProcessCnt + 1             
15140  |        Set xlSheet = xlBook.Sheets(gProcessCnt)  ||14912  |        Set xlSheet = xlBook.Sheets(gProcessCnt)  
15141  |                                                  ||14913  |                                                  
15142  |        'Excelフォーマットを調整                  ||14914  |        'Excelフォーマットを調整                  
15143  |        xlSheet.Cells.ColumnWidth = 1             ||14915  |        xlSheet.Cells.ColumnWidth = 1             
15144  |        xlSheet.Cells.Font.Size = 11              ||14916  |        xlSheet.Cells.Font.Size = 11              
15145  |        'シート名を設定(日次NAV一覧**)            ||14917  |        'シート名を設定(日次NAV一覧**)            
15146  |                                                  ||14918  |                                                  
15147  |        If dstrOldAccCode = sGetAccCode Then      ||14919  |        If dstrOldAccCode = sGetAccCode Then      
15148  |            gTotalDnavCnt = gTotalDnavCnt + 1     ||14920  |            gTotalDnavCnt = gTotalDnavCnt + 1     
15149  |        Else                                      ||14921  |        Else                                      
15150  |            gTotalDnavCnt = 1                     ||14922  |            gTotalDnavCnt = 1                     
15151  |            dstrOldAccCode = sGetAccCode          ||14923  |            dstrOldAccCode = sGetAccCode          
15152  |        End If                                    ||14924  |        End If                                    
15153  |        'gTotalCnt = gTotalCnt + 1                ||14925  |        'gTotalCnt = gTotalCnt + 1                
15154  |        'xlBook.Sheets(gProcessCnt).Name = sWord53||14926  |        'xlBook.Sheets(gProcessCnt).Name = sWord53
15155  |        '複数ページの場合                         ||14927  |        '複数ページの場合                         
15156  |        If iPage > 1 Then                         ||14928  |        If iPage > 1 Then                         
15157  |            xlBook.Sheets(gProcessCnt).Name = sWor||14929  |            xlBook.Sheets(gProcessCnt).Name = sWor
15158  |        Else                                      ||14930  |        Else                                      
15159  |            xlBook.Sheets(gProcessCnt).Name = sWor||14931  |            xlBook.Sheets(gProcessCnt).Name = sWor
15160  |        End If                                    ||14932  |        End If                                    
15161  |        'シートの余白を設定                       ||14933  |        'シートの余白を設定                       
15162  |        xlSheet.PageSetup.TopMargin = Application.||14934  |        xlSheet.PageSetup.TopMargin = Application.
15163  |        xlSheet.PageSetup.BottomMargin = Applicati||14935  |        xlSheet.PageSetup.BottomMargin = Applicati
15164  |        xlSheet.PageSetup.LeftMargin = Application||14936  |        xlSheet.PageSetup.LeftMargin = Application
15165  |        xlSheet.PageSetup.RightMargin = Applicatio||14937  |        xlSheet.PageSetup.RightMargin = Applicatio
15166  |                                                  ||14938  |                                                  
15167  |        DoEvents                                  ||14939  |        DoEvents                                  
15168  |                                                  ||14940  |                                                  
15169  |                                                  ||14941  |                                                  
15170  |        With xlSheet                              ||14942  |        With xlSheet                              
15171  |            '題目                                 ||14943  |            '題目                                 
15172  |            .Cells(5, 1).Value = sWord53          ||14944  |            .Cells(5, 1).Value = sWord53          
15173  |            .Cells(5, 1).Font.Size = 14           ||14945  |            .Cells(5, 1).Font.Size = 14           
15174  |            .Range("A5:BG5").HorizontalAlignment =||14946  |            .Range("A5:BG5").HorizontalAlignment =
15175  |            '出力日付                             ||14947  |            '出力日付                             
15176  |            If RTrim(txtSysOutDate.Text) = "" Then||14948  |            If RTrim(txtSysOutDate.Text) = "" Then
15177  |                .Cells(3, 50).Value = sWord34     ||14949  |                .Cells(3, 50).Value = sWord34     
15178  |                .Cells(3, 50).HorizontalAlignment ||14950  |                .Cells(3, 50).HorizontalAlignment 
15179  |            Else                                  ||14951  |            Else                                  
15180  |                .Cells(3, 43).Value = CStr(Format(||14952  |                .Cells(3, 43).Value = CStr(Format(
15181  |            End If                                ||14953  |            End If                                
15182  |            'ファンド名                           ||14954  |            'ファンド名                           
15183  |            .Cells(7, 2).Value = sWord4           ||14955  |            .Cells(7, 2).Value = sWord4           
15184  |            .Cells(7, 12).Value = sWord19         ||14956  |            .Cells(7, 12).Value = sWord19         
15185  |            .Cells(7, 14).NumberFormatLocal = "@" ||14957  |            .Cells(7, 14).NumberFormatLocal = "@" 
15186  |            .Cells(7, 14).Value = gbuMGetUPDRec.N(||14958  |            .Cells(7, 14).Value = gbuMGetUPDRec.N(
15187  |            'ファンドコード                       ||14959  |            'ファンドコード                       
15188  |            .Cells(8, 2).Value = sWord4_2         ||14960  |            .Cells(8, 2).Value = sWord4_2         
15189  |            .Cells(8, 12).Value = sWord19         ||14961  |            .Cells(8, 12).Value = sWord19         
15190  |            .Cells(8, 14).NumberFormatLocal = "@" ||14962  |            .Cells(8, 14).NumberFormatLocal = "@" 
15191  |            .Cells(8, 14).Value = sGetAccCode     ||14963  |            .Cells(8, 14).Value = sGetAccCode     
15192  |                                                  ||14964  |                                                  
15193  |            '計算期間                             ||14965  |            '計算期間                             
15194  |            .Cells(10, 2).Value = sWord5          ||14966  |            .Cells(10, 2).Value = sWord5          
15195  |            .Cells(10, 12).Value = sWord19        ||14967  |            .Cells(10, 12).Value = sWord19        
15196  |            '名称許諾料計算で日次(休日無し)       ||14968  |            '名称許諾料計算で日次(休日無し)       
15197  |            If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c||14969  |            If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c
15198  |            And gbuMGetUPDRec.N(lRecIdx).MGET_nav_||14970  |            And gbuMGetUPDRec.N(lRecIdx).MGET_nav_
15199  |                .Cells(10, 14).Value = _          ||14971  |                .Cells(10, 14).Value = _          
15200  |                    CStr(Format(StartDate, "YYYY年||14972  |                    CStr(Format(StartDate, "YYYY年
15201  |            Else                                  ||14973  |            Else                                  
15202  |                .Cells(10, 14).Value = _          ||14974  |                .Cells(10, 14).Value = _          
15203  |                    CStr(Format(StartDate, "YYYY年||14975  |                    CStr(Format(StartDate, "YYYY年
15204  |            End If                                ||14976  |            End If                                
15205  |            '固定料率                             ||14977  |            '固定料率                             
15206  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||14978  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
15207  |                '年率1行固定                      ||14979  |                '年率1行固定                      
15208  |                For i = SetPoint To UBound(gtypOth||14980  |                For i = SetPoint To UBound(gtypOth
15209  |                                                  ||14981  |                                                  
15210  |                    'ループ変数のインクリメント変 ||14982  |                    'ループ変数のインクリメント変 
15211  |                    Add_i = Add_i + 1             ||14983  |                    Add_i = Add_i + 1             
15212  |                                                  ||14984  |                                                  
15213  |                    For J = LBound(gtypOtherComRec||14985  |                    For J = LBound(gtypOtherComRec
15214  |                    '適用期間                     ||14986  |                    '適用期間                     
15215  |                        .Cells(StartLine, 2).Value||14987  |                        .Cells(StartLine, 2).Value
15216  |                        .Cells(StartLine, 12).Valu||14988  |                        .Cells(StartLine, 12).Valu
15217  |                        '名称許諾料計算で日次(休日||14989  |                        '名称許諾料計算で日次(休日
15218  |                        If Mid(gbuMGetUPDRec.N(lRe||14990  |                        If Mid(gbuMGetUPDRec.N(lRe
15219  |                        And gbuMGetUPDRec.N(lRecId||14991  |                        And gbuMGetUPDRec.N(lRecId
15220  |                            .Cells(StartLine, 14).||14992  |                            .Cells(StartLine, 14).
15221  |                                CStr(Format(gstrDa||14993  |                                CStr(Format(gstrDa
15222  |                                sWord20 & CStr(For||14994  |                                sWord20 & CStr(For
15223  |                                sWord59 & sWord43 ||14995  |                                sWord59 & sWord43 
15224  |                        Else                      ||14996  |                        Else                      
15225  |                            .Cells(StartLine, 14).||14997  |                            .Cells(StartLine, 14).
15226  |                                CStr(Format(gstrDa||14998  |                                CStr(Format(gstrDa
15227  |                                sWord20 & CStr(For||14999  |                                sWord20 & CStr(For
15228  |                                sWord59 & sWord43 ||15000  |                                sWord59 & sWord43 
15229  |                        End If                    ||15001  |                        End If                    
15230  |                    '平均純資産総額               ||15002  |                    '平均純資産総額               
15231  |                        .Cells(StartLine + KikanLi||15003  |                        .Cells(StartLine + KikanLi
15232  |                        .Cells(StartLine + KikanLi||15004  |                        .Cells(StartLine + KikanLi
15233  |                        '計算期間の純資産総額の合 ||15005  |                        '計算期間の純資産総額の合 
15234  |                        .Cells(StartLine + KikanLi||15006  |                        .Cells(StartLine + KikanLi
15235  |                        If gtypOtherComRec(i).APPL||15007  |                        If gtypOtherComRec(i).APPL
15236  |                            .Cells(StartLine + Kik||15008  |                            .Cells(StartLine + Kik
15237  |                        Else                      ||15009  |                        Else                      
15238  |                            .Cells(StartLine + Kik||15010  |                            .Cells(StartLine + Kik
15239  |                        End If                    ||15011  |                        End If                    
15240  |                        .Cells(StartLine + KikanLi||15012  |                        .Cells(StartLine + KikanLi
15241  |                        '計算期間の純資産総額の合 ||15013  |                        '計算期間の純資産総額の合 
15242  |                        .Cells(StartLine + KikanLi||15014  |                        .Cells(StartLine + KikanLi
15243  |                        'NAV区分が '1' の場合（月 ||15015  |                        'NAV区分が '1' の場合（月 
15244  |                        If NavGetFlg = "1" Then   ||15016  |                        If NavGetFlg = "1" Then   
15245  |                            dblValueIn = gtypOther||15017  |                            dblValueIn = gtypOther
15246  |                        '日次の場合               ||15018  |                        '日次の場合               
15247  |                        Else                      ||15019  |                        Else                      
15248  |                            dblValueIn = gtypOther||15020  |                            dblValueIn = gtypOther
15249  |                        End If                    ||15021  |                        End If                    
15250  |                        If gtypOtherComRec(i).APPL||15022  |                        If gtypOtherComRec(i).APPL
15251  |                              Call sbGetRoundValue||15023  |                              Call sbGetRoundValue
15252  |                        Else                      ||15024  |                        Else                      
15253  |                              Call sbGetRoundValue||15025  |                              Call sbGetRoundValue
15254  |                        End If                    ||15026  |                        End If                    
15255  |                        '平均NAV(計算対象NAV)     ||15027  |                        '平均NAV(計算対象NAV)     
15256  |                        If gtypOtherComRec(i).APPL||15028  |                        If gtypOtherComRec(i).APPL
15257  |                            .Cells(StartLine + Kik||15029  |                            .Cells(StartLine + Kik
15258  |                        Else                      ||15030  |                        Else                      
15259  |                            .Cells(StartLine + Kik||15031  |                            .Cells(StartLine + Kik
15260  |                        End If                    ||15032  |                        End If                    
15261  |                        '÷??＝ ,文言             ||15033  |                        '÷??＝ ,文言             
15262  |                        'NAV区分が '1' の場合（月 ||15034  |                        'NAV区分が '1' の場合（月 
15263  |                        If NavGetFlg = "1" Then   ||15035  |                        If NavGetFlg = "1" Then   
15264  |                            .Cells(StartLine + Kik||15036  |                            .Cells(StartLine + Kik
15265  |                        '日次の場合               ||15037  |                        '日次の場合               
15266  |                        Else                      ||15038  |                        Else                      
15267  |                            .Cells(StartLine + Kik||15039  |                            .Cells(StartLine + Kik
15268  |                        End If                    ||15040  |                        End If                    
15269  |                    '年率                         ||15041  |                    '年率                         
15270  |                        .Cells(StartLine + AddLine||15042  |                        .Cells(StartLine + AddLine
15271  |                        .Cells(StartLine + AddLine||15043  |                        .Cells(StartLine + AddLine
15272  |                        .Cells(StartLine + AddLine||15044  |                        .Cells(StartLine + AddLine
15273  |                            sWord30 & Format(gtypO||15045  |                            sWord30 & Format(gtypO
15274  |                        '年率文言の行数をカウント ||15046  |                        '年率文言の行数をカウント 
15275  |                        RateCnt = RateCnt + 2     ||15047  |                        RateCnt = RateCnt + 2     
15276  |                    Next J                        ||15048  |                    Next J                        
15277  |                    '年率文言の行数にスペース行を ||15049  |                    '年率文言の行数にスペース行を 
15278  |                    RateCnt = RateCnt + FixedLine ||15050  |                    RateCnt = RateCnt + FixedLine 
15279  |                                                  ||15051  |                                                  
15280  |                    '次料率の行数を取得する       ||15052  |                    '次料率の行数を取得する       
15281  |                    '配列の要素の最大値までを取得 ||15053  |                    '配列の要素の最大値までを取得 
15282  |                    If i < UBound(gtypOtherComRec)||15054  |                    If i < UBound(gtypOtherComRec)
15283  |                        For Idx_i = i + 1 To i + 1||15055  |                        For Idx_i = i + 1 To i + 1
15284  |                            For Idx_j = LBound(gty||15056  |                            For Idx_j = LBound(gty
15285  |                                '料率の数を積算   ||15057  |                                '料率の数を積算   
15286  |                                AddRateCnt = AddRa||15058  |                                AddRateCnt = AddRa
15287  |                            Next Idx_j            ||15059  |                            Next Idx_j            
15288  |                            AddRateCnt = AddRateCn||15060  |                            AddRateCnt = AddRateCn
15289  |                        Next Idx_i                ||15061  |                        Next Idx_i                
15290  |                    End If                        ||15062  |                    End If                        
15291  |                                                  ||15063  |                                                  
15292  |                    '行数を計算する               ||15064  |                    '行数を計算する               
15293  |                    GenPage = RateCnt + AddRateCnt||15065  |                    GenPage = RateCnt + AddRateCnt
15294  |                                                  ||15066  |                                                  
15295  |                    AddRateCnt = 0                ||15067  |                    AddRateCnt = 0                
15296  |                                                  ||15068  |                                                  
15297  |                    '行数が溢れたら改ページ       ||15069  |                    '行数が溢れたら改ページ       
15298  |                    If conSheetLastLine < GenPage ||15070  |                    If conSheetLastLine < GenPage 
15299  |                        'ループの開始ポジション変 ||15071  |                        'ループの開始ポジション変 
15300  |                        SetPoint = Add_i          ||15072  |                        SetPoint = Add_i          
15301  |                        Exit For                  ||15073  |                        Exit For                  
15302  |                    End If                        ||15074  |                    End If                        
15303  |                                                  ||15075  |                                                  
15304  |                    '次の開始行をセット           ||15076  |                    '次の開始行をセット           
15305  |                    RateCnt = RateCnt + 1         ||15077  |                    RateCnt = RateCnt + 1         
15306  |                    StartLine = RateCnt           ||15078  |                    StartLine = RateCnt           
15307  |                Next i                            ||15079  |                Next i                            
15308  |            '段階料率                             ||15080  |            '段階料率                             
15309  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_o||15081  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_o
15310  |                For i = SetPoint To UBound(gtypOth||15082  |                For i = SetPoint To UBound(gtypOth
15311  |                    'ループ変数のインクリメント変 ||15083  |                    'ループ変数のインクリメント変 
15312  |                    Add_i = Add_i + 1             ||15084  |                    Add_i = Add_i + 1             
15313  |                    TotalRate = 0                 ||15085  |                    TotalRate = 0                 
15314  |                    '適用期間一行目               ||15086  |                    '適用期間一行目               
15315  |                    For J = LBound(gtypOtherComRec||15087  |                    For J = LBound(gtypOtherComRec
15316  |                        If J = 0 Then             ||15088  |                        If J = 0 Then             
15317  |                        '年率1行目                ||15089  |                        '年率1行目                
15318  |                        '適用期間                 ||15090  |                        '適用期間                 
15319  |                            .Cells(StartLine + J, ||15091  |                            .Cells(StartLine + J, 
15320  |                            .Cells(StartLine + J, ||15092  |                            .Cells(StartLine + J, 
15321  |                            '名称許諾料計算で日次(||15093  |                            '名称許諾料計算で日次(
15322  |                            If Mid(gbuMGetUPDRec.N||15094  |                            If Mid(gbuMGetUPDRec.N
15323  |                            And gbuMGetUPDRec.N(lR||15095  |                            And gbuMGetUPDRec.N(lR
15324  |                                .Cells(StartLine +||15096  |                                .Cells(StartLine +
15325  |                                    CStr(Format(gs||15097  |                                    CStr(Format(gs
15326  |                                    sWord20 & CStr||15098  |                                    sWord20 & CStr
15327  |                                    sWord59 & sWor||15099  |                                    sWord59 & sWor
15328  |                            Else                  ||15100  |                            Else                  
15329  |                                .Cells(StartLine +||15101  |                                .Cells(StartLine +
15330  |                                    CStr(Format(gs||15102  |                                    CStr(Format(gs
15331  |                                    sWord20 & CStr||15103  |                                    sWord20 & CStr
15332  |                                    sWord59 & sWor||15104  |                                    sWord59 & sWor
15333  |                            End If                ||15105  |                            End If                
15334  |                        '平均純資産総額           ||15106  |                        '平均純資産総額           
15335  |                            .Cells(StartLine + Kik||15107  |                            .Cells(StartLine + Kik
15336  |                            .Cells(StartLine + Kik||15108  |                            .Cells(StartLine + Kik
15337  |                            '計算期間の純資産総額 ||15109  |                            '計算期間の純資産総額 
15338  |                            .Cells(StartLine + Kik||15110  |                            .Cells(StartLine + Kik
15339  |                            If gtypOtherComRec(i).||15111  |                            If gtypOtherComRec(i).
15340  |                                .Cells(StartLine +||15112  |                                .Cells(StartLine +
15341  |                            Else                  ||15113  |                            Else                  
15342  |                                .Cells(StartLine +||15114  |                                .Cells(StartLine +
15343  |                            End If                ||15115  |                            End If                
15344  |                            .Cells(StartLine + Kik||15116  |                            .Cells(StartLine + Kik
15345  |                            '計算期間の純資産総額 ||15117  |                            '計算期間の純資産総額 
15346  |                            .Cells(StartLine + Kik||15118  |                            .Cells(StartLine + Kik
15347  |                            'NAV区分が '1' の場合 ||15119  |                            'NAV区分が '1' の場合 
15348  |                            If NavGetFlg = "1" The||15120  |                            If NavGetFlg = "1" The
15349  |                                dblValueIn = gtypO||15121  |                                dblValueIn = gtypO
15350  |                            '日次の場合           ||15122  |                            '日次の場合           
15351  |                            Else                  ||15123  |                            Else                  
15352  |                                dblValueIn = gtypO||15124  |                                dblValueIn = gtypO
15353  |                            End If                ||15125  |                            End If                
15354  |                            If gtypOtherComRec(i).||15126  |                            If gtypOtherComRec(i).
15355  |                                  Call sbGetRoundV||15127  |                                  Call sbGetRoundV
15356  |                            Else                  ||15128  |                            Else                  
15357  |                                  Call sbGetRoundV||15129  |                                  Call sbGetRoundV
15358  |                            End If                ||15130  |                            End If                
15359  |                            '平均NAV(計算対象NAV) ||15131  |                            '平均NAV(計算対象NAV) 
15360  |                            If gtypOtherComRec(i).||15132  |                            If gtypOtherComRec(i).
15361  |                                .Cells(StartLine +||15133  |                                .Cells(StartLine +
15362  |                            Else                  ||15134  |                            Else                  
15363  |                                .Cells(StartLine +||15135  |                                .Cells(StartLine +
15364  |                            End If                ||15136  |                            End If                
15365  |                            '÷??＝ ,文言         ||15137  |                            '÷??＝ ,文言         
15366  |                            'NAV区分が '1' の場合 ||15138  |                            'NAV区分が '1' の場合 
15367  |                            If NavGetFlg = "1" The||15139  |                            If NavGetFlg = "1" The
15368  |                                .Cells(StartLine +||15140  |                                .Cells(StartLine +
15369  |                            '日次の場合           ||15141  |                            '日次の場合           
15370  |                            Else                  ||15142  |                            Else                  
15371  |                                .Cells(StartLine +||15143  |                                .Cells(StartLine +
15372  |                            End If                ||15144  |                            End If                
15373  |                        '年率                     ||15145  |                        '年率                     
15374  |                            .Cells(StartLine + Add||15146  |                            .Cells(StartLine + Add
15375  |                            .Cells(StartLine + Add||15147  |                            .Cells(StartLine + Add
15376  |                            Select Case gbuMGetUPD||15148  |                            Select Case gbuMGetUPD
15377  |                                Case cAud         ||15149  |                                Case cAud         
15378  |                                    .Cells(StartLi||15150  |                                    .Cells(StartLi
15379  |                                        sWord26 & ||15151  |                                        sWord26 & 
15380  |                                        sAud & sWo||15152  |                                        sAud & sWo
15381  |                                Case cCad         ||15153  |                                Case cCad         
15382  |                                    .Cells(StartLi||15154  |                                    .Cells(StartLi
15383  |                                        sWord26 & ||15155  |                                        sWord26 & 
15384  |                                        sCad & sWo||15156  |                                        sCad & sWo
15385  |                                Case cChf         ||15157  |                                Case cChf         
15386  |                                    .Cells(StartLi||15158  |                                    .Cells(StartLi
15387  |                                        sWord26 & ||15159  |                                        sWord26 & 
15388  |                                        sChf & sWo||15160  |                                        sChf & sWo
15389  |                                Case cEur         ||15161  |                                Case cEur         
15390  |                                    .Cells(StartLi||15162  |                                    .Cells(StartLi
15391  |                                        sWord26 & ||15163  |                                        sWord26 & 
15392  |                                        sEur & sWo||15164  |                                        sEur & sWo
15393  |                                Case cGbp         ||15165  |                                Case cGbp         
15394  |                                    .Cells(StartLi||15166  |                                    .Cells(StartLi
15395  |                                        sWord26 & ||15167  |                                        sWord26 & 
15396  |                                        sGbp & sWo||15168  |                                        sGbp & sWo
15397  |                                Case cHkd         ||15169  |                                Case cHkd         
15398  |                                    .Cells(StartLi||15170  |                                    .Cells(StartLi
15399  |                                        sWord26 & ||15171  |                                        sWord26 & 
15400  |                                        sHkd & sWo||15172  |                                        sHkd & sWo
15401  |                                Case cJpy         ||15173  |                                Case cJpy         
15402  |                                    .Cells(StartLi||15174  |                                    .Cells(StartLi
15403  |                                        sWord26 & ||15175  |                                        sWord26 & 
15404  |                                        sYen & sWo||15176  |                                        sYen & sWo
15405  |                                Case cMyr         ||15177  |                                Case cMyr         
15406  |                                    .Cells(StartLi||15178  |                                    .Cells(StartLi
15407  |                                        sWord26 & ||15179  |                                        sWord26 & 
15408  |                                        sMyr & sWo||15180  |                                        sMyr & sWo
15409  |                                Case cNzd         ||15181  |                                Case cNzd         
15410  |                                    .Cells(StartLi||15182  |                                    .Cells(StartLi
15411  |                                        sWord26 & ||15183  |                                        sWord26 & 
15412  |                                        sNzd & sWo||15184  |                                        sNzd & sWo
15413  |                                Case cSek         ||15185  |                                Case cSek         
15414  |                                    .Cells(StartLi||15186  |                                    .Cells(StartLi
15415  |                                        sWord26 & ||15187  |                                        sWord26 & 
15416  |                                        sSek & sWo||15188  |                                        sSek & sWo
15417  |                                Case cSgd         ||15189  |                                Case cSgd         
15418  |                                    .Cells(StartLi||15190  |                                    .Cells(StartLi
15419  |                                        sWord26 & ||15191  |                                        sWord26 & 
15420  |                                        sSgd & sWo||15192  |                                        sSgd & sWo
15421  |                                Case cUsd         ||15193  |                                Case cUsd         
15422  |                                    .Cells(StartLi||15194  |                                    .Cells(StartLi
15423  |                                        sWord26 & ||15195  |                                        sWord26 & 
15424  |                                        sUsd & sWo||15196  |                                        sUsd & sWo
15425  |                                Case cNok         ||15197  |                                Case cNok         
15426  |                                    .Cells(StartLi||15198  |                                    .Cells(StartLi
15427  |                                        sWord26 & ||15199  |                                        sWord26 & 
15428  |                                        sNok & sWo||15200  |                                        sNok & sWo
15429  |                            End Select            ||15201  |                            End Select            
15430  |                            '年率　累積値セット   ||15202  |                            '年率　累積値セット   
15431  |                            TotalRate = CCur(gtypO||15203  |                            TotalRate = CCur(gtypO
15432  |                                                  ||15204  |                                                  
15433  |                            '年率文言の行数をカウ ||15205  |                            '年率文言の行数をカウ 
15434  |                            RateCnt = RateCnt + 2 ||15206  |                            RateCnt = RateCnt + 2 
15435  |                        ElseIf J = UBound(gtypOthe||15207  |                        ElseIf J = UBound(gtypOthe
15436  |                            '年率最終行           ||15208  |                            '年率最終行           
15437  |                            '前半金額部分         ||15209  |                            '前半金額部分         
15438  |                            .Cells(StartLine + Add||15210  |                            .Cells(StartLine + Add
15439  |                            If gbuMGetUPDRec.N(lRe||15211  |                            If gbuMGetUPDRec.N(lRe
15440  |                                .Cells(StartLine +||15212  |                                .Cells(StartLine +
15441  |                            Else                  ||15213  |                            Else                  
15442  |                                .Cells(StartLine +||15214  |                                .Cells(StartLine +
15443  |                            End If                ||15215  |                            End If                
15444  |                            .Cells(StartLine + Add||15216  |                            .Cells(StartLine + Add
15445  |                            '後半の文言           ||15217  |                            '後半の文言           
15446  |                            Select Case gbuMGetUPD||15218  |                            Select Case gbuMGetUPD
15447  |                                Case cAud         ||15219  |                                Case cAud         
15448  |                                    .Cells(StartLi||15220  |                                    .Cells(StartLi
15449  |                                        sAud & sWo||15221  |                                        sAud & sWo
15450  |                                Case cCad         ||15222  |                                Case cCad         
15451  |                                    .Cells(StartLi||15223  |                                    .Cells(StartLi
15452  |                                        sCad & sWo||15224  |                                        sCad & sWo
15453  |                                Case cChf         ||15225  |                                Case cChf         
15454  |                                    .Cells(StartLi||15226  |                                    .Cells(StartLi
15455  |                                        sChf & sWo||15227  |                                        sChf & sWo
15456  |                                Case cEur         ||15228  |                                Case cEur         
15457  |                                    .Cells(StartLi||15229  |                                    .Cells(StartLi
15458  |                                        sEur & sWo||15230  |                                        sEur & sWo
15459  |                                Case cGbp         ||15231  |                                Case cGbp         
15460  |                                    .Cells(StartLi||15232  |                                    .Cells(StartLi
15461  |                                        sGbp & sWo||15233  |                                        sGbp & sWo
15462  |                                Case cHkd         ||15234  |                                Case cHkd         
15463  |                                    .Cells(StartLi||15235  |                                    .Cells(StartLi
15464  |                                        sHkd & sWo||15236  |                                        sHkd & sWo
15465  |                                Case cJpy         ||15237  |                                Case cJpy         
15466  |                                    .Cells(StartLi||15238  |                                    .Cells(StartLi
15467  |                                        sYen & sWo||15239  |                                        sYen & sWo
15468  |                                Case cMyr         ||15240  |                                Case cMyr         
15469  |                                    .Cells(StartLi||15241  |                                    .Cells(StartLi
15470  |                                        sMyr & sWo||15242  |                                        sMyr & sWo
15471  |                                Case cNzd         ||15243  |                                Case cNzd         
15472  |                                    .Cells(StartLi||15244  |                                    .Cells(StartLi
15473  |                                        sNzd & sWo||15245  |                                        sNzd & sWo
15474  |                                Case cSek         ||15246  |                                Case cSek         
15475  |                                    .Cells(StartLi||15247  |                                    .Cells(StartLi
15476  |                                        sSek & sWo||15248  |                                        sSek & sWo
15477  |                                Case cSgd         ||15249  |                                Case cSgd         
15478  |                                    .Cells(StartLi||15250  |                                    .Cells(StartLi
15479  |                                        sSgd & sWo||15251  |                                        sSgd & sWo
15480  |                                Case cUsd         ||15252  |                                Case cUsd         
15481  |                                    .Cells(StartLi||15253  |                                    .Cells(StartLi
15482  |                                        sUsd & sWo||15254  |                                        sUsd & sWo
15483  |                                Case cNok         ||15255  |                                Case cNok         
15484  |                                    .Cells(StartLi||15256  |                                    .Cells(StartLi
15485  |                                        sNok & sWo||15257  |                                        sNok & sWo
15486  |                            End Select            ||15258  |                            End Select            
15487  |                            '年率文言の行数をカウ ||15259  |                            '年率文言の行数をカウ 
15488  |                            RateCnt = RateCnt + 1 ||15260  |                            RateCnt = RateCnt + 1 
15489  |                        Else                      ||15261  |                        Else                      
15490  |                            '年率2行目以降        ||15262  |                            '年率2行目以降        
15491  |                            '前半金額部分         ||15263  |                            '前半金額部分         
15492  |                            .Cells(StartLine + Add||15264  |                            .Cells(StartLine + Add
15493  |                            If gbuMGetUPDRec.N(lRe||15265  |                            If gbuMGetUPDRec.N(lRe
15494  |                                .Cells(StartLine +||15266  |                                .Cells(StartLine +
15495  |                            Else                  ||15267  |                            Else                  
15496  |                                .Cells(StartLine +||15268  |                                .Cells(StartLine +
15497  |                            End If                ||15269  |                            End If                
15498  |                            .Cells(StartLine + Add||15270  |                            .Cells(StartLine + Add
15499  |                            '年率　累積値セット   ||15271  |                            '年率　累積値セット   
15500  |                            TotalRate = TotalRate ||15272  |                            TotalRate = TotalRate 
15501  |                            '後半の文言           ||15273  |                            '後半の文言           
15502  |                            Select Case gbuMGetUPD||15274  |                            Select Case gbuMGetUPD
15503  |                                Case cAud         ||15275  |                                Case cAud         
15504  |                                    .Cells(StartLi||15276  |                                    .Cells(StartLi
15505  |                                        sAud & sWo||15277  |                                        sAud & sWo
15506  |                                        Format(gty||15278  |                                        Format(gty
15507  |                                Case cCad         ||15279  |                                Case cCad         
15508  |                                    .Cells(StartLi||15280  |                                    .Cells(StartLi
15509  |                                        sCad & sWo||15281  |                                        sCad & sWo
15510  |                                        Format(gty||15282  |                                        Format(gty
15511  |                                Case cChf         ||15283  |                                Case cChf         
15512  |                                    .Cells(StartLi||15284  |                                    .Cells(StartLi
15513  |                                        sChf & sWo||15285  |                                        sChf & sWo
15514  |                                        Format(gty||15286  |                                        Format(gty
15515  |                                Case cEur         ||15287  |                                Case cEur         
15516  |                                    .Cells(StartLi||15288  |                                    .Cells(StartLi
15517  |                                        sEur & sWo||15289  |                                        sEur & sWo
15518  |                                        Format(gty||15290  |                                        Format(gty
15519  |                                Case cGbp         ||15291  |                                Case cGbp         
15520  |                                    .Cells(StartLi||15292  |                                    .Cells(StartLi
15521  |                                        sGbp & sWo||15293  |                                        sGbp & sWo
15522  |                                        Format(gty||15294  |                                        Format(gty
15523  |                                Case cHkd         ||15295  |                                Case cHkd         
15524  |                                    .Cells(StartLi||15296  |                                    .Cells(StartLi
15525  |                                        sHkd & sWo||15297  |                                        sHkd & sWo
15526  |                                        Format(gty||15298  |                                        Format(gty
15527  |                                Case cJpy         ||15299  |                                Case cJpy         
15528  |                                    .Cells(StartLi||15300  |                                    .Cells(StartLi
15529  |                                        sYen & sWo||15301  |                                        sYen & sWo
15530  |                                        Format(gty||15302  |                                        Format(gty
15531  |                                Case cMyr         ||15303  |                                Case cMyr         
15532  |                                    .Cells(StartLi||15304  |                                    .Cells(StartLi
15533  |                                        sMyr & sWo||15305  |                                        sMyr & sWo
15534  |                                        Format(gty||15306  |                                        Format(gty
15535  |                                Case cNzd         ||15307  |                                Case cNzd         
15536  |                                    .Cells(StartLi||15308  |                                    .Cells(StartLi
15537  |                                        sNzd & sWo||15309  |                                        sNzd & sWo
15538  |                                        Format(gty||15310  |                                        Format(gty
15539  |                                Case cSek         ||15311  |                                Case cSek         
15540  |                                    .Cells(StartLi||15312  |                                    .Cells(StartLi
15541  |                                        sSek & sWo||15313  |                                        sSek & sWo
15542  |                                        Format(gty||15314  |                                        Format(gty
15543  |                                Case cSgd         ||15315  |                                Case cSgd         
15544  |                                    .Cells(StartLi||15316  |                                    .Cells(StartLi
15545  |                                        sSgd & sWo||15317  |                                        sSgd & sWo
15546  |                                        Format(gty||15318  |                                        Format(gty
15547  |                                Case cUsd         ||15319  |                                Case cUsd         
15548  |                                    .Cells(StartLi||15320  |                                    .Cells(StartLi
15549  |                                        sUsd & sWo||15321  |                                        sUsd & sWo
15550  |                                        Format(gty||15322  |                                        Format(gty
15551  |                                Case cNok         ||15323  |                                Case cNok         
15552  |                                    .Cells(StartLi||15324  |                                    .Cells(StartLi
15553  |                                        sNok & sWo||15325  |                                        sNok & sWo
15554  |                                        Format(gty||15326  |                                        Format(gty
15555  |                            End Select            ||15327  |                            End Select            
15556  |                            '年率文言の行数をカウ ||15328  |                            '年率文言の行数をカウ 
15557  |                            RateCnt = RateCnt + 1 ||15329  |                            RateCnt = RateCnt + 1 
15558  |                        End If                    ||15330  |                        End If                    
15559  |                    Next J                        ||15331  |                    Next J                        
15560  |                    '年率文言の行数にスペース行を ||15332  |                    '年率文言の行数にスペース行を 
15561  |                    RateCnt = RateCnt + DivideLine||15333  |                    RateCnt = RateCnt + DivideLine
15562  |                                                  ||15334  |                                                  
15563  |                    '次料率の行数を取得する       ||15335  |                    '次料率の行数を取得する       
15564  |                    '配列の要素の最大値までを取得 ||15336  |                    '配列の要素の最大値までを取得 
15565  |                    If i < UBound(gtypOtherComRec)||15337  |                    If i < UBound(gtypOtherComRec)
15566  |                        For Idx_i = i + 1 To i + 1||15338  |                        For Idx_i = i + 1 To i + 1
15567  |                            For Idx_j = LBound(gty||15339  |                            For Idx_j = LBound(gty
15568  |                                '料率の数を積算   ||15340  |                                '料率の数を積算   
15569  |                                AddRateCnt = AddRa||15341  |                                AddRateCnt = AddRa
15570  |                            Next Idx_j            ||15342  |                            Next Idx_j            
15571  |                            AddRateCnt = AddLine  ||15343  |                            AddRateCnt = AddLine  
15572  |                        Next Idx_i                ||15344  |                        Next Idx_i                
15573  |                    End If                        ||15345  |                    End If                        
15574  |                                                  ||15346  |                                                  
15575  |                    '行数を計算する               ||15347  |                    '行数を計算する               
15576  |                    GenPage = RateCnt + AddRateCnt||15348  |                    GenPage = RateCnt + AddRateCnt
15577  |                                                  ||15349  |                                                  
15578  |                    AddRateCnt = 0                ||15350  |                    AddRateCnt = 0                
15579  |                                                  ||15351  |                                                  
15580  |                    '行数が溢れたら改ページ       ||15352  |                    '行数が溢れたら改ページ       
15581  |                    If conSheetLastLine < GenPage ||15353  |                    If conSheetLastLine < GenPage 
15582  |                        'ループの開始ポジション変 ||15354  |                        'ループの開始ポジション変 
15583  |                        SetPoint = Add_i          ||15355  |                        SetPoint = Add_i          
15584  |                        Exit For                  ||15356  |                        Exit For                  
15585  |                    End If                        ||15357  |                    End If                        
15586  |                    '次の開始行をセット           ||15358  |                    '次の開始行をセット           
15587  |                    RateCnt = RateCnt + 1         ||15359  |                    RateCnt = RateCnt + 1         
15588  |                    StartLine = RateCnt           ||15360  |                    StartLine = RateCnt           
15589  |                Next i                            ||15361  |                Next i                            
15590  |            End If                                ||15362  |            End If                                
15591  |                                                  ||15363  |                                                  
15592  |        End With                                  ||15364  |        End With                                  
15593  |        'A4印刷用に上2行を削除して、プレビュー範囲||15365  |        'A4印刷用に上2行を削除して、プレビュー範囲
15594  |        xlSheet.Rows("1:2").Delete Shift:=xlUp    ||15366  |        xlSheet.Rows("1:2").Delete Shift:=xlUp    
15595  |    Next PgIndx                                   ||15367  |    Next PgIndx                                   
15596  |End Sub                                           ||15368  |End Sub                                           
15597  |                                                  ||15369  |                                                  
15598  |'=================================================||15370  |'=================================================
15599  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelOut_ChangeRate      ||15371  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelOut_ChangeRate      
15600  |'機能            :   確認書のExcel出力(料率変更有 ||15372  |'機能            :   確認書のExcel出力(料率変更有 
15601  |'                                                 ||15373  |'                                                 
15602  |'日付               担当　              修正内容  ||15374  |'日付               担当　              修正内容  
15603  |'-------------------------------------------------||15375  |'-------------------------------------------------
15604  |'2006/08/02         K.Furuya <SRA>     期中料率変 ||15376  |'2006/08/02         K.Furuya <SRA>     期中料率変 
15605  |'                                      fnblExcelOu||15377  |'                                      fnblExcelOu
15606  |'2008/02/20         K.Furuya <SRA>     時価総額基 ||15378  |'2008/02/20         K.Furuya <SRA>     時価総額基 
15607  |'2008/03/26         K.Furuya<SRA>      ファンド決 ||15379  |'2008/03/26         K.Furuya<SRA>      ファンド決 
15608 L|'2014/02/19         M.Takada   <SRA>   【管理会計 ||       |                                                  
15609  |'=================================================||15380  |'=================================================
15610  |Private Function fnblExcelOut_ChangeRate( _       ||15381  |Private Function fnblExcelOut_ChangeRate( _       
15611  |    ByVal lRecIdx As Long _                       ||15382  |    ByVal lRecIdx As Long _                       
15612  |) As Boolean                                      ||15383  |) As Boolean                                      
15613  |                                                  ||15384  |                                                  
15614  |                                                  ||15385  |                                                  
15615  |    Dim dStart      As Date     '計算期間　開始日 ||15386  |    Dim dStart      As Date     '計算期間　開始日 
15616  |    Dim dEnd        As Date     '計算期間　終了日 ||15387  |    Dim dEnd        As Date     '計算期間　終了日 
15617  |    Dim sSql        As String                     ||15388  |    Dim sSql        As String                     
15618  |    Dim sCurrencyCode As String '通貨コード(SQL文 ||15389  |    Dim sCurrencyCode As String '通貨コード(SQL文 
15619  |    Dim AccCode     As String   '口座コード(SQL文 ||15390  |    Dim AccCode     As String   '口座コード(SQL文 
15620  |    Dim sDate       As Date     '支払予定日       ||15391  |    Dim sDate       As Date     '支払予定日       
15621  |    Dim sName       As String   '担当者名         ||15392  |    Dim sName       As String   '担当者名         
15622  |    Dim i           As Integer  'カウンター       ||15393  |    Dim i           As Integer  'カウンター       
15623  |    Dim ColNum      As Integer  '部署名コンボボッ ||15394  |    Dim ColNum      As Integer  '部署名コンボボッ 
15624  |    Dim ColWord     As String   '部署名コンボボッ ||15395  |    Dim ColWord     As String   '部署名コンボボッ 
15625  |    Dim iSyouhizei  As Long     '消費税           ||15396  |    Dim iSyouhizei  As Long     '消費税           
15626  |    Dim iRowCnt     As Long     '月末純資産データ ||15397  |    Dim iRowCnt     As Long     '月末純資産データ 
15627  |    Dim TotalNav    As Currency '累積NAV          ||15398  |    Dim TotalNav    As Currency '累積NAV          
15628  |    Dim TotalRate   As Currency '累積閾値         ||15399  |    Dim TotalRate   As Currency '累積閾値         
15629  |    Dim cRate       As Currency '料率             ||15400  |    Dim cRate       As Currency '料率             
15630  |    Dim WorkRate    As Currency '一つ前の累積閾値 ||15401  |    Dim WorkRate    As Currency '一つ前の累積閾値 
15631  |    Dim TotalCom    As Currency '累積投資顧問料   ||15402  |    Dim TotalCom    As Currency '累積投資顧問料   
15632  |    Dim lTaxNum     As Currency '消費税値         ||15403  |    Dim lTaxNum     As Currency '消費税値         
15633  |    Dim lMonthlyPayCom As Currency  '月別支払額   ||15404  |    Dim lMonthlyPayCom As Currency  '月別支払額   
15634  |    Dim lCalcNav    As Currency '計算対象NAV      ||15405  |    Dim lCalcNav    As Currency '計算対象NAV      
15635  |    Dim iCalcNum    As Integer  '計算期間日数     ||15406  |    Dim iCalcNum    As Integer  '計算期間日数     
15636  |    'Excel の Application 変数とエラーをトラップす||15407  |    'Excel の Application 変数とエラーをトラップす
15637  |    Dim iTries      As Integer                    ||15408  |    Dim iTries      As Integer                    
15638  |    Dim strErrCall      As String 'エラー呼出元   ||15409  |    Dim strErrCall      As String 'エラー呼出元   
15639  |    Const conMeModule   As String = "fnblExcelOut_||15410  |    Const conMeModule   As String = "fnblExcelOut_
15640  |    'Excel の Worksheet 削除用カウンタ変数        ||15411  |    'Excel の Worksheet 削除用カウンタ変数        
15641  |    Dim Ws_Cnt      As Integer                    ||15412  |    Dim Ws_Cnt      As Integer                    
15642  |    Dim Ws_Del_Cnt  As Integer                    ||15413  |    Dim Ws_Del_Cnt  As Integer                    
15643  |    Dim Ws_Del_Cnt2 As Integer                    ||15414  |    Dim Ws_Del_Cnt2 As Integer                    
15644  |    Dim ContNo      As String   '契約番号(SQL文作 ||15415  |    Dim ContNo      As String   '契約番号(SQL文作 
15645  |    Dim NavGetCnt   As Long                       ||15416  |    Dim NavGetCnt   As Long                       
15646  |    Dim sGetAccCode As String                     ||15417  |    Dim sGetAccCode As String                     
15647  |    Dim Mnav_Flg    As String                     ||15418  |    Dim Mnav_Flg    As String                     
15648  |    Dim sStart As String            '計算対象　開 ||15419  |    Dim sStart As String            '計算対象　開 
15649  |    Dim sEnd As String              '計算対象　終 ||15420  |    Dim sEnd As String              '計算対象　終 
15650  |    Dim dstrBasedate As String      '基準日用ワー ||15421  |    Dim dstrBasedate As String      '基準日用ワー 
15651  |    Dim dstrCaldate() As String     'カレンダー日 ||15422  |    Dim dstrCaldate() As String     'カレンダー日 
15652  |    Dim ddblDailynav() As Double    '日次NAV用格納||15423  |    Dim ddblDailynav() As Double    '日次NAV用格納
15653  |    Dim dlngCnt As Long             '計算対象期間 ||15424  |    Dim dlngCnt As Long             '計算対象期間 
15654  |    Dim dstrCaldate2 As String      'カレンダー日 ||15425  |    Dim dstrCaldate2 As String      'カレンダー日 
15655  |    Dim dstrBasedate2 As String     '基準日(/編集)||15426  |    Dim dstrBasedate2 As String     '基準日(/編集)
15656  |    Dim dlngDiffdate As Long        'カレンダー日 ||15427  |    Dim dlngDiffdate As Long        'カレンダー日 
15657  |    Dim dintFor As Integer          'For文用変数  ||15428  |    Dim dintFor As Integer          'For文用変数  
15658  |    Dim ddblTtalnav As Double       '日次NAV累積用||15429  |    Dim ddblTtalnav As Double       '日次NAV累積用
15659  |    Dim dstrAvgNav As String                      ||15430  |    Dim dstrAvgNav As String                      
15660  |    Dim ddblNearNav As Double                     ||15431  |    Dim ddblNearNav As Double                     
15661  |    Dim dstrAccCd() As String                     ||15432  |    Dim dstrAccCd() As String                     
15662  |    Dim dstrBsCCd() As String                     ||15433  |    Dim dstrBsCCd() As String                     
15663  |    Dim intRtn      As Integer                    ||15434  |    Dim intRtn      As Integer                    
15664  |    Dim dstrDate         As String                ||15435  |    Dim dstrDate         As String                
15665  |    Dim dstrCurrencyCode As String                ||15436  |    Dim dstrCurrencyCode As String                
15666  |    Dim ddblExchangeRate As Double                ||15437  |    Dim ddblExchangeRate As Double                
15667  |    Dim dintPage    As Integer                    ||15438  |    Dim dintPage    As Integer                    
15668  |    Dim dintPageIni As Integer                    ||15439  |    Dim dintPageIni As Integer                    
15669  |    Dim dintAmari   As Integer                    ||15440  |    Dim dintAmari   As Integer                    
15670  |    Dim dCalDate    As Date                       ||15441  |    Dim dCalDate    As Date                       
15671  |    Dim J           As Integer                    ||15442  |    Dim J           As Integer                    
15672  |    Dim K           As Integer                    ||15443  |    Dim K           As Integer                    
15673  |    Dim L           As Integer                    ||15444  |    Dim L           As Integer                    
15674  |    Dim AvgNav      As Currency                   ||15445  |    Dim AvgNav      As Currency                   
15675  |    Dim dintFor2    As Integer                    ||15446  |    Dim dintFor2    As Integer                    
15676  |    Dim dlngMeisyoSu As Integer                   ||15447  |    Dim dlngMeisyoSu As Integer                   
15677  |    Dim dlngCntsv As Long                         ||15448  |    Dim dlngCntsv As Long                         
15678  |                                                  ||15449  |                                                  
15679  |    '2006/04/12 START K.Furuya 実払管理テーブル更 ||15450  |    '2006/04/12 START K.Furuya 実払管理テーブル更 
15680  |    Dim WkContractNo        As String             ||15451  |    Dim WkContractNo        As String             
15681  |    Dim WkCurCode           As String             ||15452  |    Dim WkCurCode           As String             
15682  |    Dim WkSettlementDate    As String             ||15453  |    Dim WkSettlementDate    As String             
15683  |    Dim WkFixComC           As String             ||15454  |    Dim WkFixComC           As String             
15684  |    Dim WkFixComJ           As String             ||15455  |    Dim WkFixComJ           As String             
15685  |    Dim WkRealComC          As String             ||15456  |    Dim WkRealComC          As String             
15686  |    Dim WkRealComJ          As String             ||15457  |    Dim WkRealComJ          As String             
15687  |    '2006/04/12 END   K.Furuya 実払管理テーブル更 ||15458  |    '2006/04/12 END   K.Furuya 実払管理テーブル更 
15688  |    Dim RuleNoCnt                   As Integer  ' ||15459  |    Dim RuleNoCnt                   As Integer  ' 
15689  |    Dim KityuFlg                    As Boolean  ' ||15460  |    Dim KityuFlg                    As Boolean  ' 
15690  |    Dim ddblNearBabyMotherRate      As Double   ' ||15461  |    Dim ddblNearBabyMotherRate      As Double   ' 
15691  |    Dim MonthlyCnt                  As Long       ||15462  |    Dim MonthlyCnt                  As Long       
15692  |    Dim dblNavTotal                 As Double   ' ||15463  |    Dim dblNavTotal                 As Double   ' 
15693  |    Dim intRange                    As Integer  ' ||15464  |    Dim intRange                    As Integer  ' 
15694  |    Dim strRange                    As String   ' ||15465  |    Dim strRange                    As String   ' 
15695  |    Dim EndFlg                      As Boolean  ' ||15466  |    Dim EndFlg                      As Boolean  ' 
15696  |    Dim SetPoint                    As Integer    ||15467  |    Dim SetPoint                    As Integer    
15697  |    Dim AddPoint                    As Integer    ||15468  |    Dim AddPoint                    As Integer    
15698  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||15469  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
15699  |    Dim WkStart                     As String   ' ||15470  |    Dim WkStart                     As String   ' 
15700  |    Dim StartFlg                    As String   ' ||15471  |    Dim StartFlg                    As String   ' 
15701  |                                                  ||15472  |                                                  
15702  |    '戻り値初期化                                 ||15473  |    '戻り値初期化                                 
15703  |    fnblExcelOut_ChangeRate = False               ||15474  |    fnblExcelOut_ChangeRate = False               
15704  |    i = 0                                         ||15475  |    i = 0                                         
15705  |                                                  ||15476  |                                                  
15706  |On Error Resume Next                              ||15477  |On Error Resume Next                              
15707  |                                                  ||15478  |                                                  
15708  |    'Excelフォーマットを調整                      ||15479  |    'Excelフォーマットを調整                      
15709  |    xlSheet.Cells.ColumnWidth = 1                 ||15480  |    xlSheet.Cells.ColumnWidth = 1                 
15710  |    xlSheet.Cells.Font.Size = 11                  ||15481  |    xlSheet.Cells.Font.Size = 11                  
15711  |                                                  ||15482  |                                                  
15712  |    'シート名を設定(確認書**)                     ||15483  |    'シート名を設定(確認書**)                     
15713  |    '契約毎のシート番号を付番する                 ||15484  |    '契約毎のシート番号を付番する                 
15714  |    'xlBook.Sheets(gProcessCnt).Name = sWord33 & (||15485  |    'xlBook.Sheets(gProcessCnt).Name = sWord33 & (
15715  |    xlBook.Sheets(gProcessCnt).Name = sWord33 & gT||15486  |    xlBook.Sheets(gProcessCnt).Name = sWord33 & gT
15716  |                                                  ||15487  |                                                  
15717  |    'シートの余白を設定                           ||15488  |    'シートの余白を設定                           
15718  |    xlSheet.PageSetup.TopMargin = Application.Inch||15489  |    xlSheet.PageSetup.TopMargin = Application.Inch
15719  |    xlSheet.PageSetup.BottomMargin = Application.I||15490  |    xlSheet.PageSetup.BottomMargin = Application.I
15720  |    xlSheet.PageSetup.LeftMargin = Application.Inc||15491  |    xlSheet.PageSetup.LeftMargin = Application.Inc
15721  |    xlSheet.PageSetup.RightMargin = Application.In||15492  |    xlSheet.PageSetup.RightMargin = Application.In
15722  |                                                  ||15493  |                                                  
15723  |    '総計の出力処理カウンターアップ               ||15494  |    '総計の出力処理カウンターアップ               
15724  |    gTotalProcessCnt = gTotalProcessCnt + 1       ||15495  |    gTotalProcessCnt = gTotalProcessCnt + 1       
15725  |                                                  ||15496  |                                                  
15726  |    DoEvents                                      ||15497  |    DoEvents                                      
15727  |    With xlSheet                                  ||15498  |    With xlSheet                                  
15728  |        '題目                                     ||15499  |        '題目                                     
15729  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||15500  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
15730  |            Case Mid(mstrContractFlag(1), 1, 1)   ||15501  |            Case Mid(mstrContractFlag(1), 1, 1)   
15731  |                .Cells(5, 1).Value = sWord0a      ||15502  |                .Cells(5, 1).Value = sWord0a      
15732  |            Case Mid(mstrContractFlag(2), 1, 1)   ||15503  |            Case Mid(mstrContractFlag(2), 1, 1)   
15733  |                .Cells(5, 1).Value = sWord0b      ||15504  |                .Cells(5, 1).Value = sWord0b      
15734  |            Case Mid(mstrContractFlag(3), 1, 1)   ||15505  |            Case Mid(mstrContractFlag(3), 1, 1)   
15735  |                .Cells(5, 1).Value = sWord0c      ||15506  |                .Cells(5, 1).Value = sWord0c      
15736  |            Case Else                             ||15507  |            Case Else                             
15737  |                MsgBox "契約区分が不正です。", vbC||15508  |                MsgBox "契約区分が不正です。", vbC
15738  |        End Select                                ||15509  |        End Select                                
15739  |        'フォントサイズ                           ||15510  |        'フォントサイズ                           
15740  |        .Cells(5, 1).Font.Size = 14               ||15511  |        .Cells(5, 1).Font.Size = 14               
15741  |        'フォント位置                             ||15512  |        'フォント位置                             
15742  |        .Range("A5:BG5").HorizontalAlignment = xlC||15513  |        .Range("A5:BG5").HorizontalAlignment = xlC
15743  |        '出力日付文字                             ||15514  |        '出力日付文字                             
15744  |        If RTrim(txtSysOutDate.Text) = "" Then    ||15515  |        If RTrim(txtSysOutDate.Text) = "" Then    
15745  |            .Cells(3, 50).Value = sWord34         ||15516  |            .Cells(3, 50).Value = sWord34         
15746  |            .Cells(3, 50).HorizontalAlignment = xl||15517  |            .Cells(3, 50).HorizontalAlignment = xl
15747  |        Else                                      ||15518  |        Else                                      
15748  |            .Cells(3, 43).Value = CStr(Format(txtS||15519  |            .Cells(3, 43).Value = CStr(Format(txtS
15749  |        End If                                    ||15520  |        End If                                    
15750  |        '財務部　担当者                           ||15521  |        '財務部　担当者                           
15751  |        sName = RTrim(txtInputName.Text)          ||15522  |        sName = RTrim(txtInputName.Text)          
15752  |        '財務部                                   ||15523  |        '財務部                                   
15753  |        .Cells(7, 37).Value = sWord1              ||15524  |        .Cells(7, 37).Value = sWord1              
15754  |        .Cells(8, 39).Value = sWord2 & sName      ||15525  |        .Cells(8, 39).Value = sWord2 & sName      
15755  |        '下記のとおり･･･ ,文言                    ||15526  |        '下記のとおり･･･ ,文言                    
15756  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||15527  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
15757  |            Case Mid(mstrContractFlag(1), 1, 1)   ||15528  |            Case Mid(mstrContractFlag(1), 1, 1)   
15758  |                .Cells(10, 2).Value = sWord3a     ||15529  |                .Cells(10, 2).Value = sWord3a     
15759  |            Case Mid(mstrContractFlag(2), 1, 1)   ||15530  |            Case Mid(mstrContractFlag(2), 1, 1)   
15760  |                .Cells(10, 2).Value = sWord3b     ||15531  |                .Cells(10, 2).Value = sWord3b     
15761  |            Case Mid(mstrContractFlag(3), 1, 1)   ||15532  |            Case Mid(mstrContractFlag(3), 1, 1)   
15762  |                .Cells(10, 2).Value = sWord3c     ||15533  |                .Cells(10, 2).Value = sWord3c     
15763  |            Case Else                             ||15534  |            Case Else                             
15764  |        End Select                                ||15535  |        End Select                                
15765  |        'ファンド名: ,文言                        ||15536  |        'ファンド名: ,文言                        
15766  |        .Cells(12, 2).Value = sWord4              ||15537  |        .Cells(12, 2).Value = sWord4              
15767  |        .Cells(12, 11).Value = sWord19            ||15538  |        .Cells(12, 11).Value = sWord19            
15768  |        .Cells(12, 13).Value = gbuMGetUPDRec.N(lRe||15539  |        .Cells(12, 13).Value = gbuMGetUPDRec.N(lRe
15769  |        'ファンドコード: ,文言                    ||15540  |        'ファンドコード: ,文言                    
15770  |        .Cells(13, 2).Value = sWord4_2            ||15541  |        .Cells(13, 2).Value = sWord4_2            
15771  |        .Cells(13, 11).Value = sWord19            ||15542  |        .Cells(13, 11).Value = sWord19            
15772  |        .Cells(13, 13).NumberFormatLocal = "@"    ||15543  |        .Cells(13, 13).NumberFormatLocal = "@"    
15773  |        '契約番号                                 ||15544  |        '契約番号                                 
15774  |        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_con||15545  |        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_con
15775  |                                                  ||15546  |                                                  
15776  |        'RAFI対応 START                           ||15547  |        'RAFI対応 START                           
15777  |        'NAV取得SQL                               ||15548  |        'NAV取得SQL                               
15778  |        '外部委託顧問料ルールの資産種類によって取 ||15549  |        '外部委託顧問料ルールの資産種類によって取 
15779  |        '純資産                                   ||15550  |        '純資産                                   
15780  |        If msAssetFlg = "0" Then                  ||15551  |        If msAssetFlg = "0" Then                  
15781  |            sSql = gstrEditSQLcfr_NavGetForSelectL||15552  |            sSql = gstrEditSQLcfr_NavGetForSelectL
15782  |        'マザー組入資産                           ||15553  |        'マザー組入資産                           
15783  |        Else                                      ||15554  |        Else                                      
15784  |            sSql = gstrEditSQLcfr_MotherAccGetForS||15555  |            sSql = gstrEditSQLcfr_MotherAccGetForS
15785  |        End If                                    ||15556  |        End If                                    
15786  |                                                  ||15557  |                                                  
15787  |        'ﾀﾞｲﾅｾｯﾄの作成                            ||15558  |        'ﾀﾞｲﾅｾｯﾄの作成                            
15788  |        If gintDyCreate(sSql) = False Then        ||15559  |        If gintDyCreate(sSql) = False Then        
15789  |            Exit Function                         ||15560  |            Exit Function                         
15790  |        End If                                    ||15561  |        End If                                    
15791  |                                                  ||15562  |                                                  
15792  |        '2006/04/12 START K.Furuya 実払管理テーブ ||15563  |        '2006/04/12 START K.Furuya 実払管理テーブ 
15793  |        '契約番号を取得                           ||15564  |        '契約番号を取得                           
15794  |        WkContractNo = ""                         ||15565  |        WkContractNo = ""                         
15795  |        WkContractNo = ContNo                     ||15566  |        WkContractNo = ContNo                     
15796  |        '2006/04/12 END   K.Furuya 実払管理テーブ ||15567  |        '2006/04/12 END   K.Furuya 実払管理テーブ 
15797  |                                                  ||15568  |                                                  
15798  |        Do Until gblnDyEOF()                      ||15569  |        Do Until gblnDyEOF()                      
15799  |            '動的配列更新                         ||15570  |            '動的配列更新                         
15800  |            ReDim Preserve gtypcfr_navget_tbl(0 To||15571  |            ReDim Preserve gtypcfr_navget_tbl(0 To
15801  |            ReDim Preserve dstrAccCd(0 To NavGetCn||15572  |            ReDim Preserve dstrAccCd(0 To NavGetCn
15802  |            'NAV取得抽出                          ||15573  |            'NAV取得抽出                          
15803  |            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT_||15574  |            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT_
15804  |            If NavGetCnt > 0 Then                 ||15575  |            If NavGetCnt > 0 Then                 
15805  |                sGetAccCode = sGetAccCode & " , " ||15576  |                sGetAccCode = sGetAccCode & " , " 
15806  |            Else                                  ||15577  |            Else                                  
15807  |                sGetAccCode = sGetAccCode & gtypcf||15578  |                sGetAccCode = sGetAccCode & gtypcf
15808  |            End If                                ||15579  |            End If                                
15809  |            '口座コードの格納(１契約複数口座の場合||15580  |            '口座コードの格納(１契約複数口座の場合
15810  |            dstrAccCd(NavGetCnt) = gtypcfr_navget_||15581  |            dstrAccCd(NavGetCnt) = gtypcfr_navget_
15811  |            NavGetCnt = NavGetCnt + 1             ||15582  |            NavGetCnt = NavGetCnt + 1             
15812  |            'マザー組入資産の場合ベビーファンドコ ||15583  |            'マザー組入資産の場合ベビーファンドコ 
15813  |            If msAssetFlg = "1" Then              ||15584  |            If msAssetFlg = "1" Then              
15814  |                msBabyAccountCode = ""            ||15585  |                msBabyAccountCode = ""            
15815  |                msBabyAccountCode = Trim(gvlnDyDat||15586  |                msBabyAccountCode = Trim(gvlnDyDat
15816  |            End If                                ||15587  |            End If                                
15817  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     ||15588  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     
15818  |            Call gDyNext                          ||15589  |            Call gDyNext                          
15819  |        Loop                                      ||15590  |        Loop                                      
15820  |        'RAFI対応 END                             ||15591  |        'RAFI対応 END                             
15821  |                                                  ||15592  |                                                  
15822  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         ||15593  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         
15823  |        Call gblnDyClose                          ||15594  |        Call gblnDyClose                          
15824  |                                                  ||15595  |                                                  
15825  |        '１契約複数口座の場合に口座のベース通貨に ||15596  |        '１契約複数口座の場合に口座のベース通貨に 
15826  |        ReDim dstrBsCCd(0 To NavGetCnt - 1)       ||15597  |        ReDim dstrBsCCd(0 To NavGetCnt - 1)       
15827  |        If NavGetCnt - 1 > 0 Then                 ||15598  |        If NavGetCnt - 1 > 0 Then                 
15828  |            For dintFor = 0 To NavGetCnt - 1      ||15599  |            For dintFor = 0 To NavGetCnt - 1      
15829  |                sSql = ""                         ||15600  |                sSql = ""                         
15830  |                sSql = sSql & "SELECT ACCOUNT_CODE||15601  |                sSql = sSql & "SELECT ACCOUNT_CODE
15831  |                sSql = sSql & "WHERE ACCOUNT_CODE ||15602  |                sSql = sSql & "WHERE ACCOUNT_CODE 
15832  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||15603  |                'ﾀﾞｲﾅｾｯﾄの作成                    
15833  |                If gintDyCreate(sSql) = False Then||15604  |                If gintDyCreate(sSql) = False Then
15834  |                    Exit Function                 ||15605  |                    Exit Function                 
15835  |                Else                              ||15606  |                Else                              
15836  |                    dstrBsCCd(dintFor) = gvlnDyDat||15607  |                    dstrBsCCd(dintFor) = gvlnDyDat
15837  |                End If                            ||15608  |                End If                            
15838  |                If dintFor > 0 Then               ||15609  |                If dintFor > 0 Then               
15839  |                    If dstrBsCCd(dintFor) <> dstrB||15610  |                    If dstrBsCCd(dintFor) <> dstrB
15840  |                        intRtn = MsgBox("ファンド ||15611  |                        intRtn = MsgBox("ファンド 
15841  |                        Exit Function             ||15612  |                        Exit Function             
15842  |                    End If                        ||15613  |                    End If                        
15843  |                End If                            ||15614  |                End If                            
15844  |            Next dintFor                          ||15615  |            Next dintFor                          
15845  |                                                  ||15616  |                                                  
15846  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||15617  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
15847  |            Call gblnDyClose                      ||15618  |            Call gblnDyClose                      
15848  |                                                  ||15619  |                                                  
15849  |        End If                                    ||15620  |        End If                                    
15850  |                                                  ||15621  |                                                  
15851  |        '口座コードをセルに配置                   ||15622  |        '口座コードをセルに配置                   
15852  |        'RAFI対応 START                           ||15623  |        'RAFI対応 START                           
15853  |        '純資産の場合                             ||15624  |        '純資産の場合                             
15854  |        If msAssetFlg = "0" Then                  ||15625  |        If msAssetFlg = "0" Then                  
15855  |            .Cells(13, 13).Value = sGetAccCode    ||15626  |            .Cells(13, 13).Value = sGetAccCode    
15856  |        'マザー組入資産の場合                     ||15627  |        'マザー組入資産の場合                     
15857  |        Else                                      ||15628  |        Else                                      
15858  |            .Cells(13, 13).Value = msBabyAccountCo||15629  |            .Cells(13, 13).Value = msBabyAccountCo
15859  |        End If                                    ||15630  |        End If                                    
15860  |        'RAFI対応 END                             ||15631  |        'RAFI対応 END                             
15861  |        '計算期間: ,文言                          ||15632  |        '計算期間: ,文言                          
15862  |        .Cells(15, 2).Value = sWord5              ||15633  |        .Cells(15, 2).Value = sWord5              
15863  |        .Cells(15, 11).Value = sWord19            ||15634  |        .Cells(15, 11).Value = sWord19            
15864  |        '前回締日・直近締日セット                 ||15635  |        '前回締日・直近締日セット                 
15865  |        dStart = CDate(gstrDateFormat(mstrSettleme||15636  |        dStart = CDate(gstrDateFormat(mstrSettleme
15866  |        dEnd = CDate(gstrDateFormat(mstrNearSettle||15637  |        dEnd = CDate(gstrDateFormat(mstrNearSettle
15867  |        dstrDate = Replace(CStr(dEnd), "/", "")   ||15638  |        dstrDate = Replace(CStr(dEnd), "/", "")   
15868  |                                                  ||15639  |                                                  
15869  |        '2006/04/12 START K.Furuya 実払管理テーブ ||15640  |        '2006/04/12 START K.Furuya 実払管理テーブ 
15870  |        '締日を取得                               ||15641  |        '締日を取得                               
15871  |        WkSettlementDate = ""                     ||15642  |        WkSettlementDate = ""                     
15872  |        WkSettlementDate = dstrDate               ||15643  |        WkSettlementDate = dstrDate               
15873  |        '2006/04/12 END   K.Furuya 実払管理テーブ ||15644  |        '2006/04/12 END   K.Furuya 実払管理テーブ 
15874  |                                                  ||15645  |                                                  
15875  |        '前回締日から直近締日の(日数 +1)を取得    ||15646  |        '前回締日から直近締日の(日数 +1)を取得    
15876  |        iCalcNum = DateDiff("d", dStart, dEnd) + 1||15647  |        iCalcNum = DateDiff("d", dStart, dEnd) + 1
15877  |                                                  ||15648  |                                                  
15878  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||15649  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
15879  |        WkStart = Replace(CStr(dStart), "/", "")  ||15650  |        WkStart = Replace(CStr(dStart), "/", "")  
15880  |                                                  ||15651  |                                                  
15881  |        '期中料率変更対象契約                     ||15652  |        '期中料率変更対象契約                     
15882  |        '外部委託顧問料率を定義体配列にセット     ||15653  |        '外部委託顧問料率を定義体配列にセット     
15883  |        If fnSetOtherComRate(gbuMGetUPDRec.N(lRecI||15654  |        If fnSetOtherComRate(gbuMGetUPDRec.N(lRecI
15884  |                             msAssetFlg, msBabyAcc||15655  |                             msAssetFlg, msBabyAcc
15885  |                             gbuMGetUPDRec.N(lRecI||15656  |                             gbuMGetUPDRec.N(lRecI
15886  |                             conDBasset_type_codeA||15657  |                             conDBasset_type_codeA
15887  |                             WkStart, _           ||15658  |                             WkStart, _           
15888  |                             "1") = False Then    ||15659  |                             "1") = False Then    
15889  |            Exit Function                         ||15660  |            Exit Function                         
15890  |        End If                                    ||15661  |        End If                                    
15891  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||15662  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
15892  |                                                  ||15663  |                                                  
15893  |        '純資産総額: ,文言                        ||15664  |        '純資産総額: ,文言                        
15894  |        .Cells(17, 2).Value = sWord50             ||15665  |        .Cells(17, 2).Value = sWord50             
15895  |        .Cells(17, 11).Value = sWord19            ||15666  |        .Cells(17, 11).Value = sWord19            
15896  |                                                  ||15667  |                                                  
15897  |        '月末純資産: ,文言                        ||15668  |        '月末純資産: ,文言                        
15898  |        .Cells(19, 2).Value = sWord6              ||15669  |        .Cells(19, 2).Value = sWord6              
15899  |        .Cells(19, 11).Value = sWord19            ||15670  |        .Cells(19, 11).Value = sWord19            
15900  |                                                  ||15671  |                                                  
15901  |        '純資産 ,表中の文言                       ||15672  |        '純資産 ,表中の文言                       
15902  |        .Cells(19, 26).Value = sWord8             ||15673  |        .Cells(19, 26).Value = sWord8             
15903  |        .Range("Z19:AN19").HorizontalAlignment = x||15674  |        .Range("Z19:AN19").HorizontalAlignment = x
15904  |'2005/03/09 Start @@@@@ 合計行を出力しないならここ||15675  |'2005/03/09 Start @@@@@ 合計行を出力しないならここ
15905  |'        '合計(純資産) ,表中の文言                ||15676  |'        '合計(純資産) ,表中の文言                
15906  |'        .Cells(33, 14).Value = sWord9            ||15677  |'        .Cells(33, 14).Value = sWord9            
15907  |'        .Range("N33:Y33").HorizontalAlignment = x||15678  |'        .Range("N33:Y33").HorizontalAlignment = x
15908  |'2005/03/09 End @@@@@ 合計行を出力しないならここを||15679  |'2005/03/09 End @@@@@ 合計行を出力しないならここを
15909  |'2006/08/11 START K.Furuya 期中料率変更対象契約対 ||15680  |'2006/08/11 START K.Furuya 期中料率変更対象契約対 
15910  |        '総合計(純資産) ,表中の文言               ||15681  |        '総合計(純資産) ,表中の文言               
15911  |        .Cells(40, 14).Value = sWord58            ||15682  |        .Cells(40, 14).Value = sWord58            
15912  |        .Range("N40:Y40").HorizontalAlignment = xl||15683  |        .Range("N40:Y40").HorizontalAlignment = xl
15913  |'2006/08/11 END   K.Furuya 期中料率変更対象契約対 ||15684  |'2006/08/11 END   K.Furuya 期中料率変更対象契約対 
15914  |        '日付 ,表中の文言                         ||15685  |        '日付 ,表中の文言                         
15915  |        .Cells(19, 14).Value = sWord7             ||15686  |        .Cells(19, 14).Value = sWord7             
15916  |        .Range("N19:Y19").HorizontalAlignment = xl||15687  |        .Range("N19:Y19").HorizontalAlignment = xl
15917  |                                                  ||15688  |                                                  
15918  |        iRowCnt = 0                               ||15689  |        iRowCnt = 0                               
15919  |        TotalNav = 0                              ||15690  |        TotalNav = 0                              
15920  |        Mnav_Flg = 0                              ||15691  |        Mnav_Flg = 0                              
15921  |                                                  ||15692  |                                                  
15922  |'契約区分を判断する                               ||15693  |'契約区分を判断する                               
15923  |'        '契約区分「1」or「2」or (「3」and 取得NAV||15694  |'        '契約区分「1」or「2」or (「3」and 取得NAV
15924  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||15695  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
15925  |            Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c||15696  |            Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c
15926  |            Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_||15697  |            Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_
15927  |            And gbuMGetUPDRec.N(lRecIdx).MGET_nav_||15698  |            And gbuMGetUPDRec.N(lRecIdx).MGET_nav_
15928  |'取得NAV区分[1]                                   ||15699  |'取得NAV区分[1]                                   
15929  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g||15700  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g
15930  |                '月次NAVを取得する                ||15701  |                '月次NAVを取得する                
15931  |                Call sbMonthlyNAV_GetChangeRate(lR||15702  |                Call sbMonthlyNAV_GetChangeRate(lR
15932  |                'カウンターを初期化               ||15703  |                'カウンターを初期化               
15933  |                K = 0                             ||15704  |                K = 0                             
15934  |                                                  ||15705  |                                                  
15935  |                '月次NAV表を作成する              ||15706  |                '月次NAV表を作成する              
15936  |                For i = LBound(gtypOtherComRec) To||15707  |                For i = LBound(gtypOtherComRec) To
15937  |                    For J = LBound(gtypOtherComRec||15708  |                    For J = LBound(gtypOtherComRec
15938  |                        '日付                     ||15709  |                        '日付                     
15939  |                        .Cells(20 + K, 15).Value =||15710  |                        .Cells(20 + K, 15).Value =
15940  |                        '純資産                   ||15711  |                        '純資産                   
15941  |                        .Cells(20 + K, 39).NumberF||15712  |                        .Cells(20 + K, 39).NumberF
15942  |                        If gtypOtherComRec(i).APPL||15713  |                        If gtypOtherComRec(i).APPL
15943  |                            .Cells(20 + K, 39).Val||15714  |                            .Cells(20 + K, 39).Val
15944  |                                CStr(Format(gtypOt||15715  |                                CStr(Format(gtypOt
15945  |                        Else                      ||15716  |                        Else                      
15946  |                            .Cells(20 + K, 39).Val||15717  |                            .Cells(20 + K, 39).Val
15947  |                                CStr(Format(gtypOt||15718  |                                CStr(Format(gtypOt
15948  |                        End If                    ||15719  |                        End If                    
15949  |                        .Cells(20 + K, 39).Horizon||15720  |                        .Cells(20 + K, 39).Horizon
15950  |                                                  ||15721  |                                                  
15951  |                        K = K + 1                 ||15722  |                        K = K + 1                 
15952  |                    Next J                        ||15723  |                    Next J                        
15953  |                    '純資産総額を算出する         ||15724  |                    '純資産総額を算出する         
15954  |                    TotalNav = TotalNav + gtypOthe||15725  |                    TotalNav = TotalNav + gtypOthe
15955  |                    '合計(純資産) ,表中の文言     ||15726  |                    '合計(純資産) ,表中の文言     
15956  |'                    .Cells(20 + k, 14).Value = sW||15727  |'                    .Cells(20 + k, 14).Value = sW
15957  |                    .Cells(20 + K, 15).Value = sWo||15728  |                    .Cells(20 + K, 15).Value = sWo
15958  |                    '合計(金額)                   ||15729  |                    '合計(金額)                   
15959  |                    .Cells(20 + K, 39).NumberForma||15730  |                    .Cells(20 + K, 39).NumberForma
15960  |                    If gtypOtherComRec(i).APPLY_BA||15731  |                    If gtypOtherComRec(i).APPLY_BA
15961  |                        .Cells(20 + K, 39).Value =||15732  |                        .Cells(20 + K, 39).Value =
15962  |                            CStr(Format(gtypOtherC||15733  |                            CStr(Format(gtypOtherC
15963  |                    Else                          ||15734  |                    Else                          
15964  |                        .Cells(20 + K, 39).Value =||15735  |                        .Cells(20 + K, 39).Value =
15965  |                            CStr(Format(gtypOtherC||15736  |                            CStr(Format(gtypOtherC
15966  |                    End If                        ||15737  |                    End If                        
15967  |                    .Cells(20 + K, 39).HorizontalA||15738  |                    .Cells(20 + K, 39).HorizontalA
15968  |                    K = K + 1                     ||15739  |                    K = K + 1                     
15969  |                    '平均NAV ,表中の文言          ||15740  |                    '平均NAV ,表中の文言          
15970  |'                    .Cells(20 + k, 14).Value = sW||15741  |'                    .Cells(20 + k, 14).Value = sW
15971  |                    .Cells(20 + K, 15).Value = sWo||15742  |                    .Cells(20 + K, 15).Value = sWo
15972  |                    '平均NAV(金額)                ||15743  |                    '平均NAV(金額)                
15973  |                    .Cells(20 + K, 39).NumberForma||15744  |                    .Cells(20 + K, 39).NumberForma
15974  |                    If gtypOtherComRec(i).APPLY_BA||15745  |                    If gtypOtherComRec(i).APPLY_BA
15975  |                        .Cells(20 + K, 39).Value =||15746  |                        .Cells(20 + K, 39).Value =
15976  |                            CStr(Format(gtypOtherC||15747  |                            CStr(Format(gtypOtherC
15977  |                    Else                          ||15748  |                    Else                          
15978  |                        .Cells(20 + K, 39).Value =||15749  |                        .Cells(20 + K, 39).Value =
15979  |                            CStr(Format(gtypOtherC||15750  |                            CStr(Format(gtypOtherC
15980  |                    End If                        ||15751  |                    End If                        
15981  |                    .Cells(20 + K, 39).HorizontalA||15752  |                    .Cells(20 + K, 39).HorizontalA
15982  |                                                  ||15753  |                                                  
15983  |                    K = K + 1                     ||15754  |                    K = K + 1                     
15984  |                Next i                            ||15755  |                Next i                            
15985  |                '総合計(月末純資産)               ||15756  |                '総合計(月末純資産)               
15986  |                '合計行を出力しないならここをコメ ||15757  |                '合計行を出力しないならここをコメ 
15987  |                .Cells(40, 39).NumberFormatLocal =||15758  |                .Cells(40, 39).NumberFormatLocal =
15988  |                .Cells(17, 23).NumberFormatLocal =||15759  |                .Cells(17, 23).NumberFormatLocal =
15989  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||15760  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
15990  |                    '合計行を出力しないならここを ||15761  |                    '合計行を出力しないならここを 
15991  |                    .Cells(40, 39).Value = CStr(Fo||15762  |                    .Cells(40, 39).Value = CStr(Fo
15992  |                    .Cells(17, 23).Value = CStr(Fo||15763  |                    .Cells(17, 23).Value = CStr(Fo
15993  |                Else                              ||15764  |                Else                              
15994  |                    '合計行を出力しないならここを ||15765  |                    '合計行を出力しないならここを 
15995  |                    .Cells(40, 39).Value = CStr(Fo||15766  |                    .Cells(40, 39).Value = CStr(Fo
15996  |                    .Cells(17, 23).Value = CStr(Fo||15767  |                    .Cells(17, 23).Value = CStr(Fo
15997  |                End If                            ||15768  |                End If                            
15998  |                '合計行を出力しないならここをコメ ||15769  |                '合計行を出力しないならここをコメ 
15999  |                .Cells(40, 39).HorizontalAlignment||15770  |                .Cells(40, 39).HorizontalAlignment
16000  |                .Cells(17, 23).HorizontalAlignment||15771  |                .Cells(17, 23).HorizontalAlignment
16001  |                                                  ||15772  |                                                  
16002  |                '平均純資産総額                   ||15773  |                '平均純資産総額                   
16003  |                .Cells(42, 2).Value = sWord51     ||15774  |                .Cells(42, 2).Value = sWord51     
16004  |                .Cells(42, 11).Value = sWord19    ||15775  |                .Cells(42, 11).Value = sWord19    
16005  |                '平均純資産総額は別紙に記載       ||15776  |                '平均純資産総額は別紙に記載       
16006  |                '.Cells(39, 13).Value = sWord54   ||15777  |                '.Cells(39, 13).Value = sWord54   
16007  |                .Cells(42, 13).Value = sWord54    ||15778  |                .Cells(42, 13).Value = sWord54    
16008  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||15779  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
16009  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_n||15780  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_n
16010  |            '=====================================||15781  |            '=====================================
16011  |            '==                                   ||15782  |            '==                                   
16012  |            '==  '4':日次時価総額平均(休日込)の計 ||15783  |            '==  '4':日次時価総額平均(休日込)の計 
16013  |            '==                                   ||15784  |            '==                                   
16014  |            '=====================================||15785  |            '=====================================
16015  |                ddblTtalnav = 0                   ||15786  |                ddblTtalnav = 0                   
16016  |                For dintFor = 0 To NavGetCnt - 1  ||15787  |                For dintFor = 0 To NavGetCnt - 1  
16017  |                                                  ||15788  |                                                  
16018  |                    '日次時価総額平均取得         ||15789  |                    '日次時価総額平均取得         
16019  |                    sStart = gstrDateFormat2(CStr(||15790  |                    sStart = gstrDateFormat2(CStr(
16020  |                    sEnd = gstrDateFormat2(CStr(dE||15791  |                    sEnd = gstrDateFormat2(CStr(dE
16021  |                                                  ||15792  |                                                  
16022  |'2008/03/03 START '計算開始日と外部委託顧問料計算 ||15793  |'2008/03/03 START '計算開始日と外部委託顧問料計算 
16023  |                    '等しい場合                   ||15794  |                    '等しい場合                   
16024  |                    If sStart = gbuMGetUPDRec.N(lR||15795  |                    If sStart = gbuMGetUPDRec.N(lR
16025  |                        StartFlg = "1"            ||15796  |                        StartFlg = "1"            
16026  |                    Else                          ||15797  |                    Else                          
16027  |                        StartFlg = "0"            ||15798  |                        StartFlg = "0"            
16028  |                    End If                        ||15799  |                    End If                        
16029  |'2008/03/03 END   '計算開始日と外部委託顧問料計算 ||15800  |'2008/03/03 END   '計算開始日と外部委託顧問料計算 
16030  |                                                  ||15801  |                                                  
16031  |                                                  ||15802  |                                                  
16032  |                    '計算開始日と外部委託顧問料計 ||15803  |                    '計算開始日と外部委託顧問料計 
16033  |                    If sStart = gbuMGetUPDRec.N(lR||15804  |                    If sStart = gbuMGetUPDRec.N(lR
16034  |                        '== SQL1 ==               ||15805  |                        '== SQL1 ==               
16035  |                        sSql = ""                 ||15806  |                        sSql = ""                 
16036  |                        sSql = sSql & "SELECT EIGY||15807  |                        sSql = sSql & "SELECT EIGY
16037  |                                                  ||15808  |                                                  
16038  |                        'ﾀﾞｲﾅｾｯﾄの作成            ||15809  |                        'ﾀﾞｲﾅｾｯﾄの作成            
16039  |                        If gintDyCreate(sSql) = Fa||15810  |                        If gintDyCreate(sSql) = Fa
16040  |                            Exit Function         ||15811  |                            Exit Function         
16041  |                        Else                      ||15812  |                        Else                      
16042  |                            '計算開始日が休日の場 ||15813  |                            '計算開始日が休日の場 
16043  |                            If gvlnDyDataS("EIGYO_||15814  |                            If gvlnDyDataS("EIGYO_
16044  |                                '翌営業日の時価総 ||15815  |                                '翌営業日の時価総 
16045  |                                '== SQL2 ==       ||15816  |                                '== SQL2 ==       
16046  |                                sSql = ""         ||15817  |                                sSql = ""         
16047  |                                sSql = sSql & "SEL||15818  |                                sSql = sSql & "SEL
16048  |                                sSql = sSql & "FRO||15819  |                                sSql = sSql & "FRO
16049  |                                sSql = sSql & "(SE||15820  |                                sSql = sSql & "(SE
16050  |                                sSql = sSql & "WHE||15821  |                                sSql = sSql & "WHE
16051  |                                                  ||15822  |                                                  
16052  |                                'ﾀﾞｲﾅｾｯﾄの作成    ||15823  |                                'ﾀﾞｲﾅｾｯﾄの作成    
16053  |                                If gintDyCreate(sS||15824  |                                If gintDyCreate(sS
16054  |                                    Exit Function ||15825  |                                    Exit Function 
16055  |                                Else              ||15826  |                                Else              
16056  |                                    ddblNearNav = ||15827  |                                    ddblNearNav = 
16057  |'2008/03/06 START 時価総額基準の外部委託顧問料対応||15828  |'2008/03/06 START 時価総額基準の外部委託顧問料対応
16058  |'                                    '翌営業日の計||15829  |'                                    '翌営業日の計
16059  |'                                    '== SQL3 ==  ||15830  |'                                    '== SQL3 ==  
16060  |'                                    sSql = ""    ||15831  |'                                    sSql = ""    
16061  |'                                    sSql = sSql &||15832  |'                                    sSql = sSql &
16062  |'                                    sSql = sSql &||15833  |'                                    sSql = sSql &
16063  |'                                    sSql = sSql &||15834  |'                                    sSql = sSql &
16064  |'                                    sSql = sSql &||15835  |'                                    sSql = sSql &
16065  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||15836  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
16066  |'                                    If gintDyCrea||15837  |'                                    If gintDyCrea
16067  |'                                        Exit Func||15838  |'                                        Exit Func
16068  |'                                    Else         ||15839  |'                                    Else         
16069  |'                                        '計算開始||15840  |'                                        '計算開始
16070  |'                                        sStart = ||15841  |'                                        sStart = 
16071  |'                                        dStart = ||15842  |'                                        dStart = 
16072  |'                                        .Cells(15||15843  |'                                        .Cells(15
16073  |'                                            CStr(||15844  |'                                            CStr(
16074  |'                                        iCalcNum ||15845  |'                                        iCalcNum 
16075  |'                                    End If       ||15846  |'                                    End If       
16076  |'2008/03/06 END   時価総額基準の外部委託顧問料対応||15847  |'2008/03/06 END   時価総額基準の外部委託顧問料対応
16077  |                                                  ||15848  |                                                  
16078  |                                    'SQL文の作成( ||15849  |                                    'SQL文の作成( 
16079  |                                    '計算期間の開 ||15850  |                                    '計算期間の開 
16080  |                                    sSql = gstrEdi||15851  |                                    sSql = gstrEdi
16081  |                                        ContNo, sS||15852  |                                        ContNo, sS
16082  |                                                  ||15853  |                                                  
16083  |                                     'ﾀﾞｲﾅｾｯﾄの作 ||15854  |                                     'ﾀﾞｲﾅｾｯﾄの作 
16084  |                                    If gintDyCreat||15855  |                                    If gintDyCreat
16085  |                                        Exit Funct||15856  |                                        Exit Funct
16086  |                                    End If        ||15857  |                                    End If        
16087  |                                    '配列初期化   ||15858  |                                    '配列初期化   
16088  |                                    ReDim gbuOther||15859  |                                    ReDim gbuOther
16089  |                                    MonthlyCnt = 0||15860  |                                    MonthlyCnt = 0
16090  |                                    'EOF判定処理  ||15861  |                                    'EOF判定処理  
16091  |                                    Do Until gblnD||15862  |                                    Do Until gblnD
16092  |                                        '対象デー ||15863  |                                        '対象デー 
16093  |                                        Call sbOth||15864  |                                        Call sbOth
16094  |                                        MonthlyCnt||15865  |                                        MonthlyCnt
16095  |                                        'ﾀﾞｲﾅｾｯﾄ次||15866  |                                        'ﾀﾞｲﾅｾｯﾄ次
16096  |                                        Call gDyNe||15867  |                                        Call gDyNe
16097  |                                    Loop          ||15868  |                                    Loop          
16098  |                                                  ||15869  |                                                  
16099  |                                    '期中料率変更 ||15870  |                                    '期中料率変更 
16100  |                                    Erase gtypOthe||15871  |                                    Erase gtypOthe
16101  |                                                  ||15872  |                                                  
16102  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||15873  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
16103  |                                    '期中料率変更 ||15874  |                                    '期中料率変更 
16104  |                                    '外部委託顧問 ||15875  |                                    '外部委託顧問 
16105  |                                    If fnSetOtherC||15876  |                                    If fnSetOtherC
16106  |                                                  ||15877  |                                                  
16107  |                                                  ||15878  |                                                  
16108  |                                                  ||15879  |                                                  
16109  |                                                  ||15880  |                                                  
16110  |                                                  ||15881  |                                                  
16111  |                                        Exit Funct||15882  |                                        Exit Funct
16112  |                                    End If        ||15883  |                                    End If        
16113  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||15884  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
16114  |                                                  ||15885  |                                                  
16115  |                                End If            ||15886  |                                End If            
16116  |                                'RAFI対応 START   ||15887  |                                'RAFI対応 START   
16117  |                                '翌営業日のマザー ||15888  |                                '翌営業日のマザー 
16118  |                                If msAssetFlg = "1||15889  |                                If msAssetFlg = "1
16119  |                                    '== SQL4 ==   ||15890  |                                    '== SQL4 ==   
16120  |                                    sSql = ""     ||15891  |                                    sSql = ""     
16121  |                                    sSql = sSql & ||15892  |                                    sSql = sSql & 
16122  |                                    sSql = sSql & ||15893  |                                    sSql = sSql & 
16123  |                                    sSql = sSql & ||15894  |                                    sSql = sSql & 
16124  |                                    sSql = sSql & ||15895  |                                    sSql = sSql & 
16125  |                                    sSql = sSql & ||15896  |                                    sSql = sSql & 
16126  |                                    sSql = sSql & ||15897  |                                    sSql = sSql & 
16127  |                                    sSql = sSql & ||15898  |                                    sSql = sSql & 
16128  |                                    sSql = sSql & ||15899  |                                    sSql = sSql & 
16129  |                                    sSql = sSql & ||15900  |                                    sSql = sSql & 
16130  |                                    sSql = sSql & ||15901  |                                    sSql = sSql & 
16131  |                                    sSql = sSql & ||15902  |                                    sSql = sSql & 
16132  |                                    sSql = sSql & ||15903  |                                    sSql = sSql & 
16133  |                                    sSql = sSql & ||15904  |                                    sSql = sSql & 
16134  |                                    sSql = sSql & ||15905  |                                    sSql = sSql & 
16135  |                                    sSql = sSql & ||15906  |                                    sSql = sSql & 
16136  |                                    sSql = sSql & ||15907  |                                    sSql = sSql & 
16137  |                                    sSql = sSql & ||15908  |                                    sSql = sSql & 
16138  |                                    sSql = sSql & ||15909  |                                    sSql = sSql & 
16139  |                                    sSql = sSql & ||15910  |                                    sSql = sSql & 
16140  |                                    sSql = sSql & ||15911  |                                    sSql = sSql & 
16141  |                                    sSql = sSql & ||15912  |                                    sSql = sSql & 
16142  |                                    sSql = sSql & ||15913  |                                    sSql = sSql & 
16143  |                                    sSql = sSql & ||15914  |                                    sSql = sSql & 
16144  |                                    sSql = sSql & ||15915  |                                    sSql = sSql & 
16145  |                                    'ﾀﾞｲﾅｾｯﾄの作成||15916  |                                    'ﾀﾞｲﾅｾｯﾄの作成
16146  |                                                  ||15917  |                                                  
16147  |                                    If gintDyCreat||15918  |                                    If gintDyCreat
16148  |                                        Exit Funct||15919  |                                        Exit Funct
16149  |                                    Else          ||15920  |                                    Else          
16150  |                                        ddblNearBa||15921  |                                        ddblNearBa
16151  |                                    End If        ||15922  |                                    End If        
16152  |                                End If            ||15923  |                                End If            
16153  |                                'RAFI対応 END     ||15924  |                                'RAFI対応 END     
16154  |                            End If                ||15925  |                            End If                
16155  |                        End If                    ||15926  |                        End If                    
16156  |                    End If                        ||15927  |                    End If                        
16157  |                    '計算開始日から計算終了日まで ||15928  |                    '計算開始日から計算終了日まで 
16158  |                    '== SQL5 ==                   ||15929  |                    '== SQL5 ==                   
16159  |                    sSql = ""                     ||15930  |                    sSql = ""                     
16160  |                    sSql = sSql & "SELECT CAL_YYYY||15931  |                    sSql = sSql & "SELECT CAL_YYYY
16161  |                    sSql = sSql & "WHERE CAL_YYYY ||15932  |                    sSql = sSql & "WHERE CAL_YYYY 
16162  |                                                  ||15933  |                                                  
16163  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||15934  |                    'ﾀﾞｲﾅｾｯﾄの作成                
16164  |                    If gintDyCreate(sSql) = False ||15935  |                    If gintDyCreate(sSql) = False 
16165  |                        Exit Function             ||15936  |                        Exit Function             
16166  |                    End If                        ||15937  |                    End If                        
16167  |                                                  ||15938  |                                                  
16168  |                    If dlngCnt = 0 Then           ||15939  |                    If dlngCnt = 0 Then           
16169  |                        ReDim dstrCaldate(gbxOraDy||15940  |                        ReDim dstrCaldate(gbxOraDy
16170  |                        ReDim ddblDailynav(gbxOraD||15941  |                        ReDim ddblDailynav(gbxOraD
16171  |                    End If                        ||15942  |                    End If                        
16172  |                                                  ||15943  |                                                  
16173  |                    'EOF判定処理                  ||15944  |                    'EOF判定処理                  
16174  |                    dlngCnt = 0                   ||15945  |                    dlngCnt = 0                   
16175  |                                                  ||15946  |                                                  
16176  |                    Do Until gblnDyEOF()          ||15947  |                    Do Until gblnDyEOF()          
16177  |                        dlngCnt = dlngCnt + 1     ||15948  |                        dlngCnt = dlngCnt + 1     
16178  |                        '抽出データセット         ||15949  |                        '抽出データセット         
16179  |                        dstrCaldate(dlngCnt) = gvl||15950  |                        dstrCaldate(dlngCnt) = gvl
16180  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||15951  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
16181  |                        Call gDyNext              ||15952  |                        Call gDyNext              
16182  |                    Loop                          ||15953  |                    Loop                          
16183  |                                                  ||15954  |                                                  
16184  |                                                  ||15955  |                                                  
16185  |                    '2005/08/26　START            ||15956  |                    '2005/08/26　START            
16186  |                    '変数sStartに格納されている日 ||15957  |                    '変数sStartに格納されている日 
16187  |                    '変数sStartの直近の営業日の日 ||15958  |                    '変数sStartの直近の営業日の日 
16188  |                    '（変数sStartに格納されている ||15959  |                    '（変数sStartに格納されている 
16189  |                    '　直近日付が存在しない場合は ||15960  |                    '　直近日付が存在しない場合は 
16190  |                                                  ||15961  |                                                  
16191  |                    '計算開始日の日次時価総額基準 ||15962  |                    '計算開始日の日次時価総額基準 
16192  |                    '== SQL6 ==                   ||15963  |                    '== SQL6 ==                   
16193  |                    sSql = ""                     ||15964  |                    sSql = ""                     
16194  |                    sSql = sSql & "SELECT MAX(BASE||15965  |                    sSql = sSql & "SELECT MAX(BASE
16195  |                    sSql = sSql & "FROM   CFR_DAIL||15966  |                    sSql = sSql & "FROM   CFR_DAIL
16196  |                    sSql = sSql & "WHERE  BASE_DAT||15967  |                    sSql = sSql & "WHERE  BASE_DAT
16197  |                    sSql = sSql & "AND    ACCOUNT_||15968  |                    sSql = sSql & "AND    ACCOUNT_
16198  |                                                  ||15969  |                                                  
16199  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||15970  |                    'ﾀﾞｲﾅｾｯﾄの作成                
16200  |                    If gintDyCreate(sSql) = False ||15971  |                    If gintDyCreate(sSql) = False 
16201  |                        Exit Function             ||15972  |                        Exit Function             
16202  |                    End If                        ||15973  |                    End If                        
16203  |                                                  ||15974  |                                                  
16204  |                    Do Until gblnDyEOF()          ||15975  |                    Do Until gblnDyEOF()          
16205  |                       '抽出データセット          ||15976  |                       '抽出データセット          
16206  |                        sStart = gvlnDyDataS("BASE||15977  |                        sStart = gvlnDyDataS("BASE
16207  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||15978  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
16208  |                        Call gDyNext              ||15979  |                        Call gDyNext              
16209  |                    Loop                          ||15980  |                    Loop                          
16210  |                                                  ||15981  |                                                  
16211  |                    'SQL文の作成(外部委託顧問料率 ||15982  |                    'SQL文の作成(外部委託顧問料率 
16212  |                    '計算期間の開始日と終了日に含 ||15983  |                    '計算期間の開始日と終了日に含 
16213  |                    sSql = gstrEditSQLcfr_OtherCom||15984  |                    sSql = gstrEditSQLcfr_OtherCom
16214  |                        ContNo, sStart, mstrNearSe||15985  |                        ContNo, sStart, mstrNearSe
16215  |                                                  ||15986  |                                                  
16216  |                     'ﾀﾞｲﾅｾｯﾄの作成               ||15987  |                     'ﾀﾞｲﾅｾｯﾄの作成               
16217  |                    If gintDyCreate(sSql) = False ||15988  |                    If gintDyCreate(sSql) = False 
16218  |                        Exit Function             ||15989  |                        Exit Function             
16219  |                    End If                        ||15990  |                    End If                        
16220  |                    '配列初期化                   ||15991  |                    '配列初期化                   
16221  |                    ReDim gbuOtherComRateGetUPDRec||15992  |                    ReDim gbuOtherComRateGetUPDRec
16222  |                    MonthlyCnt = 0                ||15993  |                    MonthlyCnt = 0                
16223  |                    'EOF判定処理                  ||15994  |                    'EOF判定処理                  
16224  |                    Do Until gblnDyEOF()          ||15995  |                    Do Until gblnDyEOF()          
16225  |                        '対象データ抽出           ||15996  |                        '対象データ抽出           
16226  |                        Call sbOtherComDataGet(Mon||15997  |                        Call sbOtherComDataGet(Mon
16227  |                        MonthlyCnt = MonthlyCnt + ||15998  |                        MonthlyCnt = MonthlyCnt + 
16228  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||15999  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
16229  |                        Call gDyNext              ||16000  |                        Call gDyNext              
16230  |                    Loop                          ||16001  |                    Loop                          
16231  |                                                  ||16002  |                                                  
16232  |                    '期中料率変更用配列のクリア   ||16003  |                    '期中料率変更用配列のクリア   
16233  |                    Erase gtypOtherComRec         ||16004  |                    Erase gtypOtherComRec         
16234  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||16005  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
16235  |                    '期中料率変更対象契約         ||16006  |                    '期中料率変更対象契約         
16236  |                    '外部委託顧問料率を定義体配列 ||16007  |                    '外部委託顧問料率を定義体配列 
16237  |                    If fnSetOtherComRate(gbuMGetUP||16008  |                    If fnSetOtherComRate(gbuMGetUP
16238  |                                         msAssetFl||16009  |                                         msAssetFl
16239  |                                         gbuMGetUP||16010  |                                         gbuMGetUP
16240  |                                         conDBasse||16011  |                                         conDBasse
16241  |                                         sStart, _||16012  |                                         sStart, _
16242  |                                         StartFlg)||16013  |                                         StartFlg)
16243  |                        Exit Function             ||16014  |                        Exit Function             
16244  |                    End If                        ||16015  |                    End If                        
16245  | '2008/03/03 END   時価総額基準の外部委託顧問料対 ||16016  | '2008/03/03 END   時価総額基準の外部委託顧問料対 
16246  |                                                  ||16017  |                                                  
16247  |                    'RAFI対応 START               ||16018  |                    'RAFI対応 START               
16248  |                    '純資産の場合                 ||16019  |                    '純資産の場合                 
16249  |                    If msAssetFlg = "0" Then      ||16020  |                    If msAssetFlg = "0" Then      
16250  |                        '計算開始日から計算終了日 ||16021  |                        '計算開始日から計算終了日 
16251  |                        '== SQL 7 ==              ||16022  |                        '== SQL 7 ==              
16252  |                        sSql = ""                 ||16023  |                        sSql = ""                 
16253  |                        sSql = sSql & "SELECT ACCO||16024  |                        sSql = sSql & "SELECT ACCO
16254  |                        sSql = sSql & "WHERE CFR_D||16025  |                        sSql = sSql & "WHERE CFR_D
16255  |                        sSql = sSql & "AND   (CFR_||16026  |                        sSql = sSql & "AND   (CFR_
16256  |                        sSql = sSql & "ORDER BY CF||16027  |                        sSql = sSql & "ORDER BY CF
16257  |                    'マザー組入資産の場合         ||16028  |                    'マザー組入資産の場合         
16258  |                    Else                          ||16029  |                    Else                          
16259  |                        '計算開始日から計算終了日 ||16030  |                        '計算開始日から計算終了日 
16260  |                        '== SQL8 ==               ||16031  |                        '== SQL8 ==               
16261  |                        sSql = ""                 ||16032  |                        sSql = ""                 
16262  |                        sSql = sSql & "SELECT"    ||16033  |                        sSql = sSql & "SELECT"    
16263  |                        sSql = sSql & "    a.ACCOU||16034  |                        sSql = sSql & "    a.ACCOU
16264  |                        sSql = sSql & "    a.BASE_||16035  |                        sSql = sSql & "    a.BASE_
16265  |                        sSql = sSql & "    a.MARKE||16036  |                        sSql = sSql & "    a.MARKE
16266  |                        sSql = sSql & "    b.BABY_||16037  |                        sSql = sSql & "    b.BABY_
16267  |                        sSql = sSql & "    b.BABY_||16038  |                        sSql = sSql & "    b.BABY_
16268  |                        sSql = sSql & " FROM"     ||16039  |                        sSql = sSql & " FROM"     
16269  |                        sSql = sSql & "    CFR_DAI||16040  |                        sSql = sSql & "    CFR_DAI
16270  |                        sSql = sSql & " WHERE"    ||16041  |                        sSql = sSql & " WHERE"    
16271  |                        sSql = sSql & "    b.BABY_||16042  |                        sSql = sSql & "    b.BABY_
16272  |                        sSql = sSql & "    b.MOTHE||16043  |                        sSql = sSql & "    b.MOTHE
16273  |                        sSql = sSql & "    b.BASE_||16044  |                        sSql = sSql & "    b.BASE_
16274  |                        sSql = sSql & "    a.ACCOU||16045  |                        sSql = sSql & "    a.ACCOU
16275  |                        sSql = sSql & "    (a.BASE||16046  |                        sSql = sSql & "    (a.BASE
16276  |                        sSql = sSql & "    a.BASE_||16047  |                        sSql = sSql & "    a.BASE_
16277  |                        sSql = sSql & " ORDER BY" ||16048  |                        sSql = sSql & " ORDER BY" 
16278  |                        sSql = sSql & "    a.BASE_||16049  |                        sSql = sSql & "    a.BASE_
16279  |                    End If                        ||16050  |                    End If                        
16280  |                    'RAFI対応 END                 ||16051  |                    'RAFI対応 END                 
16281  |                                                  ||16052  |                                                  
16282  |                    If gintDyCreate(sSql) = False ||16053  |                    If gintDyCreate(sSql) = False 
16283  |                        Exit Function             ||16054  |                        Exit Function             
16284  |                    End If                        ||16055  |                    End If                        
16285  |                                                  ||16056  |                                                  
16286  |                    dlngCntsv = dlngCnt           ||16057  |                    dlngCntsv = dlngCnt           
16287  |                    dlngCnt = 0                   ||16058  |                    dlngCnt = 0                   
16288  |                                                  ||16059  |                                                  
16289  |                    Do Until gblnDyEOF()          ||16060  |                    Do Until gblnDyEOF()          
16290  |                        dlngCnt = dlngCnt + 1     ||16061  |                        dlngCnt = dlngCnt + 1     
16291  |                        '抽出データセット         ||16062  |                        '抽出データセット         
16292  |                        dstrBasedate = gvlnDyDataS||16063  |                        dstrBasedate = gvlnDyDataS
16293  |                        If Mid(dstrCaldate(dlngCnt||16064  |                        If Mid(dstrCaldate(dlngCnt
16294  |                            'RAFI対応 START       ||16065  |                            'RAFI対応 START       
16295  |                            '純資産の場合         ||16066  |                            '純資産の場合         
16296  |                            If msAssetFlg = "0" Th||16067  |                            If msAssetFlg = "0" Th
16297  |                                ddblDailynav(dlngC||16068  |                                ddblDailynav(dlngC
16298  |                            'マザー組入資産の場合 ||16069  |                            'マザー組入資産の場合 
16299  |                            Else                  ||16070  |                            Else                  
16300  |                                ddblDailynav(dlngC||16071  |                                ddblDailynav(dlngC
16301  |                            End If                ||16072  |                            End If                
16302  |                            'RAFI対応 END         ||16073  |                            'RAFI対応 END         
16303  |                        Else                      ||16074  |                        Else                      
16304  |                            '計算開始日が外部委託 ||16075  |                            '計算開始日が外部委託 
16305  |                            If ddblNearNav <> 0 An||16076  |                            If ddblNearNav <> 0 An
16306  |                                dstrCaldate2 = Mid||16077  |                                dstrCaldate2 = Mid
16307  |                                dstrBasedate2 = Mi||16078  |                                dstrBasedate2 = Mi
16308  |                                dlngDiffdate = Dat||16079  |                                dlngDiffdate = Dat
16309  |                                                  ||16080  |                                                  
16310  |                                For dintFor2 = 1 T||16081  |                                For dintFor2 = 1 T
16311  |                                    'RAFI対応 STAR||16082  |                                    'RAFI対応 STAR
16312  |                                    '純資産の場合 ||16083  |                                    '純資産の場合 
16313  |                                    If msAssetFlg ||16084  |                                    If msAssetFlg 
16314  |                                        ddblDailyn||16085  |                                        ddblDailyn
16315  |                                    'マザー組入資 ||16086  |                                    'マザー組入資 
16316  |                                    Else          ||16087  |                                    Else          
16317  |                                        ddblDailyn||16088  |                                        ddblDailyn
16318  |                                    End If        ||16089  |                                    End If        
16319  |                                    'RAFI対応 END ||16090  |                                    'RAFI対応 END 
16320  |                                    dlngCnt = dlng||16091  |                                    dlngCnt = dlng
16321  |                                Next dintFor2     ||16092  |                                Next dintFor2     
16322  |                                'RAFI対応 START   ||16093  |                                'RAFI対応 START   
16323  |                                '純資産の場合     ||16094  |                                '純資産の場合     
16324  |                                If msAssetFlg = "0||16095  |                                If msAssetFlg = "0
16325  |                                    ddblDailynav(d||16096  |                                    ddblDailynav(d
16326  |                                'マザー組入資産の ||16097  |                                'マザー組入資産の 
16327  |                                Else              ||16098  |                                Else              
16328  |                                    ddblDailynav(d||16099  |                                    ddblDailynav(d
16329  |                                End If            ||16100  |                                End If            
16330  |                                'RAFI対応 END     ||16101  |                                'RAFI対応 END     
16331  |                            Else                  ||16102  |                            Else                  
16332  |                                '日次時価総額にデ ||16103  |                                '日次時価総額にデ 
16333  |                                dstrCaldate2 = Mid||16104  |                                dstrCaldate2 = Mid
16334  |                                dstrBasedate2 = Mi||16105  |                                dstrBasedate2 = Mi
16335  |                                dlngDiffdate = Dat||16106  |                                dlngDiffdate = Dat
16336  |                                                  ||16107  |                                                  
16337  |                                For dintFor2 = 1 T||16108  |                                For dintFor2 = 1 T
16338  |                                    If ddblDailyna||16109  |                                    If ddblDailyna
16339  |                                        ddblDailyn||16110  |                                        ddblDailyn
16340  |                                    Else          ||16111  |                                    Else          
16341  |                                        '日次時価 ||16112  |                                        '日次時価 
16342  |                                        intRtn = M||16113  |                                        intRtn = M
16343  |                                        vbLf & "対||16114  |                                        vbLf & "対
16344  |                                        vbLf & "基||16115  |                                        vbLf & "基
16345  |                                            vbCrit||16116  |                                            vbCrit
16346  |                                        Exit Funct||16117  |                                        Exit Funct
16347  |                                    End If        ||16118  |                                    End If        
16348  |                                    dlngCnt = dlng||16119  |                                    dlngCnt = dlng
16349  |                                Next dintFor2     ||16120  |                                Next dintFor2     
16350  |                                'RAFI対応 START   ||16121  |                                'RAFI対応 START   
16351  |                                '純資産の場合     ||16122  |                                '純資産の場合     
16352  |                                If msAssetFlg = "0||16123  |                                If msAssetFlg = "0
16353  |                                    ddblDailynav(d||16124  |                                    ddblDailynav(d
16354  |                                'マザー組入資産の ||16125  |                                'マザー組入資産の 
16355  |                                Else              ||16126  |                                Else              
16356  |                                    ddblDailynav(d||16127  |                                    ddblDailynav(d
16357  |                                End If            ||16128  |                                End If            
16358  |                                'RAFI対応 END     ||16129  |                                'RAFI対応 END     
16359  |                            End If                ||16130  |                            End If                
16360  |                                                  ||16131  |                                                  
16361  |                        End If                    ||16132  |                        End If                    
16362  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||16133  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
16363  |                        Call gDyNext              ||16134  |                        Call gDyNext              
16364  |                    Loop                          ||16135  |                    Loop                          
16365  |                                                  ||16136  |                                                  
16366  |                                                  ||16137  |                                                  
16367  |                Next dintFor                      ||16138  |                Next dintFor                      
16368  |                                                  ||16139  |                                                  
16369  |                If dlngCntsv <> dlngCnt Then      ||16140  |                If dlngCntsv <> dlngCnt Then      
16370  |                    For dintFor2 = dlngCnt + 1 To ||16141  |                    For dintFor2 = dlngCnt + 1 To 
16371  |                        ddblDailynav(dintFor2) = d||16142  |                        ddblDailynav(dintFor2) = d
16372  |                    Next dintFor2                 ||16143  |                    Next dintFor2                 
16373  |                    dlngCnt = dlngCntsv           ||16144  |                    dlngCnt = dlngCntsv           
16374  |                End If                            ||16145  |                End If                            
16375  |                                                  ||16146  |                                                  
16376  |                ddblTtalnav = 0                   ||16147  |                ddblTtalnav = 0                   
16377  |                                                  ||16148  |                                                  
16378  |                For dintFor2 = 1 To dlngCnt       ||16149  |                For dintFor2 = 1 To dlngCnt       
16379  |                    ddblTtalnav = ddblTtalnav + dd||16150  |                    ddblTtalnav = ddblTtalnav + dd
16380  |                Next dintFor2                     ||16151  |                Next dintFor2                     
16381  |                                                  ||16152  |                                                  
16382  |                'カレンダーを元に日次時価総額を配 ||16153  |                'カレンダーを元に日次時価総額を配 
16383  |                K = 0                             ||16154  |                K = 0                             
16384  |                For i = 1 To dlngCnt              ||16155  |                For i = 1 To dlngCnt              
16385  |                    '計算開始日の日次時価総額は無 ||16156  |                    '計算開始日の日次時価総額は無 
16386  |                    If i = 1 Then                 ||16157  |                    If i = 1 Then                 
16387  |                        gtypOtherComRec(K).APPLY_T||16158  |                        gtypOtherComRec(K).APPLY_T
16388  |                    Else                          ||16159  |                    Else                          
16389  |                        '適用終了日に成るまで累積 ||16160  |                        '適用終了日に成るまで累積 
16390  |                        If Mid(dstrCaldate(i), 1, ||16161  |                        If Mid(dstrCaldate(i), 1, 
16391  |                            gtypOtherComRec(K).APP||16162  |                            gtypOtherComRec(K).APP
16392  |                        'カレンダー日付が適用終了 ||16163  |                        'カレンダー日付が適用終了 
16393  |                        Else                      ||16164  |                        Else                      
16394  |                            '料率変更毎に平均時価 ||16165  |                            '料率変更毎に平均時価 
16395  |                            gtypOtherComRec(K).APP||16166  |                            gtypOtherComRec(K).APP
16396  |                            '次の料率へシフトする ||16167  |                            '次の料率へシフトする 
16397  |                            K = K + 1             ||16168  |                            K = K + 1             
16398  |                            gtypOtherComRec(K).APP||16169  |                            gtypOtherComRec(K).APP
16399  |                        End If                    ||16170  |                        End If                    
16400  |                    End If                        ||16171  |                    End If                        
16401  |                    '最後のレコードの場合時価総額 ||16172  |                    '最後のレコードの場合時価総額 
16402  |                    If i = dlngCnt Then           ||16173  |                    If i = dlngCnt Then           
16403  |                        '料率変更毎に平均時価総額 ||16174  |                        '料率変更毎に平均時価総額 
16404  |                        gtypOtherComRec(K).APPLY_N||16175  |                        gtypOtherComRec(K).APPLY_N
16405  |                    End If                        ||16176  |                    End If                        
16406  |                Next i                            ||16177  |                Next i                            
16407  |                                                  ||16178  |                                                  
16408  |                iRowCnt = dlngCnt                 ||16179  |                iRowCnt = dlngCnt                 
16409  |                TotalNav = ddblTtalnav            ||16180  |                TotalNav = ddblTtalnav            
16410  |                dblValueIn = TotalNav             ||16181  |                dblValueIn = TotalNav             
16411  |                Call sbGetRoundValue2(dblValueIn) ||16182  |                Call sbGetRoundValue2(dblValueIn) 
16412  |                TotalNav = dblValueOut            ||16183  |                TotalNav = dblValueOut            
16413  |                                                  ||16184  |                                                  
16414  |                '合計(月末純資産)                 ||16185  |                '合計(月末純資産)                 
16415  |                .Cells(17, 23).NumberFormatLocal =||16186  |                .Cells(17, 23).NumberFormatLocal =
16416  |                .Cells(17, 23).Value = CStr(Format||16187  |                .Cells(17, 23).Value = CStr(Format
16417  |                .Cells(17, 23).HorizontalAlignment||16188  |                .Cells(17, 23).HorizontalAlignment
16418  |'2006/08/16 START 期中料率変更契約/RAFI対応のため ||16189  |'2006/08/16 START 期中料率変更契約/RAFI対応のため 
16419  |'                '平均純資産総額                  ||16190  |'                '平均純資産総額                  
16420  |'                .Cells(36, 2).Value = sWord51    ||16191  |'                .Cells(36, 2).Value = sWord51    
16421  |'                .Cells(36, 11).Value = sWord19   ||16192  |'                .Cells(36, 11).Value = sWord19   
16422  |'2006/08/16 END   期中料率変更契約/RAFI対応のため ||16193  |'2006/08/16 END   期中料率変更契約/RAFI対応のため 
16423  |                                                  ||16194  |                                                  
16424  |                '平均純資産総額                   ||16195  |                '平均純資産総額                   
16425  |                .Cells(42, 2).Value = sWord51     ||16196  |                .Cells(42, 2).Value = sWord51     
16426  |                .Cells(42, 11).Value = sWord19    ||16197  |                .Cells(42, 11).Value = sWord19    
16427  |                '平均純資産総額は別紙に記載       ||16198  |                '平均純資産総額は別紙に記載       
16428  |                '.Cells(39, 13).Value = sWord54   ||16199  |                '.Cells(39, 13).Value = sWord54   
16429  |                .Cells(42, 13).Value = sWord54    ||16200  |                .Cells(42, 13).Value = sWord54    
16430  |                                                  ||16201  |                                                  
16431  |'2006/08/16 START 期中料率変更契約/RAFI対応のため ||16202  |'2006/08/16 START 期中料率変更契約/RAFI対応のため 
16432  |'                '計算期間の純資産総額の合計(月末 ||16203  |'                '計算期間の純資産総額の合計(月末 
16433  |'                .Cells(36, 23).NumberFormatLocal ||16204  |'                .Cells(36, 23).NumberFormatLocal 
16434  |'                    If gbuMGetUPDRec.N(lRecIdx).M||16205  |'                    If gbuMGetUPDRec.N(lRecIdx).M
16435  |'                        .Cells(36, 23).Value = CS||16206  |'                        .Cells(36, 23).Value = CS
16436  |'                    Else                         ||16207  |'                    Else                         
16437  |'                        .Cells(36, 23).Value = CS||16208  |'                        .Cells(36, 23).Value = CS
16438  |'                    End If                       ||16209  |'                    End If                       
16439  |'                .Cells(36, 23).HorizontalAlignmen||16210  |'                .Cells(36, 23).HorizontalAlignmen
16440  |'                '計算期間の純資産総額の合計÷計算||16211  |'                '計算期間の純資産総額の合計÷計算
16441  |'                .Cells(36, 35).NumberFormatLocal ||16212  |'                .Cells(36, 35).NumberFormatLocal 
16442  |'                dblValueIn = TotalNav / iRowCnt  ||16213  |'                dblValueIn = TotalNav / iRowCnt  
16443  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||16214  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
16444  |'                    Call sbGetRoundValue2(dblValu||16215  |'                    Call sbGetRoundValue2(dblValu
16445  |'                Else                             ||16216  |'                Else                             
16446  |'                    Call sbGetRoundValue(dblValue||16217  |'                    Call sbGetRoundValue(dblValue
16447  |'                End If                           ||16218  |'                End If                           
16448  |'                    If gbuMGetUPDRec.N(lRecIdx).M||16219  |'                    If gbuMGetUPDRec.N(lRecIdx).M
16449  |'                        .Cells(36, 35).Value = CS||16220  |'                        .Cells(36, 35).Value = CS
16450  |'                    Else                         ||16221  |'                    Else                         
16451  |'                        .Cells(36, 35).Value = CS||16222  |'                        .Cells(36, 35).Value = CS
16452  |'                    End If                       ||16223  |'                    End If                       
16453  |'                '÷??＝ ,文言                    ||16224  |'                '÷??＝ ,文言                    
16454  |'                .Cells(36, 26).Value = sWord18 & ||16225  |'                .Cells(36, 26).Value = sWord18 & 
16455  |'2006/08/16 END   期中料率変更契約/RAFI対応のため ||16226  |'2006/08/16 END   期中料率変更契約/RAFI対応のため 
16456  |                                                  ||16227  |                                                  
16457  |                '計算期間の純資産総額の合計÷計算 ||16228  |                '計算期間の純資産総額の合計÷計算 
16458  |                dblValueIn = TotalNav / iRowCnt   ||16229  |                dblValueIn = TotalNav / iRowCnt   
16459  |                Call sbGetRoundValue(dblValueIn)  ||16230  |                Call sbGetRoundValue(dblValueIn)  
16460  |                AvgNav = dblValueOut              ||16231  |                AvgNav = dblValueOut              
16461  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||16232  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
16462  |                                                  ||16233  |                                                  
16463  |            Else                                  ||16234  |            Else                                  
16464  |'取得NAV区分[1]以外(取得NAV区分='2')              ||16235  |'取得NAV区分[1]以外(取得NAV区分='2')              
16465  |                                                  ||16236  |                                                  
16466  |                ddblTtalnav = 0                   ||16237  |                ddblTtalnav = 0                   
16467  |                For dintFor = 0 To NavGetCnt - 1  ||16238  |                For dintFor = 0 To NavGetCnt - 1  
16468  |                                                  ||16239  |                                                  
16469  |                    '日次NAV平均取得              ||16240  |                    '日次NAV平均取得              
16470  |                    sStart = gstrDateFormat2(CStr(||16241  |                    sStart = gstrDateFormat2(CStr(
16471  |                    sEnd = gstrDateFormat2(CStr(dE||16242  |                    sEnd = gstrDateFormat2(CStr(dE
16472  |                                                  ||16243  |                                                  
16473  |'2008/03/03 START '計算開始日と外部委託顧問料計算 ||16244  |'2008/03/03 START '計算開始日と外部委託顧問料計算 
16474  |                    '等しい場合                   ||16245  |                    '等しい場合                   
16475  |                    If sStart = gbuMGetUPDRec.N(lR||16246  |                    If sStart = gbuMGetUPDRec.N(lR
16476  |                        StartFlg = "1"            ||16247  |                        StartFlg = "1"            
16477  |                    Else                          ||16248  |                    Else                          
16478  |                        StartFlg = "0"            ||16249  |                        StartFlg = "0"            
16479  |                    End If                        ||16250  |                    End If                        
16480  |'2008/03/03 END   '計算開始日と外部委託顧問料計算 ||16251  |'2008/03/03 END   '計算開始日と外部委託顧問料計算 
16481  |                                                  ||16252  |                                                  
16482  |                    '計算開始日と外部委託顧問料計 ||16253  |                    '計算開始日と外部委託顧問料計 
16483  |                    If sStart = gbuMGetUPDRec.N(lR||16254  |                    If sStart = gbuMGetUPDRec.N(lR
16484  |                        '== SQL1 ==               ||16255  |                        '== SQL1 ==               
16485  |                        sSql = ""                 ||16256  |                        sSql = ""                 
16486  |                        sSql = sSql & "SELECT EIGY||16257  |                        sSql = sSql & "SELECT EIGY
16487  |                                                  ||16258  |                                                  
16488  |                        'ﾀﾞｲﾅｾｯﾄの作成            ||16259  |                        'ﾀﾞｲﾅｾｯﾄの作成            
16489  |                        If gintDyCreate(sSql) = Fa||16260  |                        If gintDyCreate(sSql) = Fa
16490  |                            Exit Function         ||16261  |                            Exit Function         
16491  |                        Else                      ||16262  |                        Else                      
16492  |                            '計算開始日が休日の場 ||16263  |                            '計算開始日が休日の場 
16493  |                            If gvlnDyDataS("EIGYO_||16264  |                            If gvlnDyDataS("EIGYO_
16494  |                                '翌営業日のNAVを取||16265  |                                '翌営業日のNAVを取
16495  |                                '== SQL2 ==       ||16266  |                                '== SQL2 ==       
16496  |                                sSql = ""         ||16267  |                                sSql = ""         
16497  |                                sSql = sSql & "SEL||16268  |                                sSql = sSql & "SEL
16498  |                                sSql = sSql & "FRO||16269  |                                sSql = sSql & "FRO
16499  |                                sSql = sSql & "(SE||16270  |                                sSql = sSql & "(SE
16500  |                                sSql = sSql & "WHE||16271  |                                sSql = sSql & "WHE
16501  |                                                  ||16272  |                                                  
16502  |                                'ﾀﾞｲﾅｾｯﾄの作成    ||16273  |                                'ﾀﾞｲﾅｾｯﾄの作成    
16503  |                                If gintDyCreate(sS||16274  |                                If gintDyCreate(sS
16504  |                                    Exit Function ||16275  |                                    Exit Function 
16505  |                                Else              ||16276  |                                Else              
16506  |                                    ddblNearNav = ||16277  |                                    ddblNearNav = 
16507  |'2008/03/06 START 時価総額基準の外部委託顧問料対応||16278  |'2008/03/06 START 時価総額基準の外部委託顧問料対応
16508  |'                                    '翌営業日の計||16279  |'                                    '翌営業日の計
16509  |'                                    '== SQL3 ==  ||16280  |'                                    '== SQL3 ==  
16510  |'                                    sSql = ""    ||16281  |'                                    sSql = ""    
16511  |'                                    sSql = sSql &||16282  |'                                    sSql = sSql &
16512  |'                                    sSql = sSql &||16283  |'                                    sSql = sSql &
16513  |'                                    sSql = sSql &||16284  |'                                    sSql = sSql &
16514  |'                                    sSql = sSql &||16285  |'                                    sSql = sSql &
16515  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||16286  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
16516  |'                                    If gintDyCrea||16287  |'                                    If gintDyCrea
16517  |'                                        Exit Func||16288  |'                                        Exit Func
16518  |'                                    Else         ||16289  |'                                    Else         
16519  |'                                        '計算開始||16290  |'                                        '計算開始
16520  |'                                        sStart = ||16291  |'                                        sStart = 
16521  |'                                        dStart = ||16292  |'                                        dStart = 
16522  |'                                        .Cells(15||16293  |'                                        .Cells(15
16523  |'                                            CStr(||16294  |'                                            CStr(
16524  |'                                        iCalcNum ||16295  |'                                        iCalcNum 
16525  |'                                    End If       ||16296  |'                                    End If       
16526  |'2008/03/06 END   時価総額基準の外部委託顧問料対応||16297  |'2008/03/06 END   時価総額基準の外部委託顧問料対応
16527  |                                                  ||16298  |                                                  
16528  |                                    'SQL文の作成( ||16299  |                                    'SQL文の作成( 
16529  |                                    '計算期間の開 ||16300  |                                    '計算期間の開 
16530  |                                    sSql = gstrEdi||16301  |                                    sSql = gstrEdi
16531  |                                        ContNo, sS||16302  |                                        ContNo, sS
16532  |                                                  ||16303  |                                                  
16533  |                                     'ﾀﾞｲﾅｾｯﾄの作 ||16304  |                                     'ﾀﾞｲﾅｾｯﾄの作 
16534  |                                    If gintDyCreat||16305  |                                    If gintDyCreat
16535  |                                        Exit Funct||16306  |                                        Exit Funct
16536  |                                    End If        ||16307  |                                    End If        
16537  |                                    '配列初期化   ||16308  |                                    '配列初期化   
16538  |                                    ReDim gbuOther||16309  |                                    ReDim gbuOther
16539  |                                    MonthlyCnt = 0||16310  |                                    MonthlyCnt = 0
16540  |                                    'EOF判定処理  ||16311  |                                    'EOF判定処理  
16541  |                                    Do Until gblnD||16312  |                                    Do Until gblnD
16542  |                                        '対象デー ||16313  |                                        '対象デー 
16543  |                                        Call sbOth||16314  |                                        Call sbOth
16544  |                                        MonthlyCnt||16315  |                                        MonthlyCnt
16545  |                                        'ﾀﾞｲﾅｾｯﾄ次||16316  |                                        'ﾀﾞｲﾅｾｯﾄ次
16546  |                                        Call gDyNe||16317  |                                        Call gDyNe
16547  |                                    Loop          ||16318  |                                    Loop          
16548  |                                                  ||16319  |                                                  
16549  |                                    '期中料率変更 ||16320  |                                    '期中料率変更 
16550  |                                    Erase gtypOthe||16321  |                                    Erase gtypOthe
16551  |                                                  ||16322  |                                                  
16552  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||16323  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
16553  |                                    '期中料率変更 ||16324  |                                    '期中料率変更 
16554  |                                    '外部委託顧問 ||16325  |                                    '外部委託顧問 
16555  |                                    If fnSetOtherC||16326  |                                    If fnSetOtherC
16556  |                                                  ||16327  |                                                  
16557  |                                                  ||16328  |                                                  
16558  |                                                  ||16329  |                                                  
16559  |                                                  ||16330  |                                                  
16560  |                                                  ||16331  |                                                  
16561  |                                        Exit Funct||16332  |                                        Exit Funct
16562  |                                    End If        ||16333  |                                    End If        
16563  |'2008/03/03 END 時価総額基準の外部委託顧問料対応( ||16334  |'2008/03/03 END 時価総額基準の外部委託顧問料対応( 
16564  |                                                  ||16335  |                                                  
16565  |                                End If            ||16336  |                                End If            
16566  |                                'RAFI対応 START   ||16337  |                                'RAFI対応 START   
16567  |                                '翌営業日のマザー ||16338  |                                '翌営業日のマザー 
16568  |                                If msAssetFlg = "1||16339  |                                If msAssetFlg = "1
16569  |                                    '== SQL4 ==   ||16340  |                                    '== SQL4 ==   
16570  |                                    sSql = ""     ||16341  |                                    sSql = ""     
16571  |                                    sSql = sSql & ||16342  |                                    sSql = sSql & 
16572  |                                    sSql = sSql & ||16343  |                                    sSql = sSql & 
16573  |                                    sSql = sSql & ||16344  |                                    sSql = sSql & 
16574  |                                    sSql = sSql & ||16345  |                                    sSql = sSql & 
16575  |                                    sSql = sSql & ||16346  |                                    sSql = sSql & 
16576  |                                    sSql = sSql & ||16347  |                                    sSql = sSql & 
16577  |                                    sSql = sSql & ||16348  |                                    sSql = sSql & 
16578  |                                    sSql = sSql & ||16349  |                                    sSql = sSql & 
16579  |                                    sSql = sSql & ||16350  |                                    sSql = sSql & 
16580  |                                    sSql = sSql & ||16351  |                                    sSql = sSql & 
16581  |                                    sSql = sSql & ||16352  |                                    sSql = sSql & 
16582  |                                    sSql = sSql & ||16353  |                                    sSql = sSql & 
16583  |                                    sSql = sSql & ||16354  |                                    sSql = sSql & 
16584  |                                    sSql = sSql & ||16355  |                                    sSql = sSql & 
16585  |                                    sSql = sSql & ||16356  |                                    sSql = sSql & 
16586  |                                    sSql = sSql & ||16357  |                                    sSql = sSql & 
16587  |                                    sSql = sSql & ||16358  |                                    sSql = sSql & 
16588  |                                    sSql = sSql & ||16359  |                                    sSql = sSql & 
16589  |                                    sSql = sSql & ||16360  |                                    sSql = sSql & 
16590  |                                    sSql = sSql & ||16361  |                                    sSql = sSql & 
16591  |                                    sSql = sSql & ||16362  |                                    sSql = sSql & 
16592  |                                    sSql = sSql & ||16363  |                                    sSql = sSql & 
16593  |                                    sSql = sSql & ||16364  |                                    sSql = sSql & 
16594  |                                    sSql = sSql & ||16365  |                                    sSql = sSql & 
16595  |                                    'ﾀﾞｲﾅｾｯﾄの作成||16366  |                                    'ﾀﾞｲﾅｾｯﾄの作成
16596  |                                                  ||16367  |                                                  
16597  |                                    If gintDyCreat||16368  |                                    If gintDyCreat
16598  |                                        Exit Funct||16369  |                                        Exit Funct
16599  |                                    Else          ||16370  |                                    Else          
16600  |                                        ddblNearBa||16371  |                                        ddblNearBa
16601  |                                    End If        ||16372  |                                    End If        
16602  |                                End If            ||16373  |                                End If            
16603  |                                'RAFI対応 END     ||16374  |                                'RAFI対応 END     
16604  |                            End If                ||16375  |                            End If                
16605  |                        End If                    ||16376  |                        End If                    
16606  |                    End If                        ||16377  |                    End If                        
16607  |                    '計算開始日から計算終了日まで ||16378  |                    '計算開始日から計算終了日まで 
16608  |                    '== SQL5 ==                   ||16379  |                    '== SQL5 ==                   
16609  |                    sSql = ""                     ||16380  |                    sSql = ""                     
16610  |                    sSql = sSql & "SELECT CAL_YYYY||16381  |                    sSql = sSql & "SELECT CAL_YYYY
16611  |                    sSql = sSql & "WHERE CAL_YYYY ||16382  |                    sSql = sSql & "WHERE CAL_YYYY 
16612  |                                                  ||16383  |                                                  
16613  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||16384  |                    'ﾀﾞｲﾅｾｯﾄの作成                
16614  |                    If gintDyCreate(sSql) = False ||16385  |                    If gintDyCreate(sSql) = False 
16615  |                        Exit Function             ||16386  |                        Exit Function             
16616  |                    End If                        ||16387  |                    End If                        
16617  |                                                  ||16388  |                                                  
16618  |                    If dlngCnt = 0 Then           ||16389  |                    If dlngCnt = 0 Then           
16619  |                        ReDim dstrCaldate(gbxOraDy||16390  |                        ReDim dstrCaldate(gbxOraDy
16620  |                        ReDim ddblDailynav(gbxOraD||16391  |                        ReDim ddblDailynav(gbxOraD
16621  |                    End If                        ||16392  |                    End If                        
16622  |                                                  ||16393  |                                                  
16623  |                    'EOF判定処理                  ||16394  |                    'EOF判定処理                  
16624  |                    dlngCnt = 0                   ||16395  |                    dlngCnt = 0                   
16625  |                                                  ||16396  |                                                  
16626  |                    Do Until gblnDyEOF()          ||16397  |                    Do Until gblnDyEOF()          
16627  |                        dlngCnt = dlngCnt + 1     ||16398  |                        dlngCnt = dlngCnt + 1     
16628  |                        '抽出データセット         ||16399  |                        '抽出データセット         
16629  |                        dstrCaldate(dlngCnt) = gvl||16400  |                        dstrCaldate(dlngCnt) = gvl
16630  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||16401  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
16631  |                        Call gDyNext              ||16402  |                        Call gDyNext              
16632  |                    Loop                          ||16403  |                    Loop                          
16633  |                                                  ||16404  |                                                  
16634  |                                                  ||16405  |                                                  
16635  |                    '2005/08/26　START            ||16406  |                    '2005/08/26　START            
16636  |                    '変数sStartに格納されている日 ||16407  |                    '変数sStartに格納されている日 
16637  |                    '変数sStartの直近の営業日の日 ||16408  |                    '変数sStartの直近の営業日の日 
16638  |                    '（変数sStartに格納されている ||16409  |                    '（変数sStartに格納されている 
16639  |                    '　直近日付が存在しない場合は ||16410  |                    '　直近日付が存在しない場合は 
16640  |                                                  ||16411  |                                                  
16641  |                    '計算開始日の日次NAV基準日を取||16412  |                    '計算開始日の日次NAV基準日を取
16642  |                    '== SQL6 ==                   ||16413  |                    '== SQL6 ==                   
16643  |                    sSql = ""                     ||16414  |                    sSql = ""                     
16644  |                    sSql = sSql & "SELECT MAX(BASE||16415  |                    sSql = sSql & "SELECT MAX(BASE
16645  |                    sSql = sSql & "FROM   CFR_DAIL||16416  |                    sSql = sSql & "FROM   CFR_DAIL
16646  |                    sSql = sSql & "WHERE  BASE_DAT||16417  |                    sSql = sSql & "WHERE  BASE_DAT
16647  |                    sSql = sSql & "AND    ACCOUNT_||16418  |                    sSql = sSql & "AND    ACCOUNT_
16648  |                                                  ||16419  |                                                  
16649  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||16420  |                    'ﾀﾞｲﾅｾｯﾄの作成                
16650  |                    If gintDyCreate(sSql) = False ||16421  |                    If gintDyCreate(sSql) = False 
16651  |                        Exit Function             ||16422  |                        Exit Function             
16652  |                    End If                        ||16423  |                    End If                        
16653  |                                                  ||16424  |                                                  
16654  |                    Do Until gblnDyEOF()          ||16425  |                    Do Until gblnDyEOF()          
16655  |                       '抽出データセット          ||16426  |                       '抽出データセット          
16656  |                        sStart = gvlnDyDataS("BASE||16427  |                        sStart = gvlnDyDataS("BASE
16657  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||16428  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
16658  |                        Call gDyNext              ||16429  |                        Call gDyNext              
16659  |                    Loop                          ||16430  |                    Loop                          
16660  |                                                  ||16431  |                                                  
16661  |                    'SQL文の作成(外部委託顧問料率 ||16432  |                    'SQL文の作成(外部委託顧問料率 
16662  |                    '計算期間の開始日と終了日に含 ||16433  |                    '計算期間の開始日と終了日に含 
16663  |                    sSql = gstrEditSQLcfr_OtherCom||16434  |                    sSql = gstrEditSQLcfr_OtherCom
16664  |                        ContNo, sStart, mstrNearSe||16435  |                        ContNo, sStart, mstrNearSe
16665  |                                                  ||16436  |                                                  
16666  |                     'ﾀﾞｲﾅｾｯﾄの作成               ||16437  |                     'ﾀﾞｲﾅｾｯﾄの作成               
16667  |                    If gintDyCreate(sSql) = False ||16438  |                    If gintDyCreate(sSql) = False 
16668  |                        Exit Function             ||16439  |                        Exit Function             
16669  |                    End If                        ||16440  |                    End If                        
16670  |                    '配列初期化                   ||16441  |                    '配列初期化                   
16671  |                    ReDim gbuOtherComRateGetUPDRec||16442  |                    ReDim gbuOtherComRateGetUPDRec
16672  |                    MonthlyCnt = 0                ||16443  |                    MonthlyCnt = 0                
16673  |                    'EOF判定処理                  ||16444  |                    'EOF判定処理                  
16674  |                    Do Until gblnDyEOF()          ||16445  |                    Do Until gblnDyEOF()          
16675  |                        '対象データ抽出           ||16446  |                        '対象データ抽出           
16676  |                        Call sbOtherComDataGet(Mon||16447  |                        Call sbOtherComDataGet(Mon
16677  |                        MonthlyCnt = MonthlyCnt + ||16448  |                        MonthlyCnt = MonthlyCnt + 
16678  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||16449  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
16679  |                        Call gDyNext              ||16450  |                        Call gDyNext              
16680  |                    Loop                          ||16451  |                    Loop                          
16681  |                                                  ||16452  |                                                  
16682  |                    '期中料率変更用配列のクリア   ||16453  |                    '期中料率変更用配列のクリア   
16683  |                    Erase gtypOtherComRec         ||16454  |                    Erase gtypOtherComRec         
16684  |                                                  ||16455  |                                                  
16685  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||16456  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
16686  |                    '期中料率変更対象契約         ||16457  |                    '期中料率変更対象契約         
16687  |                    '外部委託顧問料率を定義体配列 ||16458  |                    '外部委託顧問料率を定義体配列 
16688  |                    If fnSetOtherComRate(gbuMGetUP||16459  |                    If fnSetOtherComRate(gbuMGetUP
16689  |                                         msAssetFl||16460  |                                         msAssetFl
16690  |                                         gbuMGetUP||16461  |                                         gbuMGetUP
16691  |                                         conDBasse||16462  |                                         conDBasse
16692  |                                         sStart, _||16463  |                                         sStart, _
16693  |                                         StartFlg)||16464  |                                         StartFlg)
16694  |                        Exit Function             ||16465  |                        Exit Function             
16695  |                    End If                        ||16466  |                    End If                        
16696  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||16467  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
16697  |                                                  ||16468  |                                                  
16698  |                    'RAFI対応 START               ||16469  |                    'RAFI対応 START               
16699  |                    '純資産の場合                 ||16470  |                    '純資産の場合                 
16700  |                    If msAssetFlg = "0" Then      ||16471  |                    If msAssetFlg = "0" Then      
16701  |                        '計算開始日から計算終了日 ||16472  |                        '計算開始日から計算終了日 
16702  |                        '== SQL 7 ==              ||16473  |                        '== SQL 7 ==              
16703  |                        sSql = ""                 ||16474  |                        sSql = ""                 
16704  |                        sSql = sSql & "SELECT ACCO||16475  |                        sSql = sSql & "SELECT ACCO
16705  |                        sSql = sSql & "WHERE (((CF||16476  |                        sSql = sSql & "WHERE (((CF
16706  |                        sSql = sSql & "AND ((CFR_D||16477  |                        sSql = sSql & "AND ((CFR_D
16707  |                        sSql = sSql & "AND ((CFR_D||16478  |                        sSql = sSql & "AND ((CFR_D
16708  |                        sSql = sSql & "ORDER BY CF||16479  |                        sSql = sSql & "ORDER BY CF
16709  |                    'マザー組入資産の場合         ||16480  |                    'マザー組入資産の場合         
16710  |                    Else                          ||16481  |                    Else                          
16711  |                        '計算開始日から計算終了日 ||16482  |                        '計算開始日から計算終了日 
16712  |                        '== SQL8 ==               ||16483  |                        '== SQL8 ==               
16713  |                        sSql = ""                 ||16484  |                        sSql = ""                 
16714  |                        sSql = sSql & "SELECT"    ||16485  |                        sSql = sSql & "SELECT"    
16715  |                        sSql = sSql & "    a.ACCOU||16486  |                        sSql = sSql & "    a.ACCOU
16716  |                        sSql = sSql & "    a.BASE_||16487  |                        sSql = sSql & "    a.BASE_
16717  |                        sSql = sSql & "    a.NET_A||16488  |                        sSql = sSql & "    a.NET_A
16718  |                        sSql = sSql & "    b.BABY_||16489  |                        sSql = sSql & "    b.BABY_
16719  |                        sSql = sSql & "    b.BABY_||16490  |                        sSql = sSql & "    b.BABY_
16720  |                        sSql = sSql & " FROM"     ||16491  |                        sSql = sSql & " FROM"     
16721  |                        sSql = sSql & "    CFR_DAI||16492  |                        sSql = sSql & "    CFR_DAI
16722  |                        sSql = sSql & " WHERE"    ||16493  |                        sSql = sSql & " WHERE"    
16723  |                        sSql = sSql & "    b.BABY_||16494  |                        sSql = sSql & "    b.BABY_
16724  |                        sSql = sSql & "    b.MOTHE||16495  |                        sSql = sSql & "    b.MOTHE
16725  |                        sSql = sSql & "    b.BASE_||16496  |                        sSql = sSql & "    b.BASE_
16726  |                        sSql = sSql & "    a.ACCOU||16497  |                        sSql = sSql & "    a.ACCOU
16727  |                        sSql = sSql & "    (a.BASE||16498  |                        sSql = sSql & "    (a.BASE
16728  |                        sSql = sSql & "    a.BASE_||16499  |                        sSql = sSql & "    a.BASE_
16729  |                        sSql = sSql & "    a.CURRE||16500  |                        sSql = sSql & "    a.CURRE
16730  |                        sSql = sSql & "    a.ASSET||16501  |                        sSql = sSql & "    a.ASSET
16731  |                        sSql = sSql & " ORDER BY" ||16502  |                        sSql = sSql & " ORDER BY" 
16732  |                        sSql = sSql & "    a.BASE_||16503  |                        sSql = sSql & "    a.BASE_
16733  |                    End If                        ||16504  |                    End If                        
16734  |                    'RAFI対応 END                 ||16505  |                    'RAFI対応 END                 
16735  |                                                  ||16506  |                                                  
16736  |                    If gintDyCreate(sSql) = False ||16507  |                    If gintDyCreate(sSql) = False 
16737  |                        Exit Function             ||16508  |                        Exit Function             
16738  |                    End If                        ||16509  |                    End If                        
16739  |                                                  ||16510  |                                                  
16740  |                    dlngCntsv = dlngCnt           ||16511  |                    dlngCntsv = dlngCnt           
16741  |                    dlngCnt = 0                   ||16512  |                    dlngCnt = 0                   
16742  |                                                  ||16513  |                                                  
16743  |                    Do Until gblnDyEOF()          ||16514  |                    Do Until gblnDyEOF()          
16744  |                        dlngCnt = dlngCnt + 1     ||16515  |                        dlngCnt = dlngCnt + 1     
16745  |                        '抽出データセット         ||16516  |                        '抽出データセット         
16746  |                        dstrBasedate = gvlnDyDataS||16517  |                        dstrBasedate = gvlnDyDataS
16747  |                        If Mid(dstrCaldate(dlngCnt||16518  |                        If Mid(dstrCaldate(dlngCnt
16748  |                            'RAFI対応 START       ||16519  |                            'RAFI対応 START       
16749  |                            '純資産の場合         ||16520  |                            '純資産の場合         
16750  |                            If msAssetFlg = "0" Th||16521  |                            If msAssetFlg = "0" Th
16751  |                                ddblDailynav(dlngC||16522  |                                ddblDailynav(dlngC
16752  |                            'マザー組入資産の場合 ||16523  |                            'マザー組入資産の場合 
16753  |                            Else                  ||16524  |                            Else                  
16754  |                                ddblDailynav(dlngC||16525  |                                ddblDailynav(dlngC
16755  |                            End If                ||16526  |                            End If                
16756  |                            'RAFI対応 END         ||16527  |                            'RAFI対応 END         
16757  |                        Else                      ||16528  |                        Else                      
16758  |                            '計算開始日が外部委託 ||16529  |                            '計算開始日が外部委託 
16759  |                            If ddblNearNav <> 0 An||16530  |                            If ddblNearNav <> 0 An
16760  |                                dstrCaldate2 = Mid||16531  |                                dstrCaldate2 = Mid
16761  |                                dstrBasedate2 = Mi||16532  |                                dstrBasedate2 = Mi
16762  |                                dlngDiffdate = Dat||16533  |                                dlngDiffdate = Dat
16763  |                                                  ||16534  |                                                  
16764  |                                For dintFor2 = 1 T||16535  |                                For dintFor2 = 1 T
16765  |                                    'RAFI対応 STAR||16536  |                                    'RAFI対応 STAR
16766  |                                    '純資産の場合 ||16537  |                                    '純資産の場合 
16767  |                                    If msAssetFlg ||16538  |                                    If msAssetFlg 
16768  |                                        ddblDailyn||16539  |                                        ddblDailyn
16769  |                                    'マザー組入資 ||16540  |                                    'マザー組入資 
16770  |                                    Else          ||16541  |                                    Else          
16771  |                                        ddblDailyn||16542  |                                        ddblDailyn
16772  |                                    End If        ||16543  |                                    End If        
16773  |                                    'RAFI対応 END ||16544  |                                    'RAFI対応 END 
16774  |                                    dlngCnt = dlng||16545  |                                    dlngCnt = dlng
16775  |                                Next dintFor2     ||16546  |                                Next dintFor2     
16776  |                                'RAFI対応 START   ||16547  |                                'RAFI対応 START   
16777  |                                '純資産の場合     ||16548  |                                '純資産の場合     
16778  |                                If msAssetFlg = "0||16549  |                                If msAssetFlg = "0
16779  |                                    ddblDailynav(d||16550  |                                    ddblDailynav(d
16780  |                                'マザー組入資産の ||16551  |                                'マザー組入資産の 
16781  |                                Else              ||16552  |                                Else              
16782  |                                    ddblDailynav(d||16553  |                                    ddblDailynav(d
16783  |                                End If            ||16554  |                                End If            
16784  |                                'RAFI対応 END     ||16555  |                                'RAFI対応 END     
16785  |                            Else                  ||16556  |                            Else                  
16786  |                                '日次NAVにデータが||16557  |                                '日次NAVにデータが
16787  |                                dstrCaldate2 = Mid||16558  |                                dstrCaldate2 = Mid
16788  |                                dstrBasedate2 = Mi||16559  |                                dstrBasedate2 = Mi
16789  |                                dlngDiffdate = Dat||16560  |                                dlngDiffdate = Dat
16790  |                                                  ||16561  |                                                  
16791  |                                For dintFor2 = 1 T||16562  |                                For dintFor2 = 1 T
16792  |                                    If ddblDailyna||16563  |                                    If ddblDailyna
16793  |                                        ddblDailyn||16564  |                                        ddblDailyn
16794  |                                    Else          ||16565  |                                    Else          
16795  |                                        '日次NAVに||16566  |                                        '日次NAVに
16796  |                                        intRtn = M||16567  |                                        intRtn = M
16797  |                                        vbLf & "対||16568  |                                        vbLf & "対
16798  |                                        vbLf & "基||16569  |                                        vbLf & "基
16799  |                                            vbCrit||16570  |                                            vbCrit
16800  |                                        Exit Funct||16571  |                                        Exit Funct
16801  |                                    End If        ||16572  |                                    End If        
16802  |                                    dlngCnt = dlng||16573  |                                    dlngCnt = dlng
16803  |                                Next dintFor2     ||16574  |                                Next dintFor2     
16804  |                                'RAFI対応 START   ||16575  |                                'RAFI対応 START   
16805  |                                '純資産の場合     ||16576  |                                '純資産の場合     
16806  |                                If msAssetFlg = "0||16577  |                                If msAssetFlg = "0
16807  |                                    ddblDailynav(d||16578  |                                    ddblDailynav(d
16808  |                                'マザー組入資産の ||16579  |                                'マザー組入資産の 
16809  |                                Else              ||16580  |                                Else              
16810  |                                    ddblDailynav(d||16581  |                                    ddblDailynav(d
16811  |                                End If            ||16582  |                                End If            
16812  |                                'RAFI対応 END     ||16583  |                                'RAFI対応 END     
16813  |                            End If                ||16584  |                            End If                
16814  |                                                  ||16585  |                                                  
16815  |                        End If                    ||16586  |                        End If                    
16816  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||16587  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
16817  |                        Call gDyNext              ||16588  |                        Call gDyNext              
16818  |                    Loop                          ||16589  |                    Loop                          
16819  |                                                  ||16590  |                                                  
16820  |                                                  ||16591  |                                                  
16821  |                Next dintFor                      ||16592  |                Next dintFor                      
16822  |                                                  ||16593  |                                                  
16823  |                If dlngCntsv <> dlngCnt Then      ||16594  |                If dlngCntsv <> dlngCnt Then      
16824  |                    For dintFor2 = dlngCnt + 1 To ||16595  |                    For dintFor2 = dlngCnt + 1 To 
16825  |                        ddblDailynav(dintFor2) = d||16596  |                        ddblDailynav(dintFor2) = d
16826  |                    Next dintFor2                 ||16597  |                    Next dintFor2                 
16827  |                    dlngCnt = dlngCntsv           ||16598  |                    dlngCnt = dlngCntsv           
16828  |                End If                            ||16599  |                End If                            
16829  |                                                  ||16600  |                                                  
16830  |                ddblTtalnav = 0                   ||16601  |                ddblTtalnav = 0                   
16831  |                                                  ||16602  |                                                  
16832  |                For dintFor2 = 1 To dlngCnt       ||16603  |                For dintFor2 = 1 To dlngCnt       
16833  |                    ddblTtalnav = ddblTtalnav + dd||16604  |                    ddblTtalnav = ddblTtalnav + dd
16834  |                Next dintFor2                     ||16605  |                Next dintFor2                     
16835  |                                                  ||16606  |                                                  
16836  |                'カレンダーを元に日次NAVを配列より||16607  |                'カレンダーを元に日次NAVを配列より
16837  |                K = 0                             ||16608  |                K = 0                             
16838  |                For i = 1 To dlngCnt              ||16609  |                For i = 1 To dlngCnt              
16839  |                    '計算開始日の日次NAVは無条件に||16610  |                    '計算開始日の日次NAVは無条件に
16840  |                    If i = 1 Then                 ||16611  |                    If i = 1 Then                 
16841  |                        gtypOtherComRec(K).APPLY_T||16612  |                        gtypOtherComRec(K).APPLY_T
16842  |                    Else                          ||16613  |                    Else                          
16843  |                        '適用終了日に成るまで累積 ||16614  |                        '適用終了日に成るまで累積 
16844  |                        If Mid(dstrCaldate(i), 1, ||16615  |                        If Mid(dstrCaldate(i), 1, 
16845  |                            gtypOtherComRec(K).APP||16616  |                            gtypOtherComRec(K).APP
16846  |                        'カレンダー日付が適用終了 ||16617  |                        'カレンダー日付が適用終了 
16847  |                        Else                      ||16618  |                        Else                      
16848  |                            '料率変更毎に平均NAVを||16619  |                            '料率変更毎に平均NAVを
16849  |                            gtypOtherComRec(K).APP||16620  |                            gtypOtherComRec(K).APP
16850  |                            '次の料率へシフトする ||16621  |                            '次の料率へシフトする 
16851  |                            K = K + 1             ||16622  |                            K = K + 1             
16852  |                            gtypOtherComRec(K).APP||16623  |                            gtypOtherComRec(K).APP
16853  |                        End If                    ||16624  |                        End If                    
16854  |                    End If                        ||16625  |                    End If                        
16855  |                    '最後のレコードの場合NAV平均を||16626  |                    '最後のレコードの場合NAV平均を
16856  |                    If i = dlngCnt Then           ||16627  |                    If i = dlngCnt Then           
16857  |                        '料率変更毎に平均NAVを算出||16628  |                        '料率変更毎に平均NAVを算出
16858  |                        gtypOtherComRec(K).APPLY_N||16629  |                        gtypOtherComRec(K).APPLY_N
16859  |                    End If                        ||16630  |                    End If                        
16860  |                Next i                            ||16631  |                Next i                            
16861  |                                                  ||16632  |                                                  
16862  |                iRowCnt = dlngCnt                 ||16633  |                iRowCnt = dlngCnt                 
16863  |                TotalNav = ddblTtalnav            ||16634  |                TotalNav = ddblTtalnav            
16864  |                dblValueIn = TotalNav             ||16635  |                dblValueIn = TotalNav             
16865  |                Call sbGetRoundValue2(dblValueIn) ||16636  |                Call sbGetRoundValue2(dblValueIn) 
16866  |                TotalNav = dblValueOut            ||16637  |                TotalNav = dblValueOut            
16867  |                                                  ||16638  |                                                  
16868  |                '合計(月末純資産)                 ||16639  |                '合計(月末純資産)                 
16869  |                .Cells(17, 23).NumberFormatLocal =||16640  |                .Cells(17, 23).NumberFormatLocal =
16870  |                    If gbuMGetUPDRec.N(lRecIdx).MG||16641  |                    If gbuMGetUPDRec.N(lRecIdx).MG
16871  |                        .Cells(17, 23).Value = CSt||16642  |                        .Cells(17, 23).Value = CSt
16872  |                    Else                          ||16643  |                    Else                          
16873  |                        .Cells(17, 23).Value = CSt||16644  |                        .Cells(17, 23).Value = CSt
16874  |                    End If                        ||16645  |                    End If                        
16875  |                .Cells(17, 23).HorizontalAlignment||16646  |                .Cells(17, 23).HorizontalAlignment
16876  |'2006/08/16 START 期中料率変更契約/RAFI対応のため ||16647  |'2006/08/16 START 期中料率変更契約/RAFI対応のため 
16877  |'                '平均純資産総額                  ||16648  |'                '平均純資産総額                  
16878  |'                .Cells(36, 2).Value = sWord51    ||16649  |'                .Cells(36, 2).Value = sWord51    
16879  |'                .Cells(36, 11).Value = sWord19   ||16650  |'                .Cells(36, 11).Value = sWord19   
16880  |'2006/08/16 END   期中料率変更契約/RAFI対応のため ||16651  |'2006/08/16 END   期中料率変更契約/RAFI対応のため 
16881  |                                                  ||16652  |                                                  
16882  |                '平均純資産総額                   ||16653  |                '平均純資産総額                   
16883  |                .Cells(42, 2).Value = sWord51     ||16654  |                .Cells(42, 2).Value = sWord51     
16884  |                .Cells(42, 11).Value = sWord19    ||16655  |                .Cells(42, 11).Value = sWord19    
16885  |                '平均純資産総額は別紙に記載       ||16656  |                '平均純資産総額は別紙に記載       
16886  |                '.Cells(39, 13).Value = sWord54   ||16657  |                '.Cells(39, 13).Value = sWord54   
16887  |                .Cells(42, 13).Value = sWord54    ||16658  |                .Cells(42, 13).Value = sWord54    
16888  |                                                  ||16659  |                                                  
16889  |'2006/08/16 START 期中料率変更契約/RAFI対応のため ||16660  |'2006/08/16 START 期中料率変更契約/RAFI対応のため 
16890  |'                '計算期間の純資産総額の合計(月末 ||16661  |'                '計算期間の純資産総額の合計(月末 
16891  |'                .Cells(36, 23).NumberFormatLocal ||16662  |'                .Cells(36, 23).NumberFormatLocal 
16892  |'                    If gbuMGetUPDRec.N(lRecIdx).M||16663  |'                    If gbuMGetUPDRec.N(lRecIdx).M
16893  |'                        .Cells(36, 23).Value = CS||16664  |'                        .Cells(36, 23).Value = CS
16894  |'                    Else                         ||16665  |'                    Else                         
16895  |'                        .Cells(36, 23).Value = CS||16666  |'                        .Cells(36, 23).Value = CS
16896  |'                    End If                       ||16667  |'                    End If                       
16897  |'                .Cells(36, 23).HorizontalAlignmen||16668  |'                .Cells(36, 23).HorizontalAlignmen
16898  |'                '計算期間の純資産総額の合計÷計算||16669  |'                '計算期間の純資産総額の合計÷計算
16899  |'                .Cells(36, 35).NumberFormatLocal ||16670  |'                .Cells(36, 35).NumberFormatLocal 
16900  |'                dblValueIn = TotalNav / iRowCnt  ||16671  |'                dblValueIn = TotalNav / iRowCnt  
16901  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||16672  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
16902  |'                    Call sbGetRoundValue2(dblValu||16673  |'                    Call sbGetRoundValue2(dblValu
16903  |'                Else                             ||16674  |'                Else                             
16904  |'                    Call sbGetRoundValue(dblValue||16675  |'                    Call sbGetRoundValue(dblValue
16905  |'                End If                           ||16676  |'                End If                           
16906  |'                    If gbuMGetUPDRec.N(lRecIdx).M||16677  |'                    If gbuMGetUPDRec.N(lRecIdx).M
16907  |'                        .Cells(36, 35).Value = CS||16678  |'                        .Cells(36, 35).Value = CS
16908  |'                    Else                         ||16679  |'                    Else                         
16909  |'                        .Cells(36, 35).Value = CS||16680  |'                        .Cells(36, 35).Value = CS
16910  |'                    End If                       ||16681  |'                    End If                       
16911  |'                '÷??＝ ,文言                    ||16682  |'                '÷??＝ ,文言                    
16912  |'                .Cells(36, 26).Value = sWord18 & ||16683  |'                .Cells(36, 26).Value = sWord18 & 
16913  |'2006/08/16 END   期中料率変更契約/RAFI対応のため ||16684  |'2006/08/16 END   期中料率変更契約/RAFI対応のため 
16914  |                                                  ||16685  |                                                  
16915  |                '計算期間の純資産総額の合計÷計算 ||16686  |                '計算期間の純資産総額の合計÷計算 
16916  |                dblValueIn = TotalNav / iRowCnt   ||16687  |                dblValueIn = TotalNav / iRowCnt   
16917  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||16688  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
16918  |                    Call sbGetRoundValue2(dblValue||16689  |                    Call sbGetRoundValue2(dblValue
16919  |                Else                              ||16690  |                Else                              
16920  |                    Call sbGetRoundValue(dblValueI||16691  |                    Call sbGetRoundValue(dblValueI
16921  |                End If                            ||16692  |                End If                            
16922  |                AvgNav = dblValueOut              ||16693  |                AvgNav = dblValueOut              
16923  |            End If                                ||16694  |            End If                                
16924  |'契約区分：名称使用許諾料計算　かつ　日次NAV(休日 ||16695  |'契約区分：名称使用許諾料計算　かつ　日次NAV(休日 
16925  |        Else                                      ||16696  |        Else                                      
16926  |                                                  ||16697  |                                                  
16927  |On Error GoTo OnErrorProc                         ||16698  |On Error GoTo OnErrorProc                         
16928  |                                                  ||16699  |                                                  
16929  |            '契約区分「3」の場合                  ||16700  |            '契約区分「3」の場合                  
16930  |            ddblTtalnav = 0                       ||16701  |            ddblTtalnav = 0                       
16931  |            For dintFor = 0 To NavGetCnt - 1      ||16702  |            For dintFor = 0 To NavGetCnt - 1      
16932  |                                                  ||16703  |                                                  
16933  |                '日次NAV平均取得                  ||16704  |                '日次NAV平均取得                  
16934  |                sStart = gstrDateFormat2(CStr(dSta||16705  |                sStart = gstrDateFormat2(CStr(dSta
16935  |                sEnd = gstrDateFormat2(CStr(dEnd),||16706  |                sEnd = gstrDateFormat2(CStr(dEnd),
16936  |                                                  ||16707  |                                                  
16937  |                'RAFI対応 START                   ||16708  |                'RAFI対応 START                   
16938  |                '純資産の場合                     ||16709  |                '純資産の場合                     
16939  |                If msAssetFlg = "0" Then          ||16710  |                If msAssetFlg = "0" Then          
16940  |                    '計算開始日から計算終了日まで ||16711  |                    '計算開始日から計算終了日まで 
16941  |                    sSql = ""                     ||16712  |                    sSql = ""                     
16942  |                    sSql = sSql & "SELECT ACCOUNT_||16713  |                    sSql = sSql & "SELECT ACCOUNT_
16943  |                    sSql = sSql & "WHERE (((CFR_DA||16714  |                    sSql = sSql & "WHERE (((CFR_DA
16944  |                    sSql = sSql & "AND ((CFR_DAILY||16715  |                    sSql = sSql & "AND ((CFR_DAILY
16945  |                    sSql = sSql & "AND ((CFR_DAILY||16716  |                    sSql = sSql & "AND ((CFR_DAILY
16946  |                    sSql = sSql & "ORDER BY CFR_DA||16717  |                    sSql = sSql & "ORDER BY CFR_DA
16947  |                'マザー組入資産の場合             ||16718  |                'マザー組入資産の場合             
16948  |                Else                              ||16719  |                Else                              
16949  |                    '計算開始日から計算終了日まで ||16720  |                    '計算開始日から計算終了日まで 
16950  |                    sSql = ""                     ||16721  |                    sSql = ""                     
16951  |                    sSql = sSql & "SELECT"        ||16722  |                    sSql = sSql & "SELECT"        
16952  |                    sSql = sSql & "    a.ACCOUNT_C||16723  |                    sSql = sSql & "    a.ACCOUNT_C
16953  |                    sSql = sSql & "    a.BASE_DATE||16724  |                    sSql = sSql & "    a.BASE_DATE
16954  |                    sSql = sSql & "    a.NET_ASSET||16725  |                    sSql = sSql & "    a.NET_ASSET
16955  |                    sSql = sSql & "    b.BABY_MOTH||16726  |                    sSql = sSql & "    b.BABY_MOTH
16956  |                    sSql = sSql & "    b.BABY_MOTH||16727  |                    sSql = sSql & "    b.BABY_MOTH
16957  |                    sSql = sSql & " FROM"         ||16728  |                    sSql = sSql & " FROM"         
16958  |                    sSql = sSql & "    CFR_DAILY_N||16729  |                    sSql = sSql & "    CFR_DAILY_N
16959  |                    sSql = sSql & " WHERE"        ||16730  |                    sSql = sSql & " WHERE"        
16960  |                    sSql = sSql & "    b.BABY_ACCO||16731  |                    sSql = sSql & "    b.BABY_ACCO
16961  |                    sSql = sSql & "    b.MOTHER_AC||16732  |                    sSql = sSql & "    b.MOTHER_AC
16962  |                    sSql = sSql & "    b.BASE_DATE||16733  |                    sSql = sSql & "    b.BASE_DATE
16963  |                    sSql = sSql & "    a.ACCOUNT_C||16734  |                    sSql = sSql & "    a.ACCOUNT_C
16964  |                    sSql = sSql & "    (a.BASE_DAT||16735  |                    sSql = sSql & "    (a.BASE_DAT
16965  |                    sSql = sSql & "    a.BASE_DATE||16736  |                    sSql = sSql & "    a.BASE_DATE
16966  |                    sSql = sSql & "    a.CURRENCY_||16737  |                    sSql = sSql & "    a.CURRENCY_
16967  |                    sSql = sSql & "    a.ASSET_TYP||16738  |                    sSql = sSql & "    a.ASSET_TYP
16968  |                    sSql = sSql & " ORDER BY"     ||16739  |                    sSql = sSql & " ORDER BY"     
16969  |                    sSql = sSql & "    a.BASE_DATE||16740  |                    sSql = sSql & "    a.BASE_DATE
16970  |                End If                            ||16741  |                End If                            
16971  |                'RAFI対応 END                     ||16742  |                'RAFI対応 END                     
16972  |                                                  ||16743  |                                                  
16973  |                If gintDyCreate(sSql) = False Then||16744  |                If gintDyCreate(sSql) = False Then
16974  |                    Exit Function                 ||16745  |                    Exit Function                 
16975  |                End If                            ||16746  |                End If                            
16976  |                                                  ||16747  |                                                  
16977  |                If dlngCnt = 0 Then               ||16748  |                If dlngCnt = 0 Then               
16978  |                    ReDim dstrCaldate(gbxOraDynase||16749  |                    ReDim dstrCaldate(gbxOraDynase
16979  |                    ReDim ddblDailynav(gbxOraDynas||16750  |                    ReDim ddblDailynav(gbxOraDynas
16980  |                End If                            ||16751  |                End If                            
16981  |                                                  ||16752  |                                                  
16982  |                dlngCnt = 0                       ||16753  |                dlngCnt = 0                       
16983  |                                                  ||16754  |                                                  
16984  |                Do Until gblnDyEOF()              ||16755  |                Do Until gblnDyEOF()              
16985  |                    dlngCnt = dlngCnt + 1         ||16756  |                    dlngCnt = dlngCnt + 1         
16986  |                    'RAFI対応 START               ||16757  |                    'RAFI対応 START               
16987  |                    '純資産の場合                 ||16758  |                    '純資産の場合                 
16988  |                    If msAssetFlg = "0" Then      ||16759  |                    If msAssetFlg = "0" Then      
16989  |                        '抽出データセット         ||16760  |                        '抽出データセット         
16990  |                        dstrCaldate(dlngCnt) = gvl||16761  |                        dstrCaldate(dlngCnt) = gvl
16991  |                        ddblDailynav(dlngCnt) = dd||16762  |                        ddblDailynav(dlngCnt) = dd
16992  |                    'マザー組入資産の場合         ||16763  |                    'マザー組入資産の場合         
16993  |                    Else                          ||16764  |                    Else                          
16994  |                        dstrCaldate(dlngCnt) = gvl||16765  |                        dstrCaldate(dlngCnt) = gvl
16995  |                        ddblDailynav(dlngCnt) = dd||16766  |                        ddblDailynav(dlngCnt) = dd
16996  |                    End If                        ||16767  |                    End If                        
16997  |                    'RAFI対応 END                 ||16768  |                    'RAFI対応 END                 
16998  |                                                  ||16769  |                                                  
16999  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             ||16770  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             
17000  |                    Call gDyNext                  ||16771  |                    Call gDyNext                  
17001  |                Loop                              ||16772  |                Loop                              
17002  |                                                  ||16773  |                                                  
17003  |            Next dintFor                          ||16774  |            Next dintFor                          
17004  |                                                  ||16775  |                                                  
17005  |            ddblTtalnav = 0                       ||16776  |            ddblTtalnav = 0                       
17006  |                                                  ||16777  |                                                  
17007  |            For dintFor2 = 1 To dlngCnt           ||16778  |            For dintFor2 = 1 To dlngCnt           
17008  |                ddblTtalnav = ddblTtalnav + ddblDa||16779  |                ddblTtalnav = ddblTtalnav + ddblDa
17009  |            Next dintFor2                         ||16780  |            Next dintFor2                         
17010  |                                                  ||16781  |                                                  
17011  |            'SQL文の作成(外部委託顧問料率取得)    ||16782  |            'SQL文の作成(外部委託顧問料率取得)    
17012  |            '計算期間の開始日と終了日に含まれる適 ||16783  |            '計算期間の開始日と終了日に含まれる適 
17013  |            sSql = gstrEditSQLcfr_OtherComRateForS||16784  |            sSql = gstrEditSQLcfr_OtherComRateForS
17014  |                ContNo, sStart, sEnd)             ||16785  |                ContNo, sStart, sEnd)             
17015  |                                                  ||16786  |                                                  
17016  |             'ﾀﾞｲﾅｾｯﾄの作成                       ||16787  |             'ﾀﾞｲﾅｾｯﾄの作成                       
17017  |            If gintDyCreate(sSql) = False Then    ||16788  |            If gintDyCreate(sSql) = False Then    
17018  |                Exit Function                     ||16789  |                Exit Function                     
17019  |            End If                                ||16790  |            End If                                
17020  |            '配列初期化                           ||16791  |            '配列初期化                           
17021  |            ReDim gbuOtherComRateGetUPDRec.N(0)   ||16792  |            ReDim gbuOtherComRateGetUPDRec.N(0)   
17022  |            MonthlyCnt = 0                        ||16793  |            MonthlyCnt = 0                        
17023  |            'EOF判定処理                          ||16794  |            'EOF判定処理                          
17024  |            Do Until gblnDyEOF()                  ||16795  |            Do Until gblnDyEOF()                  
17025  |                '対象データ抽出                   ||16796  |                '対象データ抽出                   
17026  |                Call sbOtherComDataGet(MonthlyCnt)||16797  |                Call sbOtherComDataGet(MonthlyCnt)
17027  |                MonthlyCnt = MonthlyCnt + 1       ||16798  |                MonthlyCnt = MonthlyCnt + 1       
17028  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 ||16799  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 
17029  |                Call gDyNext                      ||16800  |                Call gDyNext                      
17030  |            Loop                                  ||16801  |            Loop                                  
17031  |                                                  ||16802  |                                                  
17032  |            '期中料率変更用配列のクリア           ||16803  |            '期中料率変更用配列のクリア           
17033  |            Erase gtypOtherComRec                 ||16804  |            Erase gtypOtherComRec                 
17034  |                                                  ||16805  |                                                  
17035  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||16806  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
17036  |            '期中料率変更対象契約                 ||16807  |            '期中料率変更対象契約                 
17037  |            '外部委託顧問料率を定義体配列にセット ||16808  |            '外部委託顧問料率を定義体配列にセット 
17038  |            If fnSetOtherComRate(gbuMGetUPDRec.N(l||16809  |            If fnSetOtherComRate(gbuMGetUPDRec.N(l
17039  |                                 msAssetFlg, msBab||16810  |                                 msAssetFlg, msBab
17040  |                                 gbuMGetUPDRec.N(l||16811  |                                 gbuMGetUPDRec.N(l
17041  |                                 conDBasset_type_c||16812  |                                 conDBasset_type_c
17042  |                                 " ", _           ||16813  |                                 " ", _           
17043  |                                 "0") = False Then||16814  |                                 "0") = False Then
17044  |                Exit Function                     ||16815  |                Exit Function                     
17045  |            End If                                ||16816  |            End If                                
17046  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||16817  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
17047  |                                                  ||16818  |                                                  
17048  |            'カレンダーを元に日次NAVを配列より取得||16819  |            'カレンダーを元に日次NAVを配列より取得
17049  |            K = 0                                 ||16820  |            K = 0                                 
17050  |            For i = 1 To dlngCnt                  ||16821  |            For i = 1 To dlngCnt                  
17051  |                '計算開始日の日次NAVは無条件に累積||16822  |                '計算開始日の日次NAVは無条件に累積
17052  |                If i = 1 Then                     ||16823  |                If i = 1 Then                     
17053  |                    gtypOtherComRec(K).APPLY_TOTAL||16824  |                    gtypOtherComRec(K).APPLY_TOTAL
17054  |                Else                              ||16825  |                Else                              
17055  |                    '適用終了日に成るまで累積する ||16826  |                    '適用終了日に成るまで累積する 
17056  |                    If Mid(dstrCaldate(i), 1, 8) <||16827  |                    If Mid(dstrCaldate(i), 1, 8) <
17057  |                        gtypOtherComRec(K).APPLY_T||16828  |                        gtypOtherComRec(K).APPLY_T
17058  |                    'カレンダー日付が適用終了日を ||16829  |                    'カレンダー日付が適用終了日を 
17059  |                    Else                          ||16830  |                    Else                          
17060  |                        '料率変更毎に平均NAVを算出||16831  |                        '料率変更毎に平均NAVを算出
17061  |                        gtypOtherComRec(K).APPLY_N||16832  |                        gtypOtherComRec(K).APPLY_N
17062  |                        '次の料率へシフトする     ||16833  |                        '次の料率へシフトする     
17063  |                        K = K + 1                 ||16834  |                        K = K + 1                 
17064  |                        gtypOtherComRec(K).APPLY_T||16835  |                        gtypOtherComRec(K).APPLY_T
17065  |                    End If                        ||16836  |                    End If                        
17066  |                End If                            ||16837  |                End If                            
17067  |                '最後のレコードの場合NAV平均を求め||16838  |                '最後のレコードの場合NAV平均を求め
17068  |                If i = dlngCnt Then               ||16839  |                If i = dlngCnt Then               
17069  |                    '料率変更毎に平均NAVを算出し格||16840  |                    '料率変更毎に平均NAVを算出し格
17070  |                    gtypOtherComRec(K).APPLY_NAV_A||16841  |                    gtypOtherComRec(K).APPLY_NAV_A
17071  |                End If                            ||16842  |                End If                            
17072  |            Next i                                ||16843  |            Next i                                
17073  |                                                  ||16844  |                                                  
17074  |                                                  ||16845  |                                                  
17075  |            iRowCnt = dlngCnt                     ||16846  |            iRowCnt = dlngCnt                     
17076  |            dlngMeisyoSu = dlngCnt                ||16847  |            dlngMeisyoSu = dlngCnt                
17077  |            TotalNav = ddblTtalnav                ||16848  |            TotalNav = ddblTtalnav                
17078  |            dblValueIn = TotalNav                 ||16849  |            dblValueIn = TotalNav                 
17079  |            Call sbGetRoundValue2(dblValueIn)     ||16850  |            Call sbGetRoundValue2(dblValueIn)     
17080  |            TotalNav = dblValueOut                ||16851  |            TotalNav = dblValueOut                
17081  |                                                  ||16852  |                                                  
17082  |            '計算期間の純資産総額の合計÷計算期間 ||16853  |            '計算期間の純資産総額の合計÷計算期間 
17083  |            dblValueIn = TotalNav / iRowCnt       ||16854  |            dblValueIn = TotalNav / iRowCnt       
17084  |            iCalcNum = iRowCnt                    ||16855  |            iCalcNum = iRowCnt                    
17085  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||16856  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
17086  |                  Call sbGetRoundValue2(dblValueIn||16857  |                  Call sbGetRoundValue2(dblValueIn
17087  |            Else                                  ||16858  |            Else                                  
17088  |                  Call sbGetRoundValue(dblValueIn)||16859  |                  Call sbGetRoundValue(dblValueIn)
17089  |            End If                                ||16860  |            End If                                
17090  |            dstrAvgNav = dblValueOut              ||16861  |            dstrAvgNav = dblValueOut              
17091  |            AvgNav = dstrAvgNav                   ||16862  |            AvgNav = dstrAvgNav                   
17092  |                                                  ||16863  |                                                  
17093  |                                                  ||16864  |                                                  
17094  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||16865  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
17095  |            Call gblnDyClose                      ||16866  |            Call gblnDyClose                      
17096  |                                                  ||16867  |                                                  
17097  |            '合計(月末純資産)                     ||16868  |            '合計(月末純資産)                     
17098  |            .Cells(17, 23).NumberFormatLocal = "@"||16869  |            .Cells(17, 23).NumberFormatLocal = "@"
17099  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||16870  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
17100  |                .Cells(17, 23).Value = CStr(Format||16871  |                .Cells(17, 23).Value = CStr(Format
17101  |            Else                                  ||16872  |            Else                                  
17102  |                .Cells(17, 23).Value = CStr(Format||16873  |                .Cells(17, 23).Value = CStr(Format
17103  |            End If                                ||16874  |            End If                                
17104  |            .Cells(17, 23).HorizontalAlignment = x||16875  |            .Cells(17, 23).HorizontalAlignment = x
17105  |'2006/08/16 START 期中料率変更契約/RAFI対応のため ||16876  |'2006/08/16 START 期中料率変更契約/RAFI対応のため 
17106  |'            '平均純資産総額                      ||16877  |'            '平均純資産総額                      
17107  |'            .Cells(36, 2).Value = sWord51        ||16878  |'            .Cells(36, 2).Value = sWord51        
17108  |'            .Cells(36, 11).Value = sWord19       ||16879  |'            .Cells(36, 11).Value = sWord19       
17109  |'            '計算期間の純資産総額の合計(月末純資 ||16880  |'            '計算期間の純資産総額の合計(月末純資 
17110  |'            .Cells(36, 23).NumberFormatLocal = "@||16881  |'            .Cells(36, 23).NumberFormatLocal = "@
17111  |'              If gbuMGetUPDRec.N(lRecIdx).MGET_ba||16882  |'              If gbuMGetUPDRec.N(lRecIdx).MGET_ba
17112  |'                  .Cells(36, 23).Value = CStr(For||16883  |'                  .Cells(36, 23).Value = CStr(For
17113  |'              Else                               ||16884  |'              Else                               
17114  |'                  .Cells(36, 23).Value = CStr(For||16885  |'                  .Cells(36, 23).Value = CStr(For
17115  |'              End If                             ||16886  |'              End If                             
17116  |'            .Cells(36, 23).HorizontalAlignment = ||16887  |'            .Cells(36, 23).HorizontalAlignment = 
17117  |'            '÷??＝                              ||16888  |'            '÷??＝                              
17118  |'            .Cells(36, 26).Value = sWord18 & "   ||16889  |'            .Cells(36, 26).Value = sWord18 & "   
17119  |'            '計算期間の純資産総額の合計÷計算期間||16890  |'            '計算期間の純資産総額の合計÷計算期間
17120  |'            .Cells(36, 35).NumberFormatLocal = "@||16891  |'            .Cells(36, 35).NumberFormatLocal = "@
17121  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base||16892  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base
17122  |'                .Cells(36, 35).Value = CStr(Forma||16893  |'                .Cells(36, 35).Value = CStr(Forma
17123  |'            Else                                 ||16894  |'            Else                                 
17124  |'                .Cells(36, 35).Value = CStr(Forma||16895  |'                .Cells(36, 35).Value = CStr(Forma
17125  |'            End If                               ||16896  |'            End If                               
17126  |'2006/08/16 END   期中料率変更契約/RAFI対応のため ||16897  |'2006/08/16 END   期中料率変更契約/RAFI対応のため 
17127  |            '平均純資産総額                       ||16898  |            '平均純資産総額                       
17128  |            .Cells(42, 2).Value = sWord51         ||16899  |            .Cells(42, 2).Value = sWord51         
17129  |            .Cells(42, 11).Value = sWord19        ||16900  |            .Cells(42, 11).Value = sWord19        
17130  |            '平均純資産総額は別紙に記載           ||16901  |            '平均純資産総額は別紙に記載           
17131  |            '.Cells(39, 13).Value = sWord54       ||16902  |            '.Cells(39, 13).Value = sWord54       
17132  |            .Cells(42, 13).Value = sWord54        ||16903  |            .Cells(42, 13).Value = sWord54        
17133  |                                                  ||16904  |                                                  
17134  |                                                  ||16905  |                                                  
17135  |            ddblExchangeRate = 0                  ||16906  |            ddblExchangeRate = 0                  
17136  |            '投資顧問料計算用計算対象NAVに日次平均||16907  |            '投資顧問料計算用計算対象NAVに日次平均
17137  |            If dstrAvgNav = "" Then               ||16908  |            If dstrAvgNav = "" Then               
17138  |                lCalcNav = 0                      ||16909  |                lCalcNav = 0                      
17139  |            Else                                  ||16910  |            Else                                  
17140  |                dblValueIn = CDbl(dstrAvgNav)     ||16911  |                dblValueIn = CDbl(dstrAvgNav)     
17141  |                '@@@@@ NAV通貨から閾値通貨に換算 @||16912  |                '@@@@@ NAV通貨から閾値通貨に換算 @
17142  |                Select Case gbuMGetUPDRec.N(lRecId||16913  |                Select Case gbuMGetUPDRec.N(lRecId
17143  |                  Case "1"    '固定料率           ||16914  |                  Case "1"    '固定料率           
17144  |                    If gbuMGetUPDRec.N(lRecIdx).MG||16915  |                    If gbuMGetUPDRec.N(lRecIdx).MG
17145  |                        'NAV通貨→JPYの為替レート ||16916  |                        'NAV通貨→JPYの為替レート 
17146  |                        dstrCurrencyCode = gbuMGet||16917  |                        dstrCurrencyCode = gbuMGet
17147  |                        ddblExchangeRate = fnstrEx||16918  |                        ddblExchangeRate = fnstrEx
17148  |                        If ddblExchangeRate = 0 Th||16919  |                        If ddblExchangeRate = 0 Th
17149  |                          intRtn = MsgBox("ＴＴＭ ||16920  |                          intRtn = MsgBox("ＴＴＭ 
17150  |                          vbLf & "対象通貨コード  ||16921  |                          vbLf & "対象通貨コード  
17151  |                          vbLf & "基準日 ： [ " & ||16922  |                          vbLf & "基準日 ： [ " & 
17152  |                              vbCritical, "ＴＴＭ ||16923  |                              vbCritical, "ＴＴＭ 
17153  |                          Exit Function           ||16924  |                          Exit Function           
17154  |                        End If                    ||16925  |                        End If                    
17155  |                        'NAV通貨→JPYへレート換算 ||16926  |                        'NAV通貨→JPYへレート換算 
17156  |                        dblValueIn = dblValueIn * ||16927  |                        dblValueIn = dblValueIn * 
17157  |                    End If                        ||16928  |                    End If                        
17158  |                  Case "2"    '段階料率           ||16929  |                  Case "2"    '段階料率           
17159  |                    If gbuMGetUPDRec.N(lRecIdx).MG||16930  |                    If gbuMGetUPDRec.N(lRecIdx).MG
17160  |                        If gbuMGetUPDRec.N(lRecIdx||16931  |                        If gbuMGetUPDRec.N(lRecIdx
17161  |                        Else                      ||16932  |                        Else                      
17162  |                            '閾値通貨→JPYの為替レ||16933  |                            '閾値通貨→JPYの為替レ
17163  |                            dstrCurrencyCode = gbu||16934  |                            dstrCurrencyCode = gbu
17164  |                            ddblExchangeRate = fns||16935  |                            ddblExchangeRate = fns
17165  |                            If ddblExchangeRate = ||16936  |                            If ddblExchangeRate = 
17166  |                              intRtn = MsgBox("Ｔ ||16937  |                              intRtn = MsgBox("Ｔ 
17167  |                              vbLf & "対象通貨コー||16938  |                              vbLf & "対象通貨コー
17168  |                              vbLf & "基準日 ： [ ||16939  |                              vbLf & "基準日 ： [ 
17169  |                                  vbCritical, "Ｔ ||16940  |                                  vbCritical, "Ｔ 
17170  |                              Exit Function       ||16941  |                              Exit Function       
17171  |                            End If                ||16942  |                            End If                
17172  |                            'JPY→閾値通貨へレート||16943  |                            'JPY→閾値通貨へレート
17173  |                            dblValueIn = dblValueI||16944  |                            dblValueIn = dblValueI
17174  |                        End If                    ||16945  |                        End If                    
17175  |                    Else                          ||16946  |                    Else                          
17176  |                        'NAV通貨→JPYの為替レート ||16947  |                        'NAV通貨→JPYの為替レート 
17177  |                        dstrCurrencyCode = gbuMGet||16948  |                        dstrCurrencyCode = gbuMGet
17178  |                        ddblExchangeRate = fnstrEx||16949  |                        ddblExchangeRate = fnstrEx
17179  |                        If ddblExchangeRate = 0 Th||16950  |                        If ddblExchangeRate = 0 Th
17180  |                          intRtn = MsgBox("ＴＴＭ ||16951  |                          intRtn = MsgBox("ＴＴＭ 
17181  |                          vbLf & "対象通貨コード  ||16952  |                          vbLf & "対象通貨コード  
17182  |                          vbLf & "基準日 ： [ " & ||16953  |                          vbLf & "基準日 ： [ " & 
17183  |                              vbCritical, "ＴＴＭ ||16954  |                              vbCritical, "ＴＴＭ 
17184  |                          Exit Function           ||16955  |                          Exit Function           
17185  |                        End If                    ||16956  |                        End If                    
17186  |                        'NAV通貨→JPYへレート換算 ||16957  |                        'NAV通貨→JPYへレート換算 
17187  |                        dblValueIn = dblValueIn * ||16958  |                        dblValueIn = dblValueIn * 
17188  |                        If gbuMGetUPDRec.N(lRecIdx||16959  |                        If gbuMGetUPDRec.N(lRecIdx
17189  |                        Else                      ||16960  |                        Else                      
17190  |                            '閾値通貨→JPYの為替レ||16961  |                            '閾値通貨→JPYの為替レ
17191  |                            dstrCurrencyCode = gbu||16962  |                            dstrCurrencyCode = gbu
17192  |                            ddblExchangeRate = fns||16963  |                            ddblExchangeRate = fns
17193  |                            If ddblExchangeRate = ||16964  |                            If ddblExchangeRate = 
17194  |                              intRtn = MsgBox("Ｔ ||16965  |                              intRtn = MsgBox("Ｔ 
17195  |                              vbLf & "対象通貨コー||16966  |                              vbLf & "対象通貨コー
17196  |                              vbLf & "基準日 ： [ ||16967  |                              vbLf & "基準日 ： [ 
17197  |                                  vbCritical, "Ｔ ||16968  |                                  vbCritical, "Ｔ 
17198  |                              Exit Function       ||16969  |                              Exit Function       
17199  |                            End If                ||16970  |                            End If                
17200  |                            'JPY→閾値通貨へ逆レー||16971  |                            'JPY→閾値通貨へ逆レー
17201  |                            dblValueIn = dblValueI||16972  |                            dblValueIn = dblValueI
17202  |                        End If                    ||16973  |                        End If                    
17203  |                    End If                        ||16974  |                    End If                        
17204  |                End Select                        ||16975  |                End Select                        
17205  |                '@@@@@ NAV通貨から閾値通貨に換算 @||16976  |                '@@@@@ NAV通貨から閾値通貨に換算 @
17206  |                Call sbGetRoundValue2(dblValueIn) ||16977  |                Call sbGetRoundValue2(dblValueIn) 
17207  |                '閾値レート換算後平均NAV(計算対象N||16978  |                '閾値レート換算後平均NAV(計算対象N
17208  |                lCalcNav = CStr(Format(dblValueOut||16979  |                lCalcNav = CStr(Format(dblValueOut
17209  |            End If                                ||16980  |            End If                                
17210  |                                                  ||16981  |                                                  
17211  |On Error Resume Next                              ||16982  |On Error Resume Next                              
17212  |        End If                                    ||16983  |        End If                                    
17213  |                                                  ||16984  |                                                  
17214  |        '投資顧問料                               ||16985  |        '投資顧問料                               
17215  |        Dim dRitsu As Double    '外部委託顧問料率 ||16986  |        Dim dRitsu As Double    '外部委託顧問料率 
17216  |        dRitsu = 0                                ||16987  |        dRitsu = 0                                
17217  |        TotalRate = 0                             ||16988  |        TotalRate = 0                             
17218  |        ddblExchangeRate = 0                      ||16989  |        ddblExchangeRate = 0                      
17219  |        '計算対象NAVを変数にセット                ||16990  |        '計算対象NAVを変数にセット                
17220  |        lCalcNav = 0                              ||16991  |        lCalcNav = 0                              
17221  |        dblValueIn = TotalNav / iRowCnt           ||16992  |        dblValueIn = TotalNav / iRowCnt           
17222  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    ||16993  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    
17223  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||16994  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
17224  |          Case "1"    '固定料率(固定料率の場合は、||16995  |          Case "1"    '固定料率(固定料率の場合は、
17225  |              'NAV通貨と外部委託顧問料通貨が相違  ||16996  |              'NAV通貨と外部委託顧問料通貨が相違  
17226  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||16997  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
17227  |                'NAV通貨→JPYの為替レートを取得   ||16998  |                'NAV通貨→JPYの為替レートを取得   
17228  |                dstrCurrencyCode = gbuMGetUPDRec.N||16999  |                dstrCurrencyCode = gbuMGetUPDRec.N
17229  |                ddblExchangeRate = fnstrExchangeRa||17000  |                ddblExchangeRate = fnstrExchangeRa
17230  |                If ddblExchangeRate = 0 Then      ||17001  |                If ddblExchangeRate = 0 Then      
17231  |                  intRtn = MsgBox("ＴＴＭが取得で ||17002  |                  intRtn = MsgBox("ＴＴＭが取得で 
17232  |                  vbLf & "対象通貨コード ： [ " & ||17003  |                  vbLf & "対象通貨コード ： [ " & 
17233  |                  vbLf & "基準日 ： [ " & Mid(dstr||17004  |                  vbLf & "基準日 ： [ " & Mid(dstr
17234  |                      vbCritical, "ＴＴＭ取得エラ ||17005  |                      vbCritical, "ＴＴＭ取得エラ 
17235  |                  Exit Function                   ||17006  |                  Exit Function                   
17236  |                End If                            ||17007  |                End If                            
17237  |'                'NAV通貨→JPYへレート換算        ||17008  |'                'NAV通貨→JPYへレート換算        
17238  |'                dblValueIn = dblValueIn * ddblExc||17009  |'                dblValueIn = dblValueIn * ddblExc
17239  |                For i = LBound(gtypOtherComRec) To||17010  |                For i = LBound(gtypOtherComRec) To
17240  |                    'NAV通貨→JPYへレート換算     ||17011  |                    'NAV通貨→JPYへレート換算     
17241  |                    gtypOtherComRec(i).APPLY_NAV_A||17012  |                    gtypOtherComRec(i).APPLY_NAV_A
17242  |                Next i                            ||17013  |                Next i                            
17243  |            End If                                ||17014  |            End If                                
17244  |                                                  ||17015  |                                                  
17245  |          Case "2"    '段階料率                   ||17016  |          Case "2"    '段階料率                   
17246  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||17017  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
17247  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||17018  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
17248  |                Else                              ||17019  |                Else                              
17249  |                    '閾値通貨→JPYの為替レートを取||17020  |                    '閾値通貨→JPYの為替レートを取
17250  |                    dstrCurrencyCode = gbuMGetUPDR||17021  |                    dstrCurrencyCode = gbuMGetUPDR
17251  |                    ddblExchangeRate = fnstrExchan||17022  |                    ddblExchangeRate = fnstrExchan
17252  |                    If ddblExchangeRate = 0 Then  ||17023  |                    If ddblExchangeRate = 0 Then  
17253  |                      intRtn = MsgBox("ＴＴＭが取 ||17024  |                      intRtn = MsgBox("ＴＴＭが取 
17254  |                      vbLf & "対象通貨コード ： [ ||17025  |                      vbLf & "対象通貨コード ： [ 
17255  |                      vbLf & "基準日 ： [ " & Mid(||17026  |                      vbLf & "基準日 ： [ " & Mid(
17256  |                          vbCritical, "ＴＴＭ取得 ||17027  |                          vbCritical, "ＴＴＭ取得 
17257  |                      Exit Function               ||17028  |                      Exit Function               
17258  |                    End If                        ||17029  |                    End If                        
17259  |'                    'JPY→閾値通貨へレート換算   ||17030  |'                    'JPY→閾値通貨へレート換算   
17260  |'                    dblValueIn = dblValueIn * ddb||17031  |'                    dblValueIn = dblValueIn * ddb
17261  |                    For i = LBound(gtypOtherComRec||17032  |                    For i = LBound(gtypOtherComRec
17262  |                        'NAV通貨→JPYへレート換算 ||17033  |                        'NAV通貨→JPYへレート換算 
17263  |                        gtypOtherComRec(i).APPLY_N||17034  |                        gtypOtherComRec(i).APPLY_N
17264  |                    Next i                        ||17035  |                    Next i                        
17265  |                End If                            ||17036  |                End If                            
17266  |            Else                                  ||17037  |            Else                                  
17267  |                'NAV通貨→JPYの為替レートを取得   ||17038  |                'NAV通貨→JPYの為替レートを取得   
17268  |                dstrCurrencyCode = gbuMGetUPDRec.N||17039  |                dstrCurrencyCode = gbuMGetUPDRec.N
17269  |                ddblExchangeRate = fnstrExchangeRa||17040  |                ddblExchangeRate = fnstrExchangeRa
17270  |                If ddblExchangeRate = 0 Then      ||17041  |                If ddblExchangeRate = 0 Then      
17271  |                  intRtn = MsgBox("ＴＴＭが取得で ||17042  |                  intRtn = MsgBox("ＴＴＭが取得で 
17272  |                  vbLf & "対象通貨コード ： [ " & ||17043  |                  vbLf & "対象通貨コード ： [ " & 
17273  |                  vbLf & "基準日 ： [ " & Mid(dstr||17044  |                  vbLf & "基準日 ： [ " & Mid(dstr
17274  |                      vbCritical, "ＴＴＭ取得エラ ||17045  |                      vbCritical, "ＴＴＭ取得エラ 
17275  |                  Exit Function                   ||17046  |                  Exit Function                   
17276  |                End If                            ||17047  |                End If                            
17277  |'                'NAV通貨→JPYへレート換算        ||17048  |'                'NAV通貨→JPYへレート換算        
17278  |'                dblValueIn = dblValueIn * ddblExc||17049  |'                dblValueIn = dblValueIn * ddblExc
17279  |                For i = LBound(gtypOtherComRec) To||17050  |                For i = LBound(gtypOtherComRec) To
17280  |                    'NAV通貨→JPYへレート換算     ||17051  |                    'NAV通貨→JPYへレート換算     
17281  |                    gtypOtherComRec(i).APPLY_NAV_A||17052  |                    gtypOtherComRec(i).APPLY_NAV_A
17282  |                Next i                            ||17053  |                Next i                            
17283  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||17054  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
17284  |                Else                              ||17055  |                Else                              
17285  |                    '閾値通貨→JPYの為替レートを取||17056  |                    '閾値通貨→JPYの為替レートを取
17286  |                    dstrCurrencyCode = gbuMGetUPDR||17057  |                    dstrCurrencyCode = gbuMGetUPDR
17287  |                    ddblExchangeRate = fnstrExchan||17058  |                    ddblExchangeRate = fnstrExchan
17288  |                    If ddblExchangeRate = 0 Then  ||17059  |                    If ddblExchangeRate = 0 Then  
17289  |                      intRtn = MsgBox("ＴＴＭが取 ||17060  |                      intRtn = MsgBox("ＴＴＭが取 
17290  |                      vbLf & "対象通貨コード ： [ ||17061  |                      vbLf & "対象通貨コード ： [ 
17291  |                      vbLf & "基準日 ： [ " & Mid(||17062  |                      vbLf & "基準日 ： [ " & Mid(
17292  |                          vbCritical, "ＴＴＭ取得 ||17063  |                          vbCritical, "ＴＴＭ取得 
17293  |                      Exit Function               ||17064  |                      Exit Function               
17294  |                    End If                        ||17065  |                    End If                        
17295  |'                    'JPY→閾値通貨へ逆レート換算 ||17066  |'                    'JPY→閾値通貨へ逆レート換算 
17296  |'                    dblValueIn = dblValueIn / ddb||17067  |'                    dblValueIn = dblValueIn / ddb
17297  |                    For i = LBound(gtypOtherComRec||17068  |                    For i = LBound(gtypOtherComRec
17298  |                        'NAV通貨→JPYへレート換算 ||17069  |                        'NAV通貨→JPYへレート換算 
17299  |                        gtypOtherComRec(i).APPLY_N||17070  |                        gtypOtherComRec(i).APPLY_N
17300  |                    Next i                        ||17071  |                    Next i                        
17301  |                End If                            ||17072  |                End If                            
17302  |            End If                                ||17073  |            End If                                
17303  |        End Select                                ||17074  |        End Select                                
17304  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    ||17075  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    
17305  |'        Call sbGetRoundValue2(dblValueIn)        ||17076  |'        Call sbGetRoundValue2(dblValueIn)        
17306  |'        lCalcNav = CStr(Format(dblValueOut, "#,##||17077  |'        lCalcNav = CStr(Format(dblValueOut, "#,##
17307  |        For i = LBound(gtypOtherComRec) To UBound(||17078  |        For i = LBound(gtypOtherComRec) To UBound(
17308  |            Call sbGetRoundValue2(gtypOtherComRec(||17079  |            Call sbGetRoundValue2(gtypOtherComRec(
17309  |            gtypOtherComRec(i).APPLY_NAV_AVG = CSt||17080  |            gtypOtherComRec(i).APPLY_NAV_AVG = CSt
17310  |        Next i                                    ||17081  |        Next i                                    
17311  |                                                  ||17082  |                                                  
17312  |        '固定料率                                 ||17083  |        '固定料率                                 
17313  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat||17084  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat
17314  |'期中料率変更契約対応 START                       ||17085  |'期中料率変更契約対応 START                       
17315  |'            '単一料率の場合                      ||17086  |'            '単一料率の場合                      
17316  |'            If KityuFlg = False Then             ||17087  |'            If KityuFlg = False Then             
17317  |'                '計算対称NAV × 外部委託顧問料率 ||17088  |'                '計算対称NAV × 外部委託顧問料率 
17318  |'                dRitsu = CDbl(gbuOtherComRateGetU||17089  |'                dRitsu = CDbl(gbuOtherComRateGetU
17319  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||17090  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
17320  |'                Or gbuMGetUPDRec.N(lRecIdx).MGET_||17091  |'                Or gbuMGetUPDRec.N(lRecIdx).MGET_
17321  |'                    '一年間の日数：365日またはカ ||17092  |'                    '一年間の日数：365日またはカ 
17322  |'                    dblValueIn = lCalcNav * dRits||17093  |'                    dblValueIn = lCalcNav * dRits
17323  |'                Else                             ||17094  |'                Else                             
17324  |'                    '一年間の日数：360日         ||17095  |'                    '一年間の日数：360日         
17325  |'                    dblValueIn = lCalcNav * dRits||17096  |'                    dblValueIn = lCalcNav * dRits
17326  |'                End If                           ||17097  |'                End If                           
17327  |            '期中料率変更契約の場合               ||17098  |            '期中料率変更契約の場合               
17328  |            dblValueIn = 0                        ||17099  |            dblValueIn = 0                        
17329  |            '一年間の日数：365日またはカレンダー  ||17100  |            '一年間の日数：365日またはカレンダー  
17330  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_||17101  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_
17331  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_||17102  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_
17332  |                '計算対称NAV × 期中外部委託顧問料||17103  |                '計算対称NAV × 期中外部委託顧問料
17333  |                For i = LBound(gtypOtherComRec) To||17104  |                For i = LBound(gtypOtherComRec) To
17334  |                    For J = LBound(gtypOtherComRec||17105  |                    For J = LBound(gtypOtherComRec
17335  |                        gtypOtherComRec(i).APPLY_P||17106  |                        gtypOtherComRec(i).APPLY_P
17336  |                        gtypOtherComRec(i).APPLY_N||17107  |                        gtypOtherComRec(i).APPLY_N
17337  |                        gtypOtherComRec(i).APPLY_O||17108  |                        gtypOtherComRec(i).APPLY_O
17338  |                        gtypOtherComRec(i).APPLY_C||17109  |                        gtypOtherComRec(i).APPLY_C
17339  |                    Next J                        ||17110  |                    Next J                        
17340  |                Next i                            ||17111  |                Next i                            
17341  |            '一年間の日数：360日                  ||17112  |            '一年間の日数：360日                  
17342  |            Else                                  ||17113  |            Else                                  
17343  |                '計算対称NAV × 期中外部委託顧問料||17114  |                '計算対称NAV × 期中外部委託顧問料
17344  |                For i = LBound(gtypOtherComRec) To||17115  |                For i = LBound(gtypOtherComRec) To
17345  |                    For J = LBound(gtypOtherComRec||17116  |                    For J = LBound(gtypOtherComRec
17346  |                        gtypOtherComRec(i).APPLY_P||17117  |                        gtypOtherComRec(i).APPLY_P
17347  |                        gtypOtherComRec(i).APPLY_N||17118  |                        gtypOtherComRec(i).APPLY_N
17348  |                        gtypOtherComRec(i).APPLY_O||17119  |                        gtypOtherComRec(i).APPLY_O
17349  |                        gtypOtherComRec(i).APPLY_C||17120  |                        gtypOtherComRec(i).APPLY_C
17350  |                    Next J                        ||17121  |                    Next J                        
17351  |                Next i                            ||17122  |                Next i                            
17352  |            End If                                ||17123  |            End If                                
17353  |            '料率別顧問料を集計する               ||17124  |            '料率別顧問料を集計する               
17354  |            For i = LBound(gtypOtherComRec) To UBo||17125  |            For i = LBound(gtypOtherComRec) To UBo
17355  |                dblValueIn = dblValueIn + gtypOthe||17126  |                dblValueIn = dblValueIn + gtypOthe
17356  |            Next i                                ||17127  |            Next i                                
17357  |                                                  ||17128  |                                                  
17358  |'期中料率変更契約対応 END                         ||17129  |'期中料率変更契約対応 END                         
17359  |                                                  ||17130  |                                                  
17360  |        '段階料率                                 ||17131  |        '段階料率                                 
17361  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other||17132  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other
17362  |'期中料率変更契約対応 START                       ||17133  |'期中料率変更契約対応 START                       
17363  |'            '単一料率の場合                      ||17134  |'            '単一料率の場合                      
17364  |'            '料率分ループ処理                    ||17135  |'            '料率分ループ処理                    
17365  |'            For i = LBound(gbuOtherComRateGetUPDR||17136  |'            For i = LBound(gbuOtherComRateGetUPDR
17366  |'                TotalRate = TotalRate + CCur(gbuO||17137  |'                TotalRate = TotalRate + CCur(gbuO
17367  |'                cRate = CCur(gbuOtherComRateGetUP||17138  |'                cRate = CCur(gbuOtherComRateGetUP
17368  |'                dRitsu = CDbl(gbuOtherComRateGetU||17139  |'                dRitsu = CDbl(gbuOtherComRateGetU
17369  |'                If i = UBound(gbuOtherComRateGetU||17140  |'                If i = UBound(gbuOtherComRateGetU
17370  |'                    '(前回閾値)：累積閾値 = WORK ||17141  |'                    '(前回閾値)：累積閾値 = WORK 
17371  |'                    TotalRate = WorkRate         ||17142  |'                    TotalRate = WorkRate         
17372  |'                ElseIf TotalRate <= lCalcNav Then||17143  |'                ElseIf TotalRate <= lCalcNav Then
17373  |'                    '累積投資顧問料 = 累積投資顧 ||17144  |'                    '累積投資顧問料 = 累積投資顧 
17374  |'                    dblValueIn = cRate * dRitsu /||17145  |'                    dblValueIn = cRate * dRitsu /
17375  |'                    Call sbGetRoundValue2(dblValu||17146  |'                    Call sbGetRoundValue2(dblValu
17376  |'                    TotalCom = TotalCom + dblValu||17147  |'                    TotalCom = TotalCom + dblValu
17377  |'                Else                             ||17148  |'                Else                             
17378  |'                    '(前回閾値)：累積閾値 = WORK ||17149  |'                    '(前回閾値)：累積閾値 = WORK 
17379  |'                    TotalRate = WorkRate         ||17150  |'                    TotalRate = WorkRate         
17380  |'                    Exit For                     ||17151  |'                    Exit For                     
17381  |'                End If                           ||17152  |'                End If                           
17382  |'                '累積閾値をWORKに格納(一つ前の閾 ||17153  |'                '累積閾値をWORKに格納(一つ前の閾 
17383  |'                WorkRate = TotalRate             ||17154  |'                WorkRate = TotalRate             
17384  |'            Next i                               ||17155  |'            Next i                               
17385  |'            '累積投資顧問料 = 累積投資顧問料 + ( ||17156  |'            '累積投資顧問料 = 累積投資顧問料 + ( 
17386  |'            dblValueIn = (lCalcNav - TotalRate) *||17157  |'            dblValueIn = (lCalcNav - TotalRate) *
17387  |'            TotalCom = TotalCom + dblValueIn     ||17158  |'            TotalCom = TotalCom + dblValueIn     
17388  |'            '投資顧問料 = 累積投資顧問料 × 計算 ||17159  |'            '投資顧問料 = 累積投資顧問料 × 計算 
17389  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days||17160  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_days
17390  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days||17161  |'            Or gbuMGetUPDRec.N(lRecIdx).MGET_days
17391  |'                '一年間の日数：365日またはカレン ||17162  |'                '一年間の日数：365日またはカレン 
17392  |'                dblValueIn = TotalCom * iCalcNum ||17163  |'                dblValueIn = TotalCom * iCalcNum 
17393  |'            Else                                 ||17164  |'            Else                                 
17394  |'                '一年間の日数：360日             ||17165  |'                '一年間の日数：360日             
17395  |'                dblValueIn = TotalCom * iCalcNum ||17166  |'                dblValueIn = TotalCom * iCalcNum 
17396  |'            End If                               ||17167  |'            End If                               
17397  |        '期中料率変更契約の場合                   ||17168  |        '期中料率変更契約の場合                   
17398  |            For i = LBound(gtypOtherComRec) To UBo||17169  |            For i = LBound(gtypOtherComRec) To UBo
17399  |                TotalRate = 0                     ||17170  |                TotalRate = 0                     
17400  |                TotalCom = 0                      ||17171  |                TotalCom = 0                      
17401  |'2008/03/03 START NAVが閾値を超えない場合、累積投 ||17172  |'2008/03/03 START NAVが閾値を超えない場合、累積投 
17402  |                WorkRate = 0                      ||17173  |                WorkRate = 0                      
17403  |'2008/03/03 END   NAVが閾値を超えない場合、累積投 ||17174  |'2008/03/03 END   NAVが閾値を超えない場合、累積投 
17404  |                For J = LBound(gtypOtherComRec(i).||17175  |                For J = LBound(gtypOtherComRec(i).
17405  |                    TotalRate = TotalRate + CCur(g||17176  |                    TotalRate = TotalRate + CCur(g
17406  |                    cRate = CCur(gtypOtherComRec(i||17177  |                    cRate = CCur(gtypOtherComRec(i
17407  |                    dRitsu = CDbl(gtypOtherComRec(||17178  |                    dRitsu = CDbl(gtypOtherComRec(
17408  |                    If J = UBound(gtypOtherComRec(||17179  |                    If J = UBound(gtypOtherComRec(
17409  |                        '(前回閾値)：累積閾値 = WO||17180  |                        '(前回閾値)：累積閾値 = WO
17410  |                        TotalRate = WorkRate      ||17181  |                        TotalRate = WorkRate      
17411  |                    ElseIf TotalRate <= gtypOtherC||17182  |                    ElseIf TotalRate <= gtypOtherC
17412  |                        '累積投資顧問料 = 累積投資||17183  |                        '累積投資顧問料 = 累積投資
17413  |                        dblValueIn = cRate * dRits||17184  |                        dblValueIn = cRate * dRits
17414  |                        Call sbGetRoundValue2(dblV||17185  |                        Call sbGetRoundValue2(dblV
17415  |                        TotalCom = TotalCom + dblV||17186  |                        TotalCom = TotalCom + dblV
17416  |                    Else                          ||17187  |                    Else                          
17417  |                        '(前回閾値)：累積閾値 = WO||17188  |                        '(前回閾値)：累積閾値 = WO
17418  |                        TotalRate = WorkRate      ||17189  |                        TotalRate = WorkRate      
17419  |                        Exit For                  ||17190  |                        Exit For                  
17420  |                    End If                        ||17191  |                    End If                        
17421  |                    '累積閾値をWORKに格納(一つ前の||17192  |                    '累積閾値をWORKに格納(一つ前の
17422  |                    WorkRate = TotalRate          ||17193  |                    WorkRate = TotalRate          
17423  |                Next J                            ||17194  |                Next J                            
17424  |                '累積投資顧問料 = 累積投資顧問料 +||17195  |                '累積投資顧問料 = 累積投資顧問料 +
17425  |                dblValueIn = (gtypOtherComRec(i).A||17196  |                dblValueIn = (gtypOtherComRec(i).A
17426  |                TotalCom = TotalCom + dblValueIn  ||17197  |                TotalCom = TotalCom + dblValueIn  
17427  |                '投資顧問料 = 累積投資顧問料 × 計||17198  |                '投資顧問料 = 累積投資顧問料 × 計
17428  |                If gbuMGetUPDRec.N(lRecIdx).MGET_d||17199  |                If gbuMGetUPDRec.N(lRecIdx).MGET_d
17429  |                Or gbuMGetUPDRec.N(lRecIdx).MGET_d||17200  |                Or gbuMGetUPDRec.N(lRecIdx).MGET_d
17430  |                    '一年間の日数：365日またはカレ||17201  |                    '一年間の日数：365日またはカレ
17431  |                    gtypOtherComRec(i).APPLY_PAY_C||17202  |                    gtypOtherComRec(i).APPLY_PAY_C
17432  |                Else                              ||17203  |                Else                              
17433  |                    '一年間の日数：360日          ||17204  |                    '一年間の日数：360日          
17434  |                    gtypOtherComRec(i).APPLY_PAY_C||17205  |                    gtypOtherComRec(i).APPLY_PAY_C
17435  |                End If                            ||17206  |                End If                            
17436  |            Next i                                ||17207  |            Next i                                
17437  |            '外部委託顧問料変数を初期化           ||17208  |            '外部委託顧問料変数を初期化           
17438  |            dblValueIn = 0                        ||17209  |            dblValueIn = 0                        
17439  |            'トータル顧問料をセット               ||17210  |            'トータル顧問料をセット               
17440  |            For i = LBound(gtypOtherComRec) To UBo||17211  |            For i = LBound(gtypOtherComRec) To UBo
17441  |                dblValueIn = dblValueIn + gtypOthe||17212  |                dblValueIn = dblValueIn + gtypOthe
17442  |            Next i                                ||17213  |            Next i                                
17443  |'期中料率変更契約対応 END                         ||17214  |'期中料率変更契約対応 END                         
17444  |        End If                                    ||17215  |        End If                                    
17445  |        ddblExchangeRate = 0                      ||17216  |        ddblExchangeRate = 0                      
17446  |        '@@@@@ 外部委託顧問料に換算 @@@@@         ||17217  |        '@@@@@ 外部委託顧問料に換算 @@@@@         
17447  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||17218  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
17448  |          Case "1"    '固定料率                   ||17219  |          Case "1"    '固定料率                   
17449  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o||17220  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o
17450  |                Else                              ||17221  |                Else                              
17451  |                  '外部委託顧問料通貨→JPYの為替レ||17222  |                  '外部委託顧問料通貨→JPYの為替レ
17452  |                  dstrCurrencyCode = gbuMGetUPDRec||17223  |                  dstrCurrencyCode = gbuMGetUPDRec
17453  |                  ddblExchangeRate = fnstrExchange||17224  |                  ddblExchangeRate = fnstrExchange
17454  |                  If ddblExchangeRate = 0 Then    ||17225  |                  If ddblExchangeRate = 0 Then    
17455  |                    intRtn = MsgBox("ＴＴＭが取得 ||17226  |                    intRtn = MsgBox("ＴＴＭが取得 
17456  |                    vbLf & "対象通貨コード ： [ " ||17227  |                    vbLf & "対象通貨コード ： [ " 
17457  |                    vbLf & "基準日 ： [ " & Mid(ds||17228  |                    vbLf & "基準日 ： [ " & Mid(ds
17458  |                        vbCritical, "ＴＴＭ取得エ ||17229  |                        vbCritical, "ＴＴＭ取得エ 
17459  |                    Exit Function                 ||17230  |                    Exit Function                 
17460  |                  End If                          ||17231  |                  End If                          
17461  |                  'JPY→閾値通貨へ逆レート換算    ||17232  |                  'JPY→閾値通貨へ逆レート換算    
17462  |                  dblValueIn = dblValueIn / ddblEx||17233  |                  dblValueIn = dblValueIn / ddblEx
17463  |                End If                            ||17234  |                End If                            
17464  |          Case "2"    '段階料率                   ||17235  |          Case "2"    '段階料率                   
17465  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||17236  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
17466  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||17237  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
17467  |                Else                              ||17238  |                Else                              
17468  |                    '閾値通貨→JPYの為替レートを取||17239  |                    '閾値通貨→JPYの為替レートを取
17469  |                    dstrCurrencyCode = gbuMGetUPDR||17240  |                    dstrCurrencyCode = gbuMGetUPDR
17470  |                    ddblExchangeRate = fnstrExchan||17241  |                    ddblExchangeRate = fnstrExchan
17471  |                    'JPY→閾値通貨へ逆レート換算  ||17242  |                    'JPY→閾値通貨へ逆レート換算  
17472  |                    dblValueIn = dblValueIn / ddbl||17243  |                    dblValueIn = dblValueIn / ddbl
17473  |                End If                            ||17244  |                End If                            
17474  |            Else                                  ||17245  |            Else                                  
17475  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||17246  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
17476  |                    '外部委託顧問料通貨→JPYの為替||17247  |                    '外部委託顧問料通貨→JPYの為替
17477  |                    dstrCurrencyCode = gbuMGetUPDR||17248  |                    dstrCurrencyCode = gbuMGetUPDR
17478  |                    ddblExchangeRate = fnstrExchan||17249  |                    ddblExchangeRate = fnstrExchan
17479  |                    'JPY→閾値通貨へレート換算    ||17250  |                    'JPY→閾値通貨へレート換算    
17480  |                    dblValueIn = dblValueIn / ddbl||17251  |                    dblValueIn = dblValueIn / ddbl
17481  |                Else                              ||17252  |                Else                              
17482  |                    '閾値通貨→JPYの為替レートを取||17253  |                    '閾値通貨→JPYの為替レートを取
17483  |                    dstrCurrencyCode = gbuMGetUPDR||17254  |                    dstrCurrencyCode = gbuMGetUPDR
17484  |                    ddblExchangeRate = fnstrExchan||17255  |                    ddblExchangeRate = fnstrExchan
17485  |                    'JPY→閾値通貨へ逆レート換算  ||17256  |                    'JPY→閾値通貨へ逆レート換算  
17486  |                    dblValueIn = dblValueIn * ddbl||17257  |                    dblValueIn = dblValueIn * ddbl
17487  |                    '外部委託顧問料通貨→JPYの為替||17258  |                    '外部委託顧問料通貨→JPYの為替
17488  |                    dstrCurrencyCode = gbuMGetUPDR||17259  |                    dstrCurrencyCode = gbuMGetUPDR
17489  |                    ddblExchangeRate = fnstrExchan||17260  |                    ddblExchangeRate = fnstrExchan
17490  |                    'JPY→閾値通貨へ逆レート換算  ||17261  |                    'JPY→閾値通貨へ逆レート換算  
17491  |                    dblValueIn = dblValueIn / ddbl||17262  |                    dblValueIn = dblValueIn / ddbl
17492  |                End If                            ||17263  |                End If                            
17493  |            End If                                ||17264  |            End If                                
17494  |        End Select                                ||17265  |        End Select                                
17495  |        '@@@@@ 外部委託顧問料に換算 @@@@@         ||17266  |        '@@@@@ 外部委託顧問料に換算 @@@@@         
17496  |        Call sbGetRoundValue2(dblValueIn)         ||17267  |        Call sbGetRoundValue2(dblValueIn)         
17497  |        mstrMonthlyPayCom = dblValueOut           ||17268  |        mstrMonthlyPayCom = dblValueOut           
17498  |'期中料率変更契約対応 START                       ||17269  |'期中料率変更契約対応 START                       
17499  |        ': ,文言                                  ||17270  |        ': ,文言                                  
17500  |        '.Cells(39, 11).Value = sWord19           ||17271  |        '.Cells(39, 11).Value = sWord19           
17501  |        .Cells(44, 11).Value = sWord19            ||17272  |        .Cells(44, 11).Value = sWord19            
17502  |        '年率 ,文言                               ||17273  |        '年率 ,文言                               
17503  |        '.Cells(39, 2).Value = sWord10            ||17274  |        '.Cells(39, 2).Value = sWord10            
17504  |        .Cells(44, 2).Value = sWord10             ||17275  |        .Cells(44, 2).Value = sWord10             
17505  |        TotalRate = 0                             ||17276  |        TotalRate = 0                             
17506  |        '年率は別紙に記載                         ||17277  |        '年率は別紙に記載                         
17507  |        '.Cells(39, 13).Value = sWord54           ||17278  |        '.Cells(39, 13).Value = sWord54           
17508  |        .Cells(44, 13).Value = sWord54            ||17279  |        .Cells(44, 13).Value = sWord54            
17509  |'期中料率変更契約対応 END                         ||17280  |'期中料率変更契約対応 END                         
17510  |                                                  ||17281  |                                                  
17511  |        '投資顧問料                               ||17282  |        '投資顧問料                               
17512  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||17283  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
17513  |            Case Mid(mstrContractFlag(1), 1, 1)   ||17284  |            Case Mid(mstrContractFlag(1), 1, 1)   
17514  |                .Cells(46, 2).Value = sWord11a    ||17285  |                .Cells(46, 2).Value = sWord11a    
17515  |            Case Mid(mstrContractFlag(2), 1, 1)   ||17286  |            Case Mid(mstrContractFlag(2), 1, 1)   
17516  |                .Cells(46, 2).Value = sWord11b    ||17287  |                .Cells(46, 2).Value = sWord11b    
17517  |            Case Mid(mstrContractFlag(3), 1, 1)   ||17288  |            Case Mid(mstrContractFlag(3), 1, 1)   
17518  |                .Cells(46, 2).Value = sWord11c    ||17289  |                .Cells(46, 2).Value = sWord11c    
17519  |            Case Else                             ||17290  |            Case Else                             
17520  |                MsgBox "契約区分が不正です。", vbC||17291  |                MsgBox "契約区分が不正です。", vbC
17521  |        End Select                                ||17292  |        End Select                                
17522  |        .Cells(46, 11).Value = sWord19            ||17293  |        .Cells(46, 11).Value = sWord19            
17523  |        '外部委託顧問料                           ||17294  |        '外部委託顧問料                           
17524  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||17295  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
17525  |            .Cells(46, 31).NumberFormatLocal = "@"||17296  |            .Cells(46, 31).NumberFormatLocal = "@"
17526  |        Else                                      ||17297  |        Else                                      
17527  |            .Cells(46, 29).NumberFormatLocal = "@"||17298  |            .Cells(46, 29).NumberFormatLocal = "@"
17528  |        End If                                    ||17299  |        End If                                    
17529  |        '契約区分が名称使用許諾料の場合上限・下限 ||17300  |        '契約区分が名称使用許諾料の場合上限・下限 
17530  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||17301  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
17531  |            '下限金額より換算した金額が小さい場合 ||17302  |            '下限金額より換算した金額が小さい場合 
17532  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_f||17303  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_f
17533  |                If mstrMonthlyPayCom < CDbl(gbuMGe||17304  |                If mstrMonthlyPayCom < CDbl(gbuMGe
17534  |                    mstrMonthlyPayCom = CDbl(gbuMG||17305  |                    mstrMonthlyPayCom = CDbl(gbuMG
17535  |                End If                            ||17306  |                End If                            
17536  |            End If                                ||17307  |            End If                                
17537  |            '上限金額より換算した金額が大きい場合 ||17308  |            '上限金額より換算した金額が大きい場合 
17538  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_c||17309  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_c
17539  |                If mstrMonthlyPayCom > CDbl(gbuMGe||17310  |                If mstrMonthlyPayCom > CDbl(gbuMGe
17540  |                    mstrMonthlyPayCom = CDbl(gbuMG||17311  |                    mstrMonthlyPayCom = CDbl(gbuMG
17541  |                End If                            ||17312  |                End If                            
17542  |            End If                                ||17313  |            End If                                
17543  |            dblValueIn = CDbl(mstrMonthlyPayCom)  ||17314  |            dblValueIn = CDbl(mstrMonthlyPayCom)  
17544  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||17315  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
17545  |                Call sbGetRoundValue2(dblValueIn) ||17316  |                Call sbGetRoundValue2(dblValueIn) 
17546  |            Else                                  ||17317  |            Else                                  
17547  |                Call sbGetRoundValue(dblValueIn)  ||17318  |                Call sbGetRoundValue(dblValueIn)  
17548  |            End If                                ||17319  |            End If                                
17549  |            mstrMonthlyPayCom = dblValueOut       ||17320  |            mstrMonthlyPayCom = dblValueOut       
17550  |        End If                                    ||17321  |        End If                                    
17551  |        '外部委託顧問料通貨                       ||17322  |        '外部委託顧問料通貨                       
17552  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||17323  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
17553  |            Case cAud                             ||17324  |            Case cAud                             
17554  |                .Cells(46, 31).Value = CStr(Format||17325  |                .Cells(46, 31).Value = CStr(Format
17555  |                .Cells(46, 32).Value = sAud       ||17326  |                .Cells(46, 32).Value = sAud       
17556  |            Case cCad                             ||17327  |            Case cCad                             
17557  |                .Cells(46, 31).Value = CStr(Format||17328  |                .Cells(46, 31).Value = CStr(Format
17558  |                .Cells(46, 32).Value = sCad       ||17329  |                .Cells(46, 32).Value = sCad       
17559  |            Case cChf                             ||17330  |            Case cChf                             
17560  |                .Cells(46, 31).Value = CStr(Format||17331  |                .Cells(46, 31).Value = CStr(Format
17561  |                .Cells(46, 32).Value = sChf       ||17332  |                .Cells(46, 32).Value = sChf       
17562  |            Case cEur                             ||17333  |            Case cEur                             
17563  |                .Cells(46, 31).Value = CStr(Format||17334  |                .Cells(46, 31).Value = CStr(Format
17564  |                .Cells(46, 32).Value = sEur       ||17335  |                .Cells(46, 32).Value = sEur       
17565  |            Case cGbp                             ||17336  |            Case cGbp                             
17566  |                .Cells(46, 31).Value = CStr(Format||17337  |                .Cells(46, 31).Value = CStr(Format
17567  |                .Cells(46, 32).Value = sGbp       ||17338  |                .Cells(46, 32).Value = sGbp       
17568  |            Case cHkd                             ||17339  |            Case cHkd                             
17569  |                .Cells(46, 31).Value = CStr(Format||17340  |                .Cells(46, 31).Value = CStr(Format
17570  |                .Cells(46, 32).Value = sHkd       ||17341  |                .Cells(46, 32).Value = sHkd       
17571  |            Case cJpy                             ||17342  |            Case cJpy                             
17572  |                .Cells(46, 29).Value = CStr(Format||17343  |                .Cells(46, 29).Value = CStr(Format
17573  |                .Cells(46, 32).Value = sYen       ||17344  |                .Cells(46, 32).Value = sYen       
17574  |            Case cMyr                             ||17345  |            Case cMyr                             
17575  |                .Cells(46, 31).Value = CStr(Format||17346  |                .Cells(46, 31).Value = CStr(Format
17576  |                .Cells(46, 32).Value = sMyr       ||17347  |                .Cells(46, 32).Value = sMyr       
17577  |            Case cNzd                             ||17348  |            Case cNzd                             
17578  |                .Cells(46, 31).Value = CStr(Format||17349  |                .Cells(46, 31).Value = CStr(Format
17579  |                .Cells(46, 32).Value = sNzd       ||17350  |                .Cells(46, 32).Value = sNzd       
17580  |            Case cSek                             ||17351  |            Case cSek                             
17581  |                .Cells(46, 31).Value = CStr(Format||17352  |                .Cells(46, 31).Value = CStr(Format
17582  |                .Cells(46, 32).Value = sSek       ||17353  |                .Cells(46, 32).Value = sSek       
17583  |            Case cSgd                             ||17354  |            Case cSgd                             
17584  |                .Cells(46, 31).Value = CStr(Format||17355  |                .Cells(46, 31).Value = CStr(Format
17585  |                .Cells(46, 32).Value = sSgd       ||17356  |                .Cells(46, 32).Value = sSgd       
17586  |            Case cUsd                             ||17357  |            Case cUsd                             
17587  |                .Cells(46, 31).Value = CStr(Format||17358  |                .Cells(46, 31).Value = CStr(Format
17588  |                .Cells(46, 32).Value = sUsd       ||17359  |                .Cells(46, 32).Value = sUsd       
17589  |            Case cNok                             ||17360  |            Case cNok                             
17590  |                .Cells(46, 31).Value = CStr(Format||17361  |                .Cells(46, 31).Value = CStr(Format
17591  |                .Cells(46, 32).Value = sNok       ||17362  |                .Cells(46, 32).Value = sNok       
17592  |        End Select                                ||17363  |        End Select                                
17593  |                                                  ||17364  |                                                  
17594  |        '顧問料                                   ||17365  |        '顧問料                                   
17595  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||17366  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
17596  |            .Cells(46, 31).HorizontalAlignment = x||17367  |            .Cells(46, 31).HorizontalAlignment = x
17597  |        Else                                      ||17368  |        Else                                      
17598  |            .Cells(46, 29).HorizontalAlignment = x||17369  |            .Cells(46, 29).HorizontalAlignment = x
17599  |        End If                                    ||17370  |        End If                                    
17600  |                                                  ||17371  |                                                  
17601  |        '契約区分が名称使用許諾料の場合上限・下限 ||17372  |        '契約区分が名称使用許諾料の場合上限・下限 
17602  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||17373  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
17603  |            '上限金額                             ||17374  |            '上限金額                             
17604  |            .Cells(46, 39).Value = sWordCap       ||17375  |            .Cells(46, 39).Value = sWordCap       
17605  |            .Cells(46, 57).NumberFormatLocal = "@"||17376  |            .Cells(46, 57).NumberFormatLocal = "@"
17606  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||17377  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
17607  |                .Cells(46, 57).Value = Format(gbuM||17378  |                .Cells(46, 57).Value = Format(gbuM
17608  |            Else                                  ||17379  |            Else                                  
17609  |                .Cells(46, 57).Value = Format(gbuM||17380  |                .Cells(46, 57).Value = Format(gbuM
17610  |            End If                                ||17381  |            End If                                
17611  |            .Cells(46, 57).HorizontalAlignment = x||17382  |            .Cells(46, 57).HorizontalAlignment = x
17612  |            '下限金額                             ||17383  |            '下限金額                             
17613  |            .Cells(47, 39).Value = sWordFloor     ||17384  |            .Cells(47, 39).Value = sWordFloor     
17614  |            .Cells(47, 57).NumberFormatLocal = "@"||17385  |            .Cells(47, 57).NumberFormatLocal = "@"
17615  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||17386  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
17616  |                .Cells(47, 57).Value = Format(gbuM||17387  |                .Cells(47, 57).Value = Format(gbuM
17617  |            Else                                  ||17388  |            Else                                  
17618  |                .Cells(47, 57).Value = Format(gbuM||17389  |                .Cells(47, 57).Value = Format(gbuM
17619  |            End If                                ||17390  |            End If                                
17620  |            .Cells(47, 57).HorizontalAlignment = x||17391  |            .Cells(47, 57).HorizontalAlignment = x
17621  |        End If                                    ||17392  |        End If                                    
17622  |                                                  ||17393  |                                                  
17623  |        ddblExchangeRate = 0                      ||17394  |        ddblExchangeRate = 0                      
17624  |        '@@@@@ 支払に換算 @@@@@                   ||17395  |        '@@@@@ 支払に換算 @@@@@                   
17625  |        dblValueIn = mstrMonthlyPayCom            ||17396  |        dblValueIn = mstrMonthlyPayCom            
17626  |                                                  ||17397  |                                                  
17627  |        '2006/04/12 START K.Furuya 実払管理テーブ ||17398  |        '2006/04/12 START K.Furuya 実払管理テーブ 
17628  |        '通貨円以外の場合確定顧問料通貨を取得     ||17399  |        '通貨円以外の場合確定顧問料通貨を取得     
17629  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||17400  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
17630  |            WkFixComC = ""                        ||17401  |            WkFixComC = ""                        
17631  |            WkRealComC = ""                       ||17402  |            WkRealComC = ""                       
17632  |            WkFixComC = mstrMonthlyPayCom         ||17403  |            WkFixComC = mstrMonthlyPayCom         
17633  |            WkRealComC = mstrMonthlyPayCom        ||17404  |            WkRealComC = mstrMonthlyPayCom        
17634  |        End If                                    ||17405  |        End If                                    
17635  |        '通貨を取得                               ||17406  |        '通貨を取得                               
17636  |        WkCurCode = ""                            ||17407  |        WkCurCode = ""                            
17637  |        WkCurCode = Trim(gbuMGetUPDRec.N(lRecIdx).||17408  |        WkCurCode = Trim(gbuMGetUPDRec.N(lRecIdx).
17638  |        '2006/04/12 END   K.Furuya 実払管理テーブ ||17409  |        '2006/04/12 END   K.Furuya 実払管理テーブ 
17639  |                                                  ||17410  |                                                  
17640  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||17411  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
17641  |          Case "1"    '固定料率                   ||17412  |          Case "1"    '固定料率                   
17642  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o||17413  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o
17643  |                Else                              ||17414  |                Else                              
17644  |                  '外部委託顧問料通貨→JPYの為替レ||17415  |                  '外部委託顧問料通貨→JPYの為替レ
17645  |                  dstrCurrencyCode = gbuMGetUPDRec||17416  |                  dstrCurrencyCode = gbuMGetUPDRec
17646  |                  ddblExchangeRate = fnstrExchange||17417  |                  ddblExchangeRate = fnstrExchange
17647  |                  If ddblExchangeRate = 0 Then    ||17418  |                  If ddblExchangeRate = 0 Then    
17648  |                    intRtn = MsgBox("ＴＴＭが取得 ||17419  |                    intRtn = MsgBox("ＴＴＭが取得 
17649  |                    vbLf & "対象通貨コード ： [ " ||17420  |                    vbLf & "対象通貨コード ： [ " 
17650  |                    vbLf & "基準日 ： [ " & Mid(ds||17421  |                    vbLf & "基準日 ： [ " & Mid(ds
17651  |                        vbCritical, "ＴＴＭ取得エ ||17422  |                        vbCritical, "ＴＴＭ取得エ 
17652  |                    Exit Function                 ||17423  |                    Exit Function                 
17653  |                  End If                          ||17424  |                  End If                          
17654  |                  'JPY→支払通貨へレート換算      ||17425  |                  'JPY→支払通貨へレート換算      
17655  |                  dblValueIn = dblValueIn * ddblEx||17426  |                  dblValueIn = dblValueIn * ddblEx
17656  |                End If                            ||17427  |                End If                            
17657  |          Case "2"    '段階料率                   ||17428  |          Case "2"    '段階料率                   
17658  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||17429  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
17659  |            Else                                  ||17430  |            Else                                  
17660  |                '外部委託顧問料通貨→JPYの為替レー||17431  |                '外部委託顧問料通貨→JPYの為替レー
17661  |                dstrCurrencyCode = gbuMGetUPDRec.N||17432  |                dstrCurrencyCode = gbuMGetUPDRec.N
17662  |                ddblExchangeRate = fnstrExchangeRa||17433  |                ddblExchangeRate = fnstrExchangeRa
17663  |                If ddblExchangeRate = 0 Then      ||17434  |                If ddblExchangeRate = 0 Then      
17664  |                  intRtn = MsgBox("ＴＴＭが取得で ||17435  |                  intRtn = MsgBox("ＴＴＭが取得で 
17665  |                  vbLf & "対象通貨コード ： [ " & ||17436  |                  vbLf & "対象通貨コード ： [ " & 
17666  |                  vbLf & "基準日 ： [ " & Mid(dstr||17437  |                  vbLf & "基準日 ： [ " & Mid(dstr
17667  |                      vbCritical, "ＴＴＭ取得エラ ||17438  |                      vbCritical, "ＴＴＭ取得エラ 
17668  |                  Exit Function                   ||17439  |                  Exit Function                   
17669  |                End If                            ||17440  |                End If                            
17670  |                '外部委託顧問料通貨→JPYへレート換||17441  |                '外部委託顧問料通貨→JPYへレート換
17671  |                dblValueIn = dblValueIn * ddblExch||17442  |                dblValueIn = dblValueIn * ddblExch
17672  |            End If                                ||17443  |            End If                                
17673  |        End Select                                ||17444  |        End Select                                
17674  |        '@@@@@ 支払に換算 @@@@@                   ||17445  |        '@@@@@ 支払に換算 @@@@@                   
17675  |        Call sbGetRoundValue(dblValueIn)          ||17446  |        Call sbGetRoundValue(dblValueIn)          
17676  |        mstrMonthlyPayCom = dblValueOut           ||17447  |        mstrMonthlyPayCom = dblValueOut           
17677  |                                                  ||17448  |                                                  
17678  |        '2006/04/12 START K.Furuya 実払管理テーブ ||17449  |        '2006/04/12 START K.Furuya 実払管理テーブ 
17679  |        '確定額と実払額を取得                     ||17450  |        '確定額と実払額を取得                     
17680  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||17451  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
17681  |            WkFixComC = ""                        ||17452  |            WkFixComC = ""                        
17682  |            WkFixComJ = ""                        ||17453  |            WkFixComJ = ""                        
17683  |            WkRealComC = ""                       ||17454  |            WkRealComC = ""                       
17684  |            WkRealComJ = ""                       ||17455  |            WkRealComJ = ""                       
17685  |            WkFixComC = mstrMonthlyPayCom         ||17456  |            WkFixComC = mstrMonthlyPayCom         
17686  |            WkFixComJ = mstrMonthlyPayCom         ||17457  |            WkFixComJ = mstrMonthlyPayCom         
17687  |            WkRealComC = mstrMonthlyPayCom        ||17458  |            WkRealComC = mstrMonthlyPayCom        
17688  |            WkRealComJ = mstrMonthlyPayCom        ||17459  |            WkRealComJ = mstrMonthlyPayCom        
17689  |        Else                                      ||17460  |        Else                                      
17690  |            WkFixComJ = ""                        ||17461  |            WkFixComJ = ""                        
17691  |            WkRealComJ = ""                       ||17462  |            WkRealComJ = ""                       
17692  |            WkFixComJ = mstrMonthlyPayCom         ||17463  |            WkFixComJ = mstrMonthlyPayCom         
17693  |            WkRealComJ = mstrMonthlyPayCom        ||17464  |            WkRealComJ = mstrMonthlyPayCom        
17694  |        End If                                    ||17465  |        End If                                    
17695  |        '2006/04/12 END   K.Furuya 実払管理テーブ ||17466  |        '2006/04/12 END   K.Furuya 実払管理テーブ 
17696  |                                                  ||17467  |                                                  
17697  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||17468  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
17698  |            'TTMレート                            ||17469  |            'TTMレート                            
17699  |            .Cells(47, 19).Value = sWord43        ||17470  |            .Cells(47, 19).Value = sWord43        
17700  |            .Cells(47, 33).NumberFormatLocal = "@"||17471  |            .Cells(47, 33).NumberFormatLocal = "@"
17701  |            .Cells(47, 33).Value = Format(ddblExch||17472  |            .Cells(47, 33).Value = Format(ddblExch
17702  |            .Cells(47, 33).HorizontalAlignment = x||17473  |            .Cells(47, 33).HorizontalAlignment = x
17703  |            .Cells(47, 34).Value = sWord44        ||17474  |            .Cells(47, 34).Value = sWord44        
17704  |        End If                                    ||17475  |        End If                                    
17705  |        '支払額                                   ||17476  |        '支払額                                   
17706  |        .Cells(48, 2).Value = sWord46             ||17477  |        .Cells(48, 2).Value = sWord46             
17707  |        .Cells(48, 11).Value = sWord19            ||17478  |        .Cells(48, 11).Value = sWord19            
17708  |        '税抜金額(月別支払顧問料の累計)           ||17479  |        '税抜金額(月別支払顧問料の累計)           
17709  |        .Cells(48, 29).NumberFormatLocal = "@"    ||17480  |        .Cells(48, 29).NumberFormatLocal = "@"    
17710  |        .Cells(48, 29).Value = CStr(Format(mstrMon||17481  |        .Cells(48, 29).Value = CStr(Format(mstrMon
17711  |        .Cells(48, 29).HorizontalAlignment = xlRig||17482  |        .Cells(48, 29).HorizontalAlignment = xlRig
17712  |        .Cells(48, 32).Value = sYen               ||17483  |        .Cells(48, 32).Value = sYen               
17713  |                                                  ||17484  |                                                  
17714  |        '消費税計算有無：「有り」の場合のみ、消費 ||17485  |        '消費税計算有無：「有り」の場合のみ、消費 
17715  |        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc_||17486  |        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc_
17716 L|'2014/02/19 START M.Takada 【管理会計】消費税率変 ||       |                                                  
17717  |            '(消費税XX%)                          ||17487  |            '(消費税XX%)                          
17718 L|            'iSyouhizei = ddblconsumption_tax     ||17488 R|            iSyouhizei = ddblconsumption_tax      
17719 L|            '.Cells(49, 32).Value = sWord22 & iSyo||17489 R|            .Cells(49, 32).Value = sWord22 & iSyou
17720 L|            'dblValueIn = mstrMonthlyPayCom * iSyo||17490 R|            dblValueIn = mstrMonthlyPayCom * iSyou
17721 L|            'Call sbGetRoundValueTax(dblValueIn)  ||17491 R|            Call sbGetRoundValueTax(dblValueIn)   
17722 L|            'lTaxNum = dblValueOut                ||17492 R|            lTaxNum = dblValueOut                 
17723 L|            '.Cells(49, 29).NumberFormatLocal = "@||17493 R|            .Cells(49, 29).NumberFormatLocal = "@"
17724 L|            '.Cells(49, 29).Value = CStr(Format((l||17494 R|            .Cells(49, 29).Value = CStr(Format((lT
17725 L|            '.Cells(49, 29).HorizontalAlignment = ||17495 R|            .Cells(49, 29).HorizontalAlignment = x
17726 L|            '合計(消費税＋月別支払顧問料の累計)   ||       |                                                  
17727 L|            '.Cells(50, 13).Value = sWord24       ||       |                                                  
17728 L|            'dblValueIn = lTaxNum + CCur(mstrMonth||       |                                                  
17729 L|            'Call sbGetRoundValue(dblValueIn)     ||       |                                                  
17730 L|            'lMonthlyPayCom = dblValueOut         ||       |                                                  
17731 L|            '.Cells(50, 29).NumberFormatLocal = "@||       |                                                  
17732 L|            '.Cells(50, 29).Value = CStr(Format(lM||       |                                                  
17733 L|            '.Cells(50, 29).HorizontalAlignment = ||       |                                                  
17734 L|            '円                                   ||       |                                                  
17735 L|            '.Cells(50, 32).Value = sYen          ||       |                                                  
17736 L|            '下線                                 ||       |                                                  
17737 L|            'With xlSheet.Range("M49:AL49").Border||       |                                                  
17738 L|            '    .LineStyle = xlContinuous        ||       |                                                  
17739 L|            '    .Weight = xlThin                 ||       |                                                  
17740 L|            'End With                             ||       |                                                  
17741 L|                                                  ||       |                                                  
17742 L|            Call Tax_calc(dStart, dEnd)     '消費 ||       |                                                  
17743 L|            If Tax_Flg = True Then                ||       |                                                  
17744 L|                '計算期間中に消費税率が変更となる ||       |                                                  
17745 L|                .Cells(49, 32).Value = sWord71    ||       |                                                  
17746 L|                .Cells(49, 29).NumberFormatLocal =||       |                                                  
17747 L|                '算出した税額を該当セルに設定する ||       |                                                  
17748 L|                .Cells(49, 29).Value = CStr(Format||       |                                                  
17749 L|                .Cells(49, 29).HorizontalAlignment||       |                                                  
17750 L|                '下線                             ||       |                                                  
17751 L|                .Range("M49:AH49").Borders (xlEdge||       |                                                  
17752 L|                .LineStyle = xlContinuous         ||       |                                                  
17753 L|                .Weight = xlThin                  ||       |                                                  
17754 L|                                                  ||       |                                                  
17755 L|                '注釈文言を出力する               ||       |                                                  
17756 L|                .Cells(48, 36).Value = sWord64    ||       |                                                  
17757 L|                .Cells(48, 36).FontSize = 10      ||       |                                                  
17758 L|                .Cells(49, 36).Value = sWord65    ||       |                                                  
17759 L|                .Cells(49, 36).FontSize = 10      ||       |                                                  
17760 L|                                                  ||       |                                                  
17761 L|            Else                                  ||       |                                                  
17762 L|                '計算期間中に消費税率が変更となら ||       |                                                  
17763 L|                '.Cells(49, 32).Value = sWord22 & ||       |                                                  
17764 L|                .Cells(49, 32).Value = sWord22 & s||       |                                                  
17765 L|                'dblValueIn = mstrMonthlyPayCom * ||       |                                                  
17766 L|                .Cells(49, 29).NumberFormatLocal =||       |                                                  
17767 L|                '算出した税額を該当セルに設定する ||       |                                                  
17768 L|                .Cells(49, 29).Value = CStr(Format||       |                                                  
17769 L|                .Cells(49, 29).HorizontalAlignment||       |                                                  
17770 L|                '下線                             ||       |                                                  
17771 L|                .Range("M49:AL49").Borders (xlEdge||       |                                                  
17775 M|            '合計(消費税＋月別支払顧問料の累計)   ||17496 R|            '合計(消費税＋月別支払顧問料の累計)   
17776 M|            .Cells(50, 13).Value = sWord24        ||17497 R|            .Cells(50, 13).Value = sWord24        
       |                                                  ||17498 R|            dblValueIn = lTaxNum + CCur(mstrMonthl
       |                                                  ||17499 R|            Call sbGetRoundValue(dblValueIn)      
       |                                                  ||17500 R|            lMonthlyPayCom = dblValueOut          
17777 M|            .Cells(50, 29).NumberFormatLocal = "@"||17501 R|            .Cells(50, 29).NumberFormatLocal = "@"
       |                                                  ||17502 R|            .Cells(50, 29).Value = CStr(Format(lMo
17772 L|                .LineStyle = xlContinuous         ||17508 M|                .LineStyle = xlContinuous         
17773 L|                .Weight = xlThin                  ||17509 M|                .Weight = xlThin                  
17774 L|            End If                                ||       |                                                  
17775 L|            '合計(消費税＋月別支払顧問料の累計)   ||17496 M|            '合計(消費税＋月別支払顧問料の累計)   
17776 L|            .Cells(50, 13).Value = sWord24        ||17497 M|            .Cells(50, 13).Value = sWord24        
17777 L|            .Cells(50, 29).NumberFormatLocal = "@"||17501 M|            .Cells(50, 29).NumberFormatLocal = "@"
17778 L|            .Cells(50, 29).Value = CStr(Format((.C||       |                                                  
17779  |            .Cells(50, 29).HorizontalAlignment = x||17503  |            .Cells(50, 29).HorizontalAlignment = x
17780  |            '円                                   ||17504  |            '円                                   
17781  |            .Cells(50, 32).Value = sYen           ||17505  |            .Cells(50, 32).Value = sYen           
17782 L|                                                  ||       |                                                  
17783  |            '下線                                 ||17506  |            '下線                                 
17784 L|            'With xlSheet.Range("M49:AL49").Border||       |                                                  
17785 L|            '    .LineStyle = xlContinuous        ||       |                                                  
17786 L|            '    .Weight = xlThin                 ||       |                                                  
17787 L|            'End With                             ||       |                                                  
17788 L|                                                  ||       |                                                  
17789 L|'2014/02/19 End M.Takada 【管理会計】消費税率変更 ||       |                                                  
17790 L|        Else                                      ||13581 M|        Else                                      
17791 L|        End If                                    ||13582 M|        End If                                    
       |                                                  ||17507 R|            With xlSheet.Range("M49:AL49").Borders
17772 M|                .LineStyle = xlContinuous         ||17508 R|                .LineStyle = xlContinuous         
17773 M|                .Weight = xlThin                  ||17509 R|                .Weight = xlThin                  
       |                                                  ||17510 R|            End With                              
13659 M|        Else                                      ||17511 R|        Else                                      
13660 M|        End If                                    ||17512 R|        End If                                    
17792  |        '支払先                                   ||17513  |        '支払先                                   
17793  |        .Cells(52, 2).Value = sWord12             ||17514  |        .Cells(52, 2).Value = sWord12             
17794  |        .Cells(52, 11).Value = sWord19            ||17515  |        .Cells(52, 11).Value = sWord19            
17795  |        .Cells(52, 13).Value = gbuMGetUPDRec.N(lRe||17516  |        .Cells(52, 13).Value = gbuMGetUPDRec.N(lRe
17796  |        '支払予定日                               ||17517  |        '支払予定日                               
17797  |        .Cells(54, 2).Value = sWord13             ||17518  |        .Cells(54, 2).Value = sWord13             
17798  |        .Cells(54, 11).Value = sWord19            ||17519  |        .Cells(54, 11).Value = sWord19            
17799  |        '支払予定日                               ||17520  |        '支払予定日                               
17800  |        sDate = Trim(mstrPaymentDate)             ||17521  |        sDate = Trim(mstrPaymentDate)             
17801  |        .Cells(54, 13).Value = _                  ||17522  |        .Cells(54, 13).Value = _                  
17802  |            Format(sDate, "YYYY") & WordYear & _  ||17523  |            Format(sDate, "YYYY") & WordYear & _  
17803  |            Format(sDate, "M") & WordMonth & _    ||17524  |            Format(sDate, "M") & WordMonth & _    
17804  |            Format(sDate, "D") & WordDay          ||17525  |            Format(sDate, "D") & WordDay          
17805  |        '部署名                                   ||17526  |        '部署名                                   
17806  |        'コンボ左の数字取得                       ||17527  |        'コンボ左の数字取得                       
17807  |        ColNum = Trim(gstrComboCodeGet(cboBumonFla||17528  |        ColNum = Trim(gstrComboCodeGet(cboBumonFla
17808  |        'コンボ「：」以下の文字列                 ||17529  |        'コンボ「：」以下の文字列                 
17809  |        ColWord = Trim(gstrComboDataGet(cboBumonFl||17530  |        ColWord = Trim(gstrComboDataGet(cboBumonFl
17810  |        .Cells(56, 2).Value = ColWord             ||17531  |        .Cells(56, 2).Value = ColWord             
17811  |        .Range("B56:S56").HorizontalAlignment = xl||17532  |        .Range("B56:S56").HorizontalAlignment = xl
17812  |        '担当者印                                 ||17533  |        '担当者印                                 
17813  |        .Cells(57, 2).Value = sWord15             ||17534  |        .Cells(57, 2).Value = sWord15             
17814  |        .Range("B57:J57").HorizontalAlignment = xl||17535  |        .Range("B57:J57").HorizontalAlignment = xl
17815  |        '検印                                     ||17536  |        '検印                                     
17816  |        .Cells(57, 11).Value = sWord16            ||17537  |        .Cells(57, 11).Value = sWord16            
17817  |        .Range("K57:S57").HorizontalAlignment = xl||17538  |        .Range("K57:S57").HorizontalAlignment = xl
17818  |        '財務部                                   ||17539  |        '財務部                                   
17819  |        .Cells(56, 24).Value = sWord35            ||17540  |        .Cells(56, 24).Value = sWord35            
17820  |        .Range("X56:AO56").HorizontalAlignment = x||17541  |        .Range("X56:AO56").HorizontalAlignment = x
17821  |        '精査印                                   ||17542  |        '精査印                                   
17822  |        .Cells(57, 24).Value = sWord17            ||17543  |        .Cells(57, 24).Value = sWord17            
17823  |        .Range("X57:AF57").HorizontalAlignment = x||17544  |        .Range("X57:AF57").HorizontalAlignment = x
17824  |        '検印                                     ||17545  |        '検印                                     
17825  |        .Cells(57, 33).Value = sWord16            ||17546  |        .Cells(57, 33).Value = sWord16            
17826  |        .Range("AG57:AO57").HorizontalAlignment = ||17547  |        .Range("AG57:AO57").HorizontalAlignment = 
17827  |                                                  ||17548  |                                                  
17828  |    End With                                      ||17549  |    End With                                      
17829  |                                                  ||17550  |                                                  
17830  |    '月末純資産(外枠)                             ||17551  |    '月末純資産(外枠)                             
17831  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge||17552  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge
17832  |'        .LineStyle = xlContinuous                ||17553  |'        .LineStyle = xlContinuous                
17833  |'        .Weight = xlThin                         ||17554  |'        .Weight = xlThin                         
17834  |'    End With                                     ||17555  |'    End With                                     
17835  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge||17556  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge
17836  |'        .LineStyle = xlContinuous                ||17557  |'        .LineStyle = xlContinuous                
17837  |'        .Weight = xlThin                         ||17558  |'        .Weight = xlThin                         
17838  |'    End With                                     ||17559  |'    End With                                     
17839  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge||17560  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge
17840  |'        .LineStyle = xlContinuous                ||17561  |'        .LineStyle = xlContinuous                
17841  |'        .Weight = xlThin                         ||17562  |'        .Weight = xlThin                         
17842  |'    End With                                     ||17563  |'    End With                                     
17843  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge||17564  |'    With xlSheet.Range("N19:AN33").Borders(xlEdge
17844  |'        .LineStyle = xlContinuous                ||17565  |'        .LineStyle = xlContinuous                
17845  |'        .Weight = xlThin                         ||17566  |'        .Weight = xlThin                         
17846  |'    End With                                     ||17567  |'    End With                                     
17847  |'    With xlSheet.Range("N19:AN33").Borders(xlInsi||17568  |'    With xlSheet.Range("N19:AN33").Borders(xlInsi
17848  |'        .LineStyle = xlContinuous                ||17569  |'        .LineStyle = xlContinuous                
17849  |'        .Weight = xlThin                         ||17570  |'        .Weight = xlThin                         
17850  |'    End With                                     ||17571  |'    End With                                     
17851  |    With xlSheet.Range("N19:AN40").Borders(xlEdgeL||17572  |    With xlSheet.Range("N19:AN40").Borders(xlEdgeL
17852  |        .LineStyle = xlContinuous                 ||17573  |        .LineStyle = xlContinuous                 
17853  |        .Weight = xlThin                          ||17574  |        .Weight = xlThin                          
17854  |    End With                                      ||17575  |    End With                                      
17855  |    With xlSheet.Range("N19:AN40").Borders(xlEdgeT||17576  |    With xlSheet.Range("N19:AN40").Borders(xlEdgeT
17856  |        .LineStyle = xlContinuous                 ||17577  |        .LineStyle = xlContinuous                 
17857  |        .Weight = xlThin                          ||17578  |        .Weight = xlThin                          
17858  |    End With                                      ||17579  |    End With                                      
17859  |    With xlSheet.Range("N19:AN40").Borders(xlEdgeB||17580  |    With xlSheet.Range("N19:AN40").Borders(xlEdgeB
17860  |        .LineStyle = xlContinuous                 ||17581  |        .LineStyle = xlContinuous                 
17861  |        .Weight = xlThin                          ||17582  |        .Weight = xlThin                          
17862  |    End With                                      ||17583  |    End With                                      
17863  |    With xlSheet.Range("N19:AN40").Borders(xlEdgeR||17584  |    With xlSheet.Range("N19:AN40").Borders(xlEdgeR
17864  |        .LineStyle = xlContinuous                 ||17585  |        .LineStyle = xlContinuous                 
17865  |        .Weight = xlThin                          ||17586  |        .Weight = xlThin                          
17866  |    End With                                      ||17587  |    End With                                      
17867  |    With xlSheet.Range("N19:AN40").Borders(xlInsid||17588  |    With xlSheet.Range("N19:AN40").Borders(xlInsid
17868  |        .LineStyle = xlContinuous                 ||17589  |        .LineStyle = xlContinuous                 
17869  |        .Weight = xlThin                          ||17590  |        .Weight = xlThin                          
17870  |    End With                                      ||17591  |    End With                                      
17871  |    '月末純資産(真中縦線)                         ||17592  |    '月末純資産(真中縦線)                         
17872  |'    With xlSheet.Range("Y19:Y33").Borders(xlEdgeR||17593  |'    With xlSheet.Range("Y19:Y33").Borders(xlEdgeR
17873  |'        .LineStyle = xlContinuous                ||17594  |'        .LineStyle = xlContinuous                
17874  |'        .Weight = xlThin                         ||17595  |'        .Weight = xlThin                         
17875  |'    End With                                     ||17596  |'    End With                                     
17876  |    With xlSheet.Range("Y19:Y40").Borders(xlEdgeRi||17597  |    With xlSheet.Range("Y19:Y40").Borders(xlEdgeRi
17877  |        .LineStyle = xlContinuous                 ||17598  |        .LineStyle = xlContinuous                 
17878  |        .Weight = xlThin                          ||17599  |        .Weight = xlThin                          
17879  |    End With                                      ||17600  |    End With                                      
17880  |    '月末純資産(左側捺印欄　外枠)                 ||17601  |    '月末純資産(左側捺印欄　外枠)                 
17881  |    With xlSheet.Range("B56:S63").Borders(xlEdgeLe||17602  |    With xlSheet.Range("B56:S63").Borders(xlEdgeLe
17882  |        .LineStyle = xlContinuous                 ||17603  |        .LineStyle = xlContinuous                 
17883  |        .Weight = xlThin                          ||17604  |        .Weight = xlThin                          
17884  |    End With                                      ||17605  |    End With                                      
17885  |    With xlSheet.Range("B56:S63").Borders(xlEdgeTo||17606  |    With xlSheet.Range("B56:S63").Borders(xlEdgeTo
17886  |        .LineStyle = xlContinuous                 ||17607  |        .LineStyle = xlContinuous                 
17887  |        .Weight = xlThin                          ||17608  |        .Weight = xlThin                          
17888  |    End With                                      ||17609  |    End With                                      
17889  |    With xlSheet.Range("B56:S63").Borders(xlEdgeBo||17610  |    With xlSheet.Range("B56:S63").Borders(xlEdgeBo
17890  |        .LineStyle = xlContinuous                 ||17611  |        .LineStyle = xlContinuous                 
17891  |        .Weight = xlThin                          ||17612  |        .Weight = xlThin                          
17892  |    End With                                      ||17613  |    End With                                      
17893  |    With xlSheet.Range("B56:S63").Borders(xlEdgeRi||17614  |    With xlSheet.Range("B56:S63").Borders(xlEdgeRi
17894  |        .LineStyle = xlContinuous                 ||17615  |        .LineStyle = xlContinuous                 
17895  |        .Weight = xlThin                          ||17616  |        .Weight = xlThin                          
17896  |    End With                                      ||17617  |    End With                                      
17897  |    '月末純資産(左側捺印欄　上枠)                 ||17618  |    '月末純資産(左側捺印欄　上枠)                 
17898  |    With xlSheet.Range("B56:S57").Borders(xlEdgeBo||17619  |    With xlSheet.Range("B56:S57").Borders(xlEdgeBo
17899  |        .LineStyle = xlContinuous                 ||17620  |        .LineStyle = xlContinuous                 
17900  |        .Weight = xlThin                          ||17621  |        .Weight = xlThin                          
17901  |    End With                                      ||17622  |    End With                                      
17902  |    With xlSheet.Range("B56:S57").Borders(xlInside||17623  |    With xlSheet.Range("B56:S57").Borders(xlInside
17903  |        .LineStyle = xlContinuous                 ||17624  |        .LineStyle = xlContinuous                 
17904  |        .Weight = xlThin                          ||17625  |        .Weight = xlThin                          
17905  |    End With                                      ||17626  |    End With                                      
17906  |    '月末純資産(左側捺印欄　縦線)                 ||17627  |    '月末純資産(左側捺印欄　縦線)                 
17907  |    With xlSheet.Range("J57:J63").Borders(xlEdgeRi||17628  |    With xlSheet.Range("J57:J63").Borders(xlEdgeRi
17908  |        .LineStyle = xlContinuous                 ||17629  |        .LineStyle = xlContinuous                 
17909  |        .Weight = xlThin                          ||17630  |        .Weight = xlThin                          
17910  |    End With                                      ||17631  |    End With                                      
17911  |    '月末純資産(右側捺印欄　外枠)                 ||17632  |    '月末純資産(右側捺印欄　外枠)                 
17912  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeL||17633  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeL
17913  |        .LineStyle = xlContinuous                 ||17634  |        .LineStyle = xlContinuous                 
17914  |        .Weight = xlThin                          ||17635  |        .Weight = xlThin                          
17915  |    End With                                      ||17636  |    End With                                      
17916  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeT||17637  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeT
17917  |        .LineStyle = xlContinuous                 ||17638  |        .LineStyle = xlContinuous                 
17918  |        .Weight = xlThin                          ||17639  |        .Weight = xlThin                          
17919  |    End With                                      ||17640  |    End With                                      
17920  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeB||17641  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeB
17921  |        .LineStyle = xlContinuous                 ||17642  |        .LineStyle = xlContinuous                 
17922  |        .Weight = xlThin                          ||17643  |        .Weight = xlThin                          
17923  |    End With                                      ||17644  |    End With                                      
17924  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeR||17645  |    With xlSheet.Range("X56:AO63").Borders(xlEdgeR
17925  |        .LineStyle = xlContinuous                 ||17646  |        .LineStyle = xlContinuous                 
17926  |        .Weight = xlThin                          ||17647  |        .Weight = xlThin                          
17927  |    End With                                      ||17648  |    End With                                      
17928  |    '月末純資産(右側捺印欄　上枠)                 ||17649  |    '月末純資産(右側捺印欄　上枠)                 
17929  |    With xlSheet.Range("X56:AO57").Borders(xlEdgeT||17650  |    With xlSheet.Range("X56:AO57").Borders(xlEdgeT
17930  |        .LineStyle = xlContinuous                 ||17651  |        .LineStyle = xlContinuous                 
17931  |        .Weight = xlThin                          ||17652  |        .Weight = xlThin                          
17932  |    End With                                      ||17653  |    End With                                      
17933  |    With xlSheet.Range("X56:AO57").Borders(xlEdgeB||17654  |    With xlSheet.Range("X56:AO57").Borders(xlEdgeB
17934  |        .LineStyle = xlContinuous                 ||17655  |        .LineStyle = xlContinuous                 
17935  |        .Weight = xlThin                          ||17656  |        .Weight = xlThin                          
17936  |    End With                                      ||17657  |    End With                                      
17937  |    With xlSheet.Range("X56:AO57").Borders(xlInsid||17658  |    With xlSheet.Range("X56:AO57").Borders(xlInsid
17938  |        .LineStyle = xlContinuous                 ||17659  |        .LineStyle = xlContinuous                 
17939  |        .Weight = xlThin                          ||17660  |        .Weight = xlThin                          
17940  |    End With                                      ||17661  |    End With                                      
17941  |    '月末純資産(右側捺印欄　縦線)                 ||17662  |    '月末純資産(右側捺印欄　縦線)                 
17942  |    With xlSheet.Range("AF57:AF63").Borders(xlEdge||17663  |    With xlSheet.Range("AF57:AF63").Borders(xlEdge
17943  |        .LineStyle = xlContinuous                 ||17664  |        .LineStyle = xlContinuous                 
17944  |        .Weight = xlThin                          ||17665  |        .Weight = xlThin                          
17945  |    End With                                      ||17666  |    End With                                      
17946  |                                                  ||17667  |                                                  
17947  |                                                  ||17668  |                                                  
17948  |    '月末純資産　下線                             ||17669  |    '月末純資産　下線                             
17949  |    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract_||17670  |    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract_
17950  |    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||17671  |    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
17951  |        xlSheet.Cells(15, 13).Value = _           ||17672  |        xlSheet.Cells(15, 13).Value = _           
17952  |            CStr(Format(dStart, "YYYY年M月D日")) &||17673  |            CStr(Format(dStart, "YYYY年M月D日")) &
17953  |    Else                                          ||17674  |    Else                                          
17954  |        xlSheet.Cells(15, 13).Value = _           ||17675  |        xlSheet.Cells(15, 13).Value = _           
17955  |            CStr(Format(dStart, "YYYY年M月D日")) &||17676  |            CStr(Format(dStart, "YYYY年M月D日")) &
17956  |    End If                                        ||17677  |    End If                                        
17957  |    'A4印刷用に上2行を削除して、プレビュー範囲内に||17678  |    'A4印刷用に上2行を削除して、プレビュー範囲内に
17958  |    xlSheet.Rows("1:2").Delete Shift:=xlUp        ||17679  |    xlSheet.Rows("1:2").Delete Shift:=xlUp        
17959  |                                                  ||17680  |                                                  
17960  |'期中料率変更契約対応 START                       ||17681  |'期中料率変更契約対応 START                       
17961  |    '料率変更履歴票作成                           ||17682  |    '料率変更履歴票作成                           
17962  |    'RAFI対応 START                               ||17683  |    'RAFI対応 START                               
17963  |    '純資産の場合                                 ||17684  |    '純資産の場合                                 
17964  |    If msAssetFlg = "0" Then                      ||17685  |    If msAssetFlg = "0" Then                      
17965  |        Call sbExcelChgRateSheetOut( _            ||17686  |        Call sbExcelChgRateSheetOut( _            
17966  |                sGetAccCode, TotalRate, lRecIdx, d||17687  |                sGetAccCode, TotalRate, lRecIdx, d
17967  |    'マザー組入資産の場合                         ||17688  |    'マザー組入資産の場合                         
17968  |    Else                                          ||17689  |    Else                                          
17969  |        Call sbExcelChgRateSheetOut( _            ||17690  |        Call sbExcelChgRateSheetOut( _            
17970  |                msBabyAccountCode, TotalRate, lRec||17691  |                msBabyAccountCode, TotalRate, lRec
17971  |    End If                                        ||17692  |    End If                                        
17972  |    'RAFI対応 END                                 ||17693  |    'RAFI対応 END                                 
17973  |'期中料率変更契約対応 END                         ||17694  |'期中料率変更契約対応 END                         
17974  |                                                  ||17695  |                                                  
17975  |'=================================================||17696  |'=================================================
17976  |'== 　　　　日次NAV/日時時価総額の別表作成エリア  ||17697  |'== 　　　　日次NAV/日時時価総額の別表作成エリア  
17977  |'=================================================||17698  |'=================================================
17978  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||17699  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
17979  |'    'NAV取得区分：日次NAV平均(休日有)または日次NA||17700  |'    'NAV取得区分：日次NAV平均(休日有)または日次NA
17980  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||17701  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
17981  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||17702  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
17982  |    'NAV取得区分：日次NAV平均(休日有)、日次NAV平均||17703  |    'NAV取得区分：日次NAV平均(休日有)、日次NAV平均
17983  |    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag ||17704  |    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag 
17984  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||17705  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
17985  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||17706  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
17986  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||17707  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
17987  |                                                  ||17708  |                                                  
17988  |        gTotalDnavCnt = 0                         ||17709  |        gTotalDnavCnt = 0                         
17989  |        J = 0                                     ||17710  |        J = 0                                     
17990  |        K = 0                                     ||17711  |        K = 0                                     
17991  |        'ループ終了フラグ初期化                   ||17712  |        'ループ終了フラグ初期化                   
17992  |        EndFlg = False                            ||17713  |        EndFlg = False                            
17993  |        SetPoint = 0                              ||17714  |        SetPoint = 0                              
17994  |        AddPoint = 0                              ||17715  |        AddPoint = 0                              
17995  |                                                  ||17716  |                                                  
17996  |        '＋２は合計行と平均行                     ||17717  |        '＋２は合計行と平均行                     
17997  |'        dintPage = (dlngCnt + 2) \ 108           ||17718  |'        dintPage = (dlngCnt + 2) \ 108           
17998  |'        dintAmari = (dlngCnt + 2) Mod 108        ||17719  |'        dintAmari = (dlngCnt + 2) Mod 108        
17999  |        '余白 + (料率数 × 2) + (料率数 - 1)      ||17720  |        '余白 + (料率数 × 2) + (料率数 - 1)      
18000  |        dintPage = (dlngCnt + 2 + 2 + ((UBound(gty||17721  |        dintPage = (dlngCnt + 2 + 2 + ((UBound(gty
18001  |        dintAmari = (dlngCnt + 2 + 2 + ((UBound(gt||17722  |        dintAmari = (dlngCnt + 2 + 2 + ((UBound(gt
18002  |                                                  ||17723  |                                                  
18003  |        If dintAmari <> 0 Then                    ||17724  |        If dintAmari <> 0 Then                    
18004  |            dintPage = dintPage + 1               ||17725  |            dintPage = dintPage + 1               
18005  |        End If                                    ||17726  |        End If                                    
18006  |                                                  ||17727  |                                                  
18007  |        For L = 1 To dintPage                     ||17728  |        For L = 1 To dintPage                     
18008  |                                                  ||17729  |                                                  
18009  |            xlBook.Worksheets.Add after:=xlBook.Sh||17730  |            xlBook.Worksheets.Add after:=xlBook.Sh
18010  |            gProcessCnt = gProcessCnt + 1         ||17731  |            gProcessCnt = gProcessCnt + 1         
18011  |            Set xlSheet = xlBook.Sheets(gProcessCn||17732  |            Set xlSheet = xlBook.Sheets(gProcessCn
18012  |                                                  ||17733  |                                                  
18013  |            'Excelフォーマットを調整              ||17734  |            'Excelフォーマットを調整              
18014  |            xlSheet.Cells.ColumnWidth = 1         ||17735  |            xlSheet.Cells.ColumnWidth = 1         
18015  |            xlSheet.Cells.Font.Size = 11          ||17736  |            xlSheet.Cells.Font.Size = 11          
18016  |            'シート名を設定(日次NAV一覧**)        ||17737  |            'シート名を設定(日次NAV一覧**)        
18017  |                                                  ||17738  |                                                  
18018  |            'RAFI対応 START                       ||17739  |            'RAFI対応 START                       
18019  |            '純資産の場合                         ||17740  |            '純資産の場合                         
18020  |            If msAssetFlg = "0" Then              ||17741  |            If msAssetFlg = "0" Then              
18021  |                If dstrOldAccCode = sGetAccCode Th||17742  |                If dstrOldAccCode = sGetAccCode Th
18022  |                    gTotalDnavCnt = gTotalDnavCnt ||17743  |                    gTotalDnavCnt = gTotalDnavCnt 
18023  |                Else                              ||17744  |                Else                              
18024  |                    gTotalDnavCnt = 1             ||17745  |                    gTotalDnavCnt = 1             
18025  |                    dstrOldAccCode = sGetAccCode  ||17746  |                    dstrOldAccCode = sGetAccCode  
18026  |                End If                            ||17747  |                End If                            
18027  |            'マザー組入資産の場合                 ||17748  |            'マザー組入資産の場合                 
18028  |            Else                                  ||17749  |            Else                                  
18029  |                If dstrOldAccCode = msBabyAccountC||17750  |                If dstrOldAccCode = msBabyAccountC
18030  |                    gTotalDnavCnt = gTotalDnavCnt ||17751  |                    gTotalDnavCnt = gTotalDnavCnt 
18031  |                Else                              ||17752  |                Else                              
18032  |                    gTotalDnavCnt = 1             ||17753  |                    gTotalDnavCnt = 1             
18033  |                    dstrOldAccCode = msBabyAccount||17754  |                    dstrOldAccCode = msBabyAccount
18034  |                End If                            ||17755  |                End If                            
18035  |            End If                                ||17756  |            End If                                
18036  |            'RAFI対応 END                         ||17757  |            'RAFI対応 END                         
18037  |            'gTotalCnt = gTotalCnt + 1            ||17758  |            'gTotalCnt = gTotalCnt + 1            
18038  |            'RAFI対応 START                       ||17759  |            'RAFI対応 START                       
18039  |            '純資産の場合                         ||17760  |            '純資産の場合                         
18040  |            If msAssetFlg = "0" Then              ||17761  |            If msAssetFlg = "0" Then              
18041  |                '複数ページの場合                 ||17762  |                '複数ページの場合                 
18042  |                If dintPage > 1 Then              ||17763  |                If dintPage > 1 Then              
18043  |                    xlBook.Sheets(gProcessCnt).Nam||17764  |                    xlBook.Sheets(gProcessCnt).Nam
18044  |                Else                              ||17765  |                Else                              
18045  |                    xlBook.Sheets(gProcessCnt).Nam||17766  |                    xlBook.Sheets(gProcessCnt).Nam
18046  |                End If                            ||17767  |                End If                            
18047  |            'マザー組入資産の場合                 ||17768  |            'マザー組入資産の場合                 
18048  |            Else                                  ||17769  |            Else                                  
18049  |                '複数ページの場合                 ||17770  |                '複数ページの場合                 
18050  |                If dintPage > 1 Then              ||17771  |                If dintPage > 1 Then              
18051  |                    xlBook.Sheets(gProcessCnt).Nam||17772  |                    xlBook.Sheets(gProcessCnt).Nam
18052  |                Else                              ||17773  |                Else                              
18053  |                    xlBook.Sheets(gProcessCnt).Nam||17774  |                    xlBook.Sheets(gProcessCnt).Nam
18054  |                End If                            ||17775  |                End If                            
18055  |            End If                                ||17776  |            End If                                
18056  |            'RAFI対応 END                         ||17777  |            'RAFI対応 END                         
18057  |            'シートの余白を設定                   ||17778  |            'シートの余白を設定                   
18058  |            xlSheet.PageSetup.TopMargin = Applicat||17779  |            xlSheet.PageSetup.TopMargin = Applicat
18059  |            xlSheet.PageSetup.BottomMargin = Appli||17780  |            xlSheet.PageSetup.BottomMargin = Appli
18060  |            xlSheet.PageSetup.LeftMargin = Applica||17781  |            xlSheet.PageSetup.LeftMargin = Applica
18061  |            xlSheet.PageSetup.RightMargin = Applic||17782  |            xlSheet.PageSetup.RightMargin = Applic
18062  |                                                  ||17783  |                                                  
18063  |            DoEvents                              ||17784  |            DoEvents                              
18064  |                                                  ||17785  |                                                  
18065  |            With xlSheet                          ||17786  |            With xlSheet                          
18066  |                '題目                             ||17787  |                '題目                             
18067  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||17788  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
18068  |                '取得NAV区分が4:日次時価総額平均の||17789  |                '取得NAV区分が4:日次時価総額平均の
18069  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||17790  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
18070  |                    .Cells(5, 1).Value = sWord63  ||17791  |                    .Cells(5, 1).Value = sWord63  
18071  |                Else                              ||17792  |                Else                              
18072  |                    .Cells(5, 1).Value = sWord47  ||17793  |                    .Cells(5, 1).Value = sWord47  
18073  |                End If                            ||17794  |                End If                            
18074  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||17795  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
18075  |                .Cells(5, 1).Font.Size = 14       ||17796  |                .Cells(5, 1).Font.Size = 14       
18076  |                .Range("A5:BG5").HorizontalAlignme||17797  |                .Range("A5:BG5").HorizontalAlignme
18077  |                '出力日付                         ||17798  |                '出力日付                         
18078  |                If RTrim(txtSysOutDate.Text) = "" ||17799  |                If RTrim(txtSysOutDate.Text) = "" 
18079  |                    .Cells(3, 50).Value = sWord34 ||17800  |                    .Cells(3, 50).Value = sWord34 
18080  |                    .Cells(3, 50).HorizontalAlignm||17801  |                    .Cells(3, 50).HorizontalAlignm
18081  |                Else                              ||17802  |                Else                              
18082  |                    .Cells(3, 43).Value = CStr(For||17803  |                    .Cells(3, 43).Value = CStr(For
18083  |                End If                            ||17804  |                End If                            
18084  |                'ファンド名                       ||17805  |                'ファンド名                       
18085  |                .Cells(6, 2).Value = sWord4       ||17806  |                .Cells(6, 2).Value = sWord4       
18086  |                .Cells(6, 11).Value = sWord19     ||17807  |                .Cells(6, 11).Value = sWord19     
18087  |                .Cells(6, 13).Value = gbuMGetUPDRe||17808  |                .Cells(6, 13).Value = gbuMGetUPDRe
18088  |                'ファンドコード                   ||17809  |                'ファンドコード                   
18089  |                .Cells(7, 2).Value = sWord4_2     ||17810  |                .Cells(7, 2).Value = sWord4_2     
18090  |                .Cells(7, 11).Value = sWord19     ||17811  |                .Cells(7, 11).Value = sWord19     
18091  |                .Cells(7, 13).NumberFormatLocal = ||17812  |                .Cells(7, 13).NumberFormatLocal = 
18092  |                'RAFI対応 START                   ||17813  |                'RAFI対応 START                   
18093  |                '純資産の場合                     ||17814  |                '純資産の場合                     
18094  |                If msAssetFlg = "0" Then          ||17815  |                If msAssetFlg = "0" Then          
18095  |                    .Cells(7, 13).Value = sGetAccC||17816  |                    .Cells(7, 13).Value = sGetAccC
18096  |                'マザー組入資産の場合             ||17817  |                'マザー組入資産の場合             
18097  |                Else                              ||17818  |                Else                              
18098  |                    .Cells(7, 13).Value = msBabyAc||17819  |                    .Cells(7, 13).Value = msBabyAc
18099  |                End If                            ||17820  |                End If                            
18100  |                'RAFI対応 END                     ||17821  |                'RAFI対応 END                     
18101  |                                                  ||17822  |                                                  
18102  |                '計算期間                         ||17823  |                '計算期間                         
18103  |                .Cells(8, 2).Value = sWord5       ||17824  |                .Cells(8, 2).Value = sWord5       
18104  |                .Cells(8, 11).Value = sWord19     ||17825  |                .Cells(8, 11).Value = sWord19     
18105  |                If Mid(gbuMGetUPDRec.N(lRecIdx).MG||17826  |                If Mid(gbuMGetUPDRec.N(lRecIdx).MG
18106  |                And gbuMGetUPDRec.N(lRecIdx).MGET_||17827  |                And gbuMGetUPDRec.N(lRecIdx).MGET_
18107  |                    .Cells(8, 13).Value = _       ||17828  |                    .Cells(8, 13).Value = _       
18108  |                        CStr(Format(dStart, "YYYY ||17829  |                        CStr(Format(dStart, "YYYY 
18109  |                Else                              ||17830  |                Else                              
18110  |                    .Cells(8, 13).Value = _       ||17831  |                    .Cells(8, 13).Value = _       
18111  |                        CStr(Format(dStart, "YYYY ||17832  |                        CStr(Format(dStart, "YYYY 
18112  |                End If                            ||17833  |                End If                            
18113  |                '日付                             ||17834  |                '日付                             
18114  |                .Cells(10, 3).Value = sWord7      ||17835  |                .Cells(10, 3).Value = sWord7      
18115  |                .Range("C10:N10").HorizontalAlignm||17836  |                .Range("C10:N10").HorizontalAlignm
18116  |                '純資産                           ||17837  |                '純資産                           
18117  |                .Cells(10, 15).Value = sWord8     ||17838  |                .Cells(10, 15).Value = sWord8     
18118  |                .Range("O10:AC10").HorizontalAlign||17839  |                .Range("O10:AC10").HorizontalAlign
18119  |                '日付                             ||17840  |                '日付                             
18120  |                .Cells(10, 31).Value = sWord7     ||17841  |                .Cells(10, 31).Value = sWord7     
18121  |                .Range("AE10:AP10").HorizontalAlig||17842  |                .Range("AE10:AP10").HorizontalAlig
18122  |                '純資産                           ||17843  |                '純資産                           
18123  |                .Cells(10, 43).Value = sWord8     ||17844  |                .Cells(10, 43).Value = sWord8     
18124  |                .Range("AQ10:BE10").HorizontalAlig||17845  |                .Range("AQ10:BE10").HorizontalAlig
18125  |                '日付＆NAV                        ||17846  |                '日付＆NAV                        
18126  |                Select Case L                     ||17847  |                Select Case L                     
18127  |                    Case 1                        ||17848  |                    Case 1                        
18128  |                        dintPageIni = 1           ||17849  |                        dintPageIni = 1           
18129  |                    Case Else                     ||17850  |                    Case Else                     
18130  |                        dintPageIni = dintPageIni ||17851  |                        dintPageIni = dintPageIni 
18131  |                End Select                        ||17852  |                End Select                        
18132  |                For dintFor = dintPageIni To dlngC||17853  |                For dintFor = dintPageIni To dlngC
18133  |                    If J < 54 Then                ||17854  |                    If J < 54 Then                
18134  |                        If dintFor = dlngCnt + 1 T||17855  |                        If dintFor = dlngCnt + 1 T
18135  |                            '合計                 ||17856  |                            '合計                 
18136  |                            .Cells(11 + J, 3).Valu||17857  |                            .Cells(11 + J, 3).Valu
18137  |                            'NAV                  ||17858  |                            'NAV                  
18138  |                            .Cells(11 + J, 28).Num||17859  |                            .Cells(11 + J, 28).Num
18139  |                            If gbuMGetUPDRec.N(lRe||17860  |                            If gbuMGetUPDRec.N(lRe
18140  |                                .Cells(11 + J, 28)||17861  |                                .Cells(11 + J, 28)
18141  |                            Else                  ||17862  |                            Else                  
18142  |                                .Cells(11 + J, 28)||17863  |                                .Cells(11 + J, 28)
18143  |                            End If                ||17864  |                            End If                
18144  |                            .Cells(11 + J, 28).Hor||17865  |                            .Cells(11 + J, 28).Hor
18145  |                        End If                    ||17866  |                        End If                    
18146  |                        If dintFor = dlngCnt + 2 T||17867  |                        If dintFor = dlngCnt + 2 T
18147  |                            '平均                 ||17868  |                            '平均                 
18148  |                            .Cells(11 + J, 3).Valu||17869  |                            .Cells(11 + J, 3).Valu
18149  |                            'NAV                  ||17870  |                            'NAV                  
18150  |                            .Cells(11 + J, 28).Num||17871  |                            .Cells(11 + J, 28).Num
18151  |                            If gbuMGetUPDRec.N(lRe||17872  |                            If gbuMGetUPDRec.N(lRe
18152  |                                .Cells(11 + J, 28)||17873  |                                .Cells(11 + J, 28)
18153  |                            Else                  ||17874  |                            Else                  
18154  |                                .Cells(11 + J, 28)||17875  |                                .Cells(11 + J, 28)
18155  |                            End If                ||17876  |                            End If                
18156  |                            .Cells(11 + J, 28).Hor||17877  |                            .Cells(11 + J, 28).Hor
18157  |                        End If                    ||17878  |                        End If                    
18158  |                        If dintFor < dlngCnt + 1 T||17879  |                        If dintFor < dlngCnt + 1 T
18159  |                            '日付                 ||17880  |                            '日付                 
18160  |                            dCalDate = CDate(gstrD||17881  |                            dCalDate = CDate(gstrD
18161  |                            .Cells(11 + J, 4).Valu||17882  |                            .Cells(11 + J, 4).Valu
18162  |                                CStr(Format(dCalDa||17883  |                                CStr(Format(dCalDa
18163  |                            'NAV                  ||17884  |                            'NAV                  
18164  |                            .Cells(11 + J, 28).Num||17885  |                            .Cells(11 + J, 28).Num
18165  |                            If gbuMGetUPDRec.N(lRe||17886  |                            If gbuMGetUPDRec.N(lRe
18166  |                                .Cells(11 + J, 28)||17887  |                                .Cells(11 + J, 28)
18167  |                            Else                  ||17888  |                            Else                  
18168  |                                .Cells(11 + J, 28)||17889  |                                .Cells(11 + J, 28)
18169  |                            End If                ||17890  |                            End If                
18170  |                            .Cells(11 + J, 28).Hor||17891  |                            .Cells(11 + J, 28).Hor
18171  |                        End If                    ||17892  |                        End If                    
18172  |                    Else                          ||17893  |                    Else                          
18173  |                        If dintFor = dlngCnt + 1 T||17894  |                        If dintFor = dlngCnt + 1 T
18174  |                            '合計                 ||17895  |                            '合計                 
18175  |                            .Cells(11 + K, 31).Val||17896  |                            .Cells(11 + K, 31).Val
18176  |                            'NAV                  ||17897  |                            'NAV                  
18177  |                            .Cells(11 + K, 56).Num||17898  |                            .Cells(11 + K, 56).Num
18178  |                            If gbuMGetUPDRec.N(lRe||17899  |                            If gbuMGetUPDRec.N(lRe
18179  |                                .Cells(11 + K, 56)||17900  |                                .Cells(11 + K, 56)
18180  |                            Else                  ||17901  |                            Else                  
18181  |                                .Cells(11 + K, 56)||17902  |                                .Cells(11 + K, 56)
18182  |                            End If                ||17903  |                            End If                
18183  |                            .Cells(11 + K, 56).Hor||17904  |                            .Cells(11 + K, 56).Hor
18184  |                        End If                    ||17905  |                        End If                    
18185  |                        If dintFor = dlngCnt + 2 T||17906  |                        If dintFor = dlngCnt + 2 T
18186  |                            '平均                 ||17907  |                            '平均                 
18187  |                            .Cells(11 + K, 31).Val||17908  |                            .Cells(11 + K, 31).Val
18188  |                            'NAV                  ||17909  |                            'NAV                  
18189  |                            .Cells(11 + K, 56).Num||17910  |                            .Cells(11 + K, 56).Num
18190  |                            If gbuMGetUPDRec.N(lRe||17911  |                            If gbuMGetUPDRec.N(lRe
18191  |                                .Cells(11 + K, 56)||17912  |                                .Cells(11 + K, 56)
18192  |                            Else                  ||17913  |                            Else                  
18193  |                                .Cells(11 + K, 56)||17914  |                                .Cells(11 + K, 56)
18194  |                            End If                ||17915  |                            End If                
18195  |                            .Cells(11 + K, 56).Hor||17916  |                            .Cells(11 + K, 56).Hor
18196  |                        End If                    ||17917  |                        End If                    
18197  |                        If dintFor < dlngCnt + 1 T||17918  |                        If dintFor < dlngCnt + 1 T
18198  |                            '日付                 ||17919  |                            '日付                 
18199  |                            dCalDate = CDate(gstrD||17920  |                            dCalDate = CDate(gstrD
18200  |                            .Cells(11 + K, 32).Val||17921  |                            .Cells(11 + K, 32).Val
18201  |                                CStr(Format(dCalDa||17922  |                                CStr(Format(dCalDa
18202  |                            'NAV                  ||17923  |                            'NAV                  
18203  |                            .Cells(11 + K, 56).Num||17924  |                            .Cells(11 + K, 56).Num
18204  |                            If gbuMGetUPDRec.N(lRe||17925  |                            If gbuMGetUPDRec.N(lRe
18205  |                                .Cells(11 + K, 56)||17926  |                                .Cells(11 + K, 56)
18206  |                            Else                  ||17927  |                            Else                  
18207  |                                .Cells(11 + K, 56)||17928  |                                .Cells(11 + K, 56)
18208  |                            End If                ||17929  |                            End If                
18209  |                            .Cells(11 + K, 56).Hor||17930  |                            .Cells(11 + K, 56).Hor
18210  |                        End If                    ||17931  |                        End If                    
18211  |                        K = K + 1                 ||17932  |                        K = K + 1                 
18212  |                        If K > 53 Then            ||17933  |                        If K > 53 Then            
18213  |                            J = 0                 ||17934  |                            J = 0                 
18214  |                            K = 0                 ||17935  |                            K = 0                 
18215  |                            Exit For              ||17936  |                            Exit For              
18216  |                        End If                    ||17937  |                        End If                    
18217  |                    End If                        ||17938  |                    End If                        
18218  |                    J = J + 1                     ||17939  |                    J = J + 1                     
18219  |                    'ループ終了したらフラグをON   ||17940  |                    'ループ終了したらフラグをON   
18220  |                    If dintFor = (dlngCnt + 2) The||17941  |                    If dintFor = (dlngCnt + 2) The
18221  |                        EndFlg = True             ||17942  |                        EndFlg = True             
18222  |                        '平均の終了行の次行を取得 ||17943  |                        '平均の終了行の次行を取得 
18223  |                        If K = 0 Then             ||17944  |                        If K = 0 Then             
18224  |                            intRange = J + 11     ||17945  |                            intRange = J + 11     
18225  |                            strRange = "J"        ||17946  |                            strRange = "J"        
18226  |                        ElseIf K <> 0 Then        ||17947  |                        ElseIf K <> 0 Then        
18227  |                            intRange = K + 11     ||17948  |                            intRange = K + 11     
18228  |                            strRange = "K"        ||17949  |                            strRange = "K"        
18229  |                        Else                      ||17950  |                        Else                      
18230  |                            intRange = 11         ||17951  |                            intRange = 11         
18231  |                            strRange = "J"        ||17952  |                            strRange = "J"        
18232  |                        End If                    ||17953  |                        End If                    
18233  |                        J = 0                     ||17954  |                        J = 0                     
18234  |                        K = 0                     ||17955  |                        K = 0                     
18235  |                    End If                        ||17956  |                    End If                        
18236  |                Next dintFor                      ||17957  |                Next dintFor                      
18237  |                                                  ||17958  |                                                  
18238  |                '左側日付                         ||17959  |                '左側日付                         
18239  |                With xlSheet.Range("C10:N64").Bord||17960  |                With xlSheet.Range("C10:N64").Bord
18240  |                    .LineStyle = xlContinuous     ||17961  |                    .LineStyle = xlContinuous     
18241  |                    .Weight = xlThin              ||17962  |                    .Weight = xlThin              
18242  |                End With                          ||17963  |                End With                          
18243  |                With xlSheet.Range("C10:N64").Bord||17964  |                With xlSheet.Range("C10:N64").Bord
18244  |                    .LineStyle = xlContinuous     ||17965  |                    .LineStyle = xlContinuous     
18245  |                    .Weight = xlThin              ||17966  |                    .Weight = xlThin              
18246  |                End With                          ||17967  |                End With                          
18247  |                With xlSheet.Range("C10:N64").Bord||17968  |                With xlSheet.Range("C10:N64").Bord
18248  |                    .LineStyle = xlContinuous     ||17969  |                    .LineStyle = xlContinuous     
18249  |                    .Weight = xlThin              ||17970  |                    .Weight = xlThin              
18250  |                End With                          ||17971  |                End With                          
18251  |                With xlSheet.Range("C10:N64").Bord||17972  |                With xlSheet.Range("C10:N64").Bord
18252  |                    .LineStyle = xlContinuous     ||17973  |                    .LineStyle = xlContinuous     
18253  |                    .Weight = xlThin              ||17974  |                    .Weight = xlThin              
18254  |                End With                          ||17975  |                End With                          
18255  |                With xlSheet.Range("C10:N64").Bord||17976  |                With xlSheet.Range("C10:N64").Bord
18256  |                    .LineStyle = xlContinuous     ||17977  |                    .LineStyle = xlContinuous     
18257  |                    .Weight = xlThin              ||17978  |                    .Weight = xlThin              
18258  |                End With                          ||17979  |                End With                          
18259  |                                                  ||17980  |                                                  
18260  |                '左側純資産                       ||17981  |                '左側純資産                       
18261  |                With xlSheet.Range("O10:AC64").Bor||17982  |                With xlSheet.Range("O10:AC64").Bor
18262  |                    .LineStyle = xlContinuous     ||17983  |                    .LineStyle = xlContinuous     
18263  |                    .Weight = xlThin              ||17984  |                    .Weight = xlThin              
18264  |                End With                          ||17985  |                End With                          
18265  |                With xlSheet.Range("O10:AC64").Bor||17986  |                With xlSheet.Range("O10:AC64").Bor
18266  |                    .LineStyle = xlContinuous     ||17987  |                    .LineStyle = xlContinuous     
18267  |                    .Weight = xlThin              ||17988  |                    .Weight = xlThin              
18268  |                End With                          ||17989  |                End With                          
18269  |                With xlSheet.Range("O10:AC64").Bor||17990  |                With xlSheet.Range("O10:AC64").Bor
18270  |                    .LineStyle = xlContinuous     ||17991  |                    .LineStyle = xlContinuous     
18271  |                    .Weight = xlThin              ||17992  |                    .Weight = xlThin              
18272  |                End With                          ||17993  |                End With                          
18273  |                With xlSheet.Range("O10:AC64").Bor||17994  |                With xlSheet.Range("O10:AC64").Bor
18274  |                    .LineStyle = xlContinuous     ||17995  |                    .LineStyle = xlContinuous     
18275  |                    .Weight = xlThin              ||17996  |                    .Weight = xlThin              
18276  |                End With                          ||17997  |                End With                          
18277  |                With xlSheet.Range("O10:AC64").Bor||17998  |                With xlSheet.Range("O10:AC64").Bor
18278  |                    .LineStyle = xlContinuous     ||17999  |                    .LineStyle = xlContinuous     
18279  |                    .Weight = xlThin              ||18000  |                    .Weight = xlThin              
18280  |                End With                          ||18001  |                End With                          
18281  |                                                  ||18002  |                                                  
18282  |                '右側日付                         ||18003  |                '右側日付                         
18283  |                With xlSheet.Range("AE10:AP64").Bo||18004  |                With xlSheet.Range("AE10:AP64").Bo
18284  |                    .LineStyle = xlContinuous     ||18005  |                    .LineStyle = xlContinuous     
18285  |                    .Weight = xlThin              ||18006  |                    .Weight = xlThin              
18286  |                End With                          ||18007  |                End With                          
18287  |                With xlSheet.Range("AE10:AP64").Bo||18008  |                With xlSheet.Range("AE10:AP64").Bo
18288  |                    .LineStyle = xlContinuous     ||18009  |                    .LineStyle = xlContinuous     
18289  |                    .Weight = xlThin              ||18010  |                    .Weight = xlThin              
18290  |                End With                          ||18011  |                End With                          
18291  |                With xlSheet.Range("AE10:AP64").Bo||18012  |                With xlSheet.Range("AE10:AP64").Bo
18292  |                    .LineStyle = xlContinuous     ||18013  |                    .LineStyle = xlContinuous     
18293  |                    .Weight = xlThin              ||18014  |                    .Weight = xlThin              
18294  |                End With                          ||18015  |                End With                          
18295  |                With xlSheet.Range("AE10:AP64").Bo||18016  |                With xlSheet.Range("AE10:AP64").Bo
18296  |                    .LineStyle = xlContinuous     ||18017  |                    .LineStyle = xlContinuous     
18297  |                    .Weight = xlThin              ||18018  |                    .Weight = xlThin              
18298  |                End With                          ||18019  |                End With                          
18299  |                With xlSheet.Range("AE10:AP64").Bo||18020  |                With xlSheet.Range("AE10:AP64").Bo
18300  |                    .LineStyle = xlContinuous     ||18021  |                    .LineStyle = xlContinuous     
18301  |                    .Weight = xlThin              ||18022  |                    .Weight = xlThin              
18302  |                End With                          ||18023  |                End With                          
18303  |                                                  ||18024  |                                                  
18304  |                '右側純資産                       ||18025  |                '右側純資産                       
18305  |                With xlSheet.Range("AQ10:BE64").Bo||18026  |                With xlSheet.Range("AQ10:BE64").Bo
18306  |                    .LineStyle = xlContinuous     ||18027  |                    .LineStyle = xlContinuous     
18307  |                    .Weight = xlThin              ||18028  |                    .Weight = xlThin              
18308  |                End With                          ||18029  |                End With                          
18309  |                With xlSheet.Range("AQ10:BE64").Bo||18030  |                With xlSheet.Range("AQ10:BE64").Bo
18310  |                    .LineStyle = xlContinuous     ||18031  |                    .LineStyle = xlContinuous     
18311  |                    .Weight = xlThin              ||18032  |                    .Weight = xlThin              
18312  |                End With                          ||18033  |                End With                          
18313  |                With xlSheet.Range("AQ10:BE64").Bo||18034  |                With xlSheet.Range("AQ10:BE64").Bo
18314  |                    .LineStyle = xlContinuous     ||18035  |                    .LineStyle = xlContinuous     
18315  |                    .Weight = xlThin              ||18036  |                    .Weight = xlThin              
18316  |                End With                          ||18037  |                End With                          
18317  |                With xlSheet.Range("AQ10:BE64").Bo||18038  |                With xlSheet.Range("AQ10:BE64").Bo
18318  |                    .LineStyle = xlContinuous     ||18039  |                    .LineStyle = xlContinuous     
18319  |                    .Weight = xlThin              ||18040  |                    .Weight = xlThin              
18320  |                End With                          ||18041  |                End With                          
18321  |                With xlSheet.Range("AQ10:BE64").Bo||18042  |                With xlSheet.Range("AQ10:BE64").Bo
18322  |                    .LineStyle = xlContinuous     ||18043  |                    .LineStyle = xlContinuous     
18323  |                    .Weight = xlThin              ||18044  |                    .Weight = xlThin              
18324  |                End With                          ||18045  |                End With                          
18325  |                                                  ||18046  |                                                  
18326  |            End With                              ||18047  |            End With                              
18327  |                                                  ||18048  |                                                  
18328  |                                                  ||18049  |                                                  
18329  |                                                  ||18050  |                                                  
18330  |            '日次NAV平均の出力が終了したら料率別平||18051  |            '日次NAV平均の出力が終了したら料率別平
18331  |            If EndFlg = True Then                 ||18052  |            If EndFlg = True Then                 
18332  |                With xlSheet                      ||18053  |                With xlSheet                      
18333  |                    For dintFor = SetPoint + AddPo||18054  |                    For dintFor = SetPoint + AddPo
18334  |                        If dintFor = 0 Then       ||18055  |                        If dintFor = 0 Then       
18335  |                            If strRange = "J" Then||18056  |                            If strRange = "J" Then
18336  |                                If intRange = 11 T||18057  |                                If intRange = 11 T
18337  |                                    '余白無し     ||18058  |                                    '余白無し     
18338  |                                    '日付         ||18059  |                                    '日付         
18339  |                                    .Cells(intRang||18060  |                                    .Cells(intRang
18340  |                                        sWord60 & ||18061  |                                        sWord60 & 
18341  |                                    J = J + 1     ||18062  |                                    J = J + 1     
18342  |                                    .Cells(intRang||18063  |                                    .Cells(intRang
18343  |                                    dblValueIn = g||18064  |                                    dblValueIn = g
18344  |                                    .Cells(intRang||18065  |                                    .Cells(intRang
18345  |                                    '平均純資産   ||18066  |                                    '平均純資産   
18346  |                                    dblValueIn = g||18067  |                                    dblValueIn = g
18347  |                                    If gtypOtherCo||18068  |                                    If gtypOtherCo
18348  |                                          Call sbG||18069  |                                          Call sbG
18349  |                                    Else          ||18070  |                                    Else          
18350  |                                          Call sbG||18071  |                                          Call sbG
18351  |                                    End If        ||18072  |                                    End If        
18352  |                                    If gtypOtherCo||18073  |                                    If gtypOtherCo
18353  |                                        .Cells(int||18074  |                                        .Cells(int
18354  |                                    Else          ||18075  |                                    Else          
18355  |                                        .Cells(int||18076  |                                        .Cells(int
18356  |                                    End If        ||18077  |                                    End If        
18357  |                                    'If gtypOtherC||18078  |                                    'If gtypOtherC
18358  |                                    '    .Cells(in||18079  |                                    '    .Cells(in
18359  |                                    'Else         ||18080  |                                    'Else         
18360  |                                    '    .Cells(in||18081  |                                    '    .Cells(in
18361  |                                    'End If       ||18082  |                                    'End If       
18362  |                                    .Cells(intRang||18083  |                                    .Cells(intRang
18363  |                                    strRange = "J"||18084  |                                    strRange = "J"
18364  |                                    intRange = int||18085  |                                    intRange = int
18365  |                                ElseIf intRange <>||18086  |                                ElseIf intRange <>
18366  |                                    '余白有り     ||18087  |                                    '余白有り     
18367  |                                    J = J + 2     ||18088  |                                    J = J + 2     
18368  |                                    '日付         ||18089  |                                    '日付         
18369  |                                    .Cells(intRang||18090  |                                    .Cells(intRang
18370  |                                        sWord60 & ||18091  |                                        sWord60 & 
18371  |                                    J = J + 1     ||18092  |                                    J = J + 1     
18372  |                                    .Cells(intRang||18093  |                                    .Cells(intRang
18373  |                                    .Cells(intRang||18094  |                                    .Cells(intRang
18374  |                                    '平均純資産   ||18095  |                                    '平均純資産   
18375  |                                    dblValueIn = g||18096  |                                    dblValueIn = g
18376  |                                    If gtypOtherCo||18097  |                                    If gtypOtherCo
18377  |                                          Call sbG||18098  |                                          Call sbG
18378  |                                    Else          ||18099  |                                    Else          
18379  |                                          Call sbG||18100  |                                          Call sbG
18380  |                                    End If        ||18101  |                                    End If        
18381  |                                    If gtypOtherCo||18102  |                                    If gtypOtherCo
18382  |                                        .Cells(int||18103  |                                        .Cells(int
18383  |                                    Else          ||18104  |                                    Else          
18384  |                                        .Cells(int||18105  |                                        .Cells(int
18385  |                                    End If        ||18106  |                                    End If        
18386  |                                    'If gtypOtherC||18107  |                                    'If gtypOtherC
18387  |                                    '    .Cells(in||18108  |                                    '    .Cells(in
18388  |                                    'Else         ||18109  |                                    'Else         
18389  |                                    '    .Cells(in||18110  |                                    '    .Cells(in
18390  |                                    'End If       ||18111  |                                    'End If       
18391  |                                    .Cells(intRang||18112  |                                    .Cells(intRang
18392  |                                    strRange = "J"||18113  |                                    strRange = "J"
18393  |                                    intRange = int||18114  |                                    intRange = int
18394  |                                Else              ||18115  |                                Else              
18395  |                                    '余白無し     ||18116  |                                    '余白無し     
18396  |                                    '日付         ||18117  |                                    '日付         
18397  |                                    .Cells(11 + K,||18118  |                                    .Cells(11 + K,
18398  |                                        sWord60 & ||18119  |                                        sWord60 & 
18399  |                                    K = K + 1     ||18120  |                                    K = K + 1     
18400  |                                    .Cells(11 + K,||18121  |                                    .Cells(11 + K,
18401  |                                    .Cells(11 + K,||18122  |                                    .Cells(11 + K,
18402  |                                    '平均純資産   ||18123  |                                    '平均純資産   
18403  |                                    dblValueIn = g||18124  |                                    dblValueIn = g
18404  |                                    If gtypOtherCo||18125  |                                    If gtypOtherCo
18405  |                                          Call sbG||18126  |                                          Call sbG
18406  |                                    Else          ||18127  |                                    Else          
18407  |                                          Call sbG||18128  |                                          Call sbG
18408  |                                    End If        ||18129  |                                    End If        
18409  |                                    If gtypOtherCo||18130  |                                    If gtypOtherCo
18410  |                                        .Cells(11 ||18131  |                                        .Cells(11 
18411  |                                    Else          ||18132  |                                    Else          
18412  |                                        .Cells(11 ||18133  |                                        .Cells(11 
18413  |                                    End If        ||18134  |                                    End If        
18414  |                                    'If gtypOtherC||18135  |                                    'If gtypOtherC
18415  |                                    '    .Cells(11||18136  |                                    '    .Cells(11
18416  |                                    'Else         ||18137  |                                    'Else         
18417  |                                    '    .Cells(11||18138  |                                    '    .Cells(11
18418  |                                    'End If       ||18139  |                                    'End If       
18419  |                                    .Cells(11 + K,||18140  |                                    .Cells(11 + K,
18420  |                                    strRange = "K"||18141  |                                    strRange = "K"
18421  |                                    intRange = 11 ||18142  |                                    intRange = 11 
18422  |                                End If            ||18143  |                                End If            
18423  |                                J = 0             ||18144  |                                J = 0             
18424  |                                K = 0             ||18145  |                                K = 0             
18425  |                            'K                    ||18146  |                            'K                    
18426  |                            Else                  ||18147  |                            Else                  
18427  |                                If intRange = 11 T||18148  |                                If intRange = 11 T
18428  |                                    '余白無し     ||18149  |                                    '余白無し     
18429  |                                    '日付         ||18150  |                                    '日付         
18430  |                                    .Cells(intRang||18151  |                                    .Cells(intRang
18431  |                                        sWord60 & ||18152  |                                        sWord60 & 
18432  |                                    K = K + 1     ||18153  |                                    K = K + 1     
18433  |                                    .Cells(intRang||18154  |                                    .Cells(intRang
18434  |                                    .Cells(intRang||18155  |                                    .Cells(intRang
18435  |                                    '平均純資産   ||18156  |                                    '平均純資産   
18436  |                                    dblValueIn = g||18157  |                                    dblValueIn = g
18437  |                                    If gtypOtherCo||18158  |                                    If gtypOtherCo
18438  |                                          Call sbG||18159  |                                          Call sbG
18439  |                                    Else          ||18160  |                                    Else          
18440  |                                          Call sbG||18161  |                                          Call sbG
18441  |                                    End If        ||18162  |                                    End If        
18442  |                                    If gtypOtherCo||18163  |                                    If gtypOtherCo
18443  |                                        .Cells(int||18164  |                                        .Cells(int
18444  |                                    Else          ||18165  |                                    Else          
18445  |                                        .Cells(int||18166  |                                        .Cells(int
18446  |                                    End If        ||18167  |                                    End If        
18447  |                                    'If gtypOtherC||18168  |                                    'If gtypOtherC
18448  |                                    '    .Cells(in||18169  |                                    '    .Cells(in
18449  |                                    'Else         ||18170  |                                    'Else         
18450  |                                    '    .Cells(in||18171  |                                    '    .Cells(in
18451  |                                    'End If       ||18172  |                                    'End If       
18452  |                                    .Cells(intRang||18173  |                                    .Cells(intRang
18453  |                                    strRange = "K"||18174  |                                    strRange = "K"
18454  |                                    intRange = int||18175  |                                    intRange = int
18455  |                                ElseIf intRange <>||18176  |                                ElseIf intRange <>
18456  |                                    '余白有り     ||18177  |                                    '余白有り     
18457  |                                    K = K + 2     ||18178  |                                    K = K + 2     
18458  |                                    '日付         ||18179  |                                    '日付         
18459  |                                    .Cells(intRang||18180  |                                    .Cells(intRang
18460  |                                        sWord60 & ||18181  |                                        sWord60 & 
18461  |                                    K = K + 1     ||18182  |                                    K = K + 1     
18462  |                                    .Cells(intRang||18183  |                                    .Cells(intRang
18463  |                                    .Cells(intRang||18184  |                                    .Cells(intRang
18464  |                                    '平均純資産   ||18185  |                                    '平均純資産   
18465  |                                    dblValueIn = g||18186  |                                    dblValueIn = g
18466  |                                    If gtypOtherCo||18187  |                                    If gtypOtherCo
18467  |                                          Call sbG||18188  |                                          Call sbG
18468  |                                    Else          ||18189  |                                    Else          
18469  |                                          Call sbG||18190  |                                          Call sbG
18470  |                                    End If        ||18191  |                                    End If        
18471  |                                    If gtypOtherCo||18192  |                                    If gtypOtherCo
18472  |                                        .Cells(int||18193  |                                        .Cells(int
18473  |                                    Else          ||18194  |                                    Else          
18474  |                                        .Cells(int||18195  |                                        .Cells(int
18475  |                                    End If        ||18196  |                                    End If        
18476  |                                    'If gtypOtherC||18197  |                                    'If gtypOtherC
18477  |                                    '    .Cells(in||18198  |                                    '    .Cells(in
18478  |                                    'Else         ||18199  |                                    'Else         
18479  |                                    '    .Cells(in||18200  |                                    '    .Cells(in
18480  |                                    'End If       ||18201  |                                    'End If       
18481  |                                    .Cells(intRang||18202  |                                    .Cells(intRang
18482  |                                    strRange = "K"||18203  |                                    strRange = "K"
18483  |                                    intRange = int||18204  |                                    intRange = int
18484  |                                Else              ||18205  |                                Else              
18485  |                                    J = 0         ||18206  |                                    J = 0         
18486  |                                    K = 0         ||18207  |                                    K = 0         
18487  |                                    strRange = "J"||18208  |                                    strRange = "J"
18488  |                                    intRange = 11 ||18209  |                                    intRange = 11 
18489  |                                                  ||18210  |                                                  
18490  |                                    AddPoint = din||18211  |                                    AddPoint = din
18491  |                                    Exit For      ||18212  |                                    Exit For      
18492  |                                End If            ||18213  |                                End If            
18493  |                                J = 0             ||18214  |                                J = 0             
18494  |                                K = 0             ||18215  |                                K = 0             
18495  |                            End If                ||18216  |                            End If                
18496  |                        'ループ二回目以降         ||18217  |                        'ループ二回目以降         
18497  |                        Else                      ||18218  |                        Else                      
18498  |                            If strRange = "J" Then||18219  |                            If strRange = "J" Then
18499  |                                If intRange = 11 T||18220  |                                If intRange = 11 T
18500  |                                    '余白無し     ||18221  |                                    '余白無し     
18501  |                                    '日付         ||18222  |                                    '日付         
18502  |                                    .Cells(intRang||18223  |                                    .Cells(intRang
18503  |                                        sWord60 & ||18224  |                                        sWord60 & 
18504  |                                    J = J + 1     ||18225  |                                    J = J + 1     
18505  |                                    .Cells(intRang||18226  |                                    .Cells(intRang
18506  |                                    .Cells(intRang||18227  |                                    .Cells(intRang
18507  |                                    '平均純資産   ||18228  |                                    '平均純資産   
18508  |                                    dblValueIn = g||18229  |                                    dblValueIn = g
18509  |                                    If gtypOtherCo||18230  |                                    If gtypOtherCo
18510  |                                          Call sbG||18231  |                                          Call sbG
18511  |                                    Else          ||18232  |                                    Else          
18512  |                                          Call sbG||18233  |                                          Call sbG
18513  |                                    End If        ||18234  |                                    End If        
18514  |                                    If gtypOtherCo||18235  |                                    If gtypOtherCo
18515  |                                        .Cells(int||18236  |                                        .Cells(int
18516  |                                    Else          ||18237  |                                    Else          
18517  |                                        .Cells(int||18238  |                                        .Cells(int
18518  |                                    End If        ||18239  |                                    End If        
18519  |                                    'If gtypOtherC||18240  |                                    'If gtypOtherC
18520  |                                    '    .Cells(in||18241  |                                    '    .Cells(in
18521  |                                    'Else         ||18242  |                                    'Else         
18522  |                                    '    .Cells(in||18243  |                                    '    .Cells(in
18523  |                                    'End If       ||18244  |                                    'End If       
18524  |                                    .Cells(intRang||18245  |                                    .Cells(intRang
18525  |                                    strRange = "J"||18246  |                                    strRange = "J"
18526  |                                    intRange = int||18247  |                                    intRange = int
18527  |                                ElseIf intRange <>||18248  |                                ElseIf intRange <>
18528  |                                    '余白有り     ||18249  |                                    '余白有り     
18529  |                                    J = J + 1     ||18250  |                                    J = J + 1     
18530  |                                    '日付         ||18251  |                                    '日付         
18531  |                                    .Cells(intRang||18252  |                                    .Cells(intRang
18532  |                                        sWord60 & ||18253  |                                        sWord60 & 
18533  |                                    J = J + 1     ||18254  |                                    J = J + 1     
18534  |                                    .Cells(intRang||18255  |                                    .Cells(intRang
18535  |                                    .Cells(intRang||18256  |                                    .Cells(intRang
18536  |                                    '平均純資産   ||18257  |                                    '平均純資産   
18537  |                                    dblValueIn = g||18258  |                                    dblValueIn = g
18538  |                                    If gtypOtherCo||18259  |                                    If gtypOtherCo
18539  |                                          Call sbG||18260  |                                          Call sbG
18540  |                                    Else          ||18261  |                                    Else          
18541  |                                          Call sbG||18262  |                                          Call sbG
18542  |                                    End If        ||18263  |                                    End If        
18543  |                                    If gtypOtherCo||18264  |                                    If gtypOtherCo
18544  |                                        .Cells(int||18265  |                                        .Cells(int
18545  |                                    Else          ||18266  |                                    Else          
18546  |                                        .Cells(int||18267  |                                        .Cells(int
18547  |                                    End If        ||18268  |                                    End If        
18548  |                                    'If gtypOtherC||18269  |                                    'If gtypOtherC
18549  |                                    '    .Cells(in||18270  |                                    '    .Cells(in
18550  |                                    'Else         ||18271  |                                    'Else         
18551  |                                    '    .Cells(in||18272  |                                    '    .Cells(in
18552  |                                    'End If       ||18273  |                                    'End If       
18553  |                                    .Cells(intRang||18274  |                                    .Cells(intRang
18554  |                                    strRange = "J"||18275  |                                    strRange = "J"
18555  |                                    intRange = int||18276  |                                    intRange = int
18556  |                                Else              ||18277  |                                Else              
18557  |                                    '余白無し     ||18278  |                                    '余白無し     
18558  |                                    '日付         ||18279  |                                    '日付         
18559  |                                    .Cells(11 + K,||18280  |                                    .Cells(11 + K,
18560  |                                        sWord60 & ||18281  |                                        sWord60 & 
18561  |                                    K = K + 1     ||18282  |                                    K = K + 1     
18562  |                                    .Cells(11 + K,||18283  |                                    .Cells(11 + K,
18563  |                                    .Cells(11 + K,||18284  |                                    .Cells(11 + K,
18564  |                                    '平均純資産   ||18285  |                                    '平均純資産   
18565  |                                    dblValueIn = g||18286  |                                    dblValueIn = g
18566  |                                    If gtypOtherCo||18287  |                                    If gtypOtherCo
18567  |                                          Call sbG||18288  |                                          Call sbG
18568  |                                    Else          ||18289  |                                    Else          
18569  |                                          Call sbG||18290  |                                          Call sbG
18570  |                                    End If        ||18291  |                                    End If        
18571  |                                    If gtypOtherCo||18292  |                                    If gtypOtherCo
18572  |                                        .Cells(11 ||18293  |                                        .Cells(11 
18573  |                                    Else          ||18294  |                                    Else          
18574  |                                        .Cells(11 ||18295  |                                        .Cells(11 
18575  |                                    End If        ||18296  |                                    End If        
18576  |                                    'If gtypOtherC||18297  |                                    'If gtypOtherC
18577  |                                    '    .Cells(11||18298  |                                    '    .Cells(11
18578  |                                    'Else         ||18299  |                                    'Else         
18579  |                                    '    .Cells(11||18300  |                                    '    .Cells(11
18580  |                                    'End If       ||18301  |                                    'End If       
18581  |                                    .Cells(11 + K,||18302  |                                    .Cells(11 + K,
18582  |                                    strRange = "K"||18303  |                                    strRange = "K"
18583  |                                    intRange = 11 ||18304  |                                    intRange = 11 
18584  |                                End If            ||18305  |                                End If            
18585  |                                J = 0             ||18306  |                                J = 0             
18586  |                                K = 0             ||18307  |                                K = 0             
18587  |                            Else                  ||18308  |                            Else                  
18588  |                                If intRange = 11 T||18309  |                                If intRange = 11 T
18589  |                                    '余白無し     ||18310  |                                    '余白無し     
18590  |                                    '日付         ||18311  |                                    '日付         
18591  |                                    .Cells(11 + K,||18312  |                                    .Cells(11 + K,
18592  |                                        sWord60 & ||18313  |                                        sWord60 & 
18593  |                                    K = K + 1     ||18314  |                                    K = K + 1     
18594  |                                    .Cells(11 + K,||18315  |                                    .Cells(11 + K,
18595  |                                    .Cells(11 + K,||18316  |                                    .Cells(11 + K,
18596  |                                    '平均純資産   ||18317  |                                    '平均純資産   
18597  |                                    dblValueIn = g||18318  |                                    dblValueIn = g
18598  |                                    If gtypOtherCo||18319  |                                    If gtypOtherCo
18599  |                                          Call sbG||18320  |                                          Call sbG
18600  |                                    Else          ||18321  |                                    Else          
18601  |                                          Call sbG||18322  |                                          Call sbG
18602  |                                    End If        ||18323  |                                    End If        
18603  |                                    If gtypOtherCo||18324  |                                    If gtypOtherCo
18604  |                                        .Cells(11 ||18325  |                                        .Cells(11 
18605  |                                    Else          ||18326  |                                    Else          
18606  |                                        .Cells(11 ||18327  |                                        .Cells(11 
18607  |                                    End If        ||18328  |                                    End If        
18608  |                                    'If gtypOtherC||18329  |                                    'If gtypOtherC
18609  |                                    '    .Cells(11||18330  |                                    '    .Cells(11
18610  |                                    'Else         ||18331  |                                    'Else         
18611  |                                    '    .Cells(11||18332  |                                    '    .Cells(11
18612  |                                    'End If       ||18333  |                                    'End If       
18613  |                                    .Cells(11 + K,||18334  |                                    .Cells(11 + K,
18614  |                                    strRange = "K"||18335  |                                    strRange = "K"
18615  |                                    intRange = 11 ||18336  |                                    intRange = 11 
18616  |                                ElseIf intRange <>||18337  |                                ElseIf intRange <>
18617  |                                    '余白有り     ||18338  |                                    '余白有り     
18618  |                                    K = K + 1     ||18339  |                                    K = K + 1     
18619  |                                    '日付         ||18340  |                                    '日付         
18620  |                                    .Cells(intRang||18341  |                                    .Cells(intRang
18621  |                                        sWord60 & ||18342  |                                        sWord60 & 
18622  |                                    K = K + 1     ||18343  |                                    K = K + 1     
18623  |                                    .Cells(intRang||18344  |                                    .Cells(intRang
18624  |                                    .Cells(intRang||18345  |                                    .Cells(intRang
18625  |                                    '平均純資産   ||18346  |                                    '平均純資産   
18626  |                                    dblValueIn = g||18347  |                                    dblValueIn = g
18627  |                                    If gtypOtherCo||18348  |                                    If gtypOtherCo
18628  |                                          Call sbG||18349  |                                          Call sbG
18629  |                                    Else          ||18350  |                                    Else          
18630  |                                          Call sbG||18351  |                                          Call sbG
18631  |                                    End If        ||18352  |                                    End If        
18632  |                                    If gtypOtherCo||18353  |                                    If gtypOtherCo
18633  |                                        .Cells(int||18354  |                                        .Cells(int
18634  |                                    Else          ||18355  |                                    Else          
18635  |                                        .Cells(int||18356  |                                        .Cells(int
18636  |                                    End If        ||18357  |                                    End If        
18637  |                                    'If gtypOtherC||18358  |                                    'If gtypOtherC
18638  |                                    '    .Cells(in||18359  |                                    '    .Cells(in
18639  |                                    'Else         ||18360  |                                    'Else         
18640  |                                    '    .Cells(in||18361  |                                    '    .Cells(in
18641  |                                    'End If       ||18362  |                                    'End If       
18642  |                                    .Cells(intRang||18363  |                                    .Cells(intRang
18643  |                                    strRange = "K"||18364  |                                    strRange = "K"
18644  |                                    intRange = int||18365  |                                    intRange = int
18645  |                                Else              ||18366  |                                Else              
18646  |                                    J = 0         ||18367  |                                    J = 0         
18647  |                                    K = 0         ||18368  |                                    K = 0         
18648  |                                    strRange = "J"||18369  |                                    strRange = "J"
18649  |                                    intRange = 11 ||18370  |                                    intRange = 11 
18650  |                                    AddPoint = din||18371  |                                    AddPoint = din
18651  |                                    Exit For      ||18372  |                                    Exit For      
18652  |                                End If            ||18373  |                                End If            
18653  |                                J = 0             ||18374  |                                J = 0             
18654  |                                K = 0             ||18375  |                                K = 0             
18655  |                            End If                ||18376  |                            End If                
18656  |                        End If                    ||18377  |                        End If                    
18657  |                    Next dintFor                  ||18378  |                    Next dintFor                  
18658  |                End With                          ||18379  |                End With                          
18659  |            End If                                ||18380  |            End If                                
18660  |            'A4印刷用に上2行を削除して、プレビュー||18381  |            'A4印刷用に上2行を削除して、プレビュー
18661  |            xlSheet.Rows("1:2").Delete Shift:=xlUp||18382  |            xlSheet.Rows("1:2").Delete Shift:=xlUp
18662  |        Next L                                    ||18383  |        Next L                                    
18663  |    End If                                        ||18384  |    End If                                        
18664  |                                                  ||18385  |                                                  
18665  |                                                  ||18386  |                                                  
18666  |                                                  ||18387  |                                                  
18667  |                                                  ||18388  |                                                  
18668  |'2006/04/12 START K.Furuya 実払管理テーブル更新対 ||18389  |'2006/04/12 START K.Furuya 実払管理テーブル更新対 
18669  |    '実払管理テーブル更新処理実行                 ||18390  |    '実払管理テーブル更新処理実行                 
18670  |'2008/03/26 START ファンド決算期間での外部委託顧問||18391  |'2008/03/26 START ファンド決算期間での外部委託顧問
18671  |    'ファンド決算期間計算の場合実払いテーブル更新 ||18392  |    'ファンド決算期間計算の場合実払いテーブル更新 
18672  |    If gbuMGetUPDRec.N(lRecIdx).MGET_other_real_fl||18393  |    If gbuMGetUPDRec.N(lRecIdx).MGET_other_real_fl
18673  |        If fncOtherRealComUpdateInsert(WkContractN||18394  |        If fncOtherRealComUpdateInsert(WkContractN
18674  |                WkFixComC, WkFixComJ, WkRealComC, ||18395  |                WkFixComC, WkFixComJ, WkRealComC, 
18675  |            intRtn = MsgBox("契約番号：" & WkContr||18396  |            intRtn = MsgBox("契約番号：" & WkContr
18676  |                        "の確定額の更新に失敗しま ||18397  |                        "の確定額の更新に失敗しま 
18677  |        End If                                    ||18398  |        End If                                    
18678  |    End If                                        ||18399  |    End If                                        
18679  |'2008/03/26 END   ファンド決算期間での外部委託顧問||18400  |'2008/03/26 END   ファンド決算期間での外部委託顧問
18680  |'2006/04/12 END   K.Furuya 実払管理テーブル更新対 ||18401  |'2006/04/12 END   K.Furuya 実払管理テーブル更新対 
18681  |                                                  ||18402  |                                                  
18682 L|'2014/02/19 START M.Takada 【管理会計】消費税率変 ||       |                                                  
18683 L|  '消費税対応                                     ||       |                                                  
18684 L|    If Tax_Flg = True Then                        ||       |                                                  
18685 L|                                                  ||       |                                                  
18686 L|        '計算期間が消費税変更適用日を跨ぐ場合、消 ||       |                                                  
18687 L|        xlBook.Worksheets.Add after:=xlBook.Sheets||       |                                                  
18688 L|        'Excelフォーマットを調整                  ||       |                                                  
18689 L|        ActiveSheet.Cells.ColumnWidth = 1         ||       |                                                  
18690 L|        ActiveSheet.Cells.Font.Size = 11          ||       |                                                  
18691 L|                                                  ||       |                                                  
18692 L|    With xlSheet                                  ||       |                                                  
18693 L|        '作成日                                   ||       |                                                  
18694 L|        If RTrim(txtSysOutDate.Text) = "" Then    ||       |                                                  
18695 L|            .Cells(3, 50).Value = sWord34         ||       |                                                  
18696 L|            .Cells(3, 50).HorizontalAlignment = xl||       |                                                  
18697 L|        Else                                      ||       |                                                  
18698 L|            .Cells(3, 43).Value = CStr(Format(txtS||       |                                                  
18699 L|        End If                                    ||       |                                                  
18700 L|        'タイトル                                 ||       |                                                  
18701 L|        .Cells(5, 1).Value = sWord0d              ||       |                                                  
18702 L|        .Range("A5:BG5").HorizontalAlignment = xlC||       |                                                  
18703 L|        '財務部　担当者                           ||       |                                                  
18704 L|        sName = RTrim(txtInputName.Text)          ||       |                                                  
18705 L|        '財務部                                   ||       |                                                  
18706 L|        .Cells(7, 37).Value = sWord1              ||       |                                                  
18707 L|        .Cells(8, 39).Value = sWord2 & sName      ||       |                                                  
18708 L|                                                  ||       |                                                  
18709 L|        '下記のとおり･･･ ,文言                    ||       |                                                  
18710 L|        .Cells(10, 2).Value = sWordComment        ||       |                                                  
18711 L|                                                  ||       |                                                  
18712 L|        'ファンド名: ,文言                        ||       |                                                  
18713 L|        .Cells(12, 2).Value = sWord4              ||       |                                                  
18714 L|        .Cells(12, 11).Value = sWord19            ||       |                                                  
18715 L|        .Cells(12, 13).Value = gbuMGetUPDRec.N(lRe||       |                                                  
18716 L|                                                  ||       |                                                  
18717 L|        'ファンドコード: ,文言                    ||       |                                                  
18718 L|        .Cells(13, 2).Value = sWord4_2            ||       |                                                  
18719 L|        .Cells(13, 11).Value = sWord19            ||       |                                                  
18720 L|        If msAssetFlg = "0" Then                  ||       |                                                  
18721 L|            .Cells(13, 13).Value = sGetAccCode    ||       |                                                  
18722 L|        'マザー組入資産の場合                     ||       |                                                  
18723 L|        Else                                      ||       |                                                  
18724 L|            .Cells(13, 13).Value = msBabyAccountCo||       |                                                  
18725 L|        End If                                    ||       |                                                  
18726 L|                                                  ||       |                                                  
18727 L|        '計算期間: ,文言                          ||       |                                                  
18728 L|        .Cells(15, 2).Value = sWord5              ||       |                                                  
18729 L|        .Cells(15, 11).Value = sWord19            ||       |                                                  
18730 L|        .Cells(15, 13).Value = _                  ||       |                                                  
18731 L|        CStr(Format(dStart, "YYYY年M月D日")) & sWo||       |                                                  
18732 L|                                                  ||       |                                                  
18733 L|        '投資顧問料                               ||       |                                                  
18734 L|        .Cells(17, 2).Value = sWord11a            ||       |                                                  
18735 L|        .Cells(17, 11).Value = sWord19            ||       |                                                  
18736 L|        .Cells(17, 29).NumberFormatLocal = "@"    ||       |                                                  
18737 L|        .Cells(17, 29).Value = CStr(Format(mstrMon||       |                                                  
18738 L|        .Cells(17, 29).HorizontalAlignment = xlRig||       |                                                  
18739 L|        .Cells(17, 32).Value = sYen               ||       |                                                  
18740 L|                                                  ||       |                                                  
18741 L|                                                  ||       |                                                  
18742 L|        '(適用前)消費税率                         ||       |                                                  
18743 L|        .Cells(21, 2).Value = sWord66             ||       |                                                  
18744 L|        .Cells(21, 11).Value = sWord19            ||       |                                                  
18745 L|        .Cells(21, 13).Value = strTaxRate(2) & sWo||       |                                                  
18746 L|                                                  ||       |                                                  
18747 L|        '(適用前)税率適用期間                     ||       |                                                  
18748 L|        .Cells(22, 2).Value = sWord67             ||       |                                                  
18749 L|        .Cells(22, 11).Value = sWord19            ||       |                                                  
18750 L|        .Cells(22, 13).Value = _                  ||       |                                                  
18751 L|        CStr(Format(dStart, "YYYY年M月D日")) & sWo||       |                                                  
18752 L|                                                  ||       |                                                  
18753 L|        '(適用前)支払額                           ||       |                                                  
18754 L|        .Cells(23, 2).Value = sWord68             ||       |                                                  
18755 L|        .Cells(23, 11).Value = sWord19            ||       |                                                  
18756 L|        .Cells(23, 29).NumberFormatLocal = "@"    ||       |                                                  
18757 L|        .Cells(23, 29).Value = CStr(Format(strPayN||       |                                                  
18758 L|        .Cells(23, 29).HorizontalAlignment = xlRig||       |                                                  
18759 L|        .Cells(23, 32).Value = sYen               ||       |                                                  
18760 L|                                                  ||       |                                                  
18761 L|        '(適用前)消費税額                         ||       |                                                  
18762 L|        .Cells(24, 2).Value = sWord69             ||       |                                                  
18763 L|        .Cells(24, 11).Value = sWord19            ||       |                                                  
18764 L|        .Cells(24, 29).NumberFormatLocal = "@"    ||       |                                                  
18765 L|        .Cells(24, 29).Value = CStr(Format(strTaxN||       |                                                  
18766 L|        .Cells(24, 29).HorizontalAlignment = xlRig||       |                                                  
18767 L|        .Cells(24, 32).Value = sYen               ||       |                                                  
18768 L|                                                  ||       |                                                  
18769 L|                                                  ||       |                                                  
18770 L|        '(適用後)消費税率                         ||       |                                                  
18771 L|        .Cells(28, 2).Value = sWord66             ||       |                                                  
18772 L|        .Cells(28, 11).Value = sWord19            ||       |                                                  
18773 L|        .Cells(28, 13).Value = strTaxRate(1) & sWo||       |                                                  
18774 L|                                                  ||       |                                                  
18775 L|        '(適用後)税率適用期間                     ||       |                                                  
18776 L|        .Cells(29, 2).Value = sWord67             ||       |                                                  
18777 L|        .Cells(29, 11).Value = sWord19            ||       |                                                  
18778 L|        .Cells(29, 13).Value = _                  ||       |                                                  
18779 L|        CStr(Format(strUse_Date, "YYYY年M月D日")) ||       |                                                  
18780 L|                                                  ||       |                                                  
18781 L|        '(適用後)支払額                           ||       |                                                  
18782 L|        .Cells(30, 2).Value = sWord68             ||       |                                                  
18783 L|        .Cells(30, 11).Value = sWord19            ||       |                                                  
18784 L|        .Cells(30, 29).NumberFormatLocal = "@"    ||       |                                                  
18785 L|        .Cells(30, 29).Value = CStr(Format(strPayN||       |                                                  
18786 L|        .Cells(30, 29).HorizontalAlignment = xlRig||       |                                                  
18787 L|        .Cells(30, 32).Value = sYen               ||       |                                                  
18788 L|                                                  ||       |                                                  
18789 L|        '(適用後)消費税額                         ||       |                                                  
18790 L|        .Cells(31, 2).Value = sWord69             ||       |                                                  
18791 L|        .Cells(31, 11).Value = sWord19            ||       |                                                  
18792 L|        .Cells(31, 29).NumberFormatLocal = "@"    ||       |                                                  
18793 L|        .Cells(31, 29).Value = CStr(Format(strTaxN||       |                                                  
18794 L|        .Cells(31, 29).HorizontalAlignment = xlRig||       |                                                  
18795 L|        .Cells(31, 32).Value = sYen               ||       |                                                  
18796 L|                                                  ||       |                                                  
18797 L|                                                  ||       |                                                  
18798 L|        '合計                                     ||       |                                                  
18799 L|        .Cells(35, 2).Value = sWord70             ||       |                                                  
18800 L|                                                  ||       |                                                  
18801 L|        '支払額                                   ||       |                                                  
18802 L|        .Cells(36, 2).Value = sWord68             ||       |                                                  
18803 L|        .Cells(36, 11).Value = sWord19            ||       |                                                  
18804 L|        .Cells(36, 29).NumberFormatLocal = "@"    ||       |                                                  
18805 L|        .Cells(36, 29).Value = CStr(Format(.Cells(||       |                                                  
18806 L|        .Cells(36, 29).HorizontalAlignment = xlRig||       |                                                  
18807 L|        .Cells(36, 32).Value = sYen               ||       |                                                  
18808 L|                                                  ||       |                                                  
18809 L|        '消費税額                                 ||       |                                                  
18810 L|        .Cells(37, 2).Value = sWord69             ||       |                                                  
18811 L|        .Cells(37, 11).Value = sWord19            ||       |                                                  
18812 L|        .Cells(37, 29).NumberFormatLocal = "@"    ||       |                                                  
18813 L|        .Cells(37, 29).Value = CStr(Format(.Cells(||       |                                                  
18814 L|        .Cells(37, 29).HorizontalAlignment = xlRig||       |                                                  
18815 L|        .Cells(37, 32).Value = sYen               ||       |                                                  
18816 L|                                                  ||       |                                                  
18817 L|        '合計額                                   ||       |                                                  
18818 L|        .Cells(37, 13).Value = sWord24            ||       |                                                  
18819 L|        .Cells(37, 29).NumberFormatLocal = "@"    ||       |                                                  
18820 L|        .Cells(37, 29).Value = CStr(Format(.Cells(||       |                                                  
18821 L|        .Cells(37, 29).HorizontalAlignment = xlRig||       |                                                  
18822 L|        .Cells(37, 32).Value = sYen               ||       |                                                  
18823 L|                                                  ||       |                                                  
18824 L|                                                  ||       |                                                  
18825 L|    Else                                          ||       |                                                  
18826 L|        '跨がない場合｢消費税額内訳書｣は出力しない ||       |                                                  
18827 L|    End If                                        ||       |                                                  
18828 L|'2014/02/19 END   M.Takada 【管理会計】消費税率変 ||       |                                                  
18829  |    '正常戻り値セット                             ||18403  |    '正常戻り値セット                             
18830  |    fnblExcelOut_ChangeRate = True                ||18404  |    fnblExcelOut_ChangeRate = True                
18831  |                                                  ||18405  |                                                  
18832  |                                                  ||18406  |                                                  
18833  |    GoTo EndProc                                  ||18407  |    GoTo EndProc                                  
18834  |                                                  ||18408  |                                                  
18835  |ErrorTrap:                                        ||18409  |ErrorTrap:                                        
18836  |    ' Excel を起動できない場合に発生するエラーをト||18410  |    ' Excel を起動できない場合に発生するエラーをト
18837  |    Select Case Err.Number                        ||18411  |    Select Case Err.Number                        
18838  |        Case 440               ' オートメーション ||18412  |        Case 440               ' オートメーション 
18839  |            iTries = iTries + 1                   ||18413  |            iTries = iTries + 1                   
18840  |            ' Excel の再起動を 5 回まで行います。 ||18414  |            ' Excel の再起動を 5 回まで行います。 
18841  |            If iTries < 5 Then                    ||18415  |            If iTries < 5 Then                    
18842  |               Set xlApp = New Excel.Application  ||18416  |               Set xlApp = New Excel.Application  
18843  |               Resume                             ||18417  |               Resume                             
18844  |            Else                                  ||18418  |            Else                                  
18845  |               Err.Raise Number:=vbObjectError + 2||18419  |               Err.Raise Number:=vbObjectError + 2
18846  |               Description:="Microsoft Excel を起 ||18420  |               Description:="Microsoft Excel を起 
18847  |            End If                                ||18421  |            End If                                
18848  |        Case Else                                 ||18422  |        Case Else                                 
18849  |    End Select                                    ||18423  |    End Select                                    
18850  |                                                  ||18424  |                                                  
18851  |    'Workbookを閉じる                             ||18425  |    'Workbookを閉じる                             
18852  |    xlBook.Close                                  ||18426  |    xlBook.Close                                  
18853  |                                                  ||18427  |                                                  
18854  |    'Excel終了                                    ||18428  |    'Excel終了                                    
18855  |    xlApp.Quit                                    ||18429  |    xlApp.Quit                                    
18856  |                                                  ||18430  |                                                  
18857  |    'オブジェクトの解放                           ||18431  |    'オブジェクトの解放                           
18858  |    Set xlApp = Nothing                           ||18432  |    Set xlApp = Nothing                           
18859  |    Set xlBook = Nothing                          ||18433  |    Set xlBook = Nothing                          
18860  |    Set xlSheet = Nothing                         ||18434  |    Set xlSheet = Nothing                         
18861  |                                                  ||18435  |                                                  
18862  |OnErrorProc:                                      ||18436  |OnErrorProc:                                      
18863  |    Call subError("システムエラー", Str(Err.Number||18437  |    Call subError("システムエラー", Str(Err.Number
18864  |        Error, strErrCall, conTitle)              ||18438  |        Error, strErrCall, conTitle)              
18865  |    'マウスポインター元に戻す                     ||18439  |    'マウスポインター元に戻す                     
18866  |    Screen.MousePointer = vbDefault               ||18440  |    Screen.MousePointer = vbDefault               
18867  |    GoTo EndProc                                  ||18441  |    GoTo EndProc                                  
18868  |                                                  ||18442  |                                                  
18869  |EndProc:                                          ||18443  |EndProc:                                          
18870  |                                                  ||18444  |                                                  
18871  |                                                  ||18445  |                                                  
18872  |                                                  ||18446  |                                                  
18873  |End Function                                      ||18447  |End Function                                      
18874  |                                                  ||18448  |                                                  
18875  |'=================================================||18449  |'=================================================
18876  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMonthlyNAV_GetNotChgRate   ||18450  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMonthlyNAV_GetNotChgRate   
18877  |'機能            :   月次NAV取得(料率変更無し)    ||18451  |'機能            :   月次NAV取得(料率変更無し)    
18878  |'                                                 ||18452  |'                                                 
18879  |'                                                 ||18453  |'                                                 
18880  |'日付               担当　              修正内容  ||18454  |'日付               担当　              修正内容  
18881  |'-------------------------------------------------||18455  |'-------------------------------------------------
18882  |'2006/08/02         K.Furuya<SRA>      新規作成 期||18456  |'2006/08/02         K.Furuya<SRA>      新規作成 期
18883  |'=================================================||18457  |'=================================================
18884  |Private Sub sbMonthlyNAV_GetNotChgRate(ByVal Idx A||18458  |Private Sub sbMonthlyNAV_GetNotChgRate(ByVal Idx A
18885  |    Dim sZenkai             As String   '前回締日 ||18459  |    Dim sZenkai             As String   '前回締日 
18886  |    Dim sNearMonth          As String   '直近締日 ||18460  |    Dim sNearMonth          As String   '直近締日 
18887  |    Dim ddblNav             As Double             ||18461  |    Dim ddblNav             As Double             
18888  |    Dim ddblCnt             As Double             ||18462  |    Dim ddblCnt             As Double             
18889  |    Dim ddblNavTotal        As Double             ||18463  |    Dim ddblNavTotal        As Double             
18890  |    Dim ddblBabyMotherRate  As Double   'ベビー/マ||18464  |    Dim ddblBabyMotherRate  As Double   'ベビー/マ
18891  |    Dim dstrMonthOld        As String             ||18465  |    Dim dstrMonthOld        As String             
18892  |    Dim dstrMonthNew        As String             ||18466  |    Dim dstrMonthNew        As String             
18893  |    Dim sSql                As String             ||18467  |    Dim sSql                As String             
18894  |    Dim MonthlyCnt          As Integer            ||18468  |    Dim MonthlyCnt          As Integer            
18895  |    Dim i                   As Integer            ||18469  |    Dim i                   As Integer            
18896  |                                                  ||18470  |                                                  
18897  |    sNearMonth = ""                               ||18471  |    sNearMonth = ""                               
18898  |    sZenkai = ""                                  ||18472  |    sZenkai = ""                                  
18899  |    MonthlyCnt = 0                                ||18473  |    MonthlyCnt = 0                                
18900  |                                                  ||18474  |                                                  
18901  |                                                  ||18475  |                                                  
18902  |    '月次NAVを取得(資産種別により分岐)            ||18476  |    '月次NAVを取得(資産種別により分岐)            
18903  |    Select Case msAssetFlg                        ||18477  |    Select Case msAssetFlg                        
18904  |        '純資産                                   ||18478  |        '純資産                                   
18905  |        Case "0"                                  ||18479  |        Case "0"                                  
18906  |            'SQL文の作成(日次NAV取得)             ||18480  |            'SQL文の作成(日次NAV取得)             
18907  |            msContNo = gbuMGetUPDRec.N(Idx).MGET_c||18481  |            msContNo = gbuMGetUPDRec.N(Idx).MGET_c
18908  |            '日次NAVは当年度のNAVを取得する       ||18482  |            '日次NAVは当年度のNAVを取得する       
18909  |            sSql = gstrEditSQLcfr_DailyNavForSelec||18483  |            sSql = gstrEditSQLcfr_DailyNavForSelec
18910  |                msContNo, mstrNearSettleDate)     ||18484  |                msContNo, mstrNearSettleDate)     
18911  |                                                  ||18485  |                                                  
18912  |            'ﾀﾞｲﾅｾｯﾄの作成                        ||18486  |            'ﾀﾞｲﾅｾｯﾄの作成                        
18913  |            If gintDyCreate(sSql) = False Then    ||18487  |            If gintDyCreate(sSql) = False Then    
18914  |                Exit Sub                          ||18488  |                Exit Sub                          
18915  |            End If                                ||18489  |            End If                                
18916  |                                                  ||18490  |                                                  
18917  |            mstrDailyNav = 0                      ||18491  |            mstrDailyNav = 0                      
18918  |            ddblNav = 0                           ||18492  |            ddblNav = 0                           
18919  |            ddblCnt = 0                           ||18493  |            ddblCnt = 0                           
18920  |            'EOF判定処理                          ||18494  |            'EOF判定処理                          
18921  |            Do Until gblnDyEOF()                  ||18495  |            Do Until gblnDyEOF()                  
18922  |                ddblNav = gvlnDyDataN("NET_ASSET_V||18496  |                ddblNav = gvlnDyDataN("NET_ASSET_V
18923  |                ddblCnt = gvlnDyDataN("NAV_CNT")  ||18497  |                ddblCnt = gvlnDyDataN("NAV_CNT")  
18924  |                If ddblCnt > 0 Then               ||18498  |                If ddblCnt > 0 Then               
18925  |                    mstrDailyNav = mstrDailyNav + ||18499  |                    mstrDailyNav = mstrDailyNav + 
18926  |                Else                              ||18500  |                Else                              
18927  |                    mstrDailyNav = mstrDailyNav + ||18501  |                    mstrDailyNav = mstrDailyNav + 
18928  |                End If                            ||18502  |                End If                            
18929  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 ||18503  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 
18930  |                Call gDyNext                      ||18504  |                Call gDyNext                      
18931  |            Loop                                  ||18505  |            Loop                                  
18932  |                                                  ||18506  |                                                  
18933  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||18507  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
18934  |            Call gblnDyClose                      ||18508  |            Call gblnDyClose                      
18935  |                                                  ||18509  |                                                  
18936  |            'SQL文の作成(月次NAV取得)             ||18510  |            'SQL文の作成(月次NAV取得)             
18937  |            '配列初期化                           ||18511  |            '配列初期化                           
18938  |            ReDim gtypcfr_mnav_tbl(0)             ||18512  |            ReDim gtypcfr_mnav_tbl(0)             
18939  |                                                  ||18513  |                                                  
18940  |            sZenkai = Mid(mstrSettlementDate, 1, 6||18514  |            sZenkai = Mid(mstrSettlementDate, 1, 6
18941  |                                                  ||18515  |                                                  
18942  |            '直近締日の月の前月をセット           ||18516  |            '直近締日の月の前月をセット           
18943  |            sNearMonth = DateAdd("m", -1, gstrDate||18517  |            sNearMonth = DateAdd("m", -1, gstrDate
18944  |            sNearMonth = Mid(gstrDateFormat2(sNear||18518  |            sNearMonth = Mid(gstrDateFormat2(sNear
18945  |                                                  ||18519  |                                                  
18946  |            sSql = gstrEditSQLcfr_MonthlyNavForSel||18520  |            sSql = gstrEditSQLcfr_MonthlyNavForSel
18947  |                msContNo, sNearMonth, sZenkai)    ||18521  |                msContNo, sNearMonth, sZenkai)    
18948  |                                                  ||18522  |                                                  
18949  |            'ﾀﾞｲﾅｾｯﾄの作成                        ||18523  |            'ﾀﾞｲﾅｾｯﾄの作成                        
18950  |            If gintDyCreate(sSql) = False Then    ||18524  |            If gintDyCreate(sSql) = False Then    
18951  |                Exit Sub                          ||18525  |                Exit Sub                          
18952  |            End If                                ||18526  |            End If                                
18953  |                                                  ||18527  |                                                  
18954  |            dstrMonthOld = ""                     ||18528  |            dstrMonthOld = ""                     
18955  |            dstrMonthNew = ""                     ||18529  |            dstrMonthNew = ""                     
18956  |            ddblNav = 0                           ||18530  |            ddblNav = 0                           
18957  |            ddblCnt = 0                           ||18531  |            ddblCnt = 0                           
18958  |            ddblNavTotal = 0                      ||18532  |            ddblNavTotal = 0                      
18959  |            i = 0                                 ||18533  |            i = 0                                 
18960  |                                                  ||18534  |                                                  
18961  |            Do Until gblnDyEOF()                  ||18535  |            Do Until gblnDyEOF()                  
18962  |                '対象月次NAV抽出                  ||18536  |                '対象月次NAV抽出                  
18963  |                dstrMonthNew = gvlnDyDataS("base_m||18537  |                dstrMonthNew = gvlnDyDataS("base_m
18964  |                If dstrMonthNew <> dstrMonthOld Th||18538  |                If dstrMonthNew <> dstrMonthOld Th
18965  |                    If i = 0 Then                 ||18539  |                    If i = 0 Then                 
18966  |                        '動的配列更新             ||18540  |                        '動的配列更新             
18967  |                        ReDim Preserve gtypcfr_mna||18541  |                        ReDim Preserve gtypcfr_mna
18968  |                        i = 1                     ||18542  |                        i = 1                     
18969  |                    Else                          ||18543  |                    Else                          
18970  |                        MonthlyCnt = MonthlyCnt + ||18544  |                        MonthlyCnt = MonthlyCnt + 
18971  |                        ReDim Preserve gtypcfr_mna||18545  |                        ReDim Preserve gtypcfr_mna
18972  |                        ddblNav = 0               ||18546  |                        ddblNav = 0               
18973  |                        ddblCnt = 0               ||18547  |                        ddblCnt = 0               
18974  |                        ddblNavTotal = 0          ||18548  |                        ddblNavTotal = 0          
18975  |                    End If                        ||18549  |                    End If                        
18976  |                End If                            ||18550  |                End If                            
18977  |                ddblNav = gvlnDyDataN("NET_ASSET_V||18551  |                ddblNav = gvlnDyDataN("NET_ASSET_V
18978  |                ddblCnt = gvlnDyDataN("NAV_CNT")  ||18552  |                ddblCnt = gvlnDyDataN("NAV_CNT")  
18979  |                If ddblCnt > 0 Then               ||18553  |                If ddblCnt > 0 Then               
18980  |                    ddblNavTotal = ddblNavTotal + ||18554  |                    ddblNavTotal = ddblNavTotal + 
18981  |                Else                              ||18555  |                Else                              
18982  |                    ddblNavTotal = ddblNavTotal + ||18556  |                    ddblNavTotal = ddblNavTotal + 
18983  |                End If                            ||18557  |                End If                            
18984  |                gtypcfr_mnav_tbl(MonthlyCnt).BASE_||18558  |                gtypcfr_mnav_tbl(MonthlyCnt).BASE_
18985  |                gtypcfr_mnav_tbl(MonthlyCnt).net_a||18559  |                gtypcfr_mnav_tbl(MonthlyCnt).net_a
18986  |                dstrMonthOld = dstrMonthNew       ||18560  |                dstrMonthOld = dstrMonthNew       
18987  |                                                  ||18561  |                                                  
18988  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 ||18562  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 
18989  |                Call gDyNext                      ||18563  |                Call gDyNext                      
18990  |            Loop                                  ||18564  |            Loop                                  
18991  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||18565  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
18992  |            Call gblnDyClose                      ||18566  |            Call gblnDyClose                      
18993  |        'マザー組入資産                           ||18567  |        'マザー組入資産                           
18994  |        Case "1"                                  ||18568  |        Case "1"                                  
18995  |            'SQL文の作成(日次NAV取得)             ||18569  |            'SQL文の作成(日次NAV取得)             
18996  |            msContNo = gbuMGetUPDRec.N(Idx).MGET_c||18570  |            msContNo = gbuMGetUPDRec.N(Idx).MGET_c
18997  |            '日次NAVとベビーマザー比率は当年度のNA||18571  |            '日次NAVとベビーマザー比率は当年度のNA
18998  |            sSql = gstrEditSQLcfr_DailyNavBabyMoth||18572  |            sSql = gstrEditSQLcfr_DailyNavBabyMoth
18999  |                msContNo, mstrNearSettleDate)     ||18573  |                msContNo, mstrNearSettleDate)     
19000  |                                                  ||18574  |                                                  
19001  |            'ﾀﾞｲﾅｾｯﾄの作成                        ||18575  |            'ﾀﾞｲﾅｾｯﾄの作成                        
19002  |            If gintDyCreate(sSql) = False Then    ||18576  |            If gintDyCreate(sSql) = False Then    
19003  |                Exit Sub                          ||18577  |                Exit Sub                          
19004  |            End If                                ||18578  |            End If                                
19005  |                                                  ||18579  |                                                  
19006  |            mstrDailyNav = 0                      ||18580  |            mstrDailyNav = 0                      
19007  |            ddblNav = 0                           ||18581  |            ddblNav = 0                           
19008  |            ddblCnt = 0                           ||18582  |            ddblCnt = 0                           
19009  |            ddblBabyMotherRate = 0                ||18583  |            ddblBabyMotherRate = 0                
19010  |                                                  ||18584  |                                                  
19011  |            'EOF判定処理                          ||18585  |            'EOF判定処理                          
19012  |            Do Until gblnDyEOF()                  ||18586  |            Do Until gblnDyEOF()                  
19013  |                ddblNav = gvlnDyDataN("NET_ASSET_V||18587  |                ddblNav = gvlnDyDataN("NET_ASSET_V
19014  |                ddblBabyMotherRate = gvlnDyDataN("||18588  |                ddblBabyMotherRate = gvlnDyDataN("
19015  |                ddblCnt = gvlnDyDataN("NAV_CNT")  ||18589  |                ddblCnt = gvlnDyDataN("NAV_CNT")  
19016  |                If ddblCnt > 0 Then               ||18590  |                If ddblCnt > 0 Then               
19017  |                    '(日次NAV × マザー組入比率)  ||18591  |                    '(日次NAV × マザー組入比率)  
19018  |                    mstrDailyNav = mstrDailyNav + ||18592  |                    mstrDailyNav = mstrDailyNav + 
19019  |                Else                              ||18593  |                Else                              
19020  |                    mstrDailyNav = mstrDailyNav + ||18594  |                    mstrDailyNav = mstrDailyNav + 
19021  |                End If                            ||18595  |                End If                            
19022  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 ||18596  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 
19023  |                Call gDyNext                      ||18597  |                Call gDyNext                      
19024  |            Loop                                  ||18598  |            Loop                                  
19025  |                                                  ||18599  |                                                  
19026  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||18600  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
19027  |            Call gblnDyClose                      ||18601  |            Call gblnDyClose                      
19028  |                                                  ||18602  |                                                  
19029  |            'SQL文の作成(月次NAV取得)             ||18603  |            'SQL文の作成(月次NAV取得)             
19030  |            '配列初期化                           ||18604  |            '配列初期化                           
19031  |            ReDim gtypcfr_mnav_tbl(0)             ||18605  |            ReDim gtypcfr_mnav_tbl(0)             
19032  |                                                  ||18606  |                                                  
19033  |            sZenkai = Mid(mstrSettlementDate, 1, 6||18607  |            sZenkai = Mid(mstrSettlementDate, 1, 6
19034  |                                                  ||18608  |                                                  
19035  |            '直近締日の月の前月をセット           ||18609  |            '直近締日の月の前月をセット           
19036  |            sNearMonth = DateAdd("m", -1, gstrDate||18610  |            sNearMonth = DateAdd("m", -1, gstrDate
19037  |            sNearMonth = Mid(gstrDateFormat2(sNear||18611  |            sNearMonth = Mid(gstrDateFormat2(sNear
19038  |                                                  ||18612  |                                                  
19039  |            'ベビーマザー比率は対象NAVの月末日付を||18613  |            'ベビーマザー比率は対象NAVの月末日付を
19040  |            sSql = gstrEditSQLcfr_MonthlyNavBabyMo||18614  |            sSql = gstrEditSQLcfr_MonthlyNavBabyMo
19041  |                msAccCode, msMotherAccCode, msCont||18615  |                msAccCode, msMotherAccCode, msCont
19042  |                                                  ||18616  |                                                  
19043  |            'ﾀﾞｲﾅｾｯﾄの作成                        ||18617  |            'ﾀﾞｲﾅｾｯﾄの作成                        
19044  |            If gintDyCreate(sSql) = False Then    ||18618  |            If gintDyCreate(sSql) = False Then    
19045  |                Exit Sub                          ||18619  |                Exit Sub                          
19046  |            End If                                ||18620  |            End If                                
19047  |                                                  ||18621  |                                                  
19048  |            dstrMonthOld = ""                     ||18622  |            dstrMonthOld = ""                     
19049  |            dstrMonthNew = ""                     ||18623  |            dstrMonthNew = ""                     
19050  |            ddblNav = 0                           ||18624  |            ddblNav = 0                           
19051  |            ddblCnt = 0                           ||18625  |            ddblCnt = 0                           
19052  |            ddblBabyMotherRate = 0                ||18626  |            ddblBabyMotherRate = 0                
19053  |            ddblNavTotal = 0                      ||18627  |            ddblNavTotal = 0                      
19054  |            i = 0                                 ||18628  |            i = 0                                 
19055  |                                                  ||18629  |                                                  
19056  |            Do Until gblnDyEOF()                  ||18630  |            Do Until gblnDyEOF()                  
19057  |                '対象月次NAV抽出                  ||18631  |                '対象月次NAV抽出                  
19058  |                dstrMonthNew = gvlnDyDataS("base_m||18632  |                dstrMonthNew = gvlnDyDataS("base_m
19059  |                If dstrMonthNew <> dstrMonthOld Th||18633  |                If dstrMonthNew <> dstrMonthOld Th
19060  |                    If i = 0 Then                 ||18634  |                    If i = 0 Then                 
19061  |                        '動的配列更新             ||18635  |                        '動的配列更新             
19062  |                        ReDim Preserve gtypcfr_mna||18636  |                        ReDim Preserve gtypcfr_mna
19063  |                        i = 1                     ||18637  |                        i = 1                     
19064  |                    Else                          ||18638  |                    Else                          
19065  |                        MonthlyCnt = MonthlyCnt + ||18639  |                        MonthlyCnt = MonthlyCnt + 
19066  |                        ReDim Preserve gtypcfr_mna||18640  |                        ReDim Preserve gtypcfr_mna
19067  |                        ddblNav = 0               ||18641  |                        ddblNav = 0               
19068  |                        ddblCnt = 0               ||18642  |                        ddblCnt = 0               
19069  |                        ddblNavTotal = 0          ||18643  |                        ddblNavTotal = 0          
19070  |                    End If                        ||18644  |                    End If                        
19071  |                End If                            ||18645  |                End If                            
19072  |                ddblNav = gvlnDyDataN("NET_ASSET_V||18646  |                ddblNav = gvlnDyDataN("NET_ASSET_V
19073  |                ddblBabyMotherRate = gvlnDyDataN("||18647  |                ddblBabyMotherRate = gvlnDyDataN("
19074  |                ddblCnt = gvlnDyDataN("NAV_CNT")  ||18648  |                ddblCnt = gvlnDyDataN("NAV_CNT")  
19075  |                If ddblCnt > 0 Then               ||18649  |                If ddblCnt > 0 Then               
19076  |                    '(日次NAV × マザー組入比率)  ||18650  |                    '(日次NAV × マザー組入比率)  
19077  |                    ddblNavTotal = ddblNavTotal + ||18651  |                    ddblNavTotal = ddblNavTotal + 
19078  |                Else                              ||18652  |                Else                              
19079  |                    ddblNavTotal = ddblNavTotal + ||18653  |                    ddblNavTotal = ddblNavTotal + 
19080  |                End If                            ||18654  |                End If                            
19081  |                gtypcfr_mnav_tbl(MonthlyCnt).BASE_||18655  |                gtypcfr_mnav_tbl(MonthlyCnt).BASE_
19082  |                gtypcfr_mnav_tbl(MonthlyCnt).net_a||18656  |                gtypcfr_mnav_tbl(MonthlyCnt).net_a
19083  |                dstrMonthOld = dstrMonthNew       ||18657  |                dstrMonthOld = dstrMonthNew       
19084  |                                                  ||18658  |                                                  
19085  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 ||18659  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 
19086  |                Call gDyNext                      ||18660  |                Call gDyNext                      
19087  |            Loop                                  ||18661  |            Loop                                  
19088  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||18662  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
19089  |            Call gblnDyClose                      ||18663  |            Call gblnDyClose                      
19090  |    End Select                                    ||18664  |    End Select                                    
19091  |                                                  ||18665  |                                                  
19092  |End Sub                                           ||18666  |End Sub                                           
19093  |                                                  ||18667  |                                                  
19094  |'=================================================||18668  |'=================================================
19095  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMonthlyNAV_GetChangeRate   ||18669  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbMonthlyNAV_GetChangeRate   
19096  |'機能            :   月次NAV取得(料率変更無し)    ||18670  |'機能            :   月次NAV取得(料率変更無し)    
19097  |'                                                 ||18671  |'                                                 
19098  |'                                                 ||18672  |'                                                 
19099  |'日付               担当　              修正内容  ||18673  |'日付               担当　              修正内容  
19100  |'-------------------------------------------------||18674  |'-------------------------------------------------
19101  |'2006/08/02         K.Furuya<SRA>      新規作成 期||18675  |'2006/08/02         K.Furuya<SRA>      新規作成 期
19102  |'=================================================||18676  |'=================================================
19103  |Private Sub sbMonthlyNAV_GetChangeRate(ByVal Idx A||18677  |Private Sub sbMonthlyNAV_GetChangeRate(ByVal Idx A
19104  |    Dim sZenkai             As String   '前回締日 ||18678  |    Dim sZenkai             As String   '前回締日 
19105  |    Dim sNearMonth          As String   '直近締日 ||18679  |    Dim sNearMonth          As String   '直近締日 
19106  |    Dim ddblNav             As Double             ||18680  |    Dim ddblNav             As Double             
19107  |    Dim ddblCnt             As Double             ||18681  |    Dim ddblCnt             As Double             
19108  |    Dim ddblNavTotal        As Double             ||18682  |    Dim ddblNavTotal        As Double             
19109  |    Dim ddblBabyMotherRate  As Double   'ベビー/マ||18683  |    Dim ddblBabyMotherRate  As Double   'ベビー/マ
19110  |    Dim dstrMonthOld        As String             ||18684  |    Dim dstrMonthOld        As String             
19111  |    Dim dstrMonthNew        As String             ||18685  |    Dim dstrMonthNew        As String             
19112  |    Dim sSql                As String             ||18686  |    Dim sSql                As String             
19113  |    Dim MonthlyCnt          As Integer            ||18687  |    Dim MonthlyCnt          As Integer            
19114  |    Dim strRuleNo           As Integer  '比較ルー ||18688  |    Dim strRuleNo           As Integer  '比較ルー 
19115  |    Dim endRuleNo           As Integer  '比較ルー ||18689  |    Dim endRuleNo           As Integer  '比較ルー 
19116  |    Dim i                   As Integer            ||18690  |    Dim i                   As Integer            
19117  |    Dim J                   As Integer            ||18691  |    Dim J                   As Integer            
19118  |    Dim K                   As Integer            ||18692  |    Dim K                   As Integer            
19119  |    Dim ContNo              As String   '契約番号 ||18693  |    Dim ContNo              As String   '契約番号 
19120  |                                                  ||18694  |                                                  
19121  |    sNearMonth = ""                               ||18695  |    sNearMonth = ""                               
19122  |    sZenkai = ""                                  ||18696  |    sZenkai = ""                                  
19123  |    MonthlyCnt = 0                                ||18697  |    MonthlyCnt = 0                                
19124  |                                                  ||18698  |                                                  
19125  |                                                  ||18699  |                                                  
19126  |    '月次NAVを取得(資産種別により分岐)            ||18700  |    '月次NAVを取得(資産種別により分岐)            
19127  |    Select Case msAssetFlg                        ||18701  |    Select Case msAssetFlg                        
19128  |        '純資産                                   ||18702  |        '純資産                                   
19129  |        Case "0"                                  ||18703  |        Case "0"                                  
19130  |            '料率変更毎の計算期間日数、順位、料率 ||18704  |            '料率変更毎の計算期間日数、順位、料率 
19131  |            For i = LBound(gtypOtherComRec) To UBo||18705  |            For i = LBound(gtypOtherComRec) To UBo
19132  |                '契約番号を取得                   ||18706  |                '契約番号を取得                   
19133  |                ContNo = gbuMGetUPDRec.N(Idx).MGET||18707  |                ContNo = gbuMGetUPDRec.N(Idx).MGET
19134  |                '計算開始月をセット               ||18708  |                '計算開始月をセット               
19135  |                sZenkai = Mid(gtypOtherComRec(i).A||18709  |                sZenkai = Mid(gtypOtherComRec(i).A
19136  |                '直近締日の月の前月をセット       ||18710  |                '直近締日の月の前月をセット       
19137  |                sNearMonth = DateAdd("m", -1, gstr||18711  |                sNearMonth = DateAdd("m", -1, gstr
19138  |                sNearMonth = Mid(gstrDateFormat2(s||18712  |                sNearMonth = Mid(gstrDateFormat2(s
19139  |                '計算終了月が開始月より前の場合は ||18713  |                '計算終了月が開始月より前の場合は 
19140  |                If sZenkai > sNearMonth Then      ||18714  |                If sZenkai > sNearMonth Then      
19141  |                    sNearMonth = sZenkai          ||18715  |                    sNearMonth = sZenkai          
19142  |                End If                            ||18716  |                End If                            
19143  |                'SQL文の作成(月次NAV取得)         ||18717  |                'SQL文の作成(月次NAV取得)         
19144  |                sSql = gstrEditSQLcfr_MonthlyNavFo||18718  |                sSql = gstrEditSQLcfr_MonthlyNavFo
19145  |                    ContNo, sNearMonth, sZenkai)  ||18719  |                    ContNo, sNearMonth, sZenkai)  
19146  |                                                  ||18720  |                                                  
19147  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||18721  |                'ﾀﾞｲﾅｾｯﾄの作成                    
19148  |                If gintDyCreate(sSql) = False Then||18722  |                If gintDyCreate(sSql) = False Then
19149  |                    Exit Sub                      ||18723  |                    Exit Sub                      
19150  |                End If                            ||18724  |                End If                            
19151  |                                                  ||18725  |                                                  
19152  |                dstrMonthOld = ""                 ||18726  |                dstrMonthOld = ""                 
19153  |                dstrMonthNew = ""                 ||18727  |                dstrMonthNew = ""                 
19154  |                ddblNav = 0                       ||18728  |                ddblNav = 0                       
19155  |                ddblCnt = 0                       ||18729  |                ddblCnt = 0                       
19156  |                ddblNavTotal = 0                  ||18730  |                ddblNavTotal = 0                  
19157  |                'ループ変数初期化                 ||18731  |                'ループ変数初期化                 
19158  |                J = 0                             ||18732  |                J = 0                             
19159  |                                                  ||18733  |                                                  
19160  |                Do Until gblnDyEOF()              ||18734  |                Do Until gblnDyEOF()              
19161  |                    '対象月次NAV抽出              ||18735  |                    '対象月次NAV抽出              
19162  |                    dstrMonthNew = gvlnDyDataS("ba||18736  |                    dstrMonthNew = gvlnDyDataS("ba
19163  |                    If dstrMonthNew <> dstrMonthOl||18737  |                    If dstrMonthNew <> dstrMonthOl
19164  |                        '動的配列更新             ||18738  |                        '動的配列更新             
19165  |                        ReDim Preserve gtypOtherCo||18739  |                        ReDim Preserve gtypOtherCo
19166  |                        ddblNav = 0               ||18740  |                        ddblNav = 0               
19167  |                        ddblCnt = 0               ||18741  |                        ddblCnt = 0               
19168  |                    End If                        ||18742  |                    End If                        
19169  |                    ddblNav = gvlnDyDataN("NET_ASS||18743  |                    ddblNav = gvlnDyDataN("NET_ASS
19170  |                    ddblCnt = gvlnDyDataN("NAV_CNT||18744  |                    ddblCnt = gvlnDyDataN("NAV_CNT
19171  |                    If ddblCnt > 0 Then           ||18745  |                    If ddblCnt > 0 Then           
19172  |                        ddblNavTotal = ddblNavTota||18746  |                        ddblNavTotal = ddblNavTota
19173  |                        'レコードが存在した場合基 ||18747  |                        'レコードが存在した場合基 
19174  |                        gtypOtherComRec(i).APPLY_G||18748  |                        gtypOtherComRec(i).APPLY_G
19175  |                            WordYear & CInt(Mid(ds||18749  |                            WordYear & CInt(Mid(ds
19176  |                        '基準月英文をセット       ||18750  |                        '基準月英文をセット       
19177  |                        dstrMonthNew = CDate(gstrD||18751  |                        dstrMonthNew = CDate(gstrD
19178  |                        gtypOtherComRec(i).APPLY_G||18752  |                        gtypOtherComRec(i).APPLY_G
19179  |                            CStr(Format(dstrMonthN||18753  |                            CStr(Format(dstrMonthN
19180  |                        'NAVをセット              ||18754  |                        'NAVをセット              
19181  |                        gtypOtherComRec(i).APPLY_G||18755  |                        gtypOtherComRec(i).APPLY_G
19182  |                    Else                          ||18756  |                    Else                          
19183  |                        ddblNavTotal = ddblNavTota||18757  |                        ddblNavTotal = ddblNavTota
19184  |                    End If                        ||18758  |                    End If                        
19185  |                    dstrMonthOld = dstrMonthNew   ||18759  |                    dstrMonthOld = dstrMonthNew   
19186  |                                                  ||18760  |                                                  
19187  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             ||18761  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             
19188  |                    Call gDyNext                  ||18762  |                    Call gDyNext                  
19189  |                    J = J + 1                     ||18763  |                    J = J + 1                     
19190  |                Loop                              ||18764  |                Loop                              
19191  |                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                 ||18765  |                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                 
19192  |                Call gblnDyClose                  ||18766  |                Call gblnDyClose                  
19193  |                                                  ||18767  |                                                  
19194  |                'SQL文の作成(日次NAV取得)         ||18768  |                'SQL文の作成(日次NAV取得)         
19195  |                '日次NAVは当年度のNAVを取得する   ||18769  |                '日次NAVは当年度のNAVを取得する   
19196  |                sNearMonth = gtypOtherComRec(i).AP||18770  |                sNearMonth = gtypOtherComRec(i).AP
19197  |                sSql = gstrEditSQLcfr_DailyNavForS||18771  |                sSql = gstrEditSQLcfr_DailyNavForS
19198  |                    ContNo, sNearMonth)           ||18772  |                    ContNo, sNearMonth)           
19199  |                                                  ||18773  |                                                  
19200  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||18774  |                'ﾀﾞｲﾅｾｯﾄの作成                    
19201  |                If gintDyCreate(sSql) = False Then||18775  |                If gintDyCreate(sSql) = False Then
19202  |                    Exit Sub                      ||18776  |                    Exit Sub                      
19203  |                End If                            ||18777  |                End If                            
19204  |                                                  ||18778  |                                                  
19205  |                ddblNav = 0                       ||18779  |                ddblNav = 0                       
19206  |                ddblCnt = 0                       ||18780  |                ddblCnt = 0                       
19207  |                'EOF判定処理                      ||18781  |                'EOF判定処理                      
19208  |                Do Until gblnDyEOF()              ||18782  |                Do Until gblnDyEOF()              
19209  |                    '動的配列更新                 ||18783  |                    '動的配列更新                 
19210  |                    ReDim Preserve gtypOtherComRec||18784  |                    ReDim Preserve gtypOtherComRec
19211  |                    ddblNav = gvlnDyDataN("NET_ASS||18785  |                    ddblNav = gvlnDyDataN("NET_ASS
19212  |                    ddblCnt = gvlnDyDataN("NAV_CNT||18786  |                    ddblCnt = gvlnDyDataN("NAV_CNT
19213  |                    If ddblCnt > 0 Then           ||18787  |                    If ddblCnt > 0 Then           
19214  |                        ddblNavTotal = ddblNavTota||18788  |                        ddblNavTotal = ddblNavTota
19215  |                        'レコードが存在した場合基 ||18789  |                        'レコードが存在した場合基 
19216  |                        gtypOtherComRec(i).APPLY_G||18790  |                        gtypOtherComRec(i).APPLY_G
19217  |                            CStr(Format(gstrDateFo||18791  |                            CStr(Format(gstrDateFo
19218  |                        '基準月英文をセット       ||18792  |                        '基準月英文をセット       
19219  |                        gtypOtherComRec(i).APPLY_G||18793  |                        gtypOtherComRec(i).APPLY_G
19220  |                            CStr(Format(CDate(gstr||18794  |                            CStr(Format(CDate(gstr
19221  |                        'NAVをセット              ||18795  |                        'NAVをセット              
19222  |                        gtypOtherComRec(i).APPLY_G||18796  |                        gtypOtherComRec(i).APPLY_G
19223  |                    Else                          ||18797  |                    Else                          
19224  |                        ddblNavTotal = ddblNavTota||18798  |                        ddblNavTotal = ddblNavTota
19225  |                    End If                        ||18799  |                    End If                        
19226  |                                                  ||18800  |                                                  
19227  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             ||18801  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             
19228  |                    Call gDyNext                  ||18802  |                    Call gDyNext                  
19229  |                    J = J + 1                     ||18803  |                    J = J + 1                     
19230  |                Loop                              ||18804  |                Loop                              
19231  |                                                  ||18805  |                                                  
19232  |                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                 ||18806  |                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                 
19233  |                Call gblnDyClose                  ||18807  |                Call gblnDyClose                  
19234  |                                                  ||18808  |                                                  
19235  |                '月数とNAV合計とNAV平均をセット   ||18809  |                '月数とNAV合計とNAV平均をセット   
19236  |                gtypOtherComRec(i).APPLY_CALC_MONT||18810  |                gtypOtherComRec(i).APPLY_CALC_MONT
19237  |                gtypOtherComRec(i).APPLY_TOTAL_NAV||18811  |                gtypOtherComRec(i).APPLY_TOTAL_NAV
19238  |                gtypOtherComRec(i).APPLY_NAV_AVG =||18812  |                gtypOtherComRec(i).APPLY_NAV_AVG =
19239  |            Next i                                ||18813  |            Next i                                
19240  |                                                  ||18814  |                                                  
19241  |        'マザー組入資産                           ||18815  |        'マザー組入資産                           
19242  |        Case "1"                                  ||18816  |        Case "1"                                  
19243  |            '料率変更毎の計算期間日数、順位、料率 ||18817  |            '料率変更毎の計算期間日数、順位、料率 
19244  |            For i = LBound(gtypOtherComRec) To UBo||18818  |            For i = LBound(gtypOtherComRec) To UBo
19245  |                '契約番号を取得                   ||18819  |                '契約番号を取得                   
19246  |                ContNo = gbuMGetUPDRec.N(Idx).MGET||18820  |                ContNo = gbuMGetUPDRec.N(Idx).MGET
19247  |                '計算開始月をセット               ||18821  |                '計算開始月をセット               
19248  |                sZenkai = Mid(gtypOtherComRec(i).A||18822  |                sZenkai = Mid(gtypOtherComRec(i).A
19249  |                '直近締日の月の前月をセット       ||18823  |                '直近締日の月の前月をセット       
19250  |                sNearMonth = DateAdd("m", -1, gstr||18824  |                sNearMonth = DateAdd("m", -1, gstr
19251  |                sNearMonth = Mid(gstrDateFormat2(s||18825  |                sNearMonth = Mid(gstrDateFormat2(s
19252  |                '計算終了月が開始月より前の場合は ||18826  |                '計算終了月が開始月より前の場合は 
19253  |                If sZenkai > sNearMonth Then      ||18827  |                If sZenkai > sNearMonth Then      
19254  |                    sNearMonth = sZenkai          ||18828  |                    sNearMonth = sZenkai          
19255  |                End If                            ||18829  |                End If                            
19256  |                                                  ||18830  |                                                  
19257  |                'ベビーマザー比率は対象NAVの月末日||18831  |                'ベビーマザー比率は対象NAVの月末日
19258  |                sSql = gstrEditSQLcfr_MonthlyNavBa||18832  |                sSql = gstrEditSQLcfr_MonthlyNavBa
19259  |                    msAccCode, msMotherAccCode, Co||18833  |                    msAccCode, msMotherAccCode, Co
19260  |                                                  ||18834  |                                                  
19261  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||18835  |                'ﾀﾞｲﾅｾｯﾄの作成                    
19262  |                If gintDyCreate(sSql) = False Then||18836  |                If gintDyCreate(sSql) = False Then
19263  |                    Exit Sub                      ||18837  |                    Exit Sub                      
19264  |                End If                            ||18838  |                End If                            
19265  |                                                  ||18839  |                                                  
19266  |                dstrMonthOld = ""                 ||18840  |                dstrMonthOld = ""                 
19267  |                dstrMonthNew = ""                 ||18841  |                dstrMonthNew = ""                 
19268  |                ddblNav = 0                       ||18842  |                ddblNav = 0                       
19269  |                ddblCnt = 0                       ||18843  |                ddblCnt = 0                       
19270  |                ddblNavTotal = 0                  ||18844  |                ddblNavTotal = 0                  
19271  |                'ループ変数初期化                 ||18845  |                'ループ変数初期化                 
19272  |                J = 0                             ||18846  |                J = 0                             
19273  |                                                  ||18847  |                                                  
19274  |                Do Until gblnDyEOF()              ||18848  |                Do Until gblnDyEOF()              
19275  |                    '対象月次NAV抽出              ||18849  |                    '対象月次NAV抽出              
19276  |                    dstrMonthNew = gvlnDyDataS("ba||18850  |                    dstrMonthNew = gvlnDyDataS("ba
19277  |                    If dstrMonthNew <> dstrMonthOl||18851  |                    If dstrMonthNew <> dstrMonthOl
19278  |                        '動的配列更新             ||18852  |                        '動的配列更新             
19279  |                        ReDim Preserve gtypOtherCo||18853  |                        ReDim Preserve gtypOtherCo
19280  |                        ddblNav = 0               ||18854  |                        ddblNav = 0               
19281  |                        ddblCnt = 0               ||18855  |                        ddblCnt = 0               
19282  |                    End If                        ||18856  |                    End If                        
19283  |                    ddblNav = gvlnDyDataN("NET_ASS||18857  |                    ddblNav = gvlnDyDataN("NET_ASS
19284  |                    ddblBabyMotherRate = gvlnDyDat||18858  |                    ddblBabyMotherRate = gvlnDyDat
19285  |                    ddblCnt = gvlnDyDataN("NAV_CNT||18859  |                    ddblCnt = gvlnDyDataN("NAV_CNT
19286  |                    If ddblCnt > 0 Then           ||18860  |                    If ddblCnt > 0 Then           
19287  |                        'NAV合計 = NAV合計 + (取得||18861  |                        'NAV合計 = NAV合計 + (取得
19288  |                        ddblNavTotal = ddblNavTota||18862  |                        ddblNavTotal = ddblNavTota
19289  |                        'レコードが存在した場合基 ||18863  |                        'レコードが存在した場合基 
19290  |                        gtypOtherComRec(i).APPLY_G||18864  |                        gtypOtherComRec(i).APPLY_G
19291  |                            WordYear & CInt(Mid(ds||18865  |                            WordYear & CInt(Mid(ds
19292  |                        '基準月英文をセット       ||18866  |                        '基準月英文をセット       
19293  |                        dstrMonthNew = CDate(gstrD||18867  |                        dstrMonthNew = CDate(gstrD
19294  |                        gtypOtherComRec(i).APPLY_G||18868  |                        gtypOtherComRec(i).APPLY_G
19295  |                            CStr(Format(dstrMonthN||18869  |                            CStr(Format(dstrMonthN
19296  |                        'NAVをセット              ||18870  |                        'NAVをセット              
19297  |                        gtypOtherComRec(i).APPLY_G||18871  |                        gtypOtherComRec(i).APPLY_G
19298  |                    Else                          ||18872  |                    Else                          
19299  |                        ddblNavTotal = ddblNavTota||18873  |                        ddblNavTotal = ddblNavTota
19300  |                    End If                        ||18874  |                    End If                        
19301  |                    dstrMonthOld = dstrMonthNew   ||18875  |                    dstrMonthOld = dstrMonthNew   
19302  |                                                  ||18876  |                                                  
19303  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             ||18877  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             
19304  |                    Call gDyNext                  ||18878  |                    Call gDyNext                  
19305  |                    J = J + 1                     ||18879  |                    J = J + 1                     
19306  |                Loop                              ||18880  |                Loop                              
19307  |                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                 ||18881  |                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                 
19308  |                Call gblnDyClose                  ||18882  |                Call gblnDyClose                  
19309  |                                                  ||18883  |                                                  
19310  |                                                  ||18884  |                                                  
19311  |                'SQL文の作成(日次NAV取得)         ||18885  |                'SQL文の作成(日次NAV取得)         
19312  |                '日次NAVは当年度のNAVを取得する   ||18886  |                '日次NAVは当年度のNAVを取得する   
19313  |                sNearMonth = gtypOtherComRec(i).AP||18887  |                sNearMonth = gtypOtherComRec(i).AP
19314  |                '日次NAVとベビーマザー比率は当年度||18888  |                '日次NAVとベビーマザー比率は当年度
19315  |                sSql = gstrEditSQLcfr_DailyNavBaby||18889  |                sSql = gstrEditSQLcfr_DailyNavBaby
19316  |                    ContNo, sNearMonth)           ||18890  |                    ContNo, sNearMonth)           
19317  |                                                  ||18891  |                                                  
19318  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||18892  |                'ﾀﾞｲﾅｾｯﾄの作成                    
19319  |                If gintDyCreate(sSql) = False Then||18893  |                If gintDyCreate(sSql) = False Then
19320  |                    Exit Sub                      ||18894  |                    Exit Sub                      
19321  |                End If                            ||18895  |                End If                            
19322  |                                                  ||18896  |                                                  
19323  |                ddblNav = 0                       ||18897  |                ddblNav = 0                       
19324  |                ddblCnt = 0                       ||18898  |                ddblCnt = 0                       
19325  |                'EOF判定処理                      ||18899  |                'EOF判定処理                      
19326  |                Do Until gblnDyEOF()              ||18900  |                Do Until gblnDyEOF()              
19327  |                    '動的配列更新                 ||18901  |                    '動的配列更新                 
19328  |                    ReDim Preserve gtypOtherComRec||18902  |                    ReDim Preserve gtypOtherComRec
19329  |                    ddblNav = gvlnDyDataN("NET_ASS||18903  |                    ddblNav = gvlnDyDataN("NET_ASS
19330  |                    ddblBabyMotherRate = gvlnDyDat||18904  |                    ddblBabyMotherRate = gvlnDyDat
19331  |                    ddblCnt = gvlnDyDataN("NAV_CNT||18905  |                    ddblCnt = gvlnDyDataN("NAV_CNT
19332  |                    If ddblCnt > 0 Then           ||18906  |                    If ddblCnt > 0 Then           
19333  |                        'NAV合計 = NAV合計 + (取得||18907  |                        'NAV合計 = NAV合計 + (取得
19334  |                        ddblNavTotal = ddblNavTota||18908  |                        ddblNavTotal = ddblNavTota
19335  |                        'レコードが存在した場合基 ||18909  |                        'レコードが存在した場合基 
19336  |                        gtypOtherComRec(i).APPLY_G||18910  |                        gtypOtherComRec(i).APPLY_G
19337  |                            CStr(Format(gstrDateFo||18911  |                            CStr(Format(gstrDateFo
19338  |                        '基準月英文をセット       ||18912  |                        '基準月英文をセット       
19339  |                        gtypOtherComRec(i).APPLY_G||18913  |                        gtypOtherComRec(i).APPLY_G
19340  |                            CStr(Format(CDate(gstr||18914  |                            CStr(Format(CDate(gstr
19341  |                        'NAVをセット              ||18915  |                        'NAVをセット              
19342  |                        gtypOtherComRec(i).APPLY_G||18916  |                        gtypOtherComRec(i).APPLY_G
19343  |                    Else                          ||18917  |                    Else                          
19344  |                        ddblNavTotal = ddblNavTota||18918  |                        ddblNavTotal = ddblNavTota
19345  |                    End If                        ||18919  |                    End If                        
19346  |                                                  ||18920  |                                                  
19347  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             ||18921  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             
19348  |                    Call gDyNext                  ||18922  |                    Call gDyNext                  
19349  |                Loop                              ||18923  |                Loop                              
19350  |                                                  ||18924  |                                                  
19351  |                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                 ||18925  |                'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                 
19352  |                Call gblnDyClose                  ||18926  |                Call gblnDyClose                  
19353  |                                                  ||18927  |                                                  
19354  |                '月数とNAV合計とNAV平均をセット   ||18928  |                '月数とNAV合計とNAV平均をセット   
19355  |                gtypOtherComRec(i).APPLY_CALC_MONT||18929  |                gtypOtherComRec(i).APPLY_CALC_MONT
19356  |                gtypOtherComRec(i).APPLY_TOTAL_NAV||18930  |                gtypOtherComRec(i).APPLY_TOTAL_NAV
19357  |                gtypOtherComRec(i).APPLY_NAV_AVG =||18931  |                gtypOtherComRec(i).APPLY_NAV_AVG =
19358  |                                                  ||18932  |                                                  
19359  |            Next i                                ||18933  |            Next i                                
19360  |    End Select                                    ||18934  |    End Select                                    
19361  |                                                  ||18935  |                                                  
19362  |End Sub                                           ||18936  |End Sub                                           
19363  |                                                  ||18937  |                                                  
19364  |                                                  ||18938  |                                                  
19365  |                                                  ||18939  |                                                  
19366  |'=================================================||18940  |'=================================================
19367  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelEnglishOut_NotChgRat||18941  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelEnglishOut_NotChgRat
19368  |'機能            :   確認書(英文)のExcel出力(料率 ||18942  |'機能            :   確認書(英文)のExcel出力(料率 
19369  |'                                                 ||18943  |'                                                 
19370  |'日付               担当　              修正内容  ||18944  |'日付               担当　              修正内容  
19371  |'-------------------------------------------------||18945  |'-------------------------------------------------
19372  |'2006/08/18         K.Furuya <SRA>     RAFI対応   ||18946  |'2006/08/18         K.Furuya <SRA>     RAFI対応   
19373  |'                                      fnblExcelEn||18947  |'                                      fnblExcelEn
19374  |'2008/02/20         K.Furuya <SRA>     時価総額基 ||18948  |'2008/02/20         K.Furuya <SRA>     時価総額基 
19375  |'=================================================||18949  |'=================================================
19376  |Private Function fnblExcelEnglishOut_NotChgRate( _||18950  |Private Function fnblExcelEnglishOut_NotChgRate( _
19377  |    ByVal lRecIdx As Long _                       ||18951  |    ByVal lRecIdx As Long _                       
19378  |) As Boolean                                      ||18952  |) As Boolean                                      
19379  |                                                  ||18953  |                                                  
19380  |    Dim dStart      As Date     '計算期間　開始日 ||18954  |    Dim dStart      As Date     '計算期間　開始日 
19381  |    Dim dEnd        As Date     '計算期間　終了日 ||18955  |    Dim dEnd        As Date     '計算期間　終了日 
19382  |    Dim sSql        As String                     ||18956  |    Dim sSql        As String                     
19383  |    Dim sCurrencyCode As String '通貨コード(SQL文 ||18957  |    Dim sCurrencyCode As String '通貨コード(SQL文 
19384  |    Dim AccCode     As String   '口座コード(SQL文 ||18958  |    Dim AccCode     As String   '口座コード(SQL文 
19385  |    Dim sDate       As Date     '支払予定日       ||18959  |    Dim sDate       As Date     '支払予定日       
19386  |    Dim sName       As String   '担当者名         ||18960  |    Dim sName       As String   '担当者名         
19387  |    Dim i           As Integer  'カウンター       ||18961  |    Dim i           As Integer  'カウンター       
19388  |    Dim ColNum      As Integer  '部署名コンボボッ ||18962  |    Dim ColNum      As Integer  '部署名コンボボッ 
19389  |    Dim ColWord     As String   '部署名コンボボッ ||18963  |    Dim ColWord     As String   '部署名コンボボッ 
19390  |    Dim iSyouhizei  As Long     '消費税           ||18964  |    Dim iSyouhizei  As Long     '消費税           
19391  |    Dim iRowCnt     As Long     '月末純資産データ ||18965  |    Dim iRowCnt     As Long     '月末純資産データ 
19392  |    Dim TotalNav    As Currency '累積NAV          ||18966  |    Dim TotalNav    As Currency '累積NAV          
19393  |    Dim TotalRate   As Currency '累積閾値         ||18967  |    Dim TotalRate   As Currency '累積閾値         
19394  |    Dim cRate       As Currency '料率             ||18968  |    Dim cRate       As Currency '料率             
19395  |    Dim WorkRate    As Currency '一つ前の累積閾値 ||18969  |    Dim WorkRate    As Currency '一つ前の累積閾値 
19396  |    Dim TotalCom    As Currency '累積投資顧問料   ||18970  |    Dim TotalCom    As Currency '累積投資顧問料   
19397  |    Dim lTaxNum     As Currency '消費税値         ||18971  |    Dim lTaxNum     As Currency '消費税値         
19398  |    Dim lMonthlyPayCom As Currency  '月別支払額   ||18972  |    Dim lMonthlyPayCom As Currency  '月別支払額   
19399  |    Dim lCalcNav    As Currency '計算対象NAV      ||18973  |    Dim lCalcNav    As Currency '計算対象NAV      
19400  |    Dim iCalcNum    As Integer  '計算期間日数     ||18974  |    Dim iCalcNum    As Integer  '計算期間日数     
19401  |    'Excel の Application 変数とエラーをトラップす||18975  |    'Excel の Application 変数とエラーをトラップす
19402  |    Dim iTries      As Integer                    ||18976  |    Dim iTries      As Integer                    
19403  |    Dim strErrCall      As String 'エラー呼出元   ||18977  |    Dim strErrCall      As String 'エラー呼出元   
19404  |    Const conMeModule   As String = "fnblExcelEngl||18978  |    Const conMeModule   As String = "fnblExcelEngl
19405  |    'Excel の Worksheet 削除用カウンタ変数        ||18979  |    'Excel の Worksheet 削除用カウンタ変数        
19406  |    Dim Ws_Cnt      As Integer                    ||18980  |    Dim Ws_Cnt      As Integer                    
19407  |    Dim Ws_Del_Cnt  As Integer                    ||18981  |    Dim Ws_Del_Cnt  As Integer                    
19408  |    Dim Ws_Del_Cnt2 As Integer                    ||18982  |    Dim Ws_Del_Cnt2 As Integer                    
19409  |    Dim ContNo      As String   '契約番号(SQL文作 ||18983  |    Dim ContNo      As String   '契約番号(SQL文作 
19410  |    Dim NavGetCnt   As Long                       ||18984  |    Dim NavGetCnt   As Long                       
19411  |    Dim sGetAccCode As String                     ||18985  |    Dim sGetAccCode As String                     
19412  |    Dim Mnav_Flg    As String                     ||18986  |    Dim Mnav_Flg    As String                     
19413  |    Dim sStart As String            '計算対象　開 ||18987  |    Dim sStart As String            '計算対象　開 
19414  |    Dim sEnd As String              '計算対象　終 ||18988  |    Dim sEnd As String              '計算対象　終 
19415  |    Dim dstrBasedate As String      '基準日用ワー ||18989  |    Dim dstrBasedate As String      '基準日用ワー 
19416  |    Dim dstrCaldate() As String     'カレンダー日 ||18990  |    Dim dstrCaldate() As String     'カレンダー日 
19417  |    Dim ddblDailynav() As Double    '日次NAV用格納||18991  |    Dim ddblDailynav() As Double    '日次NAV用格納
19418  |    Dim dlngCnt As Long             '計算対象期間 ||18992  |    Dim dlngCnt As Long             '計算対象期間 
19419  |    Dim dstrCaldate2 As String      'カレンダー日 ||18993  |    Dim dstrCaldate2 As String      'カレンダー日 
19420  |    Dim dstrBasedate2 As String     '基準日(/編集)||18994  |    Dim dstrBasedate2 As String     '基準日(/編集)
19421  |    Dim dlngDiffdate As Long        'カレンダー日 ||18995  |    Dim dlngDiffdate As Long        'カレンダー日 
19422  |    Dim dintFor As Integer          'For文用変数  ||18996  |    Dim dintFor As Integer          'For文用変数  
19423  |    Dim ddblTtalnav As Double       '日次NAV累積用||18997  |    Dim ddblTtalnav As Double       '日次NAV累積用
19424  |    Dim dstrAvgNav As String                      ||18998  |    Dim dstrAvgNav As String                      
19425  |    Dim ddblNearNav As Double                     ||18999  |    Dim ddblNearNav As Double                     
19426  |    Dim dstrAccCd() As String                     ||19000  |    Dim dstrAccCd() As String                     
19427  |    Dim dstrBsCCd() As String                     ||19001  |    Dim dstrBsCCd() As String                     
19428  |    Dim intRtn      As Integer                    ||19002  |    Dim intRtn      As Integer                    
19429  |    Dim dstrDate         As String                ||19003  |    Dim dstrDate         As String                
19430  |    Dim dstrCurrencyCode As String                ||19004  |    Dim dstrCurrencyCode As String                
19431  |    Dim ddblExchangeRate As Double                ||19005  |    Dim ddblExchangeRate As Double                
19432  |    Dim dintPage    As Integer                    ||19006  |    Dim dintPage    As Integer                    
19433  |    Dim dintPageIni As Integer                    ||19007  |    Dim dintPageIni As Integer                    
19434  |    Dim dintAmari   As Integer                    ||19008  |    Dim dintAmari   As Integer                    
19435  |    Dim dCalDate    As Date                       ||19009  |    Dim dCalDate    As Date                       
19436  |    Dim J           As Integer                    ||19010  |    Dim J           As Integer                    
19437  |    Dim K           As Integer                    ||19011  |    Dim K           As Integer                    
19438  |    Dim L           As Integer                    ||19012  |    Dim L           As Integer                    
19439  |    Dim AvgNav      As Currency                   ||19013  |    Dim AvgNav      As Currency                   
19440  |    Dim dintFor2    As Integer                    ||19014  |    Dim dintFor2    As Integer                    
19441  |    Dim dlngMeisyoSu As Integer                   ||19015  |    Dim dlngMeisyoSu As Integer                   
19442  |    Dim dlngCntsv As Long                         ||19016  |    Dim dlngCntsv As Long                         
19443  |    '2006/08/18 START K.Furuya RAFI対応           ||19017  |    '2006/08/18 START K.Furuya RAFI対応           
19444  |    Dim ddblNearBabyMotherRate      As Double   ' ||19018  |    Dim ddblNearBabyMotherRate      As Double   ' 
19445  |    Dim MonthlyCnt                  As Long       ||19019  |    Dim MonthlyCnt                  As Long       
19446  |    Dim dblNavTotal                 As Double   ' ||19020  |    Dim dblNavTotal                 As Double   ' 
19447  |    '2006/08/18 END   K.Furuya RAFI対応           ||19021  |    '2006/08/18 END   K.Furuya RAFI対応           
19448  |                                                  ||19022  |                                                  
19449  |    '戻り値初期化                                 ||19023  |    '戻り値初期化                                 
19450  |    fnblExcelEnglishOut_NotChgRate = False        ||19024  |    fnblExcelEnglishOut_NotChgRate = False        
19451  |    i = 0                                         ||19025  |    i = 0                                         
19452  |                                                  ||19026  |                                                  
19453  |On Error Resume Next                              ||19027  |On Error Resume Next                              
19454  |                                                  ||19028  |                                                  
19455  |    Set xlSheet = xlBook.Sheets(gProcessCnt)      ||19029  |    Set xlSheet = xlBook.Sheets(gProcessCnt)      
19456  |                                                  ||19030  |                                                  
19457  |    'Excelフォーマットを調整                      ||19031  |    'Excelフォーマットを調整                      
19458  |    xlSheet.Cells.ColumnWidth = 1                 ||19032  |    xlSheet.Cells.ColumnWidth = 1                 
19459  |    xlSheet.Cells.Font.Size = 11                  ||19033  |    xlSheet.Cells.Font.Size = 11                  
19460  |                                                  ||19034  |                                                  
19461  |    'シート名を設定(確認書**)                     ||19035  |    'シート名を設定(確認書**)                     
19462  |    '契約毎のシート番号を付番する                 ||19036  |    '契約毎のシート番号を付番する                 
19463  |    'xlBook.Sheets(gProcessCnt).Name = sWord33 & (||19037  |    'xlBook.Sheets(gProcessCnt).Name = sWord33 & (
19464  |    xlBook.Sheets(gProcessCnt).Name = sWord33a & g||19038  |    xlBook.Sheets(gProcessCnt).Name = sWord33a & g
19465  |                                                  ||19039  |                                                  
19466  |    'シートの余白を設定                           ||19040  |    'シートの余白を設定                           
19467  |    xlSheet.PageSetup.TopMargin = Application.Inch||19041  |    xlSheet.PageSetup.TopMargin = Application.Inch
19468  |    xlSheet.PageSetup.BottomMargin = Application.I||19042  |    xlSheet.PageSetup.BottomMargin = Application.I
19469  |    xlSheet.PageSetup.LeftMargin = Application.Inc||19043  |    xlSheet.PageSetup.LeftMargin = Application.Inc
19470  |    xlSheet.PageSetup.RightMargin = Application.In||19044  |    xlSheet.PageSetup.RightMargin = Application.In
19471  |                                                  ||19045  |                                                  
19472  |    DoEvents                                      ||19046  |    DoEvents                                      
19473  |    With xlSheet                                  ||19047  |    With xlSheet                                  
19474  |        '題目                                     ||19048  |        '題目                                     
19475  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||19049  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
19476  |            Case Mid(mstrContractFlag(1), 1, 1)   ||19050  |            Case Mid(mstrContractFlag(1), 1, 1)   
19477  |                .Cells(5, 1).Value = sWord0d      ||19051  |                .Cells(5, 1).Value = sWord0d      
19478  |            Case Mid(mstrContractFlag(2), 1, 1)   ||19052  |            Case Mid(mstrContractFlag(2), 1, 1)   
19479  |                .Cells(5, 1).Value = sWord0e      ||19053  |                .Cells(5, 1).Value = sWord0e      
19480  |            Case Mid(mstrContractFlag(3), 1, 1)   ||19054  |            Case Mid(mstrContractFlag(3), 1, 1)   
19481  |                .Cells(5, 1).Value = sWord0f      ||19055  |                .Cells(5, 1).Value = sWord0f      
19482  |            Case Else                             ||19056  |            Case Else                             
19483  |                MsgBox "契約区分が不正です。", vbC||19057  |                MsgBox "契約区分が不正です。", vbC
19484  |        End Select                                ||19058  |        End Select                                
19485  |        .Cells(5, 1).Font.Size = 14               ||19059  |        .Cells(5, 1).Font.Size = 14               
19486  |        .Range("A5:BG5").HorizontalAlignment = xlC||19060  |        .Range("A5:BG5").HorizontalAlignment = xlC
19487  |                                                  ||19061  |                                                  
19488  |        '出力日付                                 ||19062  |        '出力日付                                 
19489  |        If RTrim(txtSysOutDate.Text) = "" Then    ||19063  |        If RTrim(txtSysOutDate.Text) = "" Then    
19490  |            .Cells(3, 50).Value = sWord34a        ||19064  |            .Cells(3, 50).Value = sWord34a        
19491  |            .Cells(3, 50).HorizontalAlignment = xl||19065  |            .Cells(3, 50).HorizontalAlignment = xl
19492  |        Else                                      ||19066  |        Else                                      
19493  |            .Cells(3, 43).NumberFormatLocal = "@" ||19067  |            .Cells(3, 43).NumberFormatLocal = "@" 
19494  |            .Cells(3, 43).Value = CStr(Format(txtS||19068  |            .Cells(3, 43).Value = CStr(Format(txtS
19495  |        End If                                    ||19069  |        End If                                    
19496  |                                                  ||19070  |                                                  
19497  |        '下記のとおり･･･                          ||19071  |        '下記のとおり･･･                          
19498  |        .Cells(7, 2).Value = "Dear Sirs,"         ||19072  |        .Cells(7, 2).Value = "Dear Sirs,"         
19499  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||19073  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
19500  |            Case Mid(mstrContractFlag(1), 1, 1)   ||19074  |            Case Mid(mstrContractFlag(1), 1, 1)   
19501  |                .Cells(8, 2).Value = sWord3d      ||19075  |                .Cells(8, 2).Value = sWord3d      
19502  |            Case Mid(mstrContractFlag(2), 1, 1)   ||19076  |            Case Mid(mstrContractFlag(2), 1, 1)   
19503  |                .Cells(8, 2).Value = sWord3e      ||19077  |                .Cells(8, 2).Value = sWord3e      
19504  |            Case Mid(mstrContractFlag(3), 1, 1)   ||19078  |            Case Mid(mstrContractFlag(3), 1, 1)   
19505  |                .Cells(8, 2).Value = sWord3f      ||19079  |                .Cells(8, 2).Value = sWord3f      
19506  |            Case Else                             ||19080  |            Case Else                             
19507  |        End Select                                ||19081  |        End Select                                
19508  |                                                  ||19082  |                                                  
19509  |        'ファンド名                               ||19083  |        'ファンド名                               
19510  |        .Cells(10, 2).Value = sWord4a             ||19084  |        .Cells(10, 2).Value = sWord4a             
19511  |        '文言の冗長化でピリオド及び、名称を二列右 ||19085  |        '文言の冗長化でピリオド及び、名称を二列右 
19512  |'        .Cells(10, 11).Value = sWord19           ||19086  |'        .Cells(10, 11).Value = sWord19           
19513  |'        .Cells(10, 13).Value = gbuMGetUPDRec.N(lR||19087  |'        .Cells(10, 13).Value = gbuMGetUPDRec.N(lR
19514  |        .Cells(10, 13).Value = sWord19            ||19088  |        .Cells(10, 13).Value = sWord19            
19515  |        .Cells(10, 15).Value = gbuMGetUPDRec.N(lRe||19089  |        .Cells(10, 15).Value = gbuMGetUPDRec.N(lRe
19516  |                                                  ||19090  |                                                  
19517  |        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_con||19091  |        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_con
19518  |                                                  ||19092  |                                                  
19519  |        'RAFI対応 START                           ||19093  |        'RAFI対応 START                           
19520  |        'NAV取得SQL                               ||19094  |        'NAV取得SQL                               
19521  |        '外部委託顧問料ルールの資産種類によって取 ||19095  |        '外部委託顧問料ルールの資産種類によって取 
19522  |        '純資産                                   ||19096  |        '純資産                                   
19523  |        If msAssetFlg = "0" Then                  ||19097  |        If msAssetFlg = "0" Then                  
19524  |            sSql = gstrEditSQLcfr_NavGetForSelectL||19098  |            sSql = gstrEditSQLcfr_NavGetForSelectL
19525  |        'マザー組入資産                           ||19099  |        'マザー組入資産                           
19526  |        Else                                      ||19100  |        Else                                      
19527  |            sSql = gstrEditSQLcfr_MotherAccGetForS||19101  |            sSql = gstrEditSQLcfr_MotherAccGetForS
19528  |        End If                                    ||19102  |        End If                                    
19529  |                                                  ||19103  |                                                  
19530  |        'ﾀﾞｲﾅｾｯﾄの作成                            ||19104  |        'ﾀﾞｲﾅｾｯﾄの作成                            
19531  |        If gintDyCreate(sSql) = False Then        ||19105  |        If gintDyCreate(sSql) = False Then        
19532  |            Exit Function                         ||19106  |            Exit Function                         
19533  |        End If                                    ||19107  |        End If                                    
19534  |        Do Until gblnDyEOF()                      ||19108  |        Do Until gblnDyEOF()                      
19535  |            '動的配列更新                         ||19109  |            '動的配列更新                         
19536  |            ReDim Preserve gtypcfr_navget_tbl(0 To||19110  |            ReDim Preserve gtypcfr_navget_tbl(0 To
19537  |            ReDim Preserve dstrAccCd(0 To NavGetCn||19111  |            ReDim Preserve dstrAccCd(0 To NavGetCn
19538  |                                                  ||19112  |                                                  
19539  |            'NAV取得抽出                          ||19113  |            'NAV取得抽出                          
19540  |            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT_||19114  |            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT_
19541  |            If NavGetCnt > 0 Then                 ||19115  |            If NavGetCnt > 0 Then                 
19542  |                sGetAccCode = sGetAccCode & " , " ||19116  |                sGetAccCode = sGetAccCode & " , " 
19543  |            Else                                  ||19117  |            Else                                  
19544  |                sGetAccCode = sGetAccCode & gtypcf||19118  |                sGetAccCode = sGetAccCode & gtypcf
19545  |            End If                                ||19119  |            End If                                
19546  |                                                  ||19120  |                                                  
19547  |            '口座コードの格納(１契約複数口座の場合||19121  |            '口座コードの格納(１契約複数口座の場合
19548  |            dstrAccCd(NavGetCnt) = gtypcfr_navget_||19122  |            dstrAccCd(NavGetCnt) = gtypcfr_navget_
19549  |            NavGetCnt = NavGetCnt + 1             ||19123  |            NavGetCnt = NavGetCnt + 1             
19550  |            'マザー組入資産の場合ベビーファンドコ ||19124  |            'マザー組入資産の場合ベビーファンドコ 
19551  |            If msAssetFlg = "1" Then              ||19125  |            If msAssetFlg = "1" Then              
19552  |                msBabyAccountCode = ""            ||19126  |                msBabyAccountCode = ""            
19553  |                msBabyAccountCode = Trim(gvlnDyDat||19127  |                msBabyAccountCode = Trim(gvlnDyDat
19554  |            End If                                ||19128  |            End If                                
19555  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     ||19129  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     
19556  |            Call gDyNext                          ||19130  |            Call gDyNext                          
19557  |        Loop                                      ||19131  |        Loop                                      
19558  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         ||19132  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         
19559  |        Call gblnDyClose                          ||19133  |        Call gblnDyClose                          
19560  |                                                  ||19134  |                                                  
19561  |        '１契約複数口座の場合に口座のベース通貨に ||19135  |        '１契約複数口座の場合に口座のベース通貨に 
19562  |        ReDim dstrBsCCd(0 To NavGetCnt - 1)       ||19136  |        ReDim dstrBsCCd(0 To NavGetCnt - 1)       
19563  |        If NavGetCnt - 1 > 0 Then                 ||19137  |        If NavGetCnt - 1 > 0 Then                 
19564  |            For dintFor = 0 To NavGetCnt - 1      ||19138  |            For dintFor = 0 To NavGetCnt - 1      
19565  |                sSql = ""                         ||19139  |                sSql = ""                         
19566  |                sSql = sSql & "SELECT ACCOUNT_CODE||19140  |                sSql = sSql & "SELECT ACCOUNT_CODE
19567  |                sSql = sSql & "WHERE ACCOUNT_CODE ||19141  |                sSql = sSql & "WHERE ACCOUNT_CODE 
19568  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||19142  |                'ﾀﾞｲﾅｾｯﾄの作成                    
19569  |                If gintDyCreate(sSql) = False Then||19143  |                If gintDyCreate(sSql) = False Then
19570  |                    Exit Function                 ||19144  |                    Exit Function                 
19571  |                Else                              ||19145  |                Else                              
19572  |                    dstrBsCCd(dintFor) = gvlnDyDat||19146  |                    dstrBsCCd(dintFor) = gvlnDyDat
19573  |                End If                            ||19147  |                End If                            
19574  |                If dintFor > 0 Then               ||19148  |                If dintFor > 0 Then               
19575  |                    If dstrBsCCd(dintFor) <> dstrB||19149  |                    If dstrBsCCd(dintFor) <> dstrB
19576  |                        intRtn = MsgBox("ファンド ||19150  |                        intRtn = MsgBox("ファンド 
19577  |                        Exit Function             ||19151  |                        Exit Function             
19578  |                    End If                        ||19152  |                    End If                        
19579  |                End If                            ||19153  |                End If                            
19580  |            Next dintFor                          ||19154  |            Next dintFor                          
19581  |                                                  ||19155  |                                                  
19582  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||19156  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
19583  |            Call gblnDyClose                      ||19157  |            Call gblnDyClose                      
19584  |                                                  ||19158  |                                                  
19585  |        End If                                    ||19159  |        End If                                    
19586  |                                                  ||19160  |                                                  
19587  |        'ファンドコード                           ||19161  |        'ファンドコード                           
19588  |        .Cells(11, 2).Value = sWord4_2a           ||19162  |        .Cells(11, 2).Value = sWord4_2a           
19589  |        '文言の冗長化でピリオド及び、名称を二列右 ||19163  |        '文言の冗長化でピリオド及び、名称を二列右 
19590  |'        .Cells(11, 11).Value = sWord19           ||19164  |'        .Cells(11, 11).Value = sWord19           
19591  |'        .Cells(11, 13).NumberFormatLocal = "@"   ||19165  |'        .Cells(11, 13).NumberFormatLocal = "@"   
19592  |        .Cells(11, 13).Value = sWord19            ||19166  |        .Cells(11, 13).Value = sWord19            
19593  |        .Cells(11, 15).NumberFormatLocal = "@"    ||19167  |        .Cells(11, 15).NumberFormatLocal = "@"    
19594  |        'RAFI対応 START                           ||19168  |        'RAFI対応 START                           
19595  |        '純資産の場合                             ||19169  |        '純資産の場合                             
19596  |        If msAssetFlg = "0" Then                  ||19170  |        If msAssetFlg = "0" Then                  
19597  |'            .Cells(11, 13).Value = sGetAccCode   ||19171  |'            .Cells(11, 13).Value = sGetAccCode   
19598  |            .Cells(11, 15).Value = sGetAccCode    ||19172  |            .Cells(11, 15).Value = sGetAccCode    
19599  |        'マザー組入資産の場合                     ||19173  |        'マザー組入資産の場合                     
19600  |        Else                                      ||19174  |        Else                                      
19601  |'            .Cells(11, 13).Value = msBabyAccountC||19175  |'            .Cells(11, 13).Value = msBabyAccountC
19602  |            .Cells(11, 15).Value = msBabyAccountCo||19176  |            .Cells(11, 15).Value = msBabyAccountCo
19603  |        End If                                    ||19177  |        End If                                    
19604  |        'RAFI対応 END                             ||19178  |        'RAFI対応 END                             
19605  |                                                  ||19179  |                                                  
19606  |        '計算期間                                 ||19180  |        '計算期間                                 
19607  |        .Cells(13, 2).Value = sWord5a             ||19181  |        .Cells(13, 2).Value = sWord5a             
19608  |        '文言の冗長化でピリオド及び、名称を二列右 ||19182  |        '文言の冗長化でピリオド及び、名称を二列右 
19609  |'        .Cells(13, 11).Value = sWord19           ||19183  |'        .Cells(13, 11).Value = sWord19           
19610  |        .Cells(13, 13).Value = sWord19            ||19184  |        .Cells(13, 13).Value = sWord19            
19611  |                                                  ||19185  |                                                  
19612  |        '前回締日・直近締日セット                 ||19186  |        '前回締日・直近締日セット                 
19613  |        dStart = CDate(gstrDateFormat(mstrSettleme||19187  |        dStart = CDate(gstrDateFormat(mstrSettleme
19614  |        dEnd = CDate(gstrDateFormat(mstrNearSettle||19188  |        dEnd = CDate(gstrDateFormat(mstrNearSettle
19615  |        dstrDate = Replace(CStr(dEnd), "/", "")   ||19189  |        dstrDate = Replace(CStr(dEnd), "/", "")   
19616  |        iCalcNum = DateDiff("d", dStart, dEnd) + 1||19190  |        iCalcNum = DateDiff("d", dStart, dEnd) + 1
19617  |                                                  ||19191  |                                                  
19618  |        '年率                                     ||19192  |        '年率                                     
19619  |        .Cells(15, 2).Value = sWord10a            ||19193  |        .Cells(15, 2).Value = sWord10a            
19620  |        '文言の冗長化でピリオド及び、名称を二列右 ||19194  |        '文言の冗長化でピリオド及び、名称を二列右 
19621  |'        .Cells(15, 11).Value = sWord19           ||19195  |'        .Cells(15, 11).Value = sWord19           
19622  |        .Cells(15, 13).Value = sWord19            ||19196  |        .Cells(15, 13).Value = sWord19            
19623  |                                                  ||19197  |                                                  
19624  |        '月末純資産                               ||19198  |        '月末純資産                               
19625  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||19199  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
19626  |        '取得NAV区分が4:日次時価総額平均の場合"Mon||19200  |        '取得NAV区分が4:日次時価総額平均の場合"Mon
19627  |        If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||19201  |        If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
19628  |            .Cells(27, 2).Value = sWord63a        ||19202  |            .Cells(27, 2).Value = sWord63a        
19629  |        Else                                      ||19203  |        Else                                      
19630  |            .Cells(27, 2).Value = sWord6a         ||19204  |            .Cells(27, 2).Value = sWord6a         
19631  |        End If                                    ||19205  |        End If                                    
19632  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||19206  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
19633  |        .Cells(27, 21).Value = sWord19            ||19207  |        .Cells(27, 21).Value = sWord19            
19634  |                                                  ||19208  |                                                  
19635  |        '@@@@@ 合計行を出力しないならここをコメン ||19209  |        '@@@@@ 合計行を出力しないならここをコメン 
19636  |        '合計(純資産)                             ||19210  |        '合計(純資産)                             
19637  |        .Cells(40, 25).Value = sWord9a            ||19211  |        .Cells(40, 25).Value = sWord9a            
19638  |        .Range("X40:AI40").HorizontalAlignment = x||19212  |        .Range("X40:AI40").HorizontalAlignment = x
19639  |                                                  ||19213  |                                                  
19640  |'        '契約区分「1」or「2」or (「3」and 取得NAV||19214  |'        '契約区分「1」or「2」or (「3」and 取得NAV
19641  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||19215  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
19642  |            Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c||19216  |            Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c
19643  |            Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_||19217  |            Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_
19644  |                And gbuMGetUPDRec.N(lRecIdx).MGET_||19218  |                And gbuMGetUPDRec.N(lRecIdx).MGET_
19645  |                                                  ||19219  |                                                  
19646  |'取得NAV区分[1]                                   ||19220  |'取得NAV区分[1]                                   
19647  |            '月末NAV取得                          ||19221  |            '月末NAV取得                          
19648  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g||19222  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g
19649  |                '月次NAVを取得する                ||19223  |                '月次NAVを取得する                
19650  |                Call sbMonthlyNAV_GetNotChgRate(lR||19224  |                Call sbMonthlyNAV_GetNotChgRate(lR
19651  |                                                  ||19225  |                                                  
19652  |                '月次NAVを累積                    ||19226  |                '月次NAVを累積                    
19653  |                For i = LBound(gtypcfr_mnav_tbl) T||19227  |                For i = LBound(gtypcfr_mnav_tbl) T
19654  |                    If Len(gtypcfr_mnav_tbl(i).BAS||19228  |                    If Len(gtypcfr_mnav_tbl(i).BAS
19655  |                        '日付                     ||19229  |                        '日付                     
19656  |                         gtypcfr_mnav_tbl(i).BASE_||19230  |                         gtypcfr_mnav_tbl(i).BASE_
19657  |                        .Cells(27 + i, 25).Value =||19231  |                        .Cells(27 + i, 25).Value =
19658  |                        '純資産                   ||19232  |                        '純資産                   
19659  |                        .Cells(27 + i, 49).NumberF||19233  |                        .Cells(27 + i, 49).NumberF
19660  |                                                  ||19234  |                                                  
19661  |                        If gbuMGetUPDRec.N(lRecIdx||19235  |                        If gbuMGetUPDRec.N(lRecIdx
19662  |                            .Cells(27 + i, 49).Val||19236  |                            .Cells(27 + i, 49).Val
19663  |                        Else                      ||19237  |                        Else                      
19664  |                            .Cells(27 + i, 49).Val||19238  |                            .Cells(27 + i, 49).Val
19665  |                        End If                    ||19239  |                        End If                    
19666  |                        .Cells(27 + i, 49).Horizon||19240  |                        .Cells(27 + i, 49).Horizon
19667  |                                                  ||19241  |                                                  
19668  |                        TotalNav = TotalNav + CCur||19242  |                        TotalNav = TotalNav + CCur
19669  |                        iRowCnt = iRowCnt + 1     ||19243  |                        iRowCnt = iRowCnt + 1     
19670  |                    Else                          ||19244  |                    Else                          
19671  |                        Mnav_Flg = 1              ||19245  |                        Mnav_Flg = 1              
19672  |                    End If                        ||19246  |                    End If                        
19673  |                                                  ||19247  |                                                  
19674  |                Next i                            ||19248  |                Next i                            
19675  |                                                  ||19249  |                                                  
19676  |                '保留★★（1を引く意味がわからない||19250  |                '保留★★（1を引く意味がわからない
19677  |                '日次NAVを算出                    ||19251  |                '日次NAVを算出                    
19678  |'                If Mnav_Flg = 1 Then             ||19252  |'                If Mnav_Flg = 1 Then             
19679  |'                    i = i - 1                    ||19253  |'                    i = i - 1                    
19680  |'                End If                           ||19254  |'                End If                           
19681  |                                                  ||19255  |                                                  
19682  |                If mstrDailyNav <> "" Then        ||19256  |                If mstrDailyNav <> "" Then        
19683  |                    '日付                         ||19257  |                    '日付                         
19684  |                    .Cells(27 + i, 25).NumberForma||19258  |                    .Cells(27 + i, 25).NumberForma
19685  |                    .Cells(27 + i, 25).Value = CSt||19259  |                    .Cells(27 + i, 25).Value = CSt
19686  |                    .Cells(27 + i, 25).HorizontalA||19260  |                    .Cells(27 + i, 25).HorizontalA
19687  |                    '純資産                       ||19261  |                    '純資産                       
19688  |                    .Cells(27 + i, 49).NumberForma||19262  |                    .Cells(27 + i, 49).NumberForma
19689  |                                                  ||19263  |                                                  
19690  |                    If gbuMGetUPDRec.N(lRecIdx).MG||19264  |                    If gbuMGetUPDRec.N(lRecIdx).MG
19691  |                        .Cells(27 + i, 49).Value =||19265  |                        .Cells(27 + i, 49).Value =
19692  |                    Else                          ||19266  |                    Else                          
19693  |                        .Cells(27 + i, 49).Value =||19267  |                        .Cells(27 + i, 49).Value =
19694  |                    End If                        ||19268  |                    End If                        
19695  |                                                  ||19269  |                                                  
19696  |                    .Cells(27 + i, 49).HorizontalA||19270  |                    .Cells(27 + i, 49).HorizontalA
19697  |                    TotalNav = TotalNav + CCur(mst||19271  |                    TotalNav = TotalNav + CCur(mst
19698  |                    iRowCnt = iRowCnt + 1         ||19272  |                    iRowCnt = iRowCnt + 1         
19699  |                                                  ||19273  |                                                  
19700  |                End If                            ||19274  |                End If                            
19701  |                                                  ||19275  |                                                  
19702  |                '@@@@@ 合計行を出力しないならここ ||19276  |                '@@@@@ 合計行を出力しないならここ 
19703  |                .Cells(40, 49).NumberFormatLocal =||19277  |                .Cells(40, 49).NumberFormatLocal =
19704  |                .Cells(40, 49).Value = CStr(Format||19278  |                .Cells(40, 49).Value = CStr(Format
19705  |                                                  ||19279  |                                                  
19706  |                 If gbuMGetUPDRec.N(lRecIdx).MGET_||19280  |                 If gbuMGetUPDRec.N(lRecIdx).MGET_
19707  |                    '@@@@@ 合計行を出力しないなら ||19281  |                    '@@@@@ 合計行を出力しないなら 
19708  |                    .Cells(40, 49).Value = CStr(Fo||19282  |                    .Cells(40, 49).Value = CStr(Fo
19709  |                 Else                             ||19283  |                 Else                             
19710  |                    '合計行を出力しないならここを ||19284  |                    '合計行を出力しないならここを 
19711  |                    .Cells(40, 49).Value = CStr(Fo||19285  |                    .Cells(40, 49).Value = CStr(Fo
19712  |                 End If                           ||19286  |                 End If                           
19713  |                 .Cells(40, 49).HorizontalAlignmen||19287  |                 .Cells(40, 49).HorizontalAlignmen
19714  |                                                  ||19288  |                                                  
19715  |                 '平均純資産総額                  ||19289  |                 '平均純資産総額                  
19716  |                 .Cells(43, 2).Value = sWord51a   ||19290  |                 .Cells(43, 2).Value = sWord51a   
19717  |                 .Cells(43, 16).Value = sWord19   ||19291  |                 .Cells(43, 16).Value = sWord19   
19718  |                                                  ||19292  |                                                  
19719  |                 '計算期間の純資産総額の合計(月末 ||19293  |                 '計算期間の純資産総額の合計(月末 
19720  |                 .Cells(43, 28).NumberFormatLocal ||19294  |                 .Cells(43, 28).NumberFormatLocal 
19721  |                                                  ||19295  |                                                  
19722  |                 If gbuMGetUPDRec.N(lRecIdx).MGET_||19296  |                 If gbuMGetUPDRec.N(lRecIdx).MGET_
19723  |                     .Cells(43, 28).Value = CStr(F||19297  |                     .Cells(43, 28).Value = CStr(F
19724  |                 Else                             ||19298  |                 Else                             
19725  |                     .Cells(43, 28).Value = CStr(F||19299  |                     .Cells(43, 28).Value = CStr(F
19726  |                 End If                           ||19300  |                 End If                           
19727  |                                                  ||19301  |                                                  
19728  |                 .Cells(43, 28).HorizontalAlignmen||19302  |                 .Cells(43, 28).HorizontalAlignmen
19729  |                                                  ||19303  |                                                  
19730  |                 '計算期間の純資産総額の合計÷計算||19304  |                 '計算期間の純資産総額の合計÷計算
19731  |                 .Cells(43, 40).NumberFormatLocal ||19305  |                 .Cells(43, 40).NumberFormatLocal 
19732  |                 dblValueIn = TotalNav / iRowCnt  ||19306  |                 dblValueIn = TotalNav / iRowCnt  
19733  |                                                  ||19307  |                                                  
19734  |                 If gbuMGetUPDRec.N(lRecIdx).MGET_||19308  |                 If gbuMGetUPDRec.N(lRecIdx).MGET_
19735  |                     Call sbGetRoundValue2(dblValu||19309  |                     Call sbGetRoundValue2(dblValu
19736  |                 Else                             ||19310  |                 Else                             
19737  |                     Call sbGetRoundValue(dblValue||19311  |                     Call sbGetRoundValue(dblValue
19738  |                 End If                           ||19312  |                 End If                           
19739  |                                                  ||19313  |                                                  
19740  |                '平均NAV(計算対象NAV)             ||19314  |                '平均NAV(計算対象NAV)             
19741  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||19315  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
19742  |                    .Cells(43, 40).Value = CStr(Fo||19316  |                    .Cells(43, 40).Value = CStr(Fo
19743  |                Else                              ||19317  |                Else                              
19744  |                    .Cells(43, 40).Value = CStr(Fo||19318  |                    .Cells(43, 40).Value = CStr(Fo
19745  |                End If                            ||19319  |                End If                            
19746  |                                                  ||19320  |                                                  
19747  |                '÷??＝                           ||19321  |                '÷??＝                           
19748  |                .Cells(43, 31).Value = sWord18 & "||19322  |                .Cells(43, 31).Value = sWord18 & "
19749  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||19323  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
19750  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_n||19324  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_n
19751  |            '=====================================||19325  |            '=====================================
19752  |            '==                                   ||19326  |            '==                                   
19753  |            '==  '4':日次時価総額平均(休日込)の計 ||19327  |            '==  '4':日次時価総額平均(休日込)の計 
19754  |            '==                                   ||19328  |            '==                                   
19755  |            '=====================================||19329  |            '=====================================
19756  |                ddblTtalnav = 0                   ||19330  |                ddblTtalnav = 0                   
19757  |                For dintFor = 0 To NavGetCnt - 1  ||19331  |                For dintFor = 0 To NavGetCnt - 1  
19758  |                                                  ||19332  |                                                  
19759  |                    '日次時価総額平均取得         ||19333  |                    '日次時価総額平均取得         
19760  |                    sStart = gstrDateFormat2(CStr(||19334  |                    sStart = gstrDateFormat2(CStr(
19761  |                    sEnd = gstrDateFormat2(CStr(dE||19335  |                    sEnd = gstrDateFormat2(CStr(dE
19762  |                                                  ||19336  |                                                  
19763  |                    '計算開始日と外部委託顧問料計 ||19337  |                    '計算開始日と外部委託顧問料計 
19764  |                    If sStart = gbuMGetUPDRec.N(lR||19338  |                    If sStart = gbuMGetUPDRec.N(lR
19765  |                        '== SQL1 ==               ||19339  |                        '== SQL1 ==               
19766  |                        sSql = ""                 ||19340  |                        sSql = ""                 
19767  |                        sSql = sSql & "SELECT EIGY||19341  |                        sSql = sSql & "SELECT EIGY
19768  |                                                  ||19342  |                                                  
19769  |                        'ﾀﾞｲﾅｾｯﾄの作成            ||19343  |                        'ﾀﾞｲﾅｾｯﾄの作成            
19770  |                        If gintDyCreate(sSql) = Fa||19344  |                        If gintDyCreate(sSql) = Fa
19771  |                            Exit Function         ||19345  |                            Exit Function         
19772  |                         Else                     ||19346  |                         Else                     
19773  |                            '休日の場合、翌営業日 ||19347  |                            '休日の場合、翌営業日 
19774  |                            If gvlnDyDataS("EIGYO_||19348  |                            If gvlnDyDataS("EIGYO_
19775  |                                '翌営業日の時価総 ||19349  |                                '翌営業日の時価総 
19776  |                                '== SQL2 ==       ||19350  |                                '== SQL2 ==       
19777  |                                sSql = ""         ||19351  |                                sSql = ""         
19778  |                                sSql = sSql & "SEL||19352  |                                sSql = sSql & "SEL
19779  |                                sSql = sSql & "FRO||19353  |                                sSql = sSql & "FRO
19780  |                                sSql = sSql & "(SE||19354  |                                sSql = sSql & "(SE
19781  |                                sSql = sSql & "WHE||19355  |                                sSql = sSql & "WHE
19782  |                                                  ||19356  |                                                  
19783  |                                'ﾀﾞｲﾅｾｯﾄの作成    ||19357  |                                'ﾀﾞｲﾅｾｯﾄの作成    
19784  |                                If gintDyCreate(sS||19358  |                                If gintDyCreate(sS
19785  |                                    Exit Function ||19359  |                                    Exit Function 
19786  |                                Else              ||19360  |                                Else              
19787  |                                    ddblNearNav = ||19361  |                                    ddblNearNav = 
19788  |'2008/03/06 START 時価総額基準の外部委託顧問料対応||19362  |'2008/03/06 START 時価総額基準の外部委託顧問料対応
19789  |'                                    '翌営業日の計||19363  |'                                    '翌営業日の計
19790  |'                                    '== SQL3 ==  ||19364  |'                                    '== SQL3 ==  
19791  |'                                    sSql = ""    ||19365  |'                                    sSql = ""    
19792  |'                                    sSql = sSql &||19366  |'                                    sSql = sSql &
19793  |'                                    sSql = sSql &||19367  |'                                    sSql = sSql &
19794  |'                                    sSql = sSql &||19368  |'                                    sSql = sSql &
19795  |'                                    sSql = sSql &||19369  |'                                    sSql = sSql &
19796  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||19370  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
19797  |'                                    If gintDyCrea||19371  |'                                    If gintDyCrea
19798  |'                                        Exit Func||19372  |'                                        Exit Func
19799  |'                                     Else        ||19373  |'                                     Else        
19800  |'                                        '計算開始||19374  |'                                        '計算開始
19801  |'                                        sStart = ||19375  |'                                        sStart = 
19802  |'                                        dStart = ||19376  |'                                        dStart = 
19803  |'                                        '文言の冗||19377  |'                                        '文言の冗
19804  |''                                        .Cells(1||19378  |''                                        .Cells(1
19805  |''                                            CStr||19379  |''                                            CStr
19806  |'                                        .Cells(16||19380  |'                                        .Cells(16
19807  |'                                            CStr(||19381  |'                                            CStr(
19808  |'                                        iCalcNum ||19382  |'                                        iCalcNum 
19809  |'                                    End If       ||19383  |'                                    End If       
19810  |'2008/03/06 END   時価総額基準の外部委託顧問料対応||19384  |'2008/03/06 END   時価総額基準の外部委託顧問料対応
19811  |                                End If            ||19385  |                                End If            
19812  |                                'RAFI対応 START   ||19386  |                                'RAFI対応 START   
19813  |                                '翌営業日のマザー ||19387  |                                '翌営業日のマザー 
19814  |                                If msAssetFlg = "1||19388  |                                If msAssetFlg = "1
19815  |                                    '== SQL4 ==   ||19389  |                                    '== SQL4 ==   
19816  |                                    sSql = ""     ||19390  |                                    sSql = ""     
19817  |                                    sSql = sSql & ||19391  |                                    sSql = sSql & 
19818  |                                    sSql = sSql & ||19392  |                                    sSql = sSql & 
19819  |                                    sSql = sSql & ||19393  |                                    sSql = sSql & 
19820  |                                    sSql = sSql & ||19394  |                                    sSql = sSql & 
19821  |                                    sSql = sSql & ||19395  |                                    sSql = sSql & 
19822  |                                    sSql = sSql & ||19396  |                                    sSql = sSql & 
19823  |                                    sSql = sSql & ||19397  |                                    sSql = sSql & 
19824  |                                    sSql = sSql & ||19398  |                                    sSql = sSql & 
19825  |                                    sSql = sSql & ||19399  |                                    sSql = sSql & 
19826  |                                    sSql = sSql & ||19400  |                                    sSql = sSql & 
19827  |                                    sSql = sSql & ||19401  |                                    sSql = sSql & 
19828  |                                    sSql = sSql & ||19402  |                                    sSql = sSql & 
19829  |                                    sSql = sSql & ||19403  |                                    sSql = sSql & 
19830  |                                    sSql = sSql & ||19404  |                                    sSql = sSql & 
19831  |                                    sSql = sSql & ||19405  |                                    sSql = sSql & 
19832  |                                    sSql = sSql & ||19406  |                                    sSql = sSql & 
19833  |                                    sSql = sSql & ||19407  |                                    sSql = sSql & 
19834  |                                    sSql = sSql & ||19408  |                                    sSql = sSql & 
19835  |                                    sSql = sSql & ||19409  |                                    sSql = sSql & 
19836  |                                    sSql = sSql & ||19410  |                                    sSql = sSql & 
19837  |                                    sSql = sSql & ||19411  |                                    sSql = sSql & 
19838  |                                    sSql = sSql & ||19412  |                                    sSql = sSql & 
19839  |                                    sSql = sSql & ||19413  |                                    sSql = sSql & 
19840  |                                    sSql = sSql & ||19414  |                                    sSql = sSql & 
19841  |                                    'ﾀﾞｲﾅｾｯﾄの作成||19415  |                                    'ﾀﾞｲﾅｾｯﾄの作成
19842  |                                                  ||19416  |                                                  
19843  |                                    If gintDyCreat||19417  |                                    If gintDyCreat
19844  |                                        Exit Funct||19418  |                                        Exit Funct
19845  |                                    Else          ||19419  |                                    Else          
19846  |                                        ddblNearBa||19420  |                                        ddblNearBa
19847  |                                    End If        ||19421  |                                    End If        
19848  |                                End If            ||19422  |                                End If            
19849  |                                'RAFI対応 END     ||19423  |                                'RAFI対応 END     
19850  |                            End If                ||19424  |                            End If                
19851  |                        End If                    ||19425  |                        End If                    
19852  |                    End If                        ||19426  |                    End If                        
19853  |                    '== SQL5 ==                   ||19427  |                    '== SQL5 ==                   
19854  |                    sSql = ""                     ||19428  |                    sSql = ""                     
19855  |                    sSql = sSql & "SELECT CAL_YYYY||19429  |                    sSql = sSql & "SELECT CAL_YYYY
19856  |                    sSql = sSql & "WHERE CAL_YYYY ||19430  |                    sSql = sSql & "WHERE CAL_YYYY 
19857  |                                                  ||19431  |                                                  
19858  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||19432  |                    'ﾀﾞｲﾅｾｯﾄの作成                
19859  |                    If gintDyCreate(sSql) = False ||19433  |                    If gintDyCreate(sSql) = False 
19860  |                        Exit Function             ||19434  |                        Exit Function             
19861  |                    End If                        ||19435  |                    End If                        
19862  |                                                  ||19436  |                                                  
19863  |                    If dlngCnt = 0 Then           ||19437  |                    If dlngCnt = 0 Then           
19864  |                        ReDim dstrCaldate(gbxOraDy||19438  |                        ReDim dstrCaldate(gbxOraDy
19865  |                        ReDim ddblDailynav(gbxOraD||19439  |                        ReDim ddblDailynav(gbxOraD
19866  |                    End If                        ||19440  |                    End If                        
19867  |                                                  ||19441  |                                                  
19868  |                    'EOF判定処理                  ||19442  |                    'EOF判定処理                  
19869  |                    dlngCnt = 0                   ||19443  |                    dlngCnt = 0                   
19870  |                                                  ||19444  |                                                  
19871  |                    Do Until gblnDyEOF()          ||19445  |                    Do Until gblnDyEOF()          
19872  |                        dlngCnt = dlngCnt + 1     ||19446  |                        dlngCnt = dlngCnt + 1     
19873  |                        '抽出データセット         ||19447  |                        '抽出データセット         
19874  |                        dstrCaldate(dlngCnt) = gvl||19448  |                        dstrCaldate(dlngCnt) = gvl
19875  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||19449  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
19876  |                        Call gDyNext              ||19450  |                        Call gDyNext              
19877  |                    Loop                          ||19451  |                    Loop                          
19878  |                                                  ||19452  |                                                  
19879  |                    '2005/08/26　START            ||19453  |                    '2005/08/26　START            
19880  |                    '変数sStartに格納されている日 ||19454  |                    '変数sStartに格納されている日 
19881  |                    '変数sStartの直近の営業日の日 ||19455  |                    '変数sStartの直近の営業日の日 
19882  |                    '（変数sStartに格納されている ||19456  |                    '（変数sStartに格納されている 
19883  |                    '　直近日付が存在しない場合は ||19457  |                    '　直近日付が存在しない場合は 
19884  |                                                  ||19458  |                                                  
19885  |                    '== SQL6 ==                   ||19459  |                    '== SQL6 ==                   
19886  |                    sSql = ""                     ||19460  |                    sSql = ""                     
19887  |                    sSql = sSql & "SELECT MAX(BASE||19461  |                    sSql = sSql & "SELECT MAX(BASE
19888  |                    sSql = sSql & "FROM   CFR_DAIL||19462  |                    sSql = sSql & "FROM   CFR_DAIL
19889  |                    sSql = sSql & "WHERE  BASE_DAT||19463  |                    sSql = sSql & "WHERE  BASE_DAT
19890  |                    sSql = sSql & "AND    ACCOUNT_||19464  |                    sSql = sSql & "AND    ACCOUNT_
19891  |                                                  ||19465  |                                                  
19892  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||19466  |                    'ﾀﾞｲﾅｾｯﾄの作成                
19893  |                    If gintDyCreate(sSql) = False ||19467  |                    If gintDyCreate(sSql) = False 
19894  |                        Exit Function             ||19468  |                        Exit Function             
19895  |                    End If                        ||19469  |                    End If                        
19896  |                                                  ||19470  |                                                  
19897  |                    Do Until gblnDyEOF()          ||19471  |                    Do Until gblnDyEOF()          
19898  |                       '抽出データセット          ||19472  |                       '抽出データセット          
19899  |                        sStart = gvlnDyDataS("BASE||19473  |                        sStart = gvlnDyDataS("BASE
19900  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||19474  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
19901  |                        Call gDyNext              ||19475  |                        Call gDyNext              
19902  |                    Loop                          ||19476  |                    Loop                          
19903  |                                                  ||19477  |                                                  
19904  |                    '2005/08/26　END              ||19478  |                    '2005/08/26　END              
19905  |                    'RAFI対応 START               ||19479  |                    'RAFI対応 START               
19906  |                    '純資産の場合                 ||19480  |                    '純資産の場合                 
19907  |                    If msAssetFlg = "0" Then      ||19481  |                    If msAssetFlg = "0" Then      
19908  |                        '計算開始日から計算終了日 ||19482  |                        '計算開始日から計算終了日 
19909  |                        '== SQL7 ==               ||19483  |                        '== SQL7 ==               
19910  |                        sSql = ""                 ||19484  |                        sSql = ""                 
19911  |                        sSql = sSql & "SELECT ACCO||19485  |                        sSql = sSql & "SELECT ACCO
19912  |                        sSql = sSql & "WHERE CFR_D||19486  |                        sSql = sSql & "WHERE CFR_D
19913  |                        sSql = sSql & "AND   (CFR_||19487  |                        sSql = sSql & "AND   (CFR_
19914  |                        sSql = sSql & "ORDER BY CF||19488  |                        sSql = sSql & "ORDER BY CF
19915  |                    'マザー組入資産の場合         ||19489  |                    'マザー組入資産の場合         
19916  |                    Else                          ||19490  |                    Else                          
19917  |                        '計算開始日から計算終了日 ||19491  |                        '計算開始日から計算終了日 
19918  |                        '== SQL8 ==               ||19492  |                        '== SQL8 ==               
19919  |                        sSql = ""                 ||19493  |                        sSql = ""                 
19920  |                        sSql = sSql & "SELECT"    ||19494  |                        sSql = sSql & "SELECT"    
19921  |                        sSql = sSql & "    a.ACCOU||19495  |                        sSql = sSql & "    a.ACCOU
19922  |                        sSql = sSql & "    a.BASE_||19496  |                        sSql = sSql & "    a.BASE_
19923  |                        sSql = sSql & "    a.MARKE||19497  |                        sSql = sSql & "    a.MARKE
19924  |                        sSql = sSql & "    b.BABY_||19498  |                        sSql = sSql & "    b.BABY_
19925  |                        sSql = sSql & "    b.BABY_||19499  |                        sSql = sSql & "    b.BABY_
19926  |                        sSql = sSql & " FROM"     ||19500  |                        sSql = sSql & " FROM"     
19927  |                        sSql = sSql & "    CFR_DAI||19501  |                        sSql = sSql & "    CFR_DAI
19928  |                        sSql = sSql & " WHERE"    ||19502  |                        sSql = sSql & " WHERE"    
19929  |                        sSql = sSql & "    b.BABY_||19503  |                        sSql = sSql & "    b.BABY_
19930  |                        sSql = sSql & "    b.MOTHE||19504  |                        sSql = sSql & "    b.MOTHE
19931  |                        sSql = sSql & "    b.BASE_||19505  |                        sSql = sSql & "    b.BASE_
19932  |                        sSql = sSql & "    a.ACCOU||19506  |                        sSql = sSql & "    a.ACCOU
19933  |                        sSql = sSql & "    (a.BASE||19507  |                        sSql = sSql & "    (a.BASE
19934  |                        sSql = sSql & "    a.BASE_||19508  |                        sSql = sSql & "    a.BASE_
19935  |                        sSql = sSql & " ORDER BY" ||19509  |                        sSql = sSql & " ORDER BY" 
19936  |                        sSql = sSql & "    a.BASE_||19510  |                        sSql = sSql & "    a.BASE_
19937  |                    End If                        ||19511  |                    End If                        
19938  |                    'RAFI対応 END                 ||19512  |                    'RAFI対応 END                 
19939  |                                                  ||19513  |                                                  
19940  |                    If gintDyCreate(sSql) = False ||19514  |                    If gintDyCreate(sSql) = False 
19941  |                        Exit Function             ||19515  |                        Exit Function             
19942  |                    End If                        ||19516  |                    End If                        
19943  |                                                  ||19517  |                                                  
19944  |                    dlngCntsv = dlngCnt           ||19518  |                    dlngCntsv = dlngCnt           
19945  |                    dlngCnt = 0                   ||19519  |                    dlngCnt = 0                   
19946  |                                                  ||19520  |                                                  
19947  |                    Do Until gblnDyEOF()          ||19521  |                    Do Until gblnDyEOF()          
19948  |                        dlngCnt = dlngCnt + 1     ||19522  |                        dlngCnt = dlngCnt + 1     
19949  |                        '抽出データセット         ||19523  |                        '抽出データセット         
19950  |                        dstrBasedate = gvlnDyDataS||19524  |                        dstrBasedate = gvlnDyDataS
19951  |                        If Mid(dstrCaldate(dlngCnt||19525  |                        If Mid(dstrCaldate(dlngCnt
19952  |                            'RAFI対応 START       ||19526  |                            'RAFI対応 START       
19953  |                            '純資産の場合         ||19527  |                            '純資産の場合         
19954  |                            If msAssetFlg = "0" Th||19528  |                            If msAssetFlg = "0" Th
19955  |                                ddblDailynav(dlngC||19529  |                                ddblDailynav(dlngC
19956  |                            'マザー組入資産の場合 ||19530  |                            'マザー組入資産の場合 
19957  |                            Else                  ||19531  |                            Else                  
19958  |                                ddblDailynav(dlngC||19532  |                                ddblDailynav(dlngC
19959  |                            End If                ||19533  |                            End If                
19960  |                            'RAFI対応 END         ||19534  |                            'RAFI対応 END         
19961  |                        Else                      ||19535  |                        Else                      
19962  |                            '計算開始日が外部委託 ||19536  |                            '計算開始日が外部委託 
19963  |                            If ddblNearNav <> 0 _ ||19537  |                            If ddblNearNav <> 0 _ 
19964  |                            And dlngCnt = 1 Then  ||19538  |                            And dlngCnt = 1 Then  
19965  |                                dstrCaldate2 = Mid||19539  |                                dstrCaldate2 = Mid
19966  |                                dstrBasedate2 = Mi||19540  |                                dstrBasedate2 = Mi
19967  |                                dlngDiffdate = Dat||19541  |                                dlngDiffdate = Dat
19968  |                                                  ||19542  |                                                  
19969  |                                For dintFor2 = 1 T||19543  |                                For dintFor2 = 1 T
19970  |                                    'RAFI対応 STAR||19544  |                                    'RAFI対応 STAR
19971  |                                    '純資産の場合 ||19545  |                                    '純資産の場合 
19972  |                                    If msAssetFlg ||19546  |                                    If msAssetFlg 
19973  |                                        ddblDailyn||19547  |                                        ddblDailyn
19974  |                                    'マザー組入資 ||19548  |                                    'マザー組入資 
19975  |                                    Else          ||19549  |                                    Else          
19976  |                                        ddblDailyn||19550  |                                        ddblDailyn
19977  |                                    End If        ||19551  |                                    End If        
19978  |                                    'RAFI対応 END ||19552  |                                    'RAFI対応 END 
19979  |                                    dlngCnt = dlng||19553  |                                    dlngCnt = dlng
19980  |                                Next dintFor2     ||19554  |                                Next dintFor2     
19981  |                                '純資産の場合     ||19555  |                                '純資産の場合     
19982  |                                If msAssetFlg = "0||19556  |                                If msAssetFlg = "0
19983  |                                    ddblDailynav(d||19557  |                                    ddblDailynav(d
19984  |                                'マザー組入資産の ||19558  |                                'マザー組入資産の 
19985  |                                Else              ||19559  |                                Else              
19986  |                                    ddblDailynav(d||19560  |                                    ddblDailynav(d
19987  |                                End If            ||19561  |                                End If            
19988  |                                'RAFI対応 END     ||19562  |                                'RAFI対応 END     
19989  |                            Else                  ||19563  |                            Else                  
19990  |                                '日次時価総額にデ ||19564  |                                '日次時価総額にデ 
19991  |                                dstrCaldate2 = Mid||19565  |                                dstrCaldate2 = Mid
19992  |                                dstrBasedate2 = Mi||19566  |                                dstrBasedate2 = Mi
19993  |                                dlngDiffdate = Dat||19567  |                                dlngDiffdate = Dat
19994  |                                                  ||19568  |                                                  
19995  |                                For dintFor2 = 1 T||19569  |                                For dintFor2 = 1 T
19996  |                                    If ddblDailyna||19570  |                                    If ddblDailyna
19997  |                                        ddblDailyn||19571  |                                        ddblDailyn
19998  |                                    Else          ||19572  |                                    Else          
19999  |                                        '日次時価 ||19573  |                                        '日次時価 
20000  |                                        intRtn = M||19574  |                                        intRtn = M
20001  |                                        vbLf & "対||19575  |                                        vbLf & "対
20002  |                                        vbLf & "基||19576  |                                        vbLf & "基
20003  |                                            vbCrit||19577  |                                            vbCrit
20004  |                                        Exit Funct||19578  |                                        Exit Funct
20005  |                                    End If        ||19579  |                                    End If        
20006  |                                    dlngCnt = dlng||19580  |                                    dlngCnt = dlng
20007  |                                Next dintFor2     ||19581  |                                Next dintFor2     
20008  |                                'RAFI対応 START   ||19582  |                                'RAFI対応 START   
20009  |                                '純資産の場合     ||19583  |                                '純資産の場合     
20010  |                                If msAssetFlg = "0||19584  |                                If msAssetFlg = "0
20011  |                                    ddblDailynav(d||19585  |                                    ddblDailynav(d
20012  |                                'マザー組入資産の ||19586  |                                'マザー組入資産の 
20013  |                                Else              ||19587  |                                Else              
20014  |                                    ddblDailynav(d||19588  |                                    ddblDailynav(d
20015  |                                End If            ||19589  |                                End If            
20016  |                                'RAFI対応 END     ||19590  |                                'RAFI対応 END     
20017  |                            End If                ||19591  |                            End If                
20018  |                                                  ||19592  |                                                  
20019  |                        End If                    ||19593  |                        End If                    
20020  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||19594  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
20021  |                        Call gDyNext              ||19595  |                        Call gDyNext              
20022  |                    Loop                          ||19596  |                    Loop                          
20023  |                                                  ||19597  |                                                  
20024  |                Next dintFor                      ||19598  |                Next dintFor                      
20025  |                                                  ||19599  |                                                  
20026  |                If dlngCntsv <> dlngCnt Then      ||19600  |                If dlngCntsv <> dlngCnt Then      
20027  |                    For dintFor2 = dlngCnt + 1 To ||19601  |                    For dintFor2 = dlngCnt + 1 To 
20028  |                        ddblDailynav(dintFor2) = d||19602  |                        ddblDailynav(dintFor2) = d
20029  |                    Next dintFor2                 ||19603  |                    Next dintFor2                 
20030  |                    dlngCnt = dlngCntsv           ||19604  |                    dlngCnt = dlngCntsv           
20031  |                End If                            ||19605  |                End If                            
20032  |                                                  ||19606  |                                                  
20033  |                ddblTtalnav = 0                   ||19607  |                ddblTtalnav = 0                   
20034  |                                                  ||19608  |                                                  
20035  |                For dintFor2 = 1 To dlngCnt       ||19609  |                For dintFor2 = 1 To dlngCnt       
20036  |                    ddblTtalnav = ddblTtalnav + dd||19610  |                    ddblTtalnav = ddblTtalnav + dd
20037  |                Next dintFor2                     ||19611  |                Next dintFor2                     
20038  |                                                  ||19612  |                                                  
20039  |                iRowCnt = dlngCnt                 ||19613  |                iRowCnt = dlngCnt                 
20040  |                TotalNav = ddblTtalnav            ||19614  |                TotalNav = ddblTtalnav            
20041  |                dblValueIn = TotalNav             ||19615  |                dblValueIn = TotalNav             
20042  |                Call sbGetRoundValue2(dblValueIn) ||19616  |                Call sbGetRoundValue2(dblValueIn) 
20043  |                TotalNav = dblValueOut            ||19617  |                TotalNav = dblValueOut            
20044  |                                                  ||19618  |                                                  
20045  |                '平均純資産総額                   ||19619  |                '平均純資産総額                   
20046  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||19620  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
20047  |                '取得NAV区分が4:日次時価総額平均の||19621  |                '取得NAV区分が4:日次時価総額平均の
20048  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||19622  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
20049  |                    .Cells(43, 2).Value = sWord70a||19623  |                    .Cells(43, 2).Value = sWord70a
20050  |                Else                              ||19624  |                Else                              
20051  |                    .Cells(43, 2).Value = sWord51a||19625  |                    .Cells(43, 2).Value = sWord51a
20052  |                End If                            ||19626  |                End If                            
20053  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||19627  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
20054  |                .Cells(43, 16).Value = sWord19    ||19628  |                .Cells(43, 16).Value = sWord19    
20055  |                                                  ||19629  |                                                  
20056  |                '計算期間の純資産総額の合計(月末純||19630  |                '計算期間の純資産総額の合計(月末純
20057  |                .Cells(43, 28).NumberFormatLocal =||19631  |                .Cells(43, 28).NumberFormatLocal =
20058  |                .Cells(43, 28).Value = CStr(Format||19632  |                .Cells(43, 28).Value = CStr(Format
20059  |                .Cells(43, 28).HorizontalAlignment||19633  |                .Cells(43, 28).HorizontalAlignment
20060  |                                                  ||19634  |                                                  
20061  |                '計算期間の純資産総額の合計÷計算 ||19635  |                '計算期間の純資産総額の合計÷計算 
20062  |                .Cells(43, 40).NumberFormatLocal =||19636  |                .Cells(43, 40).NumberFormatLocal =
20063  |                dblValueIn = TotalNav / iRowCnt   ||19637  |                dblValueIn = TotalNav / iRowCnt   
20064  |                Call sbGetRoundValue(dblValueIn)  ||19638  |                Call sbGetRoundValue(dblValueIn)  
20065  |                                                  ||19639  |                                                  
20066  |                .Cells(43, 40).Value = CStr(Format||19640  |                .Cells(43, 40).Value = CStr(Format
20067  |                AvgNav = dblValueOut              ||19641  |                AvgNav = dblValueOut              
20068  |                                                  ||19642  |                                                  
20069  |                '÷??＝                           ||19643  |                '÷??＝                           
20070  |                .Cells(43, 31).Value = sWord18 & "||19644  |                .Cells(43, 31).Value = sWord18 & "
20071  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||19645  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
20072  |                                                  ||19646  |                                                  
20073  |'取得NAV区分[1]以外(取得NAV区分='2')              ||19647  |'取得NAV区分[1]以外(取得NAV区分='2')              
20074  |            Else                                  ||19648  |            Else                                  
20075  |                ddblTtalnav = 0                   ||19649  |                ddblTtalnav = 0                   
20076  |                For dintFor = 0 To NavGetCnt - 1  ||19650  |                For dintFor = 0 To NavGetCnt - 1  
20077  |                                                  ||19651  |                                                  
20078  |                    '日次NAV平均取得              ||19652  |                    '日次NAV平均取得              
20079  |                    sStart = gstrDateFormat2(CStr(||19653  |                    sStart = gstrDateFormat2(CStr(
20080  |                    sEnd = gstrDateFormat2(CStr(dE||19654  |                    sEnd = gstrDateFormat2(CStr(dE
20081  |                                                  ||19655  |                                                  
20082  |                    '計算開始日と外部委託顧問料計 ||19656  |                    '計算開始日と外部委託顧問料計 
20083  |                    If sStart = gbuMGetUPDRec.N(lR||19657  |                    If sStart = gbuMGetUPDRec.N(lR
20084  |                        '== SQL1 ==               ||19658  |                        '== SQL1 ==               
20085  |                        sSql = ""                 ||19659  |                        sSql = ""                 
20086  |                        sSql = sSql & "SELECT EIGY||19660  |                        sSql = sSql & "SELECT EIGY
20087  |                                                  ||19661  |                                                  
20088  |                        'ﾀﾞｲﾅｾｯﾄの作成            ||19662  |                        'ﾀﾞｲﾅｾｯﾄの作成            
20089  |                        If gintDyCreate(sSql) = Fa||19663  |                        If gintDyCreate(sSql) = Fa
20090  |                            Exit Function         ||19664  |                            Exit Function         
20091  |                         Else                     ||19665  |                         Else                     
20092  |                            '休日の場合、翌営業日 ||19666  |                            '休日の場合、翌営業日 
20093  |                            If gvlnDyDataS("EIGYO_||19667  |                            If gvlnDyDataS("EIGYO_
20094  |                                '翌営業日のNAVを取||19668  |                                '翌営業日のNAVを取
20095  |                                '== SQL2 ==       ||19669  |                                '== SQL2 ==       
20096  |                                sSql = ""         ||19670  |                                sSql = ""         
20097  |                                sSql = sSql & "SEL||19671  |                                sSql = sSql & "SEL
20098  |                                sSql = sSql & "FRO||19672  |                                sSql = sSql & "FRO
20099  |                                sSql = sSql & "(SE||19673  |                                sSql = sSql & "(SE
20100  |                                sSql = sSql & "WHE||19674  |                                sSql = sSql & "WHE
20101  |                                                  ||19675  |                                                  
20102  |                                'ﾀﾞｲﾅｾｯﾄの作成    ||19676  |                                'ﾀﾞｲﾅｾｯﾄの作成    
20103  |                                If gintDyCreate(sS||19677  |                                If gintDyCreate(sS
20104  |                                    Exit Function ||19678  |                                    Exit Function 
20105  |                                Else              ||19679  |                                Else              
20106  |                                    ddblNearNav = ||19680  |                                    ddblNearNav = 
20107  |'2008/03/06 START 時価総額基準の外部委託顧問料対応||19681  |'2008/03/06 START 時価総額基準の外部委託顧問料対応
20108  |'                                    '翌営業日の計||19682  |'                                    '翌営業日の計
20109  |'                                    '== SQL3 ==  ||19683  |'                                    '== SQL3 ==  
20110  |'                                    sSql = ""    ||19684  |'                                    sSql = ""    
20111  |'                                    sSql = sSql &||19685  |'                                    sSql = sSql &
20112  |'                                    sSql = sSql &||19686  |'                                    sSql = sSql &
20113  |'                                    sSql = sSql &||19687  |'                                    sSql = sSql &
20114  |'                                    sSql = sSql &||19688  |'                                    sSql = sSql &
20115  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||19689  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
20116  |'                                    If gintDyCrea||19690  |'                                    If gintDyCrea
20117  |'                                        Exit Func||19691  |'                                        Exit Func
20118  |'                                     Else        ||19692  |'                                     Else        
20119  |'                                        '計算開始||19693  |'                                        '計算開始
20120  |'                                        sStart = ||19694  |'                                        sStart = 
20121  |'                                        dStart = ||19695  |'                                        dStart = 
20122  |'                                        '文言の冗||19696  |'                                        '文言の冗
20123  |''                                        .Cells(1||19697  |''                                        .Cells(1
20124  |''                                            CStr||19698  |''                                            CStr
20125  |'                                        .Cells(16||19699  |'                                        .Cells(16
20126  |'                                            CStr(||19700  |'                                            CStr(
20127  |'                                        iCalcNum ||19701  |'                                        iCalcNum 
20128  |'                                    End If       ||19702  |'                                    End If       
20129  |'2008/03/06 END   時価総額基準の外部委託顧問料対応||19703  |'2008/03/06 END   時価総額基準の外部委託顧問料対応
20130  |                                End If            ||19704  |                                End If            
20131  |                                'RAFI対応 START   ||19705  |                                'RAFI対応 START   
20132  |                                '翌営業日のマザー ||19706  |                                '翌営業日のマザー 
20133  |                                If msAssetFlg = "1||19707  |                                If msAssetFlg = "1
20134  |                                    '== SQL4 ==   ||19708  |                                    '== SQL4 ==   
20135  |                                    sSql = ""     ||19709  |                                    sSql = ""     
20136  |                                    sSql = sSql & ||19710  |                                    sSql = sSql & 
20137  |                                    sSql = sSql & ||19711  |                                    sSql = sSql & 
20138  |                                    sSql = sSql & ||19712  |                                    sSql = sSql & 
20139  |                                    sSql = sSql & ||19713  |                                    sSql = sSql & 
20140  |                                    sSql = sSql & ||19714  |                                    sSql = sSql & 
20141  |                                    sSql = sSql & ||19715  |                                    sSql = sSql & 
20142  |                                    sSql = sSql & ||19716  |                                    sSql = sSql & 
20143  |                                    sSql = sSql & ||19717  |                                    sSql = sSql & 
20144  |                                    sSql = sSql & ||19718  |                                    sSql = sSql & 
20145  |                                    sSql = sSql & ||19719  |                                    sSql = sSql & 
20146  |                                    sSql = sSql & ||19720  |                                    sSql = sSql & 
20147  |                                    sSql = sSql & ||19721  |                                    sSql = sSql & 
20148  |                                    sSql = sSql & ||19722  |                                    sSql = sSql & 
20149  |                                    sSql = sSql & ||19723  |                                    sSql = sSql & 
20150  |                                    sSql = sSql & ||19724  |                                    sSql = sSql & 
20151  |                                    sSql = sSql & ||19725  |                                    sSql = sSql & 
20152  |                                    sSql = sSql & ||19726  |                                    sSql = sSql & 
20153  |                                    sSql = sSql & ||19727  |                                    sSql = sSql & 
20154  |                                    sSql = sSql & ||19728  |                                    sSql = sSql & 
20155  |                                    sSql = sSql & ||19729  |                                    sSql = sSql & 
20156  |                                    sSql = sSql & ||19730  |                                    sSql = sSql & 
20157  |                                    sSql = sSql & ||19731  |                                    sSql = sSql & 
20158  |                                    sSql = sSql & ||19732  |                                    sSql = sSql & 
20159  |                                    sSql = sSql & ||19733  |                                    sSql = sSql & 
20160  |                                    'ﾀﾞｲﾅｾｯﾄの作成||19734  |                                    'ﾀﾞｲﾅｾｯﾄの作成
20161  |                                                  ||19735  |                                                  
20162  |                                    If gintDyCreat||19736  |                                    If gintDyCreat
20163  |                                        Exit Funct||19737  |                                        Exit Funct
20164  |                                    Else          ||19738  |                                    Else          
20165  |                                        ddblNearBa||19739  |                                        ddblNearBa
20166  |                                    End If        ||19740  |                                    End If        
20167  |                                End If            ||19741  |                                End If            
20168  |                                'RAFI対応 END     ||19742  |                                'RAFI対応 END     
20169  |                            End If                ||19743  |                            End If                
20170  |                        End If                    ||19744  |                        End If                    
20171  |                    End If                        ||19745  |                    End If                        
20172  |                    '== SQL5 ==                   ||19746  |                    '== SQL5 ==                   
20173  |                    sSql = ""                     ||19747  |                    sSql = ""                     
20174  |                    sSql = sSql & "SELECT CAL_YYYY||19748  |                    sSql = sSql & "SELECT CAL_YYYY
20175  |                    sSql = sSql & "WHERE CAL_YYYY ||19749  |                    sSql = sSql & "WHERE CAL_YYYY 
20176  |                                                  ||19750  |                                                  
20177  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||19751  |                    'ﾀﾞｲﾅｾｯﾄの作成                
20178  |                    If gintDyCreate(sSql) = False ||19752  |                    If gintDyCreate(sSql) = False 
20179  |                        Exit Function             ||19753  |                        Exit Function             
20180  |                    End If                        ||19754  |                    End If                        
20181  |                                                  ||19755  |                                                  
20182  |                    If dlngCnt = 0 Then           ||19756  |                    If dlngCnt = 0 Then           
20183  |                        ReDim dstrCaldate(gbxOraDy||19757  |                        ReDim dstrCaldate(gbxOraDy
20184  |                        ReDim ddblDailynav(gbxOraD||19758  |                        ReDim ddblDailynav(gbxOraD
20185  |                    End If                        ||19759  |                    End If                        
20186  |                                                  ||19760  |                                                  
20187  |                    'EOF判定処理                  ||19761  |                    'EOF判定処理                  
20188  |                    dlngCnt = 0                   ||19762  |                    dlngCnt = 0                   
20189  |                                                  ||19763  |                                                  
20190  |                    Do Until gblnDyEOF()          ||19764  |                    Do Until gblnDyEOF()          
20191  |                        dlngCnt = dlngCnt + 1     ||19765  |                        dlngCnt = dlngCnt + 1     
20192  |                        '抽出データセット         ||19766  |                        '抽出データセット         
20193  |                        dstrCaldate(dlngCnt) = gvl||19767  |                        dstrCaldate(dlngCnt) = gvl
20194  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||19768  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
20195  |                        Call gDyNext              ||19769  |                        Call gDyNext              
20196  |                    Loop                          ||19770  |                    Loop                          
20197  |                                                  ||19771  |                                                  
20198  |                    '2005/08/26　START            ||19772  |                    '2005/08/26　START            
20199  |                    '変数sStartに格納されている日 ||19773  |                    '変数sStartに格納されている日 
20200  |                    '変数sStartの直近の営業日の日 ||19774  |                    '変数sStartの直近の営業日の日 
20201  |                    '（変数sStartに格納されている ||19775  |                    '（変数sStartに格納されている 
20202  |                    '　直近日付が存在しない場合は ||19776  |                    '　直近日付が存在しない場合は 
20203  |                                                  ||19777  |                                                  
20204  |                    '== SQL6 ==                   ||19778  |                    '== SQL6 ==                   
20205  |                    sSql = ""                     ||19779  |                    sSql = ""                     
20206  |                    sSql = sSql & "SELECT MAX(BASE||19780  |                    sSql = sSql & "SELECT MAX(BASE
20207  |                    sSql = sSql & "FROM   CFR_DAIL||19781  |                    sSql = sSql & "FROM   CFR_DAIL
20208  |                    sSql = sSql & "WHERE  BASE_DAT||19782  |                    sSql = sSql & "WHERE  BASE_DAT
20209  |                    sSql = sSql & "AND    ACCOUNT_||19783  |                    sSql = sSql & "AND    ACCOUNT_
20210  |                                                  ||19784  |                                                  
20211  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||19785  |                    'ﾀﾞｲﾅｾｯﾄの作成                
20212  |                    If gintDyCreate(sSql) = False ||19786  |                    If gintDyCreate(sSql) = False 
20213  |                        Exit Function             ||19787  |                        Exit Function             
20214  |                    End If                        ||19788  |                    End If                        
20215  |                                                  ||19789  |                                                  
20216  |                    Do Until gblnDyEOF()          ||19790  |                    Do Until gblnDyEOF()          
20217  |                       '抽出データセット          ||19791  |                       '抽出データセット          
20218  |                        sStart = gvlnDyDataS("BASE||19792  |                        sStart = gvlnDyDataS("BASE
20219  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||19793  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
20220  |                        Call gDyNext              ||19794  |                        Call gDyNext              
20221  |                    Loop                          ||19795  |                    Loop                          
20222  |                                                  ||19796  |                                                  
20223  |                    '2005/08/26　END              ||19797  |                    '2005/08/26　END              
20224  |                    'RAFI対応 START               ||19798  |                    'RAFI対応 START               
20225  |                    '純資産の場合                 ||19799  |                    '純資産の場合                 
20226  |                    If msAssetFlg = "0" Then      ||19800  |                    If msAssetFlg = "0" Then      
20227  |                        '計算開始日から計算終了日 ||19801  |                        '計算開始日から計算終了日 
20228  |                        '== SQL7 ==               ||19802  |                        '== SQL7 ==               
20229  |                        sSql = ""                 ||19803  |                        sSql = ""                 
20230  |                        sSql = sSql & "SELECT ACCO||19804  |                        sSql = sSql & "SELECT ACCO
20231  |                        sSql = sSql & "WHERE (((CF||19805  |                        sSql = sSql & "WHERE (((CF
20232  |                        sSql = sSql & "AND ((CFR_D||19806  |                        sSql = sSql & "AND ((CFR_D
20233  |                        sSql = sSql & "AND ((CFR_D||19807  |                        sSql = sSql & "AND ((CFR_D
20234  |                        sSql = sSql & "ORDER BY CF||19808  |                        sSql = sSql & "ORDER BY CF
20235  |                    'マザー組入資産の場合         ||19809  |                    'マザー組入資産の場合         
20236  |                    Else                          ||19810  |                    Else                          
20237  |                        '計算開始日から計算終了日 ||19811  |                        '計算開始日から計算終了日 
20238  |                        '== SQL8 ==               ||19812  |                        '== SQL8 ==               
20239  |                        sSql = ""                 ||19813  |                        sSql = ""                 
20240  |                        sSql = sSql & "SELECT"    ||19814  |                        sSql = sSql & "SELECT"    
20241  |                        sSql = sSql & "    a.ACCOU||19815  |                        sSql = sSql & "    a.ACCOU
20242  |                        sSql = sSql & "    a.BASE_||19816  |                        sSql = sSql & "    a.BASE_
20243  |                        sSql = sSql & "    a.NET_A||19817  |                        sSql = sSql & "    a.NET_A
20244  |                        sSql = sSql & "    b.BABY_||19818  |                        sSql = sSql & "    b.BABY_
20245  |                        sSql = sSql & "    b.BABY_||19819  |                        sSql = sSql & "    b.BABY_
20246  |                        sSql = sSql & " FROM"     ||19820  |                        sSql = sSql & " FROM"     
20247  |                        sSql = sSql & "    CFR_DAI||19821  |                        sSql = sSql & "    CFR_DAI
20248  |                        sSql = sSql & " WHERE"    ||19822  |                        sSql = sSql & " WHERE"    
20249  |                        sSql = sSql & "    b.BABY_||19823  |                        sSql = sSql & "    b.BABY_
20250  |                        sSql = sSql & "    b.MOTHE||19824  |                        sSql = sSql & "    b.MOTHE
20251  |                        sSql = sSql & "    b.BASE_||19825  |                        sSql = sSql & "    b.BASE_
20252  |                        sSql = sSql & "    a.ACCOU||19826  |                        sSql = sSql & "    a.ACCOU
20253  |                        sSql = sSql & "    (a.BASE||19827  |                        sSql = sSql & "    (a.BASE
20254  |                        sSql = sSql & "    a.BASE_||19828  |                        sSql = sSql & "    a.BASE_
20255  |                        sSql = sSql & "    a.CURRE||19829  |                        sSql = sSql & "    a.CURRE
20256  |                        sSql = sSql & "    a.ASSET||19830  |                        sSql = sSql & "    a.ASSET
20257  |                        sSql = sSql & " ORDER BY" ||19831  |                        sSql = sSql & " ORDER BY" 
20258  |                        sSql = sSql & "    a.BASE_||19832  |                        sSql = sSql & "    a.BASE_
20259  |                    End If                        ||19833  |                    End If                        
20260  |                    'RAFI対応 END                 ||19834  |                    'RAFI対応 END                 
20261  |                                                  ||19835  |                                                  
20262  |                    If gintDyCreate(sSql) = False ||19836  |                    If gintDyCreate(sSql) = False 
20263  |                        Exit Function             ||19837  |                        Exit Function             
20264  |                    End If                        ||19838  |                    End If                        
20265  |                                                  ||19839  |                                                  
20266  |                    dlngCntsv = dlngCnt           ||19840  |                    dlngCntsv = dlngCnt           
20267  |                    dlngCnt = 0                   ||19841  |                    dlngCnt = 0                   
20268  |                                                  ||19842  |                                                  
20269  |                    Do Until gblnDyEOF()          ||19843  |                    Do Until gblnDyEOF()          
20270  |                        dlngCnt = dlngCnt + 1     ||19844  |                        dlngCnt = dlngCnt + 1     
20271  |                        '抽出データセット         ||19845  |                        '抽出データセット         
20272  |                        dstrBasedate = gvlnDyDataS||19846  |                        dstrBasedate = gvlnDyDataS
20273  |                        If Mid(dstrCaldate(dlngCnt||19847  |                        If Mid(dstrCaldate(dlngCnt
20274  |                            'RAFI対応 START       ||19848  |                            'RAFI対応 START       
20275  |                            '純資産の場合         ||19849  |                            '純資産の場合         
20276  |                            If msAssetFlg = "0" Th||19850  |                            If msAssetFlg = "0" Th
20277  |                                ddblDailynav(dlngC||19851  |                                ddblDailynav(dlngC
20278  |                            'マザー組入資産の場合 ||19852  |                            'マザー組入資産の場合 
20279  |                            Else                  ||19853  |                            Else                  
20280  |                                ddblDailynav(dlngC||19854  |                                ddblDailynav(dlngC
20281  |                            End If                ||19855  |                            End If                
20282  |                            'RAFI対応 END         ||19856  |                            'RAFI対応 END         
20283  |                        Else                      ||19857  |                        Else                      
20284  |                            '計算開始日が外部委託 ||19858  |                            '計算開始日が外部委託 
20285  |                            If ddblNearNav <> 0 _ ||19859  |                            If ddblNearNav <> 0 _ 
20286  |                            And dlngCnt = 1 Then  ||19860  |                            And dlngCnt = 1 Then  
20287  |                                dstrCaldate2 = Mid||19861  |                                dstrCaldate2 = Mid
20288  |                                dstrBasedate2 = Mi||19862  |                                dstrBasedate2 = Mi
20289  |                                dlngDiffdate = Dat||19863  |                                dlngDiffdate = Dat
20290  |                                                  ||19864  |                                                  
20291  |                                For dintFor2 = 1 T||19865  |                                For dintFor2 = 1 T
20292  |                                    'RAFI対応 STAR||19866  |                                    'RAFI対応 STAR
20293  |                                    '純資産の場合 ||19867  |                                    '純資産の場合 
20294  |                                    If msAssetFlg ||19868  |                                    If msAssetFlg 
20295  |                                        ddblDailyn||19869  |                                        ddblDailyn
20296  |                                    'マザー組入資 ||19870  |                                    'マザー組入資 
20297  |                                    Else          ||19871  |                                    Else          
20298  |                                        ddblDailyn||19872  |                                        ddblDailyn
20299  |                                    End If        ||19873  |                                    End If        
20300  |                                    'RAFI対応 END ||19874  |                                    'RAFI対応 END 
20301  |                                    dlngCnt = dlng||19875  |                                    dlngCnt = dlng
20302  |                                Next dintFor2     ||19876  |                                Next dintFor2     
20303  |                                '純資産の場合     ||19877  |                                '純資産の場合     
20304  |                                If msAssetFlg = "0||19878  |                                If msAssetFlg = "0
20305  |                                    ddblDailynav(d||19879  |                                    ddblDailynav(d
20306  |                                'マザー組入資産の ||19880  |                                'マザー組入資産の 
20307  |                                Else              ||19881  |                                Else              
20308  |                                    ddblDailynav(d||19882  |                                    ddblDailynav(d
20309  |                                End If            ||19883  |                                End If            
20310  |                                'RAFI対応 END     ||19884  |                                'RAFI対応 END     
20311  |                            Else                  ||19885  |                            Else                  
20312  |                                '日次NAVにデータが||19886  |                                '日次NAVにデータが
20313  |                                dstrCaldate2 = Mid||19887  |                                dstrCaldate2 = Mid
20314  |                                dstrBasedate2 = Mi||19888  |                                dstrBasedate2 = Mi
20315  |                                dlngDiffdate = Dat||19889  |                                dlngDiffdate = Dat
20316  |                                                  ||19890  |                                                  
20317  |                                For dintFor2 = 1 T||19891  |                                For dintFor2 = 1 T
20318  |                                    If ddblDailyna||19892  |                                    If ddblDailyna
20319  |                                        ddblDailyn||19893  |                                        ddblDailyn
20320  |                                    Else          ||19894  |                                    Else          
20321  |                                        '日次NAVに||19895  |                                        '日次NAVに
20322  |                                        intRtn = M||19896  |                                        intRtn = M
20323  |                                        vbLf & "対||19897  |                                        vbLf & "対
20324  |                                        vbLf & "基||19898  |                                        vbLf & "基
20325  |                                            vbCrit||19899  |                                            vbCrit
20326  |                                        Exit Funct||19900  |                                        Exit Funct
20327  |                                    End If        ||19901  |                                    End If        
20328  |                                    dlngCnt = dlng||19902  |                                    dlngCnt = dlng
20329  |                                Next dintFor2     ||19903  |                                Next dintFor2     
20330  |                                'RAFI対応 START   ||19904  |                                'RAFI対応 START   
20331  |                                '純資産の場合     ||19905  |                                '純資産の場合     
20332  |                                If msAssetFlg = "0||19906  |                                If msAssetFlg = "0
20333  |                                    ddblDailynav(d||19907  |                                    ddblDailynav(d
20334  |                                'マザー組入資産の ||19908  |                                'マザー組入資産の 
20335  |                                Else              ||19909  |                                Else              
20336  |                                    ddblDailynav(d||19910  |                                    ddblDailynav(d
20337  |                                End If            ||19911  |                                End If            
20338  |                                'RAFI対応 END     ||19912  |                                'RAFI対応 END     
20339  |                            End If                ||19913  |                            End If                
20340  |                                                  ||19914  |                                                  
20341  |                        End If                    ||19915  |                        End If                    
20342  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||19916  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
20343  |                        Call gDyNext              ||19917  |                        Call gDyNext              
20344  |                    Loop                          ||19918  |                    Loop                          
20345  |                                                  ||19919  |                                                  
20346  |                Next dintFor                      ||19920  |                Next dintFor                      
20347  |                                                  ||19921  |                                                  
20348  |                If dlngCntsv <> dlngCnt Then      ||19922  |                If dlngCntsv <> dlngCnt Then      
20349  |                    For dintFor2 = dlngCnt + 1 To ||19923  |                    For dintFor2 = dlngCnt + 1 To 
20350  |                        ddblDailynav(dintFor2) = d||19924  |                        ddblDailynav(dintFor2) = d
20351  |                    Next dintFor2                 ||19925  |                    Next dintFor2                 
20352  |                    dlngCnt = dlngCntsv           ||19926  |                    dlngCnt = dlngCntsv           
20353  |                End If                            ||19927  |                End If                            
20354  |                                                  ||19928  |                                                  
20355  |                ddblTtalnav = 0                   ||19929  |                ddblTtalnav = 0                   
20356  |                                                  ||19930  |                                                  
20357  |                For dintFor2 = 1 To dlngCnt       ||19931  |                For dintFor2 = 1 To dlngCnt       
20358  |                    ddblTtalnav = ddblTtalnav + dd||19932  |                    ddblTtalnav = ddblTtalnav + dd
20359  |                Next dintFor2                     ||19933  |                Next dintFor2                     
20360  |                                                  ||19934  |                                                  
20361  |                iRowCnt = dlngCnt                 ||19935  |                iRowCnt = dlngCnt                 
20362  |                TotalNav = ddblTtalnav            ||19936  |                TotalNav = ddblTtalnav            
20363  |                dblValueIn = TotalNav             ||19937  |                dblValueIn = TotalNav             
20364  |                Call sbGetRoundValue2(dblValueIn) ||19938  |                Call sbGetRoundValue2(dblValueIn) 
20365  |                TotalNav = dblValueOut            ||19939  |                TotalNav = dblValueOut            
20366  |                                                  ||19940  |                                                  
20367  |                '平均純資産総額                   ||19941  |                '平均純資産総額                   
20368  |                .Cells(43, 2).Value = sWord51a    ||19942  |                .Cells(43, 2).Value = sWord51a    
20369  |                .Cells(43, 16).Value = sWord19    ||19943  |                .Cells(43, 16).Value = sWord19    
20370  |                                                  ||19944  |                                                  
20371  |                '計算期間の純資産総額の合計(月末純||19945  |                '計算期間の純資産総額の合計(月末純
20372  |                .Cells(43, 28).NumberFormatLocal =||19946  |                .Cells(43, 28).NumberFormatLocal =
20373  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||19947  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
20374  |                    .Cells(43, 28).Value = CStr(Fo||19948  |                    .Cells(43, 28).Value = CStr(Fo
20375  |                Else                              ||19949  |                Else                              
20376  |                    .Cells(43, 28).Value = CStr(Fo||19950  |                    .Cells(43, 28).Value = CStr(Fo
20377  |                End If                            ||19951  |                End If                            
20378  |                .Cells(43, 28).HorizontalAlignment||19952  |                .Cells(43, 28).HorizontalAlignment
20379  |                                                  ||19953  |                                                  
20380  |                '計算期間の純資産総額の合計÷計算 ||19954  |                '計算期間の純資産総額の合計÷計算 
20381  |                .Cells(43, 40).NumberFormatLocal =||19955  |                .Cells(43, 40).NumberFormatLocal =
20382  |                dblValueIn = TotalNav / iRowCnt   ||19956  |                dblValueIn = TotalNav / iRowCnt   
20383  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||19957  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
20384  |                    Call sbGetRoundValue2(dblValue||19958  |                    Call sbGetRoundValue2(dblValue
20385  |                Else                              ||19959  |                Else                              
20386  |                    Call sbGetRoundValue(dblValueI||19960  |                    Call sbGetRoundValue(dblValueI
20387  |                End If                            ||19961  |                End If                            
20388  |                                                  ||19962  |                                                  
20389  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||19963  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
20390  |                    .Cells(43, 40).Value = CStr(Fo||19964  |                    .Cells(43, 40).Value = CStr(Fo
20391  |                Else                              ||19965  |                Else                              
20392  |                    .Cells(43, 40).Value = CStr(Fo||19966  |                    .Cells(43, 40).Value = CStr(Fo
20393  |                End If                            ||19967  |                End If                            
20394  |                AvgNav = dblValueOut              ||19968  |                AvgNav = dblValueOut              
20395  |                                                  ||19969  |                                                  
20396  |                '÷??＝                           ||19970  |                '÷??＝                           
20397  |                .Cells(43, 31).Value = sWord18 & "||19971  |                .Cells(43, 31).Value = sWord18 & "
20398  |            End If                                ||19972  |            End If                                
20399  |'契約区分：名称使用許諾料計算　かつ　日次NAV(休日 ||19973  |'契約区分：名称使用許諾料計算　かつ　日次NAV(休日 
20400  |        Else                                      ||19974  |        Else                                      
20401  |On Error GoTo OnErrorProc                         ||19975  |On Error GoTo OnErrorProc                         
20402  |                                                  ||19976  |                                                  
20403  |            '契約区分「3」の場合                  ||19977  |            '契約区分「3」の場合                  
20404  |            ddblTtalnav = 0                       ||19978  |            ddblTtalnav = 0                       
20405  |            For dintFor = 0 To NavGetCnt - 1      ||19979  |            For dintFor = 0 To NavGetCnt - 1      
20406  |                                                  ||19980  |                                                  
20407  |                '日次NAV平均取得                  ||19981  |                '日次NAV平均取得                  
20408  |                sStart = gstrDateFormat2(CStr(dSta||19982  |                sStart = gstrDateFormat2(CStr(dSta
20409  |                sEnd = gstrDateFormat2(CStr(dEnd),||19983  |                sEnd = gstrDateFormat2(CStr(dEnd),
20410  |                                                  ||19984  |                                                  
20411  |                'RAFI対応 START                   ||19985  |                'RAFI対応 START                   
20412  |                '純資産の場合                     ||19986  |                '純資産の場合                     
20413  |                If msAssetFlg = "0" Then          ||19987  |                If msAssetFlg = "0" Then          
20414  |                    '計算開始日から計算終了日まで ||19988  |                    '計算開始日から計算終了日まで 
20415  |                    sSql = ""                     ||19989  |                    sSql = ""                     
20416  |                    sSql = sSql & "SELECT ACCOUNT_||19990  |                    sSql = sSql & "SELECT ACCOUNT_
20417  |                    sSql = sSql & "WHERE (((CFR_DA||19991  |                    sSql = sSql & "WHERE (((CFR_DA
20418  |                    sSql = sSql & "AND ((CFR_DAILY||19992  |                    sSql = sSql & "AND ((CFR_DAILY
20419  |                    sSql = sSql & "AND ((CFR_DAILY||19993  |                    sSql = sSql & "AND ((CFR_DAILY
20420  |                    sSql = sSql & "ORDER BY CFR_DA||19994  |                    sSql = sSql & "ORDER BY CFR_DA
20421  |                'マザー組入資産の場合             ||19995  |                'マザー組入資産の場合             
20422  |                Else                              ||19996  |                Else                              
20423  |                    '計算開始日から計算終了日まで ||19997  |                    '計算開始日から計算終了日まで 
20424  |                    sSql = ""                     ||19998  |                    sSql = ""                     
20425  |                    sSql = sSql & "SELECT"        ||19999  |                    sSql = sSql & "SELECT"        
20426  |                    sSql = sSql & "    a.ACCOUNT_C||20000  |                    sSql = sSql & "    a.ACCOUNT_C
20427  |                    sSql = sSql & "    a.BASE_DATE||20001  |                    sSql = sSql & "    a.BASE_DATE
20428  |                    sSql = sSql & "    a.NET_ASSET||20002  |                    sSql = sSql & "    a.NET_ASSET
20429  |                    sSql = sSql & "    b.BABY_MOTH||20003  |                    sSql = sSql & "    b.BABY_MOTH
20430  |                    sSql = sSql & "    b.BABY_MOTH||20004  |                    sSql = sSql & "    b.BABY_MOTH
20431  |                    sSql = sSql & " FROM"         ||20005  |                    sSql = sSql & " FROM"         
20432  |                    sSql = sSql & "    CFR_DAILY_N||20006  |                    sSql = sSql & "    CFR_DAILY_N
20433  |                    sSql = sSql & " WHERE"        ||20007  |                    sSql = sSql & " WHERE"        
20434  |                    sSql = sSql & "    b.BABY_ACCO||20008  |                    sSql = sSql & "    b.BABY_ACCO
20435  |                    sSql = sSql & "    b.MOTHER_AC||20009  |                    sSql = sSql & "    b.MOTHER_AC
20436  |                    sSql = sSql & "    b.BASE_DATE||20010  |                    sSql = sSql & "    b.BASE_DATE
20437  |                    sSql = sSql & "    a.ACCOUNT_C||20011  |                    sSql = sSql & "    a.ACCOUNT_C
20438  |                    sSql = sSql & "    (a.BASE_DAT||20012  |                    sSql = sSql & "    (a.BASE_DAT
20439  |                    sSql = sSql & "    a.BASE_DATE||20013  |                    sSql = sSql & "    a.BASE_DATE
20440  |                    sSql = sSql & "    a.CURRENCY_||20014  |                    sSql = sSql & "    a.CURRENCY_
20441  |                    sSql = sSql & "    a.ASSET_TYP||20015  |                    sSql = sSql & "    a.ASSET_TYP
20442  |                    sSql = sSql & " ORDER BY"     ||20016  |                    sSql = sSql & " ORDER BY"     
20443  |                    sSql = sSql & "    a.BASE_DATE||20017  |                    sSql = sSql & "    a.BASE_DATE
20444  |                End If                            ||20018  |                End If                            
20445  |                'RAFI対応 END                     ||20019  |                'RAFI対応 END                     
20446  |                                                  ||20020  |                                                  
20447  |                If gintDyCreate(sSql) = False Then||20021  |                If gintDyCreate(sSql) = False Then
20448  |                    Exit Function                 ||20022  |                    Exit Function                 
20449  |                End If                            ||20023  |                End If                            
20450  |                                                  ||20024  |                                                  
20451  |                If dlngCnt = 0 Then               ||20025  |                If dlngCnt = 0 Then               
20452  |                    ReDim dstrCaldate(gbxOraDynase||20026  |                    ReDim dstrCaldate(gbxOraDynase
20453  |                    ReDim ddblDailynav(gbxOraDynas||20027  |                    ReDim ddblDailynav(gbxOraDynas
20454  |                End If                            ||20028  |                End If                            
20455  |                                                  ||20029  |                                                  
20456  |                dlngCnt = 0                       ||20030  |                dlngCnt = 0                       
20457  |                                                  ||20031  |                                                  
20458  |                Do Until gblnDyEOF()              ||20032  |                Do Until gblnDyEOF()              
20459  |                    dlngCnt = dlngCnt + 1         ||20033  |                    dlngCnt = dlngCnt + 1         
20460  |                    'RAFI対応 START               ||20034  |                    'RAFI対応 START               
20461  |                    '純資産の場合                 ||20035  |                    '純資産の場合                 
20462  |                    If msAssetFlg = "0" Then      ||20036  |                    If msAssetFlg = "0" Then      
20463  |                        '抽出データセット         ||20037  |                        '抽出データセット         
20464  |                        dstrCaldate(dlngCnt) = gvl||20038  |                        dstrCaldate(dlngCnt) = gvl
20465  |                        ddblDailynav(dlngCnt) = dd||20039  |                        ddblDailynav(dlngCnt) = dd
20466  |                    'マザー組入資産の場合         ||20040  |                    'マザー組入資産の場合         
20467  |                    Else                          ||20041  |                    Else                          
20468  |                        dstrCaldate(dlngCnt) = gvl||20042  |                        dstrCaldate(dlngCnt) = gvl
20469  |                        ddblDailynav(dlngCnt) = dd||20043  |                        ddblDailynav(dlngCnt) = dd
20470  |                    End If                        ||20044  |                    End If                        
20471  |                    'RAFI対応 END                 ||20045  |                    'RAFI対応 END                 
20472  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             ||20046  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             
20473  |                    Call gDyNext                  ||20047  |                    Call gDyNext                  
20474  |                Loop                              ||20048  |                Loop                              
20475  |                                                  ||20049  |                                                  
20476  |            Next dintFor                          ||20050  |            Next dintFor                          
20477  |                                                  ||20051  |                                                  
20478  |            ddblTtalnav = 0                       ||20052  |            ddblTtalnav = 0                       
20479  |                                                  ||20053  |                                                  
20480  |            For dintFor2 = 1 To dlngCnt           ||20054  |            For dintFor2 = 1 To dlngCnt           
20481  |                ddblTtalnav = ddblTtalnav + ddblDa||20055  |                ddblTtalnav = ddblTtalnav + ddblDa
20482  |            Next dintFor2                         ||20056  |            Next dintFor2                         
20483  |                                                  ||20057  |                                                  
20484  |            iRowCnt = dlngCnt                     ||20058  |            iRowCnt = dlngCnt                     
20485  |            dlngMeisyoSu = dlngCnt                ||20059  |            dlngMeisyoSu = dlngCnt                
20486  |                                                  ||20060  |                                                  
20487  |            TotalNav = ddblTtalnav                ||20061  |            TotalNav = ddblTtalnav                
20488  |            dblValueIn = TotalNav                 ||20062  |            dblValueIn = TotalNav                 
20489  |            Call sbGetRoundValue2(dblValueIn)     ||20063  |            Call sbGetRoundValue2(dblValueIn)     
20490  |            TotalNav = dblValueOut                ||20064  |            TotalNav = dblValueOut                
20491  |                                                  ||20065  |                                                  
20492  |            '計算期間の純資産総額の合計÷計算期間 ||20066  |            '計算期間の純資産総額の合計÷計算期間 
20493  |            dblValueIn = TotalNav / iRowCnt       ||20067  |            dblValueIn = TotalNav / iRowCnt       
20494  |            iCalcNum = iRowCnt                    ||20068  |            iCalcNum = iRowCnt                    
20495  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||20069  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
20496  |                  Call sbGetRoundValue2(dblValueIn||20070  |                  Call sbGetRoundValue2(dblValueIn
20497  |            Else                                  ||20071  |            Else                                  
20498  |                  Call sbGetRoundValue(dblValueIn)||20072  |                  Call sbGetRoundValue(dblValueIn)
20499  |            End If                                ||20073  |            End If                                
20500  |            dstrAvgNav = dblValueOut              ||20074  |            dstrAvgNav = dblValueOut              
20501  |            AvgNav = dstrAvgNav                   ||20075  |            AvgNav = dstrAvgNav                   
20502  |                                                  ||20076  |                                                  
20503  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||20077  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
20504  |            Call gblnDyClose                      ||20078  |            Call gblnDyClose                      
20505  |                                                  ||20079  |                                                  
20506  |            '平均純資産総額                       ||20080  |            '平均純資産総額                       
20507  |            .Cells(43, 2).Value = sWord51a        ||20081  |            .Cells(43, 2).Value = sWord51a        
20508  |            .Cells(43, 16).Value = sWord19        ||20082  |            .Cells(43, 16).Value = sWord19        
20509  |            '計算期間の純資産総額の合計(月末純資産||20083  |            '計算期間の純資産総額の合計(月末純資産
20510  |            .Cells(43, 28).NumberFormatLocal = "@"||20084  |            .Cells(43, 28).NumberFormatLocal = "@"
20511  |              If gbuMGetUPDRec.N(lRecIdx).MGET_bas||20085  |              If gbuMGetUPDRec.N(lRecIdx).MGET_bas
20512  |                  .Cells(43, 28).Value = CStr(Form||20086  |                  .Cells(43, 28).Value = CStr(Form
20513  |              Else                                ||20087  |              Else                                
20514  |                  .Cells(43, 28).Value = CStr(Form||20088  |                  .Cells(43, 28).Value = CStr(Form
20515  |              End If                              ||20089  |              End If                              
20516  |            .Cells(43, 28).HorizontalAlignment = x||20090  |            .Cells(43, 28).HorizontalAlignment = x
20517  |            '÷??＝                               ||20091  |            '÷??＝                               
20518  |            .Cells(43, 31).Value = sWord18 & "   "||20092  |            .Cells(43, 31).Value = sWord18 & "   "
20519  |            '計算期間の純資産総額の合計÷計算期間 ||20093  |            '計算期間の純資産総額の合計÷計算期間 
20520  |            .Cells(43, 40).NumberFormatLocal = "@"||20094  |            .Cells(43, 40).NumberFormatLocal = "@"
20521  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||20095  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
20522  |                .Cells(43, 40).Value = CStr(Format||20096  |                .Cells(43, 40).Value = CStr(Format
20523  |            Else                                  ||20097  |            Else                                  
20524  |                .Cells(43, 40).Value = CStr(Format||20098  |                .Cells(43, 40).Value = CStr(Format
20525  |            End If                                ||20099  |            End If                                
20526  |                                                  ||20100  |                                                  
20527  |            ddblExchangeRate = 0                  ||20101  |            ddblExchangeRate = 0                  
20528  |                                                  ||20102  |                                                  
20529  |            '投資顧問料計算用計算対象NAVに日次平均||20103  |            '投資顧問料計算用計算対象NAVに日次平均
20530  |            If dstrAvgNav = "" Then               ||20104  |            If dstrAvgNav = "" Then               
20531  |                lCalcNav = 0                      ||20105  |                lCalcNav = 0                      
20532  |            Else                                  ||20106  |            Else                                  
20533  |                                                  ||20107  |                                                  
20534  |                dblValueIn = CDbl(dstrAvgNav)     ||20108  |                dblValueIn = CDbl(dstrAvgNav)     
20535  |                                                  ||20109  |                                                  
20536  |                '@@@@@ NAV通貨から閾値通貨に換算 @||20110  |                '@@@@@ NAV通貨から閾値通貨に換算 @
20537  |                Select Case gbuMGetUPDRec.N(lRecId||20111  |                Select Case gbuMGetUPDRec.N(lRecId
20538  |                  Case "1"    '固定料率           ||20112  |                  Case "1"    '固定料率           
20539  |                    If gbuMGetUPDRec.N(lRecIdx).MG||20113  |                    If gbuMGetUPDRec.N(lRecIdx).MG
20540  |                        'NAV通貨→JPYの為替レート ||20114  |                        'NAV通貨→JPYの為替レート 
20541  |                        dstrCurrencyCode = gbuMGet||20115  |                        dstrCurrencyCode = gbuMGet
20542  |                        ddblExchangeRate = fnstrEx||20116  |                        ddblExchangeRate = fnstrEx
20543  |                        If ddblExchangeRate = 0 Th||20117  |                        If ddblExchangeRate = 0 Th
20544  |                          intRtn = MsgBox("ＴＴＭ ||20118  |                          intRtn = MsgBox("ＴＴＭ 
20545  |                          vbLf & "対象通貨コード  ||20119  |                          vbLf & "対象通貨コード  
20546  |                          vbLf & "基準日 ： [ " & ||20120  |                          vbLf & "基準日 ： [ " & 
20547  |                              vbCritical, "ＴＴＭ ||20121  |                              vbCritical, "ＴＴＭ 
20548  |                          Exit Function           ||20122  |                          Exit Function           
20549  |                        End If                    ||20123  |                        End If                    
20550  |                        'NAV通貨→JPYへレート換算 ||20124  |                        'NAV通貨→JPYへレート換算 
20551  |                        dblValueIn = dblValueIn * ||20125  |                        dblValueIn = dblValueIn * 
20552  |                    End If                        ||20126  |                    End If                        
20553  |                                                  ||20127  |                                                  
20554  |                  Case "2"    '段階料率           ||20128  |                  Case "2"    '段階料率           
20555  |                                                  ||20129  |                                                  
20556  |                    If gbuMGetUPDRec.N(lRecIdx).MG||20130  |                    If gbuMGetUPDRec.N(lRecIdx).MG
20557  |                        If gbuMGetUPDRec.N(lRecIdx||20131  |                        If gbuMGetUPDRec.N(lRecIdx
20558  |                        Else                      ||20132  |                        Else                      
20559  |                            '閾値通貨→JPYの為替レ||20133  |                            '閾値通貨→JPYの為替レ
20560  |                            dstrCurrencyCode = gbu||20134  |                            dstrCurrencyCode = gbu
20561  |                            ddblExchangeRate = fns||20135  |                            ddblExchangeRate = fns
20562  |                            If ddblExchangeRate = ||20136  |                            If ddblExchangeRate = 
20563  |                              intRtn = MsgBox("Ｔ ||20137  |                              intRtn = MsgBox("Ｔ 
20564  |                              vbLf & "対象通貨コー||20138  |                              vbLf & "対象通貨コー
20565  |                              vbLf & "基準日 ： [ ||20139  |                              vbLf & "基準日 ： [ 
20566  |                                  vbCritical, "Ｔ ||20140  |                                  vbCritical, "Ｔ 
20567  |                              Exit Function       ||20141  |                              Exit Function       
20568  |                            End If                ||20142  |                            End If                
20569  |                            'JPY→閾値通貨へレート||20143  |                            'JPY→閾値通貨へレート
20570  |                            dblValueIn = dblValueI||20144  |                            dblValueIn = dblValueI
20571  |                        End If                    ||20145  |                        End If                    
20572  |                    Else                          ||20146  |                    Else                          
20573  |                        'NAV通貨→JPYの為替レート ||20147  |                        'NAV通貨→JPYの為替レート 
20574  |                        dstrCurrencyCode = gbuMGet||20148  |                        dstrCurrencyCode = gbuMGet
20575  |                        ddblExchangeRate = fnstrEx||20149  |                        ddblExchangeRate = fnstrEx
20576  |                        If ddblExchangeRate = 0 Th||20150  |                        If ddblExchangeRate = 0 Th
20577  |                          intRtn = MsgBox("ＴＴＭ ||20151  |                          intRtn = MsgBox("ＴＴＭ 
20578  |                          vbLf & "対象通貨コード  ||20152  |                          vbLf & "対象通貨コード  
20579  |                          vbLf & "基準日 ： [ " & ||20153  |                          vbLf & "基準日 ： [ " & 
20580  |                              vbCritical, "ＴＴＭ ||20154  |                              vbCritical, "ＴＴＭ 
20581  |                          Exit Function           ||20155  |                          Exit Function           
20582  |                        End If                    ||20156  |                        End If                    
20583  |                        'NAV通貨→JPYへレート換算 ||20157  |                        'NAV通貨→JPYへレート換算 
20584  |                        dblValueIn = dblValueIn * ||20158  |                        dblValueIn = dblValueIn * 
20585  |                        If gbuMGetUPDRec.N(lRecIdx||20159  |                        If gbuMGetUPDRec.N(lRecIdx
20586  |                        Else                      ||20160  |                        Else                      
20587  |                            '閾値通貨→JPYの為替レ||20161  |                            '閾値通貨→JPYの為替レ
20588  |                            dstrCurrencyCode = gbu||20162  |                            dstrCurrencyCode = gbu
20589  |                            ddblExchangeRate = fns||20163  |                            ddblExchangeRate = fns
20590  |                            If ddblExchangeRate = ||20164  |                            If ddblExchangeRate = 
20591  |                              intRtn = MsgBox("Ｔ ||20165  |                              intRtn = MsgBox("Ｔ 
20592  |                              vbLf & "対象通貨コー||20166  |                              vbLf & "対象通貨コー
20593  |                              vbLf & "基準日 ： [ ||20167  |                              vbLf & "基準日 ： [ 
20594  |                                  vbCritical, "Ｔ ||20168  |                                  vbCritical, "Ｔ 
20595  |                              Exit Function       ||20169  |                              Exit Function       
20596  |                            End If                ||20170  |                            End If                
20597  |                            'JPY→閾値通貨へ逆レー||20171  |                            'JPY→閾値通貨へ逆レー
20598  |                            dblValueIn = dblValueI||20172  |                            dblValueIn = dblValueI
20599  |                        End If                    ||20173  |                        End If                    
20600  |                    End If                        ||20174  |                    End If                        
20601  |                                                  ||20175  |                                                  
20602  |                End Select                        ||20176  |                End Select                        
20603  |                '@@@@@ NAV通貨から閾値通貨に換算 @||20177  |                '@@@@@ NAV通貨から閾値通貨に換算 @
20604  |                Call sbGetRoundValue2(dblValueIn) ||20178  |                Call sbGetRoundValue2(dblValueIn) 
20605  |                                                  ||20179  |                                                  
20606  |'閾値レート換算後平均NAV(計算対象NAV)             ||20180  |'閾値レート換算後平均NAV(計算対象NAV)             
20607  |                lCalcNav = CStr(Format(dblValueOut||20181  |                lCalcNav = CStr(Format(dblValueOut
20608  |            End If                                ||20182  |            End If                                
20609  |                                                  ||20183  |                                                  
20610  |On Error Resume Next                              ||20184  |On Error Resume Next                              
20611  |        End If                                    ||20185  |        End If                                    
20612  |                                                  ||20186  |                                                  
20613  |        '投資顧問料                               ||20187  |        '投資顧問料                               
20614  |        Dim dRitsu As Double    '外部委託顧問料率 ||20188  |        Dim dRitsu As Double    '外部委託顧問料率 
20615  |        dRitsu = 0                                ||20189  |        dRitsu = 0                                
20616  |        TotalRate = 0                             ||20190  |        TotalRate = 0                             
20617  |        ddblExchangeRate = 0                      ||20191  |        ddblExchangeRate = 0                      
20618  |        '計算対象NAVを変数にセット                ||20192  |        '計算対象NAVを変数にセット                
20619  |            lCalcNav = 0                          ||20193  |            lCalcNav = 0                          
20620  |            dblValueIn = TotalNav / iRowCnt       ||20194  |            dblValueIn = TotalNav / iRowCnt       
20621  |                                                  ||20195  |                                                  
20622  |            '@@@@@ NAV通貨から閾値通貨に換算 @@@@@||20196  |            '@@@@@ NAV通貨から閾値通貨に換算 @@@@@
20623  |            Select Case gbuMGetUPDRec.N(lRecIdx).M||20197  |            Select Case gbuMGetUPDRec.N(lRecIdx).M
20624  |              Case "1"    '固定料率(固定料率の場合||20198  |              Case "1"    '固定料率(固定料率の場合
20625  |                                                  ||20199  |                                                  
20626  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||20200  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
20627  |                    'NAV通貨→JPYの為替レートを取 ||20201  |                    'NAV通貨→JPYの為替レートを取 
20628  |                    dstrCurrencyCode = gbuMGetUPDR||20202  |                    dstrCurrencyCode = gbuMGetUPDR
20629  |                    ddblExchangeRate = fnstrExchan||20203  |                    ddblExchangeRate = fnstrExchan
20630  |                    If ddblExchangeRate = 0 Then  ||20204  |                    If ddblExchangeRate = 0 Then  
20631  |                      intRtn = MsgBox("ＴＴＭが取 ||20205  |                      intRtn = MsgBox("ＴＴＭが取 
20632  |                      vbLf & "対象通貨コード ： [ ||20206  |                      vbLf & "対象通貨コード ： [ 
20633  |                      vbLf & "基準日 ： [ " & Mid(||20207  |                      vbLf & "基準日 ： [ " & Mid(
20634  |                          vbCritical, "ＴＴＭ取得 ||20208  |                          vbCritical, "ＴＴＭ取得 
20635  |                      Exit Function               ||20209  |                      Exit Function               
20636  |                    End If                        ||20210  |                    End If                        
20637  |                    'NAV通貨→JPYへレート換算     ||20211  |                    'NAV通貨→JPYへレート換算     
20638  |                    dblValueIn = dblValueIn * ddbl||20212  |                    dblValueIn = dblValueIn * ddbl
20639  |                End If                            ||20213  |                End If                            
20640  |                                                  ||20214  |                                                  
20641  |              Case "2"    '段階料率               ||20215  |              Case "2"    '段階料率               
20642  |                                                  ||20216  |                                                  
20643  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||20217  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
20644  |                    If gbuMGetUPDRec.N(lRecIdx).MG||20218  |                    If gbuMGetUPDRec.N(lRecIdx).MG
20645  |                    Else                          ||20219  |                    Else                          
20646  |                        '閾値通貨→JPYの為替レート||20220  |                        '閾値通貨→JPYの為替レート
20647  |                        dstrCurrencyCode = gbuMGet||20221  |                        dstrCurrencyCode = gbuMGet
20648  |                        ddblExchangeRate = fnstrEx||20222  |                        ddblExchangeRate = fnstrEx
20649  |                        If ddblExchangeRate = 0 Th||20223  |                        If ddblExchangeRate = 0 Th
20650  |                          intRtn = MsgBox("ＴＴＭ ||20224  |                          intRtn = MsgBox("ＴＴＭ 
20651  |                          vbLf & "対象通貨コード  ||20225  |                          vbLf & "対象通貨コード  
20652  |                          vbLf & "基準日 ： [ " & ||20226  |                          vbLf & "基準日 ： [ " & 
20653  |                              vbCritical, "ＴＴＭ ||20227  |                              vbCritical, "ＴＴＭ 
20654  |                          Exit Function           ||20228  |                          Exit Function           
20655  |                        End If                    ||20229  |                        End If                    
20656  |                        'JPY→閾値通貨へレート換算||20230  |                        'JPY→閾値通貨へレート換算
20657  |                        dblValueIn = dblValueIn * ||20231  |                        dblValueIn = dblValueIn * 
20658  |                    End If                        ||20232  |                    End If                        
20659  |                Else                              ||20233  |                Else                              
20660  |                    'NAV通貨→JPYの為替レートを取 ||20234  |                    'NAV通貨→JPYの為替レートを取 
20661  |                    dstrCurrencyCode = gbuMGetUPDR||20235  |                    dstrCurrencyCode = gbuMGetUPDR
20662  |                    ddblExchangeRate = fnstrExchan||20236  |                    ddblExchangeRate = fnstrExchan
20663  |                    If ddblExchangeRate = 0 Then  ||20237  |                    If ddblExchangeRate = 0 Then  
20664  |                      intRtn = MsgBox("ＴＴＭが取 ||20238  |                      intRtn = MsgBox("ＴＴＭが取 
20665  |                      vbLf & "対象通貨コード ： [ ||20239  |                      vbLf & "対象通貨コード ： [ 
20666  |                      vbLf & "基準日 ： [ " & Mid(||20240  |                      vbLf & "基準日 ： [ " & Mid(
20667  |                          vbCritical, "ＴＴＭ取得 ||20241  |                          vbCritical, "ＴＴＭ取得 
20668  |                      Exit Function               ||20242  |                      Exit Function               
20669  |                    End If                        ||20243  |                    End If                        
20670  |                    'NAV通貨→JPYへレート換算     ||20244  |                    'NAV通貨→JPYへレート換算     
20671  |                    dblValueIn = dblValueIn * ddbl||20245  |                    dblValueIn = dblValueIn * ddbl
20672  |                    If gbuMGetUPDRec.N(lRecIdx).MG||20246  |                    If gbuMGetUPDRec.N(lRecIdx).MG
20673  |                    Else                          ||20247  |                    Else                          
20674  |                        '閾値通貨→JPYの為替レート||20248  |                        '閾値通貨→JPYの為替レート
20675  |                        dstrCurrencyCode = gbuMGet||20249  |                        dstrCurrencyCode = gbuMGet
20676  |                        ddblExchangeRate = fnstrEx||20250  |                        ddblExchangeRate = fnstrEx
20677  |                        If ddblExchangeRate = 0 Th||20251  |                        If ddblExchangeRate = 0 Th
20678  |                          intRtn = MsgBox("ＴＴＭ ||20252  |                          intRtn = MsgBox("ＴＴＭ 
20679  |                          vbLf & "対象通貨コード  ||20253  |                          vbLf & "対象通貨コード  
20680  |                          vbLf & "基準日 ： [ " & ||20254  |                          vbLf & "基準日 ： [ " & 
20681  |                              vbCritical, "ＴＴＭ ||20255  |                              vbCritical, "ＴＴＭ 
20682  |                          Exit Function           ||20256  |                          Exit Function           
20683  |                        End If                    ||20257  |                        End If                    
20684  |                        'JPY→閾値通貨へ逆レート換||20258  |                        'JPY→閾値通貨へ逆レート換
20685  |                        dblValueIn = dblValueIn / ||20259  |                        dblValueIn = dblValueIn / 
20686  |                    End If                        ||20260  |                    End If                        
20687  |                End If                            ||20261  |                End If                            
20688  |            End Select                            ||20262  |            End Select                            
20689  |            '@@@@@ NAV通貨から閾値通貨に換算 @@@@@||20263  |            '@@@@@ NAV通貨から閾値通貨に換算 @@@@@
20690  |            Call sbGetRoundValue2(dblValueIn)     ||20264  |            Call sbGetRoundValue2(dblValueIn)     
20691  |            lCalcNav = CStr(Format(dblValueOut, "#||20265  |            lCalcNav = CStr(Format(dblValueOut, "#
20692  |                                                  ||20266  |                                                  
20693  |        '固定料率                                 ||20267  |        '固定料率                                 
20694  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat||20268  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat
20695  |            '計算対称NAV × 外部委託顧問料率 ÷ 10||20269  |            '計算対称NAV × 外部委託顧問料率 ÷ 10
20696  |            dRitsu = CDbl(gbuOtherComRateGetUPDRec||20270  |            dRitsu = CDbl(gbuOtherComRateGetUPDRec
20697  |                                                  ||20271  |                                                  
20698  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_||20272  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_
20699  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_||20273  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_
20700  |                '一年間の日数：365日またはカレンダ||20274  |                '一年間の日数：365日またはカレンダ
20701  |                dblValueIn = lCalcNav * dRitsu / 1||20275  |                dblValueIn = lCalcNav * dRitsu / 1
20702  |            Else                                  ||20276  |            Else                                  
20703  |                '一年間の日数：360日              ||20277  |                '一年間の日数：360日              
20704  |                dblValueIn = lCalcNav * dRitsu / 1||20278  |                dblValueIn = lCalcNav * dRitsu / 1
20705  |            End If                                ||20279  |            End If                                
20706  |                                                  ||20280  |                                                  
20707  |        '段階料率                                 ||20281  |        '段階料率                                 
20708  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other||20282  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other
20709  |            '料率分ループ処理                     ||20283  |            '料率分ループ処理                     
20710  |            For i = LBound(gbuOtherComRateGetUPDRe||20284  |            For i = LBound(gbuOtherComRateGetUPDRe
20711  |                TotalRate = TotalRate + CCur(gbuOt||20285  |                TotalRate = TotalRate + CCur(gbuOt
20712  |                cRate = CCur(gbuOtherComRateGetUPD||20286  |                cRate = CCur(gbuOtherComRateGetUPD
20713  |                dRitsu = CDbl(gbuOtherComRateGetUP||20287  |                dRitsu = CDbl(gbuOtherComRateGetUP
20714  |                If i = UBound(gbuOtherComRateGetUP||20288  |                If i = UBound(gbuOtherComRateGetUP
20715  |                    '(前回閾値)：累積閾値 = WORK閾||20289  |                    '(前回閾値)：累積閾値 = WORK閾
20716  |                    TotalRate = WorkRate          ||20290  |                    TotalRate = WorkRate          
20717  |                ElseIf TotalRate <= lCalcNav Then ||20291  |                ElseIf TotalRate <= lCalcNav Then 
20718  |                    '累積投資顧問料 = 累積投資顧問||20292  |                    '累積投資顧問料 = 累積投資顧問
20719  |                    dblValueIn = cRate * dRitsu / ||20293  |                    dblValueIn = cRate * dRitsu / 
20720  |                    Call sbGetRoundValue2(dblValue||20294  |                    Call sbGetRoundValue2(dblValue
20721  |                    TotalCom = TotalCom + dblValue||20295  |                    TotalCom = TotalCom + dblValue
20722  |                Else                              ||20296  |                Else                              
20723  |                    '(前回閾値)：累積閾値 = WORK閾||20297  |                    '(前回閾値)：累積閾値 = WORK閾
20724  |                    TotalRate = WorkRate          ||20298  |                    TotalRate = WorkRate          
20725  |                    Exit For                      ||20299  |                    Exit For                      
20726  |                End If                            ||20300  |                End If                            
20727  |                '累積閾値をWORKに格納(一つ前の閾値||20301  |                '累積閾値をWORKに格納(一つ前の閾値
20728  |                WorkRate = TotalRate              ||20302  |                WorkRate = TotalRate              
20729  |            Next i                                ||20303  |            Next i                                
20730  |            '累積投資顧問料 = 累積投資顧問料 + (計||20304  |            '累積投資顧問料 = 累積投資顧問料 + (計
20731  |            dblValueIn = (lCalcNav - TotalRate) * ||20305  |            dblValueIn = (lCalcNav - TotalRate) * 
20732  |            TotalCom = TotalCom + dblValueIn      ||20306  |            TotalCom = TotalCom + dblValueIn      
20733  |                                                  ||20307  |                                                  
20734  |            '投資顧問料 = 累積投資顧問料 × 計算期||20308  |            '投資顧問料 = 累積投資顧問料 × 計算期
20735  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_||20309  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_
20736  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_||20310  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_
20737  |                '一年間の日数：365日またはカレンダ||20311  |                '一年間の日数：365日またはカレンダ
20738  |                dblValueIn = TotalCom * iCalcNum /||20312  |                dblValueIn = TotalCom * iCalcNum /
20739  |            Else                                  ||20313  |            Else                                  
20740  |                '一年間の日数：360日              ||20314  |                '一年間の日数：360日              
20741  |                dblValueIn = TotalCom * iCalcNum /||20315  |                dblValueIn = TotalCom * iCalcNum /
20742  |            End If                                ||20316  |            End If                                
20743  |        End If                                    ||20317  |        End If                                    
20744  |                                                  ||20318  |                                                  
20745  |        ddblExchangeRate = 0                      ||20319  |        ddblExchangeRate = 0                      
20746  |                                                  ||20320  |                                                  
20747  |        '@@@@@ 外部委託顧問料に換算 @@@@@         ||20321  |        '@@@@@ 外部委託顧問料に換算 @@@@@         
20748  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||20322  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
20749  |          Case "1"    '固定料率                   ||20323  |          Case "1"    '固定料率                   
20750  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o||20324  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o
20751  |                Else                              ||20325  |                Else                              
20752  |                  '外部委託顧問料通貨→JPYの為替レ||20326  |                  '外部委託顧問料通貨→JPYの為替レ
20753  |                  dstrCurrencyCode = gbuMGetUPDRec||20327  |                  dstrCurrencyCode = gbuMGetUPDRec
20754  |                  ddblExchangeRate = fnstrExchange||20328  |                  ddblExchangeRate = fnstrExchange
20755  |                  If ddblExchangeRate = 0 Then    ||20329  |                  If ddblExchangeRate = 0 Then    
20756  |                    intRtn = MsgBox("ＴＴＭが取得 ||20330  |                    intRtn = MsgBox("ＴＴＭが取得 
20757  |                    vbLf & "対象通貨コード ： [ " ||20331  |                    vbLf & "対象通貨コード ： [ " 
20758  |                    vbLf & "基準日 ： [ " & Mid(ds||20332  |                    vbLf & "基準日 ： [ " & Mid(ds
20759  |                        vbCritical, "ＴＴＭ取得エ ||20333  |                        vbCritical, "ＴＴＭ取得エ 
20760  |                    Exit Function                 ||20334  |                    Exit Function                 
20761  |                  End If                          ||20335  |                  End If                          
20762  |                  'JPY→閾値通貨へ逆レート換算    ||20336  |                  'JPY→閾値通貨へ逆レート換算    
20763  |                  dblValueIn = dblValueIn / ddblEx||20337  |                  dblValueIn = dblValueIn / ddblEx
20764  |                End If                            ||20338  |                End If                            
20765  |                                                  ||20339  |                                                  
20766  |          Case "2"    '段階料率                   ||20340  |          Case "2"    '段階料率                   
20767  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||20341  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
20768  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||20342  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
20769  |                Else                              ||20343  |                Else                              
20770  |                    '閾値通貨→JPYの為替レートを取||20344  |                    '閾値通貨→JPYの為替レートを取
20771  |                    dstrCurrencyCode = gbuMGetUPDR||20345  |                    dstrCurrencyCode = gbuMGetUPDR
20772  |                    ddblExchangeRate = fnstrExchan||20346  |                    ddblExchangeRate = fnstrExchan
20773  |                    'JPY→閾値通貨へ逆レート換算  ||20347  |                    'JPY→閾値通貨へ逆レート換算  
20774  |                    dblValueIn = dblValueIn / ddbl||20348  |                    dblValueIn = dblValueIn / ddbl
20775  |                End If                            ||20349  |                End If                            
20776  |            Else                                  ||20350  |            Else                                  
20777  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||20351  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
20778  |                    '外部委託顧問料通貨→JPYの為替||20352  |                    '外部委託顧問料通貨→JPYの為替
20779  |                    dstrCurrencyCode = gbuMGetUPDR||20353  |                    dstrCurrencyCode = gbuMGetUPDR
20780  |                    ddblExchangeRate = fnstrExchan||20354  |                    ddblExchangeRate = fnstrExchan
20781  |                    'JPY→閾値通貨へレート換算    ||20355  |                    'JPY→閾値通貨へレート換算    
20782  |                    dblValueIn = dblValueIn / ddbl||20356  |                    dblValueIn = dblValueIn / ddbl
20783  |                Else                              ||20357  |                Else                              
20784  |                    '閾値通貨→JPYの為替レートを取||20358  |                    '閾値通貨→JPYの為替レートを取
20785  |                    dstrCurrencyCode = gbuMGetUPDR||20359  |                    dstrCurrencyCode = gbuMGetUPDR
20786  |                    ddblExchangeRate = fnstrExchan||20360  |                    ddblExchangeRate = fnstrExchan
20787  |                    'JPY→閾値通貨へ逆レート換算  ||20361  |                    'JPY→閾値通貨へ逆レート換算  
20788  |                    dblValueIn = dblValueIn * ddbl||20362  |                    dblValueIn = dblValueIn * ddbl
20789  |                    '外部委託顧問料通貨→JPYの為替||20363  |                    '外部委託顧問料通貨→JPYの為替
20790  |                    dstrCurrencyCode = gbuMGetUPDR||20364  |                    dstrCurrencyCode = gbuMGetUPDR
20791  |                    ddblExchangeRate = fnstrExchan||20365  |                    ddblExchangeRate = fnstrExchan
20792  |                    'JPY→閾値通貨へ逆レート換算  ||20366  |                    'JPY→閾値通貨へ逆レート換算  
20793  |                    dblValueIn = dblValueIn / ddbl||20367  |                    dblValueIn = dblValueIn / ddbl
20794  |                End If                            ||20368  |                End If                            
20795  |            End If                                ||20369  |            End If                                
20796  |                                                  ||20370  |                                                  
20797  |        End Select                                ||20371  |        End Select                                
20798  |        '@@@@@ 外部委託顧問料に換算 @@@@@         ||20372  |        '@@@@@ 外部委託顧問料に換算 @@@@@         
20799  |        Call sbGetRoundValue2(dblValueIn)         ||20373  |        Call sbGetRoundValue2(dblValueIn)         
20800  |        mstrMonthlyPayCom = dblValueOut           ||20374  |        mstrMonthlyPayCom = dblValueOut           
20801  |                                                  ||20375  |                                                  
20802  |        TotalRate = 0                             ||20376  |        TotalRate = 0                             
20803  |        '固定料率                                 ||20377  |        '固定料率                                 
20804  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat||20378  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat
20805  |            '年率1行固定                          ||20379  |            '年率1行固定                          
20806  |            '文言の冗長化でピリオド及び、名称を二 ||20380  |            '文言の冗長化でピリオド及び、名称を二 
20807  |'            .Cells(15, 13).Value = _             ||20381  |'            .Cells(15, 13).Value = _             
20808  |'                Format(gbuOtherComRateGetUPDRec.N||20382  |'                Format(gbuOtherComRateGetUPDRec.N
20809  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||20383  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
20810  |            '取得NAV区分が4:日次時価総額平均の場合||20384  |            '取得NAV区分が4:日次時価総額平均の場合
20811  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g||20385  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g
20812  |            .Cells(15, 15).Value = _              ||20386  |            .Cells(15, 15).Value = _              
20813  |                Format(gbuOtherComRateGetUPDRec.N(||20387  |                Format(gbuOtherComRateGetUPDRec.N(
20814  |            Else                                  ||20388  |            Else                                  
20815  |            .Cells(15, 15).Value = _              ||20389  |            .Cells(15, 15).Value = _              
20816  |                Format(gbuOtherComRateGetUPDRec.N(||20390  |                Format(gbuOtherComRateGetUPDRec.N(
20817  |            End If                                ||20391  |            End If                                
20818  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||20392  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
20819  |        '段階料率                                 ||20393  |        '段階料率                                 
20820  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other||20394  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other
20821  |            '料率順位のデータ数により処理を分岐   ||20395  |            '料率順位のデータ数により処理を分岐   
20822  |            iRowCnt = 0                           ||20396  |            iRowCnt = 0                           
20823  |                                                  ||20397  |                                                  
20824  |                For i = LBound(gbuOtherComRateGetU||20398  |                For i = LBound(gbuOtherComRateGetU
20825  |                    If i = 0 Then                 ||20399  |                    If i = 0 Then                 
20826  |                        '年率1行目                ||20400  |                        '年率1行目                
20827  |                                                  ||20401  |                                                  
20828  |                        Select Case gbuMGetUPDRec.||20402  |                        Select Case gbuMGetUPDRec.
20829  |                            '文言の冗長化でピリオ ||20403  |                            '文言の冗長化でピリオ 
20830  |                            Case cAud             ||20404  |                            Case cAud             
20831  |                                .Cells(15, 15).Val||20405  |                                .Cells(15, 15).Val
20832  |                                    sWord26a & CSt||20406  |                                    sWord26a & CSt
20833  |                                    sAuda & sWord2||20407  |                                    sAuda & sWord2
20834  |                            Case cCad             ||20408  |                            Case cCad             
20835  |                                .Cells(15, 15).Val||20409  |                                .Cells(15, 15).Val
20836  |                                    sWord26a & CSt||20410  |                                    sWord26a & CSt
20837  |                                    sCada & sWord2||20411  |                                    sCada & sWord2
20838  |                            Case cChf             ||20412  |                            Case cChf             
20839  |                                .Cells(15, 15).Val||20413  |                                .Cells(15, 15).Val
20840  |                                    sWord26a & CSt||20414  |                                    sWord26a & CSt
20841  |                                    sChfa & sWord2||20415  |                                    sChfa & sWord2
20842  |                            Case cEur             ||20416  |                            Case cEur             
20843  |                                .Cells(15, 15).Val||20417  |                                .Cells(15, 15).Val
20844  |                                    sWord26a & CSt||20418  |                                    sWord26a & CSt
20845  |                                    sEura & sWord2||20419  |                                    sEura & sWord2
20846  |                            Case cGbp             ||20420  |                            Case cGbp             
20847  |                                .Cells(15, 15).Val||20421  |                                .Cells(15, 15).Val
20848  |                                    sWord26a & CSt||20422  |                                    sWord26a & CSt
20849  |                                    sGbpa & sWord2||20423  |                                    sGbpa & sWord2
20850  |                            Case cHkd             ||20424  |                            Case cHkd             
20851  |                                .Cells(15, 15).Val||20425  |                                .Cells(15, 15).Val
20852  |                                    sWord26a & CSt||20426  |                                    sWord26a & CSt
20853  |                                    sHkda & sWord2||20427  |                                    sHkda & sWord2
20854  |                            Case cJpy             ||20428  |                            Case cJpy             
20855  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||20429  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
20856  |                                '取得NAV区分が4:日||20430  |                                '取得NAV区分が4:日
20857  |                                If gbuMGetUPDRec.N||20431  |                                If gbuMGetUPDRec.N
20858  |                                    .Cells(15, 15)||20432  |                                    .Cells(15, 15)
20859  |                                        sWord26a &||20433  |                                        sWord26a &
20860  |                                        sYena & sW||20434  |                                        sYena & sW
20861  |                                Else              ||20435  |                                Else              
20862  |                                    .Cells(15, 15)||20436  |                                    .Cells(15, 15)
20863  |                                        sWord26a &||20437  |                                        sWord26a &
20864  |                                        sYena & sW||20438  |                                        sYena & sW
20865  |                                End If            ||20439  |                                End If            
20866  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||20440  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
20867  |                            Case cMyr             ||20441  |                            Case cMyr             
20868  |                                .Cells(15, 15).Val||20442  |                                .Cells(15, 15).Val
20869  |                                    sWord26a & CSt||20443  |                                    sWord26a & CSt
20870  |                                    sMyra & sWord2||20444  |                                    sMyra & sWord2
20871  |                            Case cNzd             ||20445  |                            Case cNzd             
20872  |                                .Cells(15, 15).Val||20446  |                                .Cells(15, 15).Val
20873  |                                    sWord26a & CSt||20447  |                                    sWord26a & CSt
20874  |                                    sNzda & sWord2||20448  |                                    sNzda & sWord2
20875  |                            Case cSek             ||20449  |                            Case cSek             
20876  |                                .Cells(15, 15).Val||20450  |                                .Cells(15, 15).Val
20877  |                                    sWord26a & CSt||20451  |                                    sWord26a & CSt
20878  |                                    sSeka & sWord2||20452  |                                    sSeka & sWord2
20879  |                            Case cSgd             ||20453  |                            Case cSgd             
20880  |                                .Cells(15, 15).Val||20454  |                                .Cells(15, 15).Val
20881  |                                    sWord26a & CSt||20455  |                                    sWord26a & CSt
20882  |                                    sSgda & sWord2||20456  |                                    sSgda & sWord2
20883  |                            Case cUsd             ||20457  |                            Case cUsd             
20884  |                                .Cells(15, 15).Val||20458  |                                .Cells(15, 15).Val
20885  |                                    sWord26a & CSt||20459  |                                    sWord26a & CSt
20886  |                                    sUsda & sWord2||20460  |                                    sUsda & sWord2
20887  |                            Case cNok             ||20461  |                            Case cNok             
20888  |                                .Cells(15, 15).Val||20462  |                                .Cells(15, 15).Val
20889  |                                    sWord26a & CSt||20463  |                                    sWord26a & CSt
20890  |                                    sNoka & sWord2||20464  |                                    sNoka & sWord2
20891  |                        End Select                ||20465  |                        End Select                
20892  |                                                  ||20466  |                                                  
20893  |                        '年率　累積値セット       ||20467  |                        '年率　累積値セット       
20894  |                        TotalRate = CCur(gbuOtherC||20468  |                        TotalRate = CCur(gbuOtherC
20895  |                    ElseIf i = UBound(gbuOtherComR||20469  |                    ElseIf i = UBound(gbuOtherComR
20896  |                        If UBound(gbuOtherComRateG||20470  |                        If UBound(gbuOtherComRateG
20897  |                            '年率最終行           ||20471  |                            '年率最終行           
20898  |                                                  ||20472  |                                                  
20899  |                            '前半金額部分         ||20473  |                            '前半金額部分         
20900  |                            '文言の冗長化でピリオ ||20474  |                            '文言の冗長化でピリオ 
20901  |                            .Cells(15 + i + UBound||20475  |                            .Cells(15 + i + UBound
20902  |                                                  ||20476  |                                                  
20903  |                            '文言の冗長化でピリオ ||20477  |                            '文言の冗長化でピリオ 
20904  |                            If gbuMGetUPDRec.N(lRe||20478  |                            If gbuMGetUPDRec.N(lRe
20905  |                                .Cells(15 + i + UB||20479  |                                .Cells(15 + i + UB
20906  |                            Else                  ||20480  |                            Else                  
20907  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||20481  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
20908  |                                '取得NAV区分が4:日||20482  |                                '取得NAV区分が4:日
20909  |                                If gbuMGetUPDRec.N||20483  |                                If gbuMGetUPDRec.N
20910  |                                    .Cells(15 + i ||20484  |                                    .Cells(15 + i 
20911  |                                Else              ||20485  |                                Else              
20912  |                                    .Cells(15 + i ||20486  |                                    .Cells(15 + i 
20913  |                                End If            ||20487  |                                End If            
20914  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||20488  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
20915  |                            End If                ||20489  |                            End If                
20916  |                                                  ||20490  |                                                  
20917  |                            '後半の文言           ||20491  |                            '後半の文言           
20918  |                            Select Case gbuMGetUPD||20492  |                            Select Case gbuMGetUPD
20919  |                                '文言の冗長化でピ ||20493  |                                '文言の冗長化でピ 
20920  |                                Case cAud         ||20494  |                                Case cAud         
20921  |                                    .Cells(15 + i ||20495  |                                    .Cells(15 + i 
20922  |                                         sAuda & "||20496  |                                         sAuda & "
20923  |                                Case cCad         ||20497  |                                Case cCad         
20924  |                                    .Cells(15 + i ||20498  |                                    .Cells(15 + i 
20925  |                                         sCada & "||20499  |                                         sCada & "
20926  |                                Case cChf         ||20500  |                                Case cChf         
20927  |                                    .Cells(15 + i ||20501  |                                    .Cells(15 + i 
20928  |                                         sChfa & "||20502  |                                         sChfa & "
20929  |                                Case cEur         ||20503  |                                Case cEur         
20930  |                                    .Cells(15 + i ||20504  |                                    .Cells(15 + i 
20931  |                                         sEura & "||20505  |                                         sEura & "
20932  |                                Case cGbp         ||20506  |                                Case cGbp         
20933  |                                    .Cells(15 + i ||20507  |                                    .Cells(15 + i 
20934  |                                         sGbpa & "||20508  |                                         sGbpa & "
20935  |                                Case cHkd         ||20509  |                                Case cHkd         
20936  |                                    .Cells(15 + i ||20510  |                                    .Cells(15 + i 
20937  |                                         sHkda & "||20511  |                                         sHkda & "
20938  |                                Case cJpy         ||20512  |                                Case cJpy         
20939  |                                    .Cells(15 + i ||20513  |                                    .Cells(15 + i 
20940  |                                         sYena & "||20514  |                                         sYena & "
20941  |                                Case cMyr         ||20515  |                                Case cMyr         
20942  |                                    .Cells(15 + i ||20516  |                                    .Cells(15 + i 
20943  |                                         sMyra & "||20517  |                                         sMyra & "
20944  |                                Case cNzd         ||20518  |                                Case cNzd         
20945  |                                    .Cells(15 + i ||20519  |                                    .Cells(15 + i 
20946  |                                         sNzda & "||20520  |                                         sNzda & "
20947  |                                Case cSek         ||20521  |                                Case cSek         
20948  |                                    .Cells(15 + i ||20522  |                                    .Cells(15 + i 
20949  |                                         sSeka & "||20523  |                                         sSeka & "
20950  |                                Case cSgd         ||20524  |                                Case cSgd         
20951  |                                    .Cells(15 + i ||20525  |                                    .Cells(15 + i 
20952  |                                         sSgda & "||20526  |                                         sSgda & "
20953  |                                Case cUsd         ||20527  |                                Case cUsd         
20954  |                                    .Cells(15 + i ||20528  |                                    .Cells(15 + i 
20955  |                                         sUsda & "||20529  |                                         sUsda & "
20956  |                                Case cNok         ||20530  |                                Case cNok         
20957  |                                    .Cells(15 + i ||20531  |                                    .Cells(15 + i 
20958  |                                         sNoka & "||20532  |                                         sNoka & "
20959  |                            End Select            ||20533  |                            End Select            
20960  |                        Else                      ||20534  |                        Else                      
20961  |                            '年率最終行           ||20535  |                            '年率最終行           
20962  |                            '前半金額部分         ||20536  |                            '前半金額部分         
20963  |                            .Cells(15 + i + UBound||20537  |                            .Cells(15 + i + UBound
20964  |                            '文言の冗長化でピリオ ||20538  |                            '文言の冗長化でピリオ 
20965  |                            If gbuMGetUPDRec.N(lRe||20539  |                            If gbuMGetUPDRec.N(lRe
20966  |                                .Cells(15 + i + UB||20540  |                                .Cells(15 + i + UB
20967  |                            Else                  ||20541  |                            Else                  
20968  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||20542  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
20969  |                                '取得NAV区分が4:日||20543  |                                '取得NAV区分が4:日
20970  |                                If gbuMGetUPDRec.N||20544  |                                If gbuMGetUPDRec.N
20971  |                                    .Cells(15 + i ||20545  |                                    .Cells(15 + i 
20972  |                                Else              ||20546  |                                Else              
20973  |                                    .Cells(15 + i ||20547  |                                    .Cells(15 + i 
20974  |                                End If            ||20548  |                                End If            
20975  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||20549  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
20976  |                            End If                ||20550  |                            End If                
20977  |                                                  ||20551  |                                                  
20978  |                            '後半の文言           ||20552  |                            '後半の文言           
20979  |                            '文言の冗長化でピリオ ||20553  |                            '文言の冗長化でピリオ 
20980  |                            .Cells(15 + i + UBound||20554  |                            .Cells(15 + i + UBound
20981  |                                                  ||20555  |                                                  
20982  |                            Select Case gbuMGetUPD||20556  |                            Select Case gbuMGetUPD
20983  |                                '文言の冗長化でピ ||20557  |                                '文言の冗長化でピ 
20984  |                                Case cAud         ||20558  |                                Case cAud         
20985  |                                    .Cells(15 + i ||20559  |                                    .Cells(15 + i 
20986  |                                         sAuda & "||20560  |                                         sAuda & "
20987  |                                Case cCad         ||20561  |                                Case cCad         
20988  |                                    .Cells(15 + i ||20562  |                                    .Cells(15 + i 
20989  |                                         sCada & "||20563  |                                         sCada & "
20990  |                                Case cChf         ||20564  |                                Case cChf         
20991  |                                    .Cells(15 + i ||20565  |                                    .Cells(15 + i 
20992  |                                         sChfa & "||20566  |                                         sChfa & "
20993  |                                Case cEur         ||20567  |                                Case cEur         
20994  |                                    .Cells(15 + i ||20568  |                                    .Cells(15 + i 
20995  |                                         sEura & "||20569  |                                         sEura & "
20996  |                                Case cGbp         ||20570  |                                Case cGbp         
20997  |                                    .Cells(15 + i ||20571  |                                    .Cells(15 + i 
20998  |                                         sGbpa & "||20572  |                                         sGbpa & "
20999  |                                Case cHkd         ||20573  |                                Case cHkd         
21000  |                                    .Cells(15 + i ||20574  |                                    .Cells(15 + i 
21001  |                                         sHkda & "||20575  |                                         sHkda & "
21002  |                                Case cJpy         ||20576  |                                Case cJpy         
21003  |                                    .Cells(15 + i ||20577  |                                    .Cells(15 + i 
21004  |                                         sYena & "||20578  |                                         sYena & "
21005  |                                Case cMyr         ||20579  |                                Case cMyr         
21006  |                                    .Cells(15 + i ||20580  |                                    .Cells(15 + i 
21007  |                                         sMyra & "||20581  |                                         sMyra & "
21008  |                                Case cNzd         ||20582  |                                Case cNzd         
21009  |                                    .Cells(15 + i ||20583  |                                    .Cells(15 + i 
21010  |                                         sNzda & "||20584  |                                         sNzda & "
21011  |                                Case cSek         ||20585  |                                Case cSek         
21012  |                                    .Cells(15 + i ||20586  |                                    .Cells(15 + i 
21013  |                                         sSeka & "||20587  |                                         sSeka & "
21014  |                                Case cSgd         ||20588  |                                Case cSgd         
21015  |                                    .Cells(15 + i ||20589  |                                    .Cells(15 + i 
21016  |                                         sSgda & "||20590  |                                         sSgda & "
21017  |                                Case cUsd         ||20591  |                                Case cUsd         
21018  |                                    .Cells(15 + i ||20592  |                                    .Cells(15 + i 
21019  |                                         sUsda & "||20593  |                                         sUsda & "
21020  |                                Case cNok         ||20594  |                                Case cNok         
21021  |                                    .Cells(15 + i ||20595  |                                    .Cells(15 + i 
21022  |                                         sNoka & "||20596  |                                         sNoka & "
21023  |                            End Select            ||20597  |                            End Select            
21024  |                        End If                    ||20598  |                        End If                    
21025  |                    Else                          ||20599  |                    Else                          
21026  |                                                  ||20600  |                                                  
21027  |                        '年率2行目以降            ||20601  |                        '年率2行目以降            
21028  |                        '前半金額部分             ||20602  |                        '前半金額部分             
21029  |                        '文言の冗長化でピリオド及 ||20603  |                        '文言の冗長化でピリオド及 
21030  |                        .Cells(15 + i + (i - 1), 1||20604  |                        .Cells(15 + i + (i - 1), 1
21031  |                                                  ||20605  |                                                  
21032  |                        '文言の冗長化でピリオド及 ||20606  |                        '文言の冗長化でピリオド及 
21033  |                        If gbuMGetUPDRec.N(lRecIdx||20607  |                        If gbuMGetUPDRec.N(lRecIdx
21034  |                            .Cells(15 + i + (i - 1||20608  |                            .Cells(15 + i + (i - 1
21035  |                              sWord28a & CStr(Form||20609  |                              sWord28a & CStr(Form
21036  |                        Else                      ||20610  |                        Else                      
21037  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||20611  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
21038  |                            '取得NAV区分が4:日次時||20612  |                            '取得NAV区分が4:日次時
21039  |                            If gbuMGetUPDRec.N(lRe||20613  |                            If gbuMGetUPDRec.N(lRe
21040  |                                .Cells(15 + i + (i||20614  |                                .Cells(15 + i + (i
21041  |                                  sWord66a & CStr(||20615  |                                  sWord66a & CStr(
21042  |                            Else                  ||20616  |                            Else                  
21043  |                                .Cells(15 + i + (i||20617  |                                .Cells(15 + i + (i
21044  |                                  sWord28a & CStr(||20618  |                                  sWord28a & CStr(
21045  |                            End If                ||20619  |                            End If                
21046  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||20620  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
21047  |                        End If                    ||20621  |                        End If                    
21048  |                                                  ||20622  |                                                  
21049  |                        '年率　累積値セット       ||20623  |                        '年率　累積値セット       
21050  |                        TotalRate = TotalRate + CC||20624  |                        TotalRate = TotalRate + CC
21051  |                        '後半の文言               ||20625  |                        '後半の文言               
21052  |                        '文言の冗長化でピリオド及 ||20626  |                        '文言の冗長化でピリオド及 
21053  |                        .Cells(15 + i + i, 15).Num||20627  |                        .Cells(15 + i + i, 15).Num
21054  |                        Select Case gbuMGetUPDRec.||20628  |                        Select Case gbuMGetUPDRec.
21055  |                            '文言の冗長化でピリオ ||20629  |                            '文言の冗長化でピリオ 
21056  |                            Case cAud             ||20630  |                            Case cAud             
21057  |                                .Cells(15 + i + i,||20631  |                                .Cells(15 + i + i,
21058  |                                    sAuda & sWord2||20632  |                                    sAuda & sWord2
21059  |                                    Format(gbuOthe||20633  |                                    Format(gbuOthe
21060  |                            Case cCad             ||20634  |                            Case cCad             
21061  |                                .Cells(15 + i + i,||20635  |                                .Cells(15 + i + i,
21062  |                                    sCada & sWord2||20636  |                                    sCada & sWord2
21063  |                                    Format(gbuOthe||20637  |                                    Format(gbuOthe
21064  |                            Case cChf             ||20638  |                            Case cChf             
21065  |                                .Cells(15 + i + i,||20639  |                                .Cells(15 + i + i,
21066  |                                    sChfa & sWord2||20640  |                                    sChfa & sWord2
21067  |                                    Format(gbuOthe||20641  |                                    Format(gbuOthe
21068  |                            Case cEur             ||20642  |                            Case cEur             
21069  |                                .Cells(15 + i + i,||20643  |                                .Cells(15 + i + i,
21070  |                                    sEura & sWord2||20644  |                                    sEura & sWord2
21071  |                                    Format(gbuOthe||20645  |                                    Format(gbuOthe
21072  |                            Case cGbp             ||20646  |                            Case cGbp             
21073  |                                .Cells(15 + i + i,||20647  |                                .Cells(15 + i + i,
21074  |                                    sGbpa & sWord2||20648  |                                    sGbpa & sWord2
21075  |                                    Format(gbuOthe||20649  |                                    Format(gbuOthe
21076  |                            Case cHkd             ||20650  |                            Case cHkd             
21077  |                                .Cells(15 + i + i,||20651  |                                .Cells(15 + i + i,
21078  |                                    sHkda & sWord2||20652  |                                    sHkda & sWord2
21079  |                                    Format(gbuOthe||20653  |                                    Format(gbuOthe
21080  |                            Case cJpy             ||20654  |                            Case cJpy             
21081  |                                .Cells(15 + i + i,||20655  |                                .Cells(15 + i + i,
21082  |                                    sYena & sWord2||20656  |                                    sYena & sWord2
21083  |                                    Format(gbuOthe||20657  |                                    Format(gbuOthe
21084  |                            Case cMyr             ||20658  |                            Case cMyr             
21085  |                                .Cells(15 + i + i,||20659  |                                .Cells(15 + i + i,
21086  |                                    sMyra & sWord2||20660  |                                    sMyra & sWord2
21087  |                                    Format(gbuOthe||20661  |                                    Format(gbuOthe
21088  |                            Case cNzd             ||20662  |                            Case cNzd             
21089  |                                .Cells(15 + i + i,||20663  |                                .Cells(15 + i + i,
21090  |                                    sNzda & sWord2||20664  |                                    sNzda & sWord2
21091  |                                    Format(gbuOthe||20665  |                                    Format(gbuOthe
21092  |                            Case cSek             ||20666  |                            Case cSek             
21093  |                                .Cells(15 + i + i,||20667  |                                .Cells(15 + i + i,
21094  |                                    sSeka & sWord2||20668  |                                    sSeka & sWord2
21095  |                                    Format(gbuOthe||20669  |                                    Format(gbuOthe
21096  |                            Case cSgd             ||20670  |                            Case cSgd             
21097  |                                .Cells(15 + i + i,||20671  |                                .Cells(15 + i + i,
21098  |                                    sSgda & sWord2||20672  |                                    sSgda & sWord2
21099  |                                    Format(gbuOthe||20673  |                                    Format(gbuOthe
21100  |                            Case cUsd             ||20674  |                            Case cUsd             
21101  |                                .Cells(15 + i + i,||20675  |                                .Cells(15 + i + i,
21102  |                                    sUsda & sWord2||20676  |                                    sUsda & sWord2
21103  |                                    Format(gbuOthe||20677  |                                    Format(gbuOthe
21104  |                            Case cNok             ||20678  |                            Case cNok             
21105  |                                .Cells(15 + i + i,||20679  |                                .Cells(15 + i + i,
21106  |                                    sNoka & sWord2||20680  |                                    sNoka & sWord2
21107  |                                    Format(gbuOthe||20681  |                                    Format(gbuOthe
21108  |                        End Select                ||20682  |                        End Select                
21109  |                    End If                        ||20683  |                    End If                        
21110  |                Next i                            ||20684  |                Next i                            
21111  |            End If                                ||20685  |            End If                                
21112  |                                                  ||20686  |                                                  
21113  |        '投資顧問料                               ||20687  |        '投資顧問料                               
21114  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||20688  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
21115  |            Case Mid(mstrContractFlag(1), 1, 1)   ||20689  |            Case Mid(mstrContractFlag(1), 1, 1)   
21116  |                .Cells(46, 2).Value = sWord11d    ||20690  |                .Cells(46, 2).Value = sWord11d    
21117  |            Case Mid(mstrContractFlag(2), 1, 1)   ||20691  |            Case Mid(mstrContractFlag(2), 1, 1)   
21118  |                .Cells(46, 2).Value = sWord11e    ||20692  |                .Cells(46, 2).Value = sWord11e    
21119  |            Case Mid(mstrContractFlag(3), 1, 1)   ||20693  |            Case Mid(mstrContractFlag(3), 1, 1)   
21120  |                .Cells(46, 2).Value = sWord11f    ||20694  |                .Cells(46, 2).Value = sWord11f    
21121  |            Case Else                             ||20695  |            Case Else                             
21122  |                MsgBox "契約区分が不正です。", vbC||20696  |                MsgBox "契約区分が不正です。", vbC
21123  |        End Select                                ||20697  |        End Select                                
21124  |        '文言の冗長化でピリオド及び、名称を二列右 ||20698  |        '文言の冗長化でピリオド及び、名称を二列右 
21125  |'        .Cells(46, 11).Value = sWord19           ||20699  |'        .Cells(46, 11).Value = sWord19           
21126  |        .Cells(46, 13).Value = sWord19            ||20700  |        .Cells(46, 13).Value = sWord19            
21127  |                                                  ||20701  |                                                  
21128  |        '外部委託顧問料                           ||20702  |        '外部委託顧問料                           
21129  |        '文言の冗長化でピリオド及び、名称を二列右 ||20703  |        '文言の冗長化でピリオド及び、名称を二列右 
21130  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||20704  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
21131  |'            .Cells(46, 31).NumberFormatLocal = "@||20705  |'            .Cells(46, 31).NumberFormatLocal = "@
21132  |'        Else                                     ||20706  |'        Else                                     
21133  |'            .Cells(46, 29).NumberFormatLocal = "@||20707  |'            .Cells(46, 29).NumberFormatLocal = "@
21134  |'        End If                                   ||20708  |'        End If                                   
21135  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||20709  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
21136  |            .Cells(46, 33).NumberFormatLocal = "@"||20710  |            .Cells(46, 33).NumberFormatLocal = "@"
21137  |        Else                                      ||20711  |        Else                                      
21138  |            .Cells(46, 31).NumberFormatLocal = "@"||20712  |            .Cells(46, 31).NumberFormatLocal = "@"
21139  |        End If                                    ||20713  |        End If                                    
21140  |                                                  ||20714  |                                                  
21141  |        '契約区分が名称使用許諾料の場合上限・下限 ||20715  |        '契約区分が名称使用許諾料の場合上限・下限 
21142  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||20716  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
21143  |            '下限金額より換算した金額が小さい場合 ||20717  |            '下限金額より換算した金額が小さい場合 
21144  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_f||20718  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_f
21145  |                If mstrMonthlyPayCom < CDbl(gbuMGe||20719  |                If mstrMonthlyPayCom < CDbl(gbuMGe
21146  |                    mstrMonthlyPayCom = CDbl(gbuMG||20720  |                    mstrMonthlyPayCom = CDbl(gbuMG
21147  |                End If                            ||20721  |                End If                            
21148  |            End If                                ||20722  |            End If                                
21149  |            '上限金額より換算した金額が大きい場合 ||20723  |            '上限金額より換算した金額が大きい場合 
21150  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_c||20724  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_c
21151  |                If mstrMonthlyPayCom > CDbl(gbuMGe||20725  |                If mstrMonthlyPayCom > CDbl(gbuMGe
21152  |                    mstrMonthlyPayCom = CDbl(gbuMG||20726  |                    mstrMonthlyPayCom = CDbl(gbuMG
21153  |                End If                            ||20727  |                End If                            
21154  |            End If                                ||20728  |            End If                                
21155  |                                                  ||20729  |                                                  
21156  |            dblValueIn = CDbl(mstrMonthlyPayCom)  ||20730  |            dblValueIn = CDbl(mstrMonthlyPayCom)  
21157  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||20731  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
21158  |                Call sbGetRoundValue2(dblValueIn) ||20732  |                Call sbGetRoundValue2(dblValueIn) 
21159  |            Else                                  ||20733  |            Else                                  
21160  |                Call sbGetRoundValue(dblValueIn)  ||20734  |                Call sbGetRoundValue(dblValueIn)  
21161  |            End If                                ||20735  |            End If                                
21162  |            mstrMonthlyPayCom = dblValueOut       ||20736  |            mstrMonthlyPayCom = dblValueOut       
21163  |                                                  ||20737  |                                                  
21164  |        End If                                    ||20738  |        End If                                    
21165  |                                                  ||20739  |                                                  
21166  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||20740  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
21167  |            '文言の冗長化でピリオド及び、名称を二 ||20741  |            '文言の冗長化でピリオド及び、名称を二 
21168  |            Case cAud                             ||20742  |            Case cAud                             
21169  |                .Cells(46, 33).Value = CStr(Format||20743  |                .Cells(46, 33).Value = CStr(Format
21170  |                .Cells(46, 34).Value = sAuda      ||20744  |                .Cells(46, 34).Value = sAuda      
21171  |            Case cCad                             ||20745  |            Case cCad                             
21172  |                .Cells(46, 33).Value = CStr(Format||20746  |                .Cells(46, 33).Value = CStr(Format
21173  |                .Cells(46, 34).Value = sCada      ||20747  |                .Cells(46, 34).Value = sCada      
21174  |            Case cChf                             ||20748  |            Case cChf                             
21175  |                .Cells(46, 33).Value = CStr(Format||20749  |                .Cells(46, 33).Value = CStr(Format
21176  |                .Cells(46, 34).Value = sChfa      ||20750  |                .Cells(46, 34).Value = sChfa      
21177  |            Case cEur                             ||20751  |            Case cEur                             
21178  |                .Cells(46, 33).Value = CStr(Format||20752  |                .Cells(46, 33).Value = CStr(Format
21179  |                .Cells(46, 34).Value = sEura      ||20753  |                .Cells(46, 34).Value = sEura      
21180  |            Case cGbp                             ||20754  |            Case cGbp                             
21181  |                .Cells(46, 33).Value = CStr(Format||20755  |                .Cells(46, 33).Value = CStr(Format
21182  |                .Cells(46, 34).Value = sGbpa      ||20756  |                .Cells(46, 34).Value = sGbpa      
21183  |            Case cHkd                             ||20757  |            Case cHkd                             
21184  |                .Cells(46, 33).Value = CStr(Format||20758  |                .Cells(46, 33).Value = CStr(Format
21185  |                .Cells(46, 34).Value = sHkda      ||20759  |                .Cells(46, 34).Value = sHkda      
21186  |            Case cJpy                             ||20760  |            Case cJpy                             
21187  |                .Cells(46, 31).Value = CStr(Format||20761  |                .Cells(46, 31).Value = CStr(Format
21188  |                .Cells(46, 34).Value = sYena      ||20762  |                .Cells(46, 34).Value = sYena      
21189  |            Case cMyr                             ||20763  |            Case cMyr                             
21190  |                .Cells(46, 33).Value = CStr(Format||20764  |                .Cells(46, 33).Value = CStr(Format
21191  |                .Cells(46, 34).Value = sMyra      ||20765  |                .Cells(46, 34).Value = sMyra      
21192  |            Case cNzd                             ||20766  |            Case cNzd                             
21193  |                .Cells(46, 33).Value = CStr(Format||20767  |                .Cells(46, 33).Value = CStr(Format
21194  |                .Cells(46, 34).Value = sNzda      ||20768  |                .Cells(46, 34).Value = sNzda      
21195  |            Case cSek                             ||20769  |            Case cSek                             
21196  |                .Cells(46, 33).Value = CStr(Format||20770  |                .Cells(46, 33).Value = CStr(Format
21197  |                .Cells(46, 34).Value = sSeka      ||20771  |                .Cells(46, 34).Value = sSeka      
21198  |            Case cSgd                             ||20772  |            Case cSgd                             
21199  |                .Cells(46, 33).Value = CStr(Format||20773  |                .Cells(46, 33).Value = CStr(Format
21200  |                .Cells(46, 34).Value = sSgda      ||20774  |                .Cells(46, 34).Value = sSgda      
21201  |            Case cUsd                             ||20775  |            Case cUsd                             
21202  |                .Cells(46, 33).Value = CStr(Format||20776  |                .Cells(46, 33).Value = CStr(Format
21203  |                .Cells(46, 34).Value = sUsda      ||20777  |                .Cells(46, 34).Value = sUsda      
21204  |            Case cNok                             ||20778  |            Case cNok                             
21205  |                .Cells(46, 33).Value = CStr(Format||20779  |                .Cells(46, 33).Value = CStr(Format
21206  |                .Cells(46, 34).Value = sNoka      ||20780  |                .Cells(46, 34).Value = sNoka      
21207  |        End Select                                ||20781  |        End Select                                
21208  |                                                  ||20782  |                                                  
21209  |        '顧問料                                   ||20783  |        '顧問料                                   
21210  |        '文言の冗長化でピリオド及び、名称を二列右 ||20784  |        '文言の冗長化でピリオド及び、名称を二列右 
21211  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||20785  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
21212  |            .Cells(46, 33).HorizontalAlignment = x||20786  |            .Cells(46, 33).HorizontalAlignment = x
21213  |        Else                                      ||20787  |        Else                                      
21214  |            .Cells(46, 31).HorizontalAlignment = x||20788  |            .Cells(46, 31).HorizontalAlignment = x
21215  |        End If                                    ||20789  |        End If                                    
21216  |                                                  ||20790  |                                                  
21217  |        '契約区分が名称使用許諾料の場合上限・下限 ||20791  |        '契約区分が名称使用許諾料の場合上限・下限 
21218  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||20792  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
21219  |            '上限金額                             ||20793  |            '上限金額                             
21220  |            '文言の冗長化でピリオド及び、名称を二 ||20794  |            '文言の冗長化でピリオド及び、名称を二 
21221  |            .Cells(46, 47).Value = sWordCapa      ||20795  |            .Cells(46, 47).Value = sWordCapa      
21222  |            .Cells(46, 59).NumberFormatLocal = "@"||20796  |            .Cells(46, 59).NumberFormatLocal = "@"
21223  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||20797  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
21224  |                .Cells(46, 59).Value = Format(gbuM||20798  |                .Cells(46, 59).Value = Format(gbuM
21225  |            Else                                  ||20799  |            Else                                  
21226  |                .Cells(46, 59).Value = Format(gbuM||20800  |                .Cells(46, 59).Value = Format(gbuM
21227  |            End If                                ||20801  |            End If                                
21228  |                                                  ||20802  |                                                  
21229  |            .Cells(46, 59).HorizontalAlignment = x||20803  |            .Cells(46, 59).HorizontalAlignment = x
21230  |                                                  ||20804  |                                                  
21231  |            '下限金額                             ||20805  |            '下限金額                             
21232  |            .Cells(47, 47).Value = sWordFloora    ||20806  |            .Cells(47, 47).Value = sWordFloora    
21233  |            .Cells(47, 59).NumberFormatLocal = "@"||20807  |            .Cells(47, 59).NumberFormatLocal = "@"
21234  |                                                  ||20808  |                                                  
21235  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||20809  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
21236  |                .Cells(47, 59).Value = Format(gbuM||20810  |                .Cells(47, 59).Value = Format(gbuM
21237  |            Else                                  ||20811  |            Else                                  
21238  |                .Cells(47, 59).Value = Format(gbuM||20812  |                .Cells(47, 59).Value = Format(gbuM
21239  |            End If                                ||20813  |            End If                                
21240  |            .Cells(47, 59).HorizontalAlignment = x||20814  |            .Cells(47, 59).HorizontalAlignment = x
21241  |        End If                                    ||20815  |        End If                                    
21242  |                                                  ||20816  |                                                  
21243  |        ddblExchangeRate = 0                      ||20817  |        ddblExchangeRate = 0                      
21244  |                                                  ||20818  |                                                  
21245  |        dblValueIn = mstrMonthlyPayCom            ||20819  |        dblValueIn = mstrMonthlyPayCom            
21246  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||20820  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
21247  |          Case "1"    '固定料率                   ||20821  |          Case "1"    '固定料率                   
21248  |                                                  ||20822  |                                                  
21249  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o||20823  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o
21250  |                Else                              ||20824  |                Else                              
21251  |                  '外部委託顧問料通貨→JPYの為替レ||20825  |                  '外部委託顧問料通貨→JPYの為替レ
21252  |                  dstrCurrencyCode = gbuMGetUPDRec||20826  |                  dstrCurrencyCode = gbuMGetUPDRec
21253  |                  ddblExchangeRate = fnstrExchange||20827  |                  ddblExchangeRate = fnstrExchange
21254  |                  If ddblExchangeRate = 0 Then    ||20828  |                  If ddblExchangeRate = 0 Then    
21255  |                    intRtn = MsgBox("ＴＴＭが取得 ||20829  |                    intRtn = MsgBox("ＴＴＭが取得 
21256  |                    vbLf & "対象通貨コード ： [ " ||20830  |                    vbLf & "対象通貨コード ： [ " 
21257  |                    vbLf & "基準日 ： [ " & Mid(ds||20831  |                    vbLf & "基準日 ： [ " & Mid(ds
21258  |                        vbCritical, "ＴＴＭ取得エ ||20832  |                        vbCritical, "ＴＴＭ取得エ 
21259  |                    Exit Function                 ||20833  |                    Exit Function                 
21260  |                  End If                          ||20834  |                  End If                          
21261  |                  'JPY→支払通貨へレート換算      ||20835  |                  'JPY→支払通貨へレート換算      
21262  |                  dblValueIn = dblValueIn * ddblEx||20836  |                  dblValueIn = dblValueIn * ddblEx
21263  |                End If                            ||20837  |                End If                            
21264  |                                                  ||20838  |                                                  
21265  |          Case "2"    '段階料率                   ||20839  |          Case "2"    '段階料率                   
21266  |                                                  ||20840  |                                                  
21267  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||20841  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
21268  |            Else                                  ||20842  |            Else                                  
21269  |                '外部委託顧問料通貨→JPYの為替レー||20843  |                '外部委託顧問料通貨→JPYの為替レー
21270  |                dstrCurrencyCode = gbuMGetUPDRec.N||20844  |                dstrCurrencyCode = gbuMGetUPDRec.N
21271  |                ddblExchangeRate = fnstrExchangeRa||20845  |                ddblExchangeRate = fnstrExchangeRa
21272  |                If ddblExchangeRate = 0 Then      ||20846  |                If ddblExchangeRate = 0 Then      
21273  |                  intRtn = MsgBox("ＴＴＭが取得で ||20847  |                  intRtn = MsgBox("ＴＴＭが取得で 
21274  |                  vbLf & "対象通貨コード ： [ " & ||20848  |                  vbLf & "対象通貨コード ： [ " & 
21275  |                  vbLf & "基準日 ： [ " & Mid(dstr||20849  |                  vbLf & "基準日 ： [ " & Mid(dstr
21276  |                      vbCritical, "ＴＴＭ取得エラ ||20850  |                      vbCritical, "ＴＴＭ取得エラ 
21277  |                  Exit Function                   ||20851  |                  Exit Function                   
21278  |                End If                            ||20852  |                End If                            
21279  |                '外部委託顧問料通貨→JPYへレート換||20853  |                '外部委託顧問料通貨→JPYへレート換
21280  |                dblValueIn = dblValueIn * ddblExch||20854  |                dblValueIn = dblValueIn * ddblExch
21281  |            End If                                ||20855  |            End If                                
21282  |                                                  ||20856  |                                                  
21283  |        End Select                                ||20857  |        End Select                                
21284  |        '@@@@@ 支払に換算 @@@@@                   ||20858  |        '@@@@@ 支払に換算 @@@@@                   
21285  |        Call sbGetRoundValue(dblValueIn)          ||20859  |        Call sbGetRoundValue(dblValueIn)          
21286  |        mstrMonthlyPayCom = dblValueOut           ||20860  |        mstrMonthlyPayCom = dblValueOut           
21287  |                                                  ||20861  |                                                  
21288  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||20862  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
21289  |                'TTMレート                        ||20863  |                'TTMレート                        
21290  |                '文言の冗長化でピリオド及び、名称 ||20864  |                '文言の冗長化でピリオド及び、名称 
21291  |                .Cells(47, 21).Value = sWord43    ||20865  |                .Cells(47, 21).Value = sWord43    
21292  |                .Cells(47, 35).NumberFormatLocal =||20866  |                .Cells(47, 35).NumberFormatLocal =
21293  |                .Cells(47, 35).Value = Format(ddbl||20867  |                .Cells(47, 35).Value = Format(ddbl
21294  |                .Cells(47, 35).HorizontalAlignment||20868  |                .Cells(47, 35).HorizontalAlignment
21295  |                .Cells(47, 36).Value = sWord44    ||20869  |                .Cells(47, 36).Value = sWord44    
21296  |            End If                                ||20870  |            End If                                
21297  |                                                  ||20871  |                                                  
21298  |            '支払額                               ||20872  |            '支払額                               
21299  |            .Cells(48, 2).Value = sWord46a        ||20873  |            .Cells(48, 2).Value = sWord46a        
21300  |            '文言の冗長化でピリオド及び、名称を二 ||20874  |            '文言の冗長化でピリオド及び、名称を二 
21301  |            .Cells(48, 13).Value = sWord19        ||20875  |            .Cells(48, 13).Value = sWord19        
21302  |                                                  ||20876  |                                                  
21303  |            '税抜金額(月別支払顧問料の累計)       ||20877  |            '税抜金額(月別支払顧問料の累計)       
21304  |            '文言の冗長化でピリオド及び、名称を二 ||20878  |            '文言の冗長化でピリオド及び、名称を二 
21305  |            .Cells(48, 31).NumberFormatLocal = "@"||20879  |            .Cells(48, 31).NumberFormatLocal = "@"
21306  |            .Cells(48, 31).Value = CStr(Format(mst||20880  |            .Cells(48, 31).Value = CStr(Format(mst
21307  |            .Cells(48, 31).HorizontalAlignment = x||20881  |            .Cells(48, 31).HorizontalAlignment = x
21308  |            .Cells(48, 34).Value = sYena          ||20882  |            .Cells(48, 34).Value = sYena          
21309  |                                                  ||20883  |                                                  
21310  |        '消費税計算有無：「有り」の場合のみ、消費 ||20884  |        '消費税計算有無：「有り」の場合のみ、消費 
21311  |        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc_||20885  |        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc_
21312  |            '(消費税XX%)                          ||20886  |            '(消費税XX%)                          
21313  |            '文言の冗長化でピリオド及び、名称を二 ||20887  |            '文言の冗長化でピリオド及び、名称を二 
21314  |            iSyouhizei = ddblconsumption_tax      ||20888  |            iSyouhizei = ddblconsumption_tax      
21315  |            .Cells(49, 34).Value = sWord22a & iSyo||20889  |            .Cells(49, 34).Value = sWord22a & iSyo
21316  |            dblValueIn = mstrMonthlyPayCom * iSyou||20890  |            dblValueIn = mstrMonthlyPayCom * iSyou
21317  |            Call sbGetRoundValueTax(dblValueIn)   ||20891  |            Call sbGetRoundValueTax(dblValueIn)   
21318  |            lTaxNum = dblValueOut                 ||20892  |            lTaxNum = dblValueOut                 
21319  |            '文言の冗長化でピリオド及び、名称を二 ||20893  |            '文言の冗長化でピリオド及び、名称を二 
21320  |            .Cells(49, 31).NumberFormatLocal = "@"||20894  |            .Cells(49, 31).NumberFormatLocal = "@"
21321  |            .Cells(49, 31).Value = CStr(Format((lT||20895  |            .Cells(49, 31).Value = CStr(Format((lT
21322  |            .Cells(49, 31).HorizontalAlignment = x||20896  |            .Cells(49, 31).HorizontalAlignment = x
21323  |            '合計(消費税＋月別支払顧問料の累計)   ||20897  |            '合計(消費税＋月別支払顧問料の累計)   
21324  |            '文言の冗長化でピリオド及び、名称を二 ||20898  |            '文言の冗長化でピリオド及び、名称を二 
21325  |            .Cells(50, 15).Value = sWord24a       ||20899  |            .Cells(50, 15).Value = sWord24a       
21326  |            dblValueIn = lTaxNum + CCur(mstrMonthl||20900  |            dblValueIn = lTaxNum + CCur(mstrMonthl
21327  |            Call sbGetRoundValue(dblValueIn)      ||20901  |            Call sbGetRoundValue(dblValueIn)      
21328  |            lMonthlyPayCom = dblValueOut          ||20902  |            lMonthlyPayCom = dblValueOut          
21329  |            '文言の冗長化でピリオド及び、名称を二 ||20903  |            '文言の冗長化でピリオド及び、名称を二 
21330  |            .Cells(50, 31).NumberFormatLocal = "@"||20904  |            .Cells(50, 31).NumberFormatLocal = "@"
21331  |            .Cells(50, 31).Value = CStr(Format(lMo||20905  |            .Cells(50, 31).Value = CStr(Format(lMo
21332  |            .Cells(50, 31).HorizontalAlignment = x||20906  |            .Cells(50, 31).HorizontalAlignment = x
21333  |            '円                                   ||20907  |            '円                                   
21334  |            .Cells(50, 34).Value = sYena          ||20908  |            .Cells(50, 34).Value = sYena          
21335  |            '下線                                 ||20909  |            '下線                                 
21336  |            '文言の冗長化でピリオド及び、名称を二 ||20910  |            '文言の冗長化でピリオド及び、名称を二 
21337  |            With xlSheet.Range("O49:AN49").Borders||20911  |            With xlSheet.Range("O49:AN49").Borders
21338  |                .LineStyle = xlContinuous         ||20912  |                .LineStyle = xlContinuous         
21339  |                .Weight = xlThin                  ||20913  |                .Weight = xlThin                  
21340  |            End With                              ||20914  |            End With                              
21341  |        Else                                      ||20915  |        Else                                      
21342  |        End If                                    ||20916  |        End If                                    
21343  |                                                  ||20917  |                                                  
21344  |        '支払予定日                               ||20918  |        '支払予定日                               
21345  |        '文言の冗長化でピリオド及び、名称を二列右 ||20919  |        '文言の冗長化でピリオド及び、名称を二列右 
21346  |        .Cells(52, 2).Value = sWord13a            ||20920  |        .Cells(52, 2).Value = sWord13a            
21347  |        .Cells(52, 13).Value = sWord19            ||20921  |        .Cells(52, 13).Value = sWord19            
21348  |        .Cells(52, 15).NumberFormatLocal = "@"    ||20922  |        .Cells(52, 15).NumberFormatLocal = "@"    
21349  |        .Cells(52, 15).Value = CStr(Format(Trim(ms||20923  |        .Cells(52, 15).Value = CStr(Format(Trim(ms
21350  |                                                  ||20924  |                                                  
21351  |        '支払先                                   ||20925  |        '支払先                                   
21352  |        '文言の冗長化でピリオド及び、名称を二列右 ||20926  |        '文言の冗長化でピリオド及び、名称を二列右 
21353  |        .Cells(54, 2).Value = sWord12a            ||20927  |        .Cells(54, 2).Value = sWord12a            
21354  |        .Cells(54, 13).Value = sWord19            ||20928  |        .Cells(54, 13).Value = sWord19            
21355  |        .Cells(54, 15).Value = gbuMGetUPDRec.N(lRe||20929  |        .Cells(54, 15).Value = gbuMGetUPDRec.N(lRe
21356  |                                                  ||20930  |                                                  
21357  |        '財務部                                   ||20931  |        '財務部                                   
21358  |        .Cells(60, 2).Value = sWord1a             ||20932  |        .Cells(60, 2).Value = sWord1a             
21359  |        .Cells(61, 2).Value = sWord2a             ||20933  |        .Cells(61, 2).Value = sWord2a             
21360  |                                                  ||20934  |                                                  
21361  |    End With                                      ||20935  |    End With                                      
21362  |                                                  ||20936  |                                                  
21363  |    '月末純資産(合計 上のライン)                  ||20937  |    '月末純資産(合計 上のライン)                  
21364  |    With xlSheet.Range("X39:AX40").Borders(xlInsid||20938  |    With xlSheet.Range("X39:AX40").Borders(xlInsid
21365  |        .LineStyle = xlContinuous                 ||20939  |        .LineStyle = xlContinuous                 
21366  |        .Weight = xlThin                          ||20940  |        .Weight = xlThin                          
21367  |    End With                                      ||20941  |    End With                                      
21368  |                                                  ||20942  |                                                  
21369  |    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract_||20943  |    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract_
21370  |    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||20944  |    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
21371  |                                                  ||20945  |                                                  
21372  |        '文言の冗長化でピリオド及び、名称を二列右 ||20946  |        '文言の冗長化でピリオド及び、名称を二列右 
21373  |        xlSheet.Cells(13, 15).Value = _           ||20947  |        xlSheet.Cells(13, 15).Value = _           
21374  |            CStr(Format(dStart, "mmmm d , yyyy")) ||20948  |            CStr(Format(dStart, "mmmm d , yyyy")) 
21375  |    Else                                          ||20949  |    Else                                          
21376  |        '文言の冗長化でピリオド及び、名称を二列右 ||20950  |        '文言の冗長化でピリオド及び、名称を二列右 
21377  |        xlSheet.Cells(13, 15).Value = _           ||20951  |        xlSheet.Cells(13, 15).Value = _           
21378  |            CStr(Format(dStart, "mmmm d , yyyy")) ||20952  |            CStr(Format(dStart, "mmmm d , yyyy")) 
21379  |    End If                                        ||20953  |    End If                                        
21380  |                                                  ||20954  |                                                  
21381  |    'A4印刷用に上2行を削除して、プレビュー範囲内に||20955  |    'A4印刷用に上2行を削除して、プレビュー範囲内に
21382  |    xlSheet.Rows("1:2").Delete Shift:=xlUp        ||20956  |    xlSheet.Rows("1:2").Delete Shift:=xlUp        
21383  |                                                  ||20957  |                                                  
21384  |'=================================================||20958  |'=================================================
21385  |'== 　　　　日次NAV/日時時価総額の別表作成エリア  ||20959  |'== 　　　　日次NAV/日時時価総額の別表作成エリア  
21386  |'=================================================||20960  |'=================================================
21387  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||20961  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
21388  |''NAV取得区分：日次NAV平均(休日有)または日次NAV平 ||20962  |''NAV取得区分：日次NAV平均(休日有)または日次NAV平 
21389  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||20963  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
21390  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||20964  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
21391  |    'NAV取得区分：日次NAV平均(休日有)、日次NAV平均||20965  |    'NAV取得区分：日次NAV平均(休日有)、日次NAV平均
21392  |    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag ||20966  |    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag 
21393  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||20967  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
21394  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||20968  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
21395  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||20969  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
21396  |                                                  ||20970  |                                                  
21397  |        gTotalDnavCnt = 0                         ||20971  |        gTotalDnavCnt = 0                         
21398  |        J = 0                                     ||20972  |        J = 0                                     
21399  |        K = 0                                     ||20973  |        K = 0                                     
21400  |        '＋２は合計行と平均行                     ||20974  |        '＋２は合計行と平均行                     
21401  |        dintPage = (dlngCnt + 2) \ 108            ||20975  |        dintPage = (dlngCnt + 2) \ 108            
21402  |        dintAmari = (dlngCnt + 2) Mod 108         ||20976  |        dintAmari = (dlngCnt + 2) Mod 108         
21403  |        If dintAmari <> 0 Then                    ||20977  |        If dintAmari <> 0 Then                    
21404  |            dintPage = dintPage + 1               ||20978  |            dintPage = dintPage + 1               
21405  |        End If                                    ||20979  |        End If                                    
21406  |                                                  ||20980  |                                                  
21407  |        For L = 1 To dintPage                     ||20981  |        For L = 1 To dintPage                     
21408  |                                                  ||20982  |                                                  
21409  |            xlBook.Worksheets.Add after:=xlBook.Sh||20983  |            xlBook.Worksheets.Add after:=xlBook.Sh
21410  |            gProcessCnt = gProcessCnt + 1         ||20984  |            gProcessCnt = gProcessCnt + 1         
21411  |            Set xlSheet = xlBook.Sheets(gProcessCn||20985  |            Set xlSheet = xlBook.Sheets(gProcessCn
21412  |                                                  ||20986  |                                                  
21413  |            'Excelフォーマットを調整              ||20987  |            'Excelフォーマットを調整              
21414  |            xlSheet.Cells.ColumnWidth = 1         ||20988  |            xlSheet.Cells.ColumnWidth = 1         
21415  |            xlSheet.Cells.Font.Size = 11          ||20989  |            xlSheet.Cells.Font.Size = 11          
21416  |            'シート名を設定(日次NAV一覧**)        ||20990  |            'シート名を設定(日次NAV一覧**)        
21417  |                                                  ||20991  |                                                  
21418  |            'RAFI対応 START                       ||20992  |            'RAFI対応 START                       
21419  |            '純資産の場合                         ||20993  |            '純資産の場合                         
21420  |            If msAssetFlg = "0" Then              ||20994  |            If msAssetFlg = "0" Then              
21421  |                If dstrOldAccCode = sGetAccCode Th||20995  |                If dstrOldAccCode = sGetAccCode Th
21422  |                    gTotalDnavCnt = gTotalDnavCnt ||20996  |                    gTotalDnavCnt = gTotalDnavCnt 
21423  |                Else                              ||20997  |                Else                              
21424  |                    gTotalDnavCnt = 1             ||20998  |                    gTotalDnavCnt = 1             
21425  |                    dstrOldAccCode = sGetAccCode  ||20999  |                    dstrOldAccCode = sGetAccCode  
21426  |                End If                            ||21000  |                End If                            
21427  |            'マザー組入資産の場合                 ||21001  |            'マザー組入資産の場合                 
21428  |            Else                                  ||21002  |            Else                                  
21429  |                If dstrOldAccCode = msBabyAccountC||21003  |                If dstrOldAccCode = msBabyAccountC
21430  |                    gTotalDnavCnt = gTotalDnavCnt ||21004  |                    gTotalDnavCnt = gTotalDnavCnt 
21431  |                Else                              ||21005  |                Else                              
21432  |                    gTotalDnavCnt = 1             ||21006  |                    gTotalDnavCnt = 1             
21433  |                    dstrOldAccCode = msBabyAccount||21007  |                    dstrOldAccCode = msBabyAccount
21434  |                End If                            ||21008  |                End If                            
21435  |            End If                                ||21009  |            End If                                
21436  |            'RAFI対応 END                         ||21010  |            'RAFI対応 END                         
21437  |                                                  ||21011  |                                                  
21438  |            'gTotalCnt = gTotalCnt + 1            ||21012  |            'gTotalCnt = gTotalCnt + 1            
21439  |            'RAFI対応 START                       ||21013  |            'RAFI対応 START                       
21440  |            '純資産の場合                         ||21014  |            '純資産の場合                         
21441  |            If msAssetFlg = "0" Then              ||21015  |            If msAssetFlg = "0" Then              
21442  |                '複数ページの場合                 ||21016  |                '複数ページの場合                 
21443  |                If dintPage > 1 Then              ||21017  |                If dintPage > 1 Then              
21444  |                    xlBook.Sheets(gProcessCnt).Nam||21018  |                    xlBook.Sheets(gProcessCnt).Nam
21445  |                Else                              ||21019  |                Else                              
21446  |                    xlBook.Sheets(gProcessCnt).Nam||21020  |                    xlBook.Sheets(gProcessCnt).Nam
21447  |                End If                            ||21021  |                End If                            
21448  |            'マザー組入資産の場合                 ||21022  |            'マザー組入資産の場合                 
21449  |            Else                                  ||21023  |            Else                                  
21450  |                '複数ページの場合                 ||21024  |                '複数ページの場合                 
21451  |                If dintPage > 1 Then              ||21025  |                If dintPage > 1 Then              
21452  |                    xlBook.Sheets(gProcessCnt).Nam||21026  |                    xlBook.Sheets(gProcessCnt).Nam
21453  |                Else                              ||21027  |                Else                              
21454  |                    xlBook.Sheets(gProcessCnt).Nam||21028  |                    xlBook.Sheets(gProcessCnt).Nam
21455  |                End If                            ||21029  |                End If                            
21456  |            End If                                ||21030  |            End If                                
21457  |            'RAFI対応 END                         ||21031  |            'RAFI対応 END                         
21458  |                                                  ||21032  |                                                  
21459  |                                                  ||21033  |                                                  
21460  |            'シートの余白を設定                   ||21034  |            'シートの余白を設定                   
21461  |            xlSheet.PageSetup.TopMargin = Applicat||21035  |            xlSheet.PageSetup.TopMargin = Applicat
21462  |            xlSheet.PageSetup.BottomMargin = Appli||21036  |            xlSheet.PageSetup.BottomMargin = Appli
21463  |            xlSheet.PageSetup.LeftMargin = Applica||21037  |            xlSheet.PageSetup.LeftMargin = Applica
21464  |            xlSheet.PageSetup.RightMargin = Applic||21038  |            xlSheet.PageSetup.RightMargin = Applic
21465  |                                                  ||21039  |                                                  
21466  |            DoEvents                              ||21040  |            DoEvents                              
21467  |                                                  ||21041  |                                                  
21468  |            With xlSheet                          ||21042  |            With xlSheet                          
21469  |                '題目                             ||21043  |                '題目                             
21470  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||21044  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
21471  |                '取得NAV区分が4:日次時価総額平均の||21045  |                '取得NAV区分が4:日次時価総額平均の
21472  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||21046  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
21473  |                    .Cells(5, 1).Value = sWord68a ||21047  |                    .Cells(5, 1).Value = sWord68a 
21474  |                Else                              ||21048  |                Else                              
21475  |                    .Cells(5, 1).Value = sWord47a ||21049  |                    .Cells(5, 1).Value = sWord47a 
21476  |                End If                            ||21050  |                End If                            
21477  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||21051  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
21478  |                .Cells(5, 1).Font.Size = 14       ||21052  |                .Cells(5, 1).Font.Size = 14       
21479  |                .Range("A5:BG5").HorizontalAlignme||21053  |                .Range("A5:BG5").HorizontalAlignme
21480  |                '出力日付                         ||21054  |                '出力日付                         
21481  |                If RTrim(txtSysOutDate.Text) = "" ||21055  |                If RTrim(txtSysOutDate.Text) = "" 
21482  |                    .Cells(3, 50).NumberFormatLoca||21056  |                    .Cells(3, 50).NumberFormatLoca
21483  |                    .Cells(3, 50).Value = sWord34a||21057  |                    .Cells(3, 50).Value = sWord34a
21484  |                    .Cells(3, 50).HorizontalAlignm||21058  |                    .Cells(3, 50).HorizontalAlignm
21485  |                Else                              ||21059  |                Else                              
21486  |                    .Cells(3, 43).NumberFormatLoca||21060  |                    .Cells(3, 43).NumberFormatLoca
21487  |                    .Cells(3, 43).Value = CStr(For||21061  |                    .Cells(3, 43).Value = CStr(For
21488  |                End If                            ||21062  |                End If                            
21489  |                'ファンド名                       ||21063  |                'ファンド名                       
21490  |                .Cells(6, 2).Value = sWord4a      ||21064  |                .Cells(6, 2).Value = sWord4a      
21491  |                .Cells(6, 11).Value = sWord19     ||21065  |                .Cells(6, 11).Value = sWord19     
21492  |                .Cells(6, 13).Value = gbuMGetUPDRe||21066  |                .Cells(6, 13).Value = gbuMGetUPDRe
21493  |                'ファンドコード                   ||21067  |                'ファンドコード                   
21494  |                .Cells(7, 2).Value = sWord4_2a    ||21068  |                .Cells(7, 2).Value = sWord4_2a    
21495  |                .Cells(7, 11).Value = sWord19     ||21069  |                .Cells(7, 11).Value = sWord19     
21496  |                .Cells(7, 13).NumberFormatLocal = ||21070  |                .Cells(7, 13).NumberFormatLocal = 
21497  |                .Cells(7, 13).Value = sGetAccCode ||21071  |                .Cells(7, 13).Value = sGetAccCode 
21498  |                '計算期間                         ||21072  |                '計算期間                         
21499  |                '文言変更                         ||21073  |                '文言変更                         
21500  |'                .Cells(8, 2).Value = sWord5a     ||21074  |'                .Cells(8, 2).Value = sWord5a     
21501  |                .Cells(8, 2).Value = sWord59a     ||21075  |                .Cells(8, 2).Value = sWord59a     
21502  |                .Cells(8, 11).Value = sWord19     ||21076  |                .Cells(8, 11).Value = sWord19     
21503  |                                                  ||21077  |                                                  
21504  |                If Mid(gbuMGetUPDRec.N(lRecIdx).MG||21078  |                If Mid(gbuMGetUPDRec.N(lRecIdx).MG
21505  |                And gbuMGetUPDRec.N(lRecIdx).MGET_||21079  |                And gbuMGetUPDRec.N(lRecIdx).MGET_
21506  |                    .Cells(8, 13).Value = _       ||21080  |                    .Cells(8, 13).Value = _       
21507  |                        CStr(Format(dStart, "mmmm ||21081  |                        CStr(Format(dStart, "mmmm 
21508  |                Else                              ||21082  |                Else                              
21509  |                    .Cells(8, 13).Value = _       ||21083  |                    .Cells(8, 13).Value = _       
21510  |                        CStr(Format(dStart, "mmmm ||21084  |                        CStr(Format(dStart, "mmmm 
21511  |                End If                            ||21085  |                End If                            
21512  |                                                  ||21086  |                                                  
21513  |                '日付                             ||21087  |                '日付                             
21514  |                .Cells(10, 3).Value = sWord7a     ||21088  |                .Cells(10, 3).Value = sWord7a     
21515  |                .Range("C10:N10").HorizontalAlignm||21089  |                .Range("C10:N10").HorizontalAlignm
21516  |                '純資産                           ||21090  |                '純資産                           
21517  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||21091  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
21518  |                '取得NAV区分が4:日次時価総額平均の||21092  |                '取得NAV区分が4:日次時価総額平均の
21519  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||21093  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
21520  |                    .Cells(10, 15).Value = sWord64||21094  |                    .Cells(10, 15).Value = sWord64
21521  |                Else                              ||21095  |                Else                              
21522  |                    .Cells(10, 15).Value = sWord8a||21096  |                    .Cells(10, 15).Value = sWord8a
21523  |                End If                            ||21097  |                End If                            
21524  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||21098  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
21525  |                .Range("O10:AC10").HorizontalAlign||21099  |                .Range("O10:AC10").HorizontalAlign
21526  |                '日付                             ||21100  |                '日付                             
21527  |                .Cells(10, 31).Value = sWord7a    ||21101  |                .Cells(10, 31).Value = sWord7a    
21528  |                .Range("AE10:AP10").HorizontalAlig||21102  |                .Range("AE10:AP10").HorizontalAlig
21529  |                '純資産                           ||21103  |                '純資産                           
21530  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||21104  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
21531  |                '取得NAV区分が4:日次時価総額平均の||21105  |                '取得NAV区分が4:日次時価総額平均の
21532  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||21106  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
21533  |                    .Cells(10, 43).Value = sWord64||21107  |                    .Cells(10, 43).Value = sWord64
21534  |                Else                              ||21108  |                Else                              
21535  |                    .Cells(10, 43).Value = sWord8a||21109  |                    .Cells(10, 43).Value = sWord8a
21536  |                End If                            ||21110  |                End If                            
21537  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||21111  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
21538  |                .Range("AQ10:BE10").HorizontalAlig||21112  |                .Range("AQ10:BE10").HorizontalAlig
21539  |                '日付＆NAV                        ||21113  |                '日付＆NAV                        
21540  |                Select Case L                     ||21114  |                Select Case L                     
21541  |                    Case 1                        ||21115  |                    Case 1                        
21542  |                        dintPageIni = 1           ||21116  |                        dintPageIni = 1           
21543  |                    Case Else                     ||21117  |                    Case Else                     
21544  |                        dintPageIni = dintPageIni ||21118  |                        dintPageIni = dintPageIni 
21545  |                End Select                        ||21119  |                End Select                        
21546  |                For dintFor = dintPageIni To dlngC||21120  |                For dintFor = dintPageIni To dlngC
21547  |                    If J < 54 Then                ||21121  |                    If J < 54 Then                
21548  |                        If dintFor = dlngCnt + 1 T||21122  |                        If dintFor = dlngCnt + 1 T
21549  |                            '合計                 ||21123  |                            '合計                 
21550  |                            .Cells(11 + J, 3).Valu||21124  |                            .Cells(11 + J, 3).Valu
21551  |                            'NAV                  ||21125  |                            'NAV                  
21552  |                            .Cells(11 + J, 28).Num||21126  |                            .Cells(11 + J, 28).Num
21553  |                            If gbuMGetUPDRec.N(lRe||21127  |                            If gbuMGetUPDRec.N(lRe
21554  |                                .Cells(11 + J, 28)||21128  |                                .Cells(11 + J, 28)
21555  |                            Else                  ||21129  |                            Else                  
21556  |                                .Cells(11 + J, 28)||21130  |                                .Cells(11 + J, 28)
21557  |                            End If                ||21131  |                            End If                
21558  |                            .Cells(11 + J, 28).Hor||21132  |                            .Cells(11 + J, 28).Hor
21559  |                        End If                    ||21133  |                        End If                    
21560  |                                                  ||21134  |                                                  
21561  |                            If dintFor = dlngCnt +||21135  |                            If dintFor = dlngCnt +
21562  |                                '平均             ||21136  |                                '平均             
21563  |                                .Cells(11 + J, 3).||21137  |                                .Cells(11 + J, 3).
21564  |                                'NAV              ||21138  |                                'NAV              
21565  |                                .Cells(11 + J, 28)||21139  |                                .Cells(11 + J, 28)
21566  |                                If gbuMGetUPDRec.N||21140  |                                If gbuMGetUPDRec.N
21567  |                                    .Cells(11 + J,||21141  |                                    .Cells(11 + J,
21568  |                                Else              ||21142  |                                Else              
21569  |                                    .Cells(11 + J,||21143  |                                    .Cells(11 + J,
21570  |                                End If            ||21144  |                                End If            
21571  |                                .Cells(11 + J, 28)||21145  |                                .Cells(11 + J, 28)
21572  |                            End If                ||21146  |                            End If                
21573  |                                                  ||21147  |                                                  
21574  |                        If dintFor < dlngCnt + 1 T||21148  |                        If dintFor < dlngCnt + 1 T
21575  |                            '日付                 ||21149  |                            '日付                 
21576  |                            .Cells(11 + J, 4).Numb||21150  |                            .Cells(11 + J, 4).Numb
21577  |                            .Cells(11 + J, 4).Valu||21151  |                            .Cells(11 + J, 4).Valu
21578  |                                        CDate(gstr||21152  |                                        CDate(gstr
21579  |                            'NAV                  ||21153  |                            'NAV                  
21580  |                            .Cells(11 + J, 28).Num||21154  |                            .Cells(11 + J, 28).Num
21581  |                            If gbuMGetUPDRec.N(lRe||21155  |                            If gbuMGetUPDRec.N(lRe
21582  |                                .Cells(11 + J, 28)||21156  |                                .Cells(11 + J, 28)
21583  |                            Else                  ||21157  |                            Else                  
21584  |                                .Cells(11 + J, 28)||21158  |                                .Cells(11 + J, 28)
21585  |                            End If                ||21159  |                            End If                
21586  |                            .Cells(11 + J, 28).Hor||21160  |                            .Cells(11 + J, 28).Hor
21587  |                        End If                    ||21161  |                        End If                    
21588  |                    Else                          ||21162  |                    Else                          
21589  |                        If dintFor = dlngCnt + 1 T||21163  |                        If dintFor = dlngCnt + 1 T
21590  |                            '合計                 ||21164  |                            '合計                 
21591  |                            .Cells(11 + K, 31).Val||21165  |                            .Cells(11 + K, 31).Val
21592  |                            'NAV                  ||21166  |                            'NAV                  
21593  |                            .Cells(11 + K, 56).Num||21167  |                            .Cells(11 + K, 56).Num
21594  |                            If gbuMGetUPDRec.N(lRe||21168  |                            If gbuMGetUPDRec.N(lRe
21595  |                                .Cells(11 + K, 56)||21169  |                                .Cells(11 + K, 56)
21596  |                            Else                  ||21170  |                            Else                  
21597  |                                .Cells(11 + K, 56)||21171  |                                .Cells(11 + K, 56)
21598  |                            End If                ||21172  |                            End If                
21599  |                            .Cells(11 + K, 56).Hor||21173  |                            .Cells(11 + K, 56).Hor
21600  |                        End If                    ||21174  |                        End If                    
21601  |                                                  ||21175  |                                                  
21602  |                            If dintFor = dlngCnt +||21176  |                            If dintFor = dlngCnt +
21603  |                                '平均             ||21177  |                                '平均             
21604  |                                .Cells(11 + K, 31)||21178  |                                .Cells(11 + K, 31)
21605  |                                'NAV              ||21179  |                                'NAV              
21606  |                                .Cells(11 + K, 56)||21180  |                                .Cells(11 + K, 56)
21607  |                                If gbuMGetUPDRec.N||21181  |                                If gbuMGetUPDRec.N
21608  |                                    .Cells(11 + K,||21182  |                                    .Cells(11 + K,
21609  |                                Else              ||21183  |                                Else              
21610  |                                    .Cells(11 + K,||21184  |                                    .Cells(11 + K,
21611  |                                End If            ||21185  |                                End If            
21612  |                                .Cells(11 + K, 56)||21186  |                                .Cells(11 + K, 56)
21613  |                            End If                ||21187  |                            End If                
21614  |                                                  ||21188  |                                                  
21615  |                        If dintFor < dlngCnt + 1 T||21189  |                        If dintFor < dlngCnt + 1 T
21616  |                            '日付                 ||21190  |                            '日付                 
21617  |                                                  ||21191  |                                                  
21618  |                            .Cells(11 + K, 32).Num||21192  |                            .Cells(11 + K, 32).Num
21619  |                            .Cells(11 + K, 32).Val||21193  |                            .Cells(11 + K, 32).Val
21620  |                                        CDate(gstr||21194  |                                        CDate(gstr
21621  |                            'NAV                  ||21195  |                            'NAV                  
21622  |                            .Cells(11 + K, 56).Num||21196  |                            .Cells(11 + K, 56).Num
21623  |                            If gbuMGetUPDRec.N(lRe||21197  |                            If gbuMGetUPDRec.N(lRe
21624  |                                .Cells(11 + K, 56)||21198  |                                .Cells(11 + K, 56)
21625  |                            Else                  ||21199  |                            Else                  
21626  |                                .Cells(11 + K, 56)||21200  |                                .Cells(11 + K, 56)
21627  |                            End If                ||21201  |                            End If                
21628  |                            .Cells(11 + K, 56).Hor||21202  |                            .Cells(11 + K, 56).Hor
21629  |                        End If                    ||21203  |                        End If                    
21630  |                        K = K + 1                 ||21204  |                        K = K + 1                 
21631  |                        If K > 53 Then            ||21205  |                        If K > 53 Then            
21632  |                            J = 0                 ||21206  |                            J = 0                 
21633  |                            K = 0                 ||21207  |                            K = 0                 
21634  |                            Exit For              ||21208  |                            Exit For              
21635  |                        End If                    ||21209  |                        End If                    
21636  |                    End If                        ||21210  |                    End If                        
21637  |                    J = J + 1                     ||21211  |                    J = J + 1                     
21638  |                Next dintFor                      ||21212  |                Next dintFor                      
21639  |                                                  ||21213  |                                                  
21640  |            End With                              ||21214  |            End With                              
21641  |            'A4印刷用に上2行を削除して、プレビュー||21215  |            'A4印刷用に上2行を削除して、プレビュー
21642  |            xlSheet.Rows("1:2").Delete Shift:=xlUp||21216  |            xlSheet.Rows("1:2").Delete Shift:=xlUp
21643  |        Next L                                    ||21217  |        Next L                                    
21644  |    End If                                        ||21218  |    End If                                        
21645  |                                                  ||21219  |                                                  
21646  |    '正常戻り値セット                             ||21220  |    '正常戻り値セット                             
21647  |    fnblExcelEnglishOut_NotChgRate = True         ||21221  |    fnblExcelEnglishOut_NotChgRate = True         
21648  |    GoTo EndProc                                  ||21222  |    GoTo EndProc                                  
21649  |                                                  ||21223  |                                                  
21650  |ErrorTrap:                                        ||21224  |ErrorTrap:                                        
21651  |    ' Excel を起動できない場合に発生するエラーをト||21225  |    ' Excel を起動できない場合に発生するエラーをト
21652  |    Select Case Err.Number                        ||21226  |    Select Case Err.Number                        
21653  |        Case 440               ' オートメーション ||21227  |        Case 440               ' オートメーション 
21654  |            iTries = iTries + 1                   ||21228  |            iTries = iTries + 1                   
21655  |            ' Excel の再起動を 5 回まで行います。 ||21229  |            ' Excel の再起動を 5 回まで行います。 
21656  |            If iTries < 5 Then                    ||21230  |            If iTries < 5 Then                    
21657  |               Set xlApp = New Excel.Application  ||21231  |               Set xlApp = New Excel.Application  
21658  |               Resume                             ||21232  |               Resume                             
21659  |            Else                                  ||21233  |            Else                                  
21660  |               Err.Raise Number:=vbObjectError + 2||21234  |               Err.Raise Number:=vbObjectError + 2
21661  |               Description:="Microsoft Excel を起 ||21235  |               Description:="Microsoft Excel を起 
21662  |            End If                                ||21236  |            End If                                
21663  |        Case Else                                 ||21237  |        Case Else                                 
21664  |    End Select                                    ||21238  |    End Select                                    
21665  |                                                  ||21239  |                                                  
21666  |    'Workbookを閉じる                             ||21240  |    'Workbookを閉じる                             
21667  |    xlBook.Close                                  ||21241  |    xlBook.Close                                  
21668  |                                                  ||21242  |                                                  
21669  |    'Excel終了                                    ||21243  |    'Excel終了                                    
21670  |    xlApp.Quit                                    ||21244  |    xlApp.Quit                                    
21671  |                                                  ||21245  |                                                  
21672  |    'オブジェクトの解放                           ||21246  |    'オブジェクトの解放                           
21673  |    Set xlApp = Nothing                           ||21247  |    Set xlApp = Nothing                           
21674  |    Set xlBook = Nothing                          ||21248  |    Set xlBook = Nothing                          
21675  |    Set xlSheet = Nothing                         ||21249  |    Set xlSheet = Nothing                         
21676  |                                                  ||21250  |                                                  
21677  |OnErrorProc:                                      ||21251  |OnErrorProc:                                      
21678  |    Call subError("システムエラー", Str(Err.Number||21252  |    Call subError("システムエラー", Str(Err.Number
21679  |        Error, strErrCall, conTitle)              ||21253  |        Error, strErrCall, conTitle)              
21680  |    'マウスポインター元に戻す                     ||21254  |    'マウスポインター元に戻す                     
21681  |    Screen.MousePointer = vbDefault               ||21255  |    Screen.MousePointer = vbDefault               
21682  |    GoTo EndProc                                  ||21256  |    GoTo EndProc                                  
21683  |                                                  ||21257  |                                                  
21684  |EndProc:                                          ||21258  |EndProc:                                          
21685  |                                                  ||21259  |                                                  
21686  |End Function                                      ||21260  |End Function                                      
21687  |                                                  ||21261  |                                                  
21688  |'=================================================||21262  |'=================================================
21689  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelEnglishOut_ChangeRat||21263  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   fnblExcelEnglishOut_ChangeRat
21690  |'機能            :   確認書(英文)のExcel出力(料率 ||21264  |'機能            :   確認書(英文)のExcel出力(料率 
21691  |'                                                 ||21265  |'                                                 
21692  |'日付               担当　              修正内容  ||21266  |'日付               担当　              修正内容  
21693  |'-------------------------------------------------||21267  |'-------------------------------------------------
21694  |'2006/08/18         K.Furuya <SRA>     RAFI対応   ||21268  |'2006/08/18         K.Furuya <SRA>     RAFI対応   
21695  |'                                      fnblExcelEn||21269  |'                                      fnblExcelEn
21696  |'2008/02/20         K.Furuya <SRA>     時価総額基 ||21270  |'2008/02/20         K.Furuya <SRA>     時価総額基 
21697  |'=================================================||21271  |'=================================================
21698  |Private Function fnblExcelEnglishOut_ChangeRate( _||21272  |Private Function fnblExcelEnglishOut_ChangeRate( _
21699  |    ByVal lRecIdx As Long _                       ||21273  |    ByVal lRecIdx As Long _                       
21700  |) As Boolean                                      ||21274  |) As Boolean                                      
21701  |                                                  ||21275  |                                                  
21702  |    Dim dStart      As Date     '計算期間　開始日 ||21276  |    Dim dStart      As Date     '計算期間　開始日 
21703  |    Dim dEnd        As Date     '計算期間　終了日 ||21277  |    Dim dEnd        As Date     '計算期間　終了日 
21704  |    Dim sSql        As String                     ||21278  |    Dim sSql        As String                     
21705  |    Dim sCurrencyCode As String '通貨コード(SQL文 ||21279  |    Dim sCurrencyCode As String '通貨コード(SQL文 
21706  |    Dim AccCode     As String   '口座コード(SQL文 ||21280  |    Dim AccCode     As String   '口座コード(SQL文 
21707  |    Dim sDate       As Date     '支払予定日       ||21281  |    Dim sDate       As Date     '支払予定日       
21708  |    Dim sName       As String   '担当者名         ||21282  |    Dim sName       As String   '担当者名         
21709  |    Dim i           As Integer  'カウンター       ||21283  |    Dim i           As Integer  'カウンター       
21710  |    Dim ColNum      As Integer  '部署名コンボボッ ||21284  |    Dim ColNum      As Integer  '部署名コンボボッ 
21711  |    Dim ColWord     As String   '部署名コンボボッ ||21285  |    Dim ColWord     As String   '部署名コンボボッ 
21712  |    Dim iSyouhizei  As Long     '消費税           ||21286  |    Dim iSyouhizei  As Long     '消費税           
21713  |    Dim iRowCnt     As Long     '月末純資産データ ||21287  |    Dim iRowCnt     As Long     '月末純資産データ 
21714  |    Dim TotalNav    As Currency '累積NAV          ||21288  |    Dim TotalNav    As Currency '累積NAV          
21715  |    Dim TotalRate   As Currency '累積閾値         ||21289  |    Dim TotalRate   As Currency '累積閾値         
21716  |    Dim cRate       As Currency '料率             ||21290  |    Dim cRate       As Currency '料率             
21717  |    Dim WorkRate    As Currency '一つ前の累積閾値 ||21291  |    Dim WorkRate    As Currency '一つ前の累積閾値 
21718  |    Dim TotalCom    As Currency '累積投資顧問料   ||21292  |    Dim TotalCom    As Currency '累積投資顧問料   
21719  |    Dim lTaxNum     As Currency '消費税値         ||21293  |    Dim lTaxNum     As Currency '消費税値         
21720  |    Dim lMonthlyPayCom As Currency  '月別支払額   ||21294  |    Dim lMonthlyPayCom As Currency  '月別支払額   
21721  |    Dim lCalcNav    As Currency '計算対象NAV      ||21295  |    Dim lCalcNav    As Currency '計算対象NAV      
21722  |    Dim iCalcNum    As Integer  '計算期間日数     ||21296  |    Dim iCalcNum    As Integer  '計算期間日数     
21723  |    'Excel の Application 変数とエラーをトラップす||21297  |    'Excel の Application 変数とエラーをトラップす
21724  |    Dim iTries      As Integer                    ||21298  |    Dim iTries      As Integer                    
21725  |    Dim strErrCall      As String 'エラー呼出元   ||21299  |    Dim strErrCall      As String 'エラー呼出元   
21726  |    Const conMeModule   As String = "fnblExcelEngl||21300  |    Const conMeModule   As String = "fnblExcelEngl
21727  |    'Excel の Worksheet 削除用カウンタ変数        ||21301  |    'Excel の Worksheet 削除用カウンタ変数        
21728  |    Dim Ws_Cnt      As Integer                    ||21302  |    Dim Ws_Cnt      As Integer                    
21729  |    Dim Ws_Del_Cnt  As Integer                    ||21303  |    Dim Ws_Del_Cnt  As Integer                    
21730  |    Dim Ws_Del_Cnt2 As Integer                    ||21304  |    Dim Ws_Del_Cnt2 As Integer                    
21731  |    Dim ContNo      As String   '契約番号(SQL文作 ||21305  |    Dim ContNo      As String   '契約番号(SQL文作 
21732  |    Dim NavGetCnt   As Long                       ||21306  |    Dim NavGetCnt   As Long                       
21733  |    Dim sGetAccCode As String                     ||21307  |    Dim sGetAccCode As String                     
21734  |    Dim Mnav_Flg    As String                     ||21308  |    Dim Mnav_Flg    As String                     
21735  |    Dim sStart As String            '計算対象　開 ||21309  |    Dim sStart As String            '計算対象　開 
21736  |    Dim sEnd As String              '計算対象　終 ||21310  |    Dim sEnd As String              '計算対象　終 
21737  |    Dim dstrBasedate As String      '基準日用ワー ||21311  |    Dim dstrBasedate As String      '基準日用ワー 
21738  |    Dim dstrCaldate() As String     'カレンダー日 ||21312  |    Dim dstrCaldate() As String     'カレンダー日 
21739  |    Dim ddblDailynav() As Double    '日次NAV用格納||21313  |    Dim ddblDailynav() As Double    '日次NAV用格納
21740  |    Dim dlngCnt As Long             '計算対象期間 ||21314  |    Dim dlngCnt As Long             '計算対象期間 
21741  |    Dim dstrCaldate2 As String      'カレンダー日 ||21315  |    Dim dstrCaldate2 As String      'カレンダー日 
21742  |    Dim dstrBasedate2 As String     '基準日(/編集)||21316  |    Dim dstrBasedate2 As String     '基準日(/編集)
21743  |    Dim dlngDiffdate As Long        'カレンダー日 ||21317  |    Dim dlngDiffdate As Long        'カレンダー日 
21744  |    Dim dintFor As Integer          'For文用変数  ||21318  |    Dim dintFor As Integer          'For文用変数  
21745  |    Dim ddblTtalnav As Double       '日次NAV累積用||21319  |    Dim ddblTtalnav As Double       '日次NAV累積用
21746  |    Dim dstrAvgNav As String                      ||21320  |    Dim dstrAvgNav As String                      
21747  |    Dim ddblNearNav As Double                     ||21321  |    Dim ddblNearNav As Double                     
21748  |    Dim dstrAccCd() As String                     ||21322  |    Dim dstrAccCd() As String                     
21749  |    Dim dstrBsCCd() As String                     ||21323  |    Dim dstrBsCCd() As String                     
21750  |    Dim intRtn      As Integer                    ||21324  |    Dim intRtn      As Integer                    
21751  |    Dim dstrDate         As String                ||21325  |    Dim dstrDate         As String                
21752  |    Dim dstrCurrencyCode As String                ||21326  |    Dim dstrCurrencyCode As String                
21753  |    Dim ddblExchangeRate As Double                ||21327  |    Dim ddblExchangeRate As Double                
21754  |    Dim dintPage    As Integer                    ||21328  |    Dim dintPage    As Integer                    
21755  |    Dim dintPageIni As Integer                    ||21329  |    Dim dintPageIni As Integer                    
21756  |    Dim dintAmari   As Integer                    ||21330  |    Dim dintAmari   As Integer                    
21757  |    Dim dCalDate    As Date                       ||21331  |    Dim dCalDate    As Date                       
21758  |    Dim J           As Integer                    ||21332  |    Dim J           As Integer                    
21759  |    Dim K           As Integer                    ||21333  |    Dim K           As Integer                    
21760  |    Dim L           As Integer                    ||21334  |    Dim L           As Integer                    
21761  |    Dim AvgNav      As Currency                   ||21335  |    Dim AvgNav      As Currency                   
21762  |    Dim dintFor2    As Integer                    ||21336  |    Dim dintFor2    As Integer                    
21763  |    Dim dlngMeisyoSu As Integer                   ||21337  |    Dim dlngMeisyoSu As Integer                   
21764  |    Dim dlngCntsv As Long                         ||21338  |    Dim dlngCntsv As Long                         
21765  |    '2006/08/18 START K.Furuya 期中料率変更契約対 ||21339  |    '2006/08/18 START K.Furuya 期中料率変更契約対 
21766  |    Dim RuleNoCnt                   As Integer  ' ||21340  |    Dim RuleNoCnt                   As Integer  ' 
21767  |    Dim KityuFlg                    As Boolean  ' ||21341  |    Dim KityuFlg                    As Boolean  ' 
21768  |    Dim ddblNearBabyMotherRate      As Double   ' ||21342  |    Dim ddblNearBabyMotherRate      As Double   ' 
21769  |    Dim MonthlyCnt                  As Long       ||21343  |    Dim MonthlyCnt                  As Long       
21770  |    Dim dblNavTotal                 As Double   ' ||21344  |    Dim dblNavTotal                 As Double   ' 
21771  |    Dim intRange                    As Integer  ' ||21345  |    Dim intRange                    As Integer  ' 
21772  |    Dim strRange                    As String   ' ||21346  |    Dim strRange                    As String   ' 
21773  |    Dim EndFlg                      As Boolean  ' ||21347  |    Dim EndFlg                      As Boolean  ' 
21774  |    Dim SetPoint                    As Integer    ||21348  |    Dim SetPoint                    As Integer    
21775  |    Dim AddPoint                    As Integer    ||21349  |    Dim AddPoint                    As Integer    
21776  |    Dim strWord                     As String   ' ||21350  |    Dim strWord                     As String   ' 
21777  |    '2006/08/18 END   K.Furuya 期中料率変更契約対 ||21351  |    '2006/08/18 END   K.Furuya 期中料率変更契約対 
21778  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||21352  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
21779  |    Dim WkStart                     As String   ' ||21353  |    Dim WkStart                     As String   ' 
21780  |    Dim StartFlg                    As String   ' ||21354  |    Dim StartFlg                    As String   ' 
21781  |                                                  ||21355  |                                                  
21782  |    '戻り値初期化                                 ||21356  |    '戻り値初期化                                 
21783  |    fnblExcelEnglishOut_ChangeRate = False        ||21357  |    fnblExcelEnglishOut_ChangeRate = False        
21784  |    i = 0                                         ||21358  |    i = 0                                         
21785  |                                                  ||21359  |                                                  
21786  |On Error Resume Next                              ||21360  |On Error Resume Next                              
21787  |                                                  ||21361  |                                                  
21788  |    Set xlSheet = xlBook.Sheets(gProcessCnt)      ||21362  |    Set xlSheet = xlBook.Sheets(gProcessCnt)      
21789  |                                                  ||21363  |                                                  
21790  |    'Excelフォーマットを調整                      ||21364  |    'Excelフォーマットを調整                      
21791  |    xlSheet.Cells.ColumnWidth = 1                 ||21365  |    xlSheet.Cells.ColumnWidth = 1                 
21792  |    xlSheet.Cells.Font.Size = 11                  ||21366  |    xlSheet.Cells.Font.Size = 11                  
21793  |                                                  ||21367  |                                                  
21794  |    'シート名を設定(確認書**)                     ||21368  |    'シート名を設定(確認書**)                     
21795  |    '契約毎のシート番号を付番する                 ||21369  |    '契約毎のシート番号を付番する                 
21796  |    'xlBook.Sheets(gProcessCnt).Name = sWord33 & (||21370  |    'xlBook.Sheets(gProcessCnt).Name = sWord33 & (
21797  |    xlBook.Sheets(gProcessCnt).Name = sWord33a & g||21371  |    xlBook.Sheets(gProcessCnt).Name = sWord33a & g
21798  |                                                  ||21372  |                                                  
21799  |    'シートの余白を設定                           ||21373  |    'シートの余白を設定                           
21800  |    xlSheet.PageSetup.TopMargin = Application.Inch||21374  |    xlSheet.PageSetup.TopMargin = Application.Inch
21801  |    xlSheet.PageSetup.BottomMargin = Application.I||21375  |    xlSheet.PageSetup.BottomMargin = Application.I
21802  |    xlSheet.PageSetup.LeftMargin = Application.Inc||21376  |    xlSheet.PageSetup.LeftMargin = Application.Inc
21803  |    xlSheet.PageSetup.RightMargin = Application.In||21377  |    xlSheet.PageSetup.RightMargin = Application.In
21804  |                                                  ||21378  |                                                  
21805  |    DoEvents                                      ||21379  |    DoEvents                                      
21806  |    With xlSheet                                  ||21380  |    With xlSheet                                  
21807  |        '題目                                     ||21381  |        '題目                                     
21808  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||21382  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
21809  |            Case Mid(mstrContractFlag(1), 1, 1)   ||21383  |            Case Mid(mstrContractFlag(1), 1, 1)   
21810  |                .Cells(5, 1).Value = sWord0d      ||21384  |                .Cells(5, 1).Value = sWord0d      
21811  |            Case Mid(mstrContractFlag(2), 1, 1)   ||21385  |            Case Mid(mstrContractFlag(2), 1, 1)   
21812  |                .Cells(5, 1).Value = sWord0e      ||21386  |                .Cells(5, 1).Value = sWord0e      
21813  |            Case Mid(mstrContractFlag(3), 1, 1)   ||21387  |            Case Mid(mstrContractFlag(3), 1, 1)   
21814  |                .Cells(5, 1).Value = sWord0f      ||21388  |                .Cells(5, 1).Value = sWord0f      
21815  |            Case Else                             ||21389  |            Case Else                             
21816  |                MsgBox "契約区分が不正です。", vbC||21390  |                MsgBox "契約区分が不正です。", vbC
21817  |        End Select                                ||21391  |        End Select                                
21818  |        .Cells(5, 1).Font.Size = 14               ||21392  |        .Cells(5, 1).Font.Size = 14               
21819  |        .Range("A5:BG5").HorizontalAlignment = xlC||21393  |        .Range("A5:BG5").HorizontalAlignment = xlC
21820  |                                                  ||21394  |                                                  
21821  |        '出力日付                                 ||21395  |        '出力日付                                 
21822  |        If RTrim(txtSysOutDate.Text) = "" Then    ||21396  |        If RTrim(txtSysOutDate.Text) = "" Then    
21823  |            .Cells(3, 50).Value = sWord34a        ||21397  |            .Cells(3, 50).Value = sWord34a        
21824  |            .Cells(3, 50).HorizontalAlignment = xl||21398  |            .Cells(3, 50).HorizontalAlignment = xl
21825  |        Else                                      ||21399  |        Else                                      
21826  |            .Cells(3, 43).NumberFormatLocal = "@" ||21400  |            .Cells(3, 43).NumberFormatLocal = "@" 
21827  |            .Cells(3, 43).Value = CStr(Format(txtS||21401  |            .Cells(3, 43).Value = CStr(Format(txtS
21828  |        End If                                    ||21402  |        End If                                    
21829  |                                                  ||21403  |                                                  
21830  |        '下記のとおり･･･                          ||21404  |        '下記のとおり･･･                          
21831  |        .Cells(7, 2).Value = "Dear Sirs,"         ||21405  |        .Cells(7, 2).Value = "Dear Sirs,"         
21832  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||21406  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
21833  |            Case Mid(mstrContractFlag(1), 1, 1)   ||21407  |            Case Mid(mstrContractFlag(1), 1, 1)   
21834  |                .Cells(8, 2).Value = sWord3d      ||21408  |                .Cells(8, 2).Value = sWord3d      
21835  |            Case Mid(mstrContractFlag(2), 1, 1)   ||21409  |            Case Mid(mstrContractFlag(2), 1, 1)   
21836  |                .Cells(8, 2).Value = sWord3e      ||21410  |                .Cells(8, 2).Value = sWord3e      
21837  |            Case Mid(mstrContractFlag(3), 1, 1)   ||21411  |            Case Mid(mstrContractFlag(3), 1, 1)   
21838  |                .Cells(8, 2).Value = sWord3f      ||21412  |                .Cells(8, 2).Value = sWord3f      
21839  |            Case Else                             ||21413  |            Case Else                             
21840  |        End Select                                ||21414  |        End Select                                
21841  |                                                  ||21415  |                                                  
21842  |        'ファンド名                               ||21416  |        'ファンド名                               
21843  |        .Cells(10, 2).Value = sWord4a             ||21417  |        .Cells(10, 2).Value = sWord4a             
21844  |        '文言の冗長化でピリオド及び、名称を二列右 ||21418  |        '文言の冗長化でピリオド及び、名称を二列右 
21845  |'        .Cells(10, 11).Value = sWord19           ||21419  |'        .Cells(10, 11).Value = sWord19           
21846  |'        .Cells(10, 13).Value = gbuMGetUPDRec.N(lR||21420  |'        .Cells(10, 13).Value = gbuMGetUPDRec.N(lR
21847  |        .Cells(10, 13).Value = sWord19            ||21421  |        .Cells(10, 13).Value = sWord19            
21848  |        .Cells(10, 15).Value = gbuMGetUPDRec.N(lRe||21422  |        .Cells(10, 15).Value = gbuMGetUPDRec.N(lRe
21849  |                                                  ||21423  |                                                  
21850  |        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_con||21424  |        ContNo = gbuMGetUPDRec.N(lRecIdx).MGET_con
21851  |                                                  ||21425  |                                                  
21852  |        'RAFI対応 START                           ||21426  |        'RAFI対応 START                           
21853  |        'NAV取得SQL                               ||21427  |        'NAV取得SQL                               
21854  |        '外部委託顧問料ルールの資産種類によって取 ||21428  |        '外部委託顧問料ルールの資産種類によって取 
21855  |        '純資産                                   ||21429  |        '純資産                                   
21856  |        If msAssetFlg = "0" Then                  ||21430  |        If msAssetFlg = "0" Then                  
21857  |            sSql = gstrEditSQLcfr_NavGetForSelectL||21431  |            sSql = gstrEditSQLcfr_NavGetForSelectL
21858  |        'マザー組入資産                           ||21432  |        'マザー組入資産                           
21859  |        Else                                      ||21433  |        Else                                      
21860  |            sSql = gstrEditSQLcfr_MotherAccGetForS||21434  |            sSql = gstrEditSQLcfr_MotherAccGetForS
21861  |        End If                                    ||21435  |        End If                                    
21862  |                                                  ||21436  |                                                  
21863  |        'ﾀﾞｲﾅｾｯﾄの作成                            ||21437  |        'ﾀﾞｲﾅｾｯﾄの作成                            
21864  |        If gintDyCreate(sSql) = False Then        ||21438  |        If gintDyCreate(sSql) = False Then        
21865  |            Exit Function                         ||21439  |            Exit Function                         
21866  |        End If                                    ||21440  |        End If                                    
21867  |        Do Until gblnDyEOF()                      ||21441  |        Do Until gblnDyEOF()                      
21868  |            '動的配列更新                         ||21442  |            '動的配列更新                         
21869  |            ReDim Preserve gtypcfr_navget_tbl(0 To||21443  |            ReDim Preserve gtypcfr_navget_tbl(0 To
21870  |            ReDim Preserve dstrAccCd(0 To NavGetCn||21444  |            ReDim Preserve dstrAccCd(0 To NavGetCn
21871  |                                                  ||21445  |                                                  
21872  |            'NAV取得抽出                          ||21446  |            'NAV取得抽出                          
21873  |            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT_||21447  |            gtypcfr_navget_tbl(NavGetCnt).ACCOUNT_
21874  |            If NavGetCnt > 0 Then                 ||21448  |            If NavGetCnt > 0 Then                 
21875  |                sGetAccCode = sGetAccCode & " , " ||21449  |                sGetAccCode = sGetAccCode & " , " 
21876  |            Else                                  ||21450  |            Else                                  
21877  |                sGetAccCode = sGetAccCode & gtypcf||21451  |                sGetAccCode = sGetAccCode & gtypcf
21878  |            End If                                ||21452  |            End If                                
21879  |                                                  ||21453  |                                                  
21880  |            '口座コードの格納(１契約複数口座の場合||21454  |            '口座コードの格納(１契約複数口座の場合
21881  |            dstrAccCd(NavGetCnt) = gtypcfr_navget_||21455  |            dstrAccCd(NavGetCnt) = gtypcfr_navget_
21882  |            NavGetCnt = NavGetCnt + 1             ||21456  |            NavGetCnt = NavGetCnt + 1             
21883  |            'マザー組入資産の場合ベビーファンドコ ||21457  |            'マザー組入資産の場合ベビーファンドコ 
21884  |            If msAssetFlg = "1" Then              ||21458  |            If msAssetFlg = "1" Then              
21885  |                msBabyAccountCode = ""            ||21459  |                msBabyAccountCode = ""            
21886  |                msBabyAccountCode = Trim(gvlnDyDat||21460  |                msBabyAccountCode = Trim(gvlnDyDat
21887  |            End If                                ||21461  |            End If                                
21888  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     ||21462  |            'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                     
21889  |            Call gDyNext                          ||21463  |            Call gDyNext                          
21890  |        Loop                                      ||21464  |        Loop                                      
21891  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         ||21465  |        'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                         
21892  |        Call gblnDyClose                          ||21466  |        Call gblnDyClose                          
21893  |                                                  ||21467  |                                                  
21894  |        '１契約複数口座の場合に口座のベース通貨に ||21468  |        '１契約複数口座の場合に口座のベース通貨に 
21895  |        ReDim dstrBsCCd(0 To NavGetCnt - 1)       ||21469  |        ReDim dstrBsCCd(0 To NavGetCnt - 1)       
21896  |        If NavGetCnt - 1 > 0 Then                 ||21470  |        If NavGetCnt - 1 > 0 Then                 
21897  |            For dintFor = 0 To NavGetCnt - 1      ||21471  |            For dintFor = 0 To NavGetCnt - 1      
21898  |                sSql = ""                         ||21472  |                sSql = ""                         
21899  |                sSql = sSql & "SELECT ACCOUNT_CODE||21473  |                sSql = sSql & "SELECT ACCOUNT_CODE
21900  |                sSql = sSql & "WHERE ACCOUNT_CODE ||21474  |                sSql = sSql & "WHERE ACCOUNT_CODE 
21901  |                'ﾀﾞｲﾅｾｯﾄの作成                    ||21475  |                'ﾀﾞｲﾅｾｯﾄの作成                    
21902  |                If gintDyCreate(sSql) = False Then||21476  |                If gintDyCreate(sSql) = False Then
21903  |                    Exit Function                 ||21477  |                    Exit Function                 
21904  |                Else                              ||21478  |                Else                              
21905  |                    dstrBsCCd(dintFor) = gvlnDyDat||21479  |                    dstrBsCCd(dintFor) = gvlnDyDat
21906  |                End If                            ||21480  |                End If                            
21907  |                If dintFor > 0 Then               ||21481  |                If dintFor > 0 Then               
21908  |                    If dstrBsCCd(dintFor) <> dstrB||21482  |                    If dstrBsCCd(dintFor) <> dstrB
21909  |                        intRtn = MsgBox("ファンド ||21483  |                        intRtn = MsgBox("ファンド 
21910  |                        Exit Function             ||21484  |                        Exit Function             
21911  |                    End If                        ||21485  |                    End If                        
21912  |                End If                            ||21486  |                End If                            
21913  |            Next dintFor                          ||21487  |            Next dintFor                          
21914  |                                                  ||21488  |                                                  
21915  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||21489  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
21916  |            Call gblnDyClose                      ||21490  |            Call gblnDyClose                      
21917  |                                                  ||21491  |                                                  
21918  |        End If                                    ||21492  |        End If                                    
21919  |                                                  ||21493  |                                                  
21920  |        'ファンドコード                           ||21494  |        'ファンドコード                           
21921  |        .Cells(11, 2).Value = sWord4_2a           ||21495  |        .Cells(11, 2).Value = sWord4_2a           
21922  |        '文言の冗長化でピリオド及び、名称を二列右 ||21496  |        '文言の冗長化でピリオド及び、名称を二列右 
21923  |'        .Cells(11, 11).Value = sWord19           ||21497  |'        .Cells(11, 11).Value = sWord19           
21924  |'        .Cells(11, 13).NumberFormatLocal = "@"   ||21498  |'        .Cells(11, 13).NumberFormatLocal = "@"   
21925  |        .Cells(11, 13).Value = sWord19            ||21499  |        .Cells(11, 13).Value = sWord19            
21926  |        .Cells(11, 15).NumberFormatLocal = "@"    ||21500  |        .Cells(11, 15).NumberFormatLocal = "@"    
21927  |        'RAFI対応 START                           ||21501  |        'RAFI対応 START                           
21928  |        '純資産の場合                             ||21502  |        '純資産の場合                             
21929  |        If msAssetFlg = "0" Then                  ||21503  |        If msAssetFlg = "0" Then                  
21930  |'            .Cells(11, 13).Value = sGetAccCode   ||21504  |'            .Cells(11, 13).Value = sGetAccCode   
21931  |            .Cells(11, 15).Value = sGetAccCode    ||21505  |            .Cells(11, 15).Value = sGetAccCode    
21932  |        'マザー組入資産の場合                     ||21506  |        'マザー組入資産の場合                     
21933  |        Else                                      ||21507  |        Else                                      
21934  |'            .Cells(11, 13).Value = msBabyAccountC||21508  |'            .Cells(11, 13).Value = msBabyAccountC
21935  |            .Cells(11, 15).Value = msBabyAccountCo||21509  |            .Cells(11, 15).Value = msBabyAccountCo
21936  |        End If                                    ||21510  |        End If                                    
21937  |        'RAFI対応 END                             ||21511  |        'RAFI対応 END                             
21938  |                                                  ||21512  |                                                  
21939  |        '計算期間                                 ||21513  |        '計算期間                                 
21940  |        .Cells(13, 2).Value = sWord5a             ||21514  |        .Cells(13, 2).Value = sWord5a             
21941  |        '文言の冗長化でピリオド及び、名称を二列右 ||21515  |        '文言の冗長化でピリオド及び、名称を二列右 
21942  |'        .Cells(13, 11).Value = sWord19           ||21516  |'        .Cells(13, 11).Value = sWord19           
21943  |        .Cells(13, 13).Value = sWord19            ||21517  |        .Cells(13, 13).Value = sWord19            
21944  |                                                  ||21518  |                                                  
21945  |        '前回締日・直近締日セット                 ||21519  |        '前回締日・直近締日セット                 
21946  |        dStart = CDate(gstrDateFormat(mstrSettleme||21520  |        dStart = CDate(gstrDateFormat(mstrSettleme
21947  |        dEnd = CDate(gstrDateFormat(mstrNearSettle||21521  |        dEnd = CDate(gstrDateFormat(mstrNearSettle
21948  |        dstrDate = Replace(CStr(dEnd), "/", "")   ||21522  |        dstrDate = Replace(CStr(dEnd), "/", "")   
21949  |        iCalcNum = DateDiff("d", dStart, dEnd) + 1||21523  |        iCalcNum = DateDiff("d", dStart, dEnd) + 1
21950  |                                                  ||21524  |                                                  
21951  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||21525  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
21952  |        WkStart = Replace(CStr(dStart), "/", "")  ||21526  |        WkStart = Replace(CStr(dStart), "/", "")  
21953  |        '期中料率変更対象契約                     ||21527  |        '期中料率変更対象契約                     
21954  |        '外部委託顧問料率を定義体配列にセット     ||21528  |        '外部委託顧問料率を定義体配列にセット     
21955  |        If fnSetOtherComRate(gbuMGetUPDRec.N(lRecI||21529  |        If fnSetOtherComRate(gbuMGetUPDRec.N(lRecI
21956  |                             msAssetFlg, msBabyAcc||21530  |                             msAssetFlg, msBabyAcc
21957  |                             gbuMGetUPDRec.N(lRecI||21531  |                             gbuMGetUPDRec.N(lRecI
21958  |                             conDBasset_type_codeA||21532  |                             conDBasset_type_codeA
21959  |                             WkStart, _           ||21533  |                             WkStart, _           
21960  |                             "1") = False Then    ||21534  |                             "1") = False Then    
21961  |            Exit Function                         ||21535  |            Exit Function                         
21962  |        End If                                    ||21536  |        End If                                    
21963  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||21537  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
21964  |                                                  ||21538  |                                                  
21965  |        '年率                                     ||21539  |        '年率                                     
21966  |        .Cells(15, 2).Value = sWord10a            ||21540  |        .Cells(15, 2).Value = sWord10a            
21967  |        '文言の冗長化でピリオド及び、名称を二列右 ||21541  |        '文言の冗長化でピリオド及び、名称を二列右 
21968  |'        .Cells(15, 11).Value = sWord19           ||21542  |'        .Cells(15, 11).Value = sWord19           
21969  |        .Cells(15, 13).Value = sWord19            ||21543  |        .Cells(15, 13).Value = sWord19            
21970  |                                                  ||21544  |                                                  
21971  |        '月末純資産                               ||21545  |        '月末純資産                               
21972  |        '開始位置を変更                           ||21546  |        '開始位置を変更                           
21973  |'        .Cells(27, 2).Value = sWord6a            ||21547  |'        .Cells(27, 2).Value = sWord6a            
21974  |'        .Cells(27, 21).Value = sWord19           ||21548  |'        .Cells(27, 21).Value = sWord19           
21975  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||21549  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
21976  |        '取得NAV区分が4:日次時価総額平均の場合"Mon||21550  |        '取得NAV区分が4:日次時価総額平均の場合"Mon
21977  |        If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||21551  |        If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
21978  |            .Cells(20, 2).Value = sWord63a        ||21552  |            .Cells(20, 2).Value = sWord63a        
21979  |        Else                                      ||21553  |        Else                                      
21980  |            .Cells(20, 2).Value = sWord6a         ||21554  |            .Cells(20, 2).Value = sWord6a         
21981  |        End If                                    ||21555  |        End If                                    
21982  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||21556  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
21983  |        .Cells(20, 21).Value = sWord19            ||21557  |        .Cells(20, 21).Value = sWord19            
21984  |                                                  ||21558  |                                                  
21985  |        '@@@@@ 合計行を出力しないならここをコメン ||21559  |        '@@@@@ 合計行を出力しないならここをコメン 
21986  |        '合計(純資産)                             ||21560  |        '合計(純資産)                             
21987  |        .Cells(40, 25).Value = sWord9a            ||21561  |        .Cells(40, 25).Value = sWord9a            
21988  |        .Range("X40:AI40").HorizontalAlignment = x||21562  |        .Range("X40:AI40").HorizontalAlignment = x
21989  |                                                  ||21563  |                                                  
21990  |'        '契約区分「1」or「2」                    ||21564  |'        '契約区分「1」or「2」                    
21991  |'        '契約区分「1」or「2」or (「3」and 取得NAV||21565  |'        '契約区分「1」or「2」or (「3」and 取得NAV
21992  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||21566  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
21993  |        Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||21567  |        Or Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
21994  |        Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont||21568  |        Or (Mid(gbuMGetUPDRec.N(lRecIdx).MGET_cont
21995  |                                                  ||21569  |                                                  
21996  |'取得NAV区分[1]                                   ||21570  |'取得NAV区分[1]                                   
21997  |            '月末NAV取得                          ||21571  |            '月末NAV取得                          
21998  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g||21572  |            If gbuMGetUPDRec.N(lRecIdx).MGET_nav_g
21999  |                '月次NAVを取得する                ||21573  |                '月次NAVを取得する                
22000  |                Call sbMonthlyNAV_GetChangeRate(lR||21574  |                Call sbMonthlyNAV_GetChangeRate(lR
22001  |                                                  ||21575  |                                                  
22002  |                'カウンターを初期化               ||21576  |                'カウンターを初期化               
22003  |                K = 0                             ||21577  |                K = 0                             
22004  |                '月次NAV表を作成する              ||21578  |                '月次NAV表を作成する              
22005  |                For i = LBound(gtypOtherComRec) To||21579  |                For i = LBound(gtypOtherComRec) To
22006  |                    For J = LBound(gtypOtherComRec||21580  |                    For J = LBound(gtypOtherComRec
22007  |                        '日付                     ||21581  |                        '日付                     
22008  |                        .Cells(20 + K, 25).NumberF||21582  |                        .Cells(20 + K, 25).NumberF
22009  |                        .Cells(20 + K, 25).Value =||21583  |                        .Cells(20 + K, 25).Value =
22010  |                        .Cells(20 + K, 25).Horizon||21584  |                        .Cells(20 + K, 25).Horizon
22011  |                        '純資産                   ||21585  |                        '純資産                   
22012  |                        .Cells(20 + K, 49).NumberF||21586  |                        .Cells(20 + K, 49).NumberF
22013  |                        If gtypOtherComRec(i).APPL||21587  |                        If gtypOtherComRec(i).APPL
22014  |                            .Cells(20 + K, 49).Val||21588  |                            .Cells(20 + K, 49).Val
22015  |                                CStr(Format(gtypOt||21589  |                                CStr(Format(gtypOt
22016  |                        Else                      ||21590  |                        Else                      
22017  |                            .Cells(20 + K, 49).Val||21591  |                            .Cells(20 + K, 49).Val
22018  |                                CStr(Format(gtypOt||21592  |                                CStr(Format(gtypOt
22019  |                        End If                    ||21593  |                        End If                    
22020  |                        .Cells(20 + K, 49).Horizon||21594  |                        .Cells(20 + K, 49).Horizon
22021  |                                                  ||21595  |                                                  
22022  |                        K = K + 1                 ||21596  |                        K = K + 1                 
22023  |                    Next J                        ||21597  |                    Next J                        
22024  |                    '純資産総額を算出する         ||21598  |                    '純資産総額を算出する         
22025  |                    TotalNav = TotalNav + gtypOthe||21599  |                    TotalNav = TotalNav + gtypOthe
22026  |                    '合計(純資産) ,表中の文言     ||21600  |                    '合計(純資産) ,表中の文言     
22027  |                    .Cells(20 + K, 25).Value = sWo||21601  |                    .Cells(20 + K, 25).Value = sWo
22028  |                    '合計(金額)                   ||21602  |                    '合計(金額)                   
22029  |                    .Cells(20 + K, 49).NumberForma||21603  |                    .Cells(20 + K, 49).NumberForma
22030  |                    If gtypOtherComRec(i).APPLY_BA||21604  |                    If gtypOtherComRec(i).APPLY_BA
22031  |                        .Cells(20 + K, 49).Value =||21605  |                        .Cells(20 + K, 49).Value =
22032  |                            CStr(Format(gtypOtherC||21606  |                            CStr(Format(gtypOtherC
22033  |                    Else                          ||21607  |                    Else                          
22034  |                        .Cells(20 + K, 49).Value =||21608  |                        .Cells(20 + K, 49).Value =
22035  |                            CStr(Format(gtypOtherC||21609  |                            CStr(Format(gtypOtherC
22036  |                    End If                        ||21610  |                    End If                        
22037  |                    .Cells(20 + K, 49).HorizontalA||21611  |                    .Cells(20 + K, 49).HorizontalA
22038  |                    K = K + 1                     ||21612  |                    K = K + 1                     
22039  |                    '平均NAV ,表中の文言          ||21613  |                    '平均NAV ,表中の文言          
22040  |                    .Cells(20 + K, 25).Value = sWo||21614  |                    .Cells(20 + K, 25).Value = sWo
22041  |                    '平均NAV(金額)                ||21615  |                    '平均NAV(金額)                
22042  |                    .Cells(20 + K, 49).NumberForma||21616  |                    .Cells(20 + K, 49).NumberForma
22043  |                    If gtypOtherComRec(i).APPLY_BA||21617  |                    If gtypOtherComRec(i).APPLY_BA
22044  |                        .Cells(20 + K, 49).Value =||21618  |                        .Cells(20 + K, 49).Value =
22045  |                            CStr(Format(gtypOtherC||21619  |                            CStr(Format(gtypOtherC
22046  |                    Else                          ||21620  |                    Else                          
22047  |                        .Cells(20 + K, 49).Value =||21621  |                        .Cells(20 + K, 49).Value =
22048  |                            CStr(Format(gtypOtherC||21622  |                            CStr(Format(gtypOtherC
22049  |                    End If                        ||21623  |                    End If                        
22050  |                    .Cells(20 + K, 49).HorizontalA||21624  |                    .Cells(20 + K, 49).HorizontalA
22051  |                                                  ||21625  |                                                  
22052  |                    K = K + 1                     ||21626  |                    K = K + 1                     
22053  |                Next i                            ||21627  |                Next i                            
22054  |                                                  ||21628  |                                                  
22055  |                 '@@@@@ 合計行を出力しないならここ||21629  |                 '@@@@@ 合計行を出力しないならここ
22056  |                .Cells(40, 49).NumberFormatLocal =||21630  |                .Cells(40, 49).NumberFormatLocal =
22057  |                .Cells(40, 49).Value = CStr(Format||21631  |                .Cells(40, 49).Value = CStr(Format
22058  |                                                  ||21632  |                                                  
22059  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||21633  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
22060  |                   '@@@@@ 合計行を出力しないならこ||21634  |                   '@@@@@ 合計行を出力しないならこ
22061  |                   .Cells(40, 49).Value = CStr(For||21635  |                   .Cells(40, 49).Value = CStr(For
22062  |                Else                              ||21636  |                Else                              
22063  |                   '合計行を出力しないならここをコ||21637  |                   '合計行を出力しないならここをコ
22064  |                   .Cells(40, 49).Value = CStr(For||21638  |                   .Cells(40, 49).Value = CStr(For
22065  |                End If                            ||21639  |                End If                            
22066  |                .Cells(40, 49).HorizontalAlignment||21640  |                .Cells(40, 49).HorizontalAlignment
22067  |                                                  ||21641  |                                                  
22068  |                '平均純資産総額                   ||21642  |                '平均純資産総額                   
22069  |                .Cells(43, 2).Value = sWord51a    ||21643  |                .Cells(43, 2).Value = sWord51a    
22070  |                .Cells(43, 16).Value = sWord19    ||21644  |                .Cells(43, 16).Value = sWord19    
22071  |                '平均純資産総額は別紙に記載       ||21645  |                '平均純資産総額は別紙に記載       
22072  |                strWord = ""                      ||21646  |                strWord = ""                      
22073  |                strWord = strWord & sWord53a & """||21647  |                strWord = strWord & sWord53a & """
22074  |                Select Case Mid(gbuMGetUPDRec.N(lR||21648  |                Select Case Mid(gbuMGetUPDRec.N(lR
22075  |                    Case Mid(mstrContractFlag(1), ||21649  |                    Case Mid(mstrContractFlag(1), 
22076  |                        strWord = strWord & sWord5||21650  |                        strWord = strWord & sWord5
22077  |                    Case Mid(mstrContractFlag(2), ||21651  |                    Case Mid(mstrContractFlag(2), 
22078  |                        strWord = strWord & sWord5||21652  |                        strWord = strWord & sWord5
22079  |                    Case Mid(mstrContractFlag(3), ||21653  |                    Case Mid(mstrContractFlag(3), 
22080  |                        strWord = strWord & sWord5||21654  |                        strWord = strWord & sWord5
22081  |                    Case Else                     ||21655  |                    Case Else                     
22082  |                End Select                        ||21656  |                End Select                        
22083  |                .Cells(43, 19).Value = strWord    ||21657  |                .Cells(43, 19).Value = strWord    
22084  |                                                  ||21658  |                                                  
22085  |'                 '計算期間の純資産総額の合計(月末||21659  |'                 '計算期間の純資産総額の合計(月末
22086  |'                 .Cells(43, 28).NumberFormatLocal||21660  |'                 .Cells(43, 28).NumberFormatLocal
22087  |'                                                 ||21661  |'                                                 
22088  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET||21662  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET
22089  |'                     .Cells(43, 28).Value = CStr(||21663  |'                     .Cells(43, 28).Value = CStr(
22090  |'                 Else                            ||21664  |'                 Else                            
22091  |'                     .Cells(43, 28).Value = CStr(||21665  |'                     .Cells(43, 28).Value = CStr(
22092  |'                 End If                          ||21666  |'                 End If                          
22093  |'                                                 ||21667  |'                                                 
22094  |'                 .Cells(43, 28).HorizontalAlignme||21668  |'                 .Cells(43, 28).HorizontalAlignme
22095  |'                                                 ||21669  |'                                                 
22096  |'                 '計算期間の純資産総額の合計÷計 ||21670  |'                 '計算期間の純資産総額の合計÷計 
22097  |'                 .Cells(43, 40).NumberFormatLocal||21671  |'                 .Cells(43, 40).NumberFormatLocal
22098  |'                 dblValueIn = TotalNav / iRowCnt ||21672  |'                 dblValueIn = TotalNav / iRowCnt 
22099  |'                                                 ||21673  |'                                                 
22100  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET||21674  |'                 If gbuMGetUPDRec.N(lRecIdx).MGET
22101  |'                     Call sbGetRoundValue2(dblVal||21675  |'                     Call sbGetRoundValue2(dblVal
22102  |'                 Else                            ||21676  |'                 Else                            
22103  |'                     Call sbGetRoundValue(dblValu||21677  |'                     Call sbGetRoundValue(dblValu
22104  |'                 End If                          ||21678  |'                 End If                          
22105  |'                                                 ||21679  |'                                                 
22106  |'                '平均NAV(計算対象NAV)            ||21680  |'                '平均NAV(計算対象NAV)            
22107  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||21681  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
22108  |'                    .Cells(43, 40).Value = CStr(F||21682  |'                    .Cells(43, 40).Value = CStr(F
22109  |'                Else                             ||21683  |'                Else                             
22110  |'                    .Cells(43, 40).Value = CStr(F||21684  |'                    .Cells(43, 40).Value = CStr(F
22111  |'                End If                           ||21685  |'                End If                           
22112  |'                                                 ||21686  |'                                                 
22113  |'                '÷??＝                          ||21687  |'                '÷??＝                          
22114  |'                          .Cells(43, 31).Value = ||21688  |'                          .Cells(43, 31).Value = 
22115  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||21689  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
22116  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_n||21690  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_n
22117  |            '=====================================||21691  |            '=====================================
22118  |            '==                                   ||21692  |            '==                                   
22119  |            '==  '4':日次時価総額平均(休日込)の計 ||21693  |            '==  '4':日次時価総額平均(休日込)の計 
22120  |            '==                                   ||21694  |            '==                                   
22121  |            '=====================================||21695  |            '=====================================
22122  |                ddblTtalnav = 0                   ||21696  |                ddblTtalnav = 0                   
22123  |                For dintFor = 0 To NavGetCnt - 1  ||21697  |                For dintFor = 0 To NavGetCnt - 1  
22124  |                                                  ||21698  |                                                  
22125  |                    '日次時価総額平均取得         ||21699  |                    '日次時価総額平均取得         
22126  |                    sStart = gstrDateFormat2(CStr(||21700  |                    sStart = gstrDateFormat2(CStr(
22127  |                    sEnd = gstrDateFormat2(CStr(dE||21701  |                    sEnd = gstrDateFormat2(CStr(dE
22128  |                                                  ||21702  |                                                  
22129  |'2008/03/03 START '計算開始日と外部委託顧問料計算 ||21703  |'2008/03/03 START '計算開始日と外部委託顧問料計算 
22130  |                    '等しい場合                   ||21704  |                    '等しい場合                   
22131  |                    If sStart = gbuMGetUPDRec.N(lR||21705  |                    If sStart = gbuMGetUPDRec.N(lR
22132  |                        StartFlg = "1"            ||21706  |                        StartFlg = "1"            
22133  |                    Else                          ||21707  |                    Else                          
22134  |                        StartFlg = "0"            ||21708  |                        StartFlg = "0"            
22135  |                    End If                        ||21709  |                    End If                        
22136  |'2008/03/03 END   '計算開始日と外部委託顧問料計算 ||21710  |'2008/03/03 END   '計算開始日と外部委託顧問料計算 
22137  |                                                  ||21711  |                                                  
22138  |                    '計算開始日と外部委託顧問料計 ||21712  |                    '計算開始日と外部委託顧問料計 
22139  |                    If sStart = gbuMGetUPDRec.N(lR||21713  |                    If sStart = gbuMGetUPDRec.N(lR
22140  |                        '== SQL1 ==               ||21714  |                        '== SQL1 ==               
22141  |                        sSql = ""                 ||21715  |                        sSql = ""                 
22142  |                        sSql = sSql & "SELECT EIGY||21716  |                        sSql = sSql & "SELECT EIGY
22143  |                                                  ||21717  |                                                  
22144  |                        'ﾀﾞｲﾅｾｯﾄの作成            ||21718  |                        'ﾀﾞｲﾅｾｯﾄの作成            
22145  |                        If gintDyCreate(sSql) = Fa||21719  |                        If gintDyCreate(sSql) = Fa
22146  |                            Exit Function         ||21720  |                            Exit Function         
22147  |                        Else                      ||21721  |                        Else                      
22148  |                            '休日の場合、翌営業日 ||21722  |                            '休日の場合、翌営業日 
22149  |                            If gvlnDyDataS("EIGYO_||21723  |                            If gvlnDyDataS("EIGYO_
22150  |                                '翌営業日の時価総 ||21724  |                                '翌営業日の時価総 
22151  |                                '== SQL2 ==       ||21725  |                                '== SQL2 ==       
22152  |                                sSql = ""         ||21726  |                                sSql = ""         
22153  |                                sSql = sSql & "SEL||21727  |                                sSql = sSql & "SEL
22154  |                                sSql = sSql & "FRO||21728  |                                sSql = sSql & "FRO
22155  |                                sSql = sSql & "(SE||21729  |                                sSql = sSql & "(SE
22156  |                                sSql = sSql & "WHE||21730  |                                sSql = sSql & "WHE
22157  |                                                  ||21731  |                                                  
22158  |                                'ﾀﾞｲﾅｾｯﾄの作成    ||21732  |                                'ﾀﾞｲﾅｾｯﾄの作成    
22159  |                                If gintDyCreate(sS||21733  |                                If gintDyCreate(sS
22160  |                                    Exit Function ||21734  |                                    Exit Function 
22161  |                                Else              ||21735  |                                Else              
22162  |                                    ddblNearNav = ||21736  |                                    ddblNearNav = 
22163  |'2008/03/06 START 時価総額基準の外部委託顧問料対応||21737  |'2008/03/06 START 時価総額基準の外部委託顧問料対応
22164  |'                                    '翌営業日の計||21738  |'                                    '翌営業日の計
22165  |'                                    '== SQL3 ==  ||21739  |'                                    '== SQL3 ==  
22166  |'                                    sSql = ""    ||21740  |'                                    sSql = ""    
22167  |'                                    sSql = sSql &||21741  |'                                    sSql = sSql &
22168  |'                                    sSql = sSql &||21742  |'                                    sSql = sSql &
22169  |'                                    sSql = sSql &||21743  |'                                    sSql = sSql &
22170  |'                                    sSql = sSql &||21744  |'                                    sSql = sSql &
22171  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||21745  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
22172  |'                                    If gintDyCrea||21746  |'                                    If gintDyCrea
22173  |'                                        Exit Func||21747  |'                                        Exit Func
22174  |'                                     Else        ||21748  |'                                     Else        
22175  |'                                        '計算開始||21749  |'                                        '計算開始
22176  |'                                        sStart = ||21750  |'                                        sStart = 
22177  |'                                        dStart = ||21751  |'                                        dStart = 
22178  |'                                        '文言の冗||21752  |'                                        '文言の冗
22179  |''                                        .Cells(1||21753  |''                                        .Cells(1
22180  |''                                            CStr||21754  |''                                            CStr
22181  |'                                        .Cells(16||21755  |'                                        .Cells(16
22182  |'                                            CStr(||21756  |'                                            CStr(
22183  |'                                        iCalcNum ||21757  |'                                        iCalcNum 
22184  |'                                    End If       ||21758  |'                                    End If       
22185  |'2008/03/06 END   時価総額基準の外部委託顧問料対応||21759  |'2008/03/06 END   時価総額基準の外部委託顧問料対応
22186  |                                                  ||21760  |                                                  
22187  |                                    'SQL文の作成( ||21761  |                                    'SQL文の作成( 
22188  |                                    '計算期間の開 ||21762  |                                    '計算期間の開 
22189  |                                    sSql = gstrEdi||21763  |                                    sSql = gstrEdi
22190  |                                        ContNo, sS||21764  |                                        ContNo, sS
22191  |                                                  ||21765  |                                                  
22192  |                                     'ﾀﾞｲﾅｾｯﾄの作 ||21766  |                                     'ﾀﾞｲﾅｾｯﾄの作 
22193  |                                    If gintDyCreat||21767  |                                    If gintDyCreat
22194  |                                        Exit Funct||21768  |                                        Exit Funct
22195  |                                    End If        ||21769  |                                    End If        
22196  |                                    '配列初期化   ||21770  |                                    '配列初期化   
22197  |                                    ReDim gbuOther||21771  |                                    ReDim gbuOther
22198  |                                    MonthlyCnt = 0||21772  |                                    MonthlyCnt = 0
22199  |                                    'EOF判定処理  ||21773  |                                    'EOF判定処理  
22200  |                                    Do Until gblnD||21774  |                                    Do Until gblnD
22201  |                                        '対象デー ||21775  |                                        '対象デー 
22202  |                                        Call sbOth||21776  |                                        Call sbOth
22203  |                                        MonthlyCnt||21777  |                                        MonthlyCnt
22204  |                                        'ﾀﾞｲﾅｾｯﾄ次||21778  |                                        'ﾀﾞｲﾅｾｯﾄ次
22205  |                                        Call gDyNe||21779  |                                        Call gDyNe
22206  |                                    Loop          ||21780  |                                    Loop          
22207  |                                                  ||21781  |                                                  
22208  |                                    '期中料率変更 ||21782  |                                    '期中料率変更 
22209  |                                    Erase gtypOthe||21783  |                                    Erase gtypOthe
22210  |                                                  ||21784  |                                                  
22211  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||21785  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
22212  |                                    '期中料率変更 ||21786  |                                    '期中料率変更 
22213  |                                    '外部委託顧問 ||21787  |                                    '外部委託顧問 
22214  |                                    If fnSetOtherC||21788  |                                    If fnSetOtherC
22215  |                                                  ||21789  |                                                  
22216  |                                                  ||21790  |                                                  
22217  |                                                  ||21791  |                                                  
22218  |                                                  ||21792  |                                                  
22219  |                                                  ||21793  |                                                  
22220  |                                        Exit Funct||21794  |                                        Exit Funct
22221  |                                    End If        ||21795  |                                    End If        
22222  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||21796  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
22223  |                                                  ||21797  |                                                  
22224  |                                End If            ||21798  |                                End If            
22225  |                                'RAFI対応 START   ||21799  |                                'RAFI対応 START   
22226  |                                '翌営業日のマザー ||21800  |                                '翌営業日のマザー 
22227  |                                If msAssetFlg = "1||21801  |                                If msAssetFlg = "1
22228  |                                    '== SQL4 ==   ||21802  |                                    '== SQL4 ==   
22229  |                                    sSql = ""     ||21803  |                                    sSql = ""     
22230  |                                    sSql = sSql & ||21804  |                                    sSql = sSql & 
22231  |                                    sSql = sSql & ||21805  |                                    sSql = sSql & 
22232  |                                    sSql = sSql & ||21806  |                                    sSql = sSql & 
22233  |                                    sSql = sSql & ||21807  |                                    sSql = sSql & 
22234  |                                    sSql = sSql & ||21808  |                                    sSql = sSql & 
22235  |                                    sSql = sSql & ||21809  |                                    sSql = sSql & 
22236  |                                    sSql = sSql & ||21810  |                                    sSql = sSql & 
22237  |                                    sSql = sSql & ||21811  |                                    sSql = sSql & 
22238  |                                    sSql = sSql & ||21812  |                                    sSql = sSql & 
22239  |                                    sSql = sSql & ||21813  |                                    sSql = sSql & 
22240  |                                    sSql = sSql & ||21814  |                                    sSql = sSql & 
22241  |                                    sSql = sSql & ||21815  |                                    sSql = sSql & 
22242  |                                    sSql = sSql & ||21816  |                                    sSql = sSql & 
22243  |                                    sSql = sSql & ||21817  |                                    sSql = sSql & 
22244  |                                    sSql = sSql & ||21818  |                                    sSql = sSql & 
22245  |                                    sSql = sSql & ||21819  |                                    sSql = sSql & 
22246  |                                    sSql = sSql & ||21820  |                                    sSql = sSql & 
22247  |                                    sSql = sSql & ||21821  |                                    sSql = sSql & 
22248  |                                    sSql = sSql & ||21822  |                                    sSql = sSql & 
22249  |                                    sSql = sSql & ||21823  |                                    sSql = sSql & 
22250  |                                    sSql = sSql & ||21824  |                                    sSql = sSql & 
22251  |                                    sSql = sSql & ||21825  |                                    sSql = sSql & 
22252  |                                    sSql = sSql & ||21826  |                                    sSql = sSql & 
22253  |                                    sSql = sSql & ||21827  |                                    sSql = sSql & 
22254  |                                    'ﾀﾞｲﾅｾｯﾄの作成||21828  |                                    'ﾀﾞｲﾅｾｯﾄの作成
22255  |                                                  ||21829  |                                                  
22256  |                                    If gintDyCreat||21830  |                                    If gintDyCreat
22257  |                                        Exit Funct||21831  |                                        Exit Funct
22258  |                                    Else          ||21832  |                                    Else          
22259  |                                        ddblNearBa||21833  |                                        ddblNearBa
22260  |                                    End If        ||21834  |                                    End If        
22261  |                                End If            ||21835  |                                End If            
22262  |                                'RAFI対応 END     ||21836  |                                'RAFI対応 END     
22263  |                            End If                ||21837  |                            End If                
22264  |                        End If                    ||21838  |                        End If                    
22265  |                    End If                        ||21839  |                    End If                        
22266  |                    '== SQL5 ==                   ||21840  |                    '== SQL5 ==                   
22267  |                    sSql = ""                     ||21841  |                    sSql = ""                     
22268  |                    sSql = sSql & "SELECT CAL_YYYY||21842  |                    sSql = sSql & "SELECT CAL_YYYY
22269  |                    sSql = sSql & "WHERE CAL_YYYY ||21843  |                    sSql = sSql & "WHERE CAL_YYYY 
22270  |                                                  ||21844  |                                                  
22271  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||21845  |                    'ﾀﾞｲﾅｾｯﾄの作成                
22272  |                    If gintDyCreate(sSql) = False ||21846  |                    If gintDyCreate(sSql) = False 
22273  |                        Exit Function             ||21847  |                        Exit Function             
22274  |                    End If                        ||21848  |                    End If                        
22275  |                                                  ||21849  |                                                  
22276  |                    If dlngCnt = 0 Then           ||21850  |                    If dlngCnt = 0 Then           
22277  |                        ReDim dstrCaldate(gbxOraDy||21851  |                        ReDim dstrCaldate(gbxOraDy
22278  |                        ReDim ddblDailynav(gbxOraD||21852  |                        ReDim ddblDailynav(gbxOraD
22279  |                    End If                        ||21853  |                    End If                        
22280  |                                                  ||21854  |                                                  
22281  |                    'EOF判定処理                  ||21855  |                    'EOF判定処理                  
22282  |                    dlngCnt = 0                   ||21856  |                    dlngCnt = 0                   
22283  |                                                  ||21857  |                                                  
22284  |                    Do Until gblnDyEOF()          ||21858  |                    Do Until gblnDyEOF()          
22285  |                        dlngCnt = dlngCnt + 1     ||21859  |                        dlngCnt = dlngCnt + 1     
22286  |                        '抽出データセット         ||21860  |                        '抽出データセット         
22287  |                        dstrCaldate(dlngCnt) = gvl||21861  |                        dstrCaldate(dlngCnt) = gvl
22288  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||21862  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
22289  |                        Call gDyNext              ||21863  |                        Call gDyNext              
22290  |                    Loop                          ||21864  |                    Loop                          
22291  |                                                  ||21865  |                                                  
22292  |                    '2005/08/26　START            ||21866  |                    '2005/08/26　START            
22293  |                    '変数sStartに格納されている日 ||21867  |                    '変数sStartに格納されている日 
22294  |                    '変数sStartの直近の営業日の日 ||21868  |                    '変数sStartの直近の営業日の日 
22295  |                    '（変数sStartに格納されている ||21869  |                    '（変数sStartに格納されている 
22296  |                    '　直近日付が存在しない場合は ||21870  |                    '　直近日付が存在しない場合は 
22297  |                                                  ||21871  |                                                  
22298  |                    '== SQL6 ==                   ||21872  |                    '== SQL6 ==                   
22299  |                    sSql = ""                     ||21873  |                    sSql = ""                     
22300  |                    sSql = sSql & "SELECT MAX(BASE||21874  |                    sSql = sSql & "SELECT MAX(BASE
22301  |                    sSql = sSql & "FROM   CFR_DAIL||21875  |                    sSql = sSql & "FROM   CFR_DAIL
22302  |                    sSql = sSql & "WHERE  BASE_DAT||21876  |                    sSql = sSql & "WHERE  BASE_DAT
22303  |                    sSql = sSql & "AND    ACCOUNT_||21877  |                    sSql = sSql & "AND    ACCOUNT_
22304  |                                                  ||21878  |                                                  
22305  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||21879  |                    'ﾀﾞｲﾅｾｯﾄの作成                
22306  |                    If gintDyCreate(sSql) = False ||21880  |                    If gintDyCreate(sSql) = False 
22307  |                        Exit Function             ||21881  |                        Exit Function             
22308  |                    End If                        ||21882  |                    End If                        
22309  |                                                  ||21883  |                                                  
22310  |                    Do Until gblnDyEOF()          ||21884  |                    Do Until gblnDyEOF()          
22311  |                       '抽出データセット          ||21885  |                       '抽出データセット          
22312  |                        sStart = gvlnDyDataS("BASE||21886  |                        sStart = gvlnDyDataS("BASE
22313  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||21887  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
22314  |                        Call gDyNext              ||21888  |                        Call gDyNext              
22315  |                    Loop                          ||21889  |                    Loop                          
22316  |                                                  ||21890  |                                                  
22317  |                    'SQL文の作成(外部委託顧問料率 ||21891  |                    'SQL文の作成(外部委託顧問料率 
22318  |                    '計算期間の開始日と終了日に含 ||21892  |                    '計算期間の開始日と終了日に含 
22319  |                    sSql = gstrEditSQLcfr_OtherCom||21893  |                    sSql = gstrEditSQLcfr_OtherCom
22320  |                        ContNo, sStart, mstrNearSe||21894  |                        ContNo, sStart, mstrNearSe
22321  |                                                  ||21895  |                                                  
22322  |                     'ﾀﾞｲﾅｾｯﾄの作成               ||21896  |                     'ﾀﾞｲﾅｾｯﾄの作成               
22323  |                    If gintDyCreate(sSql) = False ||21897  |                    If gintDyCreate(sSql) = False 
22324  |                        Exit Function             ||21898  |                        Exit Function             
22325  |                    End If                        ||21899  |                    End If                        
22326  |                    '配列初期化                   ||21900  |                    '配列初期化                   
22327  |                    ReDim gbuOtherComRateGetUPDRec||21901  |                    ReDim gbuOtherComRateGetUPDRec
22328  |                    MonthlyCnt = 0                ||21902  |                    MonthlyCnt = 0                
22329  |                    'EOF判定処理                  ||21903  |                    'EOF判定処理                  
22330  |                    Do Until gblnDyEOF()          ||21904  |                    Do Until gblnDyEOF()          
22331  |                        '対象データ抽出           ||21905  |                        '対象データ抽出           
22332  |                        Call sbOtherComDataGet(Mon||21906  |                        Call sbOtherComDataGet(Mon
22333  |                        MonthlyCnt = MonthlyCnt + ||21907  |                        MonthlyCnt = MonthlyCnt + 
22334  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||21908  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
22335  |                        Call gDyNext              ||21909  |                        Call gDyNext              
22336  |                    Loop                          ||21910  |                    Loop                          
22337  |                                                  ||21911  |                                                  
22338  |                    '期中料率変更用配列のクリア   ||21912  |                    '期中料率変更用配列のクリア   
22339  |                    Erase gtypOtherComRec         ||21913  |                    Erase gtypOtherComRec         
22340  |                                                  ||21914  |                                                  
22341  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||21915  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
22342  |                    '期中料率変更対象契約         ||21916  |                    '期中料率変更対象契約         
22343  |                    '外部委託顧問料率を定義体配列 ||21917  |                    '外部委託顧問料率を定義体配列 
22344  |                    If fnSetOtherComRate(gbuMGetUP||21918  |                    If fnSetOtherComRate(gbuMGetUP
22345  |                                         msAssetFl||21919  |                                         msAssetFl
22346  |                                         gbuMGetUP||21920  |                                         gbuMGetUP
22347  |                                         conDBasse||21921  |                                         conDBasse
22348  |                                         sStart, _||21922  |                                         sStart, _
22349  |                                         StartFlg)||21923  |                                         StartFlg)
22350  |                        Exit Function             ||21924  |                        Exit Function             
22351  |                    End If                        ||21925  |                    End If                        
22352  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||21926  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
22353  |                                                  ||21927  |                                                  
22354  |                    'RAFI対応 START               ||21928  |                    'RAFI対応 START               
22355  |                    '純資産の場合                 ||21929  |                    '純資産の場合                 
22356  |                    If msAssetFlg = "0" Then      ||21930  |                    If msAssetFlg = "0" Then      
22357  |                        '計算開始日から計算終了日 ||21931  |                        '計算開始日から計算終了日 
22358  |                        '== SQL7 ==               ||21932  |                        '== SQL7 ==               
22359  |                        sSql = ""                 ||21933  |                        sSql = ""                 
22360  |                        sSql = sSql & "SELECT ACCO||21934  |                        sSql = sSql & "SELECT ACCO
22361  |                        sSql = sSql & "WHERE CFR_D||21935  |                        sSql = sSql & "WHERE CFR_D
22362  |                        sSql = sSql & "AND   (CFR_||21936  |                        sSql = sSql & "AND   (CFR_
22363  |                        sSql = sSql & "ORDER BY CF||21937  |                        sSql = sSql & "ORDER BY CF
22364  |                    'マザー組入資産の場合         ||21938  |                    'マザー組入資産の場合         
22365  |                    Else                          ||21939  |                    Else                          
22366  |                        '計算開始日から計算終了日 ||21940  |                        '計算開始日から計算終了日 
22367  |                        '== SQL8 ==               ||21941  |                        '== SQL8 ==               
22368  |                        sSql = ""                 ||21942  |                        sSql = ""                 
22369  |                        sSql = sSql & "SELECT"    ||21943  |                        sSql = sSql & "SELECT"    
22370  |                        sSql = sSql & "    a.ACCOU||21944  |                        sSql = sSql & "    a.ACCOU
22371  |                        sSql = sSql & "    a.BASE_||21945  |                        sSql = sSql & "    a.BASE_
22372  |                        sSql = sSql & "    a.MARKE||21946  |                        sSql = sSql & "    a.MARKE
22373  |                        sSql = sSql & "    b.BABY_||21947  |                        sSql = sSql & "    b.BABY_
22374  |                        sSql = sSql & "    b.BABY_||21948  |                        sSql = sSql & "    b.BABY_
22375  |                        sSql = sSql & " FROM"     ||21949  |                        sSql = sSql & " FROM"     
22376  |                        sSql = sSql & "    CFR_DAI||21950  |                        sSql = sSql & "    CFR_DAI
22377  |                        sSql = sSql & " WHERE"    ||21951  |                        sSql = sSql & " WHERE"    
22378  |                        sSql = sSql & "    b.BABY_||21952  |                        sSql = sSql & "    b.BABY_
22379  |                        sSql = sSql & "    b.MOTHE||21953  |                        sSql = sSql & "    b.MOTHE
22380  |                        sSql = sSql & "    b.BASE_||21954  |                        sSql = sSql & "    b.BASE_
22381  |                        sSql = sSql & "    a.ACCOU||21955  |                        sSql = sSql & "    a.ACCOU
22382  |                        sSql = sSql & "    (a.BASE||21956  |                        sSql = sSql & "    (a.BASE
22383  |                        sSql = sSql & "    a.BASE_||21957  |                        sSql = sSql & "    a.BASE_
22384  |                        sSql = sSql & " ORDER BY" ||21958  |                        sSql = sSql & " ORDER BY" 
22385  |                        sSql = sSql & "    a.BASE_||21959  |                        sSql = sSql & "    a.BASE_
22386  |                    End If                        ||21960  |                    End If                        
22387  |                    'RAFI対応 END                 ||21961  |                    'RAFI対応 END                 
22388  |                                                  ||21962  |                                                  
22389  |                    If gintDyCreate(sSql) = False ||21963  |                    If gintDyCreate(sSql) = False 
22390  |                        Exit Function             ||21964  |                        Exit Function             
22391  |                    End If                        ||21965  |                    End If                        
22392  |                                                  ||21966  |                                                  
22393  |                    dlngCntsv = dlngCnt           ||21967  |                    dlngCntsv = dlngCnt           
22394  |                    dlngCnt = 0                   ||21968  |                    dlngCnt = 0                   
22395  |                                                  ||21969  |                                                  
22396  |                    Do Until gblnDyEOF()          ||21970  |                    Do Until gblnDyEOF()          
22397  |                        dlngCnt = dlngCnt + 1     ||21971  |                        dlngCnt = dlngCnt + 1     
22398  |                        '抽出データセット         ||21972  |                        '抽出データセット         
22399  |                        dstrBasedate = gvlnDyDataS||21973  |                        dstrBasedate = gvlnDyDataS
22400  |                        If Mid(dstrCaldate(dlngCnt||21974  |                        If Mid(dstrCaldate(dlngCnt
22401  |                            'RAFI対応 START       ||21975  |                            'RAFI対応 START       
22402  |                            '純資産の場合         ||21976  |                            '純資産の場合         
22403  |                            If msAssetFlg = "0" Th||21977  |                            If msAssetFlg = "0" Th
22404  |                                ddblDailynav(dlngC||21978  |                                ddblDailynav(dlngC
22405  |                            'マザー組入資産の場合 ||21979  |                            'マザー組入資産の場合 
22406  |                            Else                  ||21980  |                            Else                  
22407  |                                ddblDailynav(dlngC||21981  |                                ddblDailynav(dlngC
22408  |                            End If                ||21982  |                            End If                
22409  |                            'RAFI対応 END         ||21983  |                            'RAFI対応 END         
22410  |                        Else                      ||21984  |                        Else                      
22411  |                            '計算開始日が外部委託 ||21985  |                            '計算開始日が外部委託 
22412  |                            If ddblNearNav <> 0 _ ||21986  |                            If ddblNearNav <> 0 _ 
22413  |                            And dlngCnt = 1 Then  ||21987  |                            And dlngCnt = 1 Then  
22414  |                                dstrCaldate2 = Mid||21988  |                                dstrCaldate2 = Mid
22415  |                                dstrBasedate2 = Mi||21989  |                                dstrBasedate2 = Mi
22416  |                                dlngDiffdate = Dat||21990  |                                dlngDiffdate = Dat
22417  |                                                  ||21991  |                                                  
22418  |                                For dintFor2 = 1 T||21992  |                                For dintFor2 = 1 T
22419  |                                    'RAFI対応 STAR||21993  |                                    'RAFI対応 STAR
22420  |                                    '純資産の場合 ||21994  |                                    '純資産の場合 
22421  |                                    If msAssetFlg ||21995  |                                    If msAssetFlg 
22422  |                                        ddblDailyn||21996  |                                        ddblDailyn
22423  |                                    'マザー組入資 ||21997  |                                    'マザー組入資 
22424  |                                    Else          ||21998  |                                    Else          
22425  |                                        ddblDailyn||21999  |                                        ddblDailyn
22426  |                                    End If        ||22000  |                                    End If        
22427  |                                    'RAFI対応 END ||22001  |                                    'RAFI対応 END 
22428  |                                    dlngCnt = dlng||22002  |                                    dlngCnt = dlng
22429  |                                Next dintFor2     ||22003  |                                Next dintFor2     
22430  |                                '純資産の場合     ||22004  |                                '純資産の場合     
22431  |                                If msAssetFlg = "0||22005  |                                If msAssetFlg = "0
22432  |                                    ddblDailynav(d||22006  |                                    ddblDailynav(d
22433  |                                'マザー組入資産の ||22007  |                                'マザー組入資産の 
22434  |                                Else              ||22008  |                                Else              
22435  |                                    ddblDailynav(d||22009  |                                    ddblDailynav(d
22436  |                                End If            ||22010  |                                End If            
22437  |                                'RAFI対応 END     ||22011  |                                'RAFI対応 END     
22438  |                            Else                  ||22012  |                            Else                  
22439  |                                '日次時価総額にデ ||22013  |                                '日次時価総額にデ 
22440  |                                dstrCaldate2 = Mid||22014  |                                dstrCaldate2 = Mid
22441  |                                dstrBasedate2 = Mi||22015  |                                dstrBasedate2 = Mi
22442  |                                dlngDiffdate = Dat||22016  |                                dlngDiffdate = Dat
22443  |                                                  ||22017  |                                                  
22444  |                                For dintFor2 = 1 T||22018  |                                For dintFor2 = 1 T
22445  |                                    If ddblDailyna||22019  |                                    If ddblDailyna
22446  |                                        ddblDailyn||22020  |                                        ddblDailyn
22447  |                                    Else          ||22021  |                                    Else          
22448  |                                        '日次NAVに||22022  |                                        '日次NAVに
22449  |                                        intRtn = M||22023  |                                        intRtn = M
22450  |                                        vbLf & "対||22024  |                                        vbLf & "対
22451  |                                        vbLf & "基||22025  |                                        vbLf & "基
22452  |                                            vbCrit||22026  |                                            vbCrit
22453  |                                        Exit Funct||22027  |                                        Exit Funct
22454  |                                    End If        ||22028  |                                    End If        
22455  |                                    dlngCnt = dlng||22029  |                                    dlngCnt = dlng
22456  |                                Next dintFor2     ||22030  |                                Next dintFor2     
22457  |                                'RAFI対応 START   ||22031  |                                'RAFI対応 START   
22458  |                                '純資産の場合     ||22032  |                                '純資産の場合     
22459  |                                If msAssetFlg = "0||22033  |                                If msAssetFlg = "0
22460  |                                    ddblDailynav(d||22034  |                                    ddblDailynav(d
22461  |                                'マザー組入資産の ||22035  |                                'マザー組入資産の 
22462  |                                Else              ||22036  |                                Else              
22463  |                                    ddblDailynav(d||22037  |                                    ddblDailynav(d
22464  |                                End If            ||22038  |                                End If            
22465  |                                'RAFI対応 END     ||22039  |                                'RAFI対応 END     
22466  |                            End If                ||22040  |                            End If                
22467  |                                                  ||22041  |                                                  
22468  |                        End If                    ||22042  |                        End If                    
22469  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||22043  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
22470  |                        Call gDyNext              ||22044  |                        Call gDyNext              
22471  |                    Loop                          ||22045  |                    Loop                          
22472  |                                                  ||22046  |                                                  
22473  |                Next dintFor                      ||22047  |                Next dintFor                      
22474  |                                                  ||22048  |                                                  
22475  |                If dlngCntsv <> dlngCnt Then      ||22049  |                If dlngCntsv <> dlngCnt Then      
22476  |                    For dintFor2 = dlngCnt + 1 To ||22050  |                    For dintFor2 = dlngCnt + 1 To 
22477  |                        ddblDailynav(dintFor2) = d||22051  |                        ddblDailynav(dintFor2) = d
22478  |                    Next dintFor2                 ||22052  |                    Next dintFor2                 
22479  |                    dlngCnt = dlngCntsv           ||22053  |                    dlngCnt = dlngCntsv           
22480  |                End If                            ||22054  |                End If                            
22481  |                                                  ||22055  |                                                  
22482  |                ddblTtalnav = 0                   ||22056  |                ddblTtalnav = 0                   
22483  |                                                  ||22057  |                                                  
22484  |                For dintFor2 = 1 To dlngCnt       ||22058  |                For dintFor2 = 1 To dlngCnt       
22485  |                    ddblTtalnav = ddblTtalnav + dd||22059  |                    ddblTtalnav = ddblTtalnav + dd
22486  |                Next dintFor2                     ||22060  |                Next dintFor2                     
22487  |                                                  ||22061  |                                                  
22488  |                'カレンダーを元に日次時価総額を配 ||22062  |                'カレンダーを元に日次時価総額を配 
22489  |                K = 0                             ||22063  |                K = 0                             
22490  |                For i = 1 To dlngCnt              ||22064  |                For i = 1 To dlngCnt              
22491  |                    '計算開始日の日次時価総額は無 ||22065  |                    '計算開始日の日次時価総額は無 
22492  |                    If i = 1 Then                 ||22066  |                    If i = 1 Then                 
22493  |                        gtypOtherComRec(K).APPLY_T||22067  |                        gtypOtherComRec(K).APPLY_T
22494  |                    Else                          ||22068  |                    Else                          
22495  |                        '適用終了日に成るまで累積 ||22069  |                        '適用終了日に成るまで累積 
22496  |                        If Mid(dstrCaldate(i), 1, ||22070  |                        If Mid(dstrCaldate(i), 1, 
22497  |                            gtypOtherComRec(K).APP||22071  |                            gtypOtherComRec(K).APP
22498  |                        'カレンダー日付が適用終了 ||22072  |                        'カレンダー日付が適用終了 
22499  |                        Else                      ||22073  |                        Else                      
22500  |                            '料率変更毎に平均NAVを||22074  |                            '料率変更毎に平均NAVを
22501  |                            gtypOtherComRec(K).APP||22075  |                            gtypOtherComRec(K).APP
22502  |                            '次の料率へシフトする ||22076  |                            '次の料率へシフトする 
22503  |                            K = K + 1             ||22077  |                            K = K + 1             
22504  |                            gtypOtherComRec(K).APP||22078  |                            gtypOtherComRec(K).APP
22505  |                        End If                    ||22079  |                        End If                    
22506  |                    End If                        ||22080  |                    End If                        
22507  |                    '最後のレコードの場合NAV平均を||22081  |                    '最後のレコードの場合NAV平均を
22508  |                    If i = dlngCnt Then           ||22082  |                    If i = dlngCnt Then           
22509  |                        '料率変更毎に平均NAVを算出||22083  |                        '料率変更毎に平均NAVを算出
22510  |                        gtypOtherComRec(K).APPLY_N||22084  |                        gtypOtherComRec(K).APPLY_N
22511  |                    End If                        ||22085  |                    End If                        
22512  |                Next i                            ||22086  |                Next i                            
22513  |                                                  ||22087  |                                                  
22514  |                iRowCnt = dlngCnt                 ||22088  |                iRowCnt = dlngCnt                 
22515  |                TotalNav = ddblTtalnav            ||22089  |                TotalNav = ddblTtalnav            
22516  |                dblValueIn = TotalNav             ||22090  |                dblValueIn = TotalNav             
22517  |                Call sbGetRoundValue2(dblValueIn) ||22091  |                Call sbGetRoundValue2(dblValueIn) 
22518  |                TotalNav = dblValueOut            ||22092  |                TotalNav = dblValueOut            
22519  |                                                  ||22093  |                                                  
22520  |                '平均純資産総額                   ||22094  |                '平均純資産総額                   
22521  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||22095  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
22522  |                '取得NAV区分が4:日次時価総額平均の||22096  |                '取得NAV区分が4:日次時価総額平均の
22523  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||22097  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
22524  |                    .Cells(43, 2).Value = sWord70a||22098  |                    .Cells(43, 2).Value = sWord70a
22525  |                Else                              ||22099  |                Else                              
22526  |                    .Cells(43, 2).Value = sWord51a||22100  |                    .Cells(43, 2).Value = sWord51a
22527  |                End If                            ||22101  |                End If                            
22528  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||22102  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
22529  |                .Cells(43, 16).Value = sWord19    ||22103  |                .Cells(43, 16).Value = sWord19    
22530  |                '平均純資産総額は別紙に記載       ||22104  |                '平均純資産総額は別紙に記載       
22531  |                strWord = ""                      ||22105  |                strWord = ""                      
22532  |                strWord = strWord & sWord53a & """||22106  |                strWord = strWord & sWord53a & """
22533  |                Select Case Mid(gbuMGetUPDRec.N(lR||22107  |                Select Case Mid(gbuMGetUPDRec.N(lR
22534  |                    Case Mid(mstrContractFlag(1), ||22108  |                    Case Mid(mstrContractFlag(1), 
22535  |                        strWord = strWord & sWord5||22109  |                        strWord = strWord & sWord5
22536  |                    Case Mid(mstrContractFlag(2), ||22110  |                    Case Mid(mstrContractFlag(2), 
22537  |                        strWord = strWord & sWord5||22111  |                        strWord = strWord & sWord5
22538  |                    Case Mid(mstrContractFlag(3), ||22112  |                    Case Mid(mstrContractFlag(3), 
22539  |                        strWord = strWord & sWord5||22113  |                        strWord = strWord & sWord5
22540  |                    Case Else                     ||22114  |                    Case Else                     
22541  |                End Select                        ||22115  |                End Select                        
22542  |                .Cells(43, 19).Value = strWord    ||22116  |                .Cells(43, 19).Value = strWord    
22543  |                                                  ||22117  |                                                  
22544  |'                '計算期間の純資産総額の合計(月末 ||22118  |'                '計算期間の純資産総額の合計(月末 
22545  |'                .Cells(43, 28).NumberFormatLocal ||22119  |'                .Cells(43, 28).NumberFormatLocal 
22546  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||22120  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
22547  |'                    .Cells(43, 28).Value = CStr(F||22121  |'                    .Cells(43, 28).Value = CStr(F
22548  |'                Else                             ||22122  |'                Else                             
22549  |'                    .Cells(43, 28).Value = CStr(F||22123  |'                    .Cells(43, 28).Value = CStr(F
22550  |'                End If                           ||22124  |'                End If                           
22551  |'                .Cells(43, 28).HorizontalAlignmen||22125  |'                .Cells(43, 28).HorizontalAlignmen
22552  |'                                                 ||22126  |'                                                 
22553  |'                '計算期間の純資産総額の合計÷計算||22127  |'                '計算期間の純資産総額の合計÷計算
22554  |'                .Cells(43, 40).NumberFormatLocal ||22128  |'                .Cells(43, 40).NumberFormatLocal 
22555  |                dblValueIn = TotalNav / iRowCnt   ||22129  |                dblValueIn = TotalNav / iRowCnt   
22556  |                Call sbGetRoundValue(dblValueIn)  ||22130  |                Call sbGetRoundValue(dblValueIn)  
22557  |                                                  ||22131  |                                                  
22558  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||22132  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
22559  |'                    .Cells(43, 40).Value = CStr(F||22133  |'                    .Cells(43, 40).Value = CStr(F
22560  |'                Else                             ||22134  |'                Else                             
22561  |'                    .Cells(43, 40).Value = CStr(F||22135  |'                    .Cells(43, 40).Value = CStr(F
22562  |'                End If                           ||22136  |'                End If                           
22563  |                AvgNav = dblValueOut              ||22137  |                AvgNav = dblValueOut              
22564  |                                                  ||22138  |                                                  
22565  |                '÷??＝                           ||22139  |                '÷??＝                           
22566  |'                .Cells(43, 31).Value = sWord18 & ||22140  |'                .Cells(43, 31).Value = sWord18 & 
22567  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||22141  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
22568  |                                                  ||22142  |                                                  
22569  |'取得NAV区分[1]以外(取得NAV区分='2')              ||22143  |'取得NAV区分[1]以外(取得NAV区分='2')              
22570  |            Else                                  ||22144  |            Else                                  
22571  |                ddblTtalnav = 0                   ||22145  |                ddblTtalnav = 0                   
22572  |                For dintFor = 0 To NavGetCnt - 1  ||22146  |                For dintFor = 0 To NavGetCnt - 1  
22573  |                                                  ||22147  |                                                  
22574  |                    '日次NAV平均取得              ||22148  |                    '日次NAV平均取得              
22575  |                    sStart = gstrDateFormat2(CStr(||22149  |                    sStart = gstrDateFormat2(CStr(
22576  |                    sEnd = gstrDateFormat2(CStr(dE||22150  |                    sEnd = gstrDateFormat2(CStr(dE
22577  |                                                  ||22151  |                                                  
22578  |                    '計算開始日と外部委託顧問料計 ||22152  |                    '計算開始日と外部委託顧問料計 
22579  |                    If sStart = gbuMGetUPDRec.N(lR||22153  |                    If sStart = gbuMGetUPDRec.N(lR
22580  |                        '== SQL1 ==               ||22154  |                        '== SQL1 ==               
22581  |                        sSql = ""                 ||22155  |                        sSql = ""                 
22582  |                        sSql = sSql & "SELECT EIGY||22156  |                        sSql = sSql & "SELECT EIGY
22583  |                                                  ||22157  |                                                  
22584  |                        'ﾀﾞｲﾅｾｯﾄの作成            ||22158  |                        'ﾀﾞｲﾅｾｯﾄの作成            
22585  |                        If gintDyCreate(sSql) = Fa||22159  |                        If gintDyCreate(sSql) = Fa
22586  |                            Exit Function         ||22160  |                            Exit Function         
22587  |                         Else                     ||22161  |                         Else                     
22588  |                            '休日の場合、翌営業日 ||22162  |                            '休日の場合、翌営業日 
22589  |                            If gvlnDyDataS("EIGYO_||22163  |                            If gvlnDyDataS("EIGYO_
22590  |                                '翌営業日のNAVを取||22164  |                                '翌営業日のNAVを取
22591  |                                '== SQL2 ==       ||22165  |                                '== SQL2 ==       
22592  |                                sSql = ""         ||22166  |                                sSql = ""         
22593  |                                sSql = sSql & "SEL||22167  |                                sSql = sSql & "SEL
22594  |                                sSql = sSql & "FRO||22168  |                                sSql = sSql & "FRO
22595  |                                sSql = sSql & "(SE||22169  |                                sSql = sSql & "(SE
22596  |                                sSql = sSql & "WHE||22170  |                                sSql = sSql & "WHE
22597  |                                                  ||22171  |                                                  
22598  |                                'ﾀﾞｲﾅｾｯﾄの作成    ||22172  |                                'ﾀﾞｲﾅｾｯﾄの作成    
22599  |                                If gintDyCreate(sS||22173  |                                If gintDyCreate(sS
22600  |                                    Exit Function ||22174  |                                    Exit Function 
22601  |                                Else              ||22175  |                                Else              
22602  |                                    ddblNearNav = ||22176  |                                    ddblNearNav = 
22603  |'2008/03/06 START 時価総額基準の外部委託顧問料対応||22177  |'2008/03/06 START 時価総額基準の外部委託顧問料対応
22604  |'                                    '翌営業日の計||22178  |'                                    '翌営業日の計
22605  |'                                    '== SQL3 ==  ||22179  |'                                    '== SQL3 ==  
22606  |'                                    sSql = ""    ||22180  |'                                    sSql = ""    
22607  |'                                    sSql = sSql &||22181  |'                                    sSql = sSql &
22608  |'                                    sSql = sSql &||22182  |'                                    sSql = sSql &
22609  |'                                    sSql = sSql &||22183  |'                                    sSql = sSql &
22610  |'                                    sSql = sSql &||22184  |'                                    sSql = sSql &
22611  |'                                    'ﾀﾞｲﾅｾｯﾄの作 ||22185  |'                                    'ﾀﾞｲﾅｾｯﾄの作 
22612  |'                                    If gintDyCrea||22186  |'                                    If gintDyCrea
22613  |'                                        Exit Func||22187  |'                                        Exit Func
22614  |'                                     Else        ||22188  |'                                     Else        
22615  |'                                        '計算開始||22189  |'                                        '計算開始
22616  |'                                        sStart = ||22190  |'                                        sStart = 
22617  |'                                        dStart = ||22191  |'                                        dStart = 
22618  |'                                        '文言の冗||22192  |'                                        '文言の冗
22619  |''                                        .Cells(1||22193  |''                                        .Cells(1
22620  |''                                            CStr||22194  |''                                            CStr
22621  |'                                        .Cells(16||22195  |'                                        .Cells(16
22622  |'                                            CStr(||22196  |'                                            CStr(
22623  |'                                        iCalcNum ||22197  |'                                        iCalcNum 
22624  |'                                    End If       ||22198  |'                                    End If       
22625  |'2008/03/06 END   時価総額基準の外部委託顧問料対応||22199  |'2008/03/06 END   時価総額基準の外部委託顧問料対応
22626  |                                                  ||22200  |                                                  
22627  |                                    'SQL文の作成( ||22201  |                                    'SQL文の作成( 
22628  |                                    '計算期間の開 ||22202  |                                    '計算期間の開 
22629  |                                    sSql = gstrEdi||22203  |                                    sSql = gstrEdi
22630  |                                        ContNo, sS||22204  |                                        ContNo, sS
22631  |                                                  ||22205  |                                                  
22632  |                                     'ﾀﾞｲﾅｾｯﾄの作 ||22206  |                                     'ﾀﾞｲﾅｾｯﾄの作 
22633  |                                    If gintDyCreat||22207  |                                    If gintDyCreat
22634  |                                        Exit Funct||22208  |                                        Exit Funct
22635  |                                    End If        ||22209  |                                    End If        
22636  |                                    '配列初期化   ||22210  |                                    '配列初期化   
22637  |                                    ReDim gbuOther||22211  |                                    ReDim gbuOther
22638  |                                    MonthlyCnt = 0||22212  |                                    MonthlyCnt = 0
22639  |                                    'EOF判定処理  ||22213  |                                    'EOF判定処理  
22640  |                                    Do Until gblnD||22214  |                                    Do Until gblnD
22641  |                                        '対象デー ||22215  |                                        '対象デー 
22642  |                                        Call sbOth||22216  |                                        Call sbOth
22643  |                                        MonthlyCnt||22217  |                                        MonthlyCnt
22644  |                                        'ﾀﾞｲﾅｾｯﾄ次||22218  |                                        'ﾀﾞｲﾅｾｯﾄ次
22645  |                                        Call gDyNe||22219  |                                        Call gDyNe
22646  |                                    Loop          ||22220  |                                    Loop          
22647  |                                                  ||22221  |                                                  
22648  |                                    '期中料率変更 ||22222  |                                    '期中料率変更 
22649  |                                    Erase gtypOthe||22223  |                                    Erase gtypOthe
22650  |                                                  ||22224  |                                                  
22651  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||22225  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
22652  |                                    '期中料率変更 ||22226  |                                    '期中料率変更 
22653  |                                    '外部委託顧問 ||22227  |                                    '外部委託顧問 
22654  |                                    If fnSetOtherC||22228  |                                    If fnSetOtherC
22655  |                                                  ||22229  |                                                  
22656  |                                                  ||22230  |                                                  
22657  |                                                  ||22231  |                                                  
22658  |                                                  ||22232  |                                                  
22659  |                                                  ||22233  |                                                  
22660  |                                        Exit Funct||22234  |                                        Exit Funct
22661  |                                    End If        ||22235  |                                    End If        
22662  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||22236  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
22663  |                                                  ||22237  |                                                  
22664  |                                End If            ||22238  |                                End If            
22665  |                                'RAFI対応 START   ||22239  |                                'RAFI対応 START   
22666  |                                '翌営業日のマザー ||22240  |                                '翌営業日のマザー 
22667  |                                If msAssetFlg = "1||22241  |                                If msAssetFlg = "1
22668  |                                    '== SQL4 ==   ||22242  |                                    '== SQL4 ==   
22669  |                                    sSql = ""     ||22243  |                                    sSql = ""     
22670  |                                    sSql = sSql & ||22244  |                                    sSql = sSql & 
22671  |                                    sSql = sSql & ||22245  |                                    sSql = sSql & 
22672  |                                    sSql = sSql & ||22246  |                                    sSql = sSql & 
22673  |                                    sSql = sSql & ||22247  |                                    sSql = sSql & 
22674  |                                    sSql = sSql & ||22248  |                                    sSql = sSql & 
22675  |                                    sSql = sSql & ||22249  |                                    sSql = sSql & 
22676  |                                    sSql = sSql & ||22250  |                                    sSql = sSql & 
22677  |                                    sSql = sSql & ||22251  |                                    sSql = sSql & 
22678  |                                    sSql = sSql & ||22252  |                                    sSql = sSql & 
22679  |                                    sSql = sSql & ||22253  |                                    sSql = sSql & 
22680  |                                    sSql = sSql & ||22254  |                                    sSql = sSql & 
22681  |                                    sSql = sSql & ||22255  |                                    sSql = sSql & 
22682  |                                    sSql = sSql & ||22256  |                                    sSql = sSql & 
22683  |                                    sSql = sSql & ||22257  |                                    sSql = sSql & 
22684  |                                    sSql = sSql & ||22258  |                                    sSql = sSql & 
22685  |                                    sSql = sSql & ||22259  |                                    sSql = sSql & 
22686  |                                    sSql = sSql & ||22260  |                                    sSql = sSql & 
22687  |                                    sSql = sSql & ||22261  |                                    sSql = sSql & 
22688  |                                    sSql = sSql & ||22262  |                                    sSql = sSql & 
22689  |                                    sSql = sSql & ||22263  |                                    sSql = sSql & 
22690  |                                    sSql = sSql & ||22264  |                                    sSql = sSql & 
22691  |                                    sSql = sSql & ||22265  |                                    sSql = sSql & 
22692  |                                    sSql = sSql & ||22266  |                                    sSql = sSql & 
22693  |                                    sSql = sSql & ||22267  |                                    sSql = sSql & 
22694  |                                    'ﾀﾞｲﾅｾｯﾄの作成||22268  |                                    'ﾀﾞｲﾅｾｯﾄの作成
22695  |                                                  ||22269  |                                                  
22696  |                                    If gintDyCreat||22270  |                                    If gintDyCreat
22697  |                                        Exit Funct||22271  |                                        Exit Funct
22698  |                                    Else          ||22272  |                                    Else          
22699  |                                        ddblNearBa||22273  |                                        ddblNearBa
22700  |                                    End If        ||22274  |                                    End If        
22701  |                                End If            ||22275  |                                End If            
22702  |                                'RAFI対応 END     ||22276  |                                'RAFI対応 END     
22703  |                            End If                ||22277  |                            End If                
22704  |                        End If                    ||22278  |                        End If                    
22705  |                    End If                        ||22279  |                    End If                        
22706  |                    '== SQL5 ==                   ||22280  |                    '== SQL5 ==                   
22707  |                    sSql = ""                     ||22281  |                    sSql = ""                     
22708  |                    sSql = sSql & "SELECT CAL_YYYY||22282  |                    sSql = sSql & "SELECT CAL_YYYY
22709  |                    sSql = sSql & "WHERE CAL_YYYY ||22283  |                    sSql = sSql & "WHERE CAL_YYYY 
22710  |                                                  ||22284  |                                                  
22711  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||22285  |                    'ﾀﾞｲﾅｾｯﾄの作成                
22712  |                    If gintDyCreate(sSql) = False ||22286  |                    If gintDyCreate(sSql) = False 
22713  |                        Exit Function             ||22287  |                        Exit Function             
22714  |                    End If                        ||22288  |                    End If                        
22715  |                                                  ||22289  |                                                  
22716  |                    If dlngCnt = 0 Then           ||22290  |                    If dlngCnt = 0 Then           
22717  |                        ReDim dstrCaldate(gbxOraDy||22291  |                        ReDim dstrCaldate(gbxOraDy
22718  |                        ReDim ddblDailynav(gbxOraD||22292  |                        ReDim ddblDailynav(gbxOraD
22719  |                    End If                        ||22293  |                    End If                        
22720  |                                                  ||22294  |                                                  
22721  |                    'EOF判定処理                  ||22295  |                    'EOF判定処理                  
22722  |                    dlngCnt = 0                   ||22296  |                    dlngCnt = 0                   
22723  |                                                  ||22297  |                                                  
22724  |                    Do Until gblnDyEOF()          ||22298  |                    Do Until gblnDyEOF()          
22725  |                        dlngCnt = dlngCnt + 1     ||22299  |                        dlngCnt = dlngCnt + 1     
22726  |                        '抽出データセット         ||22300  |                        '抽出データセット         
22727  |                        dstrCaldate(dlngCnt) = gvl||22301  |                        dstrCaldate(dlngCnt) = gvl
22728  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||22302  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
22729  |                        Call gDyNext              ||22303  |                        Call gDyNext              
22730  |                    Loop                          ||22304  |                    Loop                          
22731  |                                                  ||22305  |                                                  
22732  |                    '2005/08/26　START            ||22306  |                    '2005/08/26　START            
22733  |                    '変数sStartに格納されている日 ||22307  |                    '変数sStartに格納されている日 
22734  |                    '変数sStartの直近の営業日の日 ||22308  |                    '変数sStartの直近の営業日の日 
22735  |                    '（変数sStartに格納されている ||22309  |                    '（変数sStartに格納されている 
22736  |                    '　直近日付が存在しない場合は ||22310  |                    '　直近日付が存在しない場合は 
22737  |                                                  ||22311  |                                                  
22738  |                    '== SQL6 ==                   ||22312  |                    '== SQL6 ==                   
22739  |                    sSql = ""                     ||22313  |                    sSql = ""                     
22740  |                    sSql = sSql & "SELECT MAX(BASE||22314  |                    sSql = sSql & "SELECT MAX(BASE
22741  |                    sSql = sSql & "FROM   CFR_DAIL||22315  |                    sSql = sSql & "FROM   CFR_DAIL
22742  |                    sSql = sSql & "WHERE  BASE_DAT||22316  |                    sSql = sSql & "WHERE  BASE_DAT
22743  |                    sSql = sSql & "AND    ACCOUNT_||22317  |                    sSql = sSql & "AND    ACCOUNT_
22744  |                                                  ||22318  |                                                  
22745  |                    'ﾀﾞｲﾅｾｯﾄの作成                ||22319  |                    'ﾀﾞｲﾅｾｯﾄの作成                
22746  |                    If gintDyCreate(sSql) = False ||22320  |                    If gintDyCreate(sSql) = False 
22747  |                        Exit Function             ||22321  |                        Exit Function             
22748  |                    End If                        ||22322  |                    End If                        
22749  |                                                  ||22323  |                                                  
22750  |                    Do Until gblnDyEOF()          ||22324  |                    Do Until gblnDyEOF()          
22751  |                       '抽出データセット          ||22325  |                       '抽出データセット          
22752  |                        sStart = gvlnDyDataS("BASE||22326  |                        sStart = gvlnDyDataS("BASE
22753  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||22327  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
22754  |                        Call gDyNext              ||22328  |                        Call gDyNext              
22755  |                    Loop                          ||22329  |                    Loop                          
22756  |                                                  ||22330  |                                                  
22757  |                    'SQL文の作成(外部委託顧問料率 ||22331  |                    'SQL文の作成(外部委託顧問料率 
22758  |                    '計算期間の開始日と終了日に含 ||22332  |                    '計算期間の開始日と終了日に含 
22759  |                    sSql = gstrEditSQLcfr_OtherCom||22333  |                    sSql = gstrEditSQLcfr_OtherCom
22760  |                        ContNo, sStart, mstrNearSe||22334  |                        ContNo, sStart, mstrNearSe
22761  |                                                  ||22335  |                                                  
22762  |                     'ﾀﾞｲﾅｾｯﾄの作成               ||22336  |                     'ﾀﾞｲﾅｾｯﾄの作成               
22763  |                    If gintDyCreate(sSql) = False ||22337  |                    If gintDyCreate(sSql) = False 
22764  |                        Exit Function             ||22338  |                        Exit Function             
22765  |                    End If                        ||22339  |                    End If                        
22766  |                    '配列初期化                   ||22340  |                    '配列初期化                   
22767  |                    ReDim gbuOtherComRateGetUPDRec||22341  |                    ReDim gbuOtherComRateGetUPDRec
22768  |                    MonthlyCnt = 0                ||22342  |                    MonthlyCnt = 0                
22769  |                    'EOF判定処理                  ||22343  |                    'EOF判定処理                  
22770  |                    Do Until gblnDyEOF()          ||22344  |                    Do Until gblnDyEOF()          
22771  |                        '対象データ抽出           ||22345  |                        '対象データ抽出           
22772  |                        Call sbOtherComDataGet(Mon||22346  |                        Call sbOtherComDataGet(Mon
22773  |                        MonthlyCnt = MonthlyCnt + ||22347  |                        MonthlyCnt = MonthlyCnt + 
22774  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||22348  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
22775  |                        Call gDyNext              ||22349  |                        Call gDyNext              
22776  |                    Loop                          ||22350  |                    Loop                          
22777  |                                                  ||22351  |                                                  
22778  |                    '期中料率変更用配列のクリア   ||22352  |                    '期中料率変更用配列のクリア   
22779  |                    Erase gtypOtherComRec         ||22353  |                    Erase gtypOtherComRec         
22780  |                                                  ||22354  |                                                  
22781  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||22355  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
22782  |                    '期中料率変更対象契約         ||22356  |                    '期中料率変更対象契約         
22783  |                    '外部委託顧問料率を定義体配列 ||22357  |                    '外部委託顧問料率を定義体配列 
22784  |                    If fnSetOtherComRate(gbuMGetUP||22358  |                    If fnSetOtherComRate(gbuMGetUP
22785  |                                         msAssetFl||22359  |                                         msAssetFl
22786  |                                         gbuMGetUP||22360  |                                         gbuMGetUP
22787  |                                         conDBasse||22361  |                                         conDBasse
22788  |                                         sStart, _||22362  |                                         sStart, _
22789  |                                         StartFlg)||22363  |                                         StartFlg)
22790  |                        Exit Function             ||22364  |                        Exit Function             
22791  |                    End If                        ||22365  |                    End If                        
22792  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||22366  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
22793  |                                                  ||22367  |                                                  
22794  |                    'RAFI対応 START               ||22368  |                    'RAFI対応 START               
22795  |                    '純資産の場合                 ||22369  |                    '純資産の場合                 
22796  |                    If msAssetFlg = "0" Then      ||22370  |                    If msAssetFlg = "0" Then      
22797  |                        '計算開始日から計算終了日 ||22371  |                        '計算開始日から計算終了日 
22798  |                        '== SQL7 ==               ||22372  |                        '== SQL7 ==               
22799  |                        sSql = ""                 ||22373  |                        sSql = ""                 
22800  |                        sSql = sSql & "SELECT ACCO||22374  |                        sSql = sSql & "SELECT ACCO
22801  |                        sSql = sSql & "WHERE (((CF||22375  |                        sSql = sSql & "WHERE (((CF
22802  |                        sSql = sSql & "AND ((CFR_D||22376  |                        sSql = sSql & "AND ((CFR_D
22803  |                        sSql = sSql & "AND ((CFR_D||22377  |                        sSql = sSql & "AND ((CFR_D
22804  |                        sSql = sSql & "ORDER BY CF||22378  |                        sSql = sSql & "ORDER BY CF
22805  |                    'マザー組入資産の場合         ||22379  |                    'マザー組入資産の場合         
22806  |                    Else                          ||22380  |                    Else                          
22807  |                        '計算開始日から計算終了日 ||22381  |                        '計算開始日から計算終了日 
22808  |                        '== SQL8 ==               ||22382  |                        '== SQL8 ==               
22809  |                        sSql = ""                 ||22383  |                        sSql = ""                 
22810  |                        sSql = sSql & "SELECT"    ||22384  |                        sSql = sSql & "SELECT"    
22811  |                        sSql = sSql & "    a.ACCOU||22385  |                        sSql = sSql & "    a.ACCOU
22812  |                        sSql = sSql & "    a.BASE_||22386  |                        sSql = sSql & "    a.BASE_
22813  |                        sSql = sSql & "    a.NET_A||22387  |                        sSql = sSql & "    a.NET_A
22814  |                        sSql = sSql & "    b.BABY_||22388  |                        sSql = sSql & "    b.BABY_
22815  |                        sSql = sSql & "    b.BABY_||22389  |                        sSql = sSql & "    b.BABY_
22816  |                        sSql = sSql & " FROM"     ||22390  |                        sSql = sSql & " FROM"     
22817  |                        sSql = sSql & "    CFR_DAI||22391  |                        sSql = sSql & "    CFR_DAI
22818  |                        sSql = sSql & " WHERE"    ||22392  |                        sSql = sSql & " WHERE"    
22819  |                        sSql = sSql & "    b.BABY_||22393  |                        sSql = sSql & "    b.BABY_
22820  |                        sSql = sSql & "    b.MOTHE||22394  |                        sSql = sSql & "    b.MOTHE
22821  |                        sSql = sSql & "    b.BASE_||22395  |                        sSql = sSql & "    b.BASE_
22822  |                        sSql = sSql & "    a.ACCOU||22396  |                        sSql = sSql & "    a.ACCOU
22823  |                        sSql = sSql & "    (a.BASE||22397  |                        sSql = sSql & "    (a.BASE
22824  |                        sSql = sSql & "    a.BASE_||22398  |                        sSql = sSql & "    a.BASE_
22825  |                        sSql = sSql & "    a.CURRE||22399  |                        sSql = sSql & "    a.CURRE
22826  |                        sSql = sSql & "    a.ASSET||22400  |                        sSql = sSql & "    a.ASSET
22827  |                        sSql = sSql & " ORDER BY" ||22401  |                        sSql = sSql & " ORDER BY" 
22828  |                        sSql = sSql & "    a.BASE_||22402  |                        sSql = sSql & "    a.BASE_
22829  |                    End If                        ||22403  |                    End If                        
22830  |                    'RAFI対応 END                 ||22404  |                    'RAFI対応 END                 
22831  |                                                  ||22405  |                                                  
22832  |                    If gintDyCreate(sSql) = False ||22406  |                    If gintDyCreate(sSql) = False 
22833  |                        Exit Function             ||22407  |                        Exit Function             
22834  |                    End If                        ||22408  |                    End If                        
22835  |                                                  ||22409  |                                                  
22836  |                    dlngCntsv = dlngCnt           ||22410  |                    dlngCntsv = dlngCnt           
22837  |                    dlngCnt = 0                   ||22411  |                    dlngCnt = 0                   
22838  |                                                  ||22412  |                                                  
22839  |                    Do Until gblnDyEOF()          ||22413  |                    Do Until gblnDyEOF()          
22840  |                        dlngCnt = dlngCnt + 1     ||22414  |                        dlngCnt = dlngCnt + 1     
22841  |                        '抽出データセット         ||22415  |                        '抽出データセット         
22842  |                        dstrBasedate = gvlnDyDataS||22416  |                        dstrBasedate = gvlnDyDataS
22843  |                        If Mid(dstrCaldate(dlngCnt||22417  |                        If Mid(dstrCaldate(dlngCnt
22844  |                            'RAFI対応 START       ||22418  |                            'RAFI対応 START       
22845  |                            '純資産の場合         ||22419  |                            '純資産の場合         
22846  |                            If msAssetFlg = "0" Th||22420  |                            If msAssetFlg = "0" Th
22847  |                                ddblDailynav(dlngC||22421  |                                ddblDailynav(dlngC
22848  |                            'マザー組入資産の場合 ||22422  |                            'マザー組入資産の場合 
22849  |                            Else                  ||22423  |                            Else                  
22850  |                                ddblDailynav(dlngC||22424  |                                ddblDailynav(dlngC
22851  |                            End If                ||22425  |                            End If                
22852  |                            'RAFI対応 END         ||22426  |                            'RAFI対応 END         
22853  |                        Else                      ||22427  |                        Else                      
22854  |                            '計算開始日が外部委託 ||22428  |                            '計算開始日が外部委託 
22855  |                            If ddblNearNav <> 0 _ ||22429  |                            If ddblNearNav <> 0 _ 
22856  |                            And dlngCnt = 1 Then  ||22430  |                            And dlngCnt = 1 Then  
22857  |                                dstrCaldate2 = Mid||22431  |                                dstrCaldate2 = Mid
22858  |                                dstrBasedate2 = Mi||22432  |                                dstrBasedate2 = Mi
22859  |                                dlngDiffdate = Dat||22433  |                                dlngDiffdate = Dat
22860  |                                                  ||22434  |                                                  
22861  |                                For dintFor2 = 1 T||22435  |                                For dintFor2 = 1 T
22862  |                                    'RAFI対応 STAR||22436  |                                    'RAFI対応 STAR
22863  |                                    '純資産の場合 ||22437  |                                    '純資産の場合 
22864  |                                    If msAssetFlg ||22438  |                                    If msAssetFlg 
22865  |                                        ddblDailyn||22439  |                                        ddblDailyn
22866  |                                    'マザー組入資 ||22440  |                                    'マザー組入資 
22867  |                                    Else          ||22441  |                                    Else          
22868  |                                        ddblDailyn||22442  |                                        ddblDailyn
22869  |                                    End If        ||22443  |                                    End If        
22870  |                                    'RAFI対応 END ||22444  |                                    'RAFI対応 END 
22871  |                                    dlngCnt = dlng||22445  |                                    dlngCnt = dlng
22872  |                                Next dintFor2     ||22446  |                                Next dintFor2     
22873  |                                '純資産の場合     ||22447  |                                '純資産の場合     
22874  |                                If msAssetFlg = "0||22448  |                                If msAssetFlg = "0
22875  |                                    ddblDailynav(d||22449  |                                    ddblDailynav(d
22876  |                                'マザー組入資産の ||22450  |                                'マザー組入資産の 
22877  |                                Else              ||22451  |                                Else              
22878  |                                    ddblDailynav(d||22452  |                                    ddblDailynav(d
22879  |                                End If            ||22453  |                                End If            
22880  |                                'RAFI対応 END     ||22454  |                                'RAFI対応 END     
22881  |                            Else                  ||22455  |                            Else                  
22882  |                                '日次NAVにデータが||22456  |                                '日次NAVにデータが
22883  |                                dstrCaldate2 = Mid||22457  |                                dstrCaldate2 = Mid
22884  |                                dstrBasedate2 = Mi||22458  |                                dstrBasedate2 = Mi
22885  |                                dlngDiffdate = Dat||22459  |                                dlngDiffdate = Dat
22886  |                                                  ||22460  |                                                  
22887  |                                For dintFor2 = 1 T||22461  |                                For dintFor2 = 1 T
22888  |                                    If ddblDailyna||22462  |                                    If ddblDailyna
22889  |                                        ddblDailyn||22463  |                                        ddblDailyn
22890  |                                    Else          ||22464  |                                    Else          
22891  |                                        '日次NAVに||22465  |                                        '日次NAVに
22892  |                                        intRtn = M||22466  |                                        intRtn = M
22893  |                                        vbLf & "対||22467  |                                        vbLf & "対
22894  |                                        vbLf & "基||22468  |                                        vbLf & "基
22895  |                                            vbCrit||22469  |                                            vbCrit
22896  |                                        Exit Funct||22470  |                                        Exit Funct
22897  |                                    End If        ||22471  |                                    End If        
22898  |                                    dlngCnt = dlng||22472  |                                    dlngCnt = dlng
22899  |                                Next dintFor2     ||22473  |                                Next dintFor2     
22900  |                                'RAFI対応 START   ||22474  |                                'RAFI対応 START   
22901  |                                '純資産の場合     ||22475  |                                '純資産の場合     
22902  |                                If msAssetFlg = "0||22476  |                                If msAssetFlg = "0
22903  |                                    ddblDailynav(d||22477  |                                    ddblDailynav(d
22904  |                                'マザー組入資産の ||22478  |                                'マザー組入資産の 
22905  |                                Else              ||22479  |                                Else              
22906  |                                    ddblDailynav(d||22480  |                                    ddblDailynav(d
22907  |                                End If            ||22481  |                                End If            
22908  |                                'RAFI対応 END     ||22482  |                                'RAFI対応 END     
22909  |                            End If                ||22483  |                            End If                
22910  |                                                  ||22484  |                                                  
22911  |                        End If                    ||22485  |                        End If                    
22912  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         ||22486  |                        'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ         
22913  |                        Call gDyNext              ||22487  |                        Call gDyNext              
22914  |                    Loop                          ||22488  |                    Loop                          
22915  |                                                  ||22489  |                                                  
22916  |                Next dintFor                      ||22490  |                Next dintFor                      
22917  |                                                  ||22491  |                                                  
22918  |                If dlngCntsv <> dlngCnt Then      ||22492  |                If dlngCntsv <> dlngCnt Then      
22919  |                    For dintFor2 = dlngCnt + 1 To ||22493  |                    For dintFor2 = dlngCnt + 1 To 
22920  |                        ddblDailynav(dintFor2) = d||22494  |                        ddblDailynav(dintFor2) = d
22921  |                    Next dintFor2                 ||22495  |                    Next dintFor2                 
22922  |                    dlngCnt = dlngCntsv           ||22496  |                    dlngCnt = dlngCntsv           
22923  |                End If                            ||22497  |                End If                            
22924  |                                                  ||22498  |                                                  
22925  |                ddblTtalnav = 0                   ||22499  |                ddblTtalnav = 0                   
22926  |                                                  ||22500  |                                                  
22927  |                For dintFor2 = 1 To dlngCnt       ||22501  |                For dintFor2 = 1 To dlngCnt       
22928  |                    ddblTtalnav = ddblTtalnav + dd||22502  |                    ddblTtalnav = ddblTtalnav + dd
22929  |                Next dintFor2                     ||22503  |                Next dintFor2                     
22930  |                                                  ||22504  |                                                  
22931  |                'カレンダーを元に日次NAVを配列より||22505  |                'カレンダーを元に日次NAVを配列より
22932  |                K = 0                             ||22506  |                K = 0                             
22933  |                For i = 1 To dlngCnt              ||22507  |                For i = 1 To dlngCnt              
22934  |                    '計算開始日の日次NAVは無条件に||22508  |                    '計算開始日の日次NAVは無条件に
22935  |                    If i = 1 Then                 ||22509  |                    If i = 1 Then                 
22936  |                        gtypOtherComRec(K).APPLY_T||22510  |                        gtypOtherComRec(K).APPLY_T
22937  |                    Else                          ||22511  |                    Else                          
22938  |                        '適用終了日に成るまで累積 ||22512  |                        '適用終了日に成るまで累積 
22939  |                        If Mid(dstrCaldate(i), 1, ||22513  |                        If Mid(dstrCaldate(i), 1, 
22940  |                            gtypOtherComRec(K).APP||22514  |                            gtypOtherComRec(K).APP
22941  |                        'カレンダー日付が適用終了 ||22515  |                        'カレンダー日付が適用終了 
22942  |                        Else                      ||22516  |                        Else                      
22943  |                            '料率変更毎に平均NAVを||22517  |                            '料率変更毎に平均NAVを
22944  |                            gtypOtherComRec(K).APP||22518  |                            gtypOtherComRec(K).APP
22945  |                            '次の料率へシフトする ||22519  |                            '次の料率へシフトする 
22946  |                            K = K + 1             ||22520  |                            K = K + 1             
22947  |                            gtypOtherComRec(K).APP||22521  |                            gtypOtherComRec(K).APP
22948  |                        End If                    ||22522  |                        End If                    
22949  |                    End If                        ||22523  |                    End If                        
22950  |                    '最後のレコードの場合NAV平均を||22524  |                    '最後のレコードの場合NAV平均を
22951  |                    If i = dlngCnt Then           ||22525  |                    If i = dlngCnt Then           
22952  |                        '料率変更毎に平均NAVを算出||22526  |                        '料率変更毎に平均NAVを算出
22953  |                        gtypOtherComRec(K).APPLY_N||22527  |                        gtypOtherComRec(K).APPLY_N
22954  |                    End If                        ||22528  |                    End If                        
22955  |                Next i                            ||22529  |                Next i                            
22956  |                                                  ||22530  |                                                  
22957  |                iRowCnt = dlngCnt                 ||22531  |                iRowCnt = dlngCnt                 
22958  |                TotalNav = ddblTtalnav            ||22532  |                TotalNav = ddblTtalnav            
22959  |                dblValueIn = TotalNav             ||22533  |                dblValueIn = TotalNav             
22960  |                Call sbGetRoundValue2(dblValueIn) ||22534  |                Call sbGetRoundValue2(dblValueIn) 
22961  |                TotalNav = dblValueOut            ||22535  |                TotalNav = dblValueOut            
22962  |                                                  ||22536  |                                                  
22963  |                '平均純資産総額                   ||22537  |                '平均純資産総額                   
22964  |                .Cells(43, 2).Value = sWord51a    ||22538  |                .Cells(43, 2).Value = sWord51a    
22965  |                .Cells(43, 16).Value = sWord19    ||22539  |                .Cells(43, 16).Value = sWord19    
22966  |                '平均純資産総額は別紙に記載       ||22540  |                '平均純資産総額は別紙に記載       
22967  |                strWord = ""                      ||22541  |                strWord = ""                      
22968  |                strWord = strWord & sWord53a & """||22542  |                strWord = strWord & sWord53a & """
22969  |                Select Case Mid(gbuMGetUPDRec.N(lR||22543  |                Select Case Mid(gbuMGetUPDRec.N(lR
22970  |                    Case Mid(mstrContractFlag(1), ||22544  |                    Case Mid(mstrContractFlag(1), 
22971  |                        strWord = strWord & sWord5||22545  |                        strWord = strWord & sWord5
22972  |                    Case Mid(mstrContractFlag(2), ||22546  |                    Case Mid(mstrContractFlag(2), 
22973  |                        strWord = strWord & sWord5||22547  |                        strWord = strWord & sWord5
22974  |                    Case Mid(mstrContractFlag(3), ||22548  |                    Case Mid(mstrContractFlag(3), 
22975  |                        strWord = strWord & sWord5||22549  |                        strWord = strWord & sWord5
22976  |                    Case Else                     ||22550  |                    Case Else                     
22977  |                End Select                        ||22551  |                End Select                        
22978  |                .Cells(43, 19).Value = strWord    ||22552  |                .Cells(43, 19).Value = strWord    
22979  |                                                  ||22553  |                                                  
22980  |'                '計算期間の純資産総額の合計(月末 ||22554  |'                '計算期間の純資産総額の合計(月末 
22981  |'                .Cells(43, 28).NumberFormatLocal ||22555  |'                .Cells(43, 28).NumberFormatLocal 
22982  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||22556  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
22983  |'                    .Cells(43, 28).Value = CStr(F||22557  |'                    .Cells(43, 28).Value = CStr(F
22984  |'                Else                             ||22558  |'                Else                             
22985  |'                    .Cells(43, 28).Value = CStr(F||22559  |'                    .Cells(43, 28).Value = CStr(F
22986  |'                End If                           ||22560  |'                End If                           
22987  |'                .Cells(43, 28).HorizontalAlignmen||22561  |'                .Cells(43, 28).HorizontalAlignmen
22988  |'                                                 ||22562  |'                                                 
22989  |'                '計算期間の純資産総額の合計÷計算||22563  |'                '計算期間の純資産総額の合計÷計算
22990  |'                .Cells(43, 40).NumberFormatLocal ||22564  |'                .Cells(43, 40).NumberFormatLocal 
22991  |                dblValueIn = TotalNav / iRowCnt   ||22565  |                dblValueIn = TotalNav / iRowCnt   
22992  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b||22566  |                If gbuMGetUPDRec.N(lRecIdx).MGET_b
22993  |                    Call sbGetRoundValue2(dblValue||22567  |                    Call sbGetRoundValue2(dblValue
22994  |                Else                              ||22568  |                Else                              
22995  |                    Call sbGetRoundValue(dblValueI||22569  |                    Call sbGetRoundValue(dblValueI
22996  |                End If                            ||22570  |                End If                            
22997  |                                                  ||22571  |                                                  
22998  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_||22572  |'                If gbuMGetUPDRec.N(lRecIdx).MGET_
22999  |'                    .Cells(43, 40).Value = CStr(F||22573  |'                    .Cells(43, 40).Value = CStr(F
23000  |'                Else                             ||22574  |'                Else                             
23001  |'                    .Cells(43, 40).Value = CStr(F||22575  |'                    .Cells(43, 40).Value = CStr(F
23002  |'                End If                           ||22576  |'                End If                           
23003  |                AvgNav = dblValueOut              ||22577  |                AvgNav = dblValueOut              
23004  |                                                  ||22578  |                                                  
23005  |                '÷??＝                           ||22579  |                '÷??＝                           
23006  |'                .Cells(43, 31).Value = sWord18 & ||22580  |'                .Cells(43, 31).Value = sWord18 & 
23007  |            End If                                ||22581  |            End If                                
23008  |'契約区分：名称使用許諾料計算　かつ　日次NAV(休日 ||22582  |'契約区分：名称使用許諾料計算　かつ　日次NAV(休日 
23009  |        Else                                      ||22583  |        Else                                      
23010  |On Error GoTo OnErrorProc                         ||22584  |On Error GoTo OnErrorProc                         
23011  |                                                  ||22585  |                                                  
23012  |            '契約区分「3」の場合                  ||22586  |            '契約区分「3」の場合                  
23013  |            ddblTtalnav = 0                       ||22587  |            ddblTtalnav = 0                       
23014  |            For dintFor = 0 To NavGetCnt - 1      ||22588  |            For dintFor = 0 To NavGetCnt - 1      
23015  |                                                  ||22589  |                                                  
23016  |                '日次NAV平均取得                  ||22590  |                '日次NAV平均取得                  
23017  |                sStart = gstrDateFormat2(CStr(dSta||22591  |                sStart = gstrDateFormat2(CStr(dSta
23018  |                sEnd = gstrDateFormat2(CStr(dEnd),||22592  |                sEnd = gstrDateFormat2(CStr(dEnd),
23019  |                                                  ||22593  |                                                  
23020  |                'RAFI対応 START                   ||22594  |                'RAFI対応 START                   
23021  |                '純資産の場合                     ||22595  |                '純資産の場合                     
23022  |                If msAssetFlg = "0" Then          ||22596  |                If msAssetFlg = "0" Then          
23023  |                    '計算開始日から計算終了日まで ||22597  |                    '計算開始日から計算終了日まで 
23024  |                    sSql = ""                     ||22598  |                    sSql = ""                     
23025  |                    sSql = sSql & "SELECT ACCOUNT_||22599  |                    sSql = sSql & "SELECT ACCOUNT_
23026  |                    sSql = sSql & "WHERE (((CFR_DA||22600  |                    sSql = sSql & "WHERE (((CFR_DA
23027  |                    sSql = sSql & "AND ((CFR_DAILY||22601  |                    sSql = sSql & "AND ((CFR_DAILY
23028  |                    sSql = sSql & "AND ((CFR_DAILY||22602  |                    sSql = sSql & "AND ((CFR_DAILY
23029  |                    sSql = sSql & "ORDER BY CFR_DA||22603  |                    sSql = sSql & "ORDER BY CFR_DA
23030  |                'マザー組入資産の場合             ||22604  |                'マザー組入資産の場合             
23031  |                Else                              ||22605  |                Else                              
23032  |                    '計算開始日から計算終了日まで ||22606  |                    '計算開始日から計算終了日まで 
23033  |                    sSql = ""                     ||22607  |                    sSql = ""                     
23034  |                    sSql = sSql & "SELECT"        ||22608  |                    sSql = sSql & "SELECT"        
23035  |                    sSql = sSql & "    a.ACCOUNT_C||22609  |                    sSql = sSql & "    a.ACCOUNT_C
23036  |                    sSql = sSql & "    a.BASE_DATE||22610  |                    sSql = sSql & "    a.BASE_DATE
23037  |                    sSql = sSql & "    a.NET_ASSET||22611  |                    sSql = sSql & "    a.NET_ASSET
23038  |                    sSql = sSql & "    b.BABY_MOTH||22612  |                    sSql = sSql & "    b.BABY_MOTH
23039  |                    sSql = sSql & "    b.BABY_MOTH||22613  |                    sSql = sSql & "    b.BABY_MOTH
23040  |                    sSql = sSql & " FROM"         ||22614  |                    sSql = sSql & " FROM"         
23041  |                    sSql = sSql & "    CFR_DAILY_N||22615  |                    sSql = sSql & "    CFR_DAILY_N
23042  |                    sSql = sSql & " WHERE"        ||22616  |                    sSql = sSql & " WHERE"        
23043  |                    sSql = sSql & "    b.BABY_ACCO||22617  |                    sSql = sSql & "    b.BABY_ACCO
23044  |                    sSql = sSql & "    b.MOTHER_AC||22618  |                    sSql = sSql & "    b.MOTHER_AC
23045  |                    sSql = sSql & "    b.BASE_DATE||22619  |                    sSql = sSql & "    b.BASE_DATE
23046  |                    sSql = sSql & "    a.ACCOUNT_C||22620  |                    sSql = sSql & "    a.ACCOUNT_C
23047  |                    sSql = sSql & "    (a.BASE_DAT||22621  |                    sSql = sSql & "    (a.BASE_DAT
23048  |                    sSql = sSql & "    a.BASE_DATE||22622  |                    sSql = sSql & "    a.BASE_DATE
23049  |                    sSql = sSql & "    a.CURRENCY_||22623  |                    sSql = sSql & "    a.CURRENCY_
23050  |                    sSql = sSql & "    a.ASSET_TYP||22624  |                    sSql = sSql & "    a.ASSET_TYP
23051  |                    sSql = sSql & " ORDER BY"     ||22625  |                    sSql = sSql & " ORDER BY"     
23052  |                    sSql = sSql & "    a.BASE_DATE||22626  |                    sSql = sSql & "    a.BASE_DATE
23053  |                End If                            ||22627  |                End If                            
23054  |                'RAFI対応 END                     ||22628  |                'RAFI対応 END                     
23055  |                                                  ||22629  |                                                  
23056  |                If gintDyCreate(sSql) = False Then||22630  |                If gintDyCreate(sSql) = False Then
23057  |                    Exit Function                 ||22631  |                    Exit Function                 
23058  |                End If                            ||22632  |                End If                            
23059  |                                                  ||22633  |                                                  
23060  |                If dlngCnt = 0 Then               ||22634  |                If dlngCnt = 0 Then               
23061  |                    ReDim dstrCaldate(gbxOraDynase||22635  |                    ReDim dstrCaldate(gbxOraDynase
23062  |                    ReDim ddblDailynav(gbxOraDynas||22636  |                    ReDim ddblDailynav(gbxOraDynas
23063  |                End If                            ||22637  |                End If                            
23064  |                                                  ||22638  |                                                  
23065  |                dlngCnt = 0                       ||22639  |                dlngCnt = 0                       
23066  |                                                  ||22640  |                                                  
23067  |                Do Until gblnDyEOF()              ||22641  |                Do Until gblnDyEOF()              
23068  |                    dlngCnt = dlngCnt + 1         ||22642  |                    dlngCnt = dlngCnt + 1         
23069  |                    'RAFI対応 START               ||22643  |                    'RAFI対応 START               
23070  |                    '純資産の場合                 ||22644  |                    '純資産の場合                 
23071  |                    If msAssetFlg = "0" Then      ||22645  |                    If msAssetFlg = "0" Then      
23072  |                        '抽出データセット         ||22646  |                        '抽出データセット         
23073  |                        dstrCaldate(dlngCnt) = gvl||22647  |                        dstrCaldate(dlngCnt) = gvl
23074  |                        ddblDailynav(dlngCnt) = dd||22648  |                        ddblDailynav(dlngCnt) = dd
23075  |                    'マザー組入資産の場合         ||22649  |                    'マザー組入資産の場合         
23076  |                    Else                          ||22650  |                    Else                          
23077  |                        dstrCaldate(dlngCnt) = gvl||22651  |                        dstrCaldate(dlngCnt) = gvl
23078  |                        ddblDailynav(dlngCnt) = dd||22652  |                        ddblDailynav(dlngCnt) = dd
23079  |                    End If                        ||22653  |                    End If                        
23080  |                    'RAFI対応 END                 ||22654  |                    'RAFI対応 END                 
23081  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             ||22655  |                    'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ             
23082  |                    Call gDyNext                  ||22656  |                    Call gDyNext                  
23083  |                Loop                              ||22657  |                Loop                              
23084  |                                                  ||22658  |                                                  
23085  |            Next dintFor                          ||22659  |            Next dintFor                          
23086  |                                                  ||22660  |                                                  
23087  |            ddblTtalnav = 0                       ||22661  |            ddblTtalnav = 0                       
23088  |                                                  ||22662  |                                                  
23089  |            For dintFor2 = 1 To dlngCnt           ||22663  |            For dintFor2 = 1 To dlngCnt           
23090  |                ddblTtalnav = ddblTtalnav + ddblDa||22664  |                ddblTtalnav = ddblTtalnav + ddblDa
23091  |            Next dintFor2                         ||22665  |            Next dintFor2                         
23092  |                                                  ||22666  |                                                  
23093  |            'SQL文の作成(外部委託顧問料率取得)    ||22667  |            'SQL文の作成(外部委託顧問料率取得)    
23094  |            '計算期間の開始日と終了日に含まれる適 ||22668  |            '計算期間の開始日と終了日に含まれる適 
23095  |            sSql = gstrEditSQLcfr_OtherComRateForS||22669  |            sSql = gstrEditSQLcfr_OtherComRateForS
23096  |                ContNo, sStart, sEnd)             ||22670  |                ContNo, sStart, sEnd)             
23097  |                                                  ||22671  |                                                  
23098  |             'ﾀﾞｲﾅｾｯﾄの作成                       ||22672  |             'ﾀﾞｲﾅｾｯﾄの作成                       
23099  |            If gintDyCreate(sSql) = False Then    ||22673  |            If gintDyCreate(sSql) = False Then    
23100  |                Exit Function                     ||22674  |                Exit Function                     
23101  |            End If                                ||22675  |            End If                                
23102  |            '配列初期化                           ||22676  |            '配列初期化                           
23103  |            ReDim gbuOtherComRateGetUPDRec.N(0)   ||22677  |            ReDim gbuOtherComRateGetUPDRec.N(0)   
23104  |            MonthlyCnt = 0                        ||22678  |            MonthlyCnt = 0                        
23105  |            'EOF判定処理                          ||22679  |            'EOF判定処理                          
23106  |            Do Until gblnDyEOF()                  ||22680  |            Do Until gblnDyEOF()                  
23107  |                '対象データ抽出                   ||22681  |                '対象データ抽出                   
23108  |                Call sbOtherComDataGet(MonthlyCnt)||22682  |                Call sbOtherComDataGet(MonthlyCnt)
23109  |                MonthlyCnt = MonthlyCnt + 1       ||22683  |                MonthlyCnt = MonthlyCnt + 1       
23110  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 ||22684  |                'ﾀﾞｲﾅｾｯﾄ次ﾚｺｰﾄﾞへ                 
23111  |                Call gDyNext                      ||22685  |                Call gDyNext                      
23112  |            Loop                                  ||22686  |            Loop                                  
23113  |                                                  ||22687  |                                                  
23114  |            '期中料率変更用配列のクリア           ||22688  |            '期中料率変更用配列のクリア           
23115  |            Erase gtypOtherComRec                 ||22689  |            Erase gtypOtherComRec                 
23116  |                                                  ||22690  |                                                  
23117  |'2008/03/03 START 時価総額基準の外部委託顧問料対応||22691  |'2008/03/03 START 時価総額基準の外部委託顧問料対応
23118  |            '期中料率変更対象契約                 ||22692  |            '期中料率変更対象契約                 
23119  |            '外部委託顧問料率を定義体配列にセット ||22693  |            '外部委託顧問料率を定義体配列にセット 
23120  |            If fnSetOtherComRate(gbuMGetUPDRec.N(l||22694  |            If fnSetOtherComRate(gbuMGetUPDRec.N(l
23121  |                                 msAssetFlg, msBab||22695  |                                 msAssetFlg, msBab
23122  |                                 gbuMGetUPDRec.N(l||22696  |                                 gbuMGetUPDRec.N(l
23123  |                                 conDBasset_type_c||22697  |                                 conDBasset_type_c
23124  |                                 " ", _           ||22698  |                                 " ", _           
23125  |                                 "0") = False Then||22699  |                                 "0") = False Then
23126  |                Exit Function                     ||22700  |                Exit Function                     
23127  |            End If                                ||22701  |            End If                                
23128  |'2008/03/03 END   時価総額基準の外部委託顧問料対応||22702  |'2008/03/03 END   時価総額基準の外部委託顧問料対応
23129  |                                                  ||22703  |                                                  
23130  |            'カレンダーを元に日次NAVを配列より取得||22704  |            'カレンダーを元に日次NAVを配列より取得
23131  |            K = 0                                 ||22705  |            K = 0                                 
23132  |            For i = 1 To dlngCnt                  ||22706  |            For i = 1 To dlngCnt                  
23133  |                '計算開始日の日次NAVは無条件に累積||22707  |                '計算開始日の日次NAVは無条件に累積
23134  |                If i = 1 Then                     ||22708  |                If i = 1 Then                     
23135  |                    gtypOtherComRec(K).APPLY_TOTAL||22709  |                    gtypOtherComRec(K).APPLY_TOTAL
23136  |                Else                              ||22710  |                Else                              
23137  |                    '適用終了日に成るまで累積する ||22711  |                    '適用終了日に成るまで累積する 
23138  |                    If Mid(dstrCaldate(i), 1, 8) <||22712  |                    If Mid(dstrCaldate(i), 1, 8) <
23139  |                        gtypOtherComRec(K).APPLY_T||22713  |                        gtypOtherComRec(K).APPLY_T
23140  |                    'カレンダー日付が適用終了日を ||22714  |                    'カレンダー日付が適用終了日を 
23141  |                    Else                          ||22715  |                    Else                          
23142  |                        '料率変更毎に平均NAVを算出||22716  |                        '料率変更毎に平均NAVを算出
23143  |                        gtypOtherComRec(K).APPLY_N||22717  |                        gtypOtherComRec(K).APPLY_N
23144  |                        '次の料率へシフトする     ||22718  |                        '次の料率へシフトする     
23145  |                        K = K + 1                 ||22719  |                        K = K + 1                 
23146  |                        gtypOtherComRec(K).APPLY_T||22720  |                        gtypOtherComRec(K).APPLY_T
23147  |                    End If                        ||22721  |                    End If                        
23148  |                End If                            ||22722  |                End If                            
23149  |                '最後のレコードの場合NAV平均を求め||22723  |                '最後のレコードの場合NAV平均を求め
23150  |                If i = dlngCnt Then               ||22724  |                If i = dlngCnt Then               
23151  |                    '料率変更毎に平均NAVを算出し格||22725  |                    '料率変更毎に平均NAVを算出し格
23152  |                    gtypOtherComRec(K).APPLY_NAV_A||22726  |                    gtypOtherComRec(K).APPLY_NAV_A
23153  |                End If                            ||22727  |                End If                            
23154  |            Next i                                ||22728  |            Next i                                
23155  |                                                  ||22729  |                                                  
23156  |            iRowCnt = dlngCnt                     ||22730  |            iRowCnt = dlngCnt                     
23157  |            dlngMeisyoSu = dlngCnt                ||22731  |            dlngMeisyoSu = dlngCnt                
23158  |                                                  ||22732  |                                                  
23159  |            TotalNav = ddblTtalnav                ||22733  |            TotalNav = ddblTtalnav                
23160  |            dblValueIn = TotalNav                 ||22734  |            dblValueIn = TotalNav                 
23161  |            Call sbGetRoundValue2(dblValueIn)     ||22735  |            Call sbGetRoundValue2(dblValueIn)     
23162  |            TotalNav = dblValueOut                ||22736  |            TotalNav = dblValueOut                
23163  |                                                  ||22737  |                                                  
23164  |            '計算期間の純資産総額の合計÷計算期間 ||22738  |            '計算期間の純資産総額の合計÷計算期間 
23165  |            dblValueIn = TotalNav / iRowCnt       ||22739  |            dblValueIn = TotalNav / iRowCnt       
23166  |            iCalcNum = iRowCnt                    ||22740  |            iCalcNum = iRowCnt                    
23167  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||22741  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
23168  |                  Call sbGetRoundValue2(dblValueIn||22742  |                  Call sbGetRoundValue2(dblValueIn
23169  |            Else                                  ||22743  |            Else                                  
23170  |                  Call sbGetRoundValue(dblValueIn)||22744  |                  Call sbGetRoundValue(dblValueIn)
23171  |            End If                                ||22745  |            End If                                
23172  |            dstrAvgNav = dblValueOut              ||22746  |            dstrAvgNav = dblValueOut              
23173  |            AvgNav = dstrAvgNav                   ||22747  |            AvgNav = dstrAvgNav                   
23174  |                                                  ||22748  |                                                  
23175  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     ||22749  |            'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                     
23176  |            Call gblnDyClose                      ||22750  |            Call gblnDyClose                      
23177  |                                                  ||22751  |                                                  
23178  |            '平均純資産総額                       ||22752  |            '平均純資産総額                       
23179  |            .Cells(43, 2).Value = sWord51a        ||22753  |            .Cells(43, 2).Value = sWord51a        
23180  |            .Cells(43, 16).Value = sWord19        ||22754  |            .Cells(43, 16).Value = sWord19        
23181  |                                                  ||22755  |                                                  
23182  |            '平均純資産総額は別紙に記載           ||22756  |            '平均純資産総額は別紙に記載           
23183  |            strWord = ""                          ||22757  |            strWord = ""                          
23184  |            strWord = strWord & sWord53a & """"   ||22758  |            strWord = strWord & sWord53a & """"   
23185  |            Select Case Mid(gbuMGetUPDRec.N(lRecId||22759  |            Select Case Mid(gbuMGetUPDRec.N(lRecId
23186  |                Case Mid(mstrContractFlag(1), 1, 1||22760  |                Case Mid(mstrContractFlag(1), 1, 1
23187  |                    strWord = strWord & sWord54a &||22761  |                    strWord = strWord & sWord54a &
23188  |                Case Mid(mstrContractFlag(2), 1, 1||22762  |                Case Mid(mstrContractFlag(2), 1, 1
23189  |                    strWord = strWord & sWord55a &||22763  |                    strWord = strWord & sWord55a &
23190  |                Case Mid(mstrContractFlag(3), 1, 1||22764  |                Case Mid(mstrContractFlag(3), 1, 1
23191  |                    strWord = strWord & sWord56a &||22765  |                    strWord = strWord & sWord56a &
23192  |                Case Else                         ||22766  |                Case Else                         
23193  |            End Select                            ||22767  |            End Select                            
23194  |            .Cells(43, 19).Value = strWord        ||22768  |            .Cells(43, 19).Value = strWord        
23195  |                                                  ||22769  |                                                  
23196  |'            '計算期間の純資産総額の合計(月末純資 ||22770  |'            '計算期間の純資産総額の合計(月末純資 
23197  |'            .Cells(43, 28).NumberFormatLocal = "@||22771  |'            .Cells(43, 28).NumberFormatLocal = "@
23198  |'              If gbuMGetUPDRec.N(lRecIdx).MGET_ba||22772  |'              If gbuMGetUPDRec.N(lRecIdx).MGET_ba
23199  |'                  .Cells(43, 28).Value = CStr(For||22773  |'                  .Cells(43, 28).Value = CStr(For
23200  |'              Else                               ||22774  |'              Else                               
23201  |'                  .Cells(43, 28).Value = CStr(For||22775  |'                  .Cells(43, 28).Value = CStr(For
23202  |'              End If                             ||22776  |'              End If                             
23203  |'            .Cells(43, 28).HorizontalAlignment = ||22777  |'            .Cells(43, 28).HorizontalAlignment = 
23204  |'            '÷??＝                              ||22778  |'            '÷??＝                              
23205  |'            .Cells(43, 31).Value = sWord18 & "   ||22779  |'            .Cells(43, 31).Value = sWord18 & "   
23206  |'            '計算期間の純資産総額の合計÷計算期間||22780  |'            '計算期間の純資産総額の合計÷計算期間
23207  |'            .Cells(43, 40).NumberFormatLocal = "@||22781  |'            .Cells(43, 40).NumberFormatLocal = "@
23208  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base||22782  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_base
23209  |'                .Cells(43, 40).Value = CStr(Forma||22783  |'                .Cells(43, 40).Value = CStr(Forma
23210  |'            Else                                 ||22784  |'            Else                                 
23211  |'                .Cells(43, 40).Value = CStr(Forma||22785  |'                .Cells(43, 40).Value = CStr(Forma
23212  |'            End If                               ||22786  |'            End If                               
23213  |                                                  ||22787  |                                                  
23214  |            ddblExchangeRate = 0                  ||22788  |            ddblExchangeRate = 0                  
23215  |                                                  ||22789  |                                                  
23216  |            '投資顧問料計算用計算対象NAVに日次平均||22790  |            '投資顧問料計算用計算対象NAVに日次平均
23217  |            If dstrAvgNav = "" Then               ||22791  |            If dstrAvgNav = "" Then               
23218  |                lCalcNav = 0                      ||22792  |                lCalcNav = 0                      
23219  |            Else                                  ||22793  |            Else                                  
23220  |                                                  ||22794  |                                                  
23221  |                dblValueIn = CDbl(dstrAvgNav)     ||22795  |                dblValueIn = CDbl(dstrAvgNav)     
23222  |                                                  ||22796  |                                                  
23223  |                '@@@@@ NAV通貨から閾値通貨に換算 @||22797  |                '@@@@@ NAV通貨から閾値通貨に換算 @
23224  |                Select Case gbuMGetUPDRec.N(lRecId||22798  |                Select Case gbuMGetUPDRec.N(lRecId
23225  |                  Case "1"    '固定料率           ||22799  |                  Case "1"    '固定料率           
23226  |                    If gbuMGetUPDRec.N(lRecIdx).MG||22800  |                    If gbuMGetUPDRec.N(lRecIdx).MG
23227  |                        'NAV通貨→JPYの為替レート ||22801  |                        'NAV通貨→JPYの為替レート 
23228  |                        dstrCurrencyCode = gbuMGet||22802  |                        dstrCurrencyCode = gbuMGet
23229  |                        ddblExchangeRate = fnstrEx||22803  |                        ddblExchangeRate = fnstrEx
23230  |                        If ddblExchangeRate = 0 Th||22804  |                        If ddblExchangeRate = 0 Th
23231  |                          intRtn = MsgBox("ＴＴＭ ||22805  |                          intRtn = MsgBox("ＴＴＭ 
23232  |                          vbLf & "対象通貨コード  ||22806  |                          vbLf & "対象通貨コード  
23233  |                          vbLf & "基準日 ： [ " & ||22807  |                          vbLf & "基準日 ： [ " & 
23234  |                              vbCritical, "ＴＴＭ ||22808  |                              vbCritical, "ＴＴＭ 
23235  |                          Exit Function           ||22809  |                          Exit Function           
23236  |                        End If                    ||22810  |                        End If                    
23237  |                        'NAV通貨→JPYへレート換算 ||22811  |                        'NAV通貨→JPYへレート換算 
23238  |                        dblValueIn = dblValueIn * ||22812  |                        dblValueIn = dblValueIn * 
23239  |                    End If                        ||22813  |                    End If                        
23240  |                                                  ||22814  |                                                  
23241  |                  Case "2"    '段階料率           ||22815  |                  Case "2"    '段階料率           
23242  |                                                  ||22816  |                                                  
23243  |                    If gbuMGetUPDRec.N(lRecIdx).MG||22817  |                    If gbuMGetUPDRec.N(lRecIdx).MG
23244  |                        If gbuMGetUPDRec.N(lRecIdx||22818  |                        If gbuMGetUPDRec.N(lRecIdx
23245  |                        Else                      ||22819  |                        Else                      
23246  |                            '閾値通貨→JPYの為替レ||22820  |                            '閾値通貨→JPYの為替レ
23247  |                            dstrCurrencyCode = gbu||22821  |                            dstrCurrencyCode = gbu
23248  |                            ddblExchangeRate = fns||22822  |                            ddblExchangeRate = fns
23249  |                            If ddblExchangeRate = ||22823  |                            If ddblExchangeRate = 
23250  |                              intRtn = MsgBox("Ｔ ||22824  |                              intRtn = MsgBox("Ｔ 
23251  |                              vbLf & "対象通貨コー||22825  |                              vbLf & "対象通貨コー
23252  |                              vbLf & "基準日 ： [ ||22826  |                              vbLf & "基準日 ： [ 
23253  |                                  vbCritical, "Ｔ ||22827  |                                  vbCritical, "Ｔ 
23254  |                              Exit Function       ||22828  |                              Exit Function       
23255  |                            End If                ||22829  |                            End If                
23256  |                            'JPY→閾値通貨へレート||22830  |                            'JPY→閾値通貨へレート
23257  |                            dblValueIn = dblValueI||22831  |                            dblValueIn = dblValueI
23258  |                        End If                    ||22832  |                        End If                    
23259  |                    Else                          ||22833  |                    Else                          
23260  |                        'NAV通貨→JPYの為替レート ||22834  |                        'NAV通貨→JPYの為替レート 
23261  |                        dstrCurrencyCode = gbuMGet||22835  |                        dstrCurrencyCode = gbuMGet
23262  |                        ddblExchangeRate = fnstrEx||22836  |                        ddblExchangeRate = fnstrEx
23263  |                        If ddblExchangeRate = 0 Th||22837  |                        If ddblExchangeRate = 0 Th
23264  |                          intRtn = MsgBox("ＴＴＭ ||22838  |                          intRtn = MsgBox("ＴＴＭ 
23265  |                          vbLf & "対象通貨コード  ||22839  |                          vbLf & "対象通貨コード  
23266  |                          vbLf & "基準日 ： [ " & ||22840  |                          vbLf & "基準日 ： [ " & 
23267  |                              vbCritical, "ＴＴＭ ||22841  |                              vbCritical, "ＴＴＭ 
23268  |                          Exit Function           ||22842  |                          Exit Function           
23269  |                        End If                    ||22843  |                        End If                    
23270  |                        'NAV通貨→JPYへレート換算 ||22844  |                        'NAV通貨→JPYへレート換算 
23271  |                        dblValueIn = dblValueIn * ||22845  |                        dblValueIn = dblValueIn * 
23272  |                        If gbuMGetUPDRec.N(lRecIdx||22846  |                        If gbuMGetUPDRec.N(lRecIdx
23273  |                        Else                      ||22847  |                        Else                      
23274  |                            '閾値通貨→JPYの為替レ||22848  |                            '閾値通貨→JPYの為替レ
23275  |                            dstrCurrencyCode = gbu||22849  |                            dstrCurrencyCode = gbu
23276  |                            ddblExchangeRate = fns||22850  |                            ddblExchangeRate = fns
23277  |                            If ddblExchangeRate = ||22851  |                            If ddblExchangeRate = 
23278  |                              intRtn = MsgBox("Ｔ ||22852  |                              intRtn = MsgBox("Ｔ 
23279  |                              vbLf & "対象通貨コー||22853  |                              vbLf & "対象通貨コー
23280  |                              vbLf & "基準日 ： [ ||22854  |                              vbLf & "基準日 ： [ 
23281  |                                  vbCritical, "Ｔ ||22855  |                                  vbCritical, "Ｔ 
23282  |                              Exit Function       ||22856  |                              Exit Function       
23283  |                            End If                ||22857  |                            End If                
23284  |                            'JPY→閾値通貨へ逆レー||22858  |                            'JPY→閾値通貨へ逆レー
23285  |                            dblValueIn = dblValueI||22859  |                            dblValueIn = dblValueI
23286  |                        End If                    ||22860  |                        End If                    
23287  |                    End If                        ||22861  |                    End If                        
23288  |                                                  ||22862  |                                                  
23289  |                End Select                        ||22863  |                End Select                        
23290  |                '@@@@@ NAV通貨から閾値通貨に換算 @||22864  |                '@@@@@ NAV通貨から閾値通貨に換算 @
23291  |                Call sbGetRoundValue2(dblValueIn) ||22865  |                Call sbGetRoundValue2(dblValueIn) 
23292  |                                                  ||22866  |                                                  
23293  |'閾値レート換算後平均NAV(計算対象NAV)             ||22867  |'閾値レート換算後平均NAV(計算対象NAV)             
23294  |                lCalcNav = CStr(Format(dblValueOut||22868  |                lCalcNav = CStr(Format(dblValueOut
23295  |            End If                                ||22869  |            End If                                
23296  |                                                  ||22870  |                                                  
23297  |On Error Resume Next                              ||22871  |On Error Resume Next                              
23298  |        End If                                    ||22872  |        End If                                    
23299  |                                                  ||22873  |                                                  
23300  |        '投資顧問料                               ||22874  |        '投資顧問料                               
23301  |        Dim dRitsu As Double    '外部委託顧問料率 ||22875  |        Dim dRitsu As Double    '外部委託顧問料率 
23302  |        dRitsu = 0                                ||22876  |        dRitsu = 0                                
23303  |        TotalRate = 0                             ||22877  |        TotalRate = 0                             
23304  |        ddblExchangeRate = 0                      ||22878  |        ddblExchangeRate = 0                      
23305  |        '計算対象NAVを変数にセット                ||22879  |        '計算対象NAVを変数にセット                
23306  |        lCalcNav = 0                              ||22880  |        lCalcNav = 0                              
23307  |        dblValueIn = TotalNav / iRowCnt           ||22881  |        dblValueIn = TotalNav / iRowCnt           
23308  |                                                  ||22882  |                                                  
23309  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    ||22883  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    
23310  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||22884  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
23311  |          Case "1"    '固定料率(固定料率の場合は、||22885  |          Case "1"    '固定料率(固定料率の場合は、
23312  |                                                  ||22886  |                                                  
23313  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||22887  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
23314  |                'NAV通貨→JPYの為替レートを取得   ||22888  |                'NAV通貨→JPYの為替レートを取得   
23315  |                dstrCurrencyCode = gbuMGetUPDRec.N||22889  |                dstrCurrencyCode = gbuMGetUPDRec.N
23316  |                ddblExchangeRate = fnstrExchangeRa||22890  |                ddblExchangeRate = fnstrExchangeRa
23317  |                If ddblExchangeRate = 0 Then      ||22891  |                If ddblExchangeRate = 0 Then      
23318  |                  intRtn = MsgBox("ＴＴＭが取得で ||22892  |                  intRtn = MsgBox("ＴＴＭが取得で 
23319  |                  vbLf & "対象通貨コード ： [ " & ||22893  |                  vbLf & "対象通貨コード ： [ " & 
23320  |                  vbLf & "基準日 ： [ " & Mid(dstr||22894  |                  vbLf & "基準日 ： [ " & Mid(dstr
23321  |                      vbCritical, "ＴＴＭ取得エラ ||22895  |                      vbCritical, "ＴＴＭ取得エラ 
23322  |                  Exit Function                   ||22896  |                  Exit Function                   
23323  |                End If                            ||22897  |                End If                            
23324  |'                'NAV通貨→JPYへレート換算        ||22898  |'                'NAV通貨→JPYへレート換算        
23325  |'                dblValueIn = dblValueIn * ddblExc||22899  |'                dblValueIn = dblValueIn * ddblExc
23326  |                For i = LBound(gtypOtherComRec) To||22900  |                For i = LBound(gtypOtherComRec) To
23327  |                    'NAV通貨→JPYへレート換算     ||22901  |                    'NAV通貨→JPYへレート換算     
23328  |                    gtypOtherComRec(i).APPLY_NAV_A||22902  |                    gtypOtherComRec(i).APPLY_NAV_A
23329  |                Next i                            ||22903  |                Next i                            
23330  |            End If                                ||22904  |            End If                                
23331  |                                                  ||22905  |                                                  
23332  |          Case "2"    '段階料率                   ||22906  |          Case "2"    '段階料率                   
23333  |                                                  ||22907  |                                                  
23334  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_||22908  |            If gbuMGetUPDRec.N(lRecIdx).MGET_base_
23335  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||22909  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
23336  |                Else                              ||22910  |                Else                              
23337  |                    '閾値通貨→JPYの為替レートを取||22911  |                    '閾値通貨→JPYの為替レートを取
23338  |                    dstrCurrencyCode = gbuMGetUPDR||22912  |                    dstrCurrencyCode = gbuMGetUPDR
23339  |                    ddblExchangeRate = fnstrExchan||22913  |                    ddblExchangeRate = fnstrExchan
23340  |                    If ddblExchangeRate = 0 Then  ||22914  |                    If ddblExchangeRate = 0 Then  
23341  |                      intRtn = MsgBox("ＴＴＭが取 ||22915  |                      intRtn = MsgBox("ＴＴＭが取 
23342  |                      vbLf & "対象通貨コード ： [ ||22916  |                      vbLf & "対象通貨コード ： [ 
23343  |                      vbLf & "基準日 ： [ " & Mid(||22917  |                      vbLf & "基準日 ： [ " & Mid(
23344  |                          vbCritical, "ＴＴＭ取得 ||22918  |                          vbCritical, "ＴＴＭ取得 
23345  |                      Exit Function               ||22919  |                      Exit Function               
23346  |                    End If                        ||22920  |                    End If                        
23347  |'                    'JPY→閾値通貨へレート換算   ||22921  |'                    'JPY→閾値通貨へレート換算   
23348  |'                    dblValueIn = dblValueIn * ddb||22922  |'                    dblValueIn = dblValueIn * ddb
23349  |                    For i = LBound(gtypOtherComRec||22923  |                    For i = LBound(gtypOtherComRec
23350  |                        'NAV通貨→JPYへレート換算 ||22924  |                        'NAV通貨→JPYへレート換算 
23351  |                        gtypOtherComRec(i).APPLY_N||22925  |                        gtypOtherComRec(i).APPLY_N
23352  |                    Next i                        ||22926  |                    Next i                        
23353  |                End If                            ||22927  |                End If                            
23354  |            Else                                  ||22928  |            Else                                  
23355  |                'NAV通貨→JPYの為替レートを取得   ||22929  |                'NAV通貨→JPYの為替レートを取得   
23356  |                dstrCurrencyCode = gbuMGetUPDRec.N||22930  |                dstrCurrencyCode = gbuMGetUPDRec.N
23357  |                ddblExchangeRate = fnstrExchangeRa||22931  |                ddblExchangeRate = fnstrExchangeRa
23358  |                If ddblExchangeRate = 0 Then      ||22932  |                If ddblExchangeRate = 0 Then      
23359  |                  intRtn = MsgBox("ＴＴＭが取得で ||22933  |                  intRtn = MsgBox("ＴＴＭが取得で 
23360  |                  vbLf & "対象通貨コード ： [ " & ||22934  |                  vbLf & "対象通貨コード ： [ " & 
23361  |                  vbLf & "基準日 ： [ " & Mid(dstr||22935  |                  vbLf & "基準日 ： [ " & Mid(dstr
23362  |                      vbCritical, "ＴＴＭ取得エラ ||22936  |                      vbCritical, "ＴＴＭ取得エラ 
23363  |                  Exit Function                   ||22937  |                  Exit Function                   
23364  |                End If                            ||22938  |                End If                            
23365  |'                'NAV通貨→JPYへレート換算        ||22939  |'                'NAV通貨→JPYへレート換算        
23366  |'                dblValueIn = dblValueIn * ddblExc||22940  |'                dblValueIn = dblValueIn * ddblExc
23367  |                For i = LBound(gtypOtherComRec) To||22941  |                For i = LBound(gtypOtherComRec) To
23368  |                    'NAV通貨→JPYへレート換算     ||22942  |                    'NAV通貨→JPYへレート換算     
23369  |                    gtypOtherComRec(i).APPLY_NAV_A||22943  |                    gtypOtherComRec(i).APPLY_NAV_A
23370  |                Next i                            ||22944  |                Next i                            
23371  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||22945  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
23372  |                Else                              ||22946  |                Else                              
23373  |                    '閾値通貨→JPYの為替レートを取||22947  |                    '閾値通貨→JPYの為替レートを取
23374  |                    dstrCurrencyCode = gbuMGetUPDR||22948  |                    dstrCurrencyCode = gbuMGetUPDR
23375  |                    ddblExchangeRate = fnstrExchan||22949  |                    ddblExchangeRate = fnstrExchan
23376  |                    If ddblExchangeRate = 0 Then  ||22950  |                    If ddblExchangeRate = 0 Then  
23377  |                      intRtn = MsgBox("ＴＴＭが取 ||22951  |                      intRtn = MsgBox("ＴＴＭが取 
23378  |                      vbLf & "対象通貨コード ： [ ||22952  |                      vbLf & "対象通貨コード ： [ 
23379  |                      vbLf & "基準日 ： [ " & Mid(||22953  |                      vbLf & "基準日 ： [ " & Mid(
23380  |                          vbCritical, "ＴＴＭ取得 ||22954  |                          vbCritical, "ＴＴＭ取得 
23381  |                      Exit Function               ||22955  |                      Exit Function               
23382  |                    End If                        ||22956  |                    End If                        
23383  |'                    'JPY→閾値通貨へ逆レート換算 ||22957  |'                    'JPY→閾値通貨へ逆レート換算 
23384  |'                    dblValueIn = dblValueIn / ddb||22958  |'                    dblValueIn = dblValueIn / ddb
23385  |                    For i = LBound(gtypOtherComRec||22959  |                    For i = LBound(gtypOtherComRec
23386  |                        'NAV通貨→JPYへレート換算 ||22960  |                        'NAV通貨→JPYへレート換算 
23387  |                        gtypOtherComRec(i).APPLY_N||22961  |                        gtypOtherComRec(i).APPLY_N
23388  |                    Next i                        ||22962  |                    Next i                        
23389  |                End If                            ||22963  |                End If                            
23390  |            End If                                ||22964  |            End If                                
23391  |        End Select                                ||22965  |        End Select                                
23392  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    ||22966  |        '@@@@@ NAV通貨から閾値通貨に換算 @@@@@    
23393  |'        Call sbGetRoundValue2(dblValueIn)        ||22967  |'        Call sbGetRoundValue2(dblValueIn)        
23394  |'        lCalcNav = CStr(Format(dblValueOut, "#,##||22968  |'        lCalcNav = CStr(Format(dblValueOut, "#,##
23395  |        For i = LBound(gtypOtherComRec) To UBound(||22969  |        For i = LBound(gtypOtherComRec) To UBound(
23396  |            Call sbGetRoundValue2(gtypOtherComRec(||22970  |            Call sbGetRoundValue2(gtypOtherComRec(
23397  |            gtypOtherComRec(i).APPLY_NAV_AVG = CSt||22971  |            gtypOtherComRec(i).APPLY_NAV_AVG = CSt
23398  |        Next i                                    ||22972  |        Next i                                    
23399  |                                                  ||22973  |                                                  
23400  |        '固定料率                                 ||22974  |        '固定料率                                 
23401  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat||22975  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_rat
23402  |            dblValueIn = 0                        ||22976  |            dblValueIn = 0                        
23403  |            '一年間の日数：365日またはカレンダー  ||22977  |            '一年間の日数：365日またはカレンダー  
23404  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_||22978  |            If gbuMGetUPDRec.N(lRecIdx).MGET_days_
23405  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_||22979  |            Or gbuMGetUPDRec.N(lRecIdx).MGET_days_
23406  |                '計算対称NAV × 期中外部委託顧問料||22980  |                '計算対称NAV × 期中外部委託顧問料
23407  |                For i = LBound(gtypOtherComRec) To||22981  |                For i = LBound(gtypOtherComRec) To
23408  |                    For J = LBound(gtypOtherComRec||22982  |                    For J = LBound(gtypOtherComRec
23409  |                        gtypOtherComRec(i).APPLY_P||22983  |                        gtypOtherComRec(i).APPLY_P
23410  |                        gtypOtherComRec(i).APPLY_N||22984  |                        gtypOtherComRec(i).APPLY_N
23411  |                        gtypOtherComRec(i).APPLY_O||22985  |                        gtypOtherComRec(i).APPLY_O
23412  |                        gtypOtherComRec(i).APPLY_C||22986  |                        gtypOtherComRec(i).APPLY_C
23413  |                    Next J                        ||22987  |                    Next J                        
23414  |                Next i                            ||22988  |                Next i                            
23415  |            '一年間の日数：360日                  ||22989  |            '一年間の日数：360日                  
23416  |            Else                                  ||22990  |            Else                                  
23417  |                '計算対称NAV × 期中外部委託顧問料||22991  |                '計算対称NAV × 期中外部委託顧問料
23418  |                For i = LBound(gtypOtherComRec) To||22992  |                For i = LBound(gtypOtherComRec) To
23419  |                    For J = LBound(gtypOtherComRec||22993  |                    For J = LBound(gtypOtherComRec
23420  |                        gtypOtherComRec(i).APPLY_P||22994  |                        gtypOtherComRec(i).APPLY_P
23421  |                        gtypOtherComRec(i).APPLY_N||22995  |                        gtypOtherComRec(i).APPLY_N
23422  |                        gtypOtherComRec(i).APPLY_O||22996  |                        gtypOtherComRec(i).APPLY_O
23423  |                        gtypOtherComRec(i).APPLY_C||22997  |                        gtypOtherComRec(i).APPLY_C
23424  |                    Next J                        ||22998  |                    Next J                        
23425  |                Next i                            ||22999  |                Next i                            
23426  |            End If                                ||23000  |            End If                                
23427  |            '料率別顧問料を集計する               ||23001  |            '料率別顧問料を集計する               
23428  |            For i = LBound(gtypOtherComRec) To UBo||23002  |            For i = LBound(gtypOtherComRec) To UBo
23429  |                dblValueIn = dblValueIn + gtypOthe||23003  |                dblValueIn = dblValueIn + gtypOthe
23430  |            Next i                                ||23004  |            Next i                                
23431  |                                                  ||23005  |                                                  
23432  |        '段階料率                                 ||23006  |        '段階料率                                 
23433  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other||23007  |        ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other
23434  |            For i = LBound(gtypOtherComRec) To UBo||23008  |            For i = LBound(gtypOtherComRec) To UBo
23435  |                TotalRate = 0                     ||23009  |                TotalRate = 0                     
23436  |                TotalCom = 0                      ||23010  |                TotalCom = 0                      
23437  |'2008/03/03 START NAVが閾値を超えない場合、累積投 ||23011  |'2008/03/03 START NAVが閾値を超えない場合、累積投 
23438  |                WorkRate = 0                      ||23012  |                WorkRate = 0                      
23439  |'2008/03/03 END   NAVが閾値を超えない場合、累積投 ||23013  |'2008/03/03 END   NAVが閾値を超えない場合、累積投 
23440  |                For J = LBound(gtypOtherComRec(i).||23014  |                For J = LBound(gtypOtherComRec(i).
23441  |                    TotalRate = TotalRate + CCur(g||23015  |                    TotalRate = TotalRate + CCur(g
23442  |                    cRate = CCur(gtypOtherComRec(i||23016  |                    cRate = CCur(gtypOtherComRec(i
23443  |                    dRitsu = CDbl(gtypOtherComRec(||23017  |                    dRitsu = CDbl(gtypOtherComRec(
23444  |                    If J = UBound(gtypOtherComRec(||23018  |                    If J = UBound(gtypOtherComRec(
23445  |                        '(前回閾値)：累積閾値 = WO||23019  |                        '(前回閾値)：累積閾値 = WO
23446  |                        TotalRate = WorkRate      ||23020  |                        TotalRate = WorkRate      
23447  |                    ElseIf TotalRate <= gtypOtherC||23021  |                    ElseIf TotalRate <= gtypOtherC
23448  |                        '累積投資顧問料 = 累積投資||23022  |                        '累積投資顧問料 = 累積投資
23449  |                        dblValueIn = cRate * dRits||23023  |                        dblValueIn = cRate * dRits
23450  |                        Call sbGetRoundValue2(dblV||23024  |                        Call sbGetRoundValue2(dblV
23451  |                        TotalCom = TotalCom + dblV||23025  |                        TotalCom = TotalCom + dblV
23452  |                    Else                          ||23026  |                    Else                          
23453  |                        '(前回閾値)：累積閾値 = WO||23027  |                        '(前回閾値)：累積閾値 = WO
23454  |                        TotalRate = WorkRate      ||23028  |                        TotalRate = WorkRate      
23455  |                        Exit For                  ||23029  |                        Exit For                  
23456  |                    End If                        ||23030  |                    End If                        
23457  |                    '累積閾値をWORKに格納(一つ前の||23031  |                    '累積閾値をWORKに格納(一つ前の
23458  |                    WorkRate = TotalRate          ||23032  |                    WorkRate = TotalRate          
23459  |                Next J                            ||23033  |                Next J                            
23460  |                '累積投資顧問料 = 累積投資顧問料 +||23034  |                '累積投資顧問料 = 累積投資顧問料 +
23461  |                dblValueIn = (gtypOtherComRec(i).A||23035  |                dblValueIn = (gtypOtherComRec(i).A
23462  |                TotalCom = TotalCom + dblValueIn  ||23036  |                TotalCom = TotalCom + dblValueIn  
23463  |                '投資顧問料 = 累積投資顧問料 × 計||23037  |                '投資顧問料 = 累積投資顧問料 × 計
23464  |                If gbuMGetUPDRec.N(lRecIdx).MGET_d||23038  |                If gbuMGetUPDRec.N(lRecIdx).MGET_d
23465  |                Or gbuMGetUPDRec.N(lRecIdx).MGET_d||23039  |                Or gbuMGetUPDRec.N(lRecIdx).MGET_d
23466  |                    '一年間の日数：365日またはカレ||23040  |                    '一年間の日数：365日またはカレ
23467  |                    gtypOtherComRec(i).APPLY_PAY_C||23041  |                    gtypOtherComRec(i).APPLY_PAY_C
23468  |                Else                              ||23042  |                Else                              
23469  |                    '一年間の日数：360日          ||23043  |                    '一年間の日数：360日          
23470  |                    gtypOtherComRec(i).APPLY_PAY_C||23044  |                    gtypOtherComRec(i).APPLY_PAY_C
23471  |                End If                            ||23045  |                End If                            
23472  |            Next i                                ||23046  |            Next i                                
23473  |            '外部委託顧問料変数を初期化           ||23047  |            '外部委託顧問料変数を初期化           
23474  |            dblValueIn = 0                        ||23048  |            dblValueIn = 0                        
23475  |            'トータル顧問料をセット               ||23049  |            'トータル顧問料をセット               
23476  |            For i = LBound(gtypOtherComRec) To UBo||23050  |            For i = LBound(gtypOtherComRec) To UBo
23477  |                dblValueIn = dblValueIn + gtypOthe||23051  |                dblValueIn = dblValueIn + gtypOthe
23478  |            Next i                                ||23052  |            Next i                                
23479  |'期中料率変更契約対応 END                         ||23053  |'期中料率変更契約対応 END                         
23480  |        End If                                    ||23054  |        End If                                    
23481  |                                                  ||23055  |                                                  
23482  |        ddblExchangeRate = 0                      ||23056  |        ddblExchangeRate = 0                      
23483  |                                                  ||23057  |                                                  
23484  |        '@@@@@ 外部委託顧問料に換算 @@@@@         ||23058  |        '@@@@@ 外部委託顧問料に換算 @@@@@         
23485  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||23059  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
23486  |          Case "1"    '固定料率                   ||23060  |          Case "1"    '固定料率                   
23487  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o||23061  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o
23488  |                Else                              ||23062  |                Else                              
23489  |                  '外部委託顧問料通貨→JPYの為替レ||23063  |                  '外部委託顧問料通貨→JPYの為替レ
23490  |                  dstrCurrencyCode = gbuMGetUPDRec||23064  |                  dstrCurrencyCode = gbuMGetUPDRec
23491  |                  ddblExchangeRate = fnstrExchange||23065  |                  ddblExchangeRate = fnstrExchange
23492  |                  If ddblExchangeRate = 0 Then    ||23066  |                  If ddblExchangeRate = 0 Then    
23493  |                    intRtn = MsgBox("ＴＴＭが取得 ||23067  |                    intRtn = MsgBox("ＴＴＭが取得 
23494  |                    vbLf & "対象通貨コード ： [ " ||23068  |                    vbLf & "対象通貨コード ： [ " 
23495  |                    vbLf & "基準日 ： [ " & Mid(ds||23069  |                    vbLf & "基準日 ： [ " & Mid(ds
23496  |                        vbCritical, "ＴＴＭ取得エ ||23070  |                        vbCritical, "ＴＴＭ取得エ 
23497  |                    Exit Function                 ||23071  |                    Exit Function                 
23498  |                  End If                          ||23072  |                  End If                          
23499  |                  'JPY→閾値通貨へ逆レート換算    ||23073  |                  'JPY→閾値通貨へ逆レート換算    
23500  |                  dblValueIn = dblValueIn / ddblEx||23074  |                  dblValueIn = dblValueIn / ddblEx
23501  |                End If                            ||23075  |                End If                            
23502  |                                                  ||23076  |                                                  
23503  |          Case "2"    '段階料率                   ||23077  |          Case "2"    '段階料率                   
23504  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||23078  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
23505  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||23079  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
23506  |                Else                              ||23080  |                Else                              
23507  |                    '閾値通貨→JPYの為替レートを取||23081  |                    '閾値通貨→JPYの為替レートを取
23508  |                    dstrCurrencyCode = gbuMGetUPDR||23082  |                    dstrCurrencyCode = gbuMGetUPDR
23509  |                    ddblExchangeRate = fnstrExchan||23083  |                    ddblExchangeRate = fnstrExchan
23510  |                    'JPY→閾値通貨へ逆レート換算  ||23084  |                    'JPY→閾値通貨へ逆レート換算  
23511  |                    dblValueIn = dblValueIn / ddbl||23085  |                    dblValueIn = dblValueIn / ddbl
23512  |                End If                            ||23086  |                End If                            
23513  |            Else                                  ||23087  |            Else                                  
23514  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a||23088  |                If gbuMGetUPDRec.N(lRecIdx).MGET_a
23515  |                    '外部委託顧問料通貨→JPYの為替||23089  |                    '外部委託顧問料通貨→JPYの為替
23516  |                    dstrCurrencyCode = gbuMGetUPDR||23090  |                    dstrCurrencyCode = gbuMGetUPDR
23517  |                    ddblExchangeRate = fnstrExchan||23091  |                    ddblExchangeRate = fnstrExchan
23518  |                    'JPY→閾値通貨へレート換算    ||23092  |                    'JPY→閾値通貨へレート換算    
23519  |                    dblValueIn = dblValueIn / ddbl||23093  |                    dblValueIn = dblValueIn / ddbl
23520  |                Else                              ||23094  |                Else                              
23521  |                    '閾値通貨→JPYの為替レートを取||23095  |                    '閾値通貨→JPYの為替レートを取
23522  |                    dstrCurrencyCode = gbuMGetUPDR||23096  |                    dstrCurrencyCode = gbuMGetUPDR
23523  |                    ddblExchangeRate = fnstrExchan||23097  |                    ddblExchangeRate = fnstrExchan
23524  |                    'JPY→閾値通貨へ逆レート換算  ||23098  |                    'JPY→閾値通貨へ逆レート換算  
23525  |                    dblValueIn = dblValueIn * ddbl||23099  |                    dblValueIn = dblValueIn * ddbl
23526  |                    '外部委託顧問料通貨→JPYの為替||23100  |                    '外部委託顧問料通貨→JPYの為替
23527  |                    dstrCurrencyCode = gbuMGetUPDR||23101  |                    dstrCurrencyCode = gbuMGetUPDR
23528  |                    ddblExchangeRate = fnstrExchan||23102  |                    ddblExchangeRate = fnstrExchan
23529  |                    'JPY→閾値通貨へ逆レート換算  ||23103  |                    'JPY→閾値通貨へ逆レート換算  
23530  |                    dblValueIn = dblValueIn / ddbl||23104  |                    dblValueIn = dblValueIn / ddbl
23531  |                End If                            ||23105  |                End If                            
23532  |            End If                                ||23106  |            End If                                
23533  |                                                  ||23107  |                                                  
23534  |        End Select                                ||23108  |        End Select                                
23535  |        '@@@@@ 外部委託顧問料に換算 @@@@@         ||23109  |        '@@@@@ 外部委託顧問料に換算 @@@@@         
23536  |        Call sbGetRoundValue2(dblValueIn)         ||23110  |        Call sbGetRoundValue2(dblValueIn)         
23537  |        mstrMonthlyPayCom = dblValueOut           ||23111  |        mstrMonthlyPayCom = dblValueOut           
23538  |                                                  ||23112  |                                                  
23539  |        TotalRate = 0                             ||23113  |        TotalRate = 0                             
23540  |'期中料率変更契約対応 START                       ||23114  |'期中料率変更契約対応 START                       
23541  |        TotalRate = 0                             ||23115  |        TotalRate = 0                             
23542  |        '年率は別紙に記載                         ||23116  |        '年率は別紙に記載                         
23543  |        strWord = ""                              ||23117  |        strWord = ""                              
23544  |        strWord = strWord & sWord53a & """"       ||23118  |        strWord = strWord & sWord53a & """"       
23545  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||23119  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
23546  |            Case Mid(mstrContractFlag(1), 1, 1)   ||23120  |            Case Mid(mstrContractFlag(1), 1, 1)   
23547  |                strWord = strWord & sWord54a & """||23121  |                strWord = strWord & sWord54a & """
23548  |            Case Mid(mstrContractFlag(2), 1, 1)   ||23122  |            Case Mid(mstrContractFlag(2), 1, 1)   
23549  |                strWord = strWord & sWord55a & """||23123  |                strWord = strWord & sWord55a & """
23550  |            Case Mid(mstrContractFlag(3), 1, 1)   ||23124  |            Case Mid(mstrContractFlag(3), 1, 1)   
23551  |                strWord = strWord & sWord56a & """||23125  |                strWord = strWord & sWord56a & """
23552  |            Case Else                             ||23126  |            Case Else                             
23553  |        End Select                                ||23127  |        End Select                                
23554  |        .Cells(15, 15).Value = strWord            ||23128  |        .Cells(15, 15).Value = strWord            
23555  |'期中料率変更契約対応 END                         ||23129  |'期中料率変更契約対応 END                         
23556  |                                                  ||23130  |                                                  
23557  |        '投資顧問料                               ||23131  |        '投資顧問料                               
23558  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M||23132  |        Select Case Mid(gbuMGetUPDRec.N(lRecIdx).M
23559  |            Case Mid(mstrContractFlag(1), 1, 1)   ||23133  |            Case Mid(mstrContractFlag(1), 1, 1)   
23560  |                .Cells(46, 2).Value = sWord11d    ||23134  |                .Cells(46, 2).Value = sWord11d    
23561  |            Case Mid(mstrContractFlag(2), 1, 1)   ||23135  |            Case Mid(mstrContractFlag(2), 1, 1)   
23562  |                .Cells(46, 2).Value = sWord11e    ||23136  |                .Cells(46, 2).Value = sWord11e    
23563  |            Case Mid(mstrContractFlag(3), 1, 1)   ||23137  |            Case Mid(mstrContractFlag(3), 1, 1)   
23564  |                .Cells(46, 2).Value = sWord11f    ||23138  |                .Cells(46, 2).Value = sWord11f    
23565  |            Case Else                             ||23139  |            Case Else                             
23566  |                MsgBox "契約区分が不正です。", vbC||23140  |                MsgBox "契約区分が不正です。", vbC
23567  |        End Select                                ||23141  |        End Select                                
23568  |        '文言の冗長化でピリオド及び、名称を二列右 ||23142  |        '文言の冗長化でピリオド及び、名称を二列右 
23569  |'        .Cells(46, 11).Value = sWord19           ||23143  |'        .Cells(46, 11).Value = sWord19           
23570  |        .Cells(46, 13).Value = sWord19            ||23144  |        .Cells(46, 13).Value = sWord19            
23571  |                                                  ||23145  |                                                  
23572  |        '外部委託顧問料                           ||23146  |        '外部委託顧問料                           
23573  |        '文言の冗長化でピリオド及び、名称を二列右 ||23147  |        '文言の冗長化でピリオド及び、名称を二列右 
23574  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||23148  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
23575  |'            .Cells(46, 31).NumberFormatLocal = "@||23149  |'            .Cells(46, 31).NumberFormatLocal = "@
23576  |'        Else                                     ||23150  |'        Else                                     
23577  |'            .Cells(46, 29).NumberFormatLocal = "@||23151  |'            .Cells(46, 29).NumberFormatLocal = "@
23578  |'        End If                                   ||23152  |'        End If                                   
23579  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||23153  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
23580  |            .Cells(46, 33).NumberFormatLocal = "@"||23154  |            .Cells(46, 33).NumberFormatLocal = "@"
23581  |        Else                                      ||23155  |        Else                                      
23582  |            .Cells(46, 31).NumberFormatLocal = "@"||23156  |            .Cells(46, 31).NumberFormatLocal = "@"
23583  |        End If                                    ||23157  |        End If                                    
23584  |                                                  ||23158  |                                                  
23585  |        '契約区分が名称使用許諾料の場合上限・下限 ||23159  |        '契約区分が名称使用許諾料の場合上限・下限 
23586  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||23160  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
23587  |            '下限金額より換算した金額が小さい場合 ||23161  |            '下限金額より換算した金額が小さい場合 
23588  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_f||23162  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_f
23589  |                If mstrMonthlyPayCom < CDbl(gbuMGe||23163  |                If mstrMonthlyPayCom < CDbl(gbuMGe
23590  |                    mstrMonthlyPayCom = CDbl(gbuMG||23164  |                    mstrMonthlyPayCom = CDbl(gbuMG
23591  |                End If                            ||23165  |                End If                            
23592  |            End If                                ||23166  |            End If                                
23593  |            '上限金額より換算した金額が大きい場合 ||23167  |            '上限金額より換算した金額が大きい場合 
23594  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_c||23168  |            If Len(gbuMGetUPDRec.N(lRecIdx).MGET_c
23595  |                If mstrMonthlyPayCom > CDbl(gbuMGe||23169  |                If mstrMonthlyPayCom > CDbl(gbuMGe
23596  |                    mstrMonthlyPayCom = CDbl(gbuMG||23170  |                    mstrMonthlyPayCom = CDbl(gbuMG
23597  |                End If                            ||23171  |                End If                            
23598  |            End If                                ||23172  |            End If                                
23599  |                                                  ||23173  |                                                  
23600  |            dblValueIn = CDbl(mstrMonthlyPayCom)  ||23174  |            dblValueIn = CDbl(mstrMonthlyPayCom)  
23601  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||23175  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
23602  |                Call sbGetRoundValue2(dblValueIn) ||23176  |                Call sbGetRoundValue2(dblValueIn) 
23603  |            Else                                  ||23177  |            Else                                  
23604  |                Call sbGetRoundValue(dblValueIn)  ||23178  |                Call sbGetRoundValue(dblValueIn)  
23605  |            End If                                ||23179  |            End If                                
23606  |            mstrMonthlyPayCom = dblValueOut       ||23180  |            mstrMonthlyPayCom = dblValueOut       
23607  |                                                  ||23181  |                                                  
23608  |        End If                                    ||23182  |        End If                                    
23609  |                                                  ||23183  |                                                  
23610  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||23184  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
23611  |            '文言の冗長化でピリオド及び、名称を二 ||23185  |            '文言の冗長化でピリオド及び、名称を二 
23612  |'            Case cAud                            ||23186  |'            Case cAud                            
23613  |'                .Cells(46, 31).Value = CStr(Forma||23187  |'                .Cells(46, 31).Value = CStr(Forma
23614  |'                .Cells(46, 32).Value = sAuda     ||23188  |'                .Cells(46, 32).Value = sAuda     
23615  |'            Case cCad                            ||23189  |'            Case cCad                            
23616  |'                .Cells(46, 31).Value = CStr(Forma||23190  |'                .Cells(46, 31).Value = CStr(Forma
23617  |'                .Cells(46, 32).Value = sCada     ||23191  |'                .Cells(46, 32).Value = sCada     
23618  |'            Case cChf                            ||23192  |'            Case cChf                            
23619  |'                .Cells(46, 31).Value = CStr(Forma||23193  |'                .Cells(46, 31).Value = CStr(Forma
23620  |'                .Cells(46, 32).Value = sChfa     ||23194  |'                .Cells(46, 32).Value = sChfa     
23621  |'            Case cEur                            ||23195  |'            Case cEur                            
23622  |'                .Cells(46, 31).Value = CStr(Forma||23196  |'                .Cells(46, 31).Value = CStr(Forma
23623  |'                .Cells(46, 32).Value = sEura     ||23197  |'                .Cells(46, 32).Value = sEura     
23624  |'            Case cGbp                            ||23198  |'            Case cGbp                            
23625  |'                .Cells(46, 31).Value = CStr(Forma||23199  |'                .Cells(46, 31).Value = CStr(Forma
23626  |'                .Cells(46, 32).Value = sGbpa     ||23200  |'                .Cells(46, 32).Value = sGbpa     
23627  |'            Case cHkd                            ||23201  |'            Case cHkd                            
23628  |'                .Cells(46, 31).Value = CStr(Forma||23202  |'                .Cells(46, 31).Value = CStr(Forma
23629  |'                .Cells(46, 32).Value = sHkda     ||23203  |'                .Cells(46, 32).Value = sHkda     
23630  |'            Case cJpy                            ||23204  |'            Case cJpy                            
23631  |'                .Cells(46, 29).Value = CStr(Forma||23205  |'                .Cells(46, 29).Value = CStr(Forma
23632  |'                .Cells(46, 32).Value = sYena     ||23206  |'                .Cells(46, 32).Value = sYena     
23633  |'            Case cMyr                            ||23207  |'            Case cMyr                            
23634  |'                .Cells(46, 31).Value = CStr(Forma||23208  |'                .Cells(46, 31).Value = CStr(Forma
23635  |'                .Cells(46, 32).Value = sMyra     ||23209  |'                .Cells(46, 32).Value = sMyra     
23636  |'            Case cNzd                            ||23210  |'            Case cNzd                            
23637  |'                .Cells(46, 31).Value = CStr(Forma||23211  |'                .Cells(46, 31).Value = CStr(Forma
23638  |'                .Cells(46, 32).Value = sNzda     ||23212  |'                .Cells(46, 32).Value = sNzda     
23639  |'            Case cSek                            ||23213  |'            Case cSek                            
23640  |'                .Cells(46, 31).Value = CStr(Forma||23214  |'                .Cells(46, 31).Value = CStr(Forma
23641  |'                .Cells(46, 32).Value = sSeka     ||23215  |'                .Cells(46, 32).Value = sSeka     
23642  |'            Case cSgd                            ||23216  |'            Case cSgd                            
23643  |'                .Cells(46, 31).Value = CStr(Forma||23217  |'                .Cells(46, 31).Value = CStr(Forma
23644  |'                .Cells(46, 32).Value = sSgda     ||23218  |'                .Cells(46, 32).Value = sSgda     
23645  |'            Case cUsd                            ||23219  |'            Case cUsd                            
23646  |'                .Cells(46, 31).Value = CStr(Forma||23220  |'                .Cells(46, 31).Value = CStr(Forma
23647  |'                .Cells(46, 32).Value = sUsda     ||23221  |'                .Cells(46, 32).Value = sUsda     
23648  |'            Case cNok                            ||23222  |'            Case cNok                            
23649  |'                .Cells(46, 31).Value = CStr(Forma||23223  |'                .Cells(46, 31).Value = CStr(Forma
23650  |'                .Cells(46, 32).Value = sNoka     ||23224  |'                .Cells(46, 32).Value = sNoka     
23651  |            Case cAud                             ||23225  |            Case cAud                             
23652  |                .Cells(46, 33).Value = CStr(Format||23226  |                .Cells(46, 33).Value = CStr(Format
23653  |                .Cells(46, 34).Value = sAuda      ||23227  |                .Cells(46, 34).Value = sAuda      
23654  |            Case cCad                             ||23228  |            Case cCad                             
23655  |                .Cells(46, 33).Value = CStr(Format||23229  |                .Cells(46, 33).Value = CStr(Format
23656  |                .Cells(46, 34).Value = sCada      ||23230  |                .Cells(46, 34).Value = sCada      
23657  |            Case cChf                             ||23231  |            Case cChf                             
23658  |                .Cells(46, 33).Value = CStr(Format||23232  |                .Cells(46, 33).Value = CStr(Format
23659  |                .Cells(46, 34).Value = sChfa      ||23233  |                .Cells(46, 34).Value = sChfa      
23660  |            Case cEur                             ||23234  |            Case cEur                             
23661  |                .Cells(46, 33).Value = CStr(Format||23235  |                .Cells(46, 33).Value = CStr(Format
23662  |                .Cells(46, 34).Value = sEura      ||23236  |                .Cells(46, 34).Value = sEura      
23663  |            Case cGbp                             ||23237  |            Case cGbp                             
23664  |                .Cells(46, 33).Value = CStr(Format||23238  |                .Cells(46, 33).Value = CStr(Format
23665  |                .Cells(46, 34).Value = sGbpa      ||23239  |                .Cells(46, 34).Value = sGbpa      
23666  |            Case cHkd                             ||23240  |            Case cHkd                             
23667  |                .Cells(46, 33).Value = CStr(Format||23241  |                .Cells(46, 33).Value = CStr(Format
23668  |                .Cells(46, 34).Value = sHkda      ||23242  |                .Cells(46, 34).Value = sHkda      
23669  |            Case cJpy                             ||23243  |            Case cJpy                             
23670  |                .Cells(46, 31).Value = CStr(Format||23244  |                .Cells(46, 31).Value = CStr(Format
23671  |                .Cells(46, 34).Value = sYena      ||23245  |                .Cells(46, 34).Value = sYena      
23672  |            Case cMyr                             ||23246  |            Case cMyr                             
23673  |                .Cells(46, 33).Value = CStr(Format||23247  |                .Cells(46, 33).Value = CStr(Format
23674  |                .Cells(46, 34).Value = sMyra      ||23248  |                .Cells(46, 34).Value = sMyra      
23675  |            Case cNzd                             ||23249  |            Case cNzd                             
23676  |                .Cells(46, 33).Value = CStr(Format||23250  |                .Cells(46, 33).Value = CStr(Format
23677  |                .Cells(46, 34).Value = sNzda      ||23251  |                .Cells(46, 34).Value = sNzda      
23678  |            Case cSek                             ||23252  |            Case cSek                             
23679  |                .Cells(46, 33).Value = CStr(Format||23253  |                .Cells(46, 33).Value = CStr(Format
23680  |                .Cells(46, 34).Value = sSeka      ||23254  |                .Cells(46, 34).Value = sSeka      
23681  |            Case cSgd                             ||23255  |            Case cSgd                             
23682  |                .Cells(46, 33).Value = CStr(Format||23256  |                .Cells(46, 33).Value = CStr(Format
23683  |                .Cells(46, 34).Value = sSgda      ||23257  |                .Cells(46, 34).Value = sSgda      
23684  |            Case cUsd                             ||23258  |            Case cUsd                             
23685  |                .Cells(46, 33).Value = CStr(Format||23259  |                .Cells(46, 33).Value = CStr(Format
23686  |                .Cells(46, 34).Value = sUsda      ||23260  |                .Cells(46, 34).Value = sUsda      
23687  |            Case cNok                             ||23261  |            Case cNok                             
23688  |                .Cells(46, 33).Value = CStr(Format||23262  |                .Cells(46, 33).Value = CStr(Format
23689  |                .Cells(46, 34).Value = sNoka      ||23263  |                .Cells(46, 34).Value = sNoka      
23690  |        End Select                                ||23264  |        End Select                                
23691  |                                                  ||23265  |                                                  
23692  |        '顧問料                                   ||23266  |        '顧問料                                   
23693  |        '文言の冗長化でピリオド及び、名称を二列右 ||23267  |        '文言の冗長化でピリオド及び、名称を二列右 
23694  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co||23268  |'        If gbuMGetUPDRec.N(lRecIdx).MGET_other_co
23695  |'            .Cells(46, 31).HorizontalAlignment = ||23269  |'            .Cells(46, 31).HorizontalAlignment = 
23696  |'        Else                                     ||23270  |'        Else                                     
23697  |'            .Cells(46, 29).HorizontalAlignment = ||23271  |'            .Cells(46, 29).HorizontalAlignment = 
23698  |'        End If                                   ||23272  |'        End If                                   
23699  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||23273  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
23700  |            .Cells(46, 33).HorizontalAlignment = x||23274  |            .Cells(46, 33).HorizontalAlignment = x
23701  |        Else                                      ||23275  |        Else                                      
23702  |            .Cells(46, 31).HorizontalAlignment = x||23276  |            .Cells(46, 31).HorizontalAlignment = x
23703  |        End If                                    ||23277  |        End If                                    
23704  |                                                  ||23278  |                                                  
23705  |        '契約区分が名称使用許諾料の場合上限・下限 ||23279  |        '契約区分が名称使用許諾料の場合上限・下限 
23706  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr||23280  |        If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contr
23707  |            '上限金額                             ||23281  |            '上限金額                             
23708  |            '文言の冗長化でピリオド及び、名称を二 ||23282  |            '文言の冗長化でピリオド及び、名称を二 
23709  |'            .Cells(46, 45).Value = sWordCapa     ||23283  |'            .Cells(46, 45).Value = sWordCapa     
23710  |'            .Cells(46, 57).NumberFormatLocal = "@||23284  |'            .Cells(46, 57).NumberFormatLocal = "@
23711  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou||23285  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou
23712  |'                .Cells(46, 57).Value = Format(gbu||23286  |'                .Cells(46, 57).Value = Format(gbu
23713  |'            Else                                 ||23287  |'            Else                                 
23714  |'                .Cells(46, 57).Value = Format(gbu||23288  |'                .Cells(46, 57).Value = Format(gbu
23715  |'            End If                               ||23289  |'            End If                               
23716  |'                                                 ||23290  |'                                                 
23717  |'            .Cells(46, 57).HorizontalAlignment = ||23291  |'            .Cells(46, 57).HorizontalAlignment = 
23718  |'                                                 ||23292  |'                                                 
23719  |'            '下限金額                            ||23293  |'            '下限金額                            
23720  |'            .Cells(47, 45).Value = sWordFloora   ||23294  |'            .Cells(47, 45).Value = sWordFloora   
23721  |'            .Cells(47, 57).NumberFormatLocal = "@||23295  |'            .Cells(47, 57).NumberFormatLocal = "@
23722  |'                                                 ||23296  |'                                                 
23723  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou||23297  |'            If gbuMGetUPDRec.N(lRecIdx).MGET_amou
23724  |'                .Cells(47, 57).Value = Format(gbu||23298  |'                .Cells(47, 57).Value = Format(gbu
23725  |'            Else                                 ||23299  |'            Else                                 
23726  |'                .Cells(47, 57).Value = Format(gbu||23300  |'                .Cells(47, 57).Value = Format(gbu
23727  |'            End If                               ||23301  |'            End If                               
23728  |'            .Cells(47, 57).HorizontalAlignment = ||23302  |'            .Cells(47, 57).HorizontalAlignment = 
23729  |            .Cells(46, 47).Value = sWordCapa      ||23303  |            .Cells(46, 47).Value = sWordCapa      
23730  |            .Cells(46, 59).NumberFormatLocal = "@"||23304  |            .Cells(46, 59).NumberFormatLocal = "@"
23731  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||23305  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
23732  |                .Cells(46, 59).Value = Format(gbuM||23306  |                .Cells(46, 59).Value = Format(gbuM
23733  |            Else                                  ||23307  |            Else                                  
23734  |                .Cells(46, 59).Value = Format(gbuM||23308  |                .Cells(46, 59).Value = Format(gbuM
23735  |            End If                                ||23309  |            End If                                
23736  |                                                  ||23310  |                                                  
23737  |            .Cells(46, 59).HorizontalAlignment = x||23311  |            .Cells(46, 59).HorizontalAlignment = x
23738  |                                                  ||23312  |                                                  
23739  |            '下限金額                             ||23313  |            '下限金額                             
23740  |            .Cells(47, 47).Value = sWordFloora    ||23314  |            .Cells(47, 47).Value = sWordFloora    
23741  |            .Cells(47, 59).NumberFormatLocal = "@"||23315  |            .Cells(47, 59).NumberFormatLocal = "@"
23742  |                                                  ||23316  |                                                  
23743  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun||23317  |            If gbuMGetUPDRec.N(lRecIdx).MGET_amoun
23744  |                .Cells(47, 59).Value = Format(gbuM||23318  |                .Cells(47, 59).Value = Format(gbuM
23745  |            Else                                  ||23319  |            Else                                  
23746  |                .Cells(47, 59).Value = Format(gbuM||23320  |                .Cells(47, 59).Value = Format(gbuM
23747  |            End If                                ||23321  |            End If                                
23748  |            .Cells(47, 59).HorizontalAlignment = x||23322  |            .Cells(47, 59).HorizontalAlignment = x
23749  |        End If                                    ||23323  |        End If                                    
23750  |                                                  ||23324  |                                                  
23751  |        ddblExchangeRate = 0                      ||23325  |        ddblExchangeRate = 0                      
23752  |                                                  ||23326  |                                                  
23753  |        dblValueIn = mstrMonthlyPayCom            ||23327  |        dblValueIn = mstrMonthlyPayCom            
23754  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_||23328  |        Select Case gbuMGetUPDRec.N(lRecIdx).MGET_
23755  |          Case "1"    '固定料率                   ||23329  |          Case "1"    '固定料率                   
23756  |                                                  ||23330  |                                                  
23757  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o||23331  |                If gbuMGetUPDRec.N(lRecIdx).MGET_o
23758  |                Else                              ||23332  |                Else                              
23759  |                  '外部委託顧問料通貨→JPYの為替レ||23333  |                  '外部委託顧問料通貨→JPYの為替レ
23760  |                  dstrCurrencyCode = gbuMGetUPDRec||23334  |                  dstrCurrencyCode = gbuMGetUPDRec
23761  |                  ddblExchangeRate = fnstrExchange||23335  |                  ddblExchangeRate = fnstrExchange
23762  |                  If ddblExchangeRate = 0 Then    ||23336  |                  If ddblExchangeRate = 0 Then    
23763  |                    intRtn = MsgBox("ＴＴＭが取得 ||23337  |                    intRtn = MsgBox("ＴＴＭが取得 
23764  |                    vbLf & "対象通貨コード ： [ " ||23338  |                    vbLf & "対象通貨コード ： [ " 
23765  |                    vbLf & "基準日 ： [ " & Mid(ds||23339  |                    vbLf & "基準日 ： [ " & Mid(ds
23766  |                        vbCritical, "ＴＴＭ取得エ ||23340  |                        vbCritical, "ＴＴＭ取得エ 
23767  |                    Exit Function                 ||23341  |                    Exit Function                 
23768  |                  End If                          ||23342  |                  End If                          
23769  |                  'JPY→支払通貨へレート換算      ||23343  |                  'JPY→支払通貨へレート換算      
23770  |                  dblValueIn = dblValueIn * ddblEx||23344  |                  dblValueIn = dblValueIn * ddblEx
23771  |                End If                            ||23345  |                End If                            
23772  |                                                  ||23346  |                                                  
23773  |          Case "2"    '段階料率                   ||23347  |          Case "2"    '段階料率                   
23774  |                                                  ||23348  |                                                  
23775  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||23349  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
23776  |            Else                                  ||23350  |            Else                                  
23777  |                '外部委託顧問料通貨→JPYの為替レー||23351  |                '外部委託顧問料通貨→JPYの為替レー
23778  |                dstrCurrencyCode = gbuMGetUPDRec.N||23352  |                dstrCurrencyCode = gbuMGetUPDRec.N
23779  |                ddblExchangeRate = fnstrExchangeRa||23353  |                ddblExchangeRate = fnstrExchangeRa
23780  |                If ddblExchangeRate = 0 Then      ||23354  |                If ddblExchangeRate = 0 Then      
23781  |                  intRtn = MsgBox("ＴＴＭが取得で ||23355  |                  intRtn = MsgBox("ＴＴＭが取得で 
23782  |                  vbLf & "対象通貨コード ： [ " & ||23356  |                  vbLf & "対象通貨コード ： [ " & 
23783  |                  vbLf & "基準日 ： [ " & Mid(dstr||23357  |                  vbLf & "基準日 ： [ " & Mid(dstr
23784  |                      vbCritical, "ＴＴＭ取得エラ ||23358  |                      vbCritical, "ＴＴＭ取得エラ 
23785  |                  Exit Function                   ||23359  |                  Exit Function                   
23786  |                End If                            ||23360  |                End If                            
23787  |                '外部委託顧問料通貨→JPYへレート換||23361  |                '外部委託顧問料通貨→JPYへレート換
23788  |                dblValueIn = dblValueIn * ddblExch||23362  |                dblValueIn = dblValueIn * ddblExch
23789  |            End If                                ||23363  |            End If                                
23790  |                                                  ||23364  |                                                  
23791  |        End Select                                ||23365  |        End Select                                
23792  |        '@@@@@ 支払に換算 @@@@@                   ||23366  |        '@@@@@ 支払に換算 @@@@@                   
23793  |        Call sbGetRoundValue(dblValueIn)          ||23367  |        Call sbGetRoundValue(dblValueIn)          
23794  |        mstrMonthlyPayCom = dblValueOut           ||23368  |        mstrMonthlyPayCom = dblValueOut           
23795  |                                                  ||23369  |                                                  
23796  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com||23370  |        If gbuMGetUPDRec.N(lRecIdx).MGET_other_com
23797  |            'TTMレート                            ||23371  |            'TTMレート                            
23798  |            '文言の冗長化でピリオド及び、名称を二 ||23372  |            '文言の冗長化でピリオド及び、名称を二 
23799  |'                .Cells(47, 19).Value = sWord43   ||23373  |'                .Cells(47, 19).Value = sWord43   
23800  |'                .Cells(47, 33).NumberFormatLocal ||23374  |'                .Cells(47, 33).NumberFormatLocal 
23801  |'                .Cells(47, 33).Value = Format(ddb||23375  |'                .Cells(47, 33).Value = Format(ddb
23802  |'                .Cells(47, 33).HorizontalAlignmen||23376  |'                .Cells(47, 33).HorizontalAlignmen
23803  |'                .Cells(47, 34).Value = sWord44   ||23377  |'                .Cells(47, 34).Value = sWord44   
23804  |            .Cells(47, 21).Value = sWord43        ||23378  |            .Cells(47, 21).Value = sWord43        
23805  |            .Cells(47, 35).NumberFormatLocal = "@"||23379  |            .Cells(47, 35).NumberFormatLocal = "@"
23806  |            .Cells(47, 35).Value = Format(ddblExch||23380  |            .Cells(47, 35).Value = Format(ddblExch
23807  |            .Cells(47, 35).HorizontalAlignment = x||23381  |            .Cells(47, 35).HorizontalAlignment = x
23808  |            .Cells(47, 36).Value = sWord44        ||23382  |            .Cells(47, 36).Value = sWord44        
23809  |        End If                                    ||23383  |        End If                                    
23810  |                                                  ||23384  |                                                  
23811  |        '支払額                                   ||23385  |        '支払額                                   
23812  |        .Cells(48, 2).Value = sWord46a            ||23386  |        .Cells(48, 2).Value = sWord46a            
23813  |        '文言の冗長化でピリオド及び、名称を二列右 ||23387  |        '文言の冗長化でピリオド及び、名称を二列右 
23814  |'            .Cells(48, 11).Value = sWord19       ||23388  |'            .Cells(48, 11).Value = sWord19       
23815  |        .Cells(48, 13).Value = sWord19            ||23389  |        .Cells(48, 13).Value = sWord19            
23816  |                                                  ||23390  |                                                  
23817  |        '税抜金額(月別支払顧問料の累計)           ||23391  |        '税抜金額(月別支払顧問料の累計)           
23818  |        '文言の冗長化でピリオド及び、名称を二列右 ||23392  |        '文言の冗長化でピリオド及び、名称を二列右 
23819  |'            .Cells(48, 29).NumberFormatLocal = "@||23393  |'            .Cells(48, 29).NumberFormatLocal = "@
23820  |'            .Cells(48, 29).Value = CStr(Format(ms||23394  |'            .Cells(48, 29).Value = CStr(Format(ms
23821  |'            .Cells(48, 29).HorizontalAlignment = ||23395  |'            .Cells(48, 29).HorizontalAlignment = 
23822  |'            .Cells(48, 32).Value = sYena         ||23396  |'            .Cells(48, 32).Value = sYena         
23823  |        .Cells(48, 31).NumberFormatLocal = "@"    ||23397  |        .Cells(48, 31).NumberFormatLocal = "@"    
23824  |        .Cells(48, 31).Value = CStr(Format(mstrMon||23398  |        .Cells(48, 31).Value = CStr(Format(mstrMon
23825  |        .Cells(48, 31).HorizontalAlignment = xlRig||23399  |        .Cells(48, 31).HorizontalAlignment = xlRig
23826  |        .Cells(48, 34).Value = sYena              ||23400  |        .Cells(48, 34).Value = sYena              
23827  |                                                  ||23401  |                                                  
23828  |        '消費税計算有無：「有り」の場合のみ、消費 ||23402  |        '消費税計算有無：「有り」の場合のみ、消費 
23829  |        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc_||23403  |        If gbuMGetUPDRec.N(lRecIdx).MGET_tax_calc_
23830  |            '(消費税XX%)                          ||23404  |            '(消費税XX%)                          
23831  |            '文言の冗長化でピリオド及び、名称を二 ||23405  |            '文言の冗長化でピリオド及び、名称を二 
23832  |'            iSyouhizei = ddblconsumption_tax     ||23406  |'            iSyouhizei = ddblconsumption_tax     
23833  |'            .Cells(49, 32).Value = sWord22a & iSy||23407  |'            .Cells(49, 32).Value = sWord22a & iSy
23834  |'            dblValueIn = mstrMonthlyPayCom * iSyo||23408  |'            dblValueIn = mstrMonthlyPayCom * iSyo
23835  |            iSyouhizei = ddblconsumption_tax      ||23409  |            iSyouhizei = ddblconsumption_tax      
23836  |            .Cells(49, 34).Value = sWord22a & iSyo||23410  |            .Cells(49, 34).Value = sWord22a & iSyo
23837  |            dblValueIn = mstrMonthlyPayCom * iSyou||23411  |            dblValueIn = mstrMonthlyPayCom * iSyou
23838  |            Call sbGetRoundValueTax(dblValueIn)   ||23412  |            Call sbGetRoundValueTax(dblValueIn)   
23839  |            lTaxNum = dblValueOut                 ||23413  |            lTaxNum = dblValueOut                 
23840  |            '文言の冗長化でピリオド及び、名称を二 ||23414  |            '文言の冗長化でピリオド及び、名称を二 
23841  |'            .Cells(49, 29).NumberFormatLocal = "@||23415  |'            .Cells(49, 29).NumberFormatLocal = "@
23842  |'            .Cells(49, 29).Value = CStr(Format((l||23416  |'            .Cells(49, 29).Value = CStr(Format((l
23843  |'            .Cells(49, 29).HorizontalAlignment = ||23417  |'            .Cells(49, 29).HorizontalAlignment = 
23844  |            .Cells(49, 31).NumberFormatLocal = "@"||23418  |            .Cells(49, 31).NumberFormatLocal = "@"
23845  |            .Cells(49, 31).Value = CStr(Format((lT||23419  |            .Cells(49, 31).Value = CStr(Format((lT
23846  |            .Cells(49, 31).HorizontalAlignment = x||23420  |            .Cells(49, 31).HorizontalAlignment = x
23847  |            '合計(消費税＋月別支払顧問料の累計)   ||23421  |            '合計(消費税＋月別支払顧問料の累計)   
23848  |            '文言の冗長化でピリオド及び、名称を二 ||23422  |            '文言の冗長化でピリオド及び、名称を二 
23849  |'            .Cells(50, 13).Value = sWord24a      ||23423  |'            .Cells(50, 13).Value = sWord24a      
23850  |            .Cells(50, 15).Value = sWord24a       ||23424  |            .Cells(50, 15).Value = sWord24a       
23851  |            dblValueIn = lTaxNum + CCur(mstrMonthl||23425  |            dblValueIn = lTaxNum + CCur(mstrMonthl
23852  |            Call sbGetRoundValue(dblValueIn)      ||23426  |            Call sbGetRoundValue(dblValueIn)      
23853  |            lMonthlyPayCom = dblValueOut          ||23427  |            lMonthlyPayCom = dblValueOut          
23854  |            '文言の冗長化でピリオド及び、名称を二 ||23428  |            '文言の冗長化でピリオド及び、名称を二 
23855  |'            .Cells(50, 29).NumberFormatLocal = "@||23429  |'            .Cells(50, 29).NumberFormatLocal = "@
23856  |'            .Cells(50, 29).Value = CStr(Format(lM||23430  |'            .Cells(50, 29).Value = CStr(Format(lM
23857  |'            .Cells(50, 29).HorizontalAlignment = ||23431  |'            .Cells(50, 29).HorizontalAlignment = 
23858  |'            '円                                  ||23432  |'            '円                                  
23859  |'            .Cells(50, 32).Value = sYena         ||23433  |'            .Cells(50, 32).Value = sYena         
23860  |'            '下線                                ||23434  |'            '下線                                
23861  |            .Cells(50, 31).NumberFormatLocal = "@"||23435  |            .Cells(50, 31).NumberFormatLocal = "@"
23862  |            .Cells(50, 31).Value = CStr(Format(lMo||23436  |            .Cells(50, 31).Value = CStr(Format(lMo
23863  |            .Cells(50, 31).HorizontalAlignment = x||23437  |            .Cells(50, 31).HorizontalAlignment = x
23864  |            '円                                   ||23438  |            '円                                   
23865  |            .Cells(50, 34).Value = sYena          ||23439  |            .Cells(50, 34).Value = sYena          
23866  |            '下線                                 ||23440  |            '下線                                 
23867  |            '文言の冗長化でピリオド及び、名称を二 ||23441  |            '文言の冗長化でピリオド及び、名称を二 
23868  |'            With xlSheet.Range("M49:AL49").Border||23442  |'            With xlSheet.Range("M49:AL49").Border
23869  |'                .LineStyle = xlContinuous        ||23443  |'                .LineStyle = xlContinuous        
23870  |'                .Weight = xlThin                 ||23444  |'                .Weight = xlThin                 
23871  |'            End With                             ||23445  |'            End With                             
23872  |            With xlSheet.Range("O49:AN49").Borders||23446  |            With xlSheet.Range("O49:AN49").Borders
23873  |                .LineStyle = xlContinuous         ||23447  |                .LineStyle = xlContinuous         
23874  |                .Weight = xlThin                  ||23448  |                .Weight = xlThin                  
23875  |            End With                              ||23449  |            End With                              
23876  |        Else                                      ||23450  |        Else                                      
23877  |        End If                                    ||23451  |        End If                                    
23878  |                                                  ||23452  |                                                  
23879  |        '支払予定日                               ||23453  |        '支払予定日                               
23880  |        '文言の冗長化でピリオド及び、名称を二列右 ||23454  |        '文言の冗長化でピリオド及び、名称を二列右 
23881  |        .Cells(52, 2).Value = sWord13a            ||23455  |        .Cells(52, 2).Value = sWord13a            
23882  |'        .Cells(52, 11).Value = sWord19           ||23456  |'        .Cells(52, 11).Value = sWord19           
23883  |'        .Cells(52, 13).NumberFormatLocal = "@"   ||23457  |'        .Cells(52, 13).NumberFormatLocal = "@"   
23884  |'        .Cells(52, 13).Value = CStr(Format(Trim(m||23458  |'        .Cells(52, 13).Value = CStr(Format(Trim(m
23885  |        .Cells(52, 13).Value = sWord19            ||23459  |        .Cells(52, 13).Value = sWord19            
23886  |        .Cells(52, 15).NumberFormatLocal = "@"    ||23460  |        .Cells(52, 15).NumberFormatLocal = "@"    
23887  |        .Cells(52, 15).Value = CStr(Format(Trim(ms||23461  |        .Cells(52, 15).Value = CStr(Format(Trim(ms
23888  |                                                  ||23462  |                                                  
23889  |        '支払先                                   ||23463  |        '支払先                                   
23890  |        '文言の冗長化でピリオド及び、名称を二列右 ||23464  |        '文言の冗長化でピリオド及び、名称を二列右 
23891  |        .Cells(54, 2).Value = sWord12a            ||23465  |        .Cells(54, 2).Value = sWord12a            
23892  |'        .Cells(54, 11).Value = sWord19           ||23466  |'        .Cells(54, 11).Value = sWord19           
23893  |'        .Cells(54, 13).Value = gbuMGetUPDRec.N(lR||23467  |'        .Cells(54, 13).Value = gbuMGetUPDRec.N(lR
23894  |        .Cells(54, 13).Value = sWord19            ||23468  |        .Cells(54, 13).Value = sWord19            
23895  |        .Cells(54, 15).Value = gbuMGetUPDRec.N(lRe||23469  |        .Cells(54, 15).Value = gbuMGetUPDRec.N(lRe
23896  |                                                  ||23470  |                                                  
23897  |        '財務部                                   ||23471  |        '財務部                                   
23898  |        .Cells(60, 2).Value = sWord1a             ||23472  |        .Cells(60, 2).Value = sWord1a             
23899  |        .Cells(61, 2).Value = sWord2a             ||23473  |        .Cells(61, 2).Value = sWord2a             
23900  |                                                  ||23474  |                                                  
23901  |    End With                                      ||23475  |    End With                                      
23902  |                                                  ||23476  |                                                  
23903  |    '月末純資産(合計 上のライン)                  ||23477  |    '月末純資産(合計 上のライン)                  
23904  |    With xlSheet.Range("X39:AX40").Borders(xlInsid||23478  |    With xlSheet.Range("X39:AX40").Borders(xlInsid
23905  |        .LineStyle = xlContinuous                 ||23479  |        .LineStyle = xlContinuous                 
23906  |        .Weight = xlThin                          ||23480  |        .Weight = xlThin                          
23907  |    End With                                      ||23481  |    End With                                      
23908  |                                                  ||23482  |                                                  
23909  |    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract_||23483  |    If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_contract_
23910  |    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||23484  |    And gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
23911  |                                                  ||23485  |                                                  
23912  |        '文言の冗長化でピリオド及び、名称を二列右 ||23486  |        '文言の冗長化でピリオド及び、名称を二列右 
23913  |'        xlSheet.Cells(13, 13).Value = _          ||23487  |'        xlSheet.Cells(13, 13).Value = _          
23914  |'            CStr(Format(dStart, "mmmm d , yyyy"))||23488  |'            CStr(Format(dStart, "mmmm d , yyyy"))
23915  |        xlSheet.Cells(13, 15).Value = _           ||23489  |        xlSheet.Cells(13, 15).Value = _           
23916  |            CStr(Format(dStart, "mmmm d , yyyy")) ||23490  |            CStr(Format(dStart, "mmmm d , yyyy")) 
23917  |    Else                                          ||23491  |    Else                                          
23918  |        '文言の冗長化でピリオド及び、名称を二列右 ||23492  |        '文言の冗長化でピリオド及び、名称を二列右 
23919  |'        xlSheet.Cells(13, 13).Value = _          ||23493  |'        xlSheet.Cells(13, 13).Value = _          
23920  |'            CStr(Format(dStart, "mmmm d , yyyy"))||23494  |'            CStr(Format(dStart, "mmmm d , yyyy"))
23921  |        xlSheet.Cells(13, 15).Value = _           ||23495  |        xlSheet.Cells(13, 15).Value = _           
23922  |            CStr(Format(dStart, "mmmm d , yyyy")) ||23496  |            CStr(Format(dStart, "mmmm d , yyyy")) 
23923  |    End If                                        ||23497  |    End If                                        
23924  |                                                  ||23498  |                                                  
23925  |    'A4印刷用に上2行を削除して、プレビュー範囲内に||23499  |    'A4印刷用に上2行を削除して、プレビュー範囲内に
23926  |    xlSheet.Rows("1:2").Delete Shift:=xlUp        ||23500  |    xlSheet.Rows("1:2").Delete Shift:=xlUp        
23927  |                                                  ||23501  |                                                  
23928  |'期中料率変更契約対応 START                       ||23502  |'期中料率変更契約対応 START                       
23929  |    '料率変更履歴票作成                           ||23503  |    '料率変更履歴票作成                           
23930  |    'RAFI対応 START                               ||23504  |    'RAFI対応 START                               
23931  |    '純資産の場合                                 ||23505  |    '純資産の場合                                 
23932  |    If msAssetFlg = "0" Then                      ||23506  |    If msAssetFlg = "0" Then                      
23933  |        Call sbExcelChgRateSheetEnglishOut( _     ||23507  |        Call sbExcelChgRateSheetEnglishOut( _     
23934  |                sGetAccCode, TotalRate, lRecIdx, d||23508  |                sGetAccCode, TotalRate, lRecIdx, d
23935  |    'マザー組入資産の場合                         ||23509  |    'マザー組入資産の場合                         
23936  |    Else                                          ||23510  |    Else                                          
23937  |        Call sbExcelChgRateSheetEnglishOut( _     ||23511  |        Call sbExcelChgRateSheetEnglishOut( _     
23938  |                msBabyAccountCode, TotalRate, lRec||23512  |                msBabyAccountCode, TotalRate, lRec
23939  |    End If                                        ||23513  |    End If                                        
23940  |    'RAFI対応 END                                 ||23514  |    'RAFI対応 END                                 
23941  |'期中料率変更契約対応 END                         ||23515  |'期中料率変更契約対応 END                         
23942  |                                                  ||23516  |                                                  
23943  |'=================================================||23517  |'=================================================
23944  |'== 　　　　日次NAV/日時時価総額の別表作成エリア  ||23518  |'== 　　　　日次NAV/日時時価総額の別表作成エリア  
23945  |'=================================================||23519  |'=================================================
23946  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||23520  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
23947  |                                                  ||23521  |                                                  
23948  |''NAV取得区分：日次NAV平均(休日有)または日次NAV平 ||23522  |''NAV取得区分：日次NAV平均(休日有)または日次NAV平 
23949  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||23523  |'    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
23950  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag||23524  |'    Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag
23951  |    'NAV取得区分：日次NAV平均(休日有)、日次NAV平均||23525  |    'NAV取得区分：日次NAV平均(休日有)、日次NAV平均
23952  |    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag ||23526  |    If gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_flag 
23953  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||23527  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
23954  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f||23528  |        Or gbuMGetUPDRec.N(lRecIdx).MGET_nav_get_f
23955  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||23529  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
23956  |                                                  ||23530  |                                                  
23957  |        gTotalDnavCnt = 0                         ||23531  |        gTotalDnavCnt = 0                         
23958  |        J = 0                                     ||23532  |        J = 0                                     
23959  |        K = 0                                     ||23533  |        K = 0                                     
23960  |        'ループ終了フラグ初期化                   ||23534  |        'ループ終了フラグ初期化                   
23961  |        EndFlg = False                            ||23535  |        EndFlg = False                            
23962  |        SetPoint = 0                              ||23536  |        SetPoint = 0                              
23963  |        AddPoint = 0                              ||23537  |        AddPoint = 0                              
23964  |                                                  ||23538  |                                                  
23965  |        '＋２は合計行と平均行                     ||23539  |        '＋２は合計行と平均行                     
23966  |'        dintPage = (dlngCnt + 2) \ 108           ||23540  |'        dintPage = (dlngCnt + 2) \ 108           
23967  |'        dintAmari = (dlngCnt + 2) Mod 108        ||23541  |'        dintAmari = (dlngCnt + 2) Mod 108        
23968  |        '余白 + (料率数 × 2) + (料率数 - 1)      ||23542  |        '余白 + (料率数 × 2) + (料率数 - 1)      
23969  |        dintPage = (dlngCnt + 2 + 2 + ((UBound(gty||23543  |        dintPage = (dlngCnt + 2 + 2 + ((UBound(gty
23970  |        dintAmari = (dlngCnt + 2 + 2 + ((UBound(gt||23544  |        dintAmari = (dlngCnt + 2 + 2 + ((UBound(gt
23971  |                                                  ||23545  |                                                  
23972  |        If dintAmari <> 0 Then                    ||23546  |        If dintAmari <> 0 Then                    
23973  |            dintPage = dintPage + 1               ||23547  |            dintPage = dintPage + 1               
23974  |        End If                                    ||23548  |        End If                                    
23975  |                                                  ||23549  |                                                  
23976  |        For L = 1 To dintPage                     ||23550  |        For L = 1 To dintPage                     
23977  |                                                  ||23551  |                                                  
23978  |            xlBook.Worksheets.Add after:=xlBook.Sh||23552  |            xlBook.Worksheets.Add after:=xlBook.Sh
23979  |            gProcessCnt = gProcessCnt + 1         ||23553  |            gProcessCnt = gProcessCnt + 1         
23980  |            Set xlSheet = xlBook.Sheets(gProcessCn||23554  |            Set xlSheet = xlBook.Sheets(gProcessCn
23981  |                                                  ||23555  |                                                  
23982  |            'Excelフォーマットを調整              ||23556  |            'Excelフォーマットを調整              
23983  |            xlSheet.Cells.ColumnWidth = 1         ||23557  |            xlSheet.Cells.ColumnWidth = 1         
23984  |            xlSheet.Cells.Font.Size = 11          ||23558  |            xlSheet.Cells.Font.Size = 11          
23985  |            'シート名を設定(日次NAV一覧**)        ||23559  |            'シート名を設定(日次NAV一覧**)        
23986  |                                                  ||23560  |                                                  
23987  |            'RAFI対応 START                       ||23561  |            'RAFI対応 START                       
23988  |            '純資産の場合                         ||23562  |            '純資産の場合                         
23989  |            If msAssetFlg = "0" Then              ||23563  |            If msAssetFlg = "0" Then              
23990  |                If dstrOldAccCode = sGetAccCode Th||23564  |                If dstrOldAccCode = sGetAccCode Th
23991  |                    gTotalDnavCnt = gTotalDnavCnt ||23565  |                    gTotalDnavCnt = gTotalDnavCnt 
23992  |                Else                              ||23566  |                Else                              
23993  |                    gTotalDnavCnt = 1             ||23567  |                    gTotalDnavCnt = 1             
23994  |                    dstrOldAccCode = sGetAccCode  ||23568  |                    dstrOldAccCode = sGetAccCode  
23995  |                End If                            ||23569  |                End If                            
23996  |            'マザー組入資産の場合                 ||23570  |            'マザー組入資産の場合                 
23997  |            Else                                  ||23571  |            Else                                  
23998  |                If dstrOldAccCode = msBabyAccountC||23572  |                If dstrOldAccCode = msBabyAccountC
23999  |                    gTotalDnavCnt = gTotalDnavCnt ||23573  |                    gTotalDnavCnt = gTotalDnavCnt 
24000  |                Else                              ||23574  |                Else                              
24001  |                    gTotalDnavCnt = 1             ||23575  |                    gTotalDnavCnt = 1             
24002  |                    dstrOldAccCode = msBabyAccount||23576  |                    dstrOldAccCode = msBabyAccount
24003  |                End If                            ||23577  |                End If                            
24004  |            End If                                ||23578  |            End If                                
24005  |            'RAFI対応 END                         ||23579  |            'RAFI対応 END                         
24006  |                                                  ||23580  |                                                  
24007  |            'gTotalCnt = gTotalCnt + 1            ||23581  |            'gTotalCnt = gTotalCnt + 1            
24008  |            'RAFI対応 START                       ||23582  |            'RAFI対応 START                       
24009  |            '純資産の場合                         ||23583  |            '純資産の場合                         
24010  |            If msAssetFlg = "0" Then              ||23584  |            If msAssetFlg = "0" Then              
24011  |                '複数ページの場合                 ||23585  |                '複数ページの場合                 
24012  |                If dintPage > 1 Then              ||23586  |                If dintPage > 1 Then              
24013  |                    xlBook.Sheets(gProcessCnt).Nam||23587  |                    xlBook.Sheets(gProcessCnt).Nam
24014  |                Else                              ||23588  |                Else                              
24015  |                    xlBook.Sheets(gProcessCnt).Nam||23589  |                    xlBook.Sheets(gProcessCnt).Nam
24016  |                End If                            ||23590  |                End If                            
24017  |            'マザー組入資産の場合                 ||23591  |            'マザー組入資産の場合                 
24018  |            Else                                  ||23592  |            Else                                  
24019  |                '複数ページの場合                 ||23593  |                '複数ページの場合                 
24020  |                If dintPage > 1 Then              ||23594  |                If dintPage > 1 Then              
24021  |                    xlBook.Sheets(gProcessCnt).Nam||23595  |                    xlBook.Sheets(gProcessCnt).Nam
24022  |                Else                              ||23596  |                Else                              
24023  |                    xlBook.Sheets(gProcessCnt).Nam||23597  |                    xlBook.Sheets(gProcessCnt).Nam
24024  |                End If                            ||23598  |                End If                            
24025  |            End If                                ||23599  |            End If                                
24026  |            'RAFI対応 END                         ||23600  |            'RAFI対応 END                         
24027  |                                                  ||23601  |                                                  
24028  |            'シートの余白を設定                   ||23602  |            'シートの余白を設定                   
24029  |            xlSheet.PageSetup.TopMargin = Applicat||23603  |            xlSheet.PageSetup.TopMargin = Applicat
24030  |            xlSheet.PageSetup.BottomMargin = Appli||23604  |            xlSheet.PageSetup.BottomMargin = Appli
24031  |            xlSheet.PageSetup.LeftMargin = Applica||23605  |            xlSheet.PageSetup.LeftMargin = Applica
24032  |            xlSheet.PageSetup.RightMargin = Applic||23606  |            xlSheet.PageSetup.RightMargin = Applic
24033  |                                                  ||23607  |                                                  
24034  |            DoEvents                              ||23608  |            DoEvents                              
24035  |                                                  ||23609  |                                                  
24036  |            With xlSheet                          ||23610  |            With xlSheet                          
24037  |                '題目                             ||23611  |                '題目                             
24038  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||23612  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24039  |                '取得NAV区分が4:日次時価総額平均の||23613  |                '取得NAV区分が4:日次時価総額平均の
24040  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||23614  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
24041  |                    .Cells(5, 1).Value = sWord68a ||23615  |                    .Cells(5, 1).Value = sWord68a 
24042  |                Else                              ||23616  |                Else                              
24043  |                    .Cells(5, 1).Value = sWord47a ||23617  |                    .Cells(5, 1).Value = sWord47a 
24044  |                End If                            ||23618  |                End If                            
24045  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||23619  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24046  |                .Cells(5, 1).Font.Size = 14       ||23620  |                .Cells(5, 1).Font.Size = 14       
24047  |                .Range("A5:BG5").HorizontalAlignme||23621  |                .Range("A5:BG5").HorizontalAlignme
24048  |                '出力日付                         ||23622  |                '出力日付                         
24049  |                If RTrim(txtSysOutDate.Text) = "" ||23623  |                If RTrim(txtSysOutDate.Text) = "" 
24050  |                    .Cells(3, 50).NumberFormatLoca||23624  |                    .Cells(3, 50).NumberFormatLoca
24051  |                    .Cells(3, 50).Value = sWord34a||23625  |                    .Cells(3, 50).Value = sWord34a
24052  |                    .Cells(3, 50).HorizontalAlignm||23626  |                    .Cells(3, 50).HorizontalAlignm
24053  |                Else                              ||23627  |                Else                              
24054  |                    .Cells(3, 43).NumberFormatLoca||23628  |                    .Cells(3, 43).NumberFormatLoca
24055  |                    .Cells(3, 43).Value = CStr(For||23629  |                    .Cells(3, 43).Value = CStr(For
24056  |                End If                            ||23630  |                End If                            
24057  |                'ファンド名                       ||23631  |                'ファンド名                       
24058  |                .Cells(6, 2).Value = sWord4a      ||23632  |                .Cells(6, 2).Value = sWord4a      
24059  |                .Cells(6, 11).Value = sWord19     ||23633  |                .Cells(6, 11).Value = sWord19     
24060  |                .Cells(6, 13).Value = gbuMGetUPDRe||23634  |                .Cells(6, 13).Value = gbuMGetUPDRe
24061  |                'ファンドコード                   ||23635  |                'ファンドコード                   
24062  |                .Cells(7, 2).Value = sWord4_2a    ||23636  |                .Cells(7, 2).Value = sWord4_2a    
24063  |                .Cells(7, 11).Value = sWord19     ||23637  |                .Cells(7, 11).Value = sWord19     
24064  |                .Cells(7, 13).NumberFormatLocal = ||23638  |                .Cells(7, 13).NumberFormatLocal = 
24065  |                'RAFI対応 START                   ||23639  |                'RAFI対応 START                   
24066  |                '純資産の場合                     ||23640  |                '純資産の場合                     
24067  |                If msAssetFlg = "0" Then          ||23641  |                If msAssetFlg = "0" Then          
24068  |                    .Cells(7, 13).Value = sGetAccC||23642  |                    .Cells(7, 13).Value = sGetAccC
24069  |                'マザー組入資産の場合             ||23643  |                'マザー組入資産の場合             
24070  |                Else                              ||23644  |                Else                              
24071  |                    .Cells(7, 13).Value = msBabyAc||23645  |                    .Cells(7, 13).Value = msBabyAc
24072  |                End If                            ||23646  |                End If                            
24073  |                'RAFI対応 END                     ||23647  |                'RAFI対応 END                     
24074  |                '計算期間                         ||23648  |                '計算期間                         
24075  |                '文言変更                         ||23649  |                '文言変更                         
24076  |'                .Cells(8, 2).Value = sWord5a     ||23650  |'                .Cells(8, 2).Value = sWord5a     
24077  |                .Cells(8, 2).Value = sWord59a     ||23651  |                .Cells(8, 2).Value = sWord59a     
24078  |                .Cells(8, 11).Value = sWord19     ||23652  |                .Cells(8, 11).Value = sWord19     
24079  |                                                  ||23653  |                                                  
24080  |                If Mid(gbuMGetUPDRec.N(lRecIdx).MG||23654  |                If Mid(gbuMGetUPDRec.N(lRecIdx).MG
24081  |                And gbuMGetUPDRec.N(lRecIdx).MGET_||23655  |                And gbuMGetUPDRec.N(lRecIdx).MGET_
24082  |                    .Cells(8, 13).Value = _       ||23656  |                    .Cells(8, 13).Value = _       
24083  |                        CStr(Format(dStart, "mmmm ||23657  |                        CStr(Format(dStart, "mmmm 
24084  |                Else                              ||23658  |                Else                              
24085  |                    .Cells(8, 13).Value = _       ||23659  |                    .Cells(8, 13).Value = _       
24086  |                        CStr(Format(dStart, "mmmm ||23660  |                        CStr(Format(dStart, "mmmm 
24087  |                End If                            ||23661  |                End If                            
24088  |                                                  ||23662  |                                                  
24089  |                '日付                             ||23663  |                '日付                             
24090  |                .Cells(10, 3).Value = sWord7a     ||23664  |                .Cells(10, 3).Value = sWord7a     
24091  |                .Range("C10:N10").HorizontalAlignm||23665  |                .Range("C10:N10").HorizontalAlignm
24092  |                '純資産                           ||23666  |                '純資産                           
24093  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||23667  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24094  |                '取得NAV区分が4:日次時価総額平均の||23668  |                '取得NAV区分が4:日次時価総額平均の
24095  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||23669  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
24096  |                    .Cells(10, 15).Value = sWord64||23670  |                    .Cells(10, 15).Value = sWord64
24097  |                Else                              ||23671  |                Else                              
24098  |                    .Cells(10, 15).Value = sWord8a||23672  |                    .Cells(10, 15).Value = sWord8a
24099  |                End If                            ||23673  |                End If                            
24100  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||23674  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24101  |                .Range("O10:AC10").HorizontalAlign||23675  |                .Range("O10:AC10").HorizontalAlign
24102  |                '日付                             ||23676  |                '日付                             
24103  |                .Cells(10, 31).Value = sWord7a    ||23677  |                .Cells(10, 31).Value = sWord7a    
24104  |                .Range("AE10:AP10").HorizontalAlig||23678  |                .Range("AE10:AP10").HorizontalAlig
24105  |                '純資産                           ||23679  |                '純資産                           
24106  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||23680  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24107  |                '取得NAV区分が4:日次時価総額平均の||23681  |                '取得NAV区分が4:日次時価総額平均の
24108  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n||23682  |                If gbuMGetUPDRec.N(lRecIdx).MGET_n
24109  |                    .Cells(10, 43).Value = sWord64||23683  |                    .Cells(10, 43).Value = sWord64
24110  |                Else                              ||23684  |                Else                              
24111  |                    .Cells(10, 43).Value = sWord8a||23685  |                    .Cells(10, 43).Value = sWord8a
24112  |                End If                            ||23686  |                End If                            
24113  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||23687  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24114  |                .Range("AQ10:BE10").HorizontalAlig||23688  |                .Range("AQ10:BE10").HorizontalAlig
24115  |                '日付＆NAV                        ||23689  |                '日付＆NAV                        
24116  |                Select Case L                     ||23690  |                Select Case L                     
24117  |                    Case 1                        ||23691  |                    Case 1                        
24118  |                        dintPageIni = 1           ||23692  |                        dintPageIni = 1           
24119  |                    Case Else                     ||23693  |                    Case Else                     
24120  |                        dintPageIni = dintPageIni ||23694  |                        dintPageIni = dintPageIni 
24121  |                End Select                        ||23695  |                End Select                        
24122  |                For dintFor = dintPageIni To dlngC||23696  |                For dintFor = dintPageIni To dlngC
24123  |                    If J < 54 Then                ||23697  |                    If J < 54 Then                
24124  |                        If dintFor = dlngCnt + 1 T||23698  |                        If dintFor = dlngCnt + 1 T
24125  |                            '合計                 ||23699  |                            '合計                 
24126  |                            .Cells(11 + J, 3).Valu||23700  |                            .Cells(11 + J, 3).Valu
24127  |                            'NAV                  ||23701  |                            'NAV                  
24128  |                            .Cells(11 + J, 28).Num||23702  |                            .Cells(11 + J, 28).Num
24129  |                            If gbuMGetUPDRec.N(lRe||23703  |                            If gbuMGetUPDRec.N(lRe
24130  |                                .Cells(11 + J, 28)||23704  |                                .Cells(11 + J, 28)
24131  |                            Else                  ||23705  |                            Else                  
24132  |                                .Cells(11 + J, 28)||23706  |                                .Cells(11 + J, 28)
24133  |                            End If                ||23707  |                            End If                
24134  |                            .Cells(11 + J, 28).Hor||23708  |                            .Cells(11 + J, 28).Hor
24135  |                        End If                    ||23709  |                        End If                    
24136  |                                                  ||23710  |                                                  
24137  |                            If dintFor = dlngCnt +||23711  |                            If dintFor = dlngCnt +
24138  |                                '平均             ||23712  |                                '平均             
24139  |                                .Cells(11 + J, 3).||23713  |                                .Cells(11 + J, 3).
24140  |                                'NAV              ||23714  |                                'NAV              
24141  |                                .Cells(11 + J, 28)||23715  |                                .Cells(11 + J, 28)
24142  |                                If gbuMGetUPDRec.N||23716  |                                If gbuMGetUPDRec.N
24143  |                                    .Cells(11 + J,||23717  |                                    .Cells(11 + J,
24144  |                                Else              ||23718  |                                Else              
24145  |                                    .Cells(11 + J,||23719  |                                    .Cells(11 + J,
24146  |                                End If            ||23720  |                                End If            
24147  |                                .Cells(11 + J, 28)||23721  |                                .Cells(11 + J, 28)
24148  |                            End If                ||23722  |                            End If                
24149  |                                                  ||23723  |                                                  
24150  |                        If dintFor < dlngCnt + 1 T||23724  |                        If dintFor < dlngCnt + 1 T
24151  |                            '日付                 ||23725  |                            '日付                 
24152  |                            .Cells(11 + J, 4).Numb||23726  |                            .Cells(11 + J, 4).Numb
24153  |                            .Cells(11 + J, 4).Valu||23727  |                            .Cells(11 + J, 4).Valu
24154  |                                        CDate(gstr||23728  |                                        CDate(gstr
24155  |                            'NAV                  ||23729  |                            'NAV                  
24156  |                            .Cells(11 + J, 28).Num||23730  |                            .Cells(11 + J, 28).Num
24157  |                            If gbuMGetUPDRec.N(lRe||23731  |                            If gbuMGetUPDRec.N(lRe
24158  |                                .Cells(11 + J, 28)||23732  |                                .Cells(11 + J, 28)
24159  |                            Else                  ||23733  |                            Else                  
24160  |                                .Cells(11 + J, 28)||23734  |                                .Cells(11 + J, 28)
24161  |                            End If                ||23735  |                            End If                
24162  |                            .Cells(11 + J, 28).Hor||23736  |                            .Cells(11 + J, 28).Hor
24163  |                        End If                    ||23737  |                        End If                    
24164  |                    Else                          ||23738  |                    Else                          
24165  |                        If dintFor = dlngCnt + 1 T||23739  |                        If dintFor = dlngCnt + 1 T
24166  |                            '合計                 ||23740  |                            '合計                 
24167  |                            .Cells(11 + K, 31).Val||23741  |                            .Cells(11 + K, 31).Val
24168  |                            'NAV                  ||23742  |                            'NAV                  
24169  |                            .Cells(11 + K, 56).Num||23743  |                            .Cells(11 + K, 56).Num
24170  |                            If gbuMGetUPDRec.N(lRe||23744  |                            If gbuMGetUPDRec.N(lRe
24171  |                                .Cells(11 + K, 56)||23745  |                                .Cells(11 + K, 56)
24172  |                            Else                  ||23746  |                            Else                  
24173  |                                .Cells(11 + K, 56)||23747  |                                .Cells(11 + K, 56)
24174  |                            End If                ||23748  |                            End If                
24175  |                            .Cells(11 + K, 56).Hor||23749  |                            .Cells(11 + K, 56).Hor
24176  |                        End If                    ||23750  |                        End If                    
24177  |                                                  ||23751  |                                                  
24178  |                            If dintFor = dlngCnt +||23752  |                            If dintFor = dlngCnt +
24179  |                                '平均             ||23753  |                                '平均             
24180  |                                .Cells(11 + K, 31)||23754  |                                .Cells(11 + K, 31)
24181  |                                'NAV              ||23755  |                                'NAV              
24182  |                                .Cells(11 + K, 56)||23756  |                                .Cells(11 + K, 56)
24183  |                                If gbuMGetUPDRec.N||23757  |                                If gbuMGetUPDRec.N
24184  |                                    .Cells(11 + K,||23758  |                                    .Cells(11 + K,
24185  |                                Else              ||23759  |                                Else              
24186  |                                    .Cells(11 + K,||23760  |                                    .Cells(11 + K,
24187  |                                End If            ||23761  |                                End If            
24188  |                                .Cells(11 + K, 56)||23762  |                                .Cells(11 + K, 56)
24189  |                            End If                ||23763  |                            End If                
24190  |                                                  ||23764  |                                                  
24191  |                        If dintFor < dlngCnt + 1 T||23765  |                        If dintFor < dlngCnt + 1 T
24192  |                            '日付                 ||23766  |                            '日付                 
24193  |                                                  ||23767  |                                                  
24194  |                            .Cells(11 + K, 32).Num||23768  |                            .Cells(11 + K, 32).Num
24195  |                            .Cells(11 + K, 32).Val||23769  |                            .Cells(11 + K, 32).Val
24196  |                                        CDate(gstr||23770  |                                        CDate(gstr
24197  |                            'NAV                  ||23771  |                            'NAV                  
24198  |                            .Cells(11 + K, 56).Num||23772  |                            .Cells(11 + K, 56).Num
24199  |                            If gbuMGetUPDRec.N(lRe||23773  |                            If gbuMGetUPDRec.N(lRe
24200  |                                .Cells(11 + K, 56)||23774  |                                .Cells(11 + K, 56)
24201  |                            Else                  ||23775  |                            Else                  
24202  |                                .Cells(11 + K, 56)||23776  |                                .Cells(11 + K, 56)
24203  |                            End If                ||23777  |                            End If                
24204  |                            .Cells(11 + K, 56).Hor||23778  |                            .Cells(11 + K, 56).Hor
24205  |                        End If                    ||23779  |                        End If                    
24206  |                        K = K + 1                 ||23780  |                        K = K + 1                 
24207  |                        If K > 53 Then            ||23781  |                        If K > 53 Then            
24208  |                            J = 0                 ||23782  |                            J = 0                 
24209  |                            K = 0                 ||23783  |                            K = 0                 
24210  |                            Exit For              ||23784  |                            Exit For              
24211  |                        End If                    ||23785  |                        End If                    
24212  |                    End If                        ||23786  |                    End If                        
24213  |                    J = J + 1                     ||23787  |                    J = J + 1                     
24214  |                    'ループ終了したらフラグをON   ||23788  |                    'ループ終了したらフラグをON   
24215  |                    If dintFor = (dlngCnt + 2) The||23789  |                    If dintFor = (dlngCnt + 2) The
24216  |                        EndFlg = True             ||23790  |                        EndFlg = True             
24217  |                        '平均の終了行の次行を取得 ||23791  |                        '平均の終了行の次行を取得 
24218  |                        If K = 0 Then             ||23792  |                        If K = 0 Then             
24219  |                            intRange = J + 11     ||23793  |                            intRange = J + 11     
24220  |                            strRange = "J"        ||23794  |                            strRange = "J"        
24221  |                        ElseIf K <> 0 Then        ||23795  |                        ElseIf K <> 0 Then        
24222  |                            intRange = K + 11     ||23796  |                            intRange = K + 11     
24223  |                            strRange = "K"        ||23797  |                            strRange = "K"        
24224  |                        Else                      ||23798  |                        Else                      
24225  |                            intRange = 11         ||23799  |                            intRange = 11         
24226  |                            strRange = "J"        ||23800  |                            strRange = "J"        
24227  |                        End If                    ||23801  |                        End If                    
24228  |                        J = 0                     ||23802  |                        J = 0                     
24229  |                        K = 0                     ||23803  |                        K = 0                     
24230  |                    End If                        ||23804  |                    End If                        
24231  |                Next dintFor                      ||23805  |                Next dintFor                      
24232  |                                                  ||23806  |                                                  
24233  |            End With                              ||23807  |            End With                              
24234  |            '日次NAV平均の出力が終了したら料率別平||23808  |            '日次NAV平均の出力が終了したら料率別平
24235  |            If EndFlg = True Then                 ||23809  |            If EndFlg = True Then                 
24236  |                With xlSheet                      ||23810  |                With xlSheet                      
24237  |                    For dintFor = SetPoint + AddPo||23811  |                    For dintFor = SetPoint + AddPo
24238  |                        If dintFor = 0 Then       ||23812  |                        If dintFor = 0 Then       
24239  |                            If strRange = "J" Then||23813  |                            If strRange = "J" Then
24240  |                                If intRange = 11 T||23814  |                                If intRange = 11 T
24241  |                                    '余白無し     ||23815  |                                    '余白無し     
24242  |                                    '日付         ||23816  |                                    '日付         
24243  |                                    .Cells(intRang||23817  |                                    .Cells(intRang
24244  |                                    Format(gstrDat||23818  |                                    Format(gstrDat
24245  |                                    sWord60 & Form||23819  |                                    sWord60 & Form
24246  |                                    J = J + 1     ||23820  |                                    J = J + 1     
24247  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||23821  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24248  |                                    '取得NAV区分が||23822  |                                    '取得NAV区分が
24249  |                                    If gbuMGetUPDR||23823  |                                    If gbuMGetUPDR
24250  |                                        .Cells(int||23824  |                                        .Cells(int
24251  |                                    Else          ||23825  |                                    Else          
24252  |                                        .Cells(int||23826  |                                        .Cells(int
24253  |                                    End If        ||23827  |                                    End If        
24254  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||23828  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24255  |                                    dblValueIn = g||23829  |                                    dblValueIn = g
24256  |                                    .Cells(intRang||23830  |                                    .Cells(intRang
24257  |                                    '平均純資産   ||23831  |                                    '平均純資産   
24258  |                                    dblValueIn = g||23832  |                                    dblValueIn = g
24259  |                                    If gtypOtherCo||23833  |                                    If gtypOtherCo
24260  |                                          Call sbG||23834  |                                          Call sbG
24261  |                                    Else          ||23835  |                                    Else          
24262  |                                          Call sbG||23836  |                                          Call sbG
24263  |                                    End If        ||23837  |                                    End If        
24264  |                                    If gtypOtherCo||23838  |                                    If gtypOtherCo
24265  |                                        .Cells(int||23839  |                                        .Cells(int
24266  |                                    Else          ||23840  |                                    Else          
24267  |                                        .Cells(int||23841  |                                        .Cells(int
24268  |                                    End If        ||23842  |                                    End If        
24269  |                                    'If gtypOtherC||23843  |                                    'If gtypOtherC
24270  |                                    '    .Cells(in||23844  |                                    '    .Cells(in
24271  |                                    'Else         ||23845  |                                    'Else         
24272  |                                    '    .Cells(in||23846  |                                    '    .Cells(in
24273  |                                    'End If       ||23847  |                                    'End If       
24274  |                                    .Cells(intRang||23848  |                                    .Cells(intRang
24275  |                                    strRange = "J"||23849  |                                    strRange = "J"
24276  |                                    intRange = int||23850  |                                    intRange = int
24277  |                                ElseIf intRange <>||23851  |                                ElseIf intRange <>
24278  |                                    '余白有り     ||23852  |                                    '余白有り     
24279  |                                    J = J + 2     ||23853  |                                    J = J + 2     
24280  |                                    '日付         ||23854  |                                    '日付         
24281  |                                    .Cells(intRang||23855  |                                    .Cells(intRang
24282  |                                    Format(gstrDat||23856  |                                    Format(gstrDat
24283  |                                    sWord60 & Form||23857  |                                    sWord60 & Form
24284  |                                    J = J + 1     ||23858  |                                    J = J + 1     
24285  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||23859  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24286  |                                    '取得NAV区分が||23860  |                                    '取得NAV区分が
24287  |                                    If gbuMGetUPDR||23861  |                                    If gbuMGetUPDR
24288  |                                        .Cells(int||23862  |                                        .Cells(int
24289  |                                    Else          ||23863  |                                    Else          
24290  |                                        .Cells(int||23864  |                                        .Cells(int
24291  |                                    End If        ||23865  |                                    End If        
24292  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||23866  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24293  |                                    .Cells(intRang||23867  |                                    .Cells(intRang
24294  |                                    '平均純資産   ||23868  |                                    '平均純資産   
24295  |                                    dblValueIn = g||23869  |                                    dblValueIn = g
24296  |                                    If gtypOtherCo||23870  |                                    If gtypOtherCo
24297  |                                          Call sbG||23871  |                                          Call sbG
24298  |                                    Else          ||23872  |                                    Else          
24299  |                                          Call sbG||23873  |                                          Call sbG
24300  |                                    End If        ||23874  |                                    End If        
24301  |                                    If gtypOtherCo||23875  |                                    If gtypOtherCo
24302  |                                        .Cells(int||23876  |                                        .Cells(int
24303  |                                    Else          ||23877  |                                    Else          
24304  |                                        .Cells(int||23878  |                                        .Cells(int
24305  |                                    End If        ||23879  |                                    End If        
24306  |                                    'If gtypOtherC||23880  |                                    'If gtypOtherC
24307  |                                    '    .Cells(in||23881  |                                    '    .Cells(in
24308  |                                    'Else         ||23882  |                                    'Else         
24309  |                                    '    .Cells(in||23883  |                                    '    .Cells(in
24310  |                                    'End If       ||23884  |                                    'End If       
24311  |                                    .Cells(intRang||23885  |                                    .Cells(intRang
24312  |                                    strRange = "J"||23886  |                                    strRange = "J"
24313  |                                    intRange = int||23887  |                                    intRange = int
24314  |                                Else              ||23888  |                                Else              
24315  |                                    '余白無し     ||23889  |                                    '余白無し     
24316  |                                    '日付         ||23890  |                                    '日付         
24317  |                                    .Cells(11 + K,||23891  |                                    .Cells(11 + K,
24318  |                                    Format(gstrDat||23892  |                                    Format(gstrDat
24319  |                                    sWord60 & Form||23893  |                                    sWord60 & Form
24320  |                                    K = K + 1     ||23894  |                                    K = K + 1     
24321  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||23895  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24322  |                                    '取得NAV区分が||23896  |                                    '取得NAV区分が
24323  |                                    If gbuMGetUPDR||23897  |                                    If gbuMGetUPDR
24324  |                                        .Cells(11 ||23898  |                                        .Cells(11 
24325  |                                    Else          ||23899  |                                    Else          
24326  |                                        .Cells(11 ||23900  |                                        .Cells(11 
24327  |                                    End If        ||23901  |                                    End If        
24328  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||23902  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24329  |                                    .Cells(11 + K,||23903  |                                    .Cells(11 + K,
24330  |                                    '平均純資産   ||23904  |                                    '平均純資産   
24331  |                                    dblValueIn = g||23905  |                                    dblValueIn = g
24332  |                                    If gtypOtherCo||23906  |                                    If gtypOtherCo
24333  |                                          Call sbG||23907  |                                          Call sbG
24334  |                                    Else          ||23908  |                                    Else          
24335  |                                          Call sbG||23909  |                                          Call sbG
24336  |                                    End If        ||23910  |                                    End If        
24337  |                                    If gtypOtherCo||23911  |                                    If gtypOtherCo
24338  |                                        .Cells(11 ||23912  |                                        .Cells(11 
24339  |                                    Else          ||23913  |                                    Else          
24340  |                                        .Cells(11 ||23914  |                                        .Cells(11 
24341  |                                    End If        ||23915  |                                    End If        
24342  |                                    'If gtypOtherC||23916  |                                    'If gtypOtherC
24343  |                                    '    .Cells(11||23917  |                                    '    .Cells(11
24344  |                                    'Else         ||23918  |                                    'Else         
24345  |                                    '    .Cells(11||23919  |                                    '    .Cells(11
24346  |                                    'End If       ||23920  |                                    'End If       
24347  |                                    .Cells(11 + K,||23921  |                                    .Cells(11 + K,
24348  |                                    strRange = "K"||23922  |                                    strRange = "K"
24349  |                                    intRange = 11 ||23923  |                                    intRange = 11 
24350  |                                End If            ||23924  |                                End If            
24351  |                                J = 0             ||23925  |                                J = 0             
24352  |                                K = 0             ||23926  |                                K = 0             
24353  |                            'K                    ||23927  |                            'K                    
24354  |                            Else                  ||23928  |                            Else                  
24355  |                                If intRange = 11 T||23929  |                                If intRange = 11 T
24356  |                                    '余白無し     ||23930  |                                    '余白無し     
24357  |                                    '日付         ||23931  |                                    '日付         
24358  |                                    .Cells(intRang||23932  |                                    .Cells(intRang
24359  |                                    Format(gstrDat||23933  |                                    Format(gstrDat
24360  |                                    sWord60 & Form||23934  |                                    sWord60 & Form
24361  |                                    K = K + 1     ||23935  |                                    K = K + 1     
24362  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||23936  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24363  |                                    '取得NAV区分が||23937  |                                    '取得NAV区分が
24364  |                                    If gbuMGetUPDR||23938  |                                    If gbuMGetUPDR
24365  |                                        .Cells(int||23939  |                                        .Cells(int
24366  |                                    Else          ||23940  |                                    Else          
24367  |                                        .Cells(int||23941  |                                        .Cells(int
24368  |                                    End If        ||23942  |                                    End If        
24369  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||23943  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24370  |                                    .Cells(intRang||23944  |                                    .Cells(intRang
24371  |                                    '平均純資産   ||23945  |                                    '平均純資産   
24372  |                                    dblValueIn = g||23946  |                                    dblValueIn = g
24373  |                                    If gtypOtherCo||23947  |                                    If gtypOtherCo
24374  |                                          Call sbG||23948  |                                          Call sbG
24375  |                                    Else          ||23949  |                                    Else          
24376  |                                          Call sbG||23950  |                                          Call sbG
24377  |                                    End If        ||23951  |                                    End If        
24378  |                                    If gtypOtherCo||23952  |                                    If gtypOtherCo
24379  |                                        .Cells(int||23953  |                                        .Cells(int
24380  |                                    Else          ||23954  |                                    Else          
24381  |                                        .Cells(int||23955  |                                        .Cells(int
24382  |                                    End If        ||23956  |                                    End If        
24383  |                                    'If gtypOtherC||23957  |                                    'If gtypOtherC
24384  |                                    '    .Cells(in||23958  |                                    '    .Cells(in
24385  |                                    'Else         ||23959  |                                    'Else         
24386  |                                    '    .Cells(in||23960  |                                    '    .Cells(in
24387  |                                    'End If       ||23961  |                                    'End If       
24388  |                                    .Cells(intRang||23962  |                                    .Cells(intRang
24389  |                                    strRange = "K"||23963  |                                    strRange = "K"
24390  |                                    intRange = int||23964  |                                    intRange = int
24391  |                                ElseIf intRange <>||23965  |                                ElseIf intRange <>
24392  |                                    '余白有り     ||23966  |                                    '余白有り     
24393  |                                    K = K + 2     ||23967  |                                    K = K + 2     
24394  |                                    '日付         ||23968  |                                    '日付         
24395  |                                    .Cells(intRang||23969  |                                    .Cells(intRang
24396  |                                    Format(gstrDat||23970  |                                    Format(gstrDat
24397  |                                    sWord60 & Form||23971  |                                    sWord60 & Form
24398  |                                    K = K + 1     ||23972  |                                    K = K + 1     
24399  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||23973  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24400  |                                    '取得NAV区分が||23974  |                                    '取得NAV区分が
24401  |                                    If gbuMGetUPDR||23975  |                                    If gbuMGetUPDR
24402  |                                        .Cells(int||23976  |                                        .Cells(int
24403  |                                    Else          ||23977  |                                    Else          
24404  |                                        .Cells(int||23978  |                                        .Cells(int
24405  |                                    End If        ||23979  |                                    End If        
24406  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||23980  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24407  |                                    .Cells(intRang||23981  |                                    .Cells(intRang
24408  |                                    '平均純資産   ||23982  |                                    '平均純資産   
24409  |                                    dblValueIn = g||23983  |                                    dblValueIn = g
24410  |                                    If gtypOtherCo||23984  |                                    If gtypOtherCo
24411  |                                          Call sbG||23985  |                                          Call sbG
24412  |                                    Else          ||23986  |                                    Else          
24413  |                                          Call sbG||23987  |                                          Call sbG
24414  |                                    End If        ||23988  |                                    End If        
24415  |                                    If gtypOtherCo||23989  |                                    If gtypOtherCo
24416  |                                        .Cells(int||23990  |                                        .Cells(int
24417  |                                    Else          ||23991  |                                    Else          
24418  |                                        .Cells(int||23992  |                                        .Cells(int
24419  |                                    End If        ||23993  |                                    End If        
24420  |                                    'If gtypOtherC||23994  |                                    'If gtypOtherC
24421  |                                    '    .Cells(in||23995  |                                    '    .Cells(in
24422  |                                    'Else         ||23996  |                                    'Else         
24423  |                                    '    .Cells(in||23997  |                                    '    .Cells(in
24424  |                                    'End If       ||23998  |                                    'End If       
24425  |                                    .Cells(intRang||23999  |                                    .Cells(intRang
24426  |                                    strRange = "K"||24000  |                                    strRange = "K"
24427  |                                    intRange = int||24001  |                                    intRange = int
24428  |                                Else              ||24002  |                                Else              
24429  |                                    J = 0         ||24003  |                                    J = 0         
24430  |                                    K = 0         ||24004  |                                    K = 0         
24431  |                                    strRange = "J"||24005  |                                    strRange = "J"
24432  |                                    intRange = 11 ||24006  |                                    intRange = 11 
24433  |                                                  ||24007  |                                                  
24434  |                                    AddPoint = din||24008  |                                    AddPoint = din
24435  |                                    Exit For      ||24009  |                                    Exit For      
24436  |                                End If            ||24010  |                                End If            
24437  |                                J = 0             ||24011  |                                J = 0             
24438  |                                K = 0             ||24012  |                                K = 0             
24439  |                            End If                ||24013  |                            End If                
24440  |                        'ループ二回目以降         ||24014  |                        'ループ二回目以降         
24441  |                        Else                      ||24015  |                        Else                      
24442  |                            If strRange = "J" Then||24016  |                            If strRange = "J" Then
24443  |                                If intRange = 11 T||24017  |                                If intRange = 11 T
24444  |                                    '余白無し     ||24018  |                                    '余白無し     
24445  |                                    '日付         ||24019  |                                    '日付         
24446  |                                    .Cells(intRang||24020  |                                    .Cells(intRang
24447  |                                    Format(gstrDat||24021  |                                    Format(gstrDat
24448  |                                    sWord60 & Form||24022  |                                    sWord60 & Form
24449  |                                    J = J + 1     ||24023  |                                    J = J + 1     
24450  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24024  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24451  |                                    '取得NAV区分が||24025  |                                    '取得NAV区分が
24452  |                                    If gbuMGetUPDR||24026  |                                    If gbuMGetUPDR
24453  |                                        .Cells(int||24027  |                                        .Cells(int
24454  |                                    Else          ||24028  |                                    Else          
24455  |                                        .Cells(int||24029  |                                        .Cells(int
24456  |                                    End If        ||24030  |                                    End If        
24457  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24031  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24458  |                                    .Cells(intRang||24032  |                                    .Cells(intRang
24459  |                                    '平均純資産   ||24033  |                                    '平均純資産   
24460  |                                    dblValueIn = g||24034  |                                    dblValueIn = g
24461  |                                    If gtypOtherCo||24035  |                                    If gtypOtherCo
24462  |                                          Call sbG||24036  |                                          Call sbG
24463  |                                    Else          ||24037  |                                    Else          
24464  |                                          Call sbG||24038  |                                          Call sbG
24465  |                                    End If        ||24039  |                                    End If        
24466  |                                    If gtypOtherCo||24040  |                                    If gtypOtherCo
24467  |                                        .Cells(int||24041  |                                        .Cells(int
24468  |                                    Else          ||24042  |                                    Else          
24469  |                                        .Cells(int||24043  |                                        .Cells(int
24470  |                                    End If        ||24044  |                                    End If        
24471  |                                    'If gtypOtherC||24045  |                                    'If gtypOtherC
24472  |                                    '    .Cells(in||24046  |                                    '    .Cells(in
24473  |                                    'Else         ||24047  |                                    'Else         
24474  |                                    '    .Cells(in||24048  |                                    '    .Cells(in
24475  |                                    'End If       ||24049  |                                    'End If       
24476  |                                    .Cells(intRang||24050  |                                    .Cells(intRang
24477  |                                    strRange = "J"||24051  |                                    strRange = "J"
24478  |                                    intRange = int||24052  |                                    intRange = int
24479  |                                ElseIf intRange <>||24053  |                                ElseIf intRange <>
24480  |                                    '余白有り     ||24054  |                                    '余白有り     
24481  |                                    J = J + 1     ||24055  |                                    J = J + 1     
24482  |                                    '日付         ||24056  |                                    '日付         
24483  |                                    .Cells(intRang||24057  |                                    .Cells(intRang
24484  |                                    Format(gstrDat||24058  |                                    Format(gstrDat
24485  |                                    sWord60 & Form||24059  |                                    sWord60 & Form
24486  |                                    J = J + 1     ||24060  |                                    J = J + 1     
24487  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24061  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24488  |                                    '取得NAV区分が||24062  |                                    '取得NAV区分が
24489  |                                    If gbuMGetUPDR||24063  |                                    If gbuMGetUPDR
24490  |                                        .Cells(int||24064  |                                        .Cells(int
24491  |                                    Else          ||24065  |                                    Else          
24492  |                                        .Cells(int||24066  |                                        .Cells(int
24493  |                                    End If        ||24067  |                                    End If        
24494  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24068  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24495  |                                    .Cells(intRang||24069  |                                    .Cells(intRang
24496  |                                    '平均純資産   ||24070  |                                    '平均純資産   
24497  |                                    dblValueIn = g||24071  |                                    dblValueIn = g
24498  |                                    If gtypOtherCo||24072  |                                    If gtypOtherCo
24499  |                                          Call sbG||24073  |                                          Call sbG
24500  |                                    Else          ||24074  |                                    Else          
24501  |                                          Call sbG||24075  |                                          Call sbG
24502  |                                    End If        ||24076  |                                    End If        
24503  |                                    If gtypOtherCo||24077  |                                    If gtypOtherCo
24504  |                                        .Cells(int||24078  |                                        .Cells(int
24505  |                                    Else          ||24079  |                                    Else          
24506  |                                        .Cells(int||24080  |                                        .Cells(int
24507  |                                    End If        ||24081  |                                    End If        
24508  |                                    'If gtypOtherC||24082  |                                    'If gtypOtherC
24509  |                                    '    .Cells(in||24083  |                                    '    .Cells(in
24510  |                                    'Else         ||24084  |                                    'Else         
24511  |                                    '    .Cells(in||24085  |                                    '    .Cells(in
24512  |                                    'End If       ||24086  |                                    'End If       
24513  |                                    .Cells(intRang||24087  |                                    .Cells(intRang
24514  |                                    strRange = "J"||24088  |                                    strRange = "J"
24515  |                                    intRange = int||24089  |                                    intRange = int
24516  |                                Else              ||24090  |                                Else              
24517  |                                    '余白無し     ||24091  |                                    '余白無し     
24518  |                                    '日付         ||24092  |                                    '日付         
24519  |                                    .Cells(11 + K,||24093  |                                    .Cells(11 + K,
24520  |                                    Format(gstrDat||24094  |                                    Format(gstrDat
24521  |                                    sWord60 & Form||24095  |                                    sWord60 & Form
24522  |                                    K = K + 1     ||24096  |                                    K = K + 1     
24523  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24097  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24524  |                                    '取得NAV区分が||24098  |                                    '取得NAV区分が
24525  |                                    If gbuMGetUPDR||24099  |                                    If gbuMGetUPDR
24526  |                                        .Cells(11 ||24100  |                                        .Cells(11 
24527  |                                    Else          ||24101  |                                    Else          
24528  |                                        .Cells(11 ||24102  |                                        .Cells(11 
24529  |                                    End If        ||24103  |                                    End If        
24530  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24104  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24531  |                                    .Cells(11 + K,||24105  |                                    .Cells(11 + K,
24532  |                                    '平均純資産   ||24106  |                                    '平均純資産   
24533  |                                    dblValueIn = g||24107  |                                    dblValueIn = g
24534  |                                    If gtypOtherCo||24108  |                                    If gtypOtherCo
24535  |                                          Call sbG||24109  |                                          Call sbG
24536  |                                    Else          ||24110  |                                    Else          
24537  |                                          Call sbG||24111  |                                          Call sbG
24538  |                                    End If        ||24112  |                                    End If        
24539  |                                    If gtypOtherCo||24113  |                                    If gtypOtherCo
24540  |                                        .Cells(11 ||24114  |                                        .Cells(11 
24541  |                                    Else          ||24115  |                                    Else          
24542  |                                        .Cells(11 ||24116  |                                        .Cells(11 
24543  |                                    End If        ||24117  |                                    End If        
24544  |                                    'If gtypOtherC||24118  |                                    'If gtypOtherC
24545  |                                    '    .Cells(11||24119  |                                    '    .Cells(11
24546  |                                    'Else         ||24120  |                                    'Else         
24547  |                                    '    .Cells(11||24121  |                                    '    .Cells(11
24548  |                                    'End If       ||24122  |                                    'End If       
24549  |                                    .Cells(11 + K,||24123  |                                    .Cells(11 + K,
24550  |                                    strRange = "K"||24124  |                                    strRange = "K"
24551  |                                    intRange = 11 ||24125  |                                    intRange = 11 
24552  |                                End If            ||24126  |                                End If            
24553  |                                J = 0             ||24127  |                                J = 0             
24554  |                                K = 0             ||24128  |                                K = 0             
24555  |                            Else                  ||24129  |                            Else                  
24556  |                                If intRange = 11 T||24130  |                                If intRange = 11 T
24557  |                                    '余白無し     ||24131  |                                    '余白無し     
24558  |                                    '日付         ||24132  |                                    '日付         
24559  |                                    .Cells(11 + K,||24133  |                                    .Cells(11 + K,
24560  |                                    Format(gstrDat||24134  |                                    Format(gstrDat
24561  |                                    sWord60 & Form||24135  |                                    sWord60 & Form
24562  |                                    K = K + 1     ||24136  |                                    K = K + 1     
24563  | '2008/02/20 START 時価総額基準の外部委託顧問料対 ||24137  | '2008/02/20 START 時価総額基準の外部委託顧問料対 
24564  |                                    '取得NAV区分が||24138  |                                    '取得NAV区分が
24565  |                                    If gbuMGetUPDR||24139  |                                    If gbuMGetUPDR
24566  |                                       .Cells(11 +||24140  |                                       .Cells(11 +
24567  |                                    Else          ||24141  |                                    Else          
24568  |                                       .Cells(11 +||24142  |                                       .Cells(11 +
24569  |                                    End If        ||24143  |                                    End If        
24570  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24144  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24571  |                                    .Cells(11 + K,||24145  |                                    .Cells(11 + K,
24572  |                                    '平均純資産   ||24146  |                                    '平均純資産   
24573  |                                    dblValueIn = g||24147  |                                    dblValueIn = g
24574  |                                    If gtypOtherCo||24148  |                                    If gtypOtherCo
24575  |                                          Call sbG||24149  |                                          Call sbG
24576  |                                    Else          ||24150  |                                    Else          
24577  |                                          Call sbG||24151  |                                          Call sbG
24578  |                                    End If        ||24152  |                                    End If        
24579  |                                    If gtypOtherCo||24153  |                                    If gtypOtherCo
24580  |                                        .Cells(11 ||24154  |                                        .Cells(11 
24581  |                                    Else          ||24155  |                                    Else          
24582  |                                        .Cells(11 ||24156  |                                        .Cells(11 
24583  |                                    End If        ||24157  |                                    End If        
24584  |                                    'If gtypOtherC||24158  |                                    'If gtypOtherC
24585  |                                    '    .Cells(11||24159  |                                    '    .Cells(11
24586  |                                    'Else         ||24160  |                                    'Else         
24587  |                                    '    .Cells(11||24161  |                                    '    .Cells(11
24588  |                                    'End If       ||24162  |                                    'End If       
24589  |                                    .Cells(11 + K,||24163  |                                    .Cells(11 + K,
24590  |                                    strRange = "K"||24164  |                                    strRange = "K"
24591  |                                    intRange = 11 ||24165  |                                    intRange = 11 
24592  |                                ElseIf intRange <>||24166  |                                ElseIf intRange <>
24593  |                                    '余白有り     ||24167  |                                    '余白有り     
24594  |                                    K = K + 1     ||24168  |                                    K = K + 1     
24595  |                                    '日付         ||24169  |                                    '日付         
24596  |                                    .Cells(intRang||24170  |                                    .Cells(intRang
24597  |                                    Format(gstrDat||24171  |                                    Format(gstrDat
24598  |                                    sWord60 & Form||24172  |                                    sWord60 & Form
24599  |                                    K = K + 1     ||24173  |                                    K = K + 1     
24600  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24174  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24601  |                                    '取得NAV区分が||24175  |                                    '取得NAV区分が
24602  |                                    If gbuMGetUPDR||24176  |                                    If gbuMGetUPDR
24603  |                                        .Cells(int||24177  |                                        .Cells(int
24604  |                                    Else          ||24178  |                                    Else          
24605  |                                        .Cells(int||24179  |                                        .Cells(int
24606  |                                    End If        ||24180  |                                    End If        
24607  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24181  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24608  |                                    .Cells(intRang||24182  |                                    .Cells(intRang
24609  |                                    '平均純資産   ||24183  |                                    '平均純資産   
24610  |                                    dblValueIn = g||24184  |                                    dblValueIn = g
24611  |                                    If gtypOtherCo||24185  |                                    If gtypOtherCo
24612  |                                          Call sbG||24186  |                                          Call sbG
24613  |                                    Else          ||24187  |                                    Else          
24614  |                                          Call sbG||24188  |                                          Call sbG
24615  |                                    End If        ||24189  |                                    End If        
24616  |                                    If gtypOtherCo||24190  |                                    If gtypOtherCo
24617  |                                        .Cells(int||24191  |                                        .Cells(int
24618  |                                    Else          ||24192  |                                    Else          
24619  |                                        .Cells(int||24193  |                                        .Cells(int
24620  |                                    End If        ||24194  |                                    End If        
24621  |                                    'If gtypOtherC||24195  |                                    'If gtypOtherC
24622  |                                    '    .Cells(in||24196  |                                    '    .Cells(in
24623  |                                    'Else         ||24197  |                                    'Else         
24624  |                                    '    .Cells(in||24198  |                                    '    .Cells(in
24625  |                                    'End If       ||24199  |                                    'End If       
24626  |                                    .Cells(intRang||24200  |                                    .Cells(intRang
24627  |                                    strRange = "K"||24201  |                                    strRange = "K"
24628  |                                    intRange = int||24202  |                                    intRange = int
24629  |                                Else              ||24203  |                                Else              
24630  |                                    J = 0         ||24204  |                                    J = 0         
24631  |                                    K = 0         ||24205  |                                    K = 0         
24632  |                                    strRange = "J"||24206  |                                    strRange = "J"
24633  |                                    intRange = 11 ||24207  |                                    intRange = 11 
24634  |                                    AddPoint = din||24208  |                                    AddPoint = din
24635  |                                    Exit For      ||24209  |                                    Exit For      
24636  |                                End If            ||24210  |                                End If            
24637  |                                J = 0             ||24211  |                                J = 0             
24638  |                                K = 0             ||24212  |                                K = 0             
24639  |                            End If                ||24213  |                            End If                
24640  |                        End If                    ||24214  |                        End If                    
24641  |                    Next dintFor                  ||24215  |                    Next dintFor                  
24642  |                End With                          ||24216  |                End With                          
24643  |            End If                                ||24217  |            End If                                
24644  |                                                  ||24218  |                                                  
24645  |            'A4印刷用に上2行を削除して、プレビュー||24219  |            'A4印刷用に上2行を削除して、プレビュー
24646  |            xlSheet.Rows("1:2").Delete Shift:=xlUp||24220  |            xlSheet.Rows("1:2").Delete Shift:=xlUp
24647  |        Next L                                    ||24221  |        Next L                                    
24648  |    End If                                        ||24222  |    End If                                        
24649  |                                                  ||24223  |                                                  
24650  |    '正常戻り値セット                             ||24224  |    '正常戻り値セット                             
24651  |    fnblExcelEnglishOut_ChangeRate = True         ||24225  |    fnblExcelEnglishOut_ChangeRate = True         
24652  |    GoTo EndProc                                  ||24226  |    GoTo EndProc                                  
24653  |                                                  ||24227  |                                                  
24654  |ErrorTrap:                                        ||24228  |ErrorTrap:                                        
24655  |    ' Excel を起動できない場合に発生するエラーをト||24229  |    ' Excel を起動できない場合に発生するエラーをト
24656  |    Select Case Err.Number                        ||24230  |    Select Case Err.Number                        
24657  |        Case 440               ' オートメーション ||24231  |        Case 440               ' オートメーション 
24658  |            iTries = iTries + 1                   ||24232  |            iTries = iTries + 1                   
24659  |            ' Excel の再起動を 5 回まで行います。 ||24233  |            ' Excel の再起動を 5 回まで行います。 
24660  |            If iTries < 5 Then                    ||24234  |            If iTries < 5 Then                    
24661  |               Set xlApp = New Excel.Application  ||24235  |               Set xlApp = New Excel.Application  
24662  |               Resume                             ||24236  |               Resume                             
24663  |            Else                                  ||24237  |            Else                                  
24664  |               Err.Raise Number:=vbObjectError + 2||24238  |               Err.Raise Number:=vbObjectError + 2
24665  |               Description:="Microsoft Excel を起 ||24239  |               Description:="Microsoft Excel を起 
24666  |            End If                                ||24240  |            End If                                
24667  |        Case Else                                 ||24241  |        Case Else                                 
24668  |    End Select                                    ||24242  |    End Select                                    
24669  |                                                  ||24243  |                                                  
24670  |    'Workbookを閉じる                             ||24244  |    'Workbookを閉じる                             
24671  |    xlBook.Close                                  ||24245  |    xlBook.Close                                  
24672  |                                                  ||24246  |                                                  
24673  |    'Excel終了                                    ||24247  |    'Excel終了                                    
24674  |    xlApp.Quit                                    ||24248  |    xlApp.Quit                                    
24675  |                                                  ||24249  |                                                  
24676  |    'オブジェクトの解放                           ||24250  |    'オブジェクトの解放                           
24677  |    Set xlApp = Nothing                           ||24251  |    Set xlApp = Nothing                           
24678  |    Set xlBook = Nothing                          ||24252  |    Set xlBook = Nothing                          
24679  |    Set xlSheet = Nothing                         ||24253  |    Set xlSheet = Nothing                         
24680  |                                                  ||24254  |                                                  
24681  |OnErrorProc:                                      ||24255  |OnErrorProc:                                      
24682  |    Call subError("システムエラー", Str(Err.Number||24256  |    Call subError("システムエラー", Str(Err.Number
24683  |        Error, strErrCall, conTitle)              ||24257  |        Error, strErrCall, conTitle)              
24684  |    'マウスポインター元に戻す                     ||24258  |    'マウスポインター元に戻す                     
24685  |    Screen.MousePointer = vbDefault               ||24259  |    Screen.MousePointer = vbDefault               
24686  |    GoTo EndProc                                  ||24260  |    GoTo EndProc                                  
24687  |                                                  ||24261  |                                                  
24688  |EndProc:                                          ||24262  |EndProc:                                          
24689  |                                                  ||24263  |                                                  
24690  |End Function                                      ||24264  |End Function                                      
24691  |                                                  ||24265  |                                                  
24692  |'=================================================||24266  |'=================================================
24693  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbExcelChgRateSheetEnglishOut||24267  |'ﾌﾟﾛｼｰｼﾞｬ名称    :   sbExcelChgRateSheetEnglishOut
24694  |'機能            :   確認書の料率変更履歴出力(英語||24268  |'機能            :   確認書の料率変更履歴出力(英語
24695  |'                                                 ||24269  |'                                                 
24696  |'日付               担当　              修正内容  ||24270  |'日付               担当　              修正内容  
24697  |'-------------------------------------------------||24271  |'-------------------------------------------------
24698  |'2006/08/22         K.Furuya <SRA>     新規作成(期||24272  |'2006/08/22         K.Furuya <SRA>     新規作成(期
24699  |'=================================================||24273  |'=================================================
24700  |Private Sub sbExcelChgRateSheetEnglishOut( _      ||24274  |Private Sub sbExcelChgRateSheetEnglishOut( _      
24701  |    ByVal sGetAccCode As String, _                ||24275  |    ByVal sGetAccCode As String, _                
24702  |    ByVal TotalRate As Currency, _                ||24276  |    ByVal TotalRate As Currency, _                
24703  |    ByVal lRecIdx As Long, _                      ||24277  |    ByVal lRecIdx As Long, _                      
24704  |    ByVal StartDate As Date, _                    ||24278  |    ByVal StartDate As Date, _                    
24705  |    ByVal EndDate As Date, _                      ||24279  |    ByVal EndDate As Date, _                      
24706  |    ByVal dlngMeisyoSu As Integer, _              ||24280  |    ByVal dlngMeisyoSu As Integer, _              
24707  |    ByVal NavGetFlg As String _                   ||24281  |    ByVal NavGetFlg As String _                   
24708  |    )                                             ||24282  |    )                                             
24709  |    Dim i       As Integer                        ||24283  |    Dim i       As Integer                        
24710  |    Dim J       As Integer                        ||24284  |    Dim J       As Integer                        
24711  |    Dim Idx_i   As Integer                        ||24285  |    Dim Idx_i   As Integer                        
24712  |    Dim Idx_j   As Integer                        ||24286  |    Dim Idx_j   As Integer                        
24713  |    Dim Add_i   As Integer                        ||24287  |    Dim Add_i   As Integer                        
24714  |    Dim PgIndx  As Integer                        ||24288  |    Dim PgIndx  As Integer                        
24715  |    Dim RateCnt As Integer                        ||24289  |    Dim RateCnt As Integer                        
24716  |    Dim AddRateCnt As Integer                     ||24290  |    Dim AddRateCnt As Integer                     
24717  |    Dim iPage   As Integer                        ||24291  |    Dim iPage   As Integer                        
24718  |    Dim GenPage As Integer                        ||24292  |    Dim GenPage As Integer                        
24719  |    Dim iAmari  As Integer                        ||24293  |    Dim iAmari  As Integer                        
24720  |    Dim SetPoint As Integer                       ||24294  |    Dim SetPoint As Integer                       
24721  |    Dim StartLine As Integer                      ||24295  |    Dim StartLine As Integer                      
24722  |    Dim J_Cnt As Integer                          ||24296  |    Dim J_Cnt As Integer                          
24723  |    Dim J_AddCnt As Integer                       ||24297  |    Dim J_AddCnt As Integer                       
24724  |    Const StartPoint As Integer = 12              ||24298  |    Const StartPoint As Integer = 12              
24725  |    Const FixedLine As Integer = 6                ||24299  |    Const FixedLine As Integer = 6                
24726  |    Const DivideLine As Integer = 4               ||24300  |    Const DivideLine As Integer = 4               
24727  |    Const KikanLine As Integer = 1                ||24301  |    Const KikanLine As Integer = 1                
24728  |    Const AddLine As Integer = 2                  ||24302  |    Const AddLine As Integer = 2                  
24729  |                                                  ||24303  |                                                  
24730  |    RateCnt = 0                                   ||24304  |    RateCnt = 0                                   
24731  |                                                  ||24305  |                                                  
24732  |    '固定料率                                     ||24306  |    '固定料率                                     
24733  |    If gbuMGetUPDRec.N(lRecIdx).MGET_other_rate_ru||24307  |    If gbuMGetUPDRec.N(lRecIdx).MGET_other_rate_ru
24734  |        For i = LBound(gtypOtherComRec) To UBound(||24308  |        For i = LBound(gtypOtherComRec) To UBound(
24735  |            For J = LBound(gtypOtherComRec(i).APPL||24309  |            For J = LBound(gtypOtherComRec(i).APPL
24736  |                '料率の数を積算                   ||24310  |                '料率の数を積算                   
24737  |                RateCnt = RateCnt + 1             ||24311  |                RateCnt = RateCnt + 1             
24738  |            Next J                                ||24312  |            Next J                                
24739  |            If i = UBound(gtypOtherComRec) Then   ||24313  |            If i = UBound(gtypOtherComRec) Then   
24740  |                RateCnt = RateCnt + AddLine       ||24314  |                RateCnt = RateCnt + AddLine       
24741  |            Else                                  ||24315  |            Else                                  
24742  |                RateCnt = RateCnt + AddLine + Fixe||24316  |                RateCnt = RateCnt + AddLine + Fixe
24743  |            End If                                ||24317  |            End If                                
24744  |        Next i                                    ||24318  |        Next i                                    
24745  |    '段階料率                                     ||24319  |    '段階料率                                     
24746  |    ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other_rat||24320  |    ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_other_rat
24747  |        For i = LBound(gtypOtherComRec) To UBound(||24321  |        For i = LBound(gtypOtherComRec) To UBound(
24748  |            '料率カウント変数を初期化             ||24322  |            '料率カウント変数を初期化             
24749  |            J_Cnt = 0                             ||24323  |            J_Cnt = 0                             
24750  |            For J = LBound(gtypOtherComRec(i).APPL||24324  |            For J = LBound(gtypOtherComRec(i).APPL
24751  |                '料率の数を積算                   ||24325  |                '料率の数を積算                   
24752  |                J_Cnt = J_Cnt + 1                 ||24326  |                J_Cnt = J_Cnt + 1                 
24753  |            Next J                                ||24327  |            Next J                                
24754  |            If i = UBound(gtypOtherComRec) Then   ||24328  |            If i = UBound(gtypOtherComRec) Then   
24755  |                RateCnt = RateCnt + AddLine + (((J||24329  |                RateCnt = RateCnt + AddLine + (((J
24756  |            Else                                  ||24330  |            Else                                  
24757  |                RateCnt = RateCnt + AddLine + (((J||24331  |                RateCnt = RateCnt + AddLine + (((J
24758  |            End If                                ||24332  |            End If                                
24759  |        Next i                                    ||24333  |        Next i                                    
24760  |    End If                                        ||24334  |    End If                                        
24761  |                                                  ||24335  |                                                  
24762  |    '頁数を計算する                               ||24336  |    '頁数を計算する                               
24763  |    iPage = RateCnt \ 51 '51は有効行数            ||24337  |    iPage = RateCnt \ 51 '51は有効行数            
24764  |    '頁が割切れるか計算する                       ||24338  |    '頁が割切れるか計算する                       
24765  |    iAmari = RateCnt Mod 51                       ||24339  |    iAmari = RateCnt Mod 51                       
24766  |    '頁が割切れない場合は一頁増やす               ||24340  |    '頁が割切れない場合は一頁増やす               
24767  |    If iAmari <> 0 Then                           ||24341  |    If iAmari <> 0 Then                           
24768  |        iPage = iPage + 1                         ||24342  |        iPage = iPage + 1                         
24769  |    End If                                        ||24343  |    End If                                        
24770  |                                                  ||24344  |                                                  
24771  |    'ループの開始ポジション変数を初期化           ||24345  |    'ループの開始ポジション変数を初期化           
24772  |    SetPoint = 0                                  ||24346  |    SetPoint = 0                                  
24773  |    'ループ変数のインクリメント変数を初期化       ||24347  |    'ループ変数のインクリメント変数を初期化       
24774  |    Add_i = 0                                     ||24348  |    Add_i = 0                                     
24775  |    'シート番号を初期化                           ||24349  |    'シート番号を初期化                           
24776  |    gTotalDnavCnt = 0                             ||24350  |    gTotalDnavCnt = 0                             
24777  |                                                  ||24351  |                                                  
24778  |    For PgIndx = 1 To iPage                       ||24352  |    For PgIndx = 1 To iPage                       
24779  |        'ルール単位の料率文言の行数取得変数の初期 ||24353  |        'ルール単位の料率文言の行数取得変数の初期 
24780  |        RateCnt = StartPoint                      ||24354  |        RateCnt = StartPoint                      
24781  |        AddRateCnt = 0                            ||24355  |        AddRateCnt = 0                            
24782  |                                                  ||24356  |                                                  
24783  |        'スタート行をセット                       ||24357  |        'スタート行をセット                       
24784  |        StartLine = StartPoint                    ||24358  |        StartLine = StartPoint                    
24785  |                                                  ||24359  |                                                  
24786  |        xlBook.Worksheets.Add after:=xlBook.Sheets||24360  |        xlBook.Worksheets.Add after:=xlBook.Sheets
24787  |        gProcessCnt = gProcessCnt + 1             ||24361  |        gProcessCnt = gProcessCnt + 1             
24788  |        Set xlSheet = xlBook.Sheets(gProcessCnt)  ||24362  |        Set xlSheet = xlBook.Sheets(gProcessCnt)  
24789  |                                                  ||24363  |                                                  
24790  |        'Excelフォーマットを調整                  ||24364  |        'Excelフォーマットを調整                  
24791  |        xlSheet.Cells.ColumnWidth = 1             ||24365  |        xlSheet.Cells.ColumnWidth = 1             
24792  |        xlSheet.Cells.Font.Size = 11              ||24366  |        xlSheet.Cells.Font.Size = 11              
24793  |        'シート名を設定(日次NAV一覧**)            ||24367  |        'シート名を設定(日次NAV一覧**)            
24794  |                                                  ||24368  |                                                  
24795  |        If dstrOldAccCode = sGetAccCode Then      ||24369  |        If dstrOldAccCode = sGetAccCode Then      
24796  |            gTotalDnavCnt = gTotalDnavCnt + 1     ||24370  |            gTotalDnavCnt = gTotalDnavCnt + 1     
24797  |        Else                                      ||24371  |        Else                                      
24798  |            gTotalDnavCnt = 1                     ||24372  |            gTotalDnavCnt = 1                     
24799  |            dstrOldAccCode = sGetAccCode          ||24373  |            dstrOldAccCode = sGetAccCode          
24800  |        End If                                    ||24374  |        End If                                    
24801  |        'gTotalCnt = gTotalCnt + 1                ||24375  |        'gTotalCnt = gTotalCnt + 1                
24802  |        'xlBook.Sheets(gProcessCnt).Name = sWord60||24376  |        'xlBook.Sheets(gProcessCnt).Name = sWord60
24803  |        '複数ページの場合                         ||24377  |        '複数ページの場合                         
24804  |        If iPage > 1 Then                         ||24378  |        If iPage > 1 Then                         
24805  |            xlBook.Sheets(gProcessCnt).Name = sWor||24379  |            xlBook.Sheets(gProcessCnt).Name = sWor
24806  |        Else                                      ||24380  |        Else                                      
24807  |            xlBook.Sheets(gProcessCnt).Name = sWor||24381  |            xlBook.Sheets(gProcessCnt).Name = sWor
24808  |        End If                                    ||24382  |        End If                                    
24809  |                                                  ||24383  |                                                  
24810  |        'シートの余白を設定                       ||24384  |        'シートの余白を設定                       
24811  |        xlSheet.PageSetup.TopMargin = Application.||24385  |        xlSheet.PageSetup.TopMargin = Application.
24812  |        xlSheet.PageSetup.BottomMargin = Applicati||24386  |        xlSheet.PageSetup.BottomMargin = Applicati
24813  |        xlSheet.PageSetup.LeftMargin = Application||24387  |        xlSheet.PageSetup.LeftMargin = Application
24814  |        xlSheet.PageSetup.RightMargin = Applicatio||24388  |        xlSheet.PageSetup.RightMargin = Applicatio
24815  |                                                  ||24389  |                                                  
24816  |        DoEvents                                  ||24390  |        DoEvents                                  
24817  |                                                  ||24391  |                                                  
24818  |                                                  ||24392  |                                                  
24819  |        With xlSheet                              ||24393  |        With xlSheet                              
24820  |            '題目                                 ||24394  |            '題目                                 
24821  |            Select Case Mid(gbuMGetUPDRec.N(lRecId||24395  |            Select Case Mid(gbuMGetUPDRec.N(lRecId
24822  |                Case Mid(mstrContractFlag(1), 1, 1||24396  |                Case Mid(mstrContractFlag(1), 1, 1
24823  |                    .Cells(5, 1).Value = sWord54a ||24397  |                    .Cells(5, 1).Value = sWord54a 
24824  |                Case Mid(mstrContractFlag(2), 1, 1||24398  |                Case Mid(mstrContractFlag(2), 1, 1
24825  |                    .Cells(5, 1).Value = sWord55a ||24399  |                    .Cells(5, 1).Value = sWord55a 
24826  |                Case Mid(mstrContractFlag(3), 1, 1||24400  |                Case Mid(mstrContractFlag(3), 1, 1
24827  |                    .Cells(5, 1).Value = sWord56a ||24401  |                    .Cells(5, 1).Value = sWord56a 
24828  |                Case Else                         ||24402  |                Case Else                         
24829  |            End Select                            ||24403  |            End Select                            
24830  |            .Cells(5, 1).Font.Size = 14           ||24404  |            .Cells(5, 1).Font.Size = 14           
24831  |            .Range("A5:BG5").HorizontalAlignment =||24405  |            .Range("A5:BG5").HorizontalAlignment =
24832  |            '出力日付                             ||24406  |            '出力日付                             
24833  |            If RTrim(txtSysOutDate.Text) = "" Then||24407  |            If RTrim(txtSysOutDate.Text) = "" Then
24834  |                .Cells(3, 50).Value = sWord34a    ||24408  |                .Cells(3, 50).Value = sWord34a    
24835  |                .Cells(3, 50).HorizontalAlignment ||24409  |                .Cells(3, 50).HorizontalAlignment 
24836  |            Else                                  ||24410  |            Else                                  
24837  |                .Cells(3, 43).NumberFormatLocal = ||24411  |                .Cells(3, 43).NumberFormatLocal = 
24838  |                .Cells(3, 43).Value = CStr(Format(||24412  |                .Cells(3, 43).Value = CStr(Format(
24839  |            End If                                ||24413  |            End If                                
24840  |            'ファンド名                           ||24414  |            'ファンド名                           
24841  |            .Cells(7, 2).Value = sWord4a          ||24415  |            .Cells(7, 2).Value = sWord4a          
24842  |            .Cells(7, 13).Value = sWord19         ||24416  |            .Cells(7, 13).Value = sWord19         
24843  |            .Cells(7, 15).NumberFormatLocal = "@" ||24417  |            .Cells(7, 15).NumberFormatLocal = "@" 
24844  |            .Cells(7, 15).Value = gbuMGetUPDRec.N(||24418  |            .Cells(7, 15).Value = gbuMGetUPDRec.N(
24845  |            'ファンドコード                       ||24419  |            'ファンドコード                       
24846  |            .Cells(8, 2).Value = sWord4_2a        ||24420  |            .Cells(8, 2).Value = sWord4_2a        
24847  |            .Cells(8, 13).Value = sWord19         ||24421  |            .Cells(8, 13).Value = sWord19         
24848  |            .Cells(8, 15).NumberFormatLocal = "@" ||24422  |            .Cells(8, 15).NumberFormatLocal = "@" 
24849  |            .Cells(8, 15).Value = sGetAccCode     ||24423  |            .Cells(8, 15).Value = sGetAccCode     
24850  |                                                  ||24424  |                                                  
24851  |            '計算期間                             ||24425  |            '計算期間                             
24852  |            .Cells(10, 2).Value = sWord5a         ||24426  |            .Cells(10, 2).Value = sWord5a         
24853  |            .Cells(10, 13).Value = sWord19        ||24427  |            .Cells(10, 13).Value = sWord19        
24854  |            '名称許諾料計算で日次(休日無し)       ||24428  |            '名称許諾料計算で日次(休日無し)       
24855  |            If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c||24429  |            If Mid(gbuMGetUPDRec.N(lRecIdx).MGET_c
24856  |            And gbuMGetUPDRec.N(lRecIdx).MGET_nav_||24430  |            And gbuMGetUPDRec.N(lRecIdx).MGET_nav_
24857  |                .Cells(10, 15).Value = _          ||24431  |                .Cells(10, 15).Value = _          
24858  |                    CStr(Format(StartDate, "mmmm d||24432  |                    CStr(Format(StartDate, "mmmm d
24859  |            Else                                  ||24433  |            Else                                  
24860  |                .Cells(10, 15).Value = _          ||24434  |                .Cells(10, 15).Value = _          
24861  |                    CStr(Format(StartDate, "mmmm d||24435  |                    CStr(Format(StartDate, "mmmm d
24862  |            End If                                ||24436  |            End If                                
24863  |            '固定料率                             ||24437  |            '固定料率                             
24864  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other||24438  |            If gbuMGetUPDRec.N(lRecIdx).MGET_other
24865  |                '年率1行固定                      ||24439  |                '年率1行固定                      
24866  |                For i = SetPoint To UBound(gtypOth||24440  |                For i = SetPoint To UBound(gtypOth
24867  |                                                  ||24441  |                                                  
24868  |                    'ループ変数のインクリメント変 ||24442  |                    'ループ変数のインクリメント変 
24869  |                    Add_i = Add_i + 1             ||24443  |                    Add_i = Add_i + 1             
24870  |                                                  ||24444  |                                                  
24871  |                    For J = LBound(gtypOtherComRec||24445  |                    For J = LBound(gtypOtherComRec
24872  |                    '適用期間                     ||24446  |                    '適用期間                     
24873  |                        .Cells(StartLine, 2).Value||24447  |                        .Cells(StartLine, 2).Value
24874  |                        .Cells(StartLine, 13).Valu||24448  |                        .Cells(StartLine, 13).Valu
24875  |                        '名称許諾料計算で日次(休日||24449  |                        '名称許諾料計算で日次(休日
24876  |                        If Mid(gbuMGetUPDRec.N(lRe||24450  |                        If Mid(gbuMGetUPDRec.N(lRe
24877  |                        And gbuMGetUPDRec.N(lRecId||24451  |                        And gbuMGetUPDRec.N(lRecId
24878  |                            .Cells(StartLine, 15).||24452  |                            .Cells(StartLine, 15).
24879  |                                CStr(Format(gstrDa||24453  |                                CStr(Format(gstrDa
24880  |                                sWord20 & CStr(For||24454  |                                sWord20 & CStr(For
24881  |                                sWord59 & sWord43 ||24455  |                                sWord59 & sWord43 
24882  |                        Else                      ||24456  |                        Else                      
24883  |                            .Cells(StartLine, 15).||24457  |                            .Cells(StartLine, 15).
24884  |                                CStr(Format(gstrDa||24458  |                                CStr(Format(gstrDa
24885  |                                sWord20 & CStr(For||24459  |                                sWord20 & CStr(For
24886  |                                sWord59 & sWord43 ||24460  |                                sWord59 & sWord43 
24887  |                        End If                    ||24461  |                        End If                    
24888  |                    '平均純資産総額               ||24462  |                    '平均純資産総額               
24889  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24463  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24890  |                        '取得NAV区分が4:日次時価総||24464  |                        '取得NAV区分が4:日次時価総
24891  |                        If gbuMGetUPDRec.N(lRecIdx||24465  |                        If gbuMGetUPDRec.N(lRecIdx
24892  |                            .Cells(StartLine + Kik||24466  |                            .Cells(StartLine + Kik
24893  |                        Else                      ||24467  |                        Else                      
24894  |                            .Cells(StartLine + Kik||24468  |                            .Cells(StartLine + Kik
24895  |                        End If                    ||24469  |                        End If                    
24896  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24470  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24897  |                        .Cells(StartLine + KikanLi||24471  |                        .Cells(StartLine + KikanLi
24898  |                        '計算期間の純資産総額の合 ||24472  |                        '計算期間の純資産総額の合 
24899  |                        .Cells(StartLine + KikanLi||24473  |                        .Cells(StartLine + KikanLi
24900  |                        If gtypOtherComRec(i).APPL||24474  |                        If gtypOtherComRec(i).APPL
24901  |                            .Cells(StartLine + Kik||24475  |                            .Cells(StartLine + Kik
24902  |                        Else                      ||24476  |                        Else                      
24903  |                            .Cells(StartLine + Kik||24477  |                            .Cells(StartLine + Kik
24904  |                        End If                    ||24478  |                        End If                    
24905  |                        .Cells(StartLine + KikanLi||24479  |                        .Cells(StartLine + KikanLi
24906  |                        '計算期間の純資産総額の合 ||24480  |                        '計算期間の純資産総額の合 
24907  |                        .Cells(StartLine + KikanLi||24481  |                        .Cells(StartLine + KikanLi
24908  |                        'NAV区分が '1' の場合（月 ||24482  |                        'NAV区分が '1' の場合（月 
24909  |                        If NavGetFlg = "1" Then   ||24483  |                        If NavGetFlg = "1" Then   
24910  |                            dblValueIn = gtypOther||24484  |                            dblValueIn = gtypOther
24911  |                        '日次の場合               ||24485  |                        '日次の場合               
24912  |                        Else                      ||24486  |                        Else                      
24913  |                            dblValueIn = gtypOther||24487  |                            dblValueIn = gtypOther
24914  |                        End If                    ||24488  |                        End If                    
24915  |                        If gtypOtherComRec(i).APPL||24489  |                        If gtypOtherComRec(i).APPL
24916  |                              Call sbGetRoundValue||24490  |                              Call sbGetRoundValue
24917  |                        Else                      ||24491  |                        Else                      
24918  |                              Call sbGetRoundValue||24492  |                              Call sbGetRoundValue
24919  |                        End If                    ||24493  |                        End If                    
24920  |                        '平均NAV(計算対象NAV)     ||24494  |                        '平均NAV(計算対象NAV)     
24921  |                        If gtypOtherComRec(i).APPL||24495  |                        If gtypOtherComRec(i).APPL
24922  |                            .Cells(StartLine + Kik||24496  |                            .Cells(StartLine + Kik
24923  |                        Else                      ||24497  |                        Else                      
24924  |                            .Cells(StartLine + Kik||24498  |                            .Cells(StartLine + Kik
24925  |                        End If                    ||24499  |                        End If                    
24926  |                        '÷??＝ ,文言             ||24500  |                        '÷??＝ ,文言             
24927  |                        'NAV区分が '1' の場合（月 ||24501  |                        'NAV区分が '1' の場合（月 
24928  |                        If NavGetFlg = "1" Then   ||24502  |                        If NavGetFlg = "1" Then   
24929  |                            .Cells(StartLine + Kik||24503  |                            .Cells(StartLine + Kik
24930  |                        '日次の場合               ||24504  |                        '日次の場合               
24931  |                        Else                      ||24505  |                        Else                      
24932  |                            .Cells(StartLine + Kik||24506  |                            .Cells(StartLine + Kik
24933  |                        End If                    ||24507  |                        End If                    
24934  |                    '年率                         ||24508  |                    '年率                         
24935  |                        .Cells(StartLine + AddLine||24509  |                        .Cells(StartLine + AddLine
24936  |                        .Cells(StartLine + AddLine||24510  |                        .Cells(StartLine + AddLine
24937  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24511  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
24938  |                        '取得NAV区分が4:日次時価総||24512  |                        '取得NAV区分が4:日次時価総
24939  |                        If gbuMGetUPDRec.N(lRecIdx||24513  |                        If gbuMGetUPDRec.N(lRecIdx
24940  |                            .Cells(StartLine + Add||24514  |                            .Cells(StartLine + Add
24941  |                                Format(gtypOtherCo||24515  |                                Format(gtypOtherCo
24942  |                        Else                      ||24516  |                        Else                      
24943  |                            .Cells(StartLine + Add||24517  |                            .Cells(StartLine + Add
24944  |                                Format(gtypOtherCo||24518  |                                Format(gtypOtherCo
24945  |                        End If                    ||24519  |                        End If                    
24946  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24520  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
24947  |                        '年率文言の行数をカウント ||24521  |                        '年率文言の行数をカウント 
24948  |                        RateCnt = RateCnt + 2     ||24522  |                        RateCnt = RateCnt + 2     
24949  |                    Next J                        ||24523  |                    Next J                        
24950  |                    '年率文言の行数にスペース行を ||24524  |                    '年率文言の行数にスペース行を 
24951  |                    RateCnt = RateCnt + FixedLine ||24525  |                    RateCnt = RateCnt + FixedLine 
24952  |                                                  ||24526  |                                                  
24953  |                    '次料率の行数を取得する       ||24527  |                    '次料率の行数を取得する       
24954  |                    '配列の要素の最大値までを取得 ||24528  |                    '配列の要素の最大値までを取得 
24955  |                    If i < UBound(gtypOtherComRec)||24529  |                    If i < UBound(gtypOtherComRec)
24956  |                        For Idx_i = i + 1 To i + 1||24530  |                        For Idx_i = i + 1 To i + 1
24957  |                            For Idx_j = LBound(gty||24531  |                            For Idx_j = LBound(gty
24958  |                                '料率の数を積算   ||24532  |                                '料率の数を積算   
24959  |                                AddRateCnt = AddRa||24533  |                                AddRateCnt = AddRa
24960  |                            Next Idx_j            ||24534  |                            Next Idx_j            
24961  |                            AddRateCnt = AddRateCn||24535  |                            AddRateCnt = AddRateCn
24962  |                        Next Idx_i                ||24536  |                        Next Idx_i                
24963  |                    End If                        ||24537  |                    End If                        
24964  |                                                  ||24538  |                                                  
24965  |                    '行数を計算する               ||24539  |                    '行数を計算する               
24966  |                    GenPage = RateCnt + AddRateCnt||24540  |                    GenPage = RateCnt + AddRateCnt
24967  |                                                  ||24541  |                                                  
24968  |                    AddRateCnt = 0                ||24542  |                    AddRateCnt = 0                
24969  |                                                  ||24543  |                                                  
24970  |                    '行数が溢れたら改ページ       ||24544  |                    '行数が溢れたら改ページ       
24971  |                    If conSheetLastLine < GenPage ||24545  |                    If conSheetLastLine < GenPage 
24972  |                        'ループの開始ポジション変 ||24546  |                        'ループの開始ポジション変 
24973  |                        SetPoint = Add_i          ||24547  |                        SetPoint = Add_i          
24974  |                        Exit For                  ||24548  |                        Exit For                  
24975  |                    End If                        ||24549  |                    End If                        
24976  |                    '次の開始行をセット           ||24550  |                    '次の開始行をセット           
24977  |                    RateCnt = RateCnt + 1         ||24551  |                    RateCnt = RateCnt + 1         
24978  |                    StartLine = RateCnt           ||24552  |                    StartLine = RateCnt           
24979  |                Next i                            ||24553  |                Next i                            
24980  |            '段階料率                             ||24554  |            '段階料率                             
24981  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_o||24555  |            ElseIf gbuMGetUPDRec.N(lRecIdx).MGET_o
24982  |                For i = SetPoint To UBound(gtypOth||24556  |                For i = SetPoint To UBound(gtypOth
24983  |                    'ループ変数のインクリメント変 ||24557  |                    'ループ変数のインクリメント変 
24984  |                    Add_i = Add_i + 1             ||24558  |                    Add_i = Add_i + 1             
24985  |                    TotalRate = 0                 ||24559  |                    TotalRate = 0                 
24986  |                    J_AddCnt = 0                  ||24560  |                    J_AddCnt = 0                  
24987  |                    For J = LBound(gtypOtherComRec||24561  |                    For J = LBound(gtypOtherComRec
24988  |                        If J = 0 Then             ||24562  |                        If J = 0 Then             
24989  |                        '開始行                   ||24563  |                        '開始行                   
24990  |                        '適用期間                 ||24564  |                        '適用期間                 
24991  |                            .Cells(StartLine + J, ||24565  |                            .Cells(StartLine + J, 
24992  |                            .Cells(StartLine + J, ||24566  |                            .Cells(StartLine + J, 
24993  |                            '名称許諾料計算で日次(||24567  |                            '名称許諾料計算で日次(
24994  |                            If Mid(gbuMGetUPDRec.N||24568  |                            If Mid(gbuMGetUPDRec.N
24995  |                            And gbuMGetUPDRec.N(lR||24569  |                            And gbuMGetUPDRec.N(lR
24996  |                                .Cells(StartLine +||24570  |                                .Cells(StartLine +
24997  |                                    CStr(Format(gs||24571  |                                    CStr(Format(gs
24998  |                                    sWord20 & CStr||24572  |                                    sWord20 & CStr
24999  |                                    sWord59 & sWor||24573  |                                    sWord59 & sWor
25000  |                            Else                  ||24574  |                            Else                  
25001  |                                .Cells(StartLine +||24575  |                                .Cells(StartLine +
25002  |                                    CStr(Format(gs||24576  |                                    CStr(Format(gs
25003  |                                    sWord20 & CStr||24577  |                                    sWord20 & CStr
25004  |                                    sWord59 & sWor||24578  |                                    sWord59 & sWor
25005  |                            End If                ||24579  |                            End If                
25006  |                        '平均純資産総額           ||24580  |                        '平均純資産総額           
25007  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24581  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
25008  |                            '取得NAV区分が4:日次時||24582  |                            '取得NAV区分が4:日次時
25009  |                            If gbuMGetUPDRec.N(lRe||24583  |                            If gbuMGetUPDRec.N(lRe
25010  |                                .Cells(StartLine +||24584  |                                .Cells(StartLine +
25011  |                            Else                  ||24585  |                            Else                  
25012  |                                .Cells(StartLine +||24586  |                                .Cells(StartLine +
25013  |                            End If                ||24587  |                            End If                
25014  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24588  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
25015  |                            .Cells(StartLine + Kik||24589  |                            .Cells(StartLine + Kik
25016  |                            '計算期間の純資産総額 ||24590  |                            '計算期間の純資産総額 
25017  |                            .Cells(StartLine + Kik||24591  |                            .Cells(StartLine + Kik
25018  |                            If gtypOtherComRec(i).||24592  |                            If gtypOtherComRec(i).
25019  |                                .Cells(StartLine +||24593  |                                .Cells(StartLine +
25020  |                            Else                  ||24594  |                            Else                  
25021  |                                .Cells(StartLine +||24595  |                                .Cells(StartLine +
25022  |                            End If                ||24596  |                            End If                
25023  |                            .Cells(StartLine + Kik||24597  |                            .Cells(StartLine + Kik
25024  |                            '計算期間の純資産総額 ||24598  |                            '計算期間の純資産総額 
25025  |                            .Cells(StartLine + Kik||24599  |                            .Cells(StartLine + Kik
25026  |                            'NAV区分が '1' の場合 ||24600  |                            'NAV区分が '1' の場合 
25027  |                            If NavGetFlg = "1" The||24601  |                            If NavGetFlg = "1" The
25028  |                                dblValueIn = gtypO||24602  |                                dblValueIn = gtypO
25029  |                            '日次の場合           ||24603  |                            '日次の場合           
25030  |                            Else                  ||24604  |                            Else                  
25031  |                                dblValueIn = gtypO||24605  |                                dblValueIn = gtypO
25032  |                            End If                ||24606  |                            End If                
25033  |                            If gtypOtherComRec(i).||24607  |                            If gtypOtherComRec(i).
25034  |                                  Call sbGetRoundV||24608  |                                  Call sbGetRoundV
25035  |                            Else                  ||24609  |                            Else                  
25036  |                                  Call sbGetRoundV||24610  |                                  Call sbGetRoundV
25037  |                            End If                ||24611  |                            End If                
25038  |                            '平均NAV(計算対象NAV) ||24612  |                            '平均NAV(計算対象NAV) 
25039  |                            If gtypOtherComRec(i).||24613  |                            If gtypOtherComRec(i).
25040  |                                .Cells(StartLine +||24614  |                                .Cells(StartLine +
25041  |                            Else                  ||24615  |                            Else                  
25042  |                                .Cells(StartLine +||24616  |                                .Cells(StartLine +
25043  |                            End If                ||24617  |                            End If                
25044  |                            '÷??＝ ,文言         ||24618  |                            '÷??＝ ,文言         
25045  |                            'NAV区分が '1' の場合 ||24619  |                            'NAV区分が '1' の場合 
25046  |                            If NavGetFlg = "1" The||24620  |                            If NavGetFlg = "1" The
25047  |                                .Cells(StartLine +||24621  |                                .Cells(StartLine +
25048  |                            '日次の場合           ||24622  |                            '日次の場合           
25049  |                            Else                  ||24623  |                            Else                  
25050  |                                .Cells(StartLine +||24624  |                                .Cells(StartLine +
25051  |                            End If                ||24625  |                            End If                
25052  |                        '年率                     ||24626  |                        '年率                     
25053  |                            .Cells(StartLine + Add||24627  |                            .Cells(StartLine + Add
25054  |                            .Cells(StartLine + Add||24628  |                            .Cells(StartLine + Add
25055  |                            Select Case gbuMGetUPD||24629  |                            Select Case gbuMGetUPD
25056  |                                Case cAud         ||24630  |                                Case cAud         
25057  |                                    .Cells(StartLi||24631  |                                    .Cells(StartLi
25058  |                                        sWord26a &||24632  |                                        sWord26a &
25059  |                                        sAuda & sW||24633  |                                        sAuda & sW
25060  |                                Case cCad         ||24634  |                                Case cCad         
25061  |                                    .Cells(StartLi||24635  |                                    .Cells(StartLi
25062  |                                        sWord26a &||24636  |                                        sWord26a &
25063  |                                        sCada & sW||24637  |                                        sCada & sW
25064  |                                Case cChf         ||24638  |                                Case cChf         
25065  |                                    .Cells(StartLi||24639  |                                    .Cells(StartLi
25066  |                                        sWord26a &||24640  |                                        sWord26a &
25067  |                                        sChfa & sW||24641  |                                        sChfa & sW
25068  |                                Case cEur         ||24642  |                                Case cEur         
25069  |                                    .Cells(StartLi||24643  |                                    .Cells(StartLi
25070  |                                        sWord26a &||24644  |                                        sWord26a &
25071  |                                        sEura & sW||24645  |                                        sEura & sW
25072  |                                Case cGbp         ||24646  |                                Case cGbp         
25073  |                                    .Cells(StartLi||24647  |                                    .Cells(StartLi
25074  |                                        sWord26a &||24648  |                                        sWord26a &
25075  |                                        sGbpa & sW||24649  |                                        sGbpa & sW
25076  |                                Case cHkd         ||24650  |                                Case cHkd         
25077  |                                    .Cells(StartLi||24651  |                                    .Cells(StartLi
25078  |                                        sWord26a &||24652  |                                        sWord26a &
25079  |                                        sHkda & sW||24653  |                                        sHkda & sW
25080  |                                Case cJpy         ||24654  |                                Case cJpy         
25081  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24655  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
25082  |                                '取得NAV区分が4:日||24656  |                                '取得NAV区分が4:日
25083  |                                If gbuMGetUPDRec.N||24657  |                                If gbuMGetUPDRec.N
25084  |                                    .Cells(StartLi||24658  |                                    .Cells(StartLi
25085  |                                        sWord26a &||24659  |                                        sWord26a &
25086  |                                        sYena & sW||24660  |                                        sYena & sW
25087  |                                Else              ||24661  |                                Else              
25088  |                                    .Cells(StartLi||24662  |                                    .Cells(StartLi
25089  |                                        sWord26a &||24663  |                                        sWord26a &
25090  |                                        sYena & sW||24664  |                                        sYena & sW
25091  |                                End If            ||24665  |                                End If            
25092  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24666  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
25093  |                                Case cMyr         ||24667  |                                Case cMyr         
25094  |                                    .Cells(StartLi||24668  |                                    .Cells(StartLi
25095  |                                        sWord26a &||24669  |                                        sWord26a &
25096  |                                        sMyra & sW||24670  |                                        sMyra & sW
25097  |                                Case cNzd         ||24671  |                                Case cNzd         
25098  |                                    .Cells(StartLi||24672  |                                    .Cells(StartLi
25099  |                                        sWord26a &||24673  |                                        sWord26a &
25100  |                                        sNzda & sW||24674  |                                        sNzda & sW
25101  |                                Case cSek         ||24675  |                                Case cSek         
25102  |                                    .Cells(StartLi||24676  |                                    .Cells(StartLi
25103  |                                        sWord26a &||24677  |                                        sWord26a &
25104  |                                        sSeka & sW||24678  |                                        sSeka & sW
25105  |                                Case cSgd         ||24679  |                                Case cSgd         
25106  |                                    .Cells(StartLi||24680  |                                    .Cells(StartLi
25107  |                                        sWord26a &||24681  |                                        sWord26a &
25108  |                                        sSgda & sW||24682  |                                        sSgda & sW
25109  |                                Case cUsd         ||24683  |                                Case cUsd         
25110  |                                    .Cells(StartLi||24684  |                                    .Cells(StartLi
25111  |                                        sWord26a &||24685  |                                        sWord26a &
25112  |                                        sUsda & sW||24686  |                                        sUsda & sW
25113  |                                Case cNok         ||24687  |                                Case cNok         
25114  |                                    .Cells(StartLi||24688  |                                    .Cells(StartLi
25115  |                                        sWord26a &||24689  |                                        sWord26a &
25116  |                                        sNoka & sW||24690  |                                        sNoka & sW
25117  |                            End Select            ||24691  |                            End Select            
25118  |                            '年率　累積値セット   ||24692  |                            '年率　累積値セット   
25119  |                            TotalRate = CCur(gtypO||24693  |                            TotalRate = CCur(gtypO
25120  |                                                  ||24694  |                                                  
25121  |                        ElseIf J = UBound(gtypOthe||24695  |                        ElseIf J = UBound(gtypOthe
25122  |                            If UBound(gtypOtherCom||24696  |                            If UBound(gtypOtherCom
25123  |                                '年率最終行       ||24697  |                                '年率最終行       
25124  |                                '前半金額部分     ||24698  |                                '前半金額部分     
25125  |                                .Cells(StartLine +||24699  |                                .Cells(StartLine +
25126  |                                If gbuMGetUPDRec.N||24700  |                                If gbuMGetUPDRec.N
25127  |                                    .Cells(StartLi||24701  |                                    .Cells(StartLi
25128  |                                Else              ||24702  |                                Else              
25129  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24703  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
25130  |                                    '取得NAV区分が||24704  |                                    '取得NAV区分が
25131  |                                    If gbuMGetUPDR||24705  |                                    If gbuMGetUPDR
25132  |                                        .Cells(Sta||24706  |                                        .Cells(Sta
25133  |                                    Else          ||24707  |                                    Else          
25134  |                                        .Cells(Sta||24708  |                                        .Cells(Sta
25135  |                                    End If        ||24709  |                                    End If        
25136  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24710  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
25137  |                                End If            ||24711  |                                End If            
25138  |                                '後半の文言       ||24712  |                                '後半の文言       
25139  |                                .Cells(StartLine +||24713  |                                .Cells(StartLine +
25140  |                                Select Case gbuMGe||24714  |                                Select Case gbuMGe
25141  |                                    Case cAud     ||24715  |                                    Case cAud     
25142  |                                        .Cells(Sta||24716  |                                        .Cells(Sta
25143  |                                            sAuda ||24717  |                                            sAuda 
25144  |                                    Case cCad     ||24718  |                                    Case cCad     
25145  |                                        .Cells(Sta||24719  |                                        .Cells(Sta
25146  |                                            sCada ||24720  |                                            sCada 
25147  |                                    Case cChf     ||24721  |                                    Case cChf     
25148  |                                        .Cells(Sta||24722  |                                        .Cells(Sta
25149  |                                            sChfa ||24723  |                                            sChfa 
25150  |                                    Case cEur     ||24724  |                                    Case cEur     
25151  |                                        .Cells(Sta||24725  |                                        .Cells(Sta
25152  |                                            sEura ||24726  |                                            sEura 
25153  |                                    Case cGbp     ||24727  |                                    Case cGbp     
25154  |                                        .Cells(Sta||24728  |                                        .Cells(Sta
25155  |                                            sGbpa ||24729  |                                            sGbpa 
25156  |                                    Case cHkd     ||24730  |                                    Case cHkd     
25157  |                                        .Cells(Sta||24731  |                                        .Cells(Sta
25158  |                                            sHkda ||24732  |                                            sHkda 
25159  |                                    Case cJpy     ||24733  |                                    Case cJpy     
25160  |                                        .Cells(Sta||24734  |                                        .Cells(Sta
25161  |                                            sYena ||24735  |                                            sYena 
25162  |                                    Case cMyr     ||24736  |                                    Case cMyr     
25163  |                                        .Cells(Sta||24737  |                                        .Cells(Sta
25164  |                                            sMyra ||24738  |                                            sMyra 
25165  |                                    Case cNzd     ||24739  |                                    Case cNzd     
25166  |                                        .Cells(Sta||24740  |                                        .Cells(Sta
25167  |                                            sNzda ||24741  |                                            sNzda 
25168  |                                    Case cSek     ||24742  |                                    Case cSek     
25169  |                                        .Cells(Sta||24743  |                                        .Cells(Sta
25170  |                                            sSeka ||24744  |                                            sSeka 
25171  |                                    Case cSgd     ||24745  |                                    Case cSgd     
25172  |                                        .Cells(Sta||24746  |                                        .Cells(Sta
25173  |                                            sSgda ||24747  |                                            sSgda 
25174  |                                    Case cUsd     ||24748  |                                    Case cUsd     
25175  |                                        .Cells(Sta||24749  |                                        .Cells(Sta
25176  |                                            sUsda ||24750  |                                            sUsda 
25177  |                                    Case cNok     ||24751  |                                    Case cNok     
25178  |                                        .Cells(Sta||24752  |                                        .Cells(Sta
25179  |                                            sNoka ||24753  |                                            sNoka 
25180  |                                End Select        ||24754  |                                End Select        
25181  |                            Else                  ||24755  |                            Else                  
25182  |                                '年率最終行       ||24756  |                                '年率最終行       
25183  |                                '前半金額部分     ||24757  |                                '前半金額部分     
25184  |                                .Cells(StartLine +||24758  |                                .Cells(StartLine +
25185  |                                If gbuMGetUPDRec.N||24759  |                                If gbuMGetUPDRec.N
25186  |                                    .Cells(StartLi||24760  |                                    .Cells(StartLi
25187  |                                Else              ||24761  |                                Else              
25188  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24762  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
25189  |                                    '取得NAV区分が||24763  |                                    '取得NAV区分が
25190  |                                    If gbuMGetUPDR||24764  |                                    If gbuMGetUPDR
25191  |                                        .Cells(Sta||24765  |                                        .Cells(Sta
25192  |                                    Else          ||24766  |                                    Else          
25193  |                                        .Cells(Sta||24767  |                                        .Cells(Sta
25194  |                                    End If        ||24768  |                                    End If        
25195  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24769  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
25196  |                                End If            ||24770  |                                End If            
25197  |                                '後半の文言       ||24771  |                                '後半の文言       
25198  |                                .Cells(StartLine +||24772  |                                .Cells(StartLine +
25199  |                                Select Case gbuMGe||24773  |                                Select Case gbuMGe
25200  |                                    Case cAud     ||24774  |                                    Case cAud     
25201  |                                        .Cells(Sta||24775  |                                        .Cells(Sta
25202  |                                            sAuda ||24776  |                                            sAuda 
25203  |                                    Case cCad     ||24777  |                                    Case cCad     
25204  |                                        .Cells(Sta||24778  |                                        .Cells(Sta
25205  |                                            sCada ||24779  |                                            sCada 
25206  |                                    Case cChf     ||24780  |                                    Case cChf     
25207  |                                        .Cells(Sta||24781  |                                        .Cells(Sta
25208  |                                            sChfa ||24782  |                                            sChfa 
25209  |                                    Case cEur     ||24783  |                                    Case cEur     
25210  |                                        .Cells(Sta||24784  |                                        .Cells(Sta
25211  |                                            sEura ||24785  |                                            sEura 
25212  |                                    Case cGbp     ||24786  |                                    Case cGbp     
25213  |                                        .Cells(Sta||24787  |                                        .Cells(Sta
25214  |                                            sGbpa ||24788  |                                            sGbpa 
25215  |                                    Case cHkd     ||24789  |                                    Case cHkd     
25216  |                                        .Cells(Sta||24790  |                                        .Cells(Sta
25217  |                                            sHkda ||24791  |                                            sHkda 
25218  |                                    Case cJpy     ||24792  |                                    Case cJpy     
25219  |                                        .Cells(Sta||24793  |                                        .Cells(Sta
25220  |                                            sYena ||24794  |                                            sYena 
25221  |                                    Case cMyr     ||24795  |                                    Case cMyr     
25222  |                                        .Cells(Sta||24796  |                                        .Cells(Sta
25223  |                                            sMyra ||24797  |                                            sMyra 
25224  |                                    Case cNzd     ||24798  |                                    Case cNzd     
25225  |                                        .Cells(Sta||24799  |                                        .Cells(Sta
25226  |                                            sNzda ||24800  |                                            sNzda 
25227  |                                    Case cSek     ||24801  |                                    Case cSek     
25228  |                                        .Cells(Sta||24802  |                                        .Cells(Sta
25229  |                                            sSeka ||24803  |                                            sSeka 
25230  |                                    Case cSgd     ||24804  |                                    Case cSgd     
25231  |                                        .Cells(Sta||24805  |                                        .Cells(Sta
25232  |                                            sSgda ||24806  |                                            sSgda 
25233  |                                    Case cUsd     ||24807  |                                    Case cUsd     
25234  |                                        .Cells(Sta||24808  |                                        .Cells(Sta
25235  |                                            sUsda ||24809  |                                            sUsda 
25236  |                                    Case cNok     ||24810  |                                    Case cNok     
25237  |                                        .Cells(Sta||24811  |                                        .Cells(Sta
25238  |                                            sNoka ||24812  |                                            sNoka 
25239  |                                End Select        ||24813  |                                End Select        
25240  |                            End If                ||24814  |                            End If                
25241  |                        Else                      ||24815  |                        Else                      
25242  |                            '年率2行目以降        ||24816  |                            '年率2行目以降        
25243  |                            '前半金額部分         ||24817  |                            '前半金額部分         
25244  |                            .Cells(StartLine + Add||24818  |                            .Cells(StartLine + Add
25245  |                            If gbuMGetUPDRec.N(lRe||24819  |                            If gbuMGetUPDRec.N(lRe
25246  |                                .Cells(StartLine +||24820  |                                .Cells(StartLine +
25247  |                                    sWord28a & CSt||24821  |                                    sWord28a & CSt
25248  |                            Else                  ||24822  |                            Else                  
25249  |'2008/02/20 START 時価総額基準の外部委託顧問料対応||24823  |'2008/02/20 START 時価総額基準の外部委託顧問料対応
25250  |                                '取得NAV区分が4:日||24824  |                                '取得NAV区分が4:日
25251  |                                If gbuMGetUPDRec.N||24825  |                                If gbuMGetUPDRec.N
25252  |                                    .Cells(StartLi||24826  |                                    .Cells(StartLi
25253  |                                        sWord66a &||24827  |                                        sWord66a &
25254  |                                Else              ||24828  |                                Else              
25255  |                                    .Cells(StartLi||24829  |                                    .Cells(StartLi
25256  |                                        sWord28a &||24830  |                                        sWord28a &
25257  |                                End If            ||24831  |                                End If            
25258  |'2008/02/20 END   時価総額基準の外部委託顧問料対応||24832  |'2008/02/20 END   時価総額基準の外部委託顧問料対応
25259  |                            End If                ||24833  |                            End If                
25260  |                            '年率　累積値セット   ||24834  |                            '年率　累積値セット   
25261  |                            TotalRate = TotalRate ||24835  |                            TotalRate = TotalRate 
25262  |                            '後半の文言           ||24836  |                            '後半の文言           
25263  |                            .Cells(StartLine + Add||24837  |                            .Cells(StartLine + Add
25264  |                            Select Case gbuMGetUPD||24838  |                            Select Case gbuMGetUPD
25265  |                                Case cAud         ||24839  |                                Case cAud         
25266  |                                    .Cells(StartLi||24840  |                                    .Cells(StartLi
25267  |                                        sAuda & sW||24841  |                                        sAuda & sW
25268  |                                        Format(gty||24842  |                                        Format(gty
25269  |                                Case cCad         ||24843  |                                Case cCad         
25270  |                                    .Cells(StartLi||24844  |                                    .Cells(StartLi
25271  |                                        sCada & sW||24845  |                                        sCada & sW
25272  |                                        Format(gty||24846  |                                        Format(gty
25273  |                                Case cChf         ||24847  |                                Case cChf         
25274  |                                    .Cells(StartLi||24848  |                                    .Cells(StartLi
25275  |                                        sChfa & sW||24849  |                                        sChfa & sW
25276  |                                        Format(gty||24850  |                                        Format(gty
25277  |                                Case cEur         ||24851  |                                Case cEur         
25278  |                                    .Cells(StartLi||24852  |                                    .Cells(StartLi
25279  |                                        sEura & sW||24853  |                                        sEura & sW
25280  |                                        Format(gty||24854  |                                        Format(gty
25281  |                                Case cGbp         ||24855  |                                Case cGbp         
25282  |                                    .Cells(StartLi||24856  |                                    .Cells(StartLi
25283  |                                        sGbpa & sW||24857  |                                        sGbpa & sW
25284  |                                        Format(gty||24858  |                                        Format(gty
25285  |                                Case cHkd         ||24859  |                                Case cHkd         
25286  |                                    .Cells(StartLi||24860  |                                    .Cells(StartLi
25287  |                                        sHkda & sW||24861  |                                        sHkda & sW
25288  |                                        Format(gty||24862  |                                        Format(gty
25289  |                                Case cJpy         ||24863  |                                Case cJpy         
25290  |                                    .Cells(StartLi||24864  |                                    .Cells(StartLi
25291  |                                        sYena & sW||24865  |                                        sYena & sW
25292  |                                        Format(gty||24866  |                                        Format(gty
25293  |                                Case cMyr         ||24867  |                                Case cMyr         
25294  |                                    .Cells(StartLi||24868  |                                    .Cells(StartLi
25295  |                                        sMyra & sW||24869  |                                        sMyra & sW
25296  |                                        Format(gty||24870  |                                        Format(gty
25297  |                                Case cNzd         ||24871  |                                Case cNzd         
25298  |                                    .Cells(StartLi||24872  |                                    .Cells(StartLi
25299  |                                        sNzda & sW||24873  |                                        sNzda & sW
25300  |                                        Format(gty||24874  |                                        Format(gty
25301  |                                Case cSek         ||24875  |                                Case cSek         
25302  |                                    .Cells(StartLi||24876  |                                    .Cells(StartLi
25303  |                                        sSeka & sW||24877  |                                        sSeka & sW
25304  |                                        Format(gty||24878  |                                        Format(gty
25305  |                                Case cSgd         ||24879  |                                Case cSgd         
25306  |                                    .Cells(StartLi||24880  |                                    .Cells(StartLi
25307  |                                        sSgda & sW||24881  |                                        sSgda & sW
25308  |                                        Format(gty||24882  |                                        Format(gty
25309  |                                Case cUsd         ||24883  |                                Case cUsd         
25310  |                                    .Cells(StartLi||24884  |                                    .Cells(StartLi
25311  |                                        sUsda & sW||24885  |                                        sUsda & sW
25312  |                                        Format(gty||24886  |                                        Format(gty
25313  |                                Case cNok         ||24887  |                                Case cNok         
25314  |                                    .Cells(StartLi||24888  |                                    .Cells(StartLi
25315  |                                        sNoka & sW||24889  |                                        sNoka & sW
25316  |                                        Format(gty||24890  |                                        Format(gty
25317  |                            End Select            ||24891  |                            End Select            
25318  |                        End If                    ||24892  |                        End If                    
25319  |                        '年率文言の行数をカウント ||24893  |                        '年率文言の行数をカウント 
25320  |                        J_AddCnt = J_AddCnt + 1   ||24894  |                        J_AddCnt = J_AddCnt + 1   
25321  |                    Next J                        ||24895  |                    Next J                        
25322  |                    '年率文言の行数にスペース行を ||24896  |                    '年率文言の行数にスペース行を 
25323  |                    RateCnt = RateCnt + KikanLine ||24897  |                    RateCnt = RateCnt + KikanLine 
25324  |                                                  ||24898  |                                                  
25325  |                    '次料率の行数を取得する       ||24899  |                    '次料率の行数を取得する       
25326  |                    '配列の要素の最大値までを取得 ||24900  |                    '配列の要素の最大値までを取得 
25327  |                    If i < UBound(gtypOtherComRec)||24901  |                    If i < UBound(gtypOtherComRec)
25328  |                        For Idx_i = i + 1 To i + 1||24902  |                        For Idx_i = i + 1 To i + 1
25329  |                            '料率カウント変数を初 ||24903  |                            '料率カウント変数を初 
25330  |                            J_Cnt = 0             ||24904  |                            J_Cnt = 0             
25331  |                            For Idx_j = LBound(gty||24905  |                            For Idx_j = LBound(gty
25332  |                                '料率の数を積算   ||24906  |                                '料率の数を積算   
25333  |                                J_Cnt = J_Cnt + 1 ||24907  |                                J_Cnt = J_Cnt + 1 
25334  |                            Next Idx_j            ||24908  |                            Next Idx_j            
25335  |                            AddRateCnt = (((J_Cnt ||24909  |                            AddRateCnt = (((J_Cnt 
25336  |                        Next Idx_i                ||24910  |                        Next Idx_i                
25337  |                    End If                        ||24911  |                    End If                        
25338  |                                                  ||24912  |                                                  
25339  |                    '行数を計算する               ||24913  |                    '行数を計算する               
25340  |                    GenPage = RateCnt + AddRateCnt||24914  |                    GenPage = RateCnt + AddRateCnt
25341  |                                                  ||24915  |                                                  
25342  |                    AddRateCnt = 0                ||24916  |                    AddRateCnt = 0                
25343  |                                                  ||24917  |                                                  
25344  |                    '行数が溢れたら改ページ       ||24918  |                    '行数が溢れたら改ページ       
25345  |                    If conSheetLastLine < GenPage ||24919  |                    If conSheetLastLine < GenPage 
25346  |                        'ループの開始ポジション変 ||24920  |                        'ループの開始ポジション変 
25347  |                        SetPoint = Add_i          ||24921  |                        SetPoint = Add_i          
25348  |                        Exit For                  ||24922  |                        Exit For                  
25349  |                    End If                        ||24923  |                    End If                        
25350  |                    '次の開始行をセット           ||24924  |                    '次の開始行をセット           
25351  |                    RateCnt = RateCnt + 1         ||24925  |                    RateCnt = RateCnt + 1         
25352  |                    StartLine = RateCnt           ||24926  |                    StartLine = RateCnt           
25353  |                Next i                            ||24927  |                Next i                            
25354  |            End If                                ||24928  |            End If                                
25355  |                                                  ||24929  |                                                  
25356  |        End With                                  ||24930  |        End With                                  
25357  |        'A4印刷用に上2行を削除して、プレビュー範囲||24931  |        'A4印刷用に上2行を削除して、プレビュー範囲
25358  |        xlSheet.Rows("1:2").Delete Shift:=xlUp    ||24932  |        xlSheet.Rows("1:2").Delete Shift:=xlUp    
25359  |    Next PgIndx                                   ||24933  |    Next PgIndx                                   
25360  |                                                  ||24934  |                                                  
25361  |End Sub                                           ||24935  |End Sub                                           
25362 L|                                                  ||       |                                                  
25363 L|'=================================================||       |                                                  
25364 L|'ﾌﾟﾛｼｰｼﾞｬ名称    :   Tax_calc                     ||       |                                                  
25365 L|'機能            :   算出方法の判別処理           ||       |                                                  
25366 L|'                                                 ||       |                                                  
25367 L|'日付               担当                修正内容  ||       |                                                  
25368 L|'-------------------------------------------------||       |                                                  
25369 L|'2014/02/19         M.Takada<SRA>       新規作成  ||       |                                                  
25370 L|'=================================================||       |                                                  
25371 L|Public Function Tax_calc(ByVal sStart As Date, ByV||       |                                                  
25372 L|                                                  ||       |                                                  
25373 L|    Dim s_Sql       As String           'SQL格納変||       |                                                  
25374 L|    Dim strUse_Date As String           '最新の適 ||       |                                                  
25375 L|                                                  ||       |                                                  
25376 L|    '初期化                                       ||       |                                                  
25377 L|    intCount = 1                                  ||       |                                                  
25378 L|    Tax_Flg = False                               ||       |                                                  
25379 L|                                                  ||       |                                                  
25380 L|                                                  ||       |                                                  
25381 L|    '配列初期化                                   ||       |                                                  
25382 L|    ReDim strTaxRate(2) '税率の格納配列           ||       |                                                  
25383 L|    ReDim strTaxNum(2)  '消費税額の格納配列       ||       |                                                  
25384 L|    ReDim intDays(2)    '計算期間の格納配列       ||       |                                                  
25385 L|                                                  ||       |                                                  
25386 L|    'SQL分の作成(税率TBLから格納されている税率を取||       |                                                  
25387 L|    s_Sql = ""                                    ||       |                                                  
25388 L|    s_Sql = s_Sql & " SELECT Max(use_date) AS use_||       |                                                  
25389 L|    s_Sql = s_Sql & " FROM cfr_tax_tbl "          ||       |                                                  
25390 L|    s_Sql = s_Sql & " WHERE use_date <= sEnd "    ||       |                                                  
25391 L|                                                  ||       |                                                  
25392 L|    'ﾀﾞｲﾅｾｯﾄの作成                                ||01764 M|    'ﾀﾞｲﾅｾｯﾄの作成                                
25393 L|    If (gintDyCreate(s_Sql) = False) Then         ||       |                                                  
25394 L|        Call subError("DBエラー", Str(9999), "gint||01766 M|        Call subError("DBエラー", Str(9999), "gint
25395 L|            "DB関数エラー", strErrCall, conTitle) ||01767 M|            "DB関数エラー", strErrCall, conTitle) 
25396 L|        Exit Function                             ||01768 M|        Exit Function                             
25397 L|    End If                                        ||01769 M|    End If                                        
25398 L|                                                  ||       |                                                  
25399 L|    '最新の適用開始日を変数に格納                 ||       |                                                  
25400 L|    strUse_Date = gvlnDyDataN("use_date")         ||       |                                                  
25401 L|                                                  ||       |                                                  
25402 L|    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             ||       |                                                  
25403 L|    Call gblnDyClose                              ||       |                                                  
25404 L|                                                  ||       |                                                  
25405 L|    '計算期間の取得                               ||       |                                                  
25406 L|    If (sStart < strUse_Date) And (sEnd >= strUse_||       |                                                  
25407 L|        '計算期間が税率変更を跨ぐ場合             ||       |                                                  
25408 L|        intCount = 1                              ||       |                                                  
25409 L|        '税率分割フラグをTrueにする               ||       |                                                  
25410 L|        Tax_Flg = True                            ||       |                                                  
25411 L|                                                  ||       |                                                  
25412 L|        '適用開始日以降の算出                     ||       |                                                  
25413 L|        Call Tax_Change_After(sStart, sEnd)       ||       |                                                  
25414 L|                                                  ||       |                                                  
25415 L|        '配列カウンターの加算                     ||       |                                                  
25416 L|        intCount = intCount + 1                   ||       |                                                  
25417 L|                                                  ||       |                                                  
25418 L|        '適用開始日以前の算出                     ||       |                                                  
25419 L|        Call Tax_Change_Before(sStart, sEnd)      ||       |                                                  
25420 L|                                                  ||       |                                                  
25421 L|                                                  ||       |                                                  
25422 L|    ElseIf (sEnd < strUse_Date) Then              ||       |                                                  
25423 L|        '計算期間が税率変更前のみの場合           ||       |                                                  
25424 L|        intCount = 2                              ||       |                                                  
25425 L|        Call Tax_Change_Before(sStart, sEnd)      ||       |                                                  
25426 L|        Tax_Flg = False                           ||       |                                                  
25427 L|    Else                                          ||       |                                                  
25428 L|        '計算期間が税率変更後のみの場合           ||       |                                                  
25429 L|        intCount = 1                              ||       |                                                  
25430 L|        Call Tax_Change_After(sStart, sEnd)       ||       |                                                  
25431 L|        Tax_Flg = False                           ||       |                                                  
25432 L|    End If                                        ||       |                                                  
25433 L|End Function                                      ||       |                                                  
25434 L|                                                  ||       |                                                  
25435 L|'=================================================||       |                                                  
25436 L|'ﾌﾟﾛｼｰｼﾞｬ名称    :   Tax_Change_Before            ||       |                                                  
25437 L|'機能            :   (税率変更前)計算日数・税率・ ||       |                                                  
25438 L|'                                                 ||       |                                                  
25439 L|'日付               担当　              修正内容  ||       |                                                  
25440 L|'-------------------------------------------------||       |                                                  
25441 L|'2014/02/19         M.Takada<SRA>        新規作成 ||       |                                                  
25442 L|'=================================================||       |                                                  
25443 L|Public Function Tax_Change_Before(ByVal sStart As ||       |                                                  
25444 L|                                                  ||       |                                                  
25445 L|    ReDim intDays(intCount)                       ||       |                                                  
25446 L|    ReDim strTaxRate(intCount)                    ||       |                                                  
25447 L|    ReDim strTaxNum(intCount)                     ||       |                                                  
25448 L|                                                  ||       |                                                  
25449 L|     '計算開始日〜変更前までの計算日数･税率･消費税||       |                                                  
25450 L|     intDays(intCount) = DateDiff("d", (strUse_Dat||       |                                                  
25451 L|                                                  ||       |                                                  
25452 L|     '税率の取得SQLの作成                         ||       |                                                  
25453 L|     s_Sql = ""                                   ||       |                                                  
25454 L|     s_Sql = s_Sql & " SELECT tax_rate "          ||       |                                                  
25455 L|     s_Sql = s_Sql & " FROM cfr_tax_tbl "         ||       |                                                  
25456 L|     s_Sql = s_Sql & " WHERE use_date Between '" &||       |                                                  
25457 L|                                                  ||       |                                                  
25458 L|     'ﾀﾞｲﾅｾｯﾄの作成                               ||       |                                                  
25459 L|     If (gintDyCreate(s_Sql) = False) Then        ||       |                                                  
25460 L|         Call subError("DBエラー", Str(9999), "gin||       |                                                  
25461 L|             "DB関数エラー", strErrCall, conTitle)||       |                                                  
25462 L|         Exit Function                            ||       |                                                  
25463 L|     End If                                       ||       |                                                  
25464 L|                                                  ||       |                                                  
25465 L|     '税率格納                                    ||       |                                                  
25466 L|     strTaxRate(intCount) = gvlnDyDataN("tax_rate"||       |                                                  
25467 L|                                                  ||       |                                                  
25468 L|     '支払額                                      ||       |                                                  
25469 L|        If Tax_Flg = True Then                    ||       |                                                  
25470 L|            '計算開始日〜適用開始日(前日)までの支 ||       |                                                  
25471 L|            '算出方法：投資顧問料*(計算開始日〜適 ||       |                                                  
25472 L|            strChgPay = (mstrMonthlyPayCom * (Date||       |                                                  
25473 L|            '算出した値に小数点が存在するか検索し ||       |                                                  
25474 L|            strPayNum(intCount) = Left(strChgPay, ||       |                                                  
25475 L|        Else                                      ||       |                                                  
25476 L|            '消費税率の変更無しの場合、投資顧問料 ||       |                                                  
25477 L|            strPayNum(intCount) = mstrMonthlyPayCo||       |                                                  
25478 L|        End If                                    ||       |                                                  
25479 L|                                                  ||       |                                                  
25480 L|     '税額算出                                    ||       |                                                  
25481 L|     strTaxNum(intCount) = Left((strPayNum(intCoun||       |                                                  
25482 L|                                                  ||       |                                                  
25483 L|    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             ||       |                                                  
25484 L|     Call gblnDyClose                             ||       |                                                  
25485 L|End Function                                      ||       |                                                  
25486 L|                                                  ||       |                                                  
25487 L|                                                  ||       |                                                  
25488 L|'=================================================||       |                                                  
25489 L|'ﾌﾟﾛｼｰｼﾞｬ名称    :   Tax_Change_After             ||       |                                                  
25490 L|'機能            :   (税率変更後)計算日数・税率・ ||       |                                                  
25491 L|'                                                 ||       |                                                  
25492 L|'日付               担当　              修正内容  ||       |                                                  
25493 L|'-------------------------------------------------||       |                                                  
25494 L|'2014/02/19         M.Takada<SRA>        新規作成 ||       |                                                  
25495 L|'=================================================||       |                                                  
25496 L|Public Function Tax_Change_After(ByVal sStart As D||       |                                                  
25497 L|                                                  ||       |                                                  
25498 L|    ReDim intDays(intCount)                       ||       |                                                  
25499 L|    ReDim strPayNum(intCount)                     ||       |                                                  
25500 L|    ReDim strTaxRate(intCount)                    ||       |                                                  
25501 L|    ReDim strTaxNum(intCount)                     ||       |                                                  
25502 L|                                                  ||       |                                                  
25503 L|     '変更後〜計算終了日までの計算日数･税率･消費税||       |                                                  
25504 L|     intDays(intCount) = DateDiff("d", strUse_Date||       |                                                  
25505 L|                                                  ||       |                                                  
25506 L|     '税率の取得SQLの作成                         ||       |                                                  
25507 L|     s_Sql = ""                                   ||       |                                                  
25508 L|     s_Sql = s_Sql & " SELECT tax_rate "          ||       |                                                  
25509 L|     s_Sql = s_Sql & " FROM cfr_tax_tbl "         ||       |                                                  
25510 L|     s_Sql = s_Sql & " WHERE use_date = '" & strUs||       |                                                  
25511 L|                                                  ||       |                                                  
25512 L|     'ﾀﾞｲﾅｾｯﾄの作成                               ||       |                                                  
25513 L|     If (gintDyCreate(s_Sql) = False) Then        ||       |                                                  
25514 L|         Call subError("DBエラー", Str(9999), "gin||       |                                                  
25515 L|             "DB関数エラー", strErrCall, conTitle)||       |                                                  
25516 L|         Exit Function                            ||       |                                                  
25517 L|     End If                                       ||       |                                                  
25518 L|                                                  ||       |                                                  
25519 L|     '税率格納                                    ||       |                                                  
25520 L|     strTaxRate(intCount) = gvlnDyDataN("tax_rate"||       |                                                  
25521 L|                                                  ||       |                                                  
25522 L|     '支払額                                      ||       |                                                  
25523 L|        If Tax_Flg = True Then                    ||       |                                                  
25524 L|            '適用開始日〜計算終了日までの支払額   ||       |                                                  
25525 L|            '算出方法：投資顧問料*(適用開始日〜計 ||       |                                                  
25526 L|            strChgPay = (mstrMonthlyPayCom * (Date||       |                                                  
25527 L|            '算出した支払額に小数以下がある場合、 ||       |                                                  
25528 L|            If InStr(1, strChgPay, ".") <> 0 Then ||       |                                                  
25529 L|                strPayNum(intCount) = Left(strChgP||       |                                                  
25530 L|            Else                                  ||       |                                                  
25531 L|            End If                                ||       |                                                  
25532 L|        Else                                      ||       |                                                  
25533 L|            '消費税率の変更無しの場合、投資顧問料 ||       |                                                  
25534 L|            strPayNum(intCount) = mstrMonthlyPayCo||       |                                                  
25535 L|        End If                                    ||       |                                                  
25536 L|                                                  ||       |                                                  
25537 L|     '税額算出(小数以下がある場合、小数部を切り捨 ||       |                                                  
25538 L|     strTaxNum(intCount) = Left((strPayNum(intCoun||       |                                                  
25539 L|                                                  ||       |                                                  
25540 L|    'ﾀﾞｲﾅｾｯﾄｸﾛｰｽﾞ処理                             ||       |                                                  
25541 L|     Call gblnDyClose                             ||       |                                                  
25542 L|                                                  ||       |                                                  
25543 L|End Function                                      ||       |                                                  
25544 L|                                                  ||       |                                                  
