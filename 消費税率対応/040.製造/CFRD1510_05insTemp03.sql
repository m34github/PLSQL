/*******************************************************************************
*
* プロジェクト : NAM顧問料デイリー算出システム
* 機能名       : 日次SS用外部委託未払計上額接続ファイル作成
*                バッチ(CFRD1510.csh)用SQL
*                SS用中間テーブル3 INSERT_SQL
* ファイル名   : CFRD1510_05insTemp03.sql
* 置換変数     : なし
*
* 作成日       : 2014/02/17
* 作成者       : GUT高
*******************************************************************************/
INSERT INTO CFR_TMP_SS03_TBL
SELECT
        SHZIN.KUGIRI_1 KUGIRI_1,
        SHZIN.KAI_CODE KAI_CODE,
        SHZIN.IN_SYS_CODE IN_SYS_CODE,
        SHZIN.IN_SYS_DATE IN_SYS_DATE,
        SHZIN.IN_SYS_DATA_NO IN_SYS_DATA_NO,
        CART1.SS_SWK_ID SWK_ID,
        SHZIN.KESSAN_KBN KESSAN_KBN,
        SHZIN.IN_USR_ID IN_USR_ID,
        SHZIN.DEN_NO DEN_NO,
        SHZIN.GYO_NO GYO_NO,
        SHZIN.DR_KMK_CODE DR_KMK_CODE,
        SHZIN.DR_HKM_CODE DR_HKM_CODE,
        SHZIN.DR_BMN_CODE DR_BMN_CODE,
        SHZIN.DR_CODE1 DR_CODE1,
        SHZIN.DR_CODE2 DR_CODE2,
        SHZIN.DR_CODE3 DR_CODE3,
        CART1.SS_R_CODE4 DR_CODE4,
        SHZIN.DR_KIN DR_KIN,
        SHZIN.DR_CUR_CODE DR_CUR_CODE,
        SHZIN.DR_CRT_RATE_TYPE DR_CRT_RATE_TYPE,
        SHZIN.DR_CRT_RATE DR_CRT_RATE,
        SHZIN.DR_CUR_KIN DR_CUR_KIN,
        SHZIN.DR_ZEI_CODE DR_ZEI_CODE,
        SHZIN.DR_ZEI_KBN DR_ZEI_KBN,
        0 DR_ZEI_KIN,
        SHZIN.DR_TEKIYO1 DR_TEKIYO1,
        SHZIN.DR_TEKIYO2 DR_TEKIYO2,
        SHZIN.DR_TORI_KBN DR_TORI_KBN,
        SHZIN.DR_TORI_CODE DR_TORI_CODE,
        SHZIN.CR_KMK_CODE CR_KMK_CODE,
        SHZIN.CR_HKM_CODE CR_HKM_CODE,
        SHZIN.CR_BMN_CODE CR_BMN_CODE,
        SHZIN.CR_CODE1 CR_CODE1,
        SHZIN.CR_CODE2 CR_CODE2,
        SHZIN.CR_CODE3 CR_CODE3,
        CART1.SS_R_CODE4 CR_CODE4,
        SHZIN.CR_KIN CR_KIN,
        SHZIN.CR_CUR_CODE CR_CUR_CODE,
        SHZIN.CR_CRT_RATE_TYPE CR_CRT_RATE_TYPE,
        SHZIN.CR_CRT_RATE CR_CRT_RATE,
        SHZIN.CR_CUR_KIN CR_CUR_KIN,
        SHZIN.CR_ZEI_CODE CR_ZEI_CODE,
        SHZIN.CR_ZEI_KBN CR_ZEI_KBN,
        0 CR_ZEI_KIN,
        SHZIN.CR_TEKIYO1 CR_TEKIYO1,
        SHZIN.CR_TEKIYO2 CR_TEKIYO2,
        SHZIN.CR_TORI_KBN CR_TORI_KBN,
        SHZIN.CR_TORI_CODE CR_TORI_CODE,
        SHZIN.SWK_JYO1 SWK_JYO1,
        SHZIN.SWK_JYO2 SWK_JYO2,
        SHZIN.SWK_JYO3 SWK_JYO3,
        SHZIN.SWK_JYO4 SWK_JYO4,
        SHZIN.SWK_JYO5 SWK_JYO5,
        SHZIN.KAIKEI_KOUMOKU1 KAIKEI_KOUMOKU1,
        SHZIN.KAIKEI_KOUMOKU2 KAIKEI_KOUMOKU2,
        SHZIN.KAIKEI_KOUMOKU3 KAIKEI_KOUMOKU3,
        SHZIN.KAIKEI_KOUMOKU4 KAIKEI_KOUMOKU4,
        SHZIN.KAIKEI_KOUMOKU5 KAIKEI_KOUMOKU5,
        SHZIN.KANRI_COMMENT1 KANRI_COMMENT1,
        SHZIN.KANRI_COMMENT2 KANRI_COMMENT2,
        SHZIN.KANRI_COMMENT3 KANRI_COMMENT3,
        SHZIN.KANRI_COMMENT4 KANRI_COMMENT4,
        SHZIN.KANRI_COMMENT5 KANRI_COMMENT5,
        SHZIN.KANRI_COMMENT6 KANRI_COMMENT6,
        SHZIN.KANRI_COMMENT7 KANRI_COMMENT7,
        SHZIN.KANRI_COMMENT8 KANRI_COMMENT8,
        SHZIN.KANRI_COMMENT9 KANRI_COMMENT9,
        SHZIN.KANRI_COMMENT10 KANRI_COMMENT10,
        SHZIN.AUS_FLG_01 AUS_FLG_01,
        SHZIN.AU_USR_ID_01 AU_USR_ID_01,
        SHZIN.AUS_DATE_01 AUS_DATE_01,
        SHZIN.AUS_FLG_02 AUS_FLG_02,
        SHZIN.AU_USR_ID_02 AU_USR_ID_02,
        SHZIN.AUS_DATE_02 AUS_DATE_02,
        SHZIN.SYO_FLG SYO_FLG,
        SHZIN.KUGIRI_2 KUGIRI_2,
        SHZIN.ZEN_BASE_MONTH ZEN_BASE_MONTH,
        SHZIN.ZEN_SETTLEMENT_DATE ZEN_SETTLEMENT_DATE,
        SHZIN.KUGIRI_3 KUGIRI_3,
        SHZIN.J_CONTRACT_NO J_CONTRACT_NO,
        SHZIN.J_BASE_MONTH J_BASE_MONTH,
        SHZIN.J_CURRENCY_CODE J_CURRENCY_CODE,
        SHZIN.J_ASSET_TYPE_CODE J_ASSET_TYPE_CODE,
        SHZIN.J_SETTLEMENT_DATE J_SETTLEMENT_DATE,
        SHZIN.J_FIX_COM_FLAG J_FIX_COM_FLAG,
        SHZIN.J_FIX_COM_J J_FIX_COM_J,
        SHZIN.KUGIRI_4 KUGIRI_4,
        SHZIN.K_CONTRACT_NO K_CONTRACT_NO,
        SHZIN.K_INSERT_DATE K_INSERT_DATE,
        SHZIN.K_CONTRACT_FLAG K_CONTRACT_FLAG,
        SHZIN.K_COMPANY_CODE K_COMPANY_CODE,
        SHZIN.K_COM_CALC_START K_COM_CALC_START,
        SHZIN.K_TAX_CALC_FLAG K_TAX_CALC_FLAG,
        SHZIN.K_ADV_LEAVE_FLAG K_ADV_LEAVE_FLAG,
        SHZIN.K_INVALID_FLAG K_INVALID_FLAG,
        SHZIN.K_ASSET_CODE K_ASSET_CODE,
        SHZIN.KUGIRI_5 KUGIRI_5,
        SHZIN.S_ITEM_FLAG S_ITEM_FLAG,
        SHZIN.S_USE_DATE S_USE_DATE,
        SHZIN.S_TAX_RATE S_TAX_RATE,
        SHZIN.S_ITEM_FLAG_P S_ITEM_FLAG_P,
        SHZIN.S_USE_DATE_P S_USE_DATE_P,
        SHZIN.S_TAX_RATE_P S_TAX_RATE_P,
        SHZIN.KUGIRI_6 KUGIRI_6,
        SYSDATE LAST_UPDATETIME,
        'CFRD1510' LAST_UPDATE_ID
FROM
CFR_TMP_SS01_TBL SHZIN,CFR_ASSET_REFARENCE_TBL CART1
WHERE
    SHZIN.K_TAX_CALC_FLAG = '0'
AND CART1.TAX_CALC_FLAG = '0'
AND SHZIN.K_ASSET_CODE = CART1.ASSET_CODE
UNION
SELECT
        BNKTN.KUGIRI_1 KUGIRI_1,
        BNKTN.KAI_CODE KAI_CODE,
        BNKTN.IN_SYS_CODE IN_SYS_CODE,
        BNKTN.IN_SYS_DATE IN_SYS_DATE,
        BNKTN.IN_SYS_DATA_NO IN_SYS_DATA_NO,
        CART2.SS_SWK_ID SWK_ID,
        BNKTN.KESSAN_KBN KESSAN_KBN,
        BNKTN.IN_USR_ID IN_USR_ID,
        BNKTN.DEN_NO DEN_NO,
        BNKTN.GYO_NO GYO_NO,
        BNKTN.DR_KMK_CODE DR_KMK_CODE,
        BNKTN.DR_HKM_CODE DR_HKM_CODE,
        BNKTN.DR_BMN_CODE DR_BMN_CODE,
        BNKTN.DR_CODE1 DR_CODE1,
        BNKTN.DR_CODE2 DR_CODE2,
        BNKTN.DR_CODE3 DR_CODE3,
        CART2.SS_R_CODE4 DR_CODE4,
        BNKTN.DR_KIN DR_KIN,
        BNKTN.DR_CUR_CODE DR_CUR_CODE,
        BNKTN.DR_CRT_RATE_TYPE DR_CRT_RATE_TYPE,
        BNKTN.DR_CRT_RATE DR_CRT_RATE,
        BNKTN.DR_CUR_KIN DR_CUR_KIN,
        BNKTN.DR_ZEI_CODE DR_ZEI_CODE,
        BNKTN.DR_ZEI_KBN DR_ZEI_KBN,
        TRUNC(BNKTN.J_FIX_COM_J * BNKTN.S_TAX_RATE / 100 , 0) DR_ZEI_KIN,
        BNKTN.DR_TEKIYO1 DR_TEKIYO1,
        BNKTN.DR_TEKIYO2 DR_TEKIYO2,
        BNKTN.DR_TORI_KBN DR_TORI_KBN,
        BNKTN.DR_TORI_CODE DR_TORI_CODE,
        BNKTN.CR_KMK_CODE CR_KMK_CODE,
        BNKTN.CR_HKM_CODE CR_HKM_CODE,
        BNKTN.CR_BMN_CODE CR_BMN_CODE,
        BNKTN.CR_CODE1 CR_CODE1,
        BNKTN.CR_CODE2 CR_CODE2,
        BNKTN.CR_CODE3 CR_CODE3,
        CART2.SS_R_CODE4 CR_CODE4,
        BNKTN.CR_KIN CR_KIN,
        BNKTN.CR_CUR_CODE CR_CUR_CODE,
        BNKTN.CR_CRT_RATE_TYPE CR_CRT_RATE_TYPE,
        BNKTN.CR_CRT_RATE CR_CRT_RATE,
        BNKTN.CR_CUR_KIN CR_CUR_KIN,
        BNKTN.CR_ZEI_CODE CR_ZEI_CODE,
        BNKTN.CR_ZEI_KBN CR_ZEI_KBN,
        TRUNC(BNKTN.J_FIX_COM_J * BNKTN.S_TAX_RATE / 100 , 0) CR_ZEI_KIN,
        BNKTN.CR_TEKIYO1 CR_TEKIYO1,
        BNKTN.CR_TEKIYO2 CR_TEKIYO2,
        BNKTN.CR_TORI_KBN CR_TORI_KBN,
        BNKTN.CR_TORI_CODE CR_TORI_CODE,
        BNKTN.SWK_JYO1 SWK_JYO1,
        BNKTN.SWK_JYO2 SWK_JYO2,
        BNKTN.SWK_JYO3 SWK_JYO3,
        BNKTN.SWK_JYO4 SWK_JYO4,
        BNKTN.SWK_JYO5 SWK_JYO5,
        BNKTN.KAIKEI_KOUMOKU1 KAIKEI_KOUMOKU1,
        BNKTN.KAIKEI_KOUMOKU2 KAIKEI_KOUMOKU2,
        BNKTN.KAIKEI_KOUMOKU3 KAIKEI_KOUMOKU3,
        BNKTN.KAIKEI_KOUMOKU4 KAIKEI_KOUMOKU4,
        BNKTN.KAIKEI_KOUMOKU5 KAIKEI_KOUMOKU5,
        BNKTN.KANRI_COMMENT1 KANRI_COMMENT1,
        BNKTN.KANRI_COMMENT2 KANRI_COMMENT2,
        BNKTN.KANRI_COMMENT3 KANRI_COMMENT3,
        BNKTN.KANRI_COMMENT4 KANRI_COMMENT4,
        BNKTN.KANRI_COMMENT5 KANRI_COMMENT5,
        BNKTN.KANRI_COMMENT6 KANRI_COMMENT6,
        BNKTN.KANRI_COMMENT7 KANRI_COMMENT7,
        BNKTN.KANRI_COMMENT8 KANRI_COMMENT8,
        BNKTN.KANRI_COMMENT9 KANRI_COMMENT9,
        BNKTN.KANRI_COMMENT10 KANRI_COMMENT10,
        BNKTN.AUS_FLG_01 AUS_FLG_01,
        BNKTN.AU_USR_ID_01 AU_USR_ID_01,
        BNKTN.AUS_DATE_01 AUS_DATE_01,
        BNKTN.AUS_FLG_02 AUS_FLG_02,
        BNKTN.AU_USR_ID_02 AU_USR_ID_02,
        BNKTN.AUS_DATE_02 AUS_DATE_02,
        BNKTN.SYO_FLG SYO_FLG,
        BNKTN.KUGIRI_2 KUGIRI_2,
        BNKTN.ZEN_BASE_MONTH ZEN_BASE_MONTH,
        BNKTN.ZEN_SETTLEMENT_DATE ZEN_SETTLEMENT_DATE,
        BNKTN.KUGIRI_3 KUGIRI_3,
        BNKTN.J_CONTRACT_NO J_CONTRACT_NO,
        BNKTN.J_BASE_MONTH J_BASE_MONTH,
        BNKTN.J_CURRENCY_CODE J_CURRENCY_CODE,
        BNKTN.J_ASSET_TYPE_CODE J_ASSET_TYPE_CODE,
        BNKTN.J_SETTLEMENT_DATE J_SETTLEMENT_DATE,
        BNKTN.J_FIX_COM_FLAG J_FIX_COM_FLAG,
        BNKTN.J_FIX_COM_J J_FIX_COM_J,
        BNKTN.KUGIRI_4 KUGIRI_4,
        BNKTN.K_CONTRACT_NO K_CONTRACT_NO,
        BNKTN.K_INSERT_DATE K_INSERT_DATE,
        BNKTN.K_CONTRACT_FLAG K_CONTRACT_FLAG,
        BNKTN.K_COMPANY_CODE K_COMPANY_CODE,
        BNKTN.K_COM_CALC_START K_COM_CALC_START,
        BNKTN.K_TAX_CALC_FLAG K_TAX_CALC_FLAG,
        BNKTN.K_ADV_LEAVE_FLAG K_ADV_LEAVE_FLAG,
        BNKTN.K_INVALID_FLAG K_INVALID_FLAG,
        BNKTN.K_ASSET_CODE K_ASSET_CODE,
        BNKTN.KUGIRI_5 KUGIRI_5,
        BNKTN.S_ITEM_FLAG S_ITEM_FLAG,
        BNKTN.S_USE_DATE S_USE_DATE,
        BNKTN.S_TAX_RATE S_TAX_RATE,
        BNKTN.S_ITEM_FLAG_P S_ITEM_FLAG_P,
        BNKTN.S_USE_DATE_P S_USE_DATE_P,
        BNKTN.S_TAX_RATE_P S_TAX_RATE_P,
        BNKTN.KUGIRI_6 KUGIRI_6,
        SYSDATE LAST_UPDATETIME,
        'CFRD1510' LAST_UPDATE_ID
FROM
CFR_TMP_SS01_TBL BNKTN,CFR_ASSET_REFARENCE_TBL CART2
WHERE
    BNKTN.K_TAX_CALC_FLAG = '1'
AND (BNKTN.S_USE_DATE <= SUBSTR(BNKTN.KAIKEI_KOUMOKU4,1,4) || SUBSTR(BNKTN.KAIKEI_KOUMOKU4,6,2) || SUBSTR(BNKTN.KAIKEI_KOUMOKU4,9,2)
OR BNKTN.S_USE_DATE > SUBSTR(BNKTN.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTN.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTN.KAIKEI_KOUMOKU4,20,2))
AND BNKTN.K_ASSET_CODE = CART2.ASSET_CODE
AND BNKTN.S_TAX_RATE = CART2.FILLER_NUM1
UNION
SELECT
        BNKTM.KUGIRI_1 KUGIRI_1,
        BNKTM.KAI_CODE KAI_CODE,
        BNKTM.IN_SYS_CODE IN_SYS_CODE,
        BNKTM.IN_SYS_DATE IN_SYS_DATE,
        BNKTM.IN_SYS_DATA_NO IN_SYS_DATA_NO,
        CART3.SS_SWK_ID SWK_ID,
        BNKTM.KESSAN_KBN KESSAN_KBN,
        BNKTM.IN_USR_ID IN_USR_ID,
        BNKTM.DEN_NO DEN_NO,
        1 GYO_NO,
        BNKTM.DR_KMK_CODE DR_KMK_CODE,
        BNKTM.DR_HKM_CODE DR_HKM_CODE,
        BNKTM.DR_BMN_CODE DR_BMN_CODE,
        BNKTM.DR_CODE1 DR_CODE1,
        BNKTM.DR_CODE2 DR_CODE2,
        BNKTM.DR_CODE3 DR_CODE3,
        CART3.SS_R_CODE4 DR_CODE4,
        BNKTM.J_FIX_COM_J - TRUNC(BNKTM.J_FIX_COM_J * 
         (TO_NUMBER(TO_DATE(SUBSTR(BNKTM.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,20,2))
        - TO_DATE(BNKTM.S_USE_DATE)) + 1)
        /(TO_NUMBER(TO_DATE(SUBSTR(BNKTM.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,20,2))
        - TO_DATE(SUBSTR(BNKTM.KAIKEI_KOUMOKU4,1,4) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,6,2) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,9,2))) + 1),0) DR_KIN,
        BNKTM.DR_CUR_CODE DR_CUR_CODE,
        BNKTM.DR_CRT_RATE_TYPE DR_CRT_RATE_TYPE,
        BNKTM.DR_CRT_RATE DR_CRT_RATE,
        BNKTM.DR_CUR_KIN DR_CUR_KIN,
        BNKTM.DR_ZEI_CODE DR_ZEI_CODE,
        BNKTM.DR_ZEI_KBN DR_ZEI_KBN,
        TRUNC((BNKTM.J_FIX_COM_J - TRUNC(BNKTM.J_FIX_COM_J * 
         (TO_NUMBER(TO_DATE(SUBSTR(BNKTM.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,20,2))
        - TO_DATE(BNKTM.S_USE_DATE)) + 1)
        /(TO_NUMBER(TO_DATE(SUBSTR(BNKTM.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,20,2))
        - TO_DATE(SUBSTR(BNKTM.KAIKEI_KOUMOKU4,1,4) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,6,2) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,9,2))) + 1),0))
        * BNKTM.S_TAX_RATE_P / 100 , 0) DR_ZEI_KIN,
        BNKTM.DR_TEKIYO1 DR_TEKIYO1,
        BNKTM.DR_TEKIYO2 DR_TEKIYO2,
        BNKTM.DR_TORI_KBN DR_TORI_KBN,
        BNKTM.DR_TORI_CODE DR_TORI_CODE,
        BNKTM.CR_KMK_CODE CR_KMK_CODE,
        BNKTM.CR_HKM_CODE CR_HKM_CODE,
        BNKTM.CR_BMN_CODE CR_BMN_CODE,
        BNKTM.CR_CODE1 CR_CODE1,
        BNKTM.CR_CODE2 CR_CODE2,
        BNKTM.CR_CODE3 CR_CODE3,
        CART3.SS_R_CODE4 CR_CODE4,
        BNKTM.J_FIX_COM_J - TRUNC(BNKTM.J_FIX_COM_J * 
         (TO_NUMBER(TO_DATE(SUBSTR(BNKTM.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,20,2))
        - TO_DATE(BNKTM.S_USE_DATE)) + 1)
        /(TO_NUMBER(TO_DATE(SUBSTR(BNKTM.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,20,2))
        - TO_DATE(SUBSTR(BNKTM.KAIKEI_KOUMOKU4,1,4) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,6,2) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,9,2))) + 1),0) CR_KIN,
        BNKTM.CR_CUR_CODE CR_CUR_CODE,
        BNKTM.CR_CRT_RATE_TYPE CR_CRT_RATE_TYPE,
        BNKTM.CR_CRT_RATE CR_CRT_RATE,
        BNKTM.CR_CUR_KIN CR_CUR_KIN,
        BNKTM.CR_ZEI_CODE CR_ZEI_CODE,
        BNKTM.CR_ZEI_KBN CR_ZEI_KBN,
        TRUNC((BNKTM.J_FIX_COM_J - TRUNC(BNKTM.J_FIX_COM_J * 
         (TO_NUMBER(TO_DATE(SUBSTR(BNKTM.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,20,2))
        - TO_DATE(BNKTM.S_USE_DATE)) + 1)
        /(TO_NUMBER(TO_DATE(SUBSTR(BNKTM.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,20,2))
        - TO_DATE(SUBSTR(BNKTM.KAIKEI_KOUMOKU4,1,4) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,6,2) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,9,2))) + 1),0))
        * BNKTM.S_TAX_RATE_P / 100 , 0) CR_ZEI_KIN,
        BNKTM.CR_TEKIYO1 CR_TEKIYO1,
        BNKTM.CR_TEKIYO2 CR_TEKIYO2,
        BNKTM.CR_TORI_KBN CR_TORI_KBN,
        BNKTM.CR_TORI_CODE CR_TORI_CODE,
        BNKTM.SWK_JYO1 SWK_JYO1,
        BNKTM.SWK_JYO2 SWK_JYO2,
        BNKTM.SWK_JYO3 SWK_JYO3,
        BNKTM.SWK_JYO4 SWK_JYO4,
        BNKTM.SWK_JYO5 SWK_JYO5,
        BNKTM.KAIKEI_KOUMOKU1 KAIKEI_KOUMOKU1,
        BNKTM.KAIKEI_KOUMOKU2 KAIKEI_KOUMOKU2,
        BNKTM.KAIKEI_KOUMOKU3 KAIKEI_KOUMOKU3,
        BNKTM.KAIKEI_KOUMOKU4 KAIKEI_KOUMOKU4,
        BNKTM.KAIKEI_KOUMOKU5 KAIKEI_KOUMOKU5,
        BNKTM.KANRI_COMMENT1 KANRI_COMMENT1,
        BNKTM.KANRI_COMMENT2 KANRI_COMMENT2,
        BNKTM.KANRI_COMMENT3 KANRI_COMMENT3,
        BNKTM.KANRI_COMMENT4 KANRI_COMMENT4,
        BNKTM.KANRI_COMMENT5 KANRI_COMMENT5,
        BNKTM.KANRI_COMMENT6 KANRI_COMMENT6,
        BNKTM.KANRI_COMMENT7 KANRI_COMMENT7,
        BNKTM.KANRI_COMMENT8 KANRI_COMMENT8,
        BNKTM.KANRI_COMMENT9 KANRI_COMMENT9,
        BNKTM.KANRI_COMMENT10 KANRI_COMMENT10,
        BNKTM.AUS_FLG_01 AUS_FLG_01,
        BNKTM.AU_USR_ID_01 AU_USR_ID_01,
        BNKTM.AUS_DATE_01 AUS_DATE_01,
        BNKTM.AUS_FLG_02 AUS_FLG_02,
        BNKTM.AU_USR_ID_02 AU_USR_ID_02,
        BNKTM.AUS_DATE_02 AUS_DATE_02,
        BNKTM.SYO_FLG SYO_FLG,
        BNKTM.KUGIRI_2 KUGIRI_2,
        BNKTM.ZEN_BASE_MONTH ZEN_BASE_MONTH,
        BNKTM.ZEN_SETTLEMENT_DATE ZEN_SETTLEMENT_DATE,
        BNKTM.KUGIRI_3 KUGIRI_3,
        BNKTM.J_CONTRACT_NO J_CONTRACT_NO,
        BNKTM.J_BASE_MONTH J_BASE_MONTH,
        BNKTM.J_CURRENCY_CODE J_CURRENCY_CODE,
        BNKTM.J_ASSET_TYPE_CODE J_ASSET_TYPE_CODE,
        BNKTM.J_SETTLEMENT_DATE J_SETTLEMENT_DATE,
        BNKTM.J_FIX_COM_FLAG J_FIX_COM_FLAG,
        BNKTM.J_FIX_COM_J J_FIX_COM_J,
        BNKTM.KUGIRI_4 KUGIRI_4,
        BNKTM.K_CONTRACT_NO K_CONTRACT_NO,
        BNKTM.K_INSERT_DATE K_INSERT_DATE,
        BNKTM.K_CONTRACT_FLAG K_CONTRACT_FLAG,
        BNKTM.K_COMPANY_CODE K_COMPANY_CODE,
        BNKTM.K_COM_CALC_START K_COM_CALC_START,
        BNKTM.K_TAX_CALC_FLAG K_TAX_CALC_FLAG,
        BNKTM.K_ADV_LEAVE_FLAG K_ADV_LEAVE_FLAG,
        BNKTM.K_INVALID_FLAG K_INVALID_FLAG,
        BNKTM.K_ASSET_CODE K_ASSET_CODE,
        BNKTM.KUGIRI_5 KUGIRI_5,
        BNKTM.S_ITEM_FLAG S_ITEM_FLAG,
        BNKTM.S_USE_DATE S_USE_DATE,
        BNKTM.S_TAX_RATE S_TAX_RATE,
        BNKTM.S_ITEM_FLAG_P S_ITEM_FLAG_P,
        BNKTM.S_USE_DATE_P S_USE_DATE_P,
        BNKTM.S_TAX_RATE_P S_TAX_RATE_P,
        BNKTM.KUGIRI_6 KUGIRI_6,
        SYSDATE LAST_UPDATETIME,
        'CFRD1510' LAST_UPDATE_ID
FROM
CFR_TMP_SS01_TBL BNKTM,CFR_ASSET_REFARENCE_TBL CART3
WHERE
    BNKTM.K_TAX_CALC_FLAG = '1'
AND BNKTM.S_USE_DATE > SUBSTR(BNKTM.KAIKEI_KOUMOKU4,1,4) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,6,2) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,9,2)
AND BNKTM.S_USE_DATE <= SUBSTR(BNKTM.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTM.KAIKEI_KOUMOKU4,20,2)
AND BNKTM.K_ASSET_CODE = CART3.ASSET_CODE
AND BNKTM.S_TAX_RATE_P = CART3.FILLER_NUM1
UNION
SELECT
        BNKTG.KUGIRI_1 KUGIRI_1,
        BNKTG.KAI_CODE KAI_CODE,
        BNKTG.IN_SYS_CODE IN_SYS_CODE,
        BNKTG.IN_SYS_DATE IN_SYS_DATE,
        BNKTG.IN_SYS_DATA_NO IN_SYS_DATA_NO,
        CART4.SS_SWK_ID SWK_ID,
        BNKTG.KESSAN_KBN KESSAN_KBN,
        BNKTG.IN_USR_ID IN_USR_ID,
        BNKTG.DEN_NO DEN_NO,
        1 GYO_NO,
        BNKTG.DR_KMK_CODE DR_KMK_CODE,
        BNKTG.DR_HKM_CODE DR_HKM_CODE,
        BNKTG.DR_BMN_CODE DR_BMN_CODE,
        BNKTG.DR_CODE1 DR_CODE1,
        BNKTG.DR_CODE2 DR_CODE2,
        BNKTG.DR_CODE3 DR_CODE3,
        CART4.SS_R_CODE4 DR_CODE4,
        TRUNC(BNKTG.J_FIX_COM_J * 
         (TO_NUMBER(TO_DATE(SUBSTR(BNKTG.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,20,2))
        - TO_DATE(BNKTG.S_USE_DATE)) + 1)
        /(TO_NUMBER(TO_DATE(SUBSTR(BNKTG.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,20,2))
        - TO_DATE(SUBSTR(BNKTG.KAIKEI_KOUMOKU4,1,4) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,6,2) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,9,2))) + 1),0) DR_KIN,
        BNKTG.DR_CUR_CODE DR_CUR_CODE,
        BNKTG.DR_CRT_RATE_TYPE DR_CRT_RATE_TYPE,
        BNKTG.DR_CRT_RATE DR_CRT_RATE,
        BNKTG.DR_CUR_KIN DR_CUR_KIN,
        BNKTG.DR_ZEI_CODE DR_ZEI_CODE,
        BNKTG.DR_ZEI_KBN DR_ZEI_KBN,
        TRUNC((TRUNC(BNKTG.J_FIX_COM_J * 
         (TO_NUMBER(TO_DATE(SUBSTR(BNKTG.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,20,2))
        - TO_DATE(BNKTG.S_USE_DATE)) + 1)
        /(TO_NUMBER(TO_DATE(SUBSTR(BNKTG.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,20,2))
        - TO_DATE(SUBSTR(BNKTG.KAIKEI_KOUMOKU4,1,4) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,6,2) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,9,2))) + 1),0))
        * BNKTG.S_TAX_RATE / 100 , 0) DR_ZEI_KIN,
        BNKTG.DR_TEKIYO1 DR_TEKIYO1,
        BNKTG.DR_TEKIYO2 DR_TEKIYO2,
        BNKTG.DR_TORI_KBN DR_TORI_KBN,
        BNKTG.DR_TORI_CODE DR_TORI_CODE,
        BNKTG.CR_KMK_CODE CR_KMK_CODE,
        BNKTG.CR_HKM_CODE CR_HKM_CODE,
        BNKTG.CR_BMN_CODE CR_BMN_CODE,
        BNKTG.CR_CODE1 CR_CODE1,
        BNKTG.CR_CODE2 CR_CODE2,
        BNKTG.CR_CODE3 CR_CODE3,
        CART4.SS_R_CODE4 CR_CODE4,
        TRUNC(BNKTG.J_FIX_COM_J * 
         (TO_NUMBER(TO_DATE(SUBSTR(BNKTG.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,20,2))
        - TO_DATE(BNKTG.S_USE_DATE)) + 1)
        /(TO_NUMBER(TO_DATE(SUBSTR(BNKTG.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,20,2))
        - TO_DATE(SUBSTR(BNKTG.KAIKEI_KOUMOKU4,1,4) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,6,2) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,9,2))) + 1),0) CR_KIN,
        BNKTG.CR_CUR_CODE CR_CUR_CODE,
        BNKTG.CR_CRT_RATE_TYPE CR_CRT_RATE_TYPE,
        BNKTG.CR_CRT_RATE CR_CRT_RATE,
        BNKTG.CR_CUR_KIN CR_CUR_KIN,
        BNKTG.CR_ZEI_CODE CR_ZEI_CODE,
        BNKTG.CR_ZEI_KBN CR_ZEI_KBN,
        TRUNC((TRUNC(BNKTG.J_FIX_COM_J * 
         (TO_NUMBER(TO_DATE(SUBSTR(BNKTG.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,20,2))
        - TO_DATE(BNKTG.S_USE_DATE)) + 1)
        /(TO_NUMBER(TO_DATE(SUBSTR(BNKTG.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,20,2))
        - TO_DATE(SUBSTR(BNKTG.KAIKEI_KOUMOKU4,1,4) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,6,2) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,9,2))) + 1),0))
        * BNKTG.S_TAX_RATE / 100 , 0) CR_ZEI_KIN,
        BNKTG.CR_TEKIYO1 CR_TEKIYO1,
        BNKTG.CR_TEKIYO2 CR_TEKIYO2,
        BNKTG.CR_TORI_KBN CR_TORI_KBN,
        BNKTG.CR_TORI_CODE CR_TORI_CODE,
        BNKTG.SWK_JYO1 SWK_JYO1,
        BNKTG.SWK_JYO2 SWK_JYO2,
        BNKTG.SWK_JYO3 SWK_JYO3,
        BNKTG.SWK_JYO4 SWK_JYO4,
        BNKTG.SWK_JYO5 SWK_JYO5,
        BNKTG.KAIKEI_KOUMOKU1 KAIKEI_KOUMOKU1,
        BNKTG.KAIKEI_KOUMOKU2 KAIKEI_KOUMOKU2,
        BNKTG.KAIKEI_KOUMOKU3 KAIKEI_KOUMOKU3,
        BNKTG.KAIKEI_KOUMOKU4 KAIKEI_KOUMOKU4,
        BNKTG.KAIKEI_KOUMOKU5 KAIKEI_KOUMOKU5,
        BNKTG.KANRI_COMMENT1 KANRI_COMMENT1,
        BNKTG.KANRI_COMMENT2 KANRI_COMMENT2,
        BNKTG.KANRI_COMMENT3 KANRI_COMMENT3,
        BNKTG.KANRI_COMMENT4 KANRI_COMMENT4,
        BNKTG.KANRI_COMMENT5 KANRI_COMMENT5,
        BNKTG.KANRI_COMMENT6 KANRI_COMMENT6,
        BNKTG.KANRI_COMMENT7 KANRI_COMMENT7,
        BNKTG.KANRI_COMMENT8 KANRI_COMMENT8,
        BNKTG.KANRI_COMMENT9 KANRI_COMMENT9,
        BNKTG.KANRI_COMMENT10 KANRI_COMMENT10,
        BNKTG.AUS_FLG_01 AUS_FLG_01,
        BNKTG.AU_USR_ID_01 AU_USR_ID_01,
        BNKTG.AUS_DATE_01 AUS_DATE_01,
        BNKTG.AUS_FLG_02 AUS_FLG_02,
        BNKTG.AU_USR_ID_02 AU_USR_ID_02,
        BNKTG.AUS_DATE_02 AUS_DATE_02,
        BNKTG.SYO_FLG SYO_FLG,
        BNKTG.KUGIRI_2 KUGIRI_2,
        BNKTG.ZEN_BASE_MONTH ZEN_BASE_MONTH,
        BNKTG.ZEN_SETTLEMENT_DATE ZEN_SETTLEMENT_DATE,
        BNKTG.KUGIRI_3 KUGIRI_3,
        BNKTG.J_CONTRACT_NO J_CONTRACT_NO,
        BNKTG.J_BASE_MONTH J_BASE_MONTH,
        BNKTG.J_CURRENCY_CODE J_CURRENCY_CODE,
        BNKTG.J_ASSET_TYPE_CODE J_ASSET_TYPE_CODE,
        BNKTG.J_SETTLEMENT_DATE J_SETTLEMENT_DATE,
        BNKTG.J_FIX_COM_FLAG J_FIX_COM_FLAG,
        BNKTG.J_FIX_COM_J J_FIX_COM_J,
        BNKTG.KUGIRI_4 KUGIRI_4,
        BNKTG.K_CONTRACT_NO K_CONTRACT_NO,
        BNKTG.K_INSERT_DATE K_INSERT_DATE,
        BNKTG.K_CONTRACT_FLAG K_CONTRACT_FLAG,
        BNKTG.K_COMPANY_CODE K_COMPANY_CODE,
        BNKTG.K_COM_CALC_START K_COM_CALC_START,
        BNKTG.K_TAX_CALC_FLAG K_TAX_CALC_FLAG,
        BNKTG.K_ADV_LEAVE_FLAG K_ADV_LEAVE_FLAG,
        BNKTG.K_INVALID_FLAG K_INVALID_FLAG,
        BNKTG.K_ASSET_CODE K_ASSET_CODE,
        BNKTG.KUGIRI_5 KUGIRI_5,
        BNKTG.S_ITEM_FLAG S_ITEM_FLAG,
        BNKTG.S_USE_DATE S_USE_DATE,
        BNKTG.S_TAX_RATE S_TAX_RATE,
        BNKTG.S_ITEM_FLAG_P S_ITEM_FLAG_P,
        BNKTG.S_USE_DATE_P S_USE_DATE_P,
        BNKTG.S_TAX_RATE_P S_TAX_RATE_P,
        BNKTG.KUGIRI_6 KUGIRI_6,
        SYSDATE LAST_UPDATETIME,
        'CFRD1510' LAST_UPDATE_ID
FROM
CFR_TMP_SS01_TBL BNKTG,CFR_ASSET_REFARENCE_TBL CART4
WHERE
    BNKTG.K_TAX_CALC_FLAG = '1'
AND BNKTG.S_USE_DATE > SUBSTR(BNKTG.KAIKEI_KOUMOKU4,1,4) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,6,2) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,9,2)
AND BNKTG.S_USE_DATE <= SUBSTR(BNKTG.KAIKEI_KOUMOKU4,12,4) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,17,2) || SUBSTR(BNKTG.KAIKEI_KOUMOKU4,20,2)
AND BNKTG.K_ASSET_CODE = CART4.ASSET_CODE
AND BNKTG.S_TAX_RATE = CART4.FILLER_NUM1
;
